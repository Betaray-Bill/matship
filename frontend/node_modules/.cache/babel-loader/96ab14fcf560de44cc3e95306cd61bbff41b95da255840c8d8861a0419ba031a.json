{"ast":null,"code":"/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*exported XLSX */\n/*global exports, module, require:false, process:false, Buffer:false, ArrayBuffer:false, DataView:false, Deno:false */\nvar XLSX = {};\nfunction make_xlsx_lib(XLSX) {\n  XLSX.version = '0.18.5';\n  var current_codepage = 1200,\n    current_ansi = 1252;\n  /*global cptable:true, window */\n  var $cptable;\n  if (typeof cptable !== 'undefined') $cptable = cptable;else if (typeof module !== \"undefined\" && typeof require !== 'undefined') {\n    $cptable = require('./dist/cpexcel.js');\n  }\n  var VALID_ANSI = [874, 932, 936, 949, 950, 1250, 1251, 1252, 1253, 1254, 1255, 1256, 1257, 1258, 10000];\n  /* ECMA-376 Part I 18.4.1 charset to codepage mapping */\n  var CS2CP = {\n    0: 1252,\n    /* ANSI */\n    1: 65001,\n    /* DEFAULT */\n    2: 65001,\n    /* SYMBOL */\n    77: 10000,\n    /* MAC */\n    128: 932,\n    /* SHIFTJIS */\n    129: 949,\n    /* HANGUL */\n    130: 1361,\n    /* JOHAB */\n    134: 936,\n    /* GB2312 */\n    136: 950,\n    /* CHINESEBIG5 */\n    161: 1253,\n    /* GREEK */\n    162: 1254,\n    /* TURKISH */\n    163: 1258,\n    /* VIETNAMESE */\n    177: 1255,\n    /* HEBREW */\n    178: 1256,\n    /* ARABIC */\n    186: 1257,\n    /* BALTIC */\n    204: 1251,\n    /* RUSSIAN */\n    222: 874,\n    /* THAI */\n    238: 1250,\n    /* EASTEUROPE */\n    255: 1252,\n    /* OEM */\n    69: 6969 /* MISC */\n  };\n\n  var set_ansi = function (cp) {\n    if (VALID_ANSI.indexOf(cp) == -1) return;\n    current_ansi = CS2CP[0] = cp;\n  };\n  function reset_ansi() {\n    set_ansi(1252);\n  }\n  var set_cp = function (cp) {\n    current_codepage = cp;\n    set_ansi(cp);\n  };\n  function reset_cp() {\n    set_cp(1200);\n    reset_ansi();\n  }\n  function char_codes(data) {\n    var o = [];\n    for (var i = 0, len = data.length; i < len; ++i) o[i] = data.charCodeAt(i);\n    return o;\n  }\n  function utf16leread(data) {\n    var o = [];\n    for (var i = 0; i < data.length >> 1; ++i) o[i] = String.fromCharCode(data.charCodeAt(2 * i) + (data.charCodeAt(2 * i + 1) << 8));\n    return o.join(\"\");\n  }\n  function utf16beread(data) {\n    var o = [];\n    for (var i = 0; i < data.length >> 1; ++i) o[i] = String.fromCharCode(data.charCodeAt(2 * i + 1) + (data.charCodeAt(2 * i) << 8));\n    return o.join(\"\");\n  }\n  var debom = function (data) {\n    var c1 = data.charCodeAt(0),\n      c2 = data.charCodeAt(1);\n    if (c1 == 0xFF && c2 == 0xFE) return utf16leread(data.slice(2));\n    if (c1 == 0xFE && c2 == 0xFF) return utf16beread(data.slice(2));\n    if (c1 == 0xFEFF) return data.slice(1);\n    return data;\n  };\n  var _getchar = function _gc1(x) {\n    return String.fromCharCode(x);\n  };\n  var _getansi = function _ga1(x) {\n    return String.fromCharCode(x);\n  };\n  if (typeof $cptable !== 'undefined') {\n    set_cp = function (cp) {\n      current_codepage = cp;\n      set_ansi(cp);\n    };\n    debom = function (data) {\n      if (data.charCodeAt(0) === 0xFF && data.charCodeAt(1) === 0xFE) {\n        return $cptable.utils.decode(1200, char_codes(data.slice(2)));\n      }\n      return data;\n    };\n    _getchar = function _gc2(x) {\n      if (current_codepage === 1200) return String.fromCharCode(x);\n      return $cptable.utils.decode(current_codepage, [x & 255, x >> 8])[0];\n    };\n    _getansi = function _ga2(x) {\n      return $cptable.utils.decode(current_ansi, [x])[0];\n    };\n  }\n  var DENSE = null;\n  var DIF_XL = true;\n  var Base64_map = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n  function Base64_encode(input) {\n    var o = \"\";\n    var c1 = 0,\n      c2 = 0,\n      c3 = 0,\n      e1 = 0,\n      e2 = 0,\n      e3 = 0,\n      e4 = 0;\n    for (var i = 0; i < input.length;) {\n      c1 = input.charCodeAt(i++);\n      e1 = c1 >> 2;\n      c2 = input.charCodeAt(i++);\n      e2 = (c1 & 3) << 4 | c2 >> 4;\n      c3 = input.charCodeAt(i++);\n      e3 = (c2 & 15) << 2 | c3 >> 6;\n      e4 = c3 & 63;\n      if (isNaN(c2)) {\n        e3 = e4 = 64;\n      } else if (isNaN(c3)) {\n        e4 = 64;\n      }\n      o += Base64_map.charAt(e1) + Base64_map.charAt(e2) + Base64_map.charAt(e3) + Base64_map.charAt(e4);\n    }\n    return o;\n  }\n  function Base64_decode(input) {\n    var o = \"\";\n    var c1 = 0,\n      c2 = 0,\n      c3 = 0,\n      e1 = 0,\n      e2 = 0,\n      e3 = 0,\n      e4 = 0;\n    input = input.replace(/[^\\w\\+\\/\\=]/g, \"\");\n    for (var i = 0; i < input.length;) {\n      e1 = Base64_map.indexOf(input.charAt(i++));\n      e2 = Base64_map.indexOf(input.charAt(i++));\n      c1 = e1 << 2 | e2 >> 4;\n      o += String.fromCharCode(c1);\n      e3 = Base64_map.indexOf(input.charAt(i++));\n      c2 = (e2 & 15) << 4 | e3 >> 2;\n      if (e3 !== 64) {\n        o += String.fromCharCode(c2);\n      }\n      e4 = Base64_map.indexOf(input.charAt(i++));\n      c3 = (e3 & 3) << 6 | e4;\n      if (e4 !== 64) {\n        o += String.fromCharCode(c3);\n      }\n    }\n    return o;\n  }\n  var has_buf = function () {\n    return typeof Buffer !== 'undefined' && typeof process !== 'undefined' && typeof process.versions !== 'undefined' && !!process.versions.node;\n  }();\n  var Buffer_from = function () {\n    if (typeof Buffer !== 'undefined') {\n      var nbfs = !Buffer.from;\n      if (!nbfs) try {\n        Buffer.from(\"foo\", \"utf8\");\n      } catch (e) {\n        nbfs = true;\n      }\n      return nbfs ? function (buf, enc) {\n        return enc ? new Buffer(buf, enc) : new Buffer(buf);\n      } : Buffer.from.bind(Buffer);\n    }\n    return function () {};\n  }();\n  function new_raw_buf(len) {\n    /* jshint -W056 */\n    if (has_buf) return Buffer.alloc ? Buffer.alloc(len) : new Buffer(len);\n    return typeof Uint8Array != \"undefined\" ? new Uint8Array(len) : new Array(len);\n    /* jshint +W056 */\n  }\n\n  function new_unsafe_buf(len) {\n    /* jshint -W056 */\n    if (has_buf) return Buffer.allocUnsafe ? Buffer.allocUnsafe(len) : new Buffer(len);\n    return typeof Uint8Array != \"undefined\" ? new Uint8Array(len) : new Array(len);\n    /* jshint +W056 */\n  }\n\n  var s2a = function s2a(s) {\n    if (has_buf) return Buffer_from(s, \"binary\");\n    return s.split(\"\").map(function (x) {\n      return x.charCodeAt(0) & 0xff;\n    });\n  };\n  function s2ab(s) {\n    if (typeof ArrayBuffer === 'undefined') return s2a(s);\n    var buf = new ArrayBuffer(s.length),\n      view = new Uint8Array(buf);\n    for (var i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;\n    return buf;\n  }\n  function a2s(data) {\n    if (Array.isArray(data)) return data.map(function (c) {\n      return String.fromCharCode(c);\n    }).join(\"\");\n    var o = [];\n    for (var i = 0; i < data.length; ++i) o[i] = String.fromCharCode(data[i]);\n    return o.join(\"\");\n  }\n  function a2u(data) {\n    if (typeof Uint8Array === 'undefined') throw new Error(\"Unsupported\");\n    return new Uint8Array(data);\n  }\n  function ab2a(data) {\n    if (typeof ArrayBuffer == 'undefined') throw new Error(\"Unsupported\");\n    if (data instanceof ArrayBuffer) return ab2a(new Uint8Array(data));\n    var o = new Array(data.length);\n    for (var i = 0; i < data.length; ++i) o[i] = data[i];\n    return o;\n  }\n  var bconcat = has_buf ? function (bufs) {\n    return Buffer.concat(bufs.map(function (buf) {\n      return Buffer.isBuffer(buf) ? buf : Buffer_from(buf);\n    }));\n  } : function (bufs) {\n    if (typeof Uint8Array !== \"undefined\") {\n      var i = 0,\n        maxlen = 0;\n      for (i = 0; i < bufs.length; ++i) maxlen += bufs[i].length;\n      var o = new Uint8Array(maxlen);\n      var len = 0;\n      for (i = 0, maxlen = 0; i < bufs.length; maxlen += len, ++i) {\n        len = bufs[i].length;\n        if (bufs[i] instanceof Uint8Array) o.set(bufs[i], maxlen);else if (typeof bufs[i] == \"string\") {\n          throw \"wtf\";\n        } else o.set(new Uint8Array(bufs[i]), maxlen);\n      }\n      return o;\n    }\n    return [].concat.apply([], bufs.map(function (buf) {\n      return Array.isArray(buf) ? buf : [].slice.call(buf);\n    }));\n  };\n  function utf8decode(content) {\n    var out = [],\n      widx = 0,\n      L = content.length + 250;\n    var o = new_raw_buf(content.length + 255);\n    for (var ridx = 0; ridx < content.length; ++ridx) {\n      var c = content.charCodeAt(ridx);\n      if (c < 0x80) o[widx++] = c;else if (c < 0x800) {\n        o[widx++] = 192 | c >> 6 & 31;\n        o[widx++] = 128 | c & 63;\n      } else if (c >= 0xD800 && c < 0xE000) {\n        c = (c & 1023) + 64;\n        var d = content.charCodeAt(++ridx) & 1023;\n        o[widx++] = 240 | c >> 8 & 7;\n        o[widx++] = 128 | c >> 2 & 63;\n        o[widx++] = 128 | d >> 6 & 15 | (c & 3) << 4;\n        o[widx++] = 128 | d & 63;\n      } else {\n        o[widx++] = 224 | c >> 12 & 15;\n        o[widx++] = 128 | c >> 6 & 63;\n        o[widx++] = 128 | c & 63;\n      }\n      if (widx > L) {\n        out.push(o.slice(0, widx));\n        widx = 0;\n        o = new_raw_buf(65535);\n        L = 65530;\n      }\n    }\n    out.push(o.slice(0, widx));\n    return bconcat(out);\n  }\n  var chr0 = /\\u0000/g,\n    chr1 = /[\\u0001-\\u0006]/g;\n  /* ssf.js (C) 2013-present SheetJS -- http://sheetjs.com */\n  /*jshint -W041 */\n  function _strrev(x) {\n    var o = \"\",\n      i = x.length - 1;\n    while (i >= 0) o += x.charAt(i--);\n    return o;\n  }\n  function pad0(v, d) {\n    var t = \"\" + v;\n    return t.length >= d ? t : fill('0', d - t.length) + t;\n  }\n  function pad_(v, d) {\n    var t = \"\" + v;\n    return t.length >= d ? t : fill(' ', d - t.length) + t;\n  }\n  function rpad_(v, d) {\n    var t = \"\" + v;\n    return t.length >= d ? t : t + fill(' ', d - t.length);\n  }\n  function pad0r1(v, d) {\n    var t = \"\" + Math.round(v);\n    return t.length >= d ? t : fill('0', d - t.length) + t;\n  }\n  function pad0r2(v, d) {\n    var t = \"\" + v;\n    return t.length >= d ? t : fill('0', d - t.length) + t;\n  }\n  var p2_32 = Math.pow(2, 32);\n  function pad0r(v, d) {\n    if (v > p2_32 || v < -p2_32) return pad0r1(v, d);\n    var i = Math.round(v);\n    return pad0r2(i, d);\n  }\n  /* yes, in 2022 this is still faster than string compare */\n  function SSF_isgeneral(s, i) {\n    i = i || 0;\n    return s.length >= 7 + i && (s.charCodeAt(i) | 32) === 103 && (s.charCodeAt(i + 1) | 32) === 101 && (s.charCodeAt(i + 2) | 32) === 110 && (s.charCodeAt(i + 3) | 32) === 101 && (s.charCodeAt(i + 4) | 32) === 114 && (s.charCodeAt(i + 5) | 32) === 97 && (s.charCodeAt(i + 6) | 32) === 108;\n  }\n  var days = [['Sun', 'Sunday'], ['Mon', 'Monday'], ['Tue', 'Tuesday'], ['Wed', 'Wednesday'], ['Thu', 'Thursday'], ['Fri', 'Friday'], ['Sat', 'Saturday']];\n  var months = [['J', 'Jan', 'January'], ['F', 'Feb', 'February'], ['M', 'Mar', 'March'], ['A', 'Apr', 'April'], ['M', 'May', 'May'], ['J', 'Jun', 'June'], ['J', 'Jul', 'July'], ['A', 'Aug', 'August'], ['S', 'Sep', 'September'], ['O', 'Oct', 'October'], ['N', 'Nov', 'November'], ['D', 'Dec', 'December']];\n  function SSF_init_table(t) {\n    if (!t) t = {};\n    t[0] = 'General';\n    t[1] = '0';\n    t[2] = '0.00';\n    t[3] = '#,##0';\n    t[4] = '#,##0.00';\n    t[9] = '0%';\n    t[10] = '0.00%';\n    t[11] = '0.00E+00';\n    t[12] = '# ?/?';\n    t[13] = '# ??/??';\n    t[14] = 'm/d/yy';\n    t[15] = 'd-mmm-yy';\n    t[16] = 'd-mmm';\n    t[17] = 'mmm-yy';\n    t[18] = 'h:mm AM/PM';\n    t[19] = 'h:mm:ss AM/PM';\n    t[20] = 'h:mm';\n    t[21] = 'h:mm:ss';\n    t[22] = 'm/d/yy h:mm';\n    t[37] = '#,##0 ;(#,##0)';\n    t[38] = '#,##0 ;[Red](#,##0)';\n    t[39] = '#,##0.00;(#,##0.00)';\n    t[40] = '#,##0.00;[Red](#,##0.00)';\n    t[45] = 'mm:ss';\n    t[46] = '[h]:mm:ss';\n    t[47] = 'mmss.0';\n    t[48] = '##0.0E+0';\n    t[49] = '@';\n    t[56] = '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"';\n    return t;\n  }\n  /* repeated to satiate webpack */\n  var table_fmt = {\n    0: 'General',\n    1: '0',\n    2: '0.00',\n    3: '#,##0',\n    4: '#,##0.00',\n    9: '0%',\n    10: '0.00%',\n    11: '0.00E+00',\n    12: '# ?/?',\n    13: '# ??/??',\n    14: 'm/d/yy',\n    15: 'd-mmm-yy',\n    16: 'd-mmm',\n    17: 'mmm-yy',\n    18: 'h:mm AM/PM',\n    19: 'h:mm:ss AM/PM',\n    20: 'h:mm',\n    21: 'h:mm:ss',\n    22: 'm/d/yy h:mm',\n    37: '#,##0 ;(#,##0)',\n    38: '#,##0 ;[Red](#,##0)',\n    39: '#,##0.00;(#,##0.00)',\n    40: '#,##0.00;[Red](#,##0.00)',\n    45: 'mm:ss',\n    46: '[h]:mm:ss',\n    47: 'mmss.0',\n    48: '##0.0E+0',\n    49: '@',\n    56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"'\n  };\n\n  /* Defaults determined by systematically testing in Excel 2019 */\n\n  /* These formats appear to default to other formats in the table */\n  var SSF_default_map = {\n    5: 37,\n    6: 38,\n    7: 39,\n    8: 40,\n    //  5 -> 37 ...  8 -> 40\n\n    23: 0,\n    24: 0,\n    25: 0,\n    26: 0,\n    // 23 ->  0 ... 26 ->  0\n\n    27: 14,\n    28: 14,\n    29: 14,\n    30: 14,\n    31: 14,\n    // 27 -> 14 ... 31 -> 14\n\n    50: 14,\n    51: 14,\n    52: 14,\n    53: 14,\n    54: 14,\n    // 50 -> 14 ... 58 -> 14\n    55: 14,\n    56: 14,\n    57: 14,\n    58: 14,\n    59: 1,\n    60: 2,\n    61: 3,\n    62: 4,\n    // 59 ->  1 ... 62 ->  4\n\n    67: 9,\n    68: 10,\n    // 67 ->  9 ... 68 -> 10\n    69: 12,\n    70: 13,\n    71: 14,\n    // 69 -> 12 ... 71 -> 14\n    72: 14,\n    73: 15,\n    74: 16,\n    75: 17,\n    // 72 -> 14 ... 75 -> 17\n    76: 20,\n    77: 21,\n    78: 22,\n    // 76 -> 20 ... 78 -> 22\n    79: 45,\n    80: 46,\n    81: 47,\n    // 79 -> 45 ... 81 -> 47\n    82: 0 // 82 ->  0 ... 65536 -> 0 (omitted)\n  };\n\n  /* These formats technically refer to Accounting formats with no equivalent */\n  var SSF_default_str = {\n    //  5 -- Currency,   0 decimal, black negative\n    5: '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n    63: '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n    //  6 -- Currency,   0 decimal, red   negative\n    6: '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n    64: '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n    //  7 -- Currency,   2 decimal, black negative\n    7: '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n    65: '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n    //  8 -- Currency,   2 decimal, red   negative\n    8: '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n    66: '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n    // 41 -- Accounting, 0 decimal, No Symbol\n    41: '_(* #,##0_);_(* \\\\(#,##0\\\\);_(* \"-\"_);_(@_)',\n    // 42 -- Accounting, 0 decimal, $  Symbol\n    42: '_(\"$\"* #,##0_);_(\"$\"* \\\\(#,##0\\\\);_(\"$\"* \"-\"_);_(@_)',\n    // 43 -- Accounting, 2 decimal, No Symbol\n    43: '_(* #,##0.00_);_(* \\\\(#,##0.00\\\\);_(* \"-\"??_);_(@_)',\n    // 44 -- Accounting, 2 decimal, $  Symbol\n    44: '_(\"$\"* #,##0.00_);_(\"$\"* \\\\(#,##0.00\\\\);_(\"$\"* \"-\"??_);_(@_)'\n  };\n  function SSF_frac(x, D, mixed) {\n    var sgn = x < 0 ? -1 : 1;\n    var B = x * sgn;\n    var P_2 = 0,\n      P_1 = 1,\n      P = 0;\n    var Q_2 = 1,\n      Q_1 = 0,\n      Q = 0;\n    var A = Math.floor(B);\n    while (Q_1 < D) {\n      A = Math.floor(B);\n      P = A * P_1 + P_2;\n      Q = A * Q_1 + Q_2;\n      if (B - A < 0.00000005) break;\n      B = 1 / (B - A);\n      P_2 = P_1;\n      P_1 = P;\n      Q_2 = Q_1;\n      Q_1 = Q;\n    }\n    if (Q > D) {\n      if (Q_1 > D) {\n        Q = Q_2;\n        P = P_2;\n      } else {\n        Q = Q_1;\n        P = P_1;\n      }\n    }\n    if (!mixed) return [0, sgn * P, Q];\n    var q = Math.floor(sgn * P / Q);\n    return [q, sgn * P - q * Q, Q];\n  }\n  function SSF_parse_date_code(v, opts, b2) {\n    if (v > 2958465 || v < 0) return null;\n    var date = v | 0,\n      time = Math.floor(86400 * (v - date)),\n      dow = 0;\n    var dout = [];\n    var out = {\n      D: date,\n      T: time,\n      u: 86400 * (v - date) - time,\n      y: 0,\n      m: 0,\n      d: 0,\n      H: 0,\n      M: 0,\n      S: 0,\n      q: 0\n    };\n    if (Math.abs(out.u) < 1e-6) out.u = 0;\n    if (opts && opts.date1904) date += 1462;\n    if (out.u > 0.9999) {\n      out.u = 0;\n      if (++time == 86400) {\n        out.T = time = 0;\n        ++date;\n        ++out.D;\n      }\n    }\n    if (date === 60) {\n      dout = b2 ? [1317, 10, 29] : [1900, 2, 29];\n      dow = 3;\n    } else if (date === 0) {\n      dout = b2 ? [1317, 8, 29] : [1900, 1, 0];\n      dow = 6;\n    } else {\n      if (date > 60) --date;\n      /* 1 = Jan 1 1900 in Gregorian */\n      var d = new Date(1900, 0, 1);\n      d.setDate(d.getDate() + date - 1);\n      dout = [d.getFullYear(), d.getMonth() + 1, d.getDate()];\n      dow = d.getDay();\n      if (date < 60) dow = (dow + 6) % 7;\n      if (b2) dow = SSF_fix_hijri(d, dout);\n    }\n    out.y = dout[0];\n    out.m = dout[1];\n    out.d = dout[2];\n    out.S = time % 60;\n    time = Math.floor(time / 60);\n    out.M = time % 60;\n    time = Math.floor(time / 60);\n    out.H = time;\n    out.q = dow;\n    return out;\n  }\n  var SSFbasedate = new Date(1899, 11, 31, 0, 0, 0);\n  var SSFdnthresh = SSFbasedate.getTime();\n  var SSFbase1904 = new Date(1900, 2, 1, 0, 0, 0);\n  function datenum_local(v, date1904) {\n    var epoch = v.getTime();\n    if (date1904) epoch -= 1461 * 24 * 60 * 60 * 1000;else if (v >= SSFbase1904) epoch += 24 * 60 * 60 * 1000;\n    return (epoch - (SSFdnthresh + (v.getTimezoneOffset() - SSFbasedate.getTimezoneOffset()) * 60000)) / (24 * 60 * 60 * 1000);\n  }\n  /* ECMA-376 18.8.30 numFmt*/\n  /* Note: `toPrecision` uses standard form when prec > E and E >= -6 */\n  /* exponent >= -9 and <= 9 */\n  function SSF_strip_decimal(o) {\n    return o.indexOf(\".\") == -1 ? o : o.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)$/, \"$1\");\n  }\n\n  /* General Exponential always shows 2 digits exp and trims the mantissa */\n  function SSF_normalize_exp(o) {\n    if (o.indexOf(\"E\") == -1) return o;\n    return o.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)[Ee]/, \"$1E\").replace(/(E[+-])(\\d)$/, \"$10$2\");\n  }\n\n  /* exponent >= -9 and <= 9 */\n  function SSF_small_exp(v) {\n    var w = v < 0 ? 12 : 11;\n    var o = SSF_strip_decimal(v.toFixed(12));\n    if (o.length <= w) return o;\n    o = v.toPrecision(10);\n    if (o.length <= w) return o;\n    return v.toExponential(5);\n  }\n\n  /* exponent >= 11 or <= -10 likely exponential */\n  function SSF_large_exp(v) {\n    var o = SSF_strip_decimal(v.toFixed(11));\n    return o.length > (v < 0 ? 12 : 11) || o === \"0\" || o === \"-0\" ? v.toPrecision(6) : o;\n  }\n  function SSF_general_num(v) {\n    var V = Math.floor(Math.log(Math.abs(v)) * Math.LOG10E),\n      o;\n    if (V >= -4 && V <= -1) o = v.toPrecision(10 + V);else if (Math.abs(V) <= 9) o = SSF_small_exp(v);else if (V === 10) o = v.toFixed(10).substr(0, 12);else o = SSF_large_exp(v);\n    return SSF_strip_decimal(SSF_normalize_exp(o.toUpperCase()));\n  }\n\n  /*\n  \t\"General\" rules:\n  \t- text is passed through (\"@\")\n  \t- booleans are rendered as TRUE/FALSE\n  \t- \"up to 11 characters\" displayed for numbers\n  \t- Default date format (code 14) used for Dates\n  \n  \tThe longest 32-bit integer text is \"-2147483648\", exactly 11 chars\n  \tTODO: technically the display depends on the width of the cell\n  */\n  function SSF_general(v, opts) {\n    switch (typeof v) {\n      case 'string':\n        return v;\n      case 'boolean':\n        return v ? \"TRUE\" : \"FALSE\";\n      case 'number':\n        return (v | 0) === v ? v.toString(10) : SSF_general_num(v);\n      case 'undefined':\n        return \"\";\n      case 'object':\n        if (v == null) return \"\";\n        if (v instanceof Date) return SSF_format(14, datenum_local(v, opts && opts.date1904), opts);\n    }\n    throw new Error(\"unsupported value in General format: \" + v);\n  }\n  function SSF_fix_hijri(date, o) {\n    /* TODO: properly adjust y/m/d and  */\n    o[0] -= 581;\n    var dow = date.getDay();\n    if (date < 60) dow = (dow + 6) % 7;\n    return dow;\n  }\n  //var THAI_DIGITS = \"\\u0E50\\u0E51\\u0E52\\u0E53\\u0E54\\u0E55\\u0E56\\u0E57\\u0E58\\u0E59\".split(\"\");\n  function SSF_write_date(type, fmt, val, ss0) {\n    var o = \"\",\n      ss = 0,\n      tt = 0,\n      y = val.y,\n      out,\n      outl = 0;\n    switch (type) {\n      case 98:\n        /* 'b' buddhist year */\n        y = val.y + 543;\n      /* falls through */\n      case 121:\n        /* 'y' year */\n        switch (fmt.length) {\n          case 1:\n          case 2:\n            out = y % 100;\n            outl = 2;\n            break;\n          default:\n            out = y % 10000;\n            outl = 4;\n            break;\n        }\n        break;\n      case 109:\n        /* 'm' month */\n        switch (fmt.length) {\n          case 1:\n          case 2:\n            out = val.m;\n            outl = fmt.length;\n            break;\n          case 3:\n            return months[val.m - 1][1];\n          case 5:\n            return months[val.m - 1][0];\n          default:\n            return months[val.m - 1][2];\n        }\n        break;\n      case 100:\n        /* 'd' day */\n        switch (fmt.length) {\n          case 1:\n          case 2:\n            out = val.d;\n            outl = fmt.length;\n            break;\n          case 3:\n            return days[val.q][0];\n          default:\n            return days[val.q][1];\n        }\n        break;\n      case 104:\n        /* 'h' 12-hour */\n        switch (fmt.length) {\n          case 1:\n          case 2:\n            out = 1 + (val.H + 11) % 12;\n            outl = fmt.length;\n            break;\n          default:\n            throw 'bad hour format: ' + fmt;\n        }\n        break;\n      case 72:\n        /* 'H' 24-hour */\n        switch (fmt.length) {\n          case 1:\n          case 2:\n            out = val.H;\n            outl = fmt.length;\n            break;\n          default:\n            throw 'bad hour format: ' + fmt;\n        }\n        break;\n      case 77:\n        /* 'M' minutes */\n        switch (fmt.length) {\n          case 1:\n          case 2:\n            out = val.M;\n            outl = fmt.length;\n            break;\n          default:\n            throw 'bad minute format: ' + fmt;\n        }\n        break;\n      case 115:\n        /* 's' seconds */\n        if (fmt != 's' && fmt != 'ss' && fmt != '.0' && fmt != '.00' && fmt != '.000') throw 'bad second format: ' + fmt;\n        if (val.u === 0 && (fmt == \"s\" || fmt == \"ss\")) return pad0(val.S, fmt.length);\n        if (ss0 >= 2) tt = ss0 === 3 ? 1000 : 100;else tt = ss0 === 1 ? 10 : 1;\n        ss = Math.round(tt * (val.S + val.u));\n        if (ss >= 60 * tt) ss = 0;\n        if (fmt === 's') return ss === 0 ? \"0\" : \"\" + ss / tt;\n        o = pad0(ss, 2 + ss0);\n        if (fmt === 'ss') return o.substr(0, 2);\n        return \".\" + o.substr(2, fmt.length - 1);\n      case 90:\n        /* 'Z' absolute time */\n        switch (fmt) {\n          case '[h]':\n          case '[hh]':\n            out = val.D * 24 + val.H;\n            break;\n          case '[m]':\n          case '[mm]':\n            out = (val.D * 24 + val.H) * 60 + val.M;\n            break;\n          case '[s]':\n          case '[ss]':\n            out = ((val.D * 24 + val.H) * 60 + val.M) * 60 + Math.round(val.S + val.u);\n            break;\n          default:\n            throw 'bad abstime format: ' + fmt;\n        }\n        outl = fmt.length === 3 ? 1 : 2;\n        break;\n      case 101:\n        /* 'e' era */\n        out = y;\n        outl = 1;\n        break;\n    }\n    var outstr = outl > 0 ? pad0(out, outl) : \"\";\n    return outstr;\n  }\n\n  /*jshint -W086 */\n  /*jshint +W086 */\n  function commaify(s) {\n    var w = 3;\n    if (s.length <= w) return s;\n    var j = s.length % w,\n      o = s.substr(0, j);\n    for (; j != s.length; j += w) o += (o.length > 0 ? \",\" : \"\") + s.substr(j, w);\n    return o;\n  }\n  var pct1 = /%/g;\n  function write_num_pct(type, fmt, val) {\n    var sfmt = fmt.replace(pct1, \"\"),\n      mul = fmt.length - sfmt.length;\n    return write_num(type, sfmt, val * Math.pow(10, 2 * mul)) + fill(\"%\", mul);\n  }\n  function write_num_cm(type, fmt, val) {\n    var idx = fmt.length - 1;\n    while (fmt.charCodeAt(idx - 1) === 44) --idx;\n    return write_num(type, fmt.substr(0, idx), val / Math.pow(10, 3 * (fmt.length - idx)));\n  }\n  function write_num_exp(fmt, val) {\n    var o;\n    var idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n    if (fmt.match(/^#+0.0E\\+0$/)) {\n      if (val == 0) return \"0.0E+0\";else if (val < 0) return \"-\" + write_num_exp(fmt, -val);\n      var period = fmt.indexOf(\".\");\n      if (period === -1) period = fmt.indexOf('E');\n      var ee = Math.floor(Math.log(val) * Math.LOG10E) % period;\n      if (ee < 0) ee += period;\n      o = (val / Math.pow(10, ee)).toPrecision(idx + 1 + (period + ee) % period);\n      if (o.indexOf(\"e\") === -1) {\n        var fakee = Math.floor(Math.log(val) * Math.LOG10E);\n        if (o.indexOf(\".\") === -1) o = o.charAt(0) + \".\" + o.substr(1) + \"E+\" + (fakee - o.length + ee);else o += \"E+\" + (fakee - ee);\n        while (o.substr(0, 2) === \"0.\") {\n          o = o.charAt(0) + o.substr(2, period) + \".\" + o.substr(2 + period);\n          o = o.replace(/^0+([1-9])/, \"$1\").replace(/^0+\\./, \"0.\");\n        }\n        o = o.replace(/\\+-/, \"-\");\n      }\n      o = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/, function ($$, $1, $2, $3) {\n        return $1 + $2 + $3.substr(0, (period + ee) % period) + \".\" + $3.substr(ee) + \"E\";\n      });\n    } else o = val.toExponential(idx);\n    if (fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0, o.length - 1) + \"0\" + o.charAt(o.length - 1);\n    if (fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/, \"e\");\n    return o.replace(\"e\", \"E\");\n  }\n  var frac1 = /# (\\?+)( ?)\\/( ?)(\\d+)/;\n  function write_num_f1(r, aval, sign) {\n    var den = parseInt(r[4], 10),\n      rr = Math.round(aval * den),\n      base = Math.floor(rr / den);\n    var myn = rr - base * den,\n      myd = den;\n    return sign + (base === 0 ? \"\" : \"\" + base) + \" \" + (myn === 0 ? fill(\" \", r[1].length + 1 + r[4].length) : pad_(myn, r[1].length) + r[2] + \"/\" + r[3] + pad0(myd, r[4].length));\n  }\n  function write_num_f2(r, aval, sign) {\n    return sign + (aval === 0 ? \"\" : \"\" + aval) + fill(\" \", r[1].length + 2 + r[4].length);\n  }\n  var dec1 = /^#*0*\\.([0#]+)/;\n  var closeparen = /\\).*[0#]/;\n  var phone = /\\(###\\) ###\\\\?-####/;\n  function hashq(str) {\n    var o = \"\",\n      cc;\n    for (var i = 0; i != str.length; ++i) switch (cc = str.charCodeAt(i)) {\n      case 35:\n        break;\n      case 63:\n        o += \" \";\n        break;\n      case 48:\n        o += \"0\";\n        break;\n      default:\n        o += String.fromCharCode(cc);\n    }\n    return o;\n  }\n  function rnd(val, d) {\n    var dd = Math.pow(10, d);\n    return \"\" + Math.round(val * dd) / dd;\n  }\n  function dec(val, d) {\n    var _frac = val - Math.floor(val),\n      dd = Math.pow(10, d);\n    if (d < ('' + Math.round(_frac * dd)).length) return 0;\n    return Math.round(_frac * dd);\n  }\n  function carry(val, d) {\n    if (d < ('' + Math.round((val - Math.floor(val)) * Math.pow(10, d))).length) {\n      return 1;\n    }\n    return 0;\n  }\n  function flr(val) {\n    if (val < 2147483647 && val > -2147483648) return \"\" + (val >= 0 ? val | 0 : val - 1 | 0);\n    return \"\" + Math.floor(val);\n  }\n  function write_num_flt(type, fmt, val) {\n    if (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n      var ffmt = fmt.replace(/\\( */, \"\").replace(/ \\)/, \"\").replace(/\\)/, \"\");\n      if (val >= 0) return write_num_flt('n', ffmt, val);\n      return '(' + write_num_flt('n', ffmt, -val) + ')';\n    }\n    if (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);\n    if (fmt.indexOf('%') !== -1) return write_num_pct(type, fmt, val);\n    if (fmt.indexOf('E') !== -1) return write_num_exp(fmt, val);\n    if (fmt.charCodeAt(0) === 36) return \"$\" + write_num_flt(type, fmt.substr(fmt.charAt(1) == ' ' ? 2 : 1), val);\n    var o;\n    var r,\n      ri,\n      ff,\n      aval = Math.abs(val),\n      sign = val < 0 ? \"-\" : \"\";\n    if (fmt.match(/^00+$/)) return sign + pad0r(aval, fmt.length);\n    if (fmt.match(/^[#?]+$/)) {\n      o = pad0r(val, 0);\n      if (o === \"0\") o = \"\";\n      return o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;\n    }\n    if (r = fmt.match(frac1)) return write_num_f1(r, aval, sign);\n    if (fmt.match(/^#+0+$/)) return sign + pad0r(aval, fmt.length - fmt.indexOf(\"0\"));\n    if (r = fmt.match(dec1)) {\n      o = rnd(val, r[1].length).replace(/^([^\\.]+)$/, \"$1.\" + hashq(r[1])).replace(/\\.$/, \".\" + hashq(r[1])).replace(/\\.(\\d*)$/, function ($$, $1) {\n        return \".\" + $1 + fill(\"0\", hashq(r[1]).length - $1.length);\n      });\n      return fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./, \".\");\n    }\n    fmt = fmt.replace(/^#+([0.])/, \"$1\");\n    if (r = fmt.match(/^(0*)\\.(#*)$/)) {\n      return sign + rnd(aval, r[2].length).replace(/\\.(\\d*[1-9])0*$/, \".$1\").replace(/^(-?\\d*)$/, \"$1.\").replace(/^0\\./, r[1].length ? \"0.\" : \".\");\n    }\n    if (r = fmt.match(/^#{1,3},##0(\\.?)$/)) return sign + commaify(pad0r(aval, 0));\n    if (r = fmt.match(/^#,##0\\.([#0]*0)$/)) {\n      return val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(\"\" + (Math.floor(val) + carry(val, r[1].length))) + \".\" + pad0(dec(val, r[1].length), r[1].length);\n    }\n    if (r = fmt.match(/^#,#*,#0/)) return write_num_flt(type, fmt.replace(/^#,#*,/, \"\"), val);\n    if (r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) {\n      o = _strrev(write_num_flt(type, fmt.replace(/[\\\\-]/g, \"\"), val));\n      ri = 0;\n      return _strrev(_strrev(fmt.replace(/\\\\/g, \"\")).replace(/[0#]/g, function (x) {\n        return ri < o.length ? o.charAt(ri++) : x === '0' ? '0' : \"\";\n      }));\n    }\n    if (fmt.match(phone)) {\n      o = write_num_flt(type, \"##########\", val);\n      return \"(\" + o.substr(0, 3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n    }\n    var oa = \"\";\n    if (r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) {\n      ri = Math.min(r[4].length, 7);\n      ff = SSF_frac(aval, Math.pow(10, ri) - 1, false);\n      o = \"\" + sign;\n      oa = write_num(\"n\", r[1], ff[1]);\n      if (oa.charAt(oa.length - 1) == \" \") oa = oa.substr(0, oa.length - 1) + \"0\";\n      o += oa + r[2] + \"/\" + r[3];\n      oa = rpad_(ff[2], ri);\n      if (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;\n      o += oa;\n      return o;\n    }\n    if (r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) {\n      ri = Math.min(Math.max(r[1].length, r[4].length), 7);\n      ff = SSF_frac(aval, Math.pow(10, ri) - 1, true);\n      return sign + (ff[0] || (ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1], ri) + r[2] + \"/\" + r[3] + rpad_(ff[2], ri) : fill(\" \", 2 * ri + 1 + r[2].length + r[3].length));\n    }\n    if (r = fmt.match(/^[#0?]+$/)) {\n      o = pad0r(val, 0);\n      if (fmt.length <= o.length) return o;\n      return hashq(fmt.substr(0, fmt.length - o.length)) + o;\n    }\n    if (r = fmt.match(/^([#0?]+)\\.([#0]+)$/)) {\n      o = \"\" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, \"$1\");\n      ri = o.indexOf(\".\");\n      var lres = fmt.indexOf(\".\") - ri,\n        rres = fmt.length - o.length - lres;\n      return hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));\n    }\n    if (r = fmt.match(/^00,000\\.([#0]*0)$/)) {\n      ri = dec(val, r[1].length);\n      return val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(flr(val)).replace(/^\\d,\\d{3}$/, \"0$&\").replace(/^\\d*$/, function ($$) {\n        return \"00,\" + ($$.length < 3 ? pad0(0, 3 - $$.length) : \"\") + $$;\n      }) + \".\" + pad0(ri, r[1].length);\n    }\n    switch (fmt) {\n      case \"###,##0.00\":\n        return write_num_flt(type, \"#,##0.00\", val);\n      case \"###,###\":\n      case \"##,###\":\n      case \"#,###\":\n        var x = commaify(pad0r(aval, 0));\n        return x !== \"0\" ? sign + x : \"\";\n      case \"###,###.00\":\n        return write_num_flt(type, \"###,##0.00\", val).replace(/^0\\./, \".\");\n      case \"#,###.00\":\n        return write_num_flt(type, \"#,##0.00\", val).replace(/^0\\./, \".\");\n      default:\n    }\n    throw new Error(\"unsupported format |\" + fmt + \"|\");\n  }\n  function write_num_cm2(type, fmt, val) {\n    var idx = fmt.length - 1;\n    while (fmt.charCodeAt(idx - 1) === 44) --idx;\n    return write_num(type, fmt.substr(0, idx), val / Math.pow(10, 3 * (fmt.length - idx)));\n  }\n  function write_num_pct2(type, fmt, val) {\n    var sfmt = fmt.replace(pct1, \"\"),\n      mul = fmt.length - sfmt.length;\n    return write_num(type, sfmt, val * Math.pow(10, 2 * mul)) + fill(\"%\", mul);\n  }\n  function write_num_exp2(fmt, val) {\n    var o;\n    var idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n    if (fmt.match(/^#+0.0E\\+0$/)) {\n      if (val == 0) return \"0.0E+0\";else if (val < 0) return \"-\" + write_num_exp2(fmt, -val);\n      var period = fmt.indexOf(\".\");\n      if (period === -1) period = fmt.indexOf('E');\n      var ee = Math.floor(Math.log(val) * Math.LOG10E) % period;\n      if (ee < 0) ee += period;\n      o = (val / Math.pow(10, ee)).toPrecision(idx + 1 + (period + ee) % period);\n      if (!o.match(/[Ee]/)) {\n        var fakee = Math.floor(Math.log(val) * Math.LOG10E);\n        if (o.indexOf(\".\") === -1) o = o.charAt(0) + \".\" + o.substr(1) + \"E+\" + (fakee - o.length + ee);else o += \"E+\" + (fakee - ee);\n        o = o.replace(/\\+-/, \"-\");\n      }\n      o = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/, function ($$, $1, $2, $3) {\n        return $1 + $2 + $3.substr(0, (period + ee) % period) + \".\" + $3.substr(ee) + \"E\";\n      });\n    } else o = val.toExponential(idx);\n    if (fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0, o.length - 1) + \"0\" + o.charAt(o.length - 1);\n    if (fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/, \"e\");\n    return o.replace(\"e\", \"E\");\n  }\n  function write_num_int(type, fmt, val) {\n    if (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n      var ffmt = fmt.replace(/\\( */, \"\").replace(/ \\)/, \"\").replace(/\\)/, \"\");\n      if (val >= 0) return write_num_int('n', ffmt, val);\n      return '(' + write_num_int('n', ffmt, -val) + ')';\n    }\n    if (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm2(type, fmt, val);\n    if (fmt.indexOf('%') !== -1) return write_num_pct2(type, fmt, val);\n    if (fmt.indexOf('E') !== -1) return write_num_exp2(fmt, val);\n    if (fmt.charCodeAt(0) === 36) return \"$\" + write_num_int(type, fmt.substr(fmt.charAt(1) == ' ' ? 2 : 1), val);\n    var o;\n    var r,\n      ri,\n      ff,\n      aval = Math.abs(val),\n      sign = val < 0 ? \"-\" : \"\";\n    if (fmt.match(/^00+$/)) return sign + pad0(aval, fmt.length);\n    if (fmt.match(/^[#?]+$/)) {\n      o = \"\" + val;\n      if (val === 0) o = \"\";\n      return o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;\n    }\n    if (r = fmt.match(frac1)) return write_num_f2(r, aval, sign);\n    if (fmt.match(/^#+0+$/)) return sign + pad0(aval, fmt.length - fmt.indexOf(\"0\"));\n    if (r = fmt.match(dec1)) {\n      o = (\"\" + val).replace(/^([^\\.]+)$/, \"$1.\" + hashq(r[1])).replace(/\\.$/, \".\" + hashq(r[1]));\n      o = o.replace(/\\.(\\d*)$/, function ($$, $1) {\n        return \".\" + $1 + fill(\"0\", hashq(r[1]).length - $1.length);\n      });\n      return fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./, \".\");\n    }\n    fmt = fmt.replace(/^#+([0.])/, \"$1\");\n    if (r = fmt.match(/^(0*)\\.(#*)$/)) {\n      return sign + (\"\" + aval).replace(/\\.(\\d*[1-9])0*$/, \".$1\").replace(/^(-?\\d*)$/, \"$1.\").replace(/^0\\./, r[1].length ? \"0.\" : \".\");\n    }\n    if (r = fmt.match(/^#{1,3},##0(\\.?)$/)) return sign + commaify(\"\" + aval);\n    if (r = fmt.match(/^#,##0\\.([#0]*0)$/)) {\n      return val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\" + val) + \".\" + fill('0', r[1].length);\n    }\n    if (r = fmt.match(/^#,#*,#0/)) return write_num_int(type, fmt.replace(/^#,#*,/, \"\"), val);\n    if (r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) {\n      o = _strrev(write_num_int(type, fmt.replace(/[\\\\-]/g, \"\"), val));\n      ri = 0;\n      return _strrev(_strrev(fmt.replace(/\\\\/g, \"\")).replace(/[0#]/g, function (x) {\n        return ri < o.length ? o.charAt(ri++) : x === '0' ? '0' : \"\";\n      }));\n    }\n    if (fmt.match(phone)) {\n      o = write_num_int(type, \"##########\", val);\n      return \"(\" + o.substr(0, 3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n    }\n    var oa = \"\";\n    if (r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) {\n      ri = Math.min(r[4].length, 7);\n      ff = SSF_frac(aval, Math.pow(10, ri) - 1, false);\n      o = \"\" + sign;\n      oa = write_num(\"n\", r[1], ff[1]);\n      if (oa.charAt(oa.length - 1) == \" \") oa = oa.substr(0, oa.length - 1) + \"0\";\n      o += oa + r[2] + \"/\" + r[3];\n      oa = rpad_(ff[2], ri);\n      if (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;\n      o += oa;\n      return o;\n    }\n    if (r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) {\n      ri = Math.min(Math.max(r[1].length, r[4].length), 7);\n      ff = SSF_frac(aval, Math.pow(10, ri) - 1, true);\n      return sign + (ff[0] || (ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1], ri) + r[2] + \"/\" + r[3] + rpad_(ff[2], ri) : fill(\" \", 2 * ri + 1 + r[2].length + r[3].length));\n    }\n    if (r = fmt.match(/^[#0?]+$/)) {\n      o = \"\" + val;\n      if (fmt.length <= o.length) return o;\n      return hashq(fmt.substr(0, fmt.length - o.length)) + o;\n    }\n    if (r = fmt.match(/^([#0]+)\\.([#0]+)$/)) {\n      o = \"\" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, \"$1\");\n      ri = o.indexOf(\".\");\n      var lres = fmt.indexOf(\".\") - ri,\n        rres = fmt.length - o.length - lres;\n      return hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));\n    }\n    if (r = fmt.match(/^00,000\\.([#0]*0)$/)) {\n      return val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\" + val).replace(/^\\d,\\d{3}$/, \"0$&\").replace(/^\\d*$/, function ($$) {\n        return \"00,\" + ($$.length < 3 ? pad0(0, 3 - $$.length) : \"\") + $$;\n      }) + \".\" + pad0(0, r[1].length);\n    }\n    switch (fmt) {\n      case \"###,###\":\n      case \"##,###\":\n      case \"#,###\":\n        var x = commaify(\"\" + aval);\n        return x !== \"0\" ? sign + x : \"\";\n      default:\n        if (fmt.match(/\\.[0#?]*$/)) return write_num_int(type, fmt.slice(0, fmt.lastIndexOf(\".\")), val) + hashq(fmt.slice(fmt.lastIndexOf(\".\")));\n    }\n    throw new Error(\"unsupported format |\" + fmt + \"|\");\n  }\n  function write_num(type, fmt, val) {\n    return (val | 0) === val ? write_num_int(type, fmt, val) : write_num_flt(type, fmt, val);\n  }\n  function SSF_split_fmt(fmt) {\n    var out = [];\n    var in_str = false /*, cc*/;\n    for (var i = 0, j = 0; i < fmt.length; ++i) switch ( /*cc=*/fmt.charCodeAt(i)) {\n      case 34:\n        /* '\"' */\n        in_str = !in_str;\n        break;\n      case 95:\n      case 42:\n      case 92:\n        /* '_' '*' '\\\\' */\n        ++i;\n        break;\n      case 59:\n        /* ';' */\n        out[out.length] = fmt.substr(j, i - j);\n        j = i + 1;\n    }\n    out[out.length] = fmt.substr(j);\n    if (in_str === true) throw new Error(\"Format |\" + fmt + \"| unterminated string \");\n    return out;\n  }\n  var SSF_abstime = /\\[[HhMmSs\\u0E0A\\u0E19\\u0E17]*\\]/;\n  function fmt_is_date(fmt) {\n    var i = 0,\n      /*cc = 0,*/c = \"\",\n      o = \"\";\n    while (i < fmt.length) {\n      switch (c = fmt.charAt(i)) {\n        case 'G':\n          if (SSF_isgeneral(fmt, i)) i += 6;\n          i++;\n          break;\n        case '\"':\n          for (; /*cc=*/fmt.charCodeAt(++i) !== 34 && i < fmt.length;) {/*empty*/}\n          ++i;\n          break;\n        case '\\\\':\n          i += 2;\n          break;\n        case '_':\n          i += 2;\n          break;\n        case '@':\n          ++i;\n          break;\n        case 'B':\n        case 'b':\n          if (fmt.charAt(i + 1) === \"1\" || fmt.charAt(i + 1) === \"2\") return true;\n        /* falls through */\n        case 'M':\n        case 'D':\n        case 'Y':\n        case 'H':\n        case 'S':\n        case 'E':\n        /* falls through */\n        case 'm':\n        case 'd':\n        case 'y':\n        case 'h':\n        case 's':\n        case 'e':\n        case 'g':\n          return true;\n        case 'A':\n        case 'a':\n        case '上':\n          if (fmt.substr(i, 3).toUpperCase() === \"A/P\") return true;\n          if (fmt.substr(i, 5).toUpperCase() === \"AM/PM\") return true;\n          if (fmt.substr(i, 5).toUpperCase() === \"上午/下午\") return true;\n          ++i;\n          break;\n        case '[':\n          o = c;\n          while (fmt.charAt(i++) !== ']' && i < fmt.length) o += fmt.charAt(i);\n          if (o.match(SSF_abstime)) return true;\n          break;\n        case '.':\n        /* falls through */\n        case '0':\n        case '#':\n          while (i < fmt.length && (\"0#?.,E+-%\".indexOf(c = fmt.charAt(++i)) > -1 || c == '\\\\' && fmt.charAt(i + 1) == \"-\" && \"0#\".indexOf(fmt.charAt(i + 2)) > -1)) {/* empty */}\n          break;\n        case '?':\n          while (fmt.charAt(++i) === c) {/* empty */}\n          break;\n        case '*':\n          ++i;\n          if (fmt.charAt(i) == ' ' || fmt.charAt(i) == '*') ++i;\n          break;\n        case '(':\n        case ')':\n          ++i;\n          break;\n        case '1':\n        case '2':\n        case '3':\n        case '4':\n        case '5':\n        case '6':\n        case '7':\n        case '8':\n        case '9':\n          while (i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1) {/* empty */}\n          break;\n        case ' ':\n          ++i;\n          break;\n        default:\n          ++i;\n          break;\n      }\n    }\n    return false;\n  }\n  function eval_fmt(fmt, v, opts, flen) {\n    var out = [],\n      o = \"\",\n      i = 0,\n      c = \"\",\n      lst = 't',\n      dt,\n      j,\n      cc;\n    var hr = 'H';\n    /* Tokenize */\n    while (i < fmt.length) {\n      switch (c = fmt.charAt(i)) {\n        case 'G':\n          /* General */\n          if (!SSF_isgeneral(fmt, i)) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n          out[out.length] = {\n            t: 'G',\n            v: 'General'\n          };\n          i += 7;\n          break;\n        case '\"':\n          /* Literal text */\n          for (o = \"\"; (cc = fmt.charCodeAt(++i)) !== 34 && i < fmt.length;) o += String.fromCharCode(cc);\n          out[out.length] = {\n            t: 't',\n            v: o\n          };\n          ++i;\n          break;\n        case '\\\\':\n          var w = fmt.charAt(++i),\n            t = w === \"(\" || w === \")\" ? w : 't';\n          out[out.length] = {\n            t: t,\n            v: w\n          };\n          ++i;\n          break;\n        case '_':\n          out[out.length] = {\n            t: 't',\n            v: \" \"\n          };\n          i += 2;\n          break;\n        case '@':\n          /* Text Placeholder */\n          out[out.length] = {\n            t: 'T',\n            v: v\n          };\n          ++i;\n          break;\n        case 'B':\n        case 'b':\n          if (fmt.charAt(i + 1) === \"1\" || fmt.charAt(i + 1) === \"2\") {\n            if (dt == null) {\n              dt = SSF_parse_date_code(v, opts, fmt.charAt(i + 1) === \"2\");\n              if (dt == null) return \"\";\n            }\n            out[out.length] = {\n              t: 'X',\n              v: fmt.substr(i, 2)\n            };\n            lst = c;\n            i += 2;\n            break;\n          }\n        /* falls through */\n        case 'M':\n        case 'D':\n        case 'Y':\n        case 'H':\n        case 'S':\n        case 'E':\n          c = c.toLowerCase();\n        /* falls through */\n        case 'm':\n        case 'd':\n        case 'y':\n        case 'h':\n        case 's':\n        case 'e':\n        case 'g':\n          if (v < 0) return \"\";\n          if (dt == null) {\n            dt = SSF_parse_date_code(v, opts);\n            if (dt == null) return \"\";\n          }\n          o = c;\n          while (++i < fmt.length && fmt.charAt(i).toLowerCase() === c) o += c;\n          if (c === 'm' && lst.toLowerCase() === 'h') c = 'M';\n          if (c === 'h') c = hr;\n          out[out.length] = {\n            t: c,\n            v: o\n          };\n          lst = c;\n          break;\n        case 'A':\n        case 'a':\n        case '上':\n          var q = {\n            t: c,\n            v: c\n          };\n          if (dt == null) dt = SSF_parse_date_code(v, opts);\n          if (fmt.substr(i, 3).toUpperCase() === \"A/P\") {\n            if (dt != null) q.v = dt.H >= 12 ? \"P\" : \"A\";\n            q.t = 'T';\n            hr = 'h';\n            i += 3;\n          } else if (fmt.substr(i, 5).toUpperCase() === \"AM/PM\") {\n            if (dt != null) q.v = dt.H >= 12 ? \"PM\" : \"AM\";\n            q.t = 'T';\n            i += 5;\n            hr = 'h';\n          } else if (fmt.substr(i, 5).toUpperCase() === \"上午/下午\") {\n            if (dt != null) q.v = dt.H >= 12 ? \"下午\" : \"上午\";\n            q.t = 'T';\n            i += 5;\n            hr = 'h';\n          } else {\n            q.t = \"t\";\n            ++i;\n          }\n          if (dt == null && q.t === 'T') return \"\";\n          out[out.length] = q;\n          lst = c;\n          break;\n        case '[':\n          o = c;\n          while (fmt.charAt(i++) !== ']' && i < fmt.length) o += fmt.charAt(i);\n          if (o.slice(-1) !== ']') throw 'unterminated \"[\" block: |' + o + '|';\n          if (o.match(SSF_abstime)) {\n            if (dt == null) {\n              dt = SSF_parse_date_code(v, opts);\n              if (dt == null) return \"\";\n            }\n            out[out.length] = {\n              t: 'Z',\n              v: o.toLowerCase()\n            };\n            lst = o.charAt(1);\n          } else if (o.indexOf(\"$\") > -1) {\n            o = (o.match(/\\$([^-\\[\\]]*)/) || [])[1] || \"$\";\n            if (!fmt_is_date(fmt)) out[out.length] = {\n              t: 't',\n              v: o\n            };\n          }\n          break;\n        /* Numbers */\n        case '.':\n          if (dt != null) {\n            o = c;\n            while (++i < fmt.length && (c = fmt.charAt(i)) === \"0\") o += c;\n            out[out.length] = {\n              t: 's',\n              v: o\n            };\n            break;\n          }\n        /* falls through */\n        case '0':\n        case '#':\n          o = c;\n          while (++i < fmt.length && \"0#?.,E+-%\".indexOf(c = fmt.charAt(i)) > -1) o += c;\n          out[out.length] = {\n            t: 'n',\n            v: o\n          };\n          break;\n        case '?':\n          o = c;\n          while (fmt.charAt(++i) === c) o += c;\n          out[out.length] = {\n            t: c,\n            v: o\n          };\n          lst = c;\n          break;\n        case '*':\n          ++i;\n          if (fmt.charAt(i) == ' ' || fmt.charAt(i) == '*') ++i;\n          break;\n        // **\n        case '(':\n        case ')':\n          out[out.length] = {\n            t: flen === 1 ? 't' : c,\n            v: c\n          };\n          ++i;\n          break;\n        case '1':\n        case '2':\n        case '3':\n        case '4':\n        case '5':\n        case '6':\n        case '7':\n        case '8':\n        case '9':\n          o = c;\n          while (i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1) o += fmt.charAt(i);\n          out[out.length] = {\n            t: 'D',\n            v: o\n          };\n          break;\n        case ' ':\n          out[out.length] = {\n            t: c,\n            v: c\n          };\n          ++i;\n          break;\n        case '$':\n          out[out.length] = {\n            t: 't',\n            v: '$'\n          };\n          ++i;\n          break;\n        default:\n          if (\",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP\".indexOf(c) === -1) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n          out[out.length] = {\n            t: 't',\n            v: c\n          };\n          ++i;\n          break;\n      }\n    }\n\n    /* Scan for date/time parts */\n    var bt = 0,\n      ss0 = 0,\n      ssm;\n    for (i = out.length - 1, lst = 't'; i >= 0; --i) {\n      switch (out[i].t) {\n        case 'h':\n        case 'H':\n          out[i].t = hr;\n          lst = 'h';\n          if (bt < 1) bt = 1;\n          break;\n        case 's':\n          if (ssm = out[i].v.match(/\\.0+$/)) ss0 = Math.max(ss0, ssm[0].length - 1);\n          if (bt < 3) bt = 3;\n        /* falls through */\n        case 'd':\n        case 'y':\n        case 'M':\n        case 'e':\n          lst = out[i].t;\n          break;\n        case 'm':\n          if (lst === 's') {\n            out[i].t = 'M';\n            if (bt < 2) bt = 2;\n          }\n          break;\n        case 'X':\n          /*if(out[i].v === \"B2\");*/\n          break;\n        case 'Z':\n          if (bt < 1 && out[i].v.match(/[Hh]/)) bt = 1;\n          if (bt < 2 && out[i].v.match(/[Mm]/)) bt = 2;\n          if (bt < 3 && out[i].v.match(/[Ss]/)) bt = 3;\n      }\n    }\n    /* time rounding depends on presence of minute / second / usec fields */\n    switch (bt) {\n      case 0:\n        break;\n      case 1:\n        if (dt.u >= 0.5) {\n          dt.u = 0;\n          ++dt.S;\n        }\n        if (dt.S >= 60) {\n          dt.S = 0;\n          ++dt.M;\n        }\n        if (dt.M >= 60) {\n          dt.M = 0;\n          ++dt.H;\n        }\n        break;\n      case 2:\n        if (dt.u >= 0.5) {\n          dt.u = 0;\n          ++dt.S;\n        }\n        if (dt.S >= 60) {\n          dt.S = 0;\n          ++dt.M;\n        }\n        break;\n    }\n\n    /* replace fields */\n    var nstr = \"\",\n      jj;\n    for (i = 0; i < out.length; ++i) {\n      switch (out[i].t) {\n        case 't':\n        case 'T':\n        case ' ':\n        case 'D':\n          break;\n        case 'X':\n          out[i].v = \"\";\n          out[i].t = \";\";\n          break;\n        case 'd':\n        case 'm':\n        case 'y':\n        case 'h':\n        case 'H':\n        case 'M':\n        case 's':\n        case 'e':\n        case 'b':\n        case 'Z':\n          out[i].v = SSF_write_date(out[i].t.charCodeAt(0), out[i].v, dt, ss0);\n          out[i].t = 't';\n          break;\n        case 'n':\n        case '?':\n          jj = i + 1;\n          while (out[jj] != null && ((c = out[jj].t) === \"?\" || c === \"D\" || (c === \" \" || c === \"t\") && out[jj + 1] != null && (out[jj + 1].t === '?' || out[jj + 1].t === \"t\" && out[jj + 1].v === '/') || out[i].t === '(' && (c === ' ' || c === 'n' || c === ')') || c === 't' && (out[jj].v === '/' || out[jj].v === ' ' && out[jj + 1] != null && out[jj + 1].t == '?'))) {\n            out[i].v += out[jj].v;\n            out[jj] = {\n              v: \"\",\n              t: \";\"\n            };\n            ++jj;\n          }\n          nstr += out[i].v;\n          i = jj - 1;\n          break;\n        case 'G':\n          out[i].t = 't';\n          out[i].v = SSF_general(v, opts);\n          break;\n      }\n    }\n    var vv = \"\",\n      myv,\n      ostr;\n    if (nstr.length > 0) {\n      if (nstr.charCodeAt(0) == 40) /* '(' */{\n          myv = v < 0 && nstr.charCodeAt(0) === 45 ? -v : v;\n          ostr = write_num('n', nstr, myv);\n        } else {\n        myv = v < 0 && flen > 1 ? -v : v;\n        ostr = write_num('n', nstr, myv);\n        if (myv < 0 && out[0] && out[0].t == 't') {\n          ostr = ostr.substr(1);\n          out[0].v = \"-\" + out[0].v;\n        }\n      }\n      jj = ostr.length - 1;\n      var decpt = out.length;\n      for (i = 0; i < out.length; ++i) if (out[i] != null && out[i].t != 't' && out[i].v.indexOf(\".\") > -1) {\n        decpt = i;\n        break;\n      }\n      var lasti = out.length;\n      if (decpt === out.length && ostr.indexOf(\"E\") === -1) {\n        for (i = out.length - 1; i >= 0; --i) {\n          if (out[i] == null || 'n?'.indexOf(out[i].t) === -1) continue;\n          if (jj >= out[i].v.length - 1) {\n            jj -= out[i].v.length;\n            out[i].v = ostr.substr(jj + 1, out[i].v.length);\n          } else if (jj < 0) out[i].v = \"\";else {\n            out[i].v = ostr.substr(0, jj + 1);\n            jj = -1;\n          }\n          out[i].t = 't';\n          lasti = i;\n        }\n        if (jj >= 0 && lasti < out.length) out[lasti].v = ostr.substr(0, jj + 1) + out[lasti].v;\n      } else if (decpt !== out.length && ostr.indexOf(\"E\") === -1) {\n        jj = ostr.indexOf(\".\") - 1;\n        for (i = decpt; i >= 0; --i) {\n          if (out[i] == null || 'n?'.indexOf(out[i].t) === -1) continue;\n          j = out[i].v.indexOf(\".\") > -1 && i === decpt ? out[i].v.indexOf(\".\") - 1 : out[i].v.length - 1;\n          vv = out[i].v.substr(j + 1);\n          for (; j >= 0; --j) {\n            if (jj >= 0 && (out[i].v.charAt(j) === \"0\" || out[i].v.charAt(j) === \"#\")) vv = ostr.charAt(jj--) + vv;\n          }\n          out[i].v = vv;\n          out[i].t = 't';\n          lasti = i;\n        }\n        if (jj >= 0 && lasti < out.length) out[lasti].v = ostr.substr(0, jj + 1) + out[lasti].v;\n        jj = ostr.indexOf(\".\") + 1;\n        for (i = decpt; i < out.length; ++i) {\n          if (out[i] == null || 'n?('.indexOf(out[i].t) === -1 && i !== decpt) continue;\n          j = out[i].v.indexOf(\".\") > -1 && i === decpt ? out[i].v.indexOf(\".\") + 1 : 0;\n          vv = out[i].v.substr(0, j);\n          for (; j < out[i].v.length; ++j) {\n            if (jj < ostr.length) vv += ostr.charAt(jj++);\n          }\n          out[i].v = vv;\n          out[i].t = 't';\n          lasti = i;\n        }\n      }\n    }\n    for (i = 0; i < out.length; ++i) if (out[i] != null && 'n?'.indexOf(out[i].t) > -1) {\n      myv = flen > 1 && v < 0 && i > 0 && out[i - 1].v === \"-\" ? -v : v;\n      out[i].v = write_num(out[i].t, out[i].v, myv);\n      out[i].t = 't';\n    }\n    var retval = \"\";\n    for (i = 0; i !== out.length; ++i) if (out[i] != null) retval += out[i].v;\n    return retval;\n  }\n  var cfregex2 = /\\[(=|>[=]?|<[>=]?)(-?\\d+(?:\\.\\d*)?)\\]/;\n  function chkcond(v, rr) {\n    if (rr == null) return false;\n    var thresh = parseFloat(rr[2]);\n    switch (rr[1]) {\n      case \"=\":\n        if (v == thresh) return true;\n        break;\n      case \">\":\n        if (v > thresh) return true;\n        break;\n      case \"<\":\n        if (v < thresh) return true;\n        break;\n      case \"<>\":\n        if (v != thresh) return true;\n        break;\n      case \">=\":\n        if (v >= thresh) return true;\n        break;\n      case \"<=\":\n        if (v <= thresh) return true;\n        break;\n    }\n    return false;\n  }\n  function choose_fmt(f, v) {\n    var fmt = SSF_split_fmt(f);\n    var l = fmt.length,\n      lat = fmt[l - 1].indexOf(\"@\");\n    if (l < 4 && lat > -1) --l;\n    if (fmt.length > 4) throw new Error(\"cannot find right format for |\" + fmt.join(\"|\") + \"|\");\n    if (typeof v !== \"number\") return [4, fmt.length === 4 || lat > -1 ? fmt[fmt.length - 1] : \"@\"];\n    switch (fmt.length) {\n      case 1:\n        fmt = lat > -1 ? [\"General\", \"General\", \"General\", fmt[0]] : [fmt[0], fmt[0], fmt[0], \"@\"];\n        break;\n      case 2:\n        fmt = lat > -1 ? [fmt[0], fmt[0], fmt[0], fmt[1]] : [fmt[0], fmt[1], fmt[0], \"@\"];\n        break;\n      case 3:\n        fmt = lat > -1 ? [fmt[0], fmt[1], fmt[0], fmt[2]] : [fmt[0], fmt[1], fmt[2], \"@\"];\n        break;\n      case 4:\n        break;\n    }\n    var ff = v > 0 ? fmt[0] : v < 0 ? fmt[1] : fmt[2];\n    if (fmt[0].indexOf(\"[\") === -1 && fmt[1].indexOf(\"[\") === -1) return [l, ff];\n    if (fmt[0].match(/\\[[=<>]/) != null || fmt[1].match(/\\[[=<>]/) != null) {\n      var m1 = fmt[0].match(cfregex2);\n      var m2 = fmt[1].match(cfregex2);\n      return chkcond(v, m1) ? [l, fmt[0]] : chkcond(v, m2) ? [l, fmt[1]] : [l, fmt[m1 != null && m2 != null ? 2 : 1]];\n    }\n    return [l, ff];\n  }\n  function SSF_format(fmt, v, o) {\n    if (o == null) o = {};\n    var sfmt = \"\";\n    switch (typeof fmt) {\n      case \"string\":\n        if (fmt == \"m/d/yy\" && o.dateNF) sfmt = o.dateNF;else sfmt = fmt;\n        break;\n      case \"number\":\n        if (fmt == 14 && o.dateNF) sfmt = o.dateNF;else sfmt = (o.table != null ? o.table : table_fmt)[fmt];\n        if (sfmt == null) sfmt = o.table && o.table[SSF_default_map[fmt]] || table_fmt[SSF_default_map[fmt]];\n        if (sfmt == null) sfmt = SSF_default_str[fmt] || \"General\";\n        break;\n    }\n    if (SSF_isgeneral(sfmt, 0)) return SSF_general(v, o);\n    if (v instanceof Date) v = datenum_local(v, o.date1904);\n    var f = choose_fmt(sfmt, v);\n    if (SSF_isgeneral(f[1])) return SSF_general(v, o);\n    if (v === true) v = \"TRUE\";else if (v === false) v = \"FALSE\";else if (v === \"\" || v == null) return \"\";\n    return eval_fmt(f[1], v, o, f[0]);\n  }\n  function SSF_load(fmt, idx) {\n    if (typeof idx != 'number') {\n      idx = +idx || -1;\n      for (var i = 0; i < 0x0188; ++i) {\n        if (table_fmt[i] == undefined) {\n          if (idx < 0) idx = i;\n          continue;\n        }\n        if (table_fmt[i] == fmt) {\n          idx = i;\n          break;\n        }\n      }\n      if (idx < 0) idx = 0x187;\n    }\n    table_fmt[idx] = fmt;\n    return idx;\n  }\n  function SSF_load_table(tbl) {\n    for (var i = 0; i != 0x0188; ++i) if (tbl[i] !== undefined) SSF_load(tbl[i], i);\n  }\n  function make_ssf() {\n    table_fmt = SSF_init_table();\n  }\n  var SSF = {\n    format: SSF_format,\n    load: SSF_load,\n    _table: table_fmt,\n    load_table: SSF_load_table,\n    parse_date_code: SSF_parse_date_code,\n    is_date: fmt_is_date,\n    get_table: function get_table() {\n      return SSF._table = table_fmt;\n    }\n  };\n  var SSFImplicit /*{[number]:string}*/ = {\n    \"5\": '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n    \"6\": '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n    \"7\": '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n    \"8\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n    \"23\": 'General',\n    \"24\": 'General',\n    \"25\": 'General',\n    \"26\": 'General',\n    \"27\": 'm/d/yy',\n    \"28\": 'm/d/yy',\n    \"29\": 'm/d/yy',\n    \"30\": 'm/d/yy',\n    \"31\": 'm/d/yy',\n    \"32\": 'h:mm:ss',\n    \"33\": 'h:mm:ss',\n    \"34\": 'h:mm:ss',\n    \"35\": 'h:mm:ss',\n    \"36\": 'm/d/yy',\n    \"41\": '_(* #,##0_);_(* \\(#,##0\\);_(* \"-\"_);_(@_)',\n    \"42\": '_(\"$\"* #,##0_);_(\"$\"* \\(#,##0\\);_(\"$\"* \"-\"_);_(@_)',\n    \"43\": '_(* #,##0.00_);_(* \\(#,##0.00\\);_(* \"-\"??_);_(@_)',\n    \"44\": '_(\"$\"* #,##0.00_);_(\"$\"* \\(#,##0.00\\);_(\"$\"* \"-\"??_);_(@_)',\n    \"50\": 'm/d/yy',\n    \"51\": 'm/d/yy',\n    \"52\": 'm/d/yy',\n    \"53\": 'm/d/yy',\n    \"54\": 'm/d/yy',\n    \"55\": 'm/d/yy',\n    \"56\": 'm/d/yy',\n    \"57\": 'm/d/yy',\n    \"58\": 'm/d/yy',\n    \"59\": '0',\n    \"60\": '0.00',\n    \"61\": '#,##0',\n    \"62\": '#,##0.00',\n    \"63\": '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n    \"64\": '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n    \"65\": '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n    \"66\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n    \"67\": '0%',\n    \"68\": '0.00%',\n    \"69\": '# ?/?',\n    \"70\": '# ??/??',\n    \"71\": 'm/d/yy',\n    \"72\": 'm/d/yy',\n    \"73\": 'd-mmm-yy',\n    \"74\": 'd-mmm',\n    \"75\": 'mmm-yy',\n    \"76\": 'h:mm',\n    \"77\": 'h:mm:ss',\n    \"78\": 'm/d/yy h:mm',\n    \"79\": 'mm:ss',\n    \"80\": '[h]:mm:ss',\n    \"81\": 'mmss.0'\n  };\n\n  /* dateNF parse TODO: move to SSF */\n  var dateNFregex = /[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;\n  function dateNF_regex(dateNF) {\n    var fmt = typeof dateNF == \"number\" ? table_fmt[dateNF] : dateNF;\n    fmt = fmt.replace(dateNFregex, \"(\\\\d+)\");\n    return new RegExp(\"^\" + fmt + \"$\");\n  }\n  function dateNF_fix(str, dateNF, match) {\n    var Y = -1,\n      m = -1,\n      d = -1,\n      H = -1,\n      M = -1,\n      S = -1;\n    (dateNF.match(dateNFregex) || []).forEach(function (n, i) {\n      var v = parseInt(match[i + 1], 10);\n      switch (n.toLowerCase().charAt(0)) {\n        case 'y':\n          Y = v;\n          break;\n        case 'd':\n          d = v;\n          break;\n        case 'h':\n          H = v;\n          break;\n        case 's':\n          S = v;\n          break;\n        case 'm':\n          if (H >= 0) M = v;else m = v;\n          break;\n      }\n    });\n    if (S >= 0 && M == -1 && m >= 0) {\n      M = m;\n      m = -1;\n    }\n    var datestr = (\"\" + (Y >= 0 ? Y : new Date().getFullYear())).slice(-4) + \"-\" + (\"00\" + (m >= 1 ? m : 1)).slice(-2) + \"-\" + (\"00\" + (d >= 1 ? d : 1)).slice(-2);\n    if (datestr.length == 7) datestr = \"0\" + datestr;\n    if (datestr.length == 8) datestr = \"20\" + datestr;\n    var timestr = (\"00\" + (H >= 0 ? H : 0)).slice(-2) + \":\" + (\"00\" + (M >= 0 ? M : 0)).slice(-2) + \":\" + (\"00\" + (S >= 0 ? S : 0)).slice(-2);\n    if (H == -1 && M == -1 && S == -1) return datestr;\n    if (Y == -1 && m == -1 && d == -1) return timestr;\n    return datestr + \"T\" + timestr;\n  }\n\n  /* cfb.js (C) 2013-present SheetJS -- http://sheetjs.com */\n  /* vim: set ts=2: */\n  /*jshint eqnull:true */\n  /*exported CFB */\n  /*global Uint8Array:false, Uint16Array:false */\n\n  /* crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */\n  /* vim: set ts=2: */\n  /*exported CRC32 */\n  var CRC32 = function () {\n    var CRC32 = {};\n    CRC32.version = '1.2.0';\n    /* see perf/crc32table.js */\n    /*global Int32Array */\n    function signed_crc_table() {\n      var c = 0,\n        table = new Array(256);\n      for (var n = 0; n != 256; ++n) {\n        c = n;\n        c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n        c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n        c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n        c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n        c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n        c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n        c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n        c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n        table[n] = c;\n      }\n      return typeof Int32Array !== 'undefined' ? new Int32Array(table) : table;\n    }\n    var T0 = signed_crc_table();\n    function slice_by_16_tables(T) {\n      var c = 0,\n        v = 0,\n        n = 0,\n        table = typeof Int32Array !== 'undefined' ? new Int32Array(4096) : new Array(4096);\n      for (n = 0; n != 256; ++n) table[n] = T[n];\n      for (n = 0; n != 256; ++n) {\n        v = T[n];\n        for (c = 256 + n; c < 4096; c += 256) v = table[c] = v >>> 8 ^ T[v & 0xFF];\n      }\n      var out = [];\n      for (n = 1; n != 16; ++n) out[n - 1] = typeof Int32Array !== 'undefined' ? table.subarray(n * 256, n * 256 + 256) : table.slice(n * 256, n * 256 + 256);\n      return out;\n    }\n    var TT = slice_by_16_tables(T0);\n    var T1 = TT[0],\n      T2 = TT[1],\n      T3 = TT[2],\n      T4 = TT[3],\n      T5 = TT[4];\n    var T6 = TT[5],\n      T7 = TT[6],\n      T8 = TT[7],\n      T9 = TT[8],\n      Ta = TT[9];\n    var Tb = TT[10],\n      Tc = TT[11],\n      Td = TT[12],\n      Te = TT[13],\n      Tf = TT[14];\n    function crc32_bstr(bstr, seed) {\n      var C = seed ^ -1;\n      for (var i = 0, L = bstr.length; i < L;) C = C >>> 8 ^ T0[(C ^ bstr.charCodeAt(i++)) & 0xFF];\n      return ~C;\n    }\n    function crc32_buf(B, seed) {\n      var C = seed ^ -1,\n        L = B.length - 15,\n        i = 0;\n      for (; i < L;) C = Tf[B[i++] ^ C & 255] ^ Te[B[i++] ^ C >> 8 & 255] ^ Td[B[i++] ^ C >> 16 & 255] ^ Tc[B[i++] ^ C >>> 24] ^ Tb[B[i++]] ^ Ta[B[i++]] ^ T9[B[i++]] ^ T8[B[i++]] ^ T7[B[i++]] ^ T6[B[i++]] ^ T5[B[i++]] ^ T4[B[i++]] ^ T3[B[i++]] ^ T2[B[i++]] ^ T1[B[i++]] ^ T0[B[i++]];\n      L += 15;\n      while (i < L) C = C >>> 8 ^ T0[(C ^ B[i++]) & 0xFF];\n      return ~C;\n    }\n    function crc32_str(str, seed) {\n      var C = seed ^ -1;\n      for (var i = 0, L = str.length, c = 0, d = 0; i < L;) {\n        c = str.charCodeAt(i++);\n        if (c < 0x80) {\n          C = C >>> 8 ^ T0[(C ^ c) & 0xFF];\n        } else if (c < 0x800) {\n          C = C >>> 8 ^ T0[(C ^ (192 | c >> 6 & 31)) & 0xFF];\n          C = C >>> 8 ^ T0[(C ^ (128 | c & 63)) & 0xFF];\n        } else if (c >= 0xD800 && c < 0xE000) {\n          c = (c & 1023) + 64;\n          d = str.charCodeAt(i++) & 1023;\n          C = C >>> 8 ^ T0[(C ^ (240 | c >> 8 & 7)) & 0xFF];\n          C = C >>> 8 ^ T0[(C ^ (128 | c >> 2 & 63)) & 0xFF];\n          C = C >>> 8 ^ T0[(C ^ (128 | d >> 6 & 15 | (c & 3) << 4)) & 0xFF];\n          C = C >>> 8 ^ T0[(C ^ (128 | d & 63)) & 0xFF];\n        } else {\n          C = C >>> 8 ^ T0[(C ^ (224 | c >> 12 & 15)) & 0xFF];\n          C = C >>> 8 ^ T0[(C ^ (128 | c >> 6 & 63)) & 0xFF];\n          C = C >>> 8 ^ T0[(C ^ (128 | c & 63)) & 0xFF];\n        }\n      }\n      return ~C;\n    }\n    CRC32.table = T0;\n    CRC32.bstr = crc32_bstr;\n    CRC32.buf = crc32_buf;\n    CRC32.str = crc32_str;\n    return CRC32;\n  }();\n  /* [MS-CFB] v20171201 */\n  var CFB = function _CFB() {\n    var exports = {};\n    exports.version = '1.2.1';\n    /* [MS-CFB] 2.6.4 */\n    function namecmp(l, r) {\n      var L = l.split(\"/\"),\n        R = r.split(\"/\");\n      for (var i = 0, c = 0, Z = Math.min(L.length, R.length); i < Z; ++i) {\n        if (c = L[i].length - R[i].length) return c;\n        if (L[i] != R[i]) return L[i] < R[i] ? -1 : 1;\n      }\n      return L.length - R.length;\n    }\n    function dirname(p) {\n      if (p.charAt(p.length - 1) == \"/\") return p.slice(0, -1).indexOf(\"/\") === -1 ? p : dirname(p.slice(0, -1));\n      var c = p.lastIndexOf(\"/\");\n      return c === -1 ? p : p.slice(0, c + 1);\n    }\n    function filename(p) {\n      if (p.charAt(p.length - 1) == \"/\") return filename(p.slice(0, -1));\n      var c = p.lastIndexOf(\"/\");\n      return c === -1 ? p : p.slice(c + 1);\n    }\n    /* -------------------------------------------------------------------------- */\n    /* DOS Date format:\n       high|YYYYYYYm.mmmddddd.HHHHHMMM.MMMSSSSS|low\n       add 1980 to stored year\n       stored second should be doubled\n    */\n\n    /* write JS date to buf as a DOS date */\n    function write_dos_date(buf, date) {\n      if (typeof date === \"string\") date = new Date(date);\n      var hms = date.getHours();\n      hms = hms << 6 | date.getMinutes();\n      hms = hms << 5 | date.getSeconds() >>> 1;\n      buf.write_shift(2, hms);\n      var ymd = date.getFullYear() - 1980;\n      ymd = ymd << 4 | date.getMonth() + 1;\n      ymd = ymd << 5 | date.getDate();\n      buf.write_shift(2, ymd);\n    }\n\n    /* read four bytes from buf and interpret as a DOS date */\n    function parse_dos_date(buf) {\n      var hms = buf.read_shift(2) & 0xFFFF;\n      var ymd = buf.read_shift(2) & 0xFFFF;\n      var val = new Date();\n      var d = ymd & 0x1F;\n      ymd >>>= 5;\n      var m = ymd & 0x0F;\n      ymd >>>= 4;\n      val.setMilliseconds(0);\n      val.setFullYear(ymd + 1980);\n      val.setMonth(m - 1);\n      val.setDate(d);\n      var S = hms & 0x1F;\n      hms >>>= 5;\n      var M = hms & 0x3F;\n      hms >>>= 6;\n      val.setHours(hms);\n      val.setMinutes(M);\n      val.setSeconds(S << 1);\n      return val;\n    }\n    function parse_extra_field(blob) {\n      prep_blob(blob, 0);\n      var o = {};\n      var flags = 0;\n      while (blob.l <= blob.length - 4) {\n        var type = blob.read_shift(2);\n        var sz = blob.read_shift(2),\n          tgt = blob.l + sz;\n        var p = {};\n        switch (type) {\n          /* UNIX-style Timestamps */\n          case 0x5455:\n            {\n              flags = blob.read_shift(1);\n              if (flags & 1) p.mtime = blob.read_shift(4);\n              /* for some reason, CD flag corresponds to LFH */\n              if (sz > 5) {\n                if (flags & 2) p.atime = blob.read_shift(4);\n                if (flags & 4) p.ctime = blob.read_shift(4);\n              }\n              if (p.mtime) p.mt = new Date(p.mtime * 1000);\n            }\n            break;\n        }\n        blob.l = tgt;\n        o[type] = p;\n      }\n      return o;\n    }\n    var fs;\n    function get_fs() {\n      return fs || (fs = require('fs'));\n    }\n    function parse(file, options) {\n      if (file[0] == 0x50 && file[1] == 0x4b) return parse_zip(file, options);\n      if ((file[0] | 0x20) == 0x6d && (file[1] | 0x20) == 0x69) return parse_mad(file, options);\n      if (file.length < 512) throw new Error(\"CFB file size \" + file.length + \" < 512\");\n      var mver = 3;\n      var ssz = 512;\n      var nmfs = 0; // number of mini FAT sectors\n      var difat_sec_cnt = 0;\n      var dir_start = 0;\n      var minifat_start = 0;\n      var difat_start = 0;\n      var fat_addrs = []; // locations of FAT sectors\n\n      /* [MS-CFB] 2.2 Compound File Header */\n      var blob = file.slice(0, 512);\n      prep_blob(blob, 0);\n\n      /* major version */\n      var mv = check_get_mver(blob);\n      mver = mv[0];\n      switch (mver) {\n        case 3:\n          ssz = 512;\n          break;\n        case 4:\n          ssz = 4096;\n          break;\n        case 0:\n          if (mv[1] == 0) return parse_zip(file, options);\n        /* falls through */\n        default:\n          throw new Error(\"Major Version: Expected 3 or 4 saw \" + mver);\n      }\n\n      /* reprocess header */\n      if (ssz !== 512) {\n        blob = file.slice(0, ssz);\n        prep_blob(blob, 28 /* blob.l */);\n      }\n      /* Save header for final object */\n      var header = file.slice(0, ssz);\n      check_shifts(blob, mver);\n\n      // Number of Directory Sectors\n      var dir_cnt = blob.read_shift(4, 'i');\n      if (mver === 3 && dir_cnt !== 0) throw new Error('# Directory Sectors: Expected 0 saw ' + dir_cnt);\n\n      // Number of FAT Sectors\n      blob.l += 4;\n\n      // First Directory Sector Location\n      dir_start = blob.read_shift(4, 'i');\n\n      // Transaction Signature\n      blob.l += 4;\n\n      // Mini Stream Cutoff Size\n      blob.chk('00100000', 'Mini Stream Cutoff Size: ');\n\n      // First Mini FAT Sector Location\n      minifat_start = blob.read_shift(4, 'i');\n\n      // Number of Mini FAT Sectors\n      nmfs = blob.read_shift(4, 'i');\n\n      // First DIFAT sector location\n      difat_start = blob.read_shift(4, 'i');\n\n      // Number of DIFAT Sectors\n      difat_sec_cnt = blob.read_shift(4, 'i');\n\n      // Grab FAT Sector Locations\n      for (var q = -1, j = 0; j < 109; ++j) {\n        /* 109 = (512 - blob.l)>>>2; */\n        q = blob.read_shift(4, 'i');\n        if (q < 0) break;\n        fat_addrs[j] = q;\n      }\n\n      /** Break the file up into sectors */\n      var sectors = sectorify(file, ssz);\n      sleuth_fat(difat_start, difat_sec_cnt, sectors, ssz, fat_addrs);\n\n      /** Chains */\n      var sector_list = make_sector_list(sectors, dir_start, fat_addrs, ssz);\n      sector_list[dir_start].name = \"!Directory\";\n      if (nmfs > 0 && minifat_start !== ENDOFCHAIN) sector_list[minifat_start].name = \"!MiniFAT\";\n      sector_list[fat_addrs[0]].name = \"!FAT\";\n      sector_list.fat_addrs = fat_addrs;\n      sector_list.ssz = ssz;\n\n      /* [MS-CFB] 2.6.1 Compound File Directory Entry */\n      var files = {},\n        Paths = [],\n        FileIndex = [],\n        FullPaths = [];\n      read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex, minifat_start);\n      build_full_paths(FileIndex, FullPaths, Paths);\n      Paths.shift();\n      var o = {\n        FileIndex: FileIndex,\n        FullPaths: FullPaths\n      };\n\n      // $FlowIgnore\n      if (options && options.raw) o.raw = {\n        header: header,\n        sectors: sectors\n      };\n      return o;\n    } // parse\n\n    /* [MS-CFB] 2.2 Compound File Header -- read up to major version */\n    function check_get_mver(blob) {\n      if (blob[blob.l] == 0x50 && blob[blob.l + 1] == 0x4b) return [0, 0];\n      // header signature 8\n      blob.chk(HEADER_SIGNATURE, 'Header Signature: ');\n\n      // clsid 16\n      //blob.chk(HEADER_CLSID, 'CLSID: ');\n      blob.l += 16;\n\n      // minor version 2\n      var mver = blob.read_shift(2, 'u');\n      return [blob.read_shift(2, 'u'), mver];\n    }\n    function check_shifts(blob, mver) {\n      var shift = 0x09;\n\n      // Byte Order\n      //blob.chk('feff', 'Byte Order: '); // note: some writers put 0xffff\n      blob.l += 2;\n\n      // Sector Shift\n      switch (shift = blob.read_shift(2)) {\n        case 0x09:\n          if (mver != 3) throw new Error('Sector Shift: Expected 9 saw ' + shift);\n          break;\n        case 0x0c:\n          if (mver != 4) throw new Error('Sector Shift: Expected 12 saw ' + shift);\n          break;\n        default:\n          throw new Error('Sector Shift: Expected 9 or 12 saw ' + shift);\n      }\n\n      // Mini Sector Shift\n      blob.chk('0600', 'Mini Sector Shift: ');\n\n      // Reserved\n      blob.chk('000000000000', 'Reserved: ');\n    }\n\n    /** Break the file up into sectors */\n    function sectorify(file, ssz) {\n      var nsectors = Math.ceil(file.length / ssz) - 1;\n      var sectors = [];\n      for (var i = 1; i < nsectors; ++i) sectors[i - 1] = file.slice(i * ssz, (i + 1) * ssz);\n      sectors[nsectors - 1] = file.slice(nsectors * ssz);\n      return sectors;\n    }\n\n    /* [MS-CFB] 2.6.4 Red-Black Tree */\n    function build_full_paths(FI, FP, Paths) {\n      var i = 0,\n        L = 0,\n        R = 0,\n        C = 0,\n        j = 0,\n        pl = Paths.length;\n      var dad = [],\n        q = [];\n      for (; i < pl; ++i) {\n        dad[i] = q[i] = i;\n        FP[i] = Paths[i];\n      }\n      for (; j < q.length; ++j) {\n        i = q[j];\n        L = FI[i].L;\n        R = FI[i].R;\n        C = FI[i].C;\n        if (dad[i] === i) {\n          if (L !== -1 /*NOSTREAM*/ && dad[L] !== L) dad[i] = dad[L];\n          if (R !== -1 && dad[R] !== R) dad[i] = dad[R];\n        }\n        if (C !== -1 /*NOSTREAM*/) dad[C] = i;\n        if (L !== -1 && i != dad[i]) {\n          dad[L] = dad[i];\n          if (q.lastIndexOf(L) < j) q.push(L);\n        }\n        if (R !== -1 && i != dad[i]) {\n          dad[R] = dad[i];\n          if (q.lastIndexOf(R) < j) q.push(R);\n        }\n      }\n      for (i = 1; i < pl; ++i) if (dad[i] === i) {\n        if (R !== -1 /*NOSTREAM*/ && dad[R] !== R) dad[i] = dad[R];else if (L !== -1 && dad[L] !== L) dad[i] = dad[L];\n      }\n      for (i = 1; i < pl; ++i) {\n        if (FI[i].type === 0 /* unknown */) continue;\n        j = i;\n        if (j != dad[j]) do {\n          j = dad[j];\n          FP[i] = FP[j] + \"/\" + FP[i];\n        } while (j !== 0 && -1 !== dad[j] && j != dad[j]);\n        dad[i] = -1;\n      }\n      FP[0] += \"/\";\n      for (i = 1; i < pl; ++i) {\n        if (FI[i].type !== 2 /* stream */) FP[i] += \"/\";\n      }\n    }\n    function get_mfat_entry(entry, payload, mini) {\n      var start = entry.start,\n        size = entry.size;\n      //return (payload.slice(start*MSSZ, start*MSSZ + size));\n      var o = [];\n      var idx = start;\n      while (mini && size > 0 && idx >= 0) {\n        o.push(payload.slice(idx * MSSZ, idx * MSSZ + MSSZ));\n        size -= MSSZ;\n        idx = __readInt32LE(mini, idx * 4);\n      }\n      if (o.length === 0) return new_buf(0);\n      return bconcat(o).slice(0, entry.size);\n    }\n\n    /** Chase down the rest of the DIFAT chain to build a comprehensive list\n        DIFAT chains by storing the next sector number as the last 32 bits */\n    function sleuth_fat(idx, cnt, sectors, ssz, fat_addrs) {\n      var q = ENDOFCHAIN;\n      if (idx === ENDOFCHAIN) {\n        if (cnt !== 0) throw new Error(\"DIFAT chain shorter than expected\");\n      } else if (idx !== -1 /*FREESECT*/) {\n        var sector = sectors[idx],\n          m = (ssz >>> 2) - 1;\n        if (!sector) return;\n        for (var i = 0; i < m; ++i) {\n          if ((q = __readInt32LE(sector, i * 4)) === ENDOFCHAIN) break;\n          fat_addrs.push(q);\n        }\n        sleuth_fat(__readInt32LE(sector, ssz - 4), cnt - 1, sectors, ssz, fat_addrs);\n      }\n    }\n\n    /** Follow the linked list of sectors for a given starting point */\n    function get_sector_list(sectors, start, fat_addrs, ssz, chkd) {\n      var buf = [],\n        buf_chain = [];\n      if (!chkd) chkd = [];\n      var modulus = ssz - 1,\n        j = 0,\n        jj = 0;\n      for (j = start; j >= 0;) {\n        chkd[j] = true;\n        buf[buf.length] = j;\n        buf_chain.push(sectors[j]);\n        var addr = fat_addrs[Math.floor(j * 4 / ssz)];\n        jj = j * 4 & modulus;\n        if (ssz < 4 + jj) throw new Error(\"FAT boundary crossed: \" + j + \" 4 \" + ssz);\n        if (!sectors[addr]) break;\n        j = __readInt32LE(sectors[addr], jj);\n      }\n      return {\n        nodes: buf,\n        data: __toBuffer([buf_chain])\n      };\n    }\n\n    /** Chase down the sector linked lists */\n    function make_sector_list(sectors, dir_start, fat_addrs, ssz) {\n      var sl = sectors.length,\n        sector_list = [];\n      var chkd = [],\n        buf = [],\n        buf_chain = [];\n      var modulus = ssz - 1,\n        i = 0,\n        j = 0,\n        k = 0,\n        jj = 0;\n      for (i = 0; i < sl; ++i) {\n        buf = [];\n        k = i + dir_start;\n        if (k >= sl) k -= sl;\n        if (chkd[k]) continue;\n        buf_chain = [];\n        var seen = [];\n        for (j = k; j >= 0;) {\n          seen[j] = true;\n          chkd[j] = true;\n          buf[buf.length] = j;\n          buf_chain.push(sectors[j]);\n          var addr = fat_addrs[Math.floor(j * 4 / ssz)];\n          jj = j * 4 & modulus;\n          if (ssz < 4 + jj) throw new Error(\"FAT boundary crossed: \" + j + \" 4 \" + ssz);\n          if (!sectors[addr]) break;\n          j = __readInt32LE(sectors[addr], jj);\n          if (seen[j]) break;\n        }\n        sector_list[k] = {\n          nodes: buf,\n          data: __toBuffer([buf_chain])\n        };\n      }\n      return sector_list;\n    }\n\n    /* [MS-CFB] 2.6.1 Compound File Directory Entry */\n    function read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex, mini) {\n      var minifat_store = 0,\n        pl = Paths.length ? 2 : 0;\n      var sector = sector_list[dir_start].data;\n      var i = 0,\n        namelen = 0,\n        name;\n      for (; i < sector.length; i += 128) {\n        var blob = sector.slice(i, i + 128);\n        prep_blob(blob, 64);\n        namelen = blob.read_shift(2);\n        name = __utf16le(blob, 0, namelen - pl);\n        Paths.push(name);\n        var o = {\n          name: name,\n          type: blob.read_shift(1),\n          color: blob.read_shift(1),\n          L: blob.read_shift(4, 'i'),\n          R: blob.read_shift(4, 'i'),\n          C: blob.read_shift(4, 'i'),\n          clsid: blob.read_shift(16),\n          state: blob.read_shift(4, 'i'),\n          start: 0,\n          size: 0\n        };\n        var ctime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n        if (ctime !== 0) o.ct = read_date(blob, blob.l - 8);\n        var mtime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n        if (mtime !== 0) o.mt = read_date(blob, blob.l - 8);\n        o.start = blob.read_shift(4, 'i');\n        o.size = blob.read_shift(4, 'i');\n        if (o.size < 0 && o.start < 0) {\n          o.size = o.type = 0;\n          o.start = ENDOFCHAIN;\n          o.name = \"\";\n        }\n        if (o.type === 5) {\n          /* root */\n          minifat_store = o.start;\n          if (nmfs > 0 && minifat_store !== ENDOFCHAIN) sector_list[minifat_store].name = \"!StreamData\";\n          /*minifat_size = o.size;*/\n        } else if (o.size >= 4096 /* MSCSZ */) {\n          o.storage = 'fat';\n          if (sector_list[o.start] === undefined) sector_list[o.start] = get_sector_list(sectors, o.start, sector_list.fat_addrs, sector_list.ssz);\n          sector_list[o.start].name = o.name;\n          o.content = sector_list[o.start].data.slice(0, o.size);\n        } else {\n          o.storage = 'minifat';\n          if (o.size < 0) o.size = 0;else if (minifat_store !== ENDOFCHAIN && o.start !== ENDOFCHAIN && sector_list[minifat_store]) {\n            o.content = get_mfat_entry(o, sector_list[minifat_store].data, (sector_list[mini] || {}).data);\n          }\n        }\n        if (o.content) prep_blob(o.content, 0);\n        files[name] = o;\n        FileIndex.push(o);\n      }\n    }\n    function read_date(blob, offset) {\n      return new Date((__readUInt32LE(blob, offset + 4) / 1e7 * Math.pow(2, 32) + __readUInt32LE(blob, offset) / 1e7 - 11644473600) * 1000);\n    }\n    function read_file(filename, options) {\n      get_fs();\n      return parse(fs.readFileSync(filename), options);\n    }\n    function read(blob, options) {\n      var type = options && options.type;\n      if (!type) {\n        if (has_buf && Buffer.isBuffer(blob)) type = \"buffer\";\n      }\n      switch (type || \"base64\") {\n        case \"file\":\n          return read_file(blob, options);\n        case \"base64\":\n          return parse(s2a(Base64_decode(blob)), options);\n        case \"binary\":\n          return parse(s2a(blob), options);\n      }\n      return parse(blob, options);\n    }\n    function init_cfb(cfb, opts) {\n      var o = opts || {},\n        root = o.root || \"Root Entry\";\n      if (!cfb.FullPaths) cfb.FullPaths = [];\n      if (!cfb.FileIndex) cfb.FileIndex = [];\n      if (cfb.FullPaths.length !== cfb.FileIndex.length) throw new Error(\"inconsistent CFB structure\");\n      if (cfb.FullPaths.length === 0) {\n        cfb.FullPaths[0] = root + \"/\";\n        cfb.FileIndex[0] = {\n          name: root,\n          type: 5\n        };\n      }\n      if (o.CLSID) cfb.FileIndex[0].clsid = o.CLSID;\n      seed_cfb(cfb);\n    }\n    function seed_cfb(cfb) {\n      var nm = \"\\u0001Sh33tJ5\";\n      if (CFB.find(cfb, \"/\" + nm)) return;\n      var p = new_buf(4);\n      p[0] = 55;\n      p[1] = p[3] = 50;\n      p[2] = 54;\n      cfb.FileIndex.push({\n        name: nm,\n        type: 2,\n        content: p,\n        size: 4,\n        L: 69,\n        R: 69,\n        C: 69\n      });\n      cfb.FullPaths.push(cfb.FullPaths[0] + nm);\n      rebuild_cfb(cfb);\n    }\n    function rebuild_cfb(cfb, f) {\n      init_cfb(cfb);\n      var gc = false,\n        s = false;\n      for (var i = cfb.FullPaths.length - 1; i >= 0; --i) {\n        var _file = cfb.FileIndex[i];\n        switch (_file.type) {\n          case 0:\n            if (s) gc = true;else {\n              cfb.FileIndex.pop();\n              cfb.FullPaths.pop();\n            }\n            break;\n          case 1:\n          case 2:\n          case 5:\n            s = true;\n            if (isNaN(_file.R * _file.L * _file.C)) gc = true;\n            if (_file.R > -1 && _file.L > -1 && _file.R == _file.L) gc = true;\n            break;\n          default:\n            gc = true;\n            break;\n        }\n      }\n      if (!gc && !f) return;\n      var now = new Date(1987, 1, 19),\n        j = 0;\n      // Track which names exist\n      var fullPaths = Object.create ? Object.create(null) : {};\n      var data = [];\n      for (i = 0; i < cfb.FullPaths.length; ++i) {\n        fullPaths[cfb.FullPaths[i]] = true;\n        if (cfb.FileIndex[i].type === 0) continue;\n        data.push([cfb.FullPaths[i], cfb.FileIndex[i]]);\n      }\n      for (i = 0; i < data.length; ++i) {\n        var dad = dirname(data[i][0]);\n        s = fullPaths[dad];\n        if (!s) {\n          data.push([dad, {\n            name: filename(dad).replace(\"/\", \"\"),\n            type: 1,\n            clsid: HEADER_CLSID,\n            ct: now,\n            mt: now,\n            content: null\n          }]);\n          // Add name to set\n          fullPaths[dad] = true;\n        }\n      }\n      data.sort(function (x, y) {\n        return namecmp(x[0], y[0]);\n      });\n      cfb.FullPaths = [];\n      cfb.FileIndex = [];\n      for (i = 0; i < data.length; ++i) {\n        cfb.FullPaths[i] = data[i][0];\n        cfb.FileIndex[i] = data[i][1];\n      }\n      for (i = 0; i < data.length; ++i) {\n        var elt = cfb.FileIndex[i];\n        var nm = cfb.FullPaths[i];\n        elt.name = filename(nm).replace(\"/\", \"\");\n        elt.L = elt.R = elt.C = -(elt.color = 1);\n        elt.size = elt.content ? elt.content.length : 0;\n        elt.start = 0;\n        elt.clsid = elt.clsid || HEADER_CLSID;\n        if (i === 0) {\n          elt.C = data.length > 1 ? 1 : -1;\n          elt.size = 0;\n          elt.type = 5;\n        } else if (nm.slice(-1) == \"/\") {\n          for (j = i + 1; j < data.length; ++j) if (dirname(cfb.FullPaths[j]) == nm) break;\n          elt.C = j >= data.length ? -1 : j;\n          for (j = i + 1; j < data.length; ++j) if (dirname(cfb.FullPaths[j]) == dirname(nm)) break;\n          elt.R = j >= data.length ? -1 : j;\n          elt.type = 1;\n        } else {\n          if (dirname(cfb.FullPaths[i + 1] || \"\") == dirname(nm)) elt.R = i + 1;\n          elt.type = 2;\n        }\n      }\n    }\n    function _write(cfb, options) {\n      var _opts = options || {};\n      /* MAD is order-sensitive, skip rebuild and sort */\n      if (_opts.fileType == 'mad') return write_mad(cfb, _opts);\n      rebuild_cfb(cfb);\n      switch (_opts.fileType) {\n        case 'zip':\n          return write_zip(cfb, _opts);\n        //case 'mad': return write_mad(cfb, _opts);\n      }\n\n      var L = function (cfb) {\n        var mini_size = 0,\n          fat_size = 0;\n        for (var i = 0; i < cfb.FileIndex.length; ++i) {\n          var file = cfb.FileIndex[i];\n          if (!file.content) continue;\n          var flen = file.content.length;\n          if (flen > 0) {\n            if (flen < 0x1000) mini_size += flen + 0x3F >> 6;else fat_size += flen + 0x01FF >> 9;\n          }\n        }\n        var dir_cnt = cfb.FullPaths.length + 3 >> 2;\n        var mini_cnt = mini_size + 7 >> 3;\n        var mfat_cnt = mini_size + 0x7F >> 7;\n        var fat_base = mini_cnt + fat_size + dir_cnt + mfat_cnt;\n        var fat_cnt = fat_base + 0x7F >> 7;\n        var difat_cnt = fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt - 109) / 0x7F);\n        while (fat_base + fat_cnt + difat_cnt + 0x7F >> 7 > fat_cnt) difat_cnt = ++fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt - 109) / 0x7F);\n        var L = [1, difat_cnt, fat_cnt, mfat_cnt, dir_cnt, fat_size, mini_size, 0];\n        cfb.FileIndex[0].size = mini_size << 6;\n        L[7] = (cfb.FileIndex[0].start = L[0] + L[1] + L[2] + L[3] + L[4] + L[5]) + (L[6] + 7 >> 3);\n        return L;\n      }(cfb);\n      var o = new_buf(L[7] << 9);\n      var i = 0,\n        T = 0;\n      {\n        for (i = 0; i < 8; ++i) o.write_shift(1, HEADER_SIG[i]);\n        for (i = 0; i < 8; ++i) o.write_shift(2, 0);\n        o.write_shift(2, 0x003E);\n        o.write_shift(2, 0x0003);\n        o.write_shift(2, 0xFFFE);\n        o.write_shift(2, 0x0009);\n        o.write_shift(2, 0x0006);\n        for (i = 0; i < 3; ++i) o.write_shift(2, 0);\n        o.write_shift(4, 0);\n        o.write_shift(4, L[2]);\n        o.write_shift(4, L[0] + L[1] + L[2] + L[3] - 1);\n        o.write_shift(4, 0);\n        o.write_shift(4, 1 << 12);\n        o.write_shift(4, L[3] ? L[0] + L[1] + L[2] - 1 : ENDOFCHAIN);\n        o.write_shift(4, L[3]);\n        o.write_shift(-4, L[1] ? L[0] - 1 : ENDOFCHAIN);\n        o.write_shift(4, L[1]);\n        for (i = 0; i < 109; ++i) o.write_shift(-4, i < L[2] ? L[1] + i : -1);\n      }\n      if (L[1]) {\n        for (T = 0; T < L[1]; ++T) {\n          for (; i < 236 + T * 127; ++i) o.write_shift(-4, i < L[2] ? L[1] + i : -1);\n          o.write_shift(-4, T === L[1] - 1 ? ENDOFCHAIN : T + 1);\n        }\n      }\n      var chainit = function (w) {\n        for (T += w; i < T - 1; ++i) o.write_shift(-4, i + 1);\n        if (w) {\n          ++i;\n          o.write_shift(-4, ENDOFCHAIN);\n        }\n      };\n      T = i = 0;\n      for (T += L[1]; i < T; ++i) o.write_shift(-4, consts.DIFSECT);\n      for (T += L[2]; i < T; ++i) o.write_shift(-4, consts.FATSECT);\n      chainit(L[3]);\n      chainit(L[4]);\n      var j = 0,\n        flen = 0;\n      var file = cfb.FileIndex[0];\n      for (; j < cfb.FileIndex.length; ++j) {\n        file = cfb.FileIndex[j];\n        if (!file.content) continue;\n        flen = file.content.length;\n        if (flen < 0x1000) continue;\n        file.start = T;\n        chainit(flen + 0x01FF >> 9);\n      }\n      chainit(L[6] + 7 >> 3);\n      while (o.l & 0x1FF) o.write_shift(-4, consts.ENDOFCHAIN);\n      T = i = 0;\n      for (j = 0; j < cfb.FileIndex.length; ++j) {\n        file = cfb.FileIndex[j];\n        if (!file.content) continue;\n        flen = file.content.length;\n        if (!flen || flen >= 0x1000) continue;\n        file.start = T;\n        chainit(flen + 0x3F >> 6);\n      }\n      while (o.l & 0x1FF) o.write_shift(-4, consts.ENDOFCHAIN);\n      for (i = 0; i < L[4] << 2; ++i) {\n        var nm = cfb.FullPaths[i];\n        if (!nm || nm.length === 0) {\n          for (j = 0; j < 17; ++j) o.write_shift(4, 0);\n          for (j = 0; j < 3; ++j) o.write_shift(4, -1);\n          for (j = 0; j < 12; ++j) o.write_shift(4, 0);\n          continue;\n        }\n        file = cfb.FileIndex[i];\n        if (i === 0) file.start = file.size ? file.start - 1 : ENDOFCHAIN;\n        var _nm = i === 0 && _opts.root || file.name;\n        flen = 2 * (_nm.length + 1);\n        o.write_shift(64, _nm, \"utf16le\");\n        o.write_shift(2, flen);\n        o.write_shift(1, file.type);\n        o.write_shift(1, file.color);\n        o.write_shift(-4, file.L);\n        o.write_shift(-4, file.R);\n        o.write_shift(-4, file.C);\n        if (!file.clsid) for (j = 0; j < 4; ++j) o.write_shift(4, 0);else o.write_shift(16, file.clsid, \"hex\");\n        o.write_shift(4, file.state || 0);\n        o.write_shift(4, 0);\n        o.write_shift(4, 0);\n        o.write_shift(4, 0);\n        o.write_shift(4, 0);\n        o.write_shift(4, file.start);\n        o.write_shift(4, file.size);\n        o.write_shift(4, 0);\n      }\n      for (i = 1; i < cfb.FileIndex.length; ++i) {\n        file = cfb.FileIndex[i];\n        if (file.size >= 0x1000) {\n          o.l = file.start + 1 << 9;\n          if (has_buf && Buffer.isBuffer(file.content)) {\n            file.content.copy(o, o.l, 0, file.size);\n            // o is a 0-filled Buffer so just set next offset\n            o.l += file.size + 511 & -512;\n          } else {\n            for (j = 0; j < file.size; ++j) o.write_shift(1, file.content[j]);\n            for (; j & 0x1FF; ++j) o.write_shift(1, 0);\n          }\n        }\n      }\n      for (i = 1; i < cfb.FileIndex.length; ++i) {\n        file = cfb.FileIndex[i];\n        if (file.size > 0 && file.size < 0x1000) {\n          if (has_buf && Buffer.isBuffer(file.content)) {\n            file.content.copy(o, o.l, 0, file.size);\n            // o is a 0-filled Buffer so just set next offset\n            o.l += file.size + 63 & -64;\n          } else {\n            for (j = 0; j < file.size; ++j) o.write_shift(1, file.content[j]);\n            for (; j & 0x3F; ++j) o.write_shift(1, 0);\n          }\n        }\n      }\n      if (has_buf) {\n        o.l = o.length;\n      } else {\n        // When using Buffer, already 0-filled\n        while (o.l < o.length) o.write_shift(1, 0);\n      }\n      return o;\n    }\n    /* [MS-CFB] 2.6.4 (Unicode 3.0.1 case conversion) */\n    function find(cfb, path) {\n      var UCFullPaths = cfb.FullPaths.map(function (x) {\n        return x.toUpperCase();\n      });\n      var UCPaths = UCFullPaths.map(function (x) {\n        var y = x.split(\"/\");\n        return y[y.length - (x.slice(-1) == \"/\" ? 2 : 1)];\n      });\n      var k = false;\n      if (path.charCodeAt(0) === 47 /* \"/\" */) {\n        k = true;\n        path = UCFullPaths[0].slice(0, -1) + path;\n      } else k = path.indexOf(\"/\") !== -1;\n      var UCPath = path.toUpperCase();\n      var w = k === true ? UCFullPaths.indexOf(UCPath) : UCPaths.indexOf(UCPath);\n      if (w !== -1) return cfb.FileIndex[w];\n      var m = !UCPath.match(chr1);\n      UCPath = UCPath.replace(chr0, '');\n      if (m) UCPath = UCPath.replace(chr1, '!');\n      for (w = 0; w < UCFullPaths.length; ++w) {\n        if ((m ? UCFullPaths[w].replace(chr1, '!') : UCFullPaths[w]).replace(chr0, '') == UCPath) return cfb.FileIndex[w];\n        if ((m ? UCPaths[w].replace(chr1, '!') : UCPaths[w]).replace(chr0, '') == UCPath) return cfb.FileIndex[w];\n      }\n      return null;\n    }\n    /** CFB Constants */\n    var MSSZ = 64; /* Mini Sector Size = 1<<6 */\n    //var MSCSZ = 4096; /* Mini Stream Cutoff Size */\n    /* 2.1 Compound File Sector Numbers and Types */\n    var ENDOFCHAIN = -2;\n    /* 2.2 Compound File Header */\n    var HEADER_SIGNATURE = 'd0cf11e0a1b11ae1';\n    var HEADER_SIG = [0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1];\n    var HEADER_CLSID = '00000000000000000000000000000000';\n    var consts = {\n      /* 2.1 Compund File Sector Numbers and Types */\n      MAXREGSECT: -6,\n      DIFSECT: -4,\n      FATSECT: -3,\n      ENDOFCHAIN: ENDOFCHAIN,\n      FREESECT: -1,\n      /* 2.2 Compound File Header */\n      HEADER_SIGNATURE: HEADER_SIGNATURE,\n      HEADER_MINOR_VERSION: '3e00',\n      MAXREGSID: -6,\n      NOSTREAM: -1,\n      HEADER_CLSID: HEADER_CLSID,\n      /* 2.6.1 Compound File Directory Entry */\n      EntryTypes: ['unknown', 'storage', 'stream', 'lockbytes', 'property', 'root']\n    };\n    function write_file(cfb, filename, options) {\n      get_fs();\n      var o = _write(cfb, options);\n      fs.writeFileSync(filename, o);\n    }\n    function a2s(o) {\n      var out = new Array(o.length);\n      for (var i = 0; i < o.length; ++i) out[i] = String.fromCharCode(o[i]);\n      return out.join(\"\");\n    }\n    function write(cfb, options) {\n      var o = _write(cfb, options);\n      switch (options && options.type || \"buffer\") {\n        case \"file\":\n          get_fs();\n          fs.writeFileSync(options.filename, o);\n          return o;\n        case \"binary\":\n          return typeof o == \"string\" ? o : a2s(o);\n        case \"base64\":\n          return Base64_encode(typeof o == \"string\" ? o : a2s(o));\n        case \"buffer\":\n          if (has_buf) return Buffer.isBuffer(o) ? o : Buffer_from(o);\n        /* falls through */\n        case \"array\":\n          return typeof o == \"string\" ? s2a(o) : o;\n      }\n      return o;\n    }\n    /* node < 8.1 zlib does not expose bytesRead, so default to pure JS */\n    var _zlib;\n    function use_zlib(zlib) {\n      try {\n        var InflateRaw = zlib.InflateRaw;\n        var InflRaw = new InflateRaw();\n        InflRaw._processChunk(new Uint8Array([3, 0]), InflRaw._finishFlushFlag);\n        if (InflRaw.bytesRead) _zlib = zlib;else throw new Error(\"zlib does not expose bytesRead\");\n      } catch (e) {\n        console.error(\"cannot use native zlib: \" + (e.message || e));\n      }\n    }\n    function _inflateRawSync(payload, usz) {\n      if (!_zlib) return _inflate(payload, usz);\n      var InflateRaw = _zlib.InflateRaw;\n      var InflRaw = new InflateRaw();\n      var out = InflRaw._processChunk(payload.slice(payload.l), InflRaw._finishFlushFlag);\n      payload.l += InflRaw.bytesRead;\n      return out;\n    }\n    function _deflateRawSync(payload) {\n      return _zlib ? _zlib.deflateRawSync(payload) : _deflate(payload);\n    }\n    var CLEN_ORDER = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15];\n\n    /*  LEN_ID = [ 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285 ]; */\n    var LEN_LN = [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258];\n\n    /*  DST_ID = [  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13,  14,  15,  16,  17,  18,  19,   20,   21,   22,   23,   24,   25,   26,    27,    28,    29 ]; */\n    var DST_LN = [1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577];\n    function bit_swap_8(n) {\n      var t = (n << 1 | n << 11) & 0x22110 | (n << 5 | n << 15) & 0x88440;\n      return (t >> 16 | t >> 8 | t) & 0xFF;\n    }\n    var use_typed_arrays = typeof Uint8Array !== 'undefined';\n    var bitswap8 = use_typed_arrays ? new Uint8Array(1 << 8) : [];\n    for (var q = 0; q < 1 << 8; ++q) bitswap8[q] = bit_swap_8(q);\n    function bit_swap_n(n, b) {\n      var rev = bitswap8[n & 0xFF];\n      if (b <= 8) return rev >>> 8 - b;\n      rev = rev << 8 | bitswap8[n >> 8 & 0xFF];\n      if (b <= 16) return rev >>> 16 - b;\n      rev = rev << 8 | bitswap8[n >> 16 & 0xFF];\n      return rev >>> 24 - b;\n    }\n\n    /* helpers for unaligned bit reads */\n    function read_bits_2(buf, bl) {\n      var w = bl & 7,\n        h = bl >>> 3;\n      return (buf[h] | (w <= 6 ? 0 : buf[h + 1] << 8)) >>> w & 0x03;\n    }\n    function read_bits_3(buf, bl) {\n      var w = bl & 7,\n        h = bl >>> 3;\n      return (buf[h] | (w <= 5 ? 0 : buf[h + 1] << 8)) >>> w & 0x07;\n    }\n    function read_bits_4(buf, bl) {\n      var w = bl & 7,\n        h = bl >>> 3;\n      return (buf[h] | (w <= 4 ? 0 : buf[h + 1] << 8)) >>> w & 0x0F;\n    }\n    function read_bits_5(buf, bl) {\n      var w = bl & 7,\n        h = bl >>> 3;\n      return (buf[h] | (w <= 3 ? 0 : buf[h + 1] << 8)) >>> w & 0x1F;\n    }\n    function read_bits_7(buf, bl) {\n      var w = bl & 7,\n        h = bl >>> 3;\n      return (buf[h] | (w <= 1 ? 0 : buf[h + 1] << 8)) >>> w & 0x7F;\n    }\n\n    /* works up to n = 3 * 8 + 1 = 25 */\n    function read_bits_n(buf, bl, n) {\n      var w = bl & 7,\n        h = bl >>> 3,\n        f = (1 << n) - 1;\n      var v = buf[h] >>> w;\n      if (n < 8 - w) return v & f;\n      v |= buf[h + 1] << 8 - w;\n      if (n < 16 - w) return v & f;\n      v |= buf[h + 2] << 16 - w;\n      if (n < 24 - w) return v & f;\n      v |= buf[h + 3] << 24 - w;\n      return v & f;\n    }\n\n    /* helpers for unaligned bit writes */\n    function write_bits_3(buf, bl, v) {\n      var w = bl & 7,\n        h = bl >>> 3;\n      if (w <= 5) buf[h] |= (v & 7) << w;else {\n        buf[h] |= v << w & 0xFF;\n        buf[h + 1] = (v & 7) >> 8 - w;\n      }\n      return bl + 3;\n    }\n    function write_bits_1(buf, bl, v) {\n      var w = bl & 7,\n        h = bl >>> 3;\n      v = (v & 1) << w;\n      buf[h] |= v;\n      return bl + 1;\n    }\n    function write_bits_8(buf, bl, v) {\n      var w = bl & 7,\n        h = bl >>> 3;\n      v <<= w;\n      buf[h] |= v & 0xFF;\n      v >>>= 8;\n      buf[h + 1] = v;\n      return bl + 8;\n    }\n    function write_bits_16(buf, bl, v) {\n      var w = bl & 7,\n        h = bl >>> 3;\n      v <<= w;\n      buf[h] |= v & 0xFF;\n      v >>>= 8;\n      buf[h + 1] = v & 0xFF;\n      buf[h + 2] = v >>> 8;\n      return bl + 16;\n    }\n\n    /* until ArrayBuffer#realloc is a thing, fake a realloc */\n    function realloc(b, sz) {\n      var L = b.length,\n        M = 2 * L > sz ? 2 * L : sz + 5,\n        i = 0;\n      if (L >= sz) return b;\n      if (has_buf) {\n        var o = new_unsafe_buf(M);\n        // $FlowIgnore\n        if (b.copy) b.copy(o);else for (; i < b.length; ++i) o[i] = b[i];\n        return o;\n      } else if (use_typed_arrays) {\n        var a = new Uint8Array(M);\n        if (a.set) a.set(b);else for (; i < L; ++i) a[i] = b[i];\n        return a;\n      }\n      b.length = M;\n      return b;\n    }\n\n    /* zero-filled arrays for older browsers */\n    function zero_fill_array(n) {\n      var o = new Array(n);\n      for (var i = 0; i < n; ++i) o[i] = 0;\n      return o;\n    }\n\n    /* build tree (used for literals and lengths) */\n    function build_tree(clens, cmap, MAX) {\n      var maxlen = 1,\n        w = 0,\n        i = 0,\n        j = 0,\n        ccode = 0,\n        L = clens.length;\n      var bl_count = use_typed_arrays ? new Uint16Array(32) : zero_fill_array(32);\n      for (i = 0; i < 32; ++i) bl_count[i] = 0;\n      for (i = L; i < MAX; ++i) clens[i] = 0;\n      L = clens.length;\n      var ctree = use_typed_arrays ? new Uint16Array(L) : zero_fill_array(L); // []\n\n      /* build code tree */\n      for (i = 0; i < L; ++i) {\n        bl_count[w = clens[i]]++;\n        if (maxlen < w) maxlen = w;\n        ctree[i] = 0;\n      }\n      bl_count[0] = 0;\n      for (i = 1; i <= maxlen; ++i) bl_count[i + 16] = ccode = ccode + bl_count[i - 1] << 1;\n      for (i = 0; i < L; ++i) {\n        ccode = clens[i];\n        if (ccode != 0) ctree[i] = bl_count[ccode + 16]++;\n      }\n\n      /* cmap[maxlen + 4 bits] = (off&15) + (lit<<4) reverse mapping */\n      var cleni = 0;\n      for (i = 0; i < L; ++i) {\n        cleni = clens[i];\n        if (cleni != 0) {\n          ccode = bit_swap_n(ctree[i], maxlen) >> maxlen - cleni;\n          for (j = (1 << maxlen + 4 - cleni) - 1; j >= 0; --j) cmap[ccode | j << cleni] = cleni & 15 | i << 4;\n        }\n      }\n      return maxlen;\n    }\n\n    /* Fixed Huffman */\n    var fix_lmap = use_typed_arrays ? new Uint16Array(512) : zero_fill_array(512);\n    var fix_dmap = use_typed_arrays ? new Uint16Array(32) : zero_fill_array(32);\n    if (!use_typed_arrays) {\n      for (var i = 0; i < 512; ++i) fix_lmap[i] = 0;\n      for (i = 0; i < 32; ++i) fix_dmap[i] = 0;\n    }\n    (function () {\n      var dlens = [];\n      var i = 0;\n      for (; i < 32; i++) dlens.push(5);\n      build_tree(dlens, fix_dmap, 32);\n      var clens = [];\n      i = 0;\n      for (; i <= 143; i++) clens.push(8);\n      for (; i <= 255; i++) clens.push(9);\n      for (; i <= 279; i++) clens.push(7);\n      for (; i <= 287; i++) clens.push(8);\n      build_tree(clens, fix_lmap, 288);\n    })();\n    var _deflateRaw = function _deflateRawIIFE() {\n      var DST_LN_RE = use_typed_arrays ? new Uint8Array(0x8000) : [];\n      var j = 0,\n        k = 0;\n      for (; j < DST_LN.length - 1; ++j) {\n        for (; k < DST_LN[j + 1]; ++k) DST_LN_RE[k] = j;\n      }\n      for (; k < 32768; ++k) DST_LN_RE[k] = 29;\n      var LEN_LN_RE = use_typed_arrays ? new Uint8Array(0x103) : [];\n      for (j = 0, k = 0; j < LEN_LN.length - 1; ++j) {\n        for (; k < LEN_LN[j + 1]; ++k) LEN_LN_RE[k] = j;\n      }\n      function write_stored(data, out) {\n        var boff = 0;\n        while (boff < data.length) {\n          var L = Math.min(0xFFFF, data.length - boff);\n          var h = boff + L == data.length;\n          out.write_shift(1, +h);\n          out.write_shift(2, L);\n          out.write_shift(2, ~L & 0xFFFF);\n          while (L-- > 0) out[out.l++] = data[boff++];\n        }\n        return out.l;\n      }\n\n      /* Fixed Huffman */\n      function write_huff_fixed(data, out) {\n        var bl = 0;\n        var boff = 0;\n        var addrs = use_typed_arrays ? new Uint16Array(0x8000) : [];\n        while (boff < data.length) {\n          var L = /* data.length - boff; */Math.min(0xFFFF, data.length - boff);\n\n          /* write a stored block for short data */\n          if (L < 10) {\n            bl = write_bits_3(out, bl, +!!(boff + L == data.length)); // jshint ignore:line\n            if (bl & 7) bl += 8 - (bl & 7);\n            out.l = bl / 8 | 0;\n            out.write_shift(2, L);\n            out.write_shift(2, ~L & 0xFFFF);\n            while (L-- > 0) out[out.l++] = data[boff++];\n            bl = out.l * 8;\n            continue;\n          }\n          bl = write_bits_3(out, bl, +!!(boff + L == data.length) + 2); // jshint ignore:line\n          var hash = 0;\n          while (L-- > 0) {\n            var d = data[boff];\n            hash = (hash << 5 ^ d) & 0x7FFF;\n            var match = -1,\n              mlen = 0;\n            if (match = addrs[hash]) {\n              match |= boff & ~0x7FFF;\n              if (match > boff) match -= 0x8000;\n              if (match < boff) while (data[match + mlen] == data[boff + mlen] && mlen < 250) ++mlen;\n            }\n            if (mlen > 2) {\n              /* Copy Token  */\n              d = LEN_LN_RE[mlen];\n              if (d <= 22) bl = write_bits_8(out, bl, bitswap8[d + 1] >> 1) - 1;else {\n                write_bits_8(out, bl, 3);\n                bl += 5;\n                write_bits_8(out, bl, bitswap8[d - 23] >> 5);\n                bl += 3;\n              }\n              var len_eb = d < 8 ? 0 : d - 4 >> 2;\n              if (len_eb > 0) {\n                write_bits_16(out, bl, mlen - LEN_LN[d]);\n                bl += len_eb;\n              }\n              d = DST_LN_RE[boff - match];\n              bl = write_bits_8(out, bl, bitswap8[d] >> 3);\n              bl -= 3;\n              var dst_eb = d < 4 ? 0 : d - 2 >> 1;\n              if (dst_eb > 0) {\n                write_bits_16(out, bl, boff - match - DST_LN[d]);\n                bl += dst_eb;\n              }\n              for (var q = 0; q < mlen; ++q) {\n                addrs[hash] = boff & 0x7FFF;\n                hash = (hash << 5 ^ data[boff]) & 0x7FFF;\n                ++boff;\n              }\n              L -= mlen - 1;\n            } else {\n              /* Literal Token */\n              if (d <= 143) d = d + 48;else bl = write_bits_1(out, bl, 1);\n              bl = write_bits_8(out, bl, bitswap8[d]);\n              addrs[hash] = boff & 0x7FFF;\n              ++boff;\n            }\n          }\n          bl = write_bits_8(out, bl, 0) - 1;\n        }\n        out.l = (bl + 7) / 8 | 0;\n        return out.l;\n      }\n      return function _deflateRaw(data, out) {\n        if (data.length < 8) return write_stored(data, out);\n        return write_huff_fixed(data, out);\n      };\n    }();\n    function _deflate(data) {\n      var buf = new_buf(50 + Math.floor(data.length * 1.1));\n      var off = _deflateRaw(data, buf);\n      return buf.slice(0, off);\n    }\n    /* modified inflate function also moves original read head */\n\n    var dyn_lmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);\n    var dyn_dmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);\n    var dyn_cmap = use_typed_arrays ? new Uint16Array(128) : zero_fill_array(128);\n    var dyn_len_1 = 1,\n      dyn_len_2 = 1;\n\n    /* 5.5.3 Expanding Huffman Codes */\n    function dyn(data, boff) {\n      /* nomenclature from RFC1951 refers to bit values; these are offset by the implicit constant */\n      var _HLIT = read_bits_5(data, boff) + 257;\n      boff += 5;\n      var _HDIST = read_bits_5(data, boff) + 1;\n      boff += 5;\n      var _HCLEN = read_bits_4(data, boff) + 4;\n      boff += 4;\n      var w = 0;\n\n      /* grab and store code lengths */\n      var clens = use_typed_arrays ? new Uint8Array(19) : zero_fill_array(19);\n      var ctree = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n      var maxlen = 1;\n      var bl_count = use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);\n      var next_code = use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);\n      var L = clens.length; /* 19 */\n      for (var i = 0; i < _HCLEN; ++i) {\n        clens[CLEN_ORDER[i]] = w = read_bits_3(data, boff);\n        if (maxlen < w) maxlen = w;\n        bl_count[w]++;\n        boff += 3;\n      }\n\n      /* build code tree */\n      var ccode = 0;\n      bl_count[0] = 0;\n      for (i = 1; i <= maxlen; ++i) next_code[i] = ccode = ccode + bl_count[i - 1] << 1;\n      for (i = 0; i < L; ++i) if ((ccode = clens[i]) != 0) ctree[i] = next_code[ccode]++;\n      /* cmap[7 bits from stream] = (off&7) + (lit<<3) */\n      var cleni = 0;\n      for (i = 0; i < L; ++i) {\n        cleni = clens[i];\n        if (cleni != 0) {\n          ccode = bitswap8[ctree[i]] >> 8 - cleni;\n          for (var j = (1 << 7 - cleni) - 1; j >= 0; --j) dyn_cmap[ccode | j << cleni] = cleni & 7 | i << 3;\n        }\n      }\n\n      /* read literal and dist codes at once */\n      var hcodes = [];\n      maxlen = 1;\n      for (; hcodes.length < _HLIT + _HDIST;) {\n        ccode = dyn_cmap[read_bits_7(data, boff)];\n        boff += ccode & 7;\n        switch (ccode >>>= 3) {\n          case 16:\n            w = 3 + read_bits_2(data, boff);\n            boff += 2;\n            ccode = hcodes[hcodes.length - 1];\n            while (w-- > 0) hcodes.push(ccode);\n            break;\n          case 17:\n            w = 3 + read_bits_3(data, boff);\n            boff += 3;\n            while (w-- > 0) hcodes.push(0);\n            break;\n          case 18:\n            w = 11 + read_bits_7(data, boff);\n            boff += 7;\n            while (w-- > 0) hcodes.push(0);\n            break;\n          default:\n            hcodes.push(ccode);\n            if (maxlen < ccode) maxlen = ccode;\n            break;\n        }\n      }\n\n      /* build literal / length trees */\n      var h1 = hcodes.slice(0, _HLIT),\n        h2 = hcodes.slice(_HLIT);\n      for (i = _HLIT; i < 286; ++i) h1[i] = 0;\n      for (i = _HDIST; i < 30; ++i) h2[i] = 0;\n      dyn_len_1 = build_tree(h1, dyn_lmap, 286);\n      dyn_len_2 = build_tree(h2, dyn_dmap, 30);\n      return boff;\n    }\n\n    /* return [ data, bytesRead ] */\n    function inflate(data, usz) {\n      /* shortcircuit for empty buffer [0x03, 0x00] */\n      if (data[0] == 3 && !(data[1] & 0x3)) {\n        return [new_raw_buf(usz), 2];\n      }\n\n      /* bit offset */\n      var boff = 0;\n\n      /* header includes final bit and type bits */\n      var header = 0;\n      var outbuf = new_unsafe_buf(usz ? usz : 1 << 18);\n      var woff = 0;\n      var OL = outbuf.length >>> 0;\n      var max_len_1 = 0,\n        max_len_2 = 0;\n      while ((header & 1) == 0) {\n        header = read_bits_3(data, boff);\n        boff += 3;\n        if (header >>> 1 == 0) {\n          /* Stored block */\n          if (boff & 7) boff += 8 - (boff & 7);\n          /* 2 bytes sz, 2 bytes bit inverse */\n          var sz = data[boff >>> 3] | data[(boff >>> 3) + 1] << 8;\n          boff += 32;\n          /* push sz bytes */\n          if (sz > 0) {\n            if (!usz && OL < woff + sz) {\n              outbuf = realloc(outbuf, woff + sz);\n              OL = outbuf.length;\n            }\n            while (sz-- > 0) {\n              outbuf[woff++] = data[boff >>> 3];\n              boff += 8;\n            }\n          }\n          continue;\n        } else if (header >> 1 == 1) {\n          /* Fixed Huffman */\n          max_len_1 = 9;\n          max_len_2 = 5;\n        } else {\n          /* Dynamic Huffman */\n          boff = dyn(data, boff);\n          max_len_1 = dyn_len_1;\n          max_len_2 = dyn_len_2;\n        }\n        for (;;) {\n          // while(true) is apparently out of vogue in modern JS circles\n          if (!usz && OL < woff + 32767) {\n            outbuf = realloc(outbuf, woff + 32767);\n            OL = outbuf.length;\n          }\n          /* ingest code and move read head */\n          var bits = read_bits_n(data, boff, max_len_1);\n          var code = header >>> 1 == 1 ? fix_lmap[bits] : dyn_lmap[bits];\n          boff += code & 15;\n          code >>>= 4;\n          /* 0-255 are literals, 256 is end of block token, 257+ are copy tokens */\n          if ((code >>> 8 & 0xFF) === 0) outbuf[woff++] = code;else if (code == 256) break;else {\n            code -= 257;\n            var len_eb = code < 8 ? 0 : code - 4 >> 2;\n            if (len_eb > 5) len_eb = 0;\n            var tgt = woff + LEN_LN[code];\n            /* length extra bits */\n            if (len_eb > 0) {\n              tgt += read_bits_n(data, boff, len_eb);\n              boff += len_eb;\n            }\n\n            /* dist code */\n            bits = read_bits_n(data, boff, max_len_2);\n            code = header >>> 1 == 1 ? fix_dmap[bits] : dyn_dmap[bits];\n            boff += code & 15;\n            code >>>= 4;\n            var dst_eb = code < 4 ? 0 : code - 2 >> 1;\n            var dst = DST_LN[code];\n            /* dist extra bits */\n            if (dst_eb > 0) {\n              dst += read_bits_n(data, boff, dst_eb);\n              boff += dst_eb;\n            }\n\n            /* in the common case, manual byte copy is faster than TA set / Buffer copy */\n            if (!usz && OL < tgt) {\n              outbuf = realloc(outbuf, tgt + 100);\n              OL = outbuf.length;\n            }\n            while (woff < tgt) {\n              outbuf[woff] = outbuf[woff - dst];\n              ++woff;\n            }\n          }\n        }\n      }\n      if (usz) return [outbuf, boff + 7 >>> 3];\n      return [outbuf.slice(0, woff), boff + 7 >>> 3];\n    }\n    function _inflate(payload, usz) {\n      var data = payload.slice(payload.l || 0);\n      var out = inflate(data, usz);\n      payload.l += out[1];\n      return out[0];\n    }\n    function warn_or_throw(wrn, msg) {\n      if (wrn) {\n        if (typeof console !== 'undefined') console.error(msg);\n      } else throw new Error(msg);\n    }\n    function parse_zip(file, options) {\n      var blob = file;\n      prep_blob(blob, 0);\n      var FileIndex = [],\n        FullPaths = [];\n      var o = {\n        FileIndex: FileIndex,\n        FullPaths: FullPaths\n      };\n      init_cfb(o, {\n        root: options.root\n      });\n\n      /* find end of central directory, start just after signature */\n      var i = blob.length - 4;\n      while ((blob[i] != 0x50 || blob[i + 1] != 0x4b || blob[i + 2] != 0x05 || blob[i + 3] != 0x06) && i >= 0) --i;\n      blob.l = i + 4;\n\n      /* parse end of central directory */\n      blob.l += 4;\n      var fcnt = blob.read_shift(2);\n      blob.l += 6;\n      var start_cd = blob.read_shift(4);\n\n      /* parse central directory */\n      blob.l = start_cd;\n      for (i = 0; i < fcnt; ++i) {\n        /* trust local file header instead of CD entry */\n        blob.l += 20;\n        var csz = blob.read_shift(4);\n        var usz = blob.read_shift(4);\n        var namelen = blob.read_shift(2);\n        var efsz = blob.read_shift(2);\n        var fcsz = blob.read_shift(2);\n        blob.l += 8;\n        var offset = blob.read_shift(4);\n        var EF = parse_extra_field(blob.slice(blob.l + namelen, blob.l + namelen + efsz));\n        blob.l += namelen + efsz + fcsz;\n        var L = blob.l;\n        blob.l = offset + 4;\n        parse_local_file(blob, csz, usz, o, EF);\n        blob.l = L;\n      }\n      return o;\n    }\n\n    /* head starts just after local file header signature */\n    function parse_local_file(blob, csz, usz, o, EF) {\n      /* [local file header] */\n      blob.l += 2;\n      var flags = blob.read_shift(2);\n      var meth = blob.read_shift(2);\n      var date = parse_dos_date(blob);\n      if (flags & 0x2041) throw new Error(\"Unsupported ZIP encryption\");\n      var crc32 = blob.read_shift(4);\n      var _csz = blob.read_shift(4);\n      var _usz = blob.read_shift(4);\n      var namelen = blob.read_shift(2);\n      var efsz = blob.read_shift(2);\n\n      // TODO: flags & (1<<11) // UTF8\n      var name = \"\";\n      for (var i = 0; i < namelen; ++i) name += String.fromCharCode(blob[blob.l++]);\n      if (efsz) {\n        var ef = parse_extra_field(blob.slice(blob.l, blob.l + efsz));\n        if ((ef[0x5455] || {}).mt) date = ef[0x5455].mt;\n        if (((EF || {})[0x5455] || {}).mt) date = EF[0x5455].mt;\n      }\n      blob.l += efsz;\n\n      /* [encryption header] */\n\n      /* [file data] */\n      var data = blob.slice(blob.l, blob.l + _csz);\n      switch (meth) {\n        case 8:\n          data = _inflateRawSync(blob, _usz);\n          break;\n        case 0:\n          break;\n        // TODO: scan for magic number\n        default:\n          throw new Error(\"Unsupported ZIP Compression method \" + meth);\n      }\n\n      /* [data descriptor] */\n      var wrn = false;\n      if (flags & 8) {\n        crc32 = blob.read_shift(4);\n        if (crc32 == 0x08074b50) {\n          crc32 = blob.read_shift(4);\n          wrn = true;\n        }\n        _csz = blob.read_shift(4);\n        _usz = blob.read_shift(4);\n      }\n      if (_csz != csz) warn_or_throw(wrn, \"Bad compressed size: \" + csz + \" != \" + _csz);\n      if (_usz != usz) warn_or_throw(wrn, \"Bad uncompressed size: \" + usz + \" != \" + _usz);\n      //var _crc32 = CRC32.buf(data, 0);\n      //if((crc32>>0) != (_crc32>>0)) warn_or_throw(wrn, \"Bad CRC32 checksum: \" + crc32 + \" != \" + _crc32);\n      cfb_add(o, name, data, {\n        unsafe: true,\n        mt: date\n      });\n    }\n    function write_zip(cfb, options) {\n      var _opts = options || {};\n      var out = [],\n        cdirs = [];\n      var o = new_buf(1);\n      var method = _opts.compression ? 8 : 0,\n        flags = 0;\n      var desc = false;\n      if (desc) flags |= 8;\n      var i = 0,\n        j = 0;\n      var start_cd = 0,\n        fcnt = 0;\n      var root = cfb.FullPaths[0],\n        fp = root,\n        fi = cfb.FileIndex[0];\n      var crcs = [];\n      var sz_cd = 0;\n      for (i = 1; i < cfb.FullPaths.length; ++i) {\n        fp = cfb.FullPaths[i].slice(root.length);\n        fi = cfb.FileIndex[i];\n        if (!fi.size || !fi.content || fp == \"\\u0001Sh33tJ5\") continue;\n        var start = start_cd;\n\n        /* TODO: CP437 filename */\n        var namebuf = new_buf(fp.length);\n        for (j = 0; j < fp.length; ++j) namebuf.write_shift(1, fp.charCodeAt(j) & 0x7F);\n        namebuf = namebuf.slice(0, namebuf.l);\n        crcs[fcnt] = CRC32.buf(fi.content, 0);\n        var outbuf = fi.content;\n        if (method == 8) outbuf = _deflateRawSync(outbuf);\n\n        /* local file header */\n        o = new_buf(30);\n        o.write_shift(4, 0x04034b50);\n        o.write_shift(2, 20);\n        o.write_shift(2, flags);\n        o.write_shift(2, method);\n        /* TODO: last mod file time/date */\n        if (fi.mt) write_dos_date(o, fi.mt);else o.write_shift(4, 0);\n        o.write_shift(-4, flags & 8 ? 0 : crcs[fcnt]);\n        o.write_shift(4, flags & 8 ? 0 : outbuf.length);\n        o.write_shift(4, flags & 8 ? 0 : fi.content.length);\n        o.write_shift(2, namebuf.length);\n        o.write_shift(2, 0);\n        start_cd += o.length;\n        out.push(o);\n        start_cd += namebuf.length;\n        out.push(namebuf);\n\n        /* TODO: extra fields? */\n\n        /* TODO: encryption header ? */\n\n        start_cd += outbuf.length;\n        out.push(outbuf);\n\n        /* data descriptor */\n        if (flags & 8) {\n          o = new_buf(12);\n          o.write_shift(-4, crcs[fcnt]);\n          o.write_shift(4, outbuf.length);\n          o.write_shift(4, fi.content.length);\n          start_cd += o.l;\n          out.push(o);\n        }\n\n        /* central directory */\n        o = new_buf(46);\n        o.write_shift(4, 0x02014b50);\n        o.write_shift(2, 0);\n        o.write_shift(2, 20);\n        o.write_shift(2, flags);\n        o.write_shift(2, method);\n        o.write_shift(4, 0); /* TODO: last mod file time/date */\n        o.write_shift(-4, crcs[fcnt]);\n        o.write_shift(4, outbuf.length);\n        o.write_shift(4, fi.content.length);\n        o.write_shift(2, namebuf.length);\n        o.write_shift(2, 0);\n        o.write_shift(2, 0);\n        o.write_shift(2, 0);\n        o.write_shift(2, 0);\n        o.write_shift(4, 0);\n        o.write_shift(4, start);\n        sz_cd += o.l;\n        cdirs.push(o);\n        sz_cd += namebuf.length;\n        cdirs.push(namebuf);\n        ++fcnt;\n      }\n\n      /* end of central directory */\n      o = new_buf(22);\n      o.write_shift(4, 0x06054b50);\n      o.write_shift(2, 0);\n      o.write_shift(2, 0);\n      o.write_shift(2, fcnt);\n      o.write_shift(2, fcnt);\n      o.write_shift(4, sz_cd);\n      o.write_shift(4, start_cd);\n      o.write_shift(2, 0);\n      return bconcat([bconcat(out), bconcat(cdirs), o]);\n    }\n    var ContentTypeMap = {\n      \"htm\": \"text/html\",\n      \"xml\": \"text/xml\",\n      \"gif\": \"image/gif\",\n      \"jpg\": \"image/jpeg\",\n      \"png\": \"image/png\",\n      \"mso\": \"application/x-mso\",\n      \"thmx\": \"application/vnd.ms-officetheme\",\n      \"sh33tj5\": \"application/octet-stream\"\n    };\n    function get_content_type(fi, fp) {\n      if (fi.ctype) return fi.ctype;\n      var ext = fi.name || \"\",\n        m = ext.match(/\\.([^\\.]+)$/);\n      if (m && ContentTypeMap[m[1]]) return ContentTypeMap[m[1]];\n      if (fp) {\n        m = (ext = fp).match(/[\\.\\\\]([^\\.\\\\])+$/);\n        if (m && ContentTypeMap[m[1]]) return ContentTypeMap[m[1]];\n      }\n      return \"application/octet-stream\";\n    }\n\n    /* 76 character chunks TODO: intertwine encoding */\n    function write_base64_76(bstr) {\n      var data = Base64_encode(bstr);\n      var o = [];\n      for (var i = 0; i < data.length; i += 76) o.push(data.slice(i, i + 76));\n      return o.join(\"\\r\\n\") + \"\\r\\n\";\n    }\n\n    /*\n    Rules for QP:\n    \t- escape =## applies for all non-display characters and literal \"=\"\n    \t- space or tab at end of line must be encoded\n    \t- \\r\\n newlines can be preserved, but bare \\r and \\n must be escaped\n    \t- lines must not exceed 76 characters, use soft breaks =\\r\\n\n    \n    TODO: Some files from word appear to write line extensions with bare equals:\n    \n    ```\n    <table class=3DMsoTableGrid border=3D1 cellspacing=3D0 cellpadding=3D0 width=\n    =\"70%\"\n    ```\n    */\n    function write_quoted_printable(text) {\n      var encoded = text.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7E-\\xFF=]/g, function (c) {\n        var w = c.charCodeAt(0).toString(16).toUpperCase();\n        return \"=\" + (w.length == 1 ? \"0\" + w : w);\n      });\n      encoded = encoded.replace(/ $/mg, \"=20\").replace(/\\t$/mg, \"=09\");\n      if (encoded.charAt(0) == \"\\n\") encoded = \"=0D\" + encoded.slice(1);\n      encoded = encoded.replace(/\\r(?!\\n)/mg, \"=0D\").replace(/\\n\\n/mg, \"\\n=0A\").replace(/([^\\r\\n])\\n/mg, \"$1=0A\");\n      var o = [],\n        split = encoded.split(\"\\r\\n\");\n      for (var si = 0; si < split.length; ++si) {\n        var str = split[si];\n        if (str.length == 0) {\n          o.push(\"\");\n          continue;\n        }\n        for (var i = 0; i < str.length;) {\n          var end = 76;\n          var tmp = str.slice(i, i + end);\n          if (tmp.charAt(end - 1) == \"=\") end--;else if (tmp.charAt(end - 2) == \"=\") end -= 2;else if (tmp.charAt(end - 3) == \"=\") end -= 3;\n          tmp = str.slice(i, i + end);\n          i += end;\n          if (i < str.length) tmp += \"=\";\n          o.push(tmp);\n        }\n      }\n      return o.join(\"\\r\\n\");\n    }\n    function parse_quoted_printable(data) {\n      var o = [];\n\n      /* unify long lines */\n      for (var di = 0; di < data.length; ++di) {\n        var line = data[di];\n        while (di <= data.length && line.charAt(line.length - 1) == \"=\") line = line.slice(0, line.length - 1) + data[++di];\n        o.push(line);\n      }\n\n      /* decode */\n      for (var oi = 0; oi < o.length; ++oi) o[oi] = o[oi].replace(/[=][0-9A-Fa-f]{2}/g, function ($$) {\n        return String.fromCharCode(parseInt($$.slice(1), 16));\n      });\n      return s2a(o.join(\"\\r\\n\"));\n    }\n    function parse_mime(cfb, data, root) {\n      var fname = \"\",\n        cte = \"\",\n        ctype = \"\",\n        fdata;\n      var di = 0;\n      for (; di < 10; ++di) {\n        var line = data[di];\n        if (!line || line.match(/^\\s*$/)) break;\n        var m = line.match(/^(.*?):\\s*([^\\s].*)$/);\n        if (m) switch (m[1].toLowerCase()) {\n          case \"content-location\":\n            fname = m[2].trim();\n            break;\n          case \"content-type\":\n            ctype = m[2].trim();\n            break;\n          case \"content-transfer-encoding\":\n            cte = m[2].trim();\n            break;\n        }\n      }\n      ++di;\n      switch (cte.toLowerCase()) {\n        case 'base64':\n          fdata = s2a(Base64_decode(data.slice(di).join(\"\")));\n          break;\n        case 'quoted-printable':\n          fdata = parse_quoted_printable(data.slice(di));\n          break;\n        default:\n          throw new Error(\"Unsupported Content-Transfer-Encoding \" + cte);\n      }\n      var file = cfb_add(cfb, fname.slice(root.length), fdata, {\n        unsafe: true\n      });\n      if (ctype) file.ctype = ctype;\n    }\n    function parse_mad(file, options) {\n      if (a2s(file.slice(0, 13)).toLowerCase() != \"mime-version:\") throw new Error(\"Unsupported MAD header\");\n      var root = options && options.root || \"\";\n      // $FlowIgnore\n      var data = (has_buf && Buffer.isBuffer(file) ? file.toString(\"binary\") : a2s(file)).split(\"\\r\\n\");\n      var di = 0,\n        row = \"\";\n\n      /* if root is not specified, scan for the common prefix */\n      for (di = 0; di < data.length; ++di) {\n        row = data[di];\n        if (!/^Content-Location:/i.test(row)) continue;\n        row = row.slice(row.indexOf(\"file\"));\n        if (!root) root = row.slice(0, row.lastIndexOf(\"/\") + 1);\n        if (row.slice(0, root.length) == root) continue;\n        while (root.length > 0) {\n          root = root.slice(0, root.length - 1);\n          root = root.slice(0, root.lastIndexOf(\"/\") + 1);\n          if (row.slice(0, root.length) == root) break;\n        }\n      }\n      var mboundary = (data[1] || \"\").match(/boundary=\"(.*?)\"/);\n      if (!mboundary) throw new Error(\"MAD cannot find boundary\");\n      var boundary = \"--\" + (mboundary[1] || \"\");\n      var FileIndex = [],\n        FullPaths = [];\n      var o = {\n        FileIndex: FileIndex,\n        FullPaths: FullPaths\n      };\n      init_cfb(o);\n      var start_di,\n        fcnt = 0;\n      for (di = 0; di < data.length; ++di) {\n        var line = data[di];\n        if (line !== boundary && line !== boundary + \"--\") continue;\n        if (fcnt++) parse_mime(o, data.slice(start_di, di), root);\n        start_di = di;\n      }\n      return o;\n    }\n    function write_mad(cfb, options) {\n      var opts = options || {};\n      var boundary = opts.boundary || \"SheetJS\";\n      boundary = '------=' + boundary;\n      var out = ['MIME-Version: 1.0', 'Content-Type: multipart/related; boundary=\"' + boundary.slice(2) + '\"', '', '', ''];\n      var root = cfb.FullPaths[0],\n        fp = root,\n        fi = cfb.FileIndex[0];\n      for (var i = 1; i < cfb.FullPaths.length; ++i) {\n        fp = cfb.FullPaths[i].slice(root.length);\n        fi = cfb.FileIndex[i];\n        if (!fi.size || !fi.content || fp == \"\\u0001Sh33tJ5\") continue;\n\n        /* Normalize filename */\n        fp = fp.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7E-\\xFF]/g, function (c) {\n          return \"_x\" + c.charCodeAt(0).toString(16) + \"_\";\n        }).replace(/[\\u0080-\\uFFFF]/g, function (u) {\n          return \"_u\" + u.charCodeAt(0).toString(16) + \"_\";\n        });\n\n        /* Extract content as binary string */\n        var ca = fi.content;\n        // $FlowIgnore\n        var cstr = has_buf && Buffer.isBuffer(ca) ? ca.toString(\"binary\") : a2s(ca);\n\n        /* 4/5 of first 1024 chars ascii -> quoted printable, else base64 */\n        var dispcnt = 0,\n          L = Math.min(1024, cstr.length),\n          cc = 0;\n        for (var csl = 0; csl <= L; ++csl) if ((cc = cstr.charCodeAt(csl)) >= 0x20 && cc < 0x80) ++dispcnt;\n        var qp = dispcnt >= L * 4 / 5;\n        out.push(boundary);\n        out.push('Content-Location: ' + (opts.root || 'file:///C:/SheetJS/') + fp);\n        out.push('Content-Transfer-Encoding: ' + (qp ? 'quoted-printable' : 'base64'));\n        out.push('Content-Type: ' + get_content_type(fi, fp));\n        out.push('');\n        out.push(qp ? write_quoted_printable(cstr) : write_base64_76(cstr));\n      }\n      out.push(boundary + '--\\r\\n');\n      return out.join(\"\\r\\n\");\n    }\n    function cfb_new(opts) {\n      var o = {};\n      init_cfb(o, opts);\n      return o;\n    }\n    function cfb_add(cfb, name, content, opts) {\n      var unsafe = opts && opts.unsafe;\n      if (!unsafe) init_cfb(cfb);\n      var file = !unsafe && CFB.find(cfb, name);\n      if (!file) {\n        var fpath = cfb.FullPaths[0];\n        if (name.slice(0, fpath.length) == fpath) fpath = name;else {\n          if (fpath.slice(-1) != \"/\") fpath += \"/\";\n          fpath = (fpath + name).replace(\"//\", \"/\");\n        }\n        file = {\n          name: filename(name),\n          type: 2\n        };\n        cfb.FileIndex.push(file);\n        cfb.FullPaths.push(fpath);\n        if (!unsafe) CFB.utils.cfb_gc(cfb);\n      }\n      file.content = content;\n      file.size = content ? content.length : 0;\n      if (opts) {\n        if (opts.CLSID) file.clsid = opts.CLSID;\n        if (opts.mt) file.mt = opts.mt;\n        if (opts.ct) file.ct = opts.ct;\n      }\n      return file;\n    }\n    function cfb_del(cfb, name) {\n      init_cfb(cfb);\n      var file = CFB.find(cfb, name);\n      if (file) for (var j = 0; j < cfb.FileIndex.length; ++j) if (cfb.FileIndex[j] == file) {\n        cfb.FileIndex.splice(j, 1);\n        cfb.FullPaths.splice(j, 1);\n        return true;\n      }\n      return false;\n    }\n    function cfb_mov(cfb, old_name, new_name) {\n      init_cfb(cfb);\n      var file = CFB.find(cfb, old_name);\n      if (file) for (var j = 0; j < cfb.FileIndex.length; ++j) if (cfb.FileIndex[j] == file) {\n        cfb.FileIndex[j].name = filename(new_name);\n        cfb.FullPaths[j] = new_name;\n        return true;\n      }\n      return false;\n    }\n    function cfb_gc(cfb) {\n      rebuild_cfb(cfb, true);\n    }\n    exports.find = find;\n    exports.read = read;\n    exports.parse = parse;\n    exports.write = write;\n    exports.writeFile = write_file;\n    exports.utils = {\n      cfb_new: cfb_new,\n      cfb_add: cfb_add,\n      cfb_del: cfb_del,\n      cfb_mov: cfb_mov,\n      cfb_gc: cfb_gc,\n      ReadShift: ReadShift,\n      CheckField: CheckField,\n      prep_blob: prep_blob,\n      bconcat: bconcat,\n      use_zlib: use_zlib,\n      _deflateRaw: _deflate,\n      _inflateRaw: _inflate,\n      consts: consts\n    };\n    return exports;\n  }();\n  var _fs;\n  if (typeof require !== 'undefined') try {\n    _fs = require('fs');\n  } catch (e) {}\n\n  /* normalize data for blob ctor */\n  function blobify(data) {\n    if (typeof data === \"string\") return s2ab(data);\n    if (Array.isArray(data)) return a2u(data);\n    return data;\n  }\n  /* write or download file */\n  function write_dl(fname, payload, enc) {\n    /*global IE_SaveFile, Blob, navigator, saveAs, document, File, chrome */\n    if (typeof _fs !== 'undefined' && _fs.writeFileSync) return enc ? _fs.writeFileSync(fname, payload, enc) : _fs.writeFileSync(fname, payload);\n    if (typeof Deno !== 'undefined') {\n      /* in this spot, it's safe to assume typed arrays and TextEncoder/TextDecoder exist */\n      if (enc && typeof payload == \"string\") switch (enc) {\n        case \"utf8\":\n          payload = new TextEncoder(enc).encode(payload);\n          break;\n        case \"binary\":\n          payload = s2ab(payload);\n          break;\n        /* TODO: binary equivalent */\n        default:\n          throw new Error(\"Unsupported encoding \" + enc);\n      }\n      return Deno.writeFileSync(fname, payload);\n    }\n    var data = enc == \"utf8\" ? utf8write(payload) : payload;\n    if (typeof IE_SaveFile !== 'undefined') return IE_SaveFile(data, fname);\n    if (typeof Blob !== 'undefined') {\n      var blob = new Blob([blobify(data)], {\n        type: \"application/octet-stream\"\n      });\n      if (typeof navigator !== 'undefined' && navigator.msSaveBlob) return navigator.msSaveBlob(blob, fname);\n      if (typeof saveAs !== 'undefined') return saveAs(blob, fname);\n      if (typeof URL !== 'undefined' && typeof document !== 'undefined' && document.createElement && URL.createObjectURL) {\n        var url = URL.createObjectURL(blob);\n        if (typeof chrome === 'object' && typeof (chrome.downloads || {}).download == \"function\") {\n          if (URL.revokeObjectURL && typeof setTimeout !== 'undefined') setTimeout(function () {\n            URL.revokeObjectURL(url);\n          }, 60000);\n          return chrome.downloads.download({\n            url: url,\n            filename: fname,\n            saveAs: true\n          });\n        }\n        var a = document.createElement(\"a\");\n        if (a.download != null) {\n          a.download = fname;\n          a.href = url;\n          document.body.appendChild(a);\n          a.click();\n          document.body.removeChild(a);\n          if (URL.revokeObjectURL && typeof setTimeout !== 'undefined') setTimeout(function () {\n            URL.revokeObjectURL(url);\n          }, 60000);\n          return url;\n        }\n      }\n    }\n    // $FlowIgnore\n    if (typeof $ !== 'undefined' && typeof File !== 'undefined' && typeof Folder !== 'undefined') try {\n      // extendscript\n      // $FlowIgnore\n      var out = File(fname);\n      out.open(\"w\");\n      out.encoding = \"binary\";\n      if (Array.isArray(payload)) payload = a2s(payload);\n      out.write(payload);\n      out.close();\n      return payload;\n    } catch (e) {\n      if (!e.message || !e.message.match(/onstruct/)) throw e;\n    }\n    throw new Error(\"cannot save file \" + fname);\n  }\n\n  /* read binary data from file */\n  function read_binary(path) {\n    if (typeof _fs !== 'undefined') return _fs.readFileSync(path);\n    if (typeof Deno !== 'undefined') return Deno.readFileSync(path);\n    // $FlowIgnore\n    if (typeof $ !== 'undefined' && typeof File !== 'undefined' && typeof Folder !== 'undefined') try {\n      // extendscript\n      // $FlowIgnore\n      var infile = File(path);\n      infile.open(\"r\");\n      infile.encoding = \"binary\";\n      var data = infile.read();\n      infile.close();\n      return data;\n    } catch (e) {\n      if (!e.message || !e.message.match(/onstruct/)) throw e;\n    }\n    throw new Error(\"Cannot access file \" + path);\n  }\n  function keys(o) {\n    var ks = Object.keys(o),\n      o2 = [];\n    for (var i = 0; i < ks.length; ++i) if (Object.prototype.hasOwnProperty.call(o, ks[i])) o2.push(ks[i]);\n    return o2;\n  }\n  function evert_key(obj, key) {\n    var o = [],\n      K = keys(obj);\n    for (var i = 0; i !== K.length; ++i) if (o[obj[K[i]][key]] == null) o[obj[K[i]][key]] = K[i];\n    return o;\n  }\n  function evert(obj) {\n    var o = [],\n      K = keys(obj);\n    for (var i = 0; i !== K.length; ++i) o[obj[K[i]]] = K[i];\n    return o;\n  }\n  function evert_num(obj) {\n    var o = [],\n      K = keys(obj);\n    for (var i = 0; i !== K.length; ++i) o[obj[K[i]]] = parseInt(K[i], 10);\n    return o;\n  }\n  function evert_arr(obj) {\n    var o = [],\n      K = keys(obj);\n    for (var i = 0; i !== K.length; ++i) {\n      if (o[obj[K[i]]] == null) o[obj[K[i]]] = [];\n      o[obj[K[i]]].push(K[i]);\n    }\n    return o;\n  }\n  var basedate = new Date(1899, 11, 30, 0, 0, 0); // 2209161600000\n  function datenum(v, date1904) {\n    var epoch = v.getTime();\n    if (date1904) epoch -= 1462 * 24 * 60 * 60 * 1000;\n    var dnthresh = basedate.getTime() + (v.getTimezoneOffset() - basedate.getTimezoneOffset()) * 60000;\n    return (epoch - dnthresh) / (24 * 60 * 60 * 1000);\n  }\n  var refdate = new Date();\n  var dnthresh = basedate.getTime() + (refdate.getTimezoneOffset() - basedate.getTimezoneOffset()) * 60000;\n  var refoffset = refdate.getTimezoneOffset();\n  function numdate(v) {\n    var out = new Date();\n    out.setTime(v * 24 * 60 * 60 * 1000 + dnthresh);\n    if (out.getTimezoneOffset() !== refoffset) {\n      out.setTime(out.getTime() + (out.getTimezoneOffset() - refoffset) * 60000);\n    }\n    return out;\n  }\n\n  /* ISO 8601 Duration */\n  function parse_isodur(s) {\n    var sec = 0,\n      mt = 0,\n      time = false;\n    var m = s.match(/P([0-9\\.]+Y)?([0-9\\.]+M)?([0-9\\.]+D)?T([0-9\\.]+H)?([0-9\\.]+M)?([0-9\\.]+S)?/);\n    if (!m) throw new Error(\"|\" + s + \"| is not an ISO8601 Duration\");\n    for (var i = 1; i != m.length; ++i) {\n      if (!m[i]) continue;\n      mt = 1;\n      if (i > 3) time = true;\n      switch (m[i].slice(m[i].length - 1)) {\n        case 'Y':\n          throw new Error(\"Unsupported ISO Duration Field: \" + m[i].slice(m[i].length - 1));\n        case 'D':\n          mt *= 24;\n        /* falls through */\n        case 'H':\n          mt *= 60;\n        /* falls through */\n        case 'M':\n          if (!time) throw new Error(\"Unsupported ISO Duration Field: M\");else mt *= 60;\n        /* falls through */\n        case 'S':\n          break;\n      }\n      sec += mt * parseInt(m[i], 10);\n    }\n    return sec;\n  }\n  var good_pd_date_1 = new Date('2017-02-19T19:06:09.000Z');\n  var good_pd_date = isNaN(good_pd_date_1.getFullYear()) ? new Date('2/19/17') : good_pd_date_1;\n  var good_pd = good_pd_date.getFullYear() == 2017;\n  /* parses a date as a local date */\n  function parseDate(str, fixdate) {\n    var d = new Date(str);\n    if (good_pd) {\n      if (fixdate > 0) d.setTime(d.getTime() + d.getTimezoneOffset() * 60 * 1000);else if (fixdate < 0) d.setTime(d.getTime() - d.getTimezoneOffset() * 60 * 1000);\n      return d;\n    }\n    if (str instanceof Date) return str;\n    if (good_pd_date.getFullYear() == 1917 && !isNaN(d.getFullYear())) {\n      var s = d.getFullYear();\n      if (str.indexOf(\"\" + s) > -1) return d;\n      d.setFullYear(d.getFullYear() + 100);\n      return d;\n    }\n    var n = str.match(/\\d+/g) || [\"2017\", \"2\", \"19\", \"0\", \"0\", \"0\"];\n    var out = new Date(+n[0], +n[1] - 1, +n[2], +n[3] || 0, +n[4] || 0, +n[5] || 0);\n    if (str.indexOf(\"Z\") > -1) out = new Date(out.getTime() - out.getTimezoneOffset() * 60 * 1000);\n    return out;\n  }\n  function cc2str(arr, debomit) {\n    if (has_buf && Buffer.isBuffer(arr)) {\n      if (debomit) {\n        if (arr[0] == 0xFF && arr[1] == 0xFE) return utf8write(arr.slice(2).toString(\"utf16le\"));\n        if (arr[1] == 0xFE && arr[2] == 0xFF) return utf8write(utf16beread(arr.slice(2).toString(\"binary\")));\n      }\n      return arr.toString(\"binary\");\n    }\n    if (typeof TextDecoder !== \"undefined\") try {\n      if (debomit) {\n        if (arr[0] == 0xFF && arr[1] == 0xFE) return utf8write(new TextDecoder(\"utf-16le\").decode(arr.slice(2)));\n        if (arr[0] == 0xFE && arr[1] == 0xFF) return utf8write(new TextDecoder(\"utf-16be\").decode(arr.slice(2)));\n      }\n      var rev = {\n        \"\\u20ac\": \"\\x80\",\n        \"\\u201a\": \"\\x82\",\n        \"\\u0192\": \"\\x83\",\n        \"\\u201e\": \"\\x84\",\n        \"\\u2026\": \"\\x85\",\n        \"\\u2020\": \"\\x86\",\n        \"\\u2021\": \"\\x87\",\n        \"\\u02c6\": \"\\x88\",\n        \"\\u2030\": \"\\x89\",\n        \"\\u0160\": \"\\x8a\",\n        \"\\u2039\": \"\\x8b\",\n        \"\\u0152\": \"\\x8c\",\n        \"\\u017d\": \"\\x8e\",\n        \"\\u2018\": \"\\x91\",\n        \"\\u2019\": \"\\x92\",\n        \"\\u201c\": \"\\x93\",\n        \"\\u201d\": \"\\x94\",\n        \"\\u2022\": \"\\x95\",\n        \"\\u2013\": \"\\x96\",\n        \"\\u2014\": \"\\x97\",\n        \"\\u02dc\": \"\\x98\",\n        \"\\u2122\": \"\\x99\",\n        \"\\u0161\": \"\\x9a\",\n        \"\\u203a\": \"\\x9b\",\n        \"\\u0153\": \"\\x9c\",\n        \"\\u017e\": \"\\x9e\",\n        \"\\u0178\": \"\\x9f\"\n      };\n      if (Array.isArray(arr)) arr = new Uint8Array(arr);\n      return new TextDecoder(\"latin1\").decode(arr).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g, function (c) {\n        return rev[c] || c;\n      });\n    } catch (e) {}\n    var o = [];\n    for (var i = 0; i != arr.length; ++i) o.push(String.fromCharCode(arr[i]));\n    return o.join(\"\");\n  }\n  function dup(o) {\n    if (typeof JSON != 'undefined' && !Array.isArray(o)) return JSON.parse(JSON.stringify(o));\n    if (typeof o != 'object' || o == null) return o;\n    if (o instanceof Date) return new Date(o.getTime());\n    var out = {};\n    for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) out[k] = dup(o[k]);\n    return out;\n  }\n  function fill(c, l) {\n    var o = \"\";\n    while (o.length < l) o += c;\n    return o;\n  }\n\n  /* TODO: stress test */\n  function fuzzynum(s) {\n    var v = Number(s);\n    if (!isNaN(v)) return isFinite(v) ? v : NaN;\n    if (!/\\d/.test(s)) return v;\n    var wt = 1;\n    var ss = s.replace(/([\\d]),([\\d])/g, \"$1$2\").replace(/[$]/g, \"\").replace(/[%]/g, function () {\n      wt *= 100;\n      return \"\";\n    });\n    if (!isNaN(v = Number(ss))) return v / wt;\n    ss = ss.replace(/[(](.*)[)]/, function ($$, $1) {\n      wt = -wt;\n      return $1;\n    });\n    if (!isNaN(v = Number(ss))) return v / wt;\n    return v;\n  }\n  var lower_months = ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'];\n  function fuzzydate(s) {\n    var o = new Date(s),\n      n = new Date(NaN);\n    var y = o.getYear(),\n      m = o.getMonth(),\n      d = o.getDate();\n    if (isNaN(d)) return n;\n    var lower = s.toLowerCase();\n    if (lower.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)) {\n      lower = lower.replace(/[^a-z]/g, \"\").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/, \"\");\n      if (lower.length > 3 && lower_months.indexOf(lower) == -1) return n;\n    } else if (lower.match(/[a-z]/)) return n;\n    if (y < 0 || y > 8099) return n;\n    if ((m > 0 || d > 1) && y != 101) return o;\n    if (s.match(/[^-0-9:,\\/\\\\]/)) return n;\n    return o;\n  }\n  var split_regex = function () {\n    var safe_split_regex = \"abacaba\".split(/(:?b)/i).length == 5;\n    return function split_regex(str, re, def) {\n      if (safe_split_regex || typeof re == \"string\") return str.split(re);\n      var p = str.split(re),\n        o = [p[0]];\n      for (var i = 1; i < p.length; ++i) {\n        o.push(def);\n        o.push(p[i]);\n      }\n      return o;\n    };\n  }();\n  function getdatastr(data) {\n    if (!data) return null;\n    if (data.content && data.type) return cc2str(data.content, true);\n    if (data.data) return debom(data.data);\n    if (data.asNodeBuffer && has_buf) return debom(data.asNodeBuffer().toString('binary'));\n    if (data.asBinary) return debom(data.asBinary());\n    if (data._data && data._data.getContent) return debom(cc2str(Array.prototype.slice.call(data._data.getContent(), 0)));\n    return null;\n  }\n  function getdatabin(data) {\n    if (!data) return null;\n    if (data.data) return char_codes(data.data);\n    if (data.asNodeBuffer && has_buf) return data.asNodeBuffer();\n    if (data._data && data._data.getContent) {\n      var o = data._data.getContent();\n      if (typeof o == \"string\") return char_codes(o);\n      return Array.prototype.slice.call(o);\n    }\n    if (data.content && data.type) return data.content;\n    return null;\n  }\n  function getdata(data) {\n    return data && data.name.slice(-4) === \".bin\" ? getdatabin(data) : getdatastr(data);\n  }\n\n  /* Part 2 Section 10.1.2 \"Mapping Content Types\" Names are case-insensitive */\n  /* OASIS does not comment on filename case sensitivity */\n  function safegetzipfile(zip, file) {\n    var k = zip.FullPaths || keys(zip.files);\n    var f = file.toLowerCase().replace(/[\\/]/g, '\\\\'),\n      g = f.replace(/\\\\/g, '\\/');\n    for (var i = 0; i < k.length; ++i) {\n      var n = k[i].replace(/^Root Entry[\\/]/, \"\").toLowerCase();\n      if (f == n || g == n) return zip.files ? zip.files[k[i]] : zip.FileIndex[i];\n    }\n    return null;\n  }\n  function getzipfile(zip, file) {\n    var o = safegetzipfile(zip, file);\n    if (o == null) throw new Error(\"Cannot find file \" + file + \" in zip\");\n    return o;\n  }\n  function getzipdata(zip, file, safe) {\n    if (!safe) return getdata(getzipfile(zip, file));\n    if (!file) return null;\n    try {\n      return getzipdata(zip, file);\n    } catch (e) {\n      return null;\n    }\n  }\n  function getzipstr(zip, file, safe) {\n    if (!safe) return getdatastr(getzipfile(zip, file));\n    if (!file) return null;\n    try {\n      return getzipstr(zip, file);\n    } catch (e) {\n      return null;\n    }\n  }\n  function getzipbin(zip, file, safe) {\n    if (!safe) return getdatabin(getzipfile(zip, file));\n    if (!file) return null;\n    try {\n      return getzipbin(zip, file);\n    } catch (e) {\n      return null;\n    }\n  }\n  function zipentries(zip) {\n    var k = zip.FullPaths || keys(zip.files),\n      o = [];\n    for (var i = 0; i < k.length; ++i) if (k[i].slice(-1) != '/') o.push(k[i].replace(/^Root Entry[\\/]/, \"\"));\n    return o.sort();\n  }\n  function zip_add_file(zip, path, content) {\n    if (zip.FullPaths) {\n      if (typeof content == \"string\") {\n        var res;\n        if (has_buf) res = Buffer_from(content);\n        /* TODO: investigate performance in Edge 13 */\n        //else if(typeof TextEncoder !== \"undefined\") res = new TextEncoder().encode(content);\n        else res = utf8decode(content);\n        return CFB.utils.cfb_add(zip, path, res);\n      }\n      CFB.utils.cfb_add(zip, path, content);\n    } else zip.file(path, content);\n  }\n  function zip_new() {\n    return CFB.utils.cfb_new();\n  }\n  function zip_read(d, o) {\n    switch (o.type) {\n      case \"base64\":\n        return CFB.read(d, {\n          type: \"base64\"\n        });\n      case \"binary\":\n        return CFB.read(d, {\n          type: \"binary\"\n        });\n      case \"buffer\":\n      case \"array\":\n        return CFB.read(d, {\n          type: \"buffer\"\n        });\n    }\n    throw new Error(\"Unrecognized type \" + o.type);\n  }\n  function resolve_path(path, base) {\n    if (path.charAt(0) == \"/\") return path.slice(1);\n    var result = base.split('/');\n    if (base.slice(-1) != \"/\") result.pop(); // folder path\n    var target = path.split('/');\n    while (target.length !== 0) {\n      var step = target.shift();\n      if (step === '..') result.pop();else if (step !== '.') result.push(step);\n    }\n    return result.join('/');\n  }\n  var XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\n  var attregexg = /([^\"\\s?>\\/]+)\\s*=\\s*((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:')|([^'\">\\s]+))/g;\n  var tagregex1 = /<[\\/\\?]?[a-zA-Z0-9:_-]+(?:\\s+[^\"\\s?>\\/]+\\s*=\\s*(?:\"[^\"]*\"|'[^']*'|[^'\">\\s=]+))*\\s*[\\/\\?]?>/mg,\n    tagregex2 = /<[^>]*>/g;\n  var tagregex = XML_HEADER.match(tagregex1) ? tagregex1 : tagregex2;\n  var nsregex = /<\\w*:/,\n    nsregex2 = /<(\\/?)\\w+:/;\n  function parsexmltag(tag, skip_root, skip_LC) {\n    var z = {};\n    var eq = 0,\n      c = 0;\n    for (; eq !== tag.length; ++eq) if ((c = tag.charCodeAt(eq)) === 32 || c === 10 || c === 13) break;\n    if (!skip_root) z[0] = tag.slice(0, eq);\n    if (eq === tag.length) return z;\n    var m = tag.match(attregexg),\n      j = 0,\n      v = \"\",\n      i = 0,\n      q = \"\",\n      cc = \"\",\n      quot = 1;\n    if (m) for (i = 0; i != m.length; ++i) {\n      cc = m[i];\n      for (c = 0; c != cc.length; ++c) if (cc.charCodeAt(c) === 61) break;\n      q = cc.slice(0, c).trim();\n      while (cc.charCodeAt(c + 1) == 32) ++c;\n      quot = (eq = cc.charCodeAt(c + 1)) == 34 || eq == 39 ? 1 : 0;\n      v = cc.slice(c + 1 + quot, cc.length - quot);\n      for (j = 0; j != q.length; ++j) if (q.charCodeAt(j) === 58) break;\n      if (j === q.length) {\n        if (q.indexOf(\"_\") > 0) q = q.slice(0, q.indexOf(\"_\")); // from ods\n        z[q] = v;\n        if (!skip_LC) z[q.toLowerCase()] = v;\n      } else {\n        var k = (j === 5 && q.slice(0, 5) === \"xmlns\" ? \"xmlns\" : \"\") + q.slice(j + 1);\n        if (z[k] && q.slice(j - 3, j) == \"ext\") continue; // from ods\n        z[k] = v;\n        if (!skip_LC) z[k.toLowerCase()] = v;\n      }\n    }\n    return z;\n  }\n  function strip_ns(x) {\n    return x.replace(nsregex2, \"<$1\");\n  }\n  var encodings = {\n    '&quot;': '\"',\n    '&apos;': \"'\",\n    '&gt;': '>',\n    '&lt;': '<',\n    '&amp;': '&'\n  };\n  var rencoding = evert(encodings);\n  //var rencstr = \"&<>'\\\"\".split(\"\");\n\n  // TODO: CP remap (need to read file version to determine OS)\n  var unescapexml = function () {\n    /* 22.4.2.4 bstr (Basic String) */\n    var encregex = /&(?:quot|apos|gt|lt|amp|#x?([\\da-fA-F]+));/ig,\n      coderegex = /_x([\\da-fA-F]{4})_/ig;\n    return function unescapexml(text) {\n      var s = text + '',\n        i = s.indexOf(\"<![CDATA[\");\n      if (i == -1) return s.replace(encregex, function ($$, $1) {\n        return encodings[$$] || String.fromCharCode(parseInt($1, $$.indexOf(\"x\") > -1 ? 16 : 10)) || $$;\n      }).replace(coderegex, function (m, c) {\n        return String.fromCharCode(parseInt(c, 16));\n      });\n      var j = s.indexOf(\"]]>\");\n      return unescapexml(s.slice(0, i)) + s.slice(i + 9, j) + unescapexml(s.slice(j + 3));\n    };\n  }();\n  var decregex = /[&<>'\"]/g,\n    charegex = /[\\u0000-\\u0008\\u000b-\\u001f]/g;\n  function escapexml(text) {\n    var s = text + '';\n    return s.replace(decregex, function (y) {\n      return rencoding[y];\n    }).replace(charegex, function (s) {\n      return \"_x\" + (\"000\" + s.charCodeAt(0).toString(16)).slice(-4) + \"_\";\n    });\n  }\n  function escapexmltag(text) {\n    return escapexml(text).replace(/ /g, \"_x0020_\");\n  }\n  var htmlcharegex = /[\\u0000-\\u001f]/g;\n  function escapehtml(text) {\n    var s = text + '';\n    return s.replace(decregex, function (y) {\n      return rencoding[y];\n    }).replace(/\\n/g, \"<br/>\").replace(htmlcharegex, function (s) {\n      return \"&#x\" + (\"000\" + s.charCodeAt(0).toString(16)).slice(-4) + \";\";\n    });\n  }\n  function escapexlml(text) {\n    var s = text + '';\n    return s.replace(decregex, function (y) {\n      return rencoding[y];\n    }).replace(htmlcharegex, function (s) {\n      return \"&#x\" + s.charCodeAt(0).toString(16).toUpperCase() + \";\";\n    });\n  }\n\n  /* TODO: handle codepages */\n  var xlml_fixstr = function () {\n    var entregex = /&#(\\d+);/g;\n    function entrepl($$, $1) {\n      return String.fromCharCode(parseInt($1, 10));\n    }\n    return function xlml_fixstr(str) {\n      return str.replace(entregex, entrepl);\n    };\n  }();\n  function xlml_unfixstr(str) {\n    return str.replace(/(\\r\\n|[\\r\\n])/g, \"\\&#10;\");\n  }\n  function parsexmlbool(value) {\n    switch (value) {\n      case 1:\n      case true:\n      case '1':\n      case 'true':\n      case 'TRUE':\n        return true;\n      /* case '0': case 'false': case 'FALSE':*/\n      default:\n        return false;\n    }\n  }\n  function utf8reada(orig) {\n    var out = \"\",\n      i = 0,\n      c = 0,\n      d = 0,\n      e = 0,\n      f = 0,\n      w = 0;\n    while (i < orig.length) {\n      c = orig.charCodeAt(i++);\n      if (c < 128) {\n        out += String.fromCharCode(c);\n        continue;\n      }\n      d = orig.charCodeAt(i++);\n      if (c > 191 && c < 224) {\n        f = (c & 31) << 6;\n        f |= d & 63;\n        out += String.fromCharCode(f);\n        continue;\n      }\n      e = orig.charCodeAt(i++);\n      if (c < 240) {\n        out += String.fromCharCode((c & 15) << 12 | (d & 63) << 6 | e & 63);\n        continue;\n      }\n      f = orig.charCodeAt(i++);\n      w = ((c & 7) << 18 | (d & 63) << 12 | (e & 63) << 6 | f & 63) - 65536;\n      out += String.fromCharCode(0xD800 + (w >>> 10 & 1023));\n      out += String.fromCharCode(0xDC00 + (w & 1023));\n    }\n    return out;\n  }\n  function utf8readb(data) {\n    var out = new_raw_buf(2 * data.length),\n      w,\n      i,\n      j = 1,\n      k = 0,\n      ww = 0,\n      c;\n    for (i = 0; i < data.length; i += j) {\n      j = 1;\n      if ((c = data.charCodeAt(i)) < 128) w = c;else if (c < 224) {\n        w = (c & 31) * 64 + (data.charCodeAt(i + 1) & 63);\n        j = 2;\n      } else if (c < 240) {\n        w = (c & 15) * 4096 + (data.charCodeAt(i + 1) & 63) * 64 + (data.charCodeAt(i + 2) & 63);\n        j = 3;\n      } else {\n        j = 4;\n        w = (c & 7) * 262144 + (data.charCodeAt(i + 1) & 63) * 4096 + (data.charCodeAt(i + 2) & 63) * 64 + (data.charCodeAt(i + 3) & 63);\n        w -= 65536;\n        ww = 0xD800 + (w >>> 10 & 1023);\n        w = 0xDC00 + (w & 1023);\n      }\n      if (ww !== 0) {\n        out[k++] = ww & 255;\n        out[k++] = ww >>> 8;\n        ww = 0;\n      }\n      out[k++] = w % 256;\n      out[k++] = w >>> 8;\n    }\n    return out.slice(0, k).toString('ucs2');\n  }\n  function utf8readc(data) {\n    return Buffer_from(data, 'binary').toString('utf8');\n  }\n  var utf8corpus = \"foo bar baz\\u00e2\\u0098\\u0083\\u00f0\\u009f\\u008d\\u00a3\";\n  var utf8read = has_buf && (utf8readc(utf8corpus) == utf8reada(utf8corpus) && utf8readc || utf8readb(utf8corpus) == utf8reada(utf8corpus) && utf8readb) || utf8reada;\n  var utf8write = has_buf ? function (data) {\n    return Buffer_from(data, 'utf8').toString(\"binary\");\n  } : function (orig) {\n    var out = [],\n      i = 0,\n      c = 0,\n      d = 0;\n    while (i < orig.length) {\n      c = orig.charCodeAt(i++);\n      switch (true) {\n        case c < 128:\n          out.push(String.fromCharCode(c));\n          break;\n        case c < 2048:\n          out.push(String.fromCharCode(192 + (c >> 6)));\n          out.push(String.fromCharCode(128 + (c & 63)));\n          break;\n        case c >= 55296 && c < 57344:\n          c -= 55296;\n          d = orig.charCodeAt(i++) - 56320 + (c << 10);\n          out.push(String.fromCharCode(240 + (d >> 18 & 7)));\n          out.push(String.fromCharCode(144 + (d >> 12 & 63)));\n          out.push(String.fromCharCode(128 + (d >> 6 & 63)));\n          out.push(String.fromCharCode(128 + (d & 63)));\n          break;\n        default:\n          out.push(String.fromCharCode(224 + (c >> 12)));\n          out.push(String.fromCharCode(128 + (c >> 6 & 63)));\n          out.push(String.fromCharCode(128 + (c & 63)));\n      }\n    }\n    return out.join(\"\");\n  };\n\n  // matches <foo>...</foo> extracts content\n  var matchtag = function () {\n    var mtcache = {};\n    return function matchtag(f, g) {\n      var t = f + \"|\" + (g || \"\");\n      if (mtcache[t]) return mtcache[t];\n      return mtcache[t] = new RegExp('<(?:\\\\w+:)?' + f + '(?: xml:space=\"preserve\")?(?:[^>]*)>([\\\\s\\\\S]*?)</(?:\\\\w+:)?' + f + '>', g || \"\");\n    };\n  }();\n  var htmldecode = function () {\n    var entities = [['nbsp', ' '], ['middot', '·'], ['quot', '\"'], ['apos', \"'\"], ['gt', '>'], ['lt', '<'], ['amp', '&']].map(function (x) {\n      return [new RegExp('&' + x[0] + ';', \"ig\"), x[1]];\n    });\n    return function htmldecode(str) {\n      var o = str\n      // Remove new lines and spaces from start of content\n      .replace(/^[\\t\\n\\r ]+/, \"\")\n      // Remove new lines and spaces from end of content\n      .replace(/[\\t\\n\\r ]+$/, \"\")\n      // Added line which removes any white space characters after and before html tags\n      .replace(/>\\s+/g, \">\").replace(/\\s+</g, \"<\")\n      // Replace remaining new lines and spaces with space\n      .replace(/[\\t\\n\\r ]+/g, \" \")\n      // Replace <br> tags with new lines\n      .replace(/<\\s*[bB][rR]\\s*\\/?>/g, \"\\n\")\n      // Strip HTML elements\n      .replace(/<[^>]*>/g, \"\");\n      for (var i = 0; i < entities.length; ++i) o = o.replace(entities[i][0], entities[i][1]);\n      return o;\n    };\n  }();\n  var vtregex = function () {\n    var vt_cache = {};\n    return function vt_regex(bt) {\n      if (vt_cache[bt] !== undefined) return vt_cache[bt];\n      return vt_cache[bt] = new RegExp(\"<(?:vt:)?\" + bt + \">([\\\\s\\\\S]*?)</(?:vt:)?\" + bt + \">\", 'g');\n    };\n  }();\n  var vtvregex = /<\\/?(?:vt:)?variant>/g,\n    vtmregex = /<(?:vt:)([^>]*)>([\\s\\S]*)</;\n  function parseVector(data, opts) {\n    var h = parsexmltag(data);\n    var matches = data.match(vtregex(h.baseType)) || [];\n    var res = [];\n    if (matches.length != h.size) {\n      if (opts.WTF) throw new Error(\"unexpected vector length \" + matches.length + \" != \" + h.size);\n      return res;\n    }\n    matches.forEach(function (x) {\n      var v = x.replace(vtvregex, \"\").match(vtmregex);\n      if (v) res.push({\n        v: utf8read(v[2]),\n        t: v[1]\n      });\n    });\n    return res;\n  }\n  var wtregex = /(^\\s|\\s$|\\n)/;\n  function writetag(f, g) {\n    return '<' + f + (g.match(wtregex) ? ' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f + '>';\n  }\n  function wxt_helper(h) {\n    return keys(h).map(function (k) {\n      return \" \" + k + '=\"' + h[k] + '\"';\n    }).join(\"\");\n  }\n  function writextag(f, g, h) {\n    return '<' + f + (h != null ? wxt_helper(h) : \"\") + (g != null ? (g.match(wtregex) ? ' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f : \"/\") + '>';\n  }\n  function write_w3cdtf(d, t) {\n    try {\n      return d.toISOString().replace(/\\.\\d*/, \"\");\n    } catch (e) {\n      if (t) throw e;\n    }\n    return \"\";\n  }\n  function write_vt(s, xlsx) {\n    switch (typeof s) {\n      case 'string':\n        var o = writextag('vt:lpwstr', escapexml(s));\n        if (xlsx) o = o.replace(/&quot;/g, \"_x0022_\");\n        return o;\n      case 'number':\n        return writextag((s | 0) == s ? 'vt:i4' : 'vt:r8', escapexml(String(s)));\n      case 'boolean':\n        return writextag('vt:bool', s ? 'true' : 'false');\n    }\n    if (s instanceof Date) return writextag('vt:filetime', write_w3cdtf(s));\n    throw new Error(\"Unable to serialize \" + s);\n  }\n  function xlml_normalize(d) {\n    if (has_buf && Buffer.isBuffer(d)) return d.toString('utf8');\n    if (typeof d === 'string') return d;\n    /* duktape */\n    if (typeof Uint8Array !== 'undefined' && d instanceof Uint8Array) return utf8read(a2s(ab2a(d)));\n    throw new Error(\"Bad input format: expected Buffer or string\");\n  }\n  /* UOS uses CJK in tags */\n  var xlmlregex = /<(\\/?)([^\\s?><!\\/:]*:|)([^\\s?<>:\\/]+)(?:[\\s?:\\/][^>]*)?>/mg;\n  //var xlmlregex = /<(\\/?)([a-z0-9]*:|)(\\w+)[^>]*>/mg;\n\n  var XMLNS = {\n    CORE_PROPS: 'http://schemas.openxmlformats.org/package/2006/metadata/core-properties',\n    CUST_PROPS: \"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\",\n    EXT_PROPS: \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\",\n    CT: 'http://schemas.openxmlformats.org/package/2006/content-types',\n    RELS: 'http://schemas.openxmlformats.org/package/2006/relationships',\n    TCMNT: 'http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments',\n    'dc': 'http://purl.org/dc/elements/1.1/',\n    'dcterms': 'http://purl.org/dc/terms/',\n    'dcmitype': 'http://purl.org/dc/dcmitype/',\n    'mx': 'http://schemas.microsoft.com/office/mac/excel/2008/main',\n    'r': 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',\n    'sjs': 'http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties',\n    'vt': 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\n    'xsi': 'http://www.w3.org/2001/XMLSchema-instance',\n    'xsd': 'http://www.w3.org/2001/XMLSchema'\n  };\n  var XMLNS_main = ['http://schemas.openxmlformats.org/spreadsheetml/2006/main', 'http://purl.oclc.org/ooxml/spreadsheetml/main', 'http://schemas.microsoft.com/office/excel/2006/main', 'http://schemas.microsoft.com/office/excel/2006/2'];\n  var XLMLNS = {\n    'o': 'urn:schemas-microsoft-com:office:office',\n    'x': 'urn:schemas-microsoft-com:office:excel',\n    'ss': 'urn:schemas-microsoft-com:office:spreadsheet',\n    'dt': 'uuid:C2F41010-65B3-11d1-A29F-00AA00C14882',\n    'mv': 'http://macVmlSchemaUri',\n    'v': 'urn:schemas-microsoft-com:vml',\n    'html': 'http://www.w3.org/TR/REC-html40'\n  };\n  function read_double_le(b, idx) {\n    var s = 1 - 2 * (b[idx + 7] >>> 7);\n    var e = ((b[idx + 7] & 0x7f) << 4) + (b[idx + 6] >>> 4 & 0x0f);\n    var m = b[idx + 6] & 0x0f;\n    for (var i = 5; i >= 0; --i) m = m * 256 + b[idx + i];\n    if (e == 0x7ff) return m == 0 ? s * Infinity : NaN;\n    if (e == 0) e = -1022;else {\n      e -= 1023;\n      m += Math.pow(2, 52);\n    }\n    return s * Math.pow(2, e - 52) * m;\n  }\n  function write_double_le(b, v, idx) {\n    var bs = (v < 0 || 1 / v == -Infinity ? 1 : 0) << 7,\n      e = 0,\n      m = 0;\n    var av = bs ? -v : v;\n    if (!isFinite(av)) {\n      e = 0x7ff;\n      m = isNaN(v) ? 0x6969 : 0;\n    } else if (av == 0) e = m = 0;else {\n      e = Math.floor(Math.log(av) / Math.LN2);\n      m = av * Math.pow(2, 52 - e);\n      if (e <= -1023 && (!isFinite(m) || m < Math.pow(2, 52))) {\n        e = -1022;\n      } else {\n        m -= Math.pow(2, 52);\n        e += 1023;\n      }\n    }\n    for (var i = 0; i <= 5; ++i, m /= 256) b[idx + i] = m & 0xff;\n    b[idx + 6] = (e & 0x0f) << 4 | m & 0xf;\n    b[idx + 7] = e >> 4 | bs;\n  }\n  var ___toBuffer = function (bufs) {\n    var x = [],\n      w = 10240;\n    for (var i = 0; i < bufs[0].length; ++i) if (bufs[0][i]) for (var j = 0, L = bufs[0][i].length; j < L; j += w) x.push.apply(x, bufs[0][i].slice(j, j + w));\n    return x;\n  };\n  var __toBuffer = has_buf ? function (bufs) {\n    return bufs[0].length > 0 && Buffer.isBuffer(bufs[0][0]) ? Buffer.concat(bufs[0].map(function (x) {\n      return Buffer.isBuffer(x) ? x : Buffer_from(x);\n    })) : ___toBuffer(bufs);\n  } : ___toBuffer;\n  var ___utf16le = function (b, s, e) {\n    var ss = [];\n    for (var i = s; i < e; i += 2) ss.push(String.fromCharCode(__readUInt16LE(b, i)));\n    return ss.join(\"\").replace(chr0, '');\n  };\n  var __utf16le = has_buf ? function (b, s, e) {\n    if (!Buffer.isBuffer(b)) return ___utf16le(b, s, e);\n    return b.toString('utf16le', s, e).replace(chr0, '') /*.replace(chr1,'!')*/;\n  } : ___utf16le;\n  var ___hexlify = function (b, s, l) {\n    var ss = [];\n    for (var i = s; i < s + l; ++i) ss.push((\"0\" + b[i].toString(16)).slice(-2));\n    return ss.join(\"\");\n  };\n  var __hexlify = has_buf ? function (b, s, l) {\n    return Buffer.isBuffer(b) ? b.toString('hex', s, s + l) : ___hexlify(b, s, l);\n  } : ___hexlify;\n  var ___utf8 = function (b, s, e) {\n    var ss = [];\n    for (var i = s; i < e; i++) ss.push(String.fromCharCode(__readUInt8(b, i)));\n    return ss.join(\"\");\n  };\n  var __utf8 = has_buf ? function utf8_b(b, s, e) {\n    return Buffer.isBuffer(b) ? b.toString('utf8', s, e) : ___utf8(b, s, e);\n  } : ___utf8;\n  var ___lpstr = function (b, i) {\n    var len = __readUInt32LE(b, i);\n    return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : \"\";\n  };\n  var __lpstr = ___lpstr;\n  var ___cpstr = function (b, i) {\n    var len = __readUInt32LE(b, i);\n    return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : \"\";\n  };\n  var __cpstr = ___cpstr;\n  var ___lpwstr = function (b, i) {\n    var len = 2 * __readUInt32LE(b, i);\n    return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : \"\";\n  };\n  var __lpwstr = ___lpwstr;\n  var ___lpp4 = function lpp4_(b, i) {\n    var len = __readUInt32LE(b, i);\n    return len > 0 ? __utf16le(b, i + 4, i + 4 + len) : \"\";\n  };\n  var __lpp4 = ___lpp4;\n  var ___8lpp4 = function (b, i) {\n    var len = __readUInt32LE(b, i);\n    return len > 0 ? __utf8(b, i + 4, i + 4 + len) : \"\";\n  };\n  var __8lpp4 = ___8lpp4;\n  var ___double = function (b, idx) {\n    return read_double_le(b, idx);\n  };\n  var __double = ___double;\n  var is_buf = function is_buf_a(a) {\n    return Array.isArray(a) || typeof Uint8Array !== \"undefined\" && a instanceof Uint8Array;\n  };\n  if (has_buf) {\n    __lpstr = function lpstr_b(b, i) {\n      if (!Buffer.isBuffer(b)) return ___lpstr(b, i);\n      var len = b.readUInt32LE(i);\n      return len > 0 ? b.toString('utf8', i + 4, i + 4 + len - 1) : \"\";\n    };\n    __cpstr = function cpstr_b(b, i) {\n      if (!Buffer.isBuffer(b)) return ___cpstr(b, i);\n      var len = b.readUInt32LE(i);\n      return len > 0 ? b.toString('utf8', i + 4, i + 4 + len - 1) : \"\";\n    };\n    __lpwstr = function lpwstr_b(b, i) {\n      if (!Buffer.isBuffer(b)) return ___lpwstr(b, i);\n      var len = 2 * b.readUInt32LE(i);\n      return b.toString('utf16le', i + 4, i + 4 + len - 1);\n    };\n    __lpp4 = function lpp4_b(b, i) {\n      if (!Buffer.isBuffer(b)) return ___lpp4(b, i);\n      var len = b.readUInt32LE(i);\n      return b.toString('utf16le', i + 4, i + 4 + len);\n    };\n    __8lpp4 = function lpp4_8b(b, i) {\n      if (!Buffer.isBuffer(b)) return ___8lpp4(b, i);\n      var len = b.readUInt32LE(i);\n      return b.toString('utf8', i + 4, i + 4 + len);\n    };\n    __double = function double_(b, i) {\n      if (Buffer.isBuffer(b)) return b.readDoubleLE(i);\n      return ___double(b, i);\n    };\n    is_buf = function is_buf_b(a) {\n      return Buffer.isBuffer(a) || Array.isArray(a) || typeof Uint8Array !== \"undefined\" && a instanceof Uint8Array;\n    };\n  }\n\n  /* from js-xls */\n  function cpdoit() {\n    __utf16le = function (b, s, e) {\n      return $cptable.utils.decode(1200, b.slice(s, e)).replace(chr0, '');\n    };\n    __utf8 = function (b, s, e) {\n      return $cptable.utils.decode(65001, b.slice(s, e));\n    };\n    __lpstr = function (b, i) {\n      var len = __readUInt32LE(b, i);\n      return len > 0 ? $cptable.utils.decode(current_ansi, b.slice(i + 4, i + 4 + len - 1)) : \"\";\n    };\n    __cpstr = function (b, i) {\n      var len = __readUInt32LE(b, i);\n      return len > 0 ? $cptable.utils.decode(current_codepage, b.slice(i + 4, i + 4 + len - 1)) : \"\";\n    };\n    __lpwstr = function (b, i) {\n      var len = 2 * __readUInt32LE(b, i);\n      return len > 0 ? $cptable.utils.decode(1200, b.slice(i + 4, i + 4 + len - 1)) : \"\";\n    };\n    __lpp4 = function (b, i) {\n      var len = __readUInt32LE(b, i);\n      return len > 0 ? $cptable.utils.decode(1200, b.slice(i + 4, i + 4 + len)) : \"\";\n    };\n    __8lpp4 = function (b, i) {\n      var len = __readUInt32LE(b, i);\n      return len > 0 ? $cptable.utils.decode(65001, b.slice(i + 4, i + 4 + len)) : \"\";\n    };\n  }\n  if (typeof $cptable !== 'undefined') cpdoit();\n  var __readUInt8 = function (b, idx) {\n    return b[idx];\n  };\n  var __readUInt16LE = function (b, idx) {\n    return b[idx + 1] * (1 << 8) + b[idx];\n  };\n  var __readInt16LE = function (b, idx) {\n    var u = b[idx + 1] * (1 << 8) + b[idx];\n    return u < 0x8000 ? u : (0xffff - u + 1) * -1;\n  };\n  var __readUInt32LE = function (b, idx) {\n    return b[idx + 3] * (1 << 24) + (b[idx + 2] << 16) + (b[idx + 1] << 8) + b[idx];\n  };\n  var __readInt32LE = function (b, idx) {\n    return b[idx + 3] << 24 | b[idx + 2] << 16 | b[idx + 1] << 8 | b[idx];\n  };\n  var __readInt32BE = function (b, idx) {\n    return b[idx] << 24 | b[idx + 1] << 16 | b[idx + 2] << 8 | b[idx + 3];\n  };\n  function ReadShift(size, t) {\n    var o = \"\",\n      oI,\n      oR,\n      oo = [],\n      w,\n      vv,\n      i,\n      loc;\n    switch (t) {\n      case 'dbcs':\n        loc = this.l;\n        if (has_buf && Buffer.isBuffer(this)) o = this.slice(this.l, this.l + 2 * size).toString(\"utf16le\");else for (i = 0; i < size; ++i) {\n          o += String.fromCharCode(__readUInt16LE(this, loc));\n          loc += 2;\n        }\n        size *= 2;\n        break;\n      case 'utf8':\n        o = __utf8(this, this.l, this.l + size);\n        break;\n      case 'utf16le':\n        size *= 2;\n        o = __utf16le(this, this.l, this.l + size);\n        break;\n      case 'wstr':\n        if (typeof $cptable !== 'undefined') o = $cptable.utils.decode(current_codepage, this.slice(this.l, this.l + 2 * size));else return ReadShift.call(this, size, 'dbcs');\n        size = 2 * size;\n        break;\n\n      /* [MS-OLEDS] 2.1.4 LengthPrefixedAnsiString */\n      case 'lpstr-ansi':\n        o = __lpstr(this, this.l);\n        size = 4 + __readUInt32LE(this, this.l);\n        break;\n      case 'lpstr-cp':\n        o = __cpstr(this, this.l);\n        size = 4 + __readUInt32LE(this, this.l);\n        break;\n      /* [MS-OLEDS] 2.1.5 LengthPrefixedUnicodeString */\n      case 'lpwstr':\n        o = __lpwstr(this, this.l);\n        size = 4 + 2 * __readUInt32LE(this, this.l);\n        break;\n      /* [MS-OFFCRYPTO] 2.1.2 Length-Prefixed Padded Unicode String (UNICODE-LP-P4) */\n      case 'lpp4':\n        size = 4 + __readUInt32LE(this, this.l);\n        o = __lpp4(this, this.l);\n        if (size & 0x02) size += 2;\n        break;\n      /* [MS-OFFCRYPTO] 2.1.3 Length-Prefixed UTF-8 String (UTF-8-LP-P4) */\n      case '8lpp4':\n        size = 4 + __readUInt32LE(this, this.l);\n        o = __8lpp4(this, this.l);\n        if (size & 0x03) size += 4 - (size & 0x03);\n        break;\n      case 'cstr':\n        size = 0;\n        o = \"\";\n        while ((w = __readUInt8(this, this.l + size++)) !== 0) oo.push(_getchar(w));\n        o = oo.join(\"\");\n        break;\n      case '_wstr':\n        size = 0;\n        o = \"\";\n        while ((w = __readUInt16LE(this, this.l + size)) !== 0) {\n          oo.push(_getchar(w));\n          size += 2;\n        }\n        size += 2;\n        o = oo.join(\"\");\n        break;\n\n      /* sbcs and dbcs support continue records in the SST way TODO codepages */\n      case 'dbcs-cont':\n        o = \"\";\n        loc = this.l;\n        for (i = 0; i < size; ++i) {\n          if (this.lens && this.lens.indexOf(loc) !== -1) {\n            w = __readUInt8(this, loc);\n            this.l = loc + 1;\n            vv = ReadShift.call(this, size - i, w ? 'dbcs-cont' : 'sbcs-cont');\n            return oo.join(\"\") + vv;\n          }\n          oo.push(_getchar(__readUInt16LE(this, loc)));\n          loc += 2;\n        }\n        o = oo.join(\"\");\n        size *= 2;\n        break;\n      case 'cpstr':\n        if (typeof $cptable !== 'undefined') {\n          o = $cptable.utils.decode(current_codepage, this.slice(this.l, this.l + size));\n          break;\n        }\n      /* falls through */\n      case 'sbcs-cont':\n        o = \"\";\n        loc = this.l;\n        for (i = 0; i != size; ++i) {\n          if (this.lens && this.lens.indexOf(loc) !== -1) {\n            w = __readUInt8(this, loc);\n            this.l = loc + 1;\n            vv = ReadShift.call(this, size - i, w ? 'dbcs-cont' : 'sbcs-cont');\n            return oo.join(\"\") + vv;\n          }\n          oo.push(_getchar(__readUInt8(this, loc)));\n          loc += 1;\n        }\n        o = oo.join(\"\");\n        break;\n      default:\n        switch (size) {\n          case 1:\n            oI = __readUInt8(this, this.l);\n            this.l++;\n            return oI;\n          case 2:\n            oI = (t === 'i' ? __readInt16LE : __readUInt16LE)(this, this.l);\n            this.l += 2;\n            return oI;\n          case 4:\n          case -4:\n            if (t === 'i' || (this[this.l + 3] & 0x80) === 0) {\n              oI = (size > 0 ? __readInt32LE : __readInt32BE)(this, this.l);\n              this.l += 4;\n              return oI;\n            } else {\n              oR = __readUInt32LE(this, this.l);\n              this.l += 4;\n            }\n            return oR;\n          case 8:\n          case -8:\n            if (t === 'f') {\n              if (size == 8) oR = __double(this, this.l);else oR = __double([this[this.l + 7], this[this.l + 6], this[this.l + 5], this[this.l + 4], this[this.l + 3], this[this.l + 2], this[this.l + 1], this[this.l + 0]], 0);\n              this.l += 8;\n              return oR;\n            } else size = 8;\n          /* falls through */\n          case 16:\n            o = __hexlify(this, this.l, size);\n            break;\n        }\n    }\n    this.l += size;\n    return o;\n  }\n  var __writeUInt32LE = function (b, val, idx) {\n    b[idx] = val & 0xFF;\n    b[idx + 1] = val >>> 8 & 0xFF;\n    b[idx + 2] = val >>> 16 & 0xFF;\n    b[idx + 3] = val >>> 24 & 0xFF;\n  };\n  var __writeInt32LE = function (b, val, idx) {\n    b[idx] = val & 0xFF;\n    b[idx + 1] = val >> 8 & 0xFF;\n    b[idx + 2] = val >> 16 & 0xFF;\n    b[idx + 3] = val >> 24 & 0xFF;\n  };\n  var __writeUInt16LE = function (b, val, idx) {\n    b[idx] = val & 0xFF;\n    b[idx + 1] = val >>> 8 & 0xFF;\n  };\n  function WriteShift(t, val, f) {\n    var size = 0,\n      i = 0;\n    if (f === 'dbcs') {\n      for (i = 0; i != val.length; ++i) __writeUInt16LE(this, val.charCodeAt(i), this.l + 2 * i);\n      size = 2 * val.length;\n    } else if (f === 'sbcs') {\n      if (typeof $cptable !== 'undefined' && current_ansi == 874) {\n        /* TODO: use tables directly, don't encode */\n        for (i = 0; i != val.length; ++i) {\n          var cppayload = $cptable.utils.encode(current_ansi, val.charAt(i));\n          this[this.l + i] = cppayload[0];\n        }\n      } else {\n        val = val.replace(/[^\\x00-\\x7F]/g, \"_\");\n        for (i = 0; i != val.length; ++i) this[this.l + i] = val.charCodeAt(i) & 0xFF;\n      }\n      size = val.length;\n    } else if (f === 'hex') {\n      for (; i < t; ++i) {\n        this[this.l++] = parseInt(val.slice(2 * i, 2 * i + 2), 16) || 0;\n      }\n      return this;\n    } else if (f === 'utf16le') {\n      var end = Math.min(this.l + t, this.length);\n      for (i = 0; i < Math.min(val.length, t); ++i) {\n        var cc = val.charCodeAt(i);\n        this[this.l++] = cc & 0xff;\n        this[this.l++] = cc >> 8;\n      }\n      while (this.l < end) this[this.l++] = 0;\n      return this;\n    } else switch (t) {\n      case 1:\n        size = 1;\n        this[this.l] = val & 0xFF;\n        break;\n      case 2:\n        size = 2;\n        this[this.l] = val & 0xFF;\n        val >>>= 8;\n        this[this.l + 1] = val & 0xFF;\n        break;\n      case 3:\n        size = 3;\n        this[this.l] = val & 0xFF;\n        val >>>= 8;\n        this[this.l + 1] = val & 0xFF;\n        val >>>= 8;\n        this[this.l + 2] = val & 0xFF;\n        break;\n      case 4:\n        size = 4;\n        __writeUInt32LE(this, val, this.l);\n        break;\n      case 8:\n        size = 8;\n        if (f === 'f') {\n          write_double_le(this, val, this.l);\n          break;\n        }\n      /* falls through */\n      case 16:\n        break;\n      case -4:\n        size = 4;\n        __writeInt32LE(this, val, this.l);\n        break;\n    }\n    this.l += size;\n    return this;\n  }\n  function CheckField(hexstr, fld) {\n    var m = __hexlify(this, this.l, hexstr.length >> 1);\n    if (m !== hexstr) throw new Error(fld + 'Expected ' + hexstr + ' saw ' + m);\n    this.l += hexstr.length >> 1;\n  }\n  function prep_blob(blob, pos) {\n    blob.l = pos;\n    blob.read_shift = ReadShift;\n    blob.chk = CheckField;\n    blob.write_shift = WriteShift;\n  }\n  function parsenoop(blob, length) {\n    blob.l += length;\n  }\n  function new_buf(sz) {\n    var o = new_raw_buf(sz);\n    prep_blob(o, 0);\n    return o;\n  }\n\n  /* [MS-XLSB] 2.1.4 Record */\n  function recordhopper(data, cb, opts) {\n    if (!data) return;\n    var tmpbyte, cntbyte, length;\n    prep_blob(data, data.l || 0);\n    var L = data.length,\n      RT = 0,\n      tgt = 0;\n    while (data.l < L) {\n      RT = data.read_shift(1);\n      if (RT & 0x80) RT = (RT & 0x7F) + ((data.read_shift(1) & 0x7F) << 7);\n      var R = XLSBRecordEnum[RT] || XLSBRecordEnum[0xFFFF];\n      tmpbyte = data.read_shift(1);\n      length = tmpbyte & 0x7F;\n      for (cntbyte = 1; cntbyte < 4 && tmpbyte & 0x80; ++cntbyte) length += ((tmpbyte = data.read_shift(1)) & 0x7F) << 7 * cntbyte;\n      tgt = data.l + length;\n      var d = R.f && R.f(data, length, opts);\n      data.l = tgt;\n      if (cb(d, R, RT)) return;\n    }\n  }\n\n  /* control buffer usage for fixed-length buffers */\n  function buf_array() {\n    var bufs = [],\n      blksz = has_buf ? 256 : 2048;\n    var newblk = function ba_newblk(sz) {\n      var o = new_buf(sz);\n      prep_blob(o, 0);\n      return o;\n    };\n    var curbuf = newblk(blksz);\n    var endbuf = function ba_endbuf() {\n      if (!curbuf) return;\n      if (curbuf.length > curbuf.l) {\n        curbuf = curbuf.slice(0, curbuf.l);\n        curbuf.l = curbuf.length;\n      }\n      if (curbuf.length > 0) bufs.push(curbuf);\n      curbuf = null;\n    };\n    var next = function ba_next(sz) {\n      if (curbuf && sz < curbuf.length - curbuf.l) return curbuf;\n      endbuf();\n      return curbuf = newblk(Math.max(sz + 1, blksz));\n    };\n    var end = function ba_end() {\n      endbuf();\n      return bconcat(bufs);\n    };\n    var push = function ba_push(buf) {\n      endbuf();\n      curbuf = buf;\n      if (curbuf.l == null) curbuf.l = curbuf.length;\n      next(blksz);\n    };\n    return {\n      next: next,\n      push: push,\n      end: end,\n      _bufs: bufs\n    };\n  }\n  function write_record(ba, type, payload, length) {\n    var t = +type,\n      l;\n    if (isNaN(t)) return; // TODO: throw something here?\n    if (!length) length = XLSBRecordEnum[t].p || (payload || []).length || 0;\n    l = 1 + (t >= 0x80 ? 1 : 0) + 1 /* + length*/;\n    if (length >= 0x80) ++l;\n    if (length >= 0x4000) ++l;\n    if (length >= 0x200000) ++l;\n    var o = ba.next(l);\n    if (t <= 0x7F) o.write_shift(1, t);else {\n      o.write_shift(1, (t & 0x7F) + 0x80);\n      o.write_shift(1, t >> 7);\n    }\n    for (var i = 0; i != 4; ++i) {\n      if (length >= 0x80) {\n        o.write_shift(1, (length & 0x7F) + 0x80);\n        length >>= 7;\n      } else {\n        o.write_shift(1, length);\n        break;\n      }\n    }\n    if (length > 0 && is_buf(payload)) ba.push(payload);\n  }\n  /* XLS ranges enforced */\n  function shift_cell_xls(cell, tgt, opts) {\n    var out = dup(cell);\n    if (tgt.s) {\n      if (out.cRel) out.c += tgt.s.c;\n      if (out.rRel) out.r += tgt.s.r;\n    } else {\n      if (out.cRel) out.c += tgt.c;\n      if (out.rRel) out.r += tgt.r;\n    }\n    if (!opts || opts.biff < 12) {\n      while (out.c >= 0x100) out.c -= 0x100;\n      while (out.r >= 0x10000) out.r -= 0x10000;\n    }\n    return out;\n  }\n  function shift_range_xls(cell, range, opts) {\n    var out = dup(cell);\n    out.s = shift_cell_xls(out.s, range.s, opts);\n    out.e = shift_cell_xls(out.e, range.s, opts);\n    return out;\n  }\n  function encode_cell_xls(c, biff) {\n    if (c.cRel && c.c < 0) {\n      c = dup(c);\n      while (c.c < 0) c.c += biff > 8 ? 0x4000 : 0x100;\n    }\n    if (c.rRel && c.r < 0) {\n      c = dup(c);\n      while (c.r < 0) c.r += biff > 8 ? 0x100000 : biff > 5 ? 0x10000 : 0x4000;\n    }\n    var s = encode_cell(c);\n    if (!c.cRel && c.cRel != null) s = fix_col(s);\n    if (!c.rRel && c.rRel != null) s = fix_row(s);\n    return s;\n  }\n  function encode_range_xls(r, opts) {\n    if (r.s.r == 0 && !r.s.rRel) {\n      if (r.e.r == (opts.biff >= 12 ? 0xFFFFF : opts.biff >= 8 ? 0x10000 : 0x4000) && !r.e.rRel) {\n        return (r.s.cRel ? \"\" : \"$\") + encode_col(r.s.c) + \":\" + (r.e.cRel ? \"\" : \"$\") + encode_col(r.e.c);\n      }\n    }\n    if (r.s.c == 0 && !r.s.cRel) {\n      if (r.e.c == (opts.biff >= 12 ? 0x3FFF : 0xFF) && !r.e.cRel) {\n        return (r.s.rRel ? \"\" : \"$\") + encode_row(r.s.r) + \":\" + (r.e.rRel ? \"\" : \"$\") + encode_row(r.e.r);\n      }\n    }\n    return encode_cell_xls(r.s, opts.biff) + \":\" + encode_cell_xls(r.e, opts.biff);\n  }\n  function decode_row(rowstr) {\n    return parseInt(unfix_row(rowstr), 10) - 1;\n  }\n  function encode_row(row) {\n    return \"\" + (row + 1);\n  }\n  function fix_row(cstr) {\n    return cstr.replace(/([A-Z]|^)(\\d+)$/, \"$1$$$2\");\n  }\n  function unfix_row(cstr) {\n    return cstr.replace(/\\$(\\d+)$/, \"$1\");\n  }\n  function decode_col(colstr) {\n    var c = unfix_col(colstr),\n      d = 0,\n      i = 0;\n    for (; i !== c.length; ++i) d = 26 * d + c.charCodeAt(i) - 64;\n    return d - 1;\n  }\n  function encode_col(col) {\n    if (col < 0) throw new Error(\"invalid column \" + col);\n    var s = \"\";\n    for (++col; col; col = Math.floor((col - 1) / 26)) s = String.fromCharCode((col - 1) % 26 + 65) + s;\n    return s;\n  }\n  function fix_col(cstr) {\n    return cstr.replace(/^([A-Z])/, \"$$$1\");\n  }\n  function unfix_col(cstr) {\n    return cstr.replace(/^\\$([A-Z])/, \"$1\");\n  }\n  function split_cell(cstr) {\n    return cstr.replace(/(\\$?[A-Z]*)(\\$?\\d*)/, \"$1,$2\").split(\",\");\n  }\n  //function decode_cell(cstr) { var splt = split_cell(cstr); return { c:decode_col(splt[0]), r:decode_row(splt[1]) }; }\n  function decode_cell(cstr) {\n    var R = 0,\n      C = 0;\n    for (var i = 0; i < cstr.length; ++i) {\n      var cc = cstr.charCodeAt(i);\n      if (cc >= 48 && cc <= 57) R = 10 * R + (cc - 48);else if (cc >= 65 && cc <= 90) C = 26 * C + (cc - 64);\n    }\n    return {\n      c: C - 1,\n      r: R - 1\n    };\n  }\n  //function encode_cell(cell) { return encode_col(cell.c) + encode_row(cell.r); }\n  function encode_cell(cell) {\n    var col = cell.c + 1;\n    var s = \"\";\n    for (; col; col = (col - 1) / 26 | 0) s = String.fromCharCode((col - 1) % 26 + 65) + s;\n    return s + (cell.r + 1);\n  }\n  function decode_range(range) {\n    var idx = range.indexOf(\":\");\n    if (idx == -1) return {\n      s: decode_cell(range),\n      e: decode_cell(range)\n    };\n    return {\n      s: decode_cell(range.slice(0, idx)),\n      e: decode_cell(range.slice(idx + 1))\n    };\n  }\n  function encode_range(cs, ce) {\n    if (typeof ce === 'undefined' || typeof ce === 'number') {\n      return encode_range(cs.s, cs.e);\n    }\n    if (typeof cs !== 'string') cs = encode_cell(cs);\n    if (typeof ce !== 'string') ce = encode_cell(ce);\n    return cs == ce ? cs : cs + \":\" + ce;\n  }\n  function safe_decode_range(range) {\n    var o = {\n      s: {\n        c: 0,\n        r: 0\n      },\n      e: {\n        c: 0,\n        r: 0\n      }\n    };\n    var idx = 0,\n      i = 0,\n      cc = 0;\n    var len = range.length;\n    for (idx = 0; i < len; ++i) {\n      if ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;\n      idx = 26 * idx + cc;\n    }\n    o.s.c = --idx;\n    for (idx = 0; i < len; ++i) {\n      if ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;\n      idx = 10 * idx + cc;\n    }\n    o.s.r = --idx;\n    if (i === len || cc != 10) {\n      o.e.c = o.s.c;\n      o.e.r = o.s.r;\n      return o;\n    }\n    ++i;\n    for (idx = 0; i != len; ++i) {\n      if ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;\n      idx = 26 * idx + cc;\n    }\n    o.e.c = --idx;\n    for (idx = 0; i != len; ++i) {\n      if ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;\n      idx = 10 * idx + cc;\n    }\n    o.e.r = --idx;\n    return o;\n  }\n  function safe_format_cell(cell, v) {\n    var q = cell.t == 'd' && v instanceof Date;\n    if (cell.z != null) try {\n      return cell.w = SSF_format(cell.z, q ? datenum(v) : v);\n    } catch (e) {}\n    try {\n      return cell.w = SSF_format((cell.XF || {}).numFmtId || (q ? 14 : 0), q ? datenum(v) : v);\n    } catch (e) {\n      return '' + v;\n    }\n  }\n  function format_cell(cell, v, o) {\n    if (cell == null || cell.t == null || cell.t == 'z') return \"\";\n    if (cell.w !== undefined) return cell.w;\n    if (cell.t == 'd' && !cell.z && o && o.dateNF) cell.z = o.dateNF;\n    if (cell.t == \"e\") return BErr[cell.v] || cell.v;\n    if (v == undefined) return safe_format_cell(cell, cell.v);\n    return safe_format_cell(cell, v);\n  }\n  function sheet_to_workbook(sheet, opts) {\n    var n = opts && opts.sheet ? opts.sheet : \"Sheet1\";\n    var sheets = {};\n    sheets[n] = sheet;\n    return {\n      SheetNames: [n],\n      Sheets: sheets\n    };\n  }\n  function sheet_add_aoa(_ws, data, opts) {\n    var o = opts || {};\n    var dense = _ws ? Array.isArray(_ws) : o.dense;\n    if (DENSE != null && dense == null) dense = DENSE;\n    var ws = _ws || (dense ? [] : {});\n    var _R = 0,\n      _C = 0;\n    if (ws && o.origin != null) {\n      if (typeof o.origin == 'number') _R = o.origin;else {\n        var _origin = typeof o.origin == \"string\" ? decode_cell(o.origin) : o.origin;\n        _R = _origin.r;\n        _C = _origin.c;\n      }\n      if (!ws[\"!ref\"]) ws[\"!ref\"] = \"A1:A1\";\n    }\n    var range = {\n      s: {\n        c: 10000000,\n        r: 10000000\n      },\n      e: {\n        c: 0,\n        r: 0\n      }\n    };\n    if (ws['!ref']) {\n      var _range = safe_decode_range(ws['!ref']);\n      range.s.c = _range.s.c;\n      range.s.r = _range.s.r;\n      range.e.c = Math.max(range.e.c, _range.e.c);\n      range.e.r = Math.max(range.e.r, _range.e.r);\n      if (_R == -1) range.e.r = _R = _range.e.r + 1;\n    }\n    for (var R = 0; R != data.length; ++R) {\n      if (!data[R]) continue;\n      if (!Array.isArray(data[R])) throw new Error(\"aoa_to_sheet expects an array of arrays\");\n      for (var C = 0; C != data[R].length; ++C) {\n        if (typeof data[R][C] === 'undefined') continue;\n        var cell = {\n          v: data[R][C]\n        };\n        var __R = _R + R,\n          __C = _C + C;\n        if (range.s.r > __R) range.s.r = __R;\n        if (range.s.c > __C) range.s.c = __C;\n        if (range.e.r < __R) range.e.r = __R;\n        if (range.e.c < __C) range.e.c = __C;\n        if (data[R][C] && typeof data[R][C] === 'object' && !Array.isArray(data[R][C]) && !(data[R][C] instanceof Date)) cell = data[R][C];else {\n          if (Array.isArray(cell.v)) {\n            cell.f = data[R][C][1];\n            cell.v = cell.v[0];\n          }\n          if (cell.v === null) {\n            if (cell.f) cell.t = 'n';else if (o.nullError) {\n              cell.t = 'e';\n              cell.v = 0;\n            } else if (!o.sheetStubs) continue;else cell.t = 'z';\n          } else if (typeof cell.v === 'number') cell.t = 'n';else if (typeof cell.v === 'boolean') cell.t = 'b';else if (cell.v instanceof Date) {\n            cell.z = o.dateNF || table_fmt[14];\n            if (o.cellDates) {\n              cell.t = 'd';\n              cell.w = SSF_format(cell.z, datenum(cell.v));\n            } else {\n              cell.t = 'n';\n              cell.v = datenum(cell.v);\n              cell.w = SSF_format(cell.z, cell.v);\n            }\n          } else cell.t = 's';\n        }\n        if (dense) {\n          if (!ws[__R]) ws[__R] = [];\n          if (ws[__R][__C] && ws[__R][__C].z) cell.z = ws[__R][__C].z;\n          ws[__R][__C] = cell;\n        } else {\n          var cell_ref = encode_cell({\n            c: __C,\n            r: __R\n          });\n          if (ws[cell_ref] && ws[cell_ref].z) cell.z = ws[cell_ref].z;\n          ws[cell_ref] = cell;\n        }\n      }\n    }\n    if (range.s.c < 10000000) ws['!ref'] = encode_range(range);\n    return ws;\n  }\n  function aoa_to_sheet(data, opts) {\n    return sheet_add_aoa(null, data, opts);\n  }\n  function parse_Int32LE(data) {\n    return data.read_shift(4, 'i');\n  }\n  function write_UInt32LE(x, o) {\n    if (!o) o = new_buf(4);\n    o.write_shift(4, x);\n    return o;\n  }\n\n  /* [MS-XLSB] 2.5.168 */\n  function parse_XLWideString(data) {\n    var cchCharacters = data.read_shift(4);\n    return cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n  }\n  function write_XLWideString(data, o) {\n    var _null = false;\n    if (o == null) {\n      _null = true;\n      o = new_buf(4 + 2 * data.length);\n    }\n    o.write_shift(4, data.length);\n    if (data.length > 0) o.write_shift(0, data, 'dbcs');\n    return _null ? o.slice(0, o.l) : o;\n  }\n\n  /* [MS-XLSB] 2.5.91 */\n  //function parse_LPWideString(data) {\n  //\tvar cchCharacters = data.read_shift(2);\n  //\treturn cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, \"utf16le\");\n  //}\n\n  /* [MS-XLSB] 2.5.143 */\n  function parse_StrRun(data) {\n    return {\n      ich: data.read_shift(2),\n      ifnt: data.read_shift(2)\n    };\n  }\n  function write_StrRun(run, o) {\n    if (!o) o = new_buf(4);\n    o.write_shift(2, run.ich || 0);\n    o.write_shift(2, run.ifnt || 0);\n    return o;\n  }\n\n  /* [MS-XLSB] 2.5.121 */\n  function parse_RichStr(data, length) {\n    var start = data.l;\n    var flags = data.read_shift(1);\n    var str = parse_XLWideString(data);\n    var rgsStrRun = [];\n    var z = {\n      t: str,\n      h: str\n    };\n    if ((flags & 1) !== 0) {\n      /* fRichStr */\n      /* TODO: formatted string */\n      var dwSizeStrRun = data.read_shift(4);\n      for (var i = 0; i != dwSizeStrRun; ++i) rgsStrRun.push(parse_StrRun(data));\n      z.r = rgsStrRun;\n    } else z.r = [{\n      ich: 0,\n      ifnt: 0\n    }];\n    //if((flags & 2) !== 0) { /* fExtStr */\n    //\t/* TODO: phonetic string */\n    //}\n    data.l = start + length;\n    return z;\n  }\n  function write_RichStr(str, o) {\n    /* TODO: formatted string */\n    var _null = false;\n    if (o == null) {\n      _null = true;\n      o = new_buf(15 + 4 * str.t.length);\n    }\n    o.write_shift(1, 0);\n    write_XLWideString(str.t, o);\n    return _null ? o.slice(0, o.l) : o;\n  }\n  /* [MS-XLSB] 2.4.328 BrtCommentText (RichStr w/1 run) */\n  var parse_BrtCommentText = parse_RichStr;\n  function write_BrtCommentText(str, o) {\n    /* TODO: formatted string */\n    var _null = false;\n    if (o == null) {\n      _null = true;\n      o = new_buf(23 + 4 * str.t.length);\n    }\n    o.write_shift(1, 1);\n    write_XLWideString(str.t, o);\n    o.write_shift(4, 1);\n    write_StrRun({\n      ich: 0,\n      ifnt: 0\n    }, o);\n    return _null ? o.slice(0, o.l) : o;\n  }\n\n  /* [MS-XLSB] 2.5.9 */\n  function parse_XLSBCell(data) {\n    var col = data.read_shift(4);\n    var iStyleRef = data.read_shift(2);\n    iStyleRef += data.read_shift(1) << 16;\n    data.l++; //var fPhShow = data.read_shift(1);\n    return {\n      c: col,\n      iStyleRef: iStyleRef\n    };\n  }\n  function write_XLSBCell(cell, o) {\n    if (o == null) o = new_buf(8);\n    o.write_shift(-4, cell.c);\n    o.write_shift(3, cell.iStyleRef || cell.s);\n    o.write_shift(1, 0); /* fPhShow */\n    return o;\n  }\n\n  /* Short XLSB Cell does not include column */\n  function parse_XLSBShortCell(data) {\n    var iStyleRef = data.read_shift(2);\n    iStyleRef += data.read_shift(1) << 16;\n    data.l++; //var fPhShow = data.read_shift(1);\n    return {\n      c: -1,\n      iStyleRef: iStyleRef\n    };\n  }\n  function write_XLSBShortCell(cell, o) {\n    if (o == null) o = new_buf(4);\n    o.write_shift(3, cell.iStyleRef || cell.s);\n    o.write_shift(1, 0); /* fPhShow */\n    return o;\n  }\n\n  /* [MS-XLSB] 2.5.21 */\n  var parse_XLSBCodeName = parse_XLWideString;\n  var write_XLSBCodeName = write_XLWideString;\n\n  /* [MS-XLSB] 2.5.166 */\n  function parse_XLNullableWideString(data) {\n    var cchCharacters = data.read_shift(4);\n    return cchCharacters === 0 || cchCharacters === 0xFFFFFFFF ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n  }\n  function write_XLNullableWideString(data, o) {\n    var _null = false;\n    if (o == null) {\n      _null = true;\n      o = new_buf(127);\n    }\n    o.write_shift(4, data.length > 0 ? data.length : 0xFFFFFFFF);\n    if (data.length > 0) o.write_shift(0, data, 'dbcs');\n    return _null ? o.slice(0, o.l) : o;\n  }\n\n  /* [MS-XLSB] 2.5.165 */\n  var parse_XLNameWideString = parse_XLWideString;\n  //var write_XLNameWideString = write_XLWideString;\n\n  /* [MS-XLSB] 2.5.114 */\n  var parse_RelID = parse_XLNullableWideString;\n  var write_RelID = write_XLNullableWideString;\n\n  /* [MS-XLS] 2.5.217 ; [MS-XLSB] 2.5.122 */\n  function parse_RkNumber(data) {\n    var b = data.slice(data.l, data.l + 4);\n    var fX100 = b[0] & 1,\n      fInt = b[0] & 2;\n    data.l += 4;\n    var RK = fInt === 0 ? __double([0, 0, 0, 0, b[0] & 0xFC, b[1], b[2], b[3]], 0) : __readInt32LE(b, 0) >> 2;\n    return fX100 ? RK / 100 : RK;\n  }\n  function write_RkNumber(data, o) {\n    if (o == null) o = new_buf(4);\n    var fX100 = 0,\n      fInt = 0,\n      d100 = data * 100;\n    if (data == (data | 0) && data >= -(1 << 29) && data < 1 << 29) {\n      fInt = 1;\n    } else if (d100 == (d100 | 0) && d100 >= -(1 << 29) && d100 < 1 << 29) {\n      fInt = 1;\n      fX100 = 1;\n    }\n    if (fInt) o.write_shift(-4, ((fX100 ? d100 : data) << 2) + (fX100 + 2));else throw new Error(\"unsupported RkNumber \" + data); // TODO\n  }\n\n  /* [MS-XLSB] 2.5.117 RfX */\n  function parse_RfX(data) {\n    var cell = {\n      s: {},\n      e: {}\n    };\n    cell.s.r = data.read_shift(4);\n    cell.e.r = data.read_shift(4);\n    cell.s.c = data.read_shift(4);\n    cell.e.c = data.read_shift(4);\n    return cell;\n  }\n  function write_RfX(r, o) {\n    if (!o) o = new_buf(16);\n    o.write_shift(4, r.s.r);\n    o.write_shift(4, r.e.r);\n    o.write_shift(4, r.s.c);\n    o.write_shift(4, r.e.c);\n    return o;\n  }\n\n  /* [MS-XLSB] 2.5.153 UncheckedRfX */\n  var parse_UncheckedRfX = parse_RfX;\n  var write_UncheckedRfX = write_RfX;\n\n  /* [MS-XLSB] 2.5.155 UncheckedSqRfX */\n  //function parse_UncheckedSqRfX(data) {\n  //\tvar cnt = data.read_shift(4);\n  //\tvar out = [];\n  //\tfor(var i = 0; i < cnt; ++i) {\n  //\t\tvar rng = parse_UncheckedRfX(data);\n  //\t\tout.push(encode_range(rng));\n  //\t}\n  //\treturn out.join(\",\");\n  //}\n  //function write_UncheckedSqRfX(sqrfx) {\n  //\tvar parts = sqrfx.split(/\\s*,\\s*/);\n  //\tvar o = new_buf(4); o.write_shift(4, parts.length);\n  //\tvar out = [o];\n  //\tparts.forEach(function(rng) {\n  //\t\tout.push(write_UncheckedRfX(safe_decode_range(rng)));\n  //\t});\n  //\treturn bconcat(out);\n  //}\n\n  /* [MS-XLS] 2.5.342 ; [MS-XLSB] 2.5.171 */\n  /* TODO: error checking, NaN and Infinity values are not valid Xnum */\n  function parse_Xnum(data) {\n    if (data.length - data.l < 8) throw \"XLS Xnum Buffer underflow\";\n    return data.read_shift(8, 'f');\n  }\n  function write_Xnum(data, o) {\n    return (o || new_buf(8)).write_shift(8, data, 'f');\n  }\n\n  /* [MS-XLSB] 2.4.324 BrtColor */\n  function parse_BrtColor(data) {\n    var out = {};\n    var d = data.read_shift(1);\n\n    //var fValidRGB = d & 1;\n    var xColorType = d >>> 1;\n    var index = data.read_shift(1);\n    var nTS = data.read_shift(2, 'i');\n    var bR = data.read_shift(1);\n    var bG = data.read_shift(1);\n    var bB = data.read_shift(1);\n    data.l++; //var bAlpha = data.read_shift(1);\n\n    switch (xColorType) {\n      case 0:\n        out.auto = 1;\n        break;\n      case 1:\n        out.index = index;\n        var icv = XLSIcv[index];\n        /* automatic pseudo index 81 */\n        if (icv) out.rgb = rgb2Hex(icv);\n        break;\n      case 2:\n        /* if(!fValidRGB) throw new Error(\"invalid\"); */\n        out.rgb = rgb2Hex([bR, bG, bB]);\n        break;\n      case 3:\n        out.theme = index;\n        break;\n    }\n    if (nTS != 0) out.tint = nTS > 0 ? nTS / 32767 : nTS / 32768;\n    return out;\n  }\n  function write_BrtColor(color, o) {\n    if (!o) o = new_buf(8);\n    if (!color || color.auto) {\n      o.write_shift(4, 0);\n      o.write_shift(4, 0);\n      return o;\n    }\n    if (color.index != null) {\n      o.write_shift(1, 0x02);\n      o.write_shift(1, color.index);\n    } else if (color.theme != null) {\n      o.write_shift(1, 0x06);\n      o.write_shift(1, color.theme);\n    } else {\n      o.write_shift(1, 0x05);\n      o.write_shift(1, 0);\n    }\n    var nTS = color.tint || 0;\n    if (nTS > 0) nTS *= 32767;else if (nTS < 0) nTS *= 32768;\n    o.write_shift(2, nTS);\n    if (!color.rgb || color.theme != null) {\n      o.write_shift(2, 0);\n      o.write_shift(1, 0);\n      o.write_shift(1, 0);\n    } else {\n      var rgb = color.rgb || 'FFFFFF';\n      if (typeof rgb == 'number') rgb = (\"000000\" + rgb.toString(16)).slice(-6);\n      o.write_shift(1, parseInt(rgb.slice(0, 2), 16));\n      o.write_shift(1, parseInt(rgb.slice(2, 4), 16));\n      o.write_shift(1, parseInt(rgb.slice(4, 6), 16));\n      o.write_shift(1, 0xFF);\n    }\n    return o;\n  }\n\n  /* [MS-XLSB] 2.5.52 */\n  function parse_FontFlags(data) {\n    var d = data.read_shift(1);\n    data.l++;\n    var out = {\n      fBold: d & 0x01,\n      fItalic: d & 0x02,\n      fUnderline: d & 0x04,\n      fStrikeout: d & 0x08,\n      fOutline: d & 0x10,\n      fShadow: d & 0x20,\n      fCondense: d & 0x40,\n      fExtend: d & 0x80\n    };\n    return out;\n  }\n  function write_FontFlags(font, o) {\n    if (!o) o = new_buf(2);\n    var grbit = (font.italic ? 0x02 : 0) | (font.strike ? 0x08 : 0) | (font.outline ? 0x10 : 0) | (font.shadow ? 0x20 : 0) | (font.condense ? 0x40 : 0) | (font.extend ? 0x80 : 0);\n    o.write_shift(1, grbit);\n    o.write_shift(1, 0);\n    return o;\n  }\n\n  /* [MS-OLEDS] 2.3.1 and 2.3.2 */\n  function parse_ClipboardFormatOrString(o, w) {\n    // $FlowIgnore\n    var ClipFmt = {\n      2: \"BITMAP\",\n      3: \"METAFILEPICT\",\n      8: \"DIB\",\n      14: \"ENHMETAFILE\"\n    };\n    var m = o.read_shift(4);\n    switch (m) {\n      case 0x00000000:\n        return \"\";\n      case 0xffffffff:\n      case 0xfffffffe:\n        return ClipFmt[o.read_shift(4)] || \"\";\n    }\n    if (m > 0x190) throw new Error(\"Unsupported Clipboard: \" + m.toString(16));\n    o.l -= 4;\n    return o.read_shift(0, w == 1 ? \"lpstr\" : \"lpwstr\");\n  }\n  function parse_ClipboardFormatOrAnsiString(o) {\n    return parse_ClipboardFormatOrString(o, 1);\n  }\n  function parse_ClipboardFormatOrUnicodeString(o) {\n    return parse_ClipboardFormatOrString(o, 2);\n  }\n\n  /* [MS-OLEPS] 2.2 PropertyType */\n  // Note: some tree shakers cannot handle VT_VECTOR | $CONST, hence extra vars\n  //var VT_EMPTY    = 0x0000;\n  //var VT_NULL     = 0x0001;\n  var VT_I2 = 0x0002;\n  var VT_I4 = 0x0003;\n  //var VT_R4       = 0x0004;\n  //var VT_R8       = 0x0005;\n  //var VT_CY       = 0x0006;\n  //var VT_DATE     = 0x0007;\n  //var VT_BSTR     = 0x0008;\n  //var VT_ERROR    = 0x000A;\n  var VT_BOOL = 0x000B;\n  var VT_VARIANT = 0x000C;\n  //var VT_DECIMAL  = 0x000E;\n  //var VT_I1       = 0x0010;\n  //var VT_UI1      = 0x0011;\n  //var VT_UI2      = 0x0012;\n  var VT_UI4 = 0x0013;\n  //var VT_I8       = 0x0014;\n  //var VT_UI8      = 0x0015;\n  //var VT_INT      = 0x0016;\n  //var VT_UINT     = 0x0017;\n  var VT_LPSTR = 0x001E;\n  //var VT_LPWSTR   = 0x001F;\n  var VT_FILETIME = 0x0040;\n  var VT_BLOB = 0x0041;\n  //var VT_STREAM   = 0x0042;\n  //var VT_STORAGE  = 0x0043;\n  //var VT_STREAMED_Object  = 0x0044;\n  //var VT_STORED_Object    = 0x0045;\n  //var VT_BLOB_Object      = 0x0046;\n  var VT_CF = 0x0047;\n  //var VT_CLSID    = 0x0048;\n  //var VT_VERSIONED_STREAM = 0x0049;\n  var VT_VECTOR = 0x1000;\n  var VT_VECTOR_VARIANT = 0x100C;\n  var VT_VECTOR_LPSTR = 0x101E;\n  //var VT_ARRAY    = 0x2000;\n\n  var VT_STRING = 0x0050; // 2.3.3.1.11 VtString\n  var VT_USTR = 0x0051; // 2.3.3.1.12 VtUnalignedString\n  var VT_CUSTOM = [VT_STRING, VT_USTR];\n\n  /* [MS-OSHARED] 2.3.3.2.2.1 Document Summary Information PIDDSI */\n  var DocSummaryPIDDSI = {\n    0x01: {\n      n: 'CodePage',\n      t: VT_I2\n    },\n    0x02: {\n      n: 'Category',\n      t: VT_STRING\n    },\n    0x03: {\n      n: 'PresentationFormat',\n      t: VT_STRING\n    },\n    0x04: {\n      n: 'ByteCount',\n      t: VT_I4\n    },\n    0x05: {\n      n: 'LineCount',\n      t: VT_I4\n    },\n    0x06: {\n      n: 'ParagraphCount',\n      t: VT_I4\n    },\n    0x07: {\n      n: 'SlideCount',\n      t: VT_I4\n    },\n    0x08: {\n      n: 'NoteCount',\n      t: VT_I4\n    },\n    0x09: {\n      n: 'HiddenCount',\n      t: VT_I4\n    },\n    0x0a: {\n      n: 'MultimediaClipCount',\n      t: VT_I4\n    },\n    0x0b: {\n      n: 'ScaleCrop',\n      t: VT_BOOL\n    },\n    0x0c: {\n      n: 'HeadingPairs',\n      t: VT_VECTOR_VARIANT /* VT_VECTOR | VT_VARIANT */\n    },\n    0x0d: {\n      n: 'TitlesOfParts',\n      t: VT_VECTOR_LPSTR /* VT_VECTOR | VT_LPSTR */\n    },\n    0x0e: {\n      n: 'Manager',\n      t: VT_STRING\n    },\n    0x0f: {\n      n: 'Company',\n      t: VT_STRING\n    },\n    0x10: {\n      n: 'LinksUpToDate',\n      t: VT_BOOL\n    },\n    0x11: {\n      n: 'CharacterCount',\n      t: VT_I4\n    },\n    0x13: {\n      n: 'SharedDoc',\n      t: VT_BOOL\n    },\n    0x16: {\n      n: 'HyperlinksChanged',\n      t: VT_BOOL\n    },\n    0x17: {\n      n: 'AppVersion',\n      t: VT_I4,\n      p: 'version'\n    },\n    0x18: {\n      n: 'DigSig',\n      t: VT_BLOB\n    },\n    0x1A: {\n      n: 'ContentType',\n      t: VT_STRING\n    },\n    0x1B: {\n      n: 'ContentStatus',\n      t: VT_STRING\n    },\n    0x1C: {\n      n: 'Language',\n      t: VT_STRING\n    },\n    0x1D: {\n      n: 'Version',\n      t: VT_STRING\n    },\n    0xFF: {},\n    /* [MS-OLEPS] 2.18 */\n    0x80000000: {\n      n: 'Locale',\n      t: VT_UI4\n    },\n    0x80000003: {\n      n: 'Behavior',\n      t: VT_UI4\n    },\n    0x72627262: {}\n  };\n\n  /* [MS-OSHARED] 2.3.3.2.1.1 Summary Information Property Set PIDSI */\n  var SummaryPIDSI = {\n    0x01: {\n      n: 'CodePage',\n      t: VT_I2\n    },\n    0x02: {\n      n: 'Title',\n      t: VT_STRING\n    },\n    0x03: {\n      n: 'Subject',\n      t: VT_STRING\n    },\n    0x04: {\n      n: 'Author',\n      t: VT_STRING\n    },\n    0x05: {\n      n: 'Keywords',\n      t: VT_STRING\n    },\n    0x06: {\n      n: 'Comments',\n      t: VT_STRING\n    },\n    0x07: {\n      n: 'Template',\n      t: VT_STRING\n    },\n    0x08: {\n      n: 'LastAuthor',\n      t: VT_STRING\n    },\n    0x09: {\n      n: 'RevNumber',\n      t: VT_STRING\n    },\n    0x0A: {\n      n: 'EditTime',\n      t: VT_FILETIME\n    },\n    0x0B: {\n      n: 'LastPrinted',\n      t: VT_FILETIME\n    },\n    0x0C: {\n      n: 'CreatedDate',\n      t: VT_FILETIME\n    },\n    0x0D: {\n      n: 'ModifiedDate',\n      t: VT_FILETIME\n    },\n    0x0E: {\n      n: 'PageCount',\n      t: VT_I4\n    },\n    0x0F: {\n      n: 'WordCount',\n      t: VT_I4\n    },\n    0x10: {\n      n: 'CharCount',\n      t: VT_I4\n    },\n    0x11: {\n      n: 'Thumbnail',\n      t: VT_CF\n    },\n    0x12: {\n      n: 'Application',\n      t: VT_STRING\n    },\n    0x13: {\n      n: 'DocSecurity',\n      t: VT_I4\n    },\n    0xFF: {},\n    /* [MS-OLEPS] 2.18 */\n    0x80000000: {\n      n: 'Locale',\n      t: VT_UI4\n    },\n    0x80000003: {\n      n: 'Behavior',\n      t: VT_UI4\n    },\n    0x72627262: {}\n  };\n\n  /* [MS-XLS] 2.4.63 Country/Region codes */\n  var CountryEnum = {\n    0x0001: \"US\",\n    // United States\n    0x0002: \"CA\",\n    // Canada\n    0x0003: \"\",\n    // Latin America (except Brazil)\n    0x0007: \"RU\",\n    // Russia\n    0x0014: \"EG\",\n    // Egypt\n    0x001E: \"GR\",\n    // Greece\n    0x001F: \"NL\",\n    // Netherlands\n    0x0020: \"BE\",\n    // Belgium\n    0x0021: \"FR\",\n    // France\n    0x0022: \"ES\",\n    // Spain\n    0x0024: \"HU\",\n    // Hungary\n    0x0027: \"IT\",\n    // Italy\n    0x0029: \"CH\",\n    // Switzerland\n    0x002B: \"AT\",\n    // Austria\n    0x002C: \"GB\",\n    // United Kingdom\n    0x002D: \"DK\",\n    // Denmark\n    0x002E: \"SE\",\n    // Sweden\n    0x002F: \"NO\",\n    // Norway\n    0x0030: \"PL\",\n    // Poland\n    0x0031: \"DE\",\n    // Germany\n    0x0034: \"MX\",\n    // Mexico\n    0x0037: \"BR\",\n    // Brazil\n    0x003d: \"AU\",\n    // Australia\n    0x0040: \"NZ\",\n    // New Zealand\n    0x0042: \"TH\",\n    // Thailand\n    0x0051: \"JP\",\n    // Japan\n    0x0052: \"KR\",\n    // Korea\n    0x0054: \"VN\",\n    // Viet Nam\n    0x0056: \"CN\",\n    // China\n    0x005A: \"TR\",\n    // Turkey\n    0x0069: \"JS\",\n    // Ramastan\n    0x00D5: \"DZ\",\n    // Algeria\n    0x00D8: \"MA\",\n    // Morocco\n    0x00DA: \"LY\",\n    // Libya\n    0x015F: \"PT\",\n    // Portugal\n    0x0162: \"IS\",\n    // Iceland\n    0x0166: \"FI\",\n    // Finland\n    0x01A4: \"CZ\",\n    // Czech Republic\n    0x0376: \"TW\",\n    // Taiwan\n    0x03C1: \"LB\",\n    // Lebanon\n    0x03C2: \"JO\",\n    // Jordan\n    0x03C3: \"SY\",\n    // Syria\n    0x03C4: \"IQ\",\n    // Iraq\n    0x03C5: \"KW\",\n    // Kuwait\n    0x03C6: \"SA\",\n    // Saudi Arabia\n    0x03CB: \"AE\",\n    // United Arab Emirates\n    0x03CC: \"IL\",\n    // Israel\n    0x03CE: \"QA\",\n    // Qatar\n    0x03D5: \"IR\",\n    // Iran\n    0xFFFF: \"US\" // United States\n  };\n\n  /* [MS-XLS] 2.5.127 */\n  var XLSFillPattern = [null, 'solid', 'mediumGray', 'darkGray', 'lightGray', 'darkHorizontal', 'darkVertical', 'darkDown', 'darkUp', 'darkGrid', 'darkTrellis', 'lightHorizontal', 'lightVertical', 'lightDown', 'lightUp', 'lightGrid', 'lightTrellis', 'gray125', 'gray0625'];\n  function rgbify(arr) {\n    return arr.map(function (x) {\n      return [x >> 16 & 255, x >> 8 & 255, x & 255];\n    });\n  }\n\n  /* [MS-XLS] 2.5.161 */\n  /* [MS-XLSB] 2.5.75 Icv */\n  var _XLSIcv = rgbify([/* Color Constants */\n  0x000000, 0xFFFFFF, 0xFF0000, 0x00FF00, 0x0000FF, 0xFFFF00, 0xFF00FF, 0x00FFFF, /* Overridable Defaults */\n  0x000000, 0xFFFFFF, 0xFF0000, 0x00FF00, 0x0000FF, 0xFFFF00, 0xFF00FF, 0x00FFFF, 0x800000, 0x008000, 0x000080, 0x808000, 0x800080, 0x008080, 0xC0C0C0, 0x808080, 0x9999FF, 0x993366, 0xFFFFCC, 0xCCFFFF, 0x660066, 0xFF8080, 0x0066CC, 0xCCCCFF, 0x000080, 0xFF00FF, 0xFFFF00, 0x00FFFF, 0x800080, 0x800000, 0x008080, 0x0000FF, 0x00CCFF, 0xCCFFFF, 0xCCFFCC, 0xFFFF99, 0x99CCFF, 0xFF99CC, 0xCC99FF, 0xFFCC99, 0x3366FF, 0x33CCCC, 0x99CC00, 0xFFCC00, 0xFF9900, 0xFF6600, 0x666699, 0x969696, 0x003366, 0x339966, 0x003300, 0x333300, 0x993300, 0x993366, 0x333399, 0x333333, /* Other entries to appease BIFF8/12 */\n  0xFFFFFF, /* 0x40 icvForeground ?? */\n  0x000000, /* 0x41 icvBackground ?? */\n  0x000000, /* 0x42 icvFrame ?? */\n  0x000000, /* 0x43 icv3D ?? */\n  0x000000, /* 0x44 icv3DText ?? */\n  0x000000, /* 0x45 icv3DHilite ?? */\n  0x000000, /* 0x46 icv3DShadow ?? */\n  0x000000, /* 0x47 icvHilite ?? */\n  0x000000, /* 0x48 icvCtlText ?? */\n  0x000000, /* 0x49 icvCtlScrl ?? */\n  0x000000, /* 0x4A icvCtlInv ?? */\n  0x000000, /* 0x4B icvCtlBody ?? */\n  0x000000, /* 0x4C icvCtlFrame ?? */\n  0x000000, /* 0x4D icvCtlFore ?? */\n  0x000000, /* 0x4E icvCtlBack ?? */\n  0x000000, /* 0x4F icvCtlNeutral */\n  0x000000, /* 0x50 icvInfoBk ?? */\n  0x000000 /* 0x51 icvInfoText ?? */]);\n\n  var XLSIcv = dup(_XLSIcv);\n\n  /* [MS-XLSB] 2.5.97.2 */\n  var BErr = {\n    0x00: \"#NULL!\",\n    0x07: \"#DIV/0!\",\n    0x0F: \"#VALUE!\",\n    0x17: \"#REF!\",\n    0x1D: \"#NAME?\",\n    0x24: \"#NUM!\",\n    0x2A: \"#N/A\",\n    0x2B: \"#GETTING_DATA\",\n    0xFF: \"#WTF?\"\n  };\n  //var RBErr = evert_num(BErr);\n  var RBErr = {\n    \"#NULL!\": 0x00,\n    \"#DIV/0!\": 0x07,\n    \"#VALUE!\": 0x0F,\n    \"#REF!\": 0x17,\n    \"#NAME?\": 0x1D,\n    \"#NUM!\": 0x24,\n    \"#N/A\": 0x2A,\n    \"#GETTING_DATA\": 0x2B,\n    \"#WTF?\": 0xFF\n  };\n\n  /* Parts enumerated in OPC spec, MS-XLSB and MS-XLSX */\n  /* 12.3 Part Summary <SpreadsheetML> */\n  /* 14.2 Part Summary <DrawingML> */\n  /* [MS-XLSX] 2.1 Part Enumerations ; [MS-XLSB] 2.1.7 Part Enumeration */\n  var ct2type /*{[string]:string}*/ = {\n    /* Workbook */\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\": \"workbooks\",\n    \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\": \"workbooks\",\n    \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\": \"workbooks\",\n    \"application/vnd.ms-excel.addin.macroEnabled.main+xml\": \"workbooks\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\": \"workbooks\",\n    /* Worksheet */\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\": \"sheets\",\n    \"application/vnd.ms-excel.worksheet\": \"sheets\",\n    \"application/vnd.ms-excel.binIndexWs\": \"TODO\",\n    /* Binary Index */\n\n    /* Chartsheet */\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\": \"charts\",\n    \"application/vnd.ms-excel.chartsheet\": \"charts\",\n    /* Macrosheet */\n    \"application/vnd.ms-excel.macrosheet+xml\": \"macros\",\n    \"application/vnd.ms-excel.macrosheet\": \"macros\",\n    \"application/vnd.ms-excel.intlmacrosheet\": \"TODO\",\n    \"application/vnd.ms-excel.binIndexMs\": \"TODO\",\n    /* Binary Index */\n\n    /* Dialogsheet */\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\": \"dialogs\",\n    \"application/vnd.ms-excel.dialogsheet\": \"dialogs\",\n    /* Shared Strings */\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\": \"strs\",\n    \"application/vnd.ms-excel.sharedStrings\": \"strs\",\n    /* Styles */\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\": \"styles\",\n    \"application/vnd.ms-excel.styles\": \"styles\",\n    /* File Properties */\n    \"application/vnd.openxmlformats-package.core-properties+xml\": \"coreprops\",\n    \"application/vnd.openxmlformats-officedocument.custom-properties+xml\": \"custprops\",\n    \"application/vnd.openxmlformats-officedocument.extended-properties+xml\": \"extprops\",\n    /* Custom Data Properties */\n    \"application/vnd.openxmlformats-officedocument.customXmlProperties+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty\": \"TODO\",\n    /* Comments */\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\": \"comments\",\n    \"application/vnd.ms-excel.comments\": \"comments\",\n    \"application/vnd.ms-excel.threadedcomments+xml\": \"threadedcomments\",\n    \"application/vnd.ms-excel.person+xml\": \"people\",\n    /* Metadata (Stock/Geography and Dynamic Array) */\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\": \"metadata\",\n    \"application/vnd.ms-excel.sheetMetadata\": \"metadata\",\n    /* PivotTable */\n    \"application/vnd.ms-excel.pivotTable\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml\": \"TODO\",\n    /* Chart Objects */\n    \"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\": \"TODO\",\n    /* Chart Colors */\n    \"application/vnd.ms-office.chartcolorstyle+xml\": \"TODO\",\n    /* Chart Style */\n    \"application/vnd.ms-office.chartstyle+xml\": \"TODO\",\n    /* Chart Advanced */\n    \"application/vnd.ms-office.chartex+xml\": \"TODO\",\n    /* Calculation Chain */\n    \"application/vnd.ms-excel.calcChain\": \"calcchains\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml\": \"calcchains\",\n    /* Printer Settings */\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings\": \"TODO\",\n    /* ActiveX */\n    \"application/vnd.ms-office.activeX\": \"TODO\",\n    \"application/vnd.ms-office.activeX+xml\": \"TODO\",\n    /* Custom Toolbars */\n    \"application/vnd.ms-excel.attachedToolbars\": \"TODO\",\n    /* External Data Connections */\n    \"application/vnd.ms-excel.connections\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml\": \"TODO\",\n    /* External Links */\n    \"application/vnd.ms-excel.externalLink\": \"links\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml\": \"links\",\n    /* PivotCache */\n    \"application/vnd.ms-excel.pivotCacheDefinition\": \"TODO\",\n    \"application/vnd.ms-excel.pivotCacheRecords\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml\": \"TODO\",\n    /* Query Table */\n    \"application/vnd.ms-excel.queryTable\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml\": \"TODO\",\n    /* Shared Workbook */\n    \"application/vnd.ms-excel.userNames\": \"TODO\",\n    \"application/vnd.ms-excel.revisionHeaders\": \"TODO\",\n    \"application/vnd.ms-excel.revisionLog\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml\": \"TODO\",\n    /* Single Cell Table */\n    \"application/vnd.ms-excel.tableSingleCells\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml\": \"TODO\",\n    /* Slicer */\n    \"application/vnd.ms-excel.slicer\": \"TODO\",\n    \"application/vnd.ms-excel.slicerCache\": \"TODO\",\n    \"application/vnd.ms-excel.slicer+xml\": \"TODO\",\n    \"application/vnd.ms-excel.slicerCache+xml\": \"TODO\",\n    /* Sort Map */\n    \"application/vnd.ms-excel.wsSortMap\": \"TODO\",\n    /* Table */\n    \"application/vnd.ms-excel.table\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\": \"TODO\",\n    /* Themes */\n    \"application/vnd.openxmlformats-officedocument.theme+xml\": \"themes\",\n    /* Theme Override */\n    \"application/vnd.openxmlformats-officedocument.themeOverride+xml\": \"TODO\",\n    /* Timeline */\n    \"application/vnd.ms-excel.Timeline+xml\": \"TODO\",\n    /* verify */\n    \"application/vnd.ms-excel.TimelineCache+xml\": \"TODO\",\n    /* verify */\n\n    /* VBA */\n    \"application/vnd.ms-office.vbaProject\": \"vba\",\n    \"application/vnd.ms-office.vbaProjectSignature\": \"TODO\",\n    /* Volatile Dependencies */\n    \"application/vnd.ms-office.volatileDependencies\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml\": \"TODO\",\n    /* Control Properties */\n    \"application/vnd.ms-excel.controlproperties+xml\": \"TODO\",\n    /* Data Model */\n    \"application/vnd.openxmlformats-officedocument.model+data\": \"TODO\",\n    /* Survey */\n    \"application/vnd.ms-excel.Survey+xml\": \"TODO\",\n    /* Drawing */\n    \"application/vnd.openxmlformats-officedocument.drawing+xml\": \"drawings\",\n    \"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml\": \"TODO\",\n    /* VML */\n    \"application/vnd.openxmlformats-officedocument.vmlDrawing\": \"TODO\",\n    \"application/vnd.openxmlformats-package.relationships+xml\": \"rels\",\n    \"application/vnd.openxmlformats-officedocument.oleObject\": \"TODO\",\n    /* Image */\n    \"image/png\": \"TODO\",\n    \"sheet\": \"js\"\n  };\n  var CT_LIST = {\n    workbooks: {\n      xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\",\n      xlsm: \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\",\n      xlsb: \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\",\n      xlam: \"application/vnd.ms-excel.addin.macroEnabled.main+xml\",\n      xltx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\"\n    },\n    strs: {\n      /* Shared Strings */\n      xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\",\n      xlsb: \"application/vnd.ms-excel.sharedStrings\"\n    },\n    comments: {\n      /* Comments */\n      xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\",\n      xlsb: \"application/vnd.ms-excel.comments\"\n    },\n    sheets: {\n      /* Worksheet */\n      xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\",\n      xlsb: \"application/vnd.ms-excel.worksheet\"\n    },\n    charts: {\n      /* Chartsheet */\n      xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\",\n      xlsb: \"application/vnd.ms-excel.chartsheet\"\n    },\n    dialogs: {\n      /* Dialogsheet */\n      xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\",\n      xlsb: \"application/vnd.ms-excel.dialogsheet\"\n    },\n    macros: {\n      /* Macrosheet (Excel 4.0 Macros) */\n      xlsx: \"application/vnd.ms-excel.macrosheet+xml\",\n      xlsb: \"application/vnd.ms-excel.macrosheet\"\n    },\n    metadata: {\n      /* Metadata (Stock/Geography and Dynamic Array) */\n      xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\",\n      xlsb: \"application/vnd.ms-excel.sheetMetadata\"\n    },\n    styles: {\n      /* Styles */\n      xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\",\n      xlsb: \"application/vnd.ms-excel.styles\"\n    }\n  };\n  function new_ct() {\n    return {\n      workbooks: [],\n      sheets: [],\n      charts: [],\n      dialogs: [],\n      macros: [],\n      rels: [],\n      strs: [],\n      comments: [],\n      threadedcomments: [],\n      links: [],\n      coreprops: [],\n      extprops: [],\n      custprops: [],\n      themes: [],\n      styles: [],\n      calcchains: [],\n      vba: [],\n      drawings: [],\n      metadata: [],\n      people: [],\n      TODO: [],\n      xmlns: \"\"\n    };\n  }\n  function parse_ct(data) {\n    var ct = new_ct();\n    if (!data || !data.match) return ct;\n    var ctext = {};\n    (data.match(tagregex) || []).forEach(function (x) {\n      var y = parsexmltag(x);\n      switch (y[0].replace(nsregex, \"<\")) {\n        case '<?xml':\n          break;\n        case '<Types':\n          ct.xmlns = y['xmlns' + (y[0].match(/<(\\w+):/) || [\"\", \"\"])[1]];\n          break;\n        case '<Default':\n          ctext[y.Extension] = y.ContentType;\n          break;\n        case '<Override':\n          if (ct[ct2type[y.ContentType]] !== undefined) ct[ct2type[y.ContentType]].push(y.PartName);\n          break;\n      }\n    });\n    if (ct.xmlns !== XMLNS.CT) throw new Error(\"Unknown Namespace: \" + ct.xmlns);\n    ct.calcchain = ct.calcchains.length > 0 ? ct.calcchains[0] : \"\";\n    ct.sst = ct.strs.length > 0 ? ct.strs[0] : \"\";\n    ct.style = ct.styles.length > 0 ? ct.styles[0] : \"\";\n    ct.defaults = ctext;\n    delete ct.calcchains;\n    return ct;\n  }\n  function write_ct(ct, opts) {\n    var type2ct /*{[string]:Array<string>}*/ = evert_arr(ct2type);\n    var o = [],\n      v;\n    o[o.length] = XML_HEADER;\n    o[o.length] = writextag('Types', null, {\n      'xmlns': XMLNS.CT,\n      'xmlns:xsd': XMLNS.xsd,\n      'xmlns:xsi': XMLNS.xsi\n    });\n    o = o.concat([['xml', 'application/xml'], ['bin', 'application/vnd.ms-excel.sheet.binary.macroEnabled.main'], ['vml', 'application/vnd.openxmlformats-officedocument.vmlDrawing'], ['data', 'application/vnd.openxmlformats-officedocument.model+data'], /* from test files */\n    ['bmp', 'image/bmp'], ['png', 'image/png'], ['gif', 'image/gif'], ['emf', 'image/x-emf'], ['wmf', 'image/x-wmf'], ['jpg', 'image/jpeg'], ['jpeg', 'image/jpeg'], ['tif', 'image/tiff'], ['tiff', 'image/tiff'], ['pdf', 'application/pdf'], ['rels', 'application/vnd.openxmlformats-package.relationships+xml']].map(function (x) {\n      return writextag('Default', null, {\n        'Extension': x[0],\n        'ContentType': x[1]\n      });\n    }));\n\n    /* only write first instance */\n    var f1 = function (w) {\n      if (ct[w] && ct[w].length > 0) {\n        v = ct[w][0];\n        o[o.length] = writextag('Override', null, {\n          'PartName': (v[0] == '/' ? \"\" : \"/\") + v,\n          'ContentType': CT_LIST[w][opts.bookType] || CT_LIST[w]['xlsx']\n        });\n      }\n    };\n\n    /* book type-specific */\n    var f2 = function (w) {\n      (ct[w] || []).forEach(function (v) {\n        o[o.length] = writextag('Override', null, {\n          'PartName': (v[0] == '/' ? \"\" : \"/\") + v,\n          'ContentType': CT_LIST[w][opts.bookType] || CT_LIST[w]['xlsx']\n        });\n      });\n    };\n\n    /* standard type */\n    var f3 = function (t) {\n      (ct[t] || []).forEach(function (v) {\n        o[o.length] = writextag('Override', null, {\n          'PartName': (v[0] == '/' ? \"\" : \"/\") + v,\n          'ContentType': type2ct[t][0]\n        });\n      });\n    };\n    f1('workbooks');\n    f2('sheets');\n    f2('charts');\n    f3('themes');\n    ['strs', 'styles'].forEach(f1);\n    ['coreprops', 'extprops', 'custprops'].forEach(f3);\n    f3('vba');\n    f3('comments');\n    f3('threadedcomments');\n    f3('drawings');\n    f2('metadata');\n    f3('people');\n    if (o.length > 2) {\n      o[o.length] = '</Types>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n    return o.join(\"\");\n  }\n  /* 9.3 Relationships */\n  var RELS = {\n    WB: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n    SHEET: \"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n    HLINK: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\",\n    VML: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing\",\n    XPATH: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath\",\n    XMISS: \"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing\",\n    XLINK: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink\",\n    CXML: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml\",\n    CXMLP: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps\",\n    CMNT: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments\",\n    CORE_PROPS: \"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\",\n    EXT_PROPS: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties',\n    CUST_PROPS: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties',\n    SST: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\",\n    STY: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\",\n    THEME: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\",\n    CHART: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart\",\n    CHARTEX: \"http://schemas.microsoft.com/office/2014/relationships/chartEx\",\n    CS: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet\",\n    WS: [\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\", \"http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet\"],\n    DS: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet\",\n    MS: \"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet\",\n    IMG: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\",\n    DRAW: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing\",\n    XLMETA: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata\",\n    TCMNT: \"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment\",\n    PEOPLE: \"http://schemas.microsoft.com/office/2017/10/relationships/person\",\n    VBA: \"http://schemas.microsoft.com/office/2006/relationships/vbaProject\"\n  };\n\n  /* 9.3.3 Representing Relationships */\n  function get_rels_path(file) {\n    var n = file.lastIndexOf(\"/\");\n    return file.slice(0, n + 1) + '_rels/' + file.slice(n + 1) + \".rels\";\n  }\n  function parse_rels(data, currentFilePath) {\n    var rels = {\n      \"!id\": {}\n    };\n    if (!data) return rels;\n    if (currentFilePath.charAt(0) !== '/') {\n      currentFilePath = '/' + currentFilePath;\n    }\n    var hash = {};\n    (data.match(tagregex) || []).forEach(function (x) {\n      var y = parsexmltag(x);\n      /* 9.3.2.2 OPC_Relationships */\n      if (y[0] === '<Relationship') {\n        var rel = {};\n        rel.Type = y.Type;\n        rel.Target = y.Target;\n        rel.Id = y.Id;\n        if (y.TargetMode) rel.TargetMode = y.TargetMode;\n        var canonictarget = y.TargetMode === 'External' ? y.Target : resolve_path(y.Target, currentFilePath);\n        rels[canonictarget] = rel;\n        hash[y.Id] = rel;\n      }\n    });\n    rels[\"!id\"] = hash;\n    return rels;\n  }\n\n  /* TODO */\n  function write_rels(rels) {\n    var o = [XML_HEADER, writextag('Relationships', null, {\n      //'xmlns:ns0': XMLNS.RELS,\n      'xmlns': XMLNS.RELS\n    })];\n    keys(rels['!id']).forEach(function (rid) {\n      o[o.length] = writextag('Relationship', null, rels['!id'][rid]);\n    });\n    if (o.length > 2) {\n      o[o.length] = '</Relationships>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n    return o.join(\"\");\n  }\n  function add_rels(rels, rId, f, type, relobj, targetmode) {\n    if (!relobj) relobj = {};\n    if (!rels['!id']) rels['!id'] = {};\n    if (!rels['!idx']) rels['!idx'] = 1;\n    if (rId < 0) for (rId = rels['!idx']; rels['!id']['rId' + rId]; ++rId) {/* empty */}\n    rels['!idx'] = rId + 1;\n    relobj.Id = 'rId' + rId;\n    relobj.Type = type;\n    relobj.Target = f;\n    if (targetmode) relobj.TargetMode = targetmode;else if ([RELS.HLINK, RELS.XPATH, RELS.XMISS].indexOf(relobj.Type) > -1) relobj.TargetMode = \"External\";\n    if (rels['!id'][relobj.Id]) throw new Error(\"Cannot rewrite rId \" + rId);\n    rels['!id'][relobj.Id] = relobj;\n    rels[('/' + relobj.Target).replace(\"//\", \"/\")] = relobj;\n    return rId;\n  }\n  /* Open Document Format for Office Applications (OpenDocument) Version 1.2 */\n  /* Part 3 Section 4 Manifest File */\n  var CT_ODS = \"application/vnd.oasis.opendocument.spreadsheet\";\n  function parse_manifest(d, opts) {\n    var str = xlml_normalize(d);\n    var Rn;\n    var FEtag;\n    while (Rn = xlmlregex.exec(str)) switch (Rn[3]) {\n      case 'manifest':\n        break;\n      // 4.2 <manifest:manifest>\n      case 'file-entry':\n        // 4.3 <manifest:file-entry>\n        FEtag = parsexmltag(Rn[0], false);\n        if (FEtag.path == '/' && FEtag.type !== CT_ODS) throw new Error(\"This OpenDocument is not a spreadsheet\");\n        break;\n      case 'encryption-data': // 4.4 <manifest:encryption-data>\n      case 'algorithm': // 4.5 <manifest:algorithm>\n      case 'start-key-generation': // 4.6 <manifest:start-key-generation>\n      case 'key-derivation':\n        // 4.7 <manifest:key-derivation>\n        throw new Error(\"Unsupported ODS Encryption\");\n      default:\n        if (opts && opts.WTF) throw Rn;\n    }\n  }\n  function write_manifest(manifest) {\n    var o = [XML_HEADER];\n    o.push('<manifest:manifest xmlns:manifest=\"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0\" manifest:version=\"1.2\">\\n');\n    o.push('  <manifest:file-entry manifest:full-path=\"/\" manifest:version=\"1.2\" manifest:media-type=\"application/vnd.oasis.opendocument.spreadsheet\"/>\\n');\n    for (var i = 0; i < manifest.length; ++i) o.push('  <manifest:file-entry manifest:full-path=\"' + manifest[i][0] + '\" manifest:media-type=\"' + manifest[i][1] + '\"/>\\n');\n    o.push('</manifest:manifest>');\n    return o.join(\"\");\n  }\n\n  /* Part 3 Section 6 Metadata Manifest File */\n  function write_rdf_type(file, res, tag) {\n    return ['  <rdf:Description rdf:about=\"' + file + '\">\\n', '    <rdf:type rdf:resource=\"http://docs.oasis-open.org/ns/office/1.2/meta/' + (tag || \"odf\") + '#' + res + '\"/>\\n', '  </rdf:Description>\\n'].join(\"\");\n  }\n  function write_rdf_has(base, file) {\n    return ['  <rdf:Description rdf:about=\"' + base + '\">\\n', '    <ns0:hasPart xmlns:ns0=\"http://docs.oasis-open.org/ns/office/1.2/meta/pkg#\" rdf:resource=\"' + file + '\"/>\\n', '  </rdf:Description>\\n'].join(\"\");\n  }\n  function write_rdf(rdf) {\n    var o = [XML_HEADER];\n    o.push('<rdf:RDF xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\\n');\n    for (var i = 0; i != rdf.length; ++i) {\n      o.push(write_rdf_type(rdf[i][0], rdf[i][1]));\n      o.push(write_rdf_has(\"\", rdf[i][0]));\n    }\n    o.push(write_rdf_type(\"\", \"Document\", \"pkg\"));\n    o.push('</rdf:RDF>');\n    return o.join(\"\");\n  }\n  /* TODO: pull properties */\n  function write_meta_ods() {\n    return '<office:document-meta xmlns:office=\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\" xmlns:meta=\"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" office:version=\"1.2\"><office:meta><meta:generator>Sheet' + 'JS ' + XLSX.version + '</meta:generator></office:meta></office:document-meta>';\n  }\n\n  /* ECMA-376 Part II 11.1 Core Properties Part */\n  /* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\n  var CORE_PROPS = [[\"cp:category\", \"Category\"], [\"cp:contentStatus\", \"ContentStatus\"], [\"cp:keywords\", \"Keywords\"], [\"cp:lastModifiedBy\", \"LastAuthor\"], [\"cp:lastPrinted\", \"LastPrinted\"], [\"cp:revision\", \"RevNumber\"], [\"cp:version\", \"Version\"], [\"dc:creator\", \"Author\"], [\"dc:description\", \"Comments\"], [\"dc:identifier\", \"Identifier\"], [\"dc:language\", \"Language\"], [\"dc:subject\", \"Subject\"], [\"dc:title\", \"Title\"], [\"dcterms:created\", \"CreatedDate\", 'date'], [\"dcterms:modified\", \"ModifiedDate\", 'date']];\n  var CORE_PROPS_REGEX = function () {\n    var r = new Array(CORE_PROPS.length);\n    for (var i = 0; i < CORE_PROPS.length; ++i) {\n      var f = CORE_PROPS[i];\n      var g = \"(?:\" + f[0].slice(0, f[0].indexOf(\":\")) + \":)\" + f[0].slice(f[0].indexOf(\":\") + 1);\n      r[i] = new RegExp(\"<\" + g + \"[^>]*>([\\\\s\\\\S]*?)<\\/\" + g + \">\");\n    }\n    return r;\n  }();\n  function parse_core_props(data) {\n    var p = {};\n    data = utf8read(data);\n    for (var i = 0; i < CORE_PROPS.length; ++i) {\n      var f = CORE_PROPS[i],\n        cur = data.match(CORE_PROPS_REGEX[i]);\n      if (cur != null && cur.length > 0) p[f[1]] = unescapexml(cur[1]);\n      if (f[2] === 'date' && p[f[1]]) p[f[1]] = parseDate(p[f[1]]);\n    }\n    return p;\n  }\n  function cp_doit(f, g, h, o, p) {\n    if (p[f] != null || g == null || g === \"\") return;\n    p[f] = g;\n    g = escapexml(g);\n    o[o.length] = h ? writextag(f, g, h) : writetag(f, g);\n  }\n  function write_core_props(cp, _opts) {\n    var opts = _opts || {};\n    var o = [XML_HEADER, writextag('cp:coreProperties', null, {\n        //'xmlns': XMLNS.CORE_PROPS,\n        'xmlns:cp': XMLNS.CORE_PROPS,\n        'xmlns:dc': XMLNS.dc,\n        'xmlns:dcterms': XMLNS.dcterms,\n        'xmlns:dcmitype': XMLNS.dcmitype,\n        'xmlns:xsi': XMLNS.xsi\n      })],\n      p = {};\n    if (!cp && !opts.Props) return o.join(\"\");\n    if (cp) {\n      if (cp.CreatedDate != null) cp_doit(\"dcterms:created\", typeof cp.CreatedDate === \"string\" ? cp.CreatedDate : write_w3cdtf(cp.CreatedDate, opts.WTF), {\n        \"xsi:type\": \"dcterms:W3CDTF\"\n      }, o, p);\n      if (cp.ModifiedDate != null) cp_doit(\"dcterms:modified\", typeof cp.ModifiedDate === \"string\" ? cp.ModifiedDate : write_w3cdtf(cp.ModifiedDate, opts.WTF), {\n        \"xsi:type\": \"dcterms:W3CDTF\"\n      }, o, p);\n    }\n    for (var i = 0; i != CORE_PROPS.length; ++i) {\n      var f = CORE_PROPS[i];\n      var v = opts.Props && opts.Props[f[1]] != null ? opts.Props[f[1]] : cp ? cp[f[1]] : null;\n      if (v === true) v = \"1\";else if (v === false) v = \"0\";else if (typeof v == \"number\") v = String(v);\n      if (v != null) cp_doit(f[0], v, null, o, p);\n    }\n    if (o.length > 2) {\n      o[o.length] = '</cp:coreProperties>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n    return o.join(\"\");\n  }\n  /* 15.2.12.3 Extended File Properties Part */\n  /* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\n  var EXT_PROPS = [[\"Application\", \"Application\", \"string\"], [\"AppVersion\", \"AppVersion\", \"string\"], [\"Company\", \"Company\", \"string\"], [\"DocSecurity\", \"DocSecurity\", \"string\"], [\"Manager\", \"Manager\", \"string\"], [\"HyperlinksChanged\", \"HyperlinksChanged\", \"bool\"], [\"SharedDoc\", \"SharedDoc\", \"bool\"], [\"LinksUpToDate\", \"LinksUpToDate\", \"bool\"], [\"ScaleCrop\", \"ScaleCrop\", \"bool\"], [\"HeadingPairs\", \"HeadingPairs\", \"raw\"], [\"TitlesOfParts\", \"TitlesOfParts\", \"raw\"]];\n  var PseudoPropsPairs = [\"Worksheets\", \"SheetNames\", \"NamedRanges\", \"DefinedNames\", \"Chartsheets\", \"ChartNames\"];\n  function load_props_pairs(HP, TOP, props, opts) {\n    var v = [];\n    if (typeof HP == \"string\") v = parseVector(HP, opts);else for (var j = 0; j < HP.length; ++j) v = v.concat(HP[j].map(function (hp) {\n      return {\n        v: hp\n      };\n    }));\n    var parts = typeof TOP == \"string\" ? parseVector(TOP, opts).map(function (x) {\n      return x.v;\n    }) : TOP;\n    var idx = 0,\n      len = 0;\n    if (parts.length > 0) for (var i = 0; i !== v.length; i += 2) {\n      len = +v[i + 1].v;\n      switch (v[i].v) {\n        case \"Worksheets\":\n        case \"工作表\":\n        case \"Листы\":\n        case \"أوراق العمل\":\n        case \"ワークシート\":\n        case \"גליונות עבודה\":\n        case \"Arbeitsblätter\":\n        case \"Çalışma Sayfaları\":\n        case \"Feuilles de calcul\":\n        case \"Fogli di lavoro\":\n        case \"Folhas de cálculo\":\n        case \"Planilhas\":\n        case \"Regneark\":\n        case \"Hojas de cálculo\":\n        case \"Werkbladen\":\n          props.Worksheets = len;\n          props.SheetNames = parts.slice(idx, idx + len);\n          break;\n        case \"Named Ranges\":\n        case \"Rangos con nombre\":\n        case \"名前付き一覧\":\n        case \"Benannte Bereiche\":\n        case \"Navngivne områder\":\n          props.NamedRanges = len;\n          props.DefinedNames = parts.slice(idx, idx + len);\n          break;\n        case \"Charts\":\n        case \"Diagramme\":\n          props.Chartsheets = len;\n          props.ChartNames = parts.slice(idx, idx + len);\n          break;\n      }\n      idx += len;\n    }\n  }\n  function parse_ext_props(data, p, opts) {\n    var q = {};\n    if (!p) p = {};\n    data = utf8read(data);\n    EXT_PROPS.forEach(function (f) {\n      var xml = (data.match(matchtag(f[0])) || [])[1];\n      switch (f[2]) {\n        case \"string\":\n          if (xml) p[f[1]] = unescapexml(xml);\n          break;\n        case \"bool\":\n          p[f[1]] = xml === \"true\";\n          break;\n        case \"raw\":\n          var cur = data.match(new RegExp(\"<\" + f[0] + \"[^>]*>([\\\\s\\\\S]*?)<\\/\" + f[0] + \">\"));\n          if (cur && cur.length > 0) q[f[1]] = cur[1];\n          break;\n      }\n    });\n    if (q.HeadingPairs && q.TitlesOfParts) load_props_pairs(q.HeadingPairs, q.TitlesOfParts, p, opts);\n    return p;\n  }\n  function write_ext_props(cp) {\n    var o = [],\n      W = writextag;\n    if (!cp) cp = {};\n    cp.Application = \"SheetJS\";\n    o[o.length] = XML_HEADER;\n    o[o.length] = writextag('Properties', null, {\n      'xmlns': XMLNS.EXT_PROPS,\n      'xmlns:vt': XMLNS.vt\n    });\n    EXT_PROPS.forEach(function (f) {\n      if (cp[f[1]] === undefined) return;\n      var v;\n      switch (f[2]) {\n        case 'string':\n          v = escapexml(String(cp[f[1]]));\n          break;\n        case 'bool':\n          v = cp[f[1]] ? 'true' : 'false';\n          break;\n      }\n      if (v !== undefined) o[o.length] = W(f[0], v);\n    });\n\n    /* TODO: HeadingPairs, TitlesOfParts */\n    o[o.length] = W('HeadingPairs', W('vt:vector', W('vt:variant', '<vt:lpstr>Worksheets</vt:lpstr>') + W('vt:variant', W('vt:i4', String(cp.Worksheets))), {\n      size: 2,\n      baseType: \"variant\"\n    }));\n    o[o.length] = W('TitlesOfParts', W('vt:vector', cp.SheetNames.map(function (s) {\n      return \"<vt:lpstr>\" + escapexml(s) + \"</vt:lpstr>\";\n    }).join(\"\"), {\n      size: cp.Worksheets,\n      baseType: \"lpstr\"\n    }));\n    if (o.length > 2) {\n      o[o.length] = '</Properties>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n    return o.join(\"\");\n  }\n  /* 15.2.12.2 Custom File Properties Part */\n  var custregex = /<[^>]+>[^<]*/g;\n  function parse_cust_props(data, opts) {\n    var p = {},\n      name = \"\";\n    var m = data.match(custregex);\n    if (m) for (var i = 0; i != m.length; ++i) {\n      var x = m[i],\n        y = parsexmltag(x);\n      switch (y[0]) {\n        case '<?xml':\n          break;\n        case '<Properties':\n          break;\n        case '<property':\n          name = unescapexml(y.name);\n          break;\n        case '</property>':\n          name = null;\n          break;\n        default:\n          if (x.indexOf('<vt:') === 0) {\n            var toks = x.split('>');\n            var type = toks[0].slice(4),\n              text = toks[1];\n            /* 22.4.2.32 (CT_Variant). Omit the binary types from 22.4 (Variant Types) */\n            switch (type) {\n              case 'lpstr':\n              case 'bstr':\n              case 'lpwstr':\n                p[name] = unescapexml(text);\n                break;\n              case 'bool':\n                p[name] = parsexmlbool(text);\n                break;\n              case 'i1':\n              case 'i2':\n              case 'i4':\n              case 'i8':\n              case 'int':\n              case 'uint':\n                p[name] = parseInt(text, 10);\n                break;\n              case 'r4':\n              case 'r8':\n              case 'decimal':\n                p[name] = parseFloat(text);\n                break;\n              case 'filetime':\n              case 'date':\n                p[name] = parseDate(text);\n                break;\n              case 'cy':\n              case 'error':\n                p[name] = unescapexml(text);\n                break;\n              default:\n                if (type.slice(-1) == '/') break;\n                if (opts.WTF && typeof console !== 'undefined') console.warn('Unexpected', x, type, toks);\n            }\n          } else if (x.slice(0, 2) === \"</\") {/* empty */\n          } else if (opts.WTF) throw new Error(x);\n      }\n    }\n    return p;\n  }\n  function write_cust_props(cp) {\n    var o = [XML_HEADER, writextag('Properties', null, {\n      'xmlns': XMLNS.CUST_PROPS,\n      'xmlns:vt': XMLNS.vt\n    })];\n    if (!cp) return o.join(\"\");\n    var pid = 1;\n    keys(cp).forEach(function custprop(k) {\n      ++pid;\n      o[o.length] = writextag('property', write_vt(cp[k], true), {\n        'fmtid': '{D5CDD505-2E9C-101B-9397-08002B2CF9AE}',\n        'pid': pid,\n        'name': escapexml(k)\n      });\n    });\n    if (o.length > 2) {\n      o[o.length] = '</Properties>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n    return o.join(\"\");\n  }\n  /* Common Name -> XLML Name */\n  var XLMLDocPropsMap = {\n    Title: 'Title',\n    Subject: 'Subject',\n    Author: 'Author',\n    Keywords: 'Keywords',\n    Comments: 'Description',\n    LastAuthor: 'LastAuthor',\n    RevNumber: 'Revision',\n    Application: 'AppName',\n    /* TotalTime: 'TotalTime', */\n    LastPrinted: 'LastPrinted',\n    CreatedDate: 'Created',\n    ModifiedDate: 'LastSaved',\n    /* Pages */\n    /* Words */\n    /* Characters */\n    Category: 'Category',\n    /* PresentationFormat */\n    Manager: 'Manager',\n    Company: 'Company',\n    /* Guid */\n    /* HyperlinkBase */\n    /* Bytes */\n    /* Lines */\n    /* Paragraphs */\n    /* CharactersWithSpaces */\n    AppVersion: 'Version',\n    ContentStatus: 'ContentStatus',\n    /* NOTE: missing from schema */\n    Identifier: 'Identifier',\n    /* NOTE: missing from schema */\n    Language: 'Language' /* NOTE: missing from schema */\n  };\n\n  var evert_XLMLDPM;\n  function xlml_set_prop(Props, tag, val) {\n    if (!evert_XLMLDPM) evert_XLMLDPM = evert(XLMLDocPropsMap);\n    tag = evert_XLMLDPM[tag] || tag;\n    Props[tag] = val;\n  }\n  function xlml_write_docprops(Props, opts) {\n    var o = [];\n    keys(XLMLDocPropsMap).map(function (m) {\n      for (var i = 0; i < CORE_PROPS.length; ++i) if (CORE_PROPS[i][1] == m) return CORE_PROPS[i];\n      for (i = 0; i < EXT_PROPS.length; ++i) if (EXT_PROPS[i][1] == m) return EXT_PROPS[i];\n      throw m;\n    }).forEach(function (p) {\n      if (Props[p[1]] == null) return;\n      var m = opts && opts.Props && opts.Props[p[1]] != null ? opts.Props[p[1]] : Props[p[1]];\n      switch (p[2]) {\n        case 'date':\n          m = new Date(m).toISOString().replace(/\\.\\d*Z/, \"Z\");\n          break;\n      }\n      if (typeof m == 'number') m = String(m);else if (m === true || m === false) {\n        m = m ? \"1\" : \"0\";\n      } else if (m instanceof Date) m = new Date(m).toISOString().replace(/\\.\\d*Z/, \"\");\n      o.push(writetag(XLMLDocPropsMap[p[1]] || p[1], m));\n    });\n    return writextag('DocumentProperties', o.join(\"\"), {\n      xmlns: XLMLNS.o\n    });\n  }\n  function xlml_write_custprops(Props, Custprops) {\n    var BLACKLIST = [\"Worksheets\", \"SheetNames\"];\n    var T = 'CustomDocumentProperties';\n    var o = [];\n    if (Props) keys(Props).forEach(function (k) {\n      if (!Object.prototype.hasOwnProperty.call(Props, k)) return;\n      for (var i = 0; i < CORE_PROPS.length; ++i) if (k == CORE_PROPS[i][1]) return;\n      for (i = 0; i < EXT_PROPS.length; ++i) if (k == EXT_PROPS[i][1]) return;\n      for (i = 0; i < BLACKLIST.length; ++i) if (k == BLACKLIST[i]) return;\n      var m = Props[k];\n      var t = \"string\";\n      if (typeof m == 'number') {\n        t = \"float\";\n        m = String(m);\n      } else if (m === true || m === false) {\n        t = \"boolean\";\n        m = m ? \"1\" : \"0\";\n      } else m = String(m);\n      o.push(writextag(escapexmltag(k), m, {\n        \"dt:dt\": t\n      }));\n    });\n    if (Custprops) keys(Custprops).forEach(function (k) {\n      if (!Object.prototype.hasOwnProperty.call(Custprops, k)) return;\n      if (Props && Object.prototype.hasOwnProperty.call(Props, k)) return;\n      var m = Custprops[k];\n      var t = \"string\";\n      if (typeof m == 'number') {\n        t = \"float\";\n        m = String(m);\n      } else if (m === true || m === false) {\n        t = \"boolean\";\n        m = m ? \"1\" : \"0\";\n      } else if (m instanceof Date) {\n        t = \"dateTime.tz\";\n        m = m.toISOString();\n      } else m = String(m);\n      o.push(writextag(escapexmltag(k), m, {\n        \"dt:dt\": t\n      }));\n    });\n    return '<' + T + ' xmlns=\"' + XLMLNS.o + '\">' + o.join(\"\") + '</' + T + '>';\n  }\n  /* [MS-DTYP] 2.3.3 FILETIME */\n  /* [MS-OLEDS] 2.1.3 FILETIME (Packet Version) */\n  /* [MS-OLEPS] 2.8 FILETIME (Packet Version) */\n  function parse_FILETIME(blob) {\n    var dwLowDateTime = blob.read_shift(4),\n      dwHighDateTime = blob.read_shift(4);\n    return new Date((dwHighDateTime / 1e7 * Math.pow(2, 32) + dwLowDateTime / 1e7 - 11644473600) * 1000).toISOString().replace(/\\.000/, \"\");\n  }\n  function write_FILETIME(time) {\n    var date = typeof time == \"string\" ? new Date(Date.parse(time)) : time;\n    var t = date.getTime() / 1000 + 11644473600;\n    var l = t % Math.pow(2, 32),\n      h = (t - l) / Math.pow(2, 32);\n    l *= 1e7;\n    h *= 1e7;\n    var w = l / Math.pow(2, 32) | 0;\n    if (w > 0) {\n      l = l % Math.pow(2, 32);\n      h += w;\n    }\n    var o = new_buf(8);\n    o.write_shift(4, l);\n    o.write_shift(4, h);\n    return o;\n  }\n\n  /* [MS-OSHARED] 2.3.3.1.4 Lpstr */\n  function parse_lpstr(blob, type, pad) {\n    var start = blob.l;\n    var str = blob.read_shift(0, 'lpstr-cp');\n    if (pad) while (blob.l - start & 3) ++blob.l;\n    return str;\n  }\n\n  /* [MS-OSHARED] 2.3.3.1.6 Lpwstr */\n  function parse_lpwstr(blob, type, pad) {\n    var str = blob.read_shift(0, 'lpwstr');\n    if (pad) blob.l += 4 - (str.length + 1 & 3) & 3;\n    return str;\n  }\n\n  /* [MS-OSHARED] 2.3.3.1.11 VtString */\n  /* [MS-OSHARED] 2.3.3.1.12 VtUnalignedString */\n  function parse_VtStringBase(blob, stringType, pad) {\n    if (stringType === 0x1F /*VT_LPWSTR*/) return parse_lpwstr(blob);\n    return parse_lpstr(blob, stringType, pad);\n  }\n  function parse_VtString(blob, t, pad) {\n    return parse_VtStringBase(blob, t, pad === false ? 0 : 4);\n  }\n  function parse_VtUnalignedString(blob, t) {\n    if (!t) throw new Error(\"VtUnalignedString must have positive length\");\n    return parse_VtStringBase(blob, t, 0);\n  }\n\n  /* [MS-OSHARED] 2.3.3.1.7 VtVecLpwstrValue */\n  function parse_VtVecLpwstrValue(blob) {\n    var length = blob.read_shift(4);\n    var ret = [];\n    for (var i = 0; i != length; ++i) {\n      var start = blob.l;\n      ret[i] = blob.read_shift(0, 'lpwstr').replace(chr0, '');\n      if (blob.l - start & 0x02) blob.l += 2;\n    }\n    return ret;\n  }\n\n  /* [MS-OSHARED] 2.3.3.1.9 VtVecUnalignedLpstrValue */\n  function parse_VtVecUnalignedLpstrValue(blob) {\n    var length = blob.read_shift(4);\n    var ret = [];\n    for (var i = 0; i != length; ++i) ret[i] = blob.read_shift(0, 'lpstr-cp').replace(chr0, '');\n    return ret;\n  }\n\n  /* [MS-OSHARED] 2.3.3.1.13 VtHeadingPair */\n  function parse_VtHeadingPair(blob) {\n    var start = blob.l;\n    var headingString = parse_TypedPropertyValue(blob, VT_USTR);\n    if (blob[blob.l] == 0x00 && blob[blob.l + 1] == 0x00 && blob.l - start & 0x02) blob.l += 2;\n    var headerParts = parse_TypedPropertyValue(blob, VT_I4);\n    return [headingString, headerParts];\n  }\n\n  /* [MS-OSHARED] 2.3.3.1.14 VtVecHeadingPairValue */\n  function parse_VtVecHeadingPairValue(blob) {\n    var cElements = blob.read_shift(4);\n    var out = [];\n    for (var i = 0; i < cElements / 2; ++i) out.push(parse_VtHeadingPair(blob));\n    return out;\n  }\n\n  /* [MS-OLEPS] 2.18.1 Dictionary (uses 2.17, 2.16) */\n  function parse_dictionary(blob, CodePage) {\n    var cnt = blob.read_shift(4);\n    var dict = {};\n    for (var j = 0; j != cnt; ++j) {\n      var pid = blob.read_shift(4);\n      var len = blob.read_shift(4);\n      dict[pid] = blob.read_shift(len, CodePage === 0x4B0 ? 'utf16le' : 'utf8').replace(chr0, '').replace(chr1, '!');\n      if (CodePage === 0x4B0 && len % 2) blob.l += 2;\n    }\n    if (blob.l & 3) blob.l = blob.l >> 2 + 1 << 2;\n    return dict;\n  }\n\n  /* [MS-OLEPS] 2.9 BLOB */\n  function parse_BLOB(blob) {\n    var size = blob.read_shift(4);\n    var bytes = blob.slice(blob.l, blob.l + size);\n    blob.l += size;\n    if ((size & 3) > 0) blob.l += 4 - (size & 3) & 3;\n    return bytes;\n  }\n\n  /* [MS-OLEPS] 2.11 ClipboardData */\n  function parse_ClipboardData(blob) {\n    // TODO\n    var o = {};\n    o.Size = blob.read_shift(4);\n    //o.Format = blob.read_shift(4);\n    blob.l += o.Size + 3 - (o.Size - 1) % 4;\n    return o;\n  }\n\n  /* [MS-OLEPS] 2.15 TypedPropertyValue */\n  function parse_TypedPropertyValue(blob, type, _opts) {\n    var t = blob.read_shift(2),\n      ret,\n      opts = _opts || {};\n    blob.l += 2;\n    if (type !== VT_VARIANT) if (t !== type && VT_CUSTOM.indexOf(type) === -1 && !((type & 0xFFFE) == 0x101E && (t & 0xFFFE) == 0x101E)) throw new Error('Expected type ' + type + ' saw ' + t);\n    switch (type === VT_VARIANT ? t : type) {\n      case 0x02 /*VT_I2*/:\n        ret = blob.read_shift(2, 'i');\n        if (!opts.raw) blob.l += 2;\n        return ret;\n      case 0x03 /*VT_I4*/:\n        ret = blob.read_shift(4, 'i');\n        return ret;\n      case 0x0B /*VT_BOOL*/:\n        return blob.read_shift(4) !== 0x0;\n      case 0x13 /*VT_UI4*/:\n        ret = blob.read_shift(4);\n        return ret;\n      case 0x1E /*VT_LPSTR*/:\n        return parse_lpstr(blob, t, 4).replace(chr0, '');\n      case 0x1F /*VT_LPWSTR*/:\n        return parse_lpwstr(blob);\n      case 0x40 /*VT_FILETIME*/:\n        return parse_FILETIME(blob);\n      case 0x41 /*VT_BLOB*/:\n        return parse_BLOB(blob);\n      case 0x47 /*VT_CF*/:\n        return parse_ClipboardData(blob);\n      case 0x50 /*VT_STRING*/:\n        return parse_VtString(blob, t, !opts.raw).replace(chr0, '');\n      case 0x51 /*VT_USTR*/:\n        return parse_VtUnalignedString(blob, t /*, 4*/).replace(chr0, '');\n      case 0x100C /*VT_VECTOR|VT_VARIANT*/:\n        return parse_VtVecHeadingPairValue(blob);\n      case 0x101E /*VT_VECTOR|VT_LPSTR*/:\n      case 0x101F /*VT_VECTOR|VT_LPWSTR*/:\n        return t == 0x101F ? parse_VtVecLpwstrValue(blob) : parse_VtVecUnalignedLpstrValue(blob);\n      default:\n        throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + t);\n    }\n  }\n  function write_TypedPropertyValue(type, value) {\n    var o = new_buf(4),\n      p = new_buf(4);\n    o.write_shift(4, type == 0x50 ? 0x1F : type);\n    switch (type) {\n      case 0x03 /*VT_I4*/:\n        p.write_shift(-4, value);\n        break;\n      case 0x05 /*VT_I4*/:\n        p = new_buf(8);\n        p.write_shift(8, value, 'f');\n        break;\n      case 0x0B /*VT_BOOL*/:\n        p.write_shift(4, value ? 0x01 : 0x00);\n        break;\n      case 0x40 /*VT_FILETIME*/:\n        p = write_FILETIME(value);\n        break;\n      case 0x1F /*VT_LPWSTR*/:\n      case 0x50 /*VT_STRING*/:\n        p = new_buf(4 + 2 * (value.length + 1) + (value.length % 2 ? 0 : 2));\n        p.write_shift(4, value.length + 1);\n        p.write_shift(0, value, \"dbcs\");\n        while (p.l != p.length) p.write_shift(1, 0);\n        break;\n      default:\n        throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + value);\n    }\n    return bconcat([o, p]);\n  }\n\n  /* [MS-OLEPS] 2.20 PropertySet */\n  function parse_PropertySet(blob, PIDSI) {\n    var start_addr = blob.l;\n    var size = blob.read_shift(4);\n    var NumProps = blob.read_shift(4);\n    var Props = [],\n      i = 0;\n    var CodePage = 0;\n    var Dictionary = -1,\n      DictObj = {};\n    for (i = 0; i != NumProps; ++i) {\n      var PropID = blob.read_shift(4);\n      var Offset = blob.read_shift(4);\n      Props[i] = [PropID, Offset + start_addr];\n    }\n    Props.sort(function (x, y) {\n      return x[1] - y[1];\n    });\n    var PropH = {};\n    for (i = 0; i != NumProps; ++i) {\n      if (blob.l !== Props[i][1]) {\n        var fail = true;\n        if (i > 0 && PIDSI) switch (PIDSI[Props[i - 1][0]].t) {\n          case 0x02 /*VT_I2*/:\n            if (blob.l + 2 === Props[i][1]) {\n              blob.l += 2;\n              fail = false;\n            }\n            break;\n          case 0x50 /*VT_STRING*/:\n            if (blob.l <= Props[i][1]) {\n              blob.l = Props[i][1];\n              fail = false;\n            }\n            break;\n          case 0x100C /*VT_VECTOR|VT_VARIANT*/:\n            if (blob.l <= Props[i][1]) {\n              blob.l = Props[i][1];\n              fail = false;\n            }\n            break;\n        }\n        if ((!PIDSI || i == 0) && blob.l <= Props[i][1]) {\n          fail = false;\n          blob.l = Props[i][1];\n        }\n        if (fail) throw new Error(\"Read Error: Expected address \" + Props[i][1] + ' at ' + blob.l + ' :' + i);\n      }\n      if (PIDSI) {\n        var piddsi = PIDSI[Props[i][0]];\n        PropH[piddsi.n] = parse_TypedPropertyValue(blob, piddsi.t, {\n          raw: true\n        });\n        if (piddsi.p === 'version') PropH[piddsi.n] = String(PropH[piddsi.n] >> 16) + \".\" + (\"0000\" + String(PropH[piddsi.n] & 0xFFFF)).slice(-4);\n        if (piddsi.n == \"CodePage\") switch (PropH[piddsi.n]) {\n          case 0:\n            PropH[piddsi.n] = 1252;\n          /* falls through */\n          case 874:\n          case 932:\n          case 936:\n          case 949:\n          case 950:\n          case 1250:\n          case 1251:\n          case 1253:\n          case 1254:\n          case 1255:\n          case 1256:\n          case 1257:\n          case 1258:\n          case 10000:\n          case 1200:\n          case 1201:\n          case 1252:\n          case 65000:\n          case -536:\n          case 65001:\n          case -535:\n            set_cp(CodePage = PropH[piddsi.n] >>> 0 & 0xFFFF);\n            break;\n          default:\n            throw new Error(\"Unsupported CodePage: \" + PropH[piddsi.n]);\n        }\n      } else {\n        if (Props[i][0] === 0x1) {\n          CodePage = PropH.CodePage = parse_TypedPropertyValue(blob, VT_I2);\n          set_cp(CodePage);\n          if (Dictionary !== -1) {\n            var oldpos = blob.l;\n            blob.l = Props[Dictionary][1];\n            DictObj = parse_dictionary(blob, CodePage);\n            blob.l = oldpos;\n          }\n        } else if (Props[i][0] === 0) {\n          if (CodePage === 0) {\n            Dictionary = i;\n            blob.l = Props[i + 1][1];\n            continue;\n          }\n          DictObj = parse_dictionary(blob, CodePage);\n        } else {\n          var name = DictObj[Props[i][0]];\n          var val;\n          /* [MS-OSHARED] 2.3.3.2.3.1.2 + PROPVARIANT */\n          switch (blob[blob.l]) {\n            case 0x41 /*VT_BLOB*/:\n              blob.l += 4;\n              val = parse_BLOB(blob);\n              break;\n            case 0x1E /*VT_LPSTR*/:\n              blob.l += 4;\n              val = parse_VtString(blob, blob[blob.l - 4]).replace(/\\u0000+$/, \"\");\n              break;\n            case 0x1F /*VT_LPWSTR*/:\n              blob.l += 4;\n              val = parse_VtString(blob, blob[blob.l - 4]).replace(/\\u0000+$/, \"\");\n              break;\n            case 0x03 /*VT_I4*/:\n              blob.l += 4;\n              val = blob.read_shift(4, 'i');\n              break;\n            case 0x13 /*VT_UI4*/:\n              blob.l += 4;\n              val = blob.read_shift(4);\n              break;\n            case 0x05 /*VT_R8*/:\n              blob.l += 4;\n              val = blob.read_shift(8, 'f');\n              break;\n            case 0x0B /*VT_BOOL*/:\n              blob.l += 4;\n              val = parsebool(blob, 4);\n              break;\n            case 0x40 /*VT_FILETIME*/:\n              blob.l += 4;\n              val = parseDate(parse_FILETIME(blob));\n              break;\n            default:\n              throw new Error(\"unparsed value: \" + blob[blob.l]);\n          }\n          PropH[name] = val;\n        }\n      }\n    }\n    blob.l = start_addr + size; /* step ahead to skip padding */\n    return PropH;\n  }\n  var XLSPSSkip = [\"CodePage\", \"Thumbnail\", \"_PID_LINKBASE\", \"_PID_HLINKS\", \"SystemIdentifier\", \"FMTID\"]; //.concat(PseudoPropsPairs);\n  function guess_property_type(val) {\n    switch (typeof val) {\n      case \"boolean\":\n        return 0x0B;\n      case \"number\":\n        return (val | 0) == val ? 0x03 : 0x05;\n      case \"string\":\n        return 0x1F;\n      case \"object\":\n        if (val instanceof Date) return 0x40;\n        break;\n    }\n    return -1;\n  }\n  function write_PropertySet(entries, RE, PIDSI) {\n    var hdr = new_buf(8),\n      piao = [],\n      prop = [];\n    var sz = 8,\n      i = 0;\n    var pr = new_buf(8),\n      pio = new_buf(8);\n    pr.write_shift(4, 0x0002);\n    pr.write_shift(4, 0x04B0);\n    pio.write_shift(4, 0x0001);\n    prop.push(pr);\n    piao.push(pio);\n    sz += 8 + pr.length;\n    if (!RE) {\n      pio = new_buf(8);\n      pio.write_shift(4, 0);\n      piao.unshift(pio);\n      var bufs = [new_buf(4)];\n      bufs[0].write_shift(4, entries.length);\n      for (i = 0; i < entries.length; ++i) {\n        var value = entries[i][0];\n        pr = new_buf(4 + 4 + 2 * (value.length + 1) + (value.length % 2 ? 0 : 2));\n        pr.write_shift(4, i + 2);\n        pr.write_shift(4, value.length + 1);\n        pr.write_shift(0, value, \"dbcs\");\n        while (pr.l != pr.length) pr.write_shift(1, 0);\n        bufs.push(pr);\n      }\n      pr = bconcat(bufs);\n      prop.unshift(pr);\n      sz += 8 + pr.length;\n    }\n    for (i = 0; i < entries.length; ++i) {\n      if (RE && !RE[entries[i][0]]) continue;\n      if (XLSPSSkip.indexOf(entries[i][0]) > -1 || PseudoPropsPairs.indexOf(entries[i][0]) > -1) continue;\n      if (entries[i][1] == null) continue;\n      var val = entries[i][1],\n        idx = 0;\n      if (RE) {\n        idx = +RE[entries[i][0]];\n        var pinfo = PIDSI[idx];\n        if (pinfo.p == \"version\" && typeof val == \"string\") {\n          var arr = val.split(\".\");\n          val = (+arr[0] << 16) + (+arr[1] || 0);\n        }\n        pr = write_TypedPropertyValue(pinfo.t, val);\n      } else {\n        var T = guess_property_type(val);\n        if (T == -1) {\n          T = 0x1F;\n          val = String(val);\n        }\n        pr = write_TypedPropertyValue(T, val);\n      }\n      prop.push(pr);\n      pio = new_buf(8);\n      pio.write_shift(4, !RE ? 2 + i : idx);\n      piao.push(pio);\n      sz += 8 + pr.length;\n    }\n    var w = 8 * (prop.length + 1);\n    for (i = 0; i < prop.length; ++i) {\n      piao[i].write_shift(4, w);\n      w += prop[i].length;\n    }\n    hdr.write_shift(4, sz);\n    hdr.write_shift(4, prop.length);\n    return bconcat([hdr].concat(piao).concat(prop));\n  }\n\n  /* [MS-OLEPS] 2.21 PropertySetStream */\n  function parse_PropertySetStream(file, PIDSI, clsid) {\n    var blob = file.content;\n    if (!blob) return {};\n    prep_blob(blob, 0);\n    var NumSets,\n      FMTID0,\n      FMTID1,\n      Offset0,\n      Offset1 = 0;\n    blob.chk('feff', 'Byte Order: ');\n\n    /*var vers = */\n    blob.read_shift(2); // TODO: check version\n    var SystemIdentifier = blob.read_shift(4);\n    var CLSID = blob.read_shift(16);\n    if (CLSID !== CFB.utils.consts.HEADER_CLSID && CLSID !== clsid) throw new Error(\"Bad PropertySet CLSID \" + CLSID);\n    NumSets = blob.read_shift(4);\n    if (NumSets !== 1 && NumSets !== 2) throw new Error(\"Unrecognized #Sets: \" + NumSets);\n    FMTID0 = blob.read_shift(16);\n    Offset0 = blob.read_shift(4);\n    if (NumSets === 1 && Offset0 !== blob.l) throw new Error(\"Length mismatch: \" + Offset0 + \" !== \" + blob.l);else if (NumSets === 2) {\n      FMTID1 = blob.read_shift(16);\n      Offset1 = blob.read_shift(4);\n    }\n    var PSet0 = parse_PropertySet(blob, PIDSI);\n    var rval = {\n      SystemIdentifier: SystemIdentifier\n    };\n    for (var y in PSet0) rval[y] = PSet0[y];\n    //rval.blob = blob;\n    rval.FMTID = FMTID0;\n    //rval.PSet0 = PSet0;\n    if (NumSets === 1) return rval;\n    if (Offset1 - blob.l == 2) blob.l += 2;\n    if (blob.l !== Offset1) throw new Error(\"Length mismatch 2: \" + blob.l + \" !== \" + Offset1);\n    var PSet1;\n    try {\n      PSet1 = parse_PropertySet(blob, null);\n    } catch (e) {/* empty */}\n    for (y in PSet1) rval[y] = PSet1[y];\n    rval.FMTID = [FMTID0, FMTID1]; // TODO: verify FMTID0/1\n    return rval;\n  }\n  function write_PropertySetStream(entries, clsid, RE, PIDSI, entries2, clsid2) {\n    var hdr = new_buf(entries2 ? 68 : 48);\n    var bufs = [hdr];\n    hdr.write_shift(2, 0xFFFE);\n    hdr.write_shift(2, 0x0000); /* TODO: type 1 props */\n    hdr.write_shift(4, 0x32363237);\n    hdr.write_shift(16, CFB.utils.consts.HEADER_CLSID, \"hex\");\n    hdr.write_shift(4, entries2 ? 2 : 1);\n    hdr.write_shift(16, clsid, \"hex\");\n    hdr.write_shift(4, entries2 ? 68 : 48);\n    var ps0 = write_PropertySet(entries, RE, PIDSI);\n    bufs.push(ps0);\n    if (entries2) {\n      var ps1 = write_PropertySet(entries2, null, null);\n      hdr.write_shift(16, clsid2, \"hex\");\n      hdr.write_shift(4, 68 + ps0.length);\n      bufs.push(ps1);\n    }\n    return bconcat(bufs);\n  }\n  function parsenoop2(blob, length) {\n    blob.read_shift(length);\n    return null;\n  }\n  function writezeroes(n, o) {\n    if (!o) o = new_buf(n);\n    for (var j = 0; j < n; ++j) o.write_shift(1, 0);\n    return o;\n  }\n  function parslurp(blob, length, cb) {\n    var arr = [],\n      target = blob.l + length;\n    while (blob.l < target) arr.push(cb(blob, target - blob.l));\n    if (target !== blob.l) throw new Error(\"Slurp error\");\n    return arr;\n  }\n  function parsebool(blob, length) {\n    return blob.read_shift(length) === 0x1;\n  }\n  function writebool(v, o) {\n    if (!o) o = new_buf(2);\n    o.write_shift(2, +!!v);\n    return o;\n  }\n  function parseuint16(blob) {\n    return blob.read_shift(2, 'u');\n  }\n  function writeuint16(v, o) {\n    if (!o) o = new_buf(2);\n    o.write_shift(2, v);\n    return o;\n  }\n  function parseuint16a(blob, length) {\n    return parslurp(blob, length, parseuint16);\n  }\n\n  /* --- 2.5 Structures --- */\n\n  /* [MS-XLS] 2.5.10 Bes (boolean or error) */\n  function parse_Bes(blob) {\n    var v = blob.read_shift(1),\n      t = blob.read_shift(1);\n    return t === 0x01 ? v : v === 0x01;\n  }\n  function write_Bes(v, t, o) {\n    if (!o) o = new_buf(2);\n    o.write_shift(1, t == 'e' ? +v : +!!v);\n    o.write_shift(1, t == 'e' ? 1 : 0);\n    return o;\n  }\n\n  /* [MS-XLS] 2.5.240 ShortXLUnicodeString */\n  function parse_ShortXLUnicodeString(blob, length, opts) {\n    var cch = blob.read_shift(opts && opts.biff >= 12 ? 2 : 1);\n    var encoding = 'sbcs-cont';\n    var cp = current_codepage;\n    if (opts && opts.biff >= 8) current_codepage = 1200;\n    if (!opts || opts.biff == 8) {\n      var fHighByte = blob.read_shift(1);\n      if (fHighByte) {\n        encoding = 'dbcs-cont';\n      }\n    } else if (opts.biff == 12) {\n      encoding = 'wstr';\n    }\n    if (opts.biff >= 2 && opts.biff <= 5) encoding = 'cpstr';\n    var o = cch ? blob.read_shift(cch, encoding) : \"\";\n    current_codepage = cp;\n    return o;\n  }\n\n  /* 2.5.293 XLUnicodeRichExtendedString */\n  function parse_XLUnicodeRichExtendedString(blob) {\n    var cp = current_codepage;\n    current_codepage = 1200;\n    var cch = blob.read_shift(2),\n      flags = blob.read_shift(1);\n    var /*fHighByte = flags & 0x1,*/fExtSt = flags & 0x4,\n      fRichSt = flags & 0x8;\n    var width = 1 + (flags & 0x1); // 0x0 -> utf8, 0x1 -> dbcs\n    var cRun = 0,\n      cbExtRst;\n    var z = {};\n    if (fRichSt) cRun = blob.read_shift(2);\n    if (fExtSt) cbExtRst = blob.read_shift(4);\n    var encoding = width == 2 ? 'dbcs-cont' : 'sbcs-cont';\n    var msg = cch === 0 ? \"\" : blob.read_shift(cch, encoding);\n    if (fRichSt) blob.l += 4 * cRun; //TODO: parse this\n    if (fExtSt) blob.l += cbExtRst; //TODO: parse this\n    z.t = msg;\n    if (!fRichSt) {\n      z.raw = \"<t>\" + z.t + \"</t>\";\n      z.r = z.t;\n    }\n    current_codepage = cp;\n    return z;\n  }\n  function write_XLUnicodeRichExtendedString(xlstr) {\n    var str = xlstr.t || \"\",\n      nfmts = 1;\n    var hdr = new_buf(3 + (nfmts > 1 ? 2 : 0));\n    hdr.write_shift(2, str.length);\n    hdr.write_shift(1, (nfmts > 1 ? 0x08 : 0x00) | 0x01);\n    if (nfmts > 1) hdr.write_shift(2, nfmts);\n    var otext = new_buf(2 * str.length);\n    otext.write_shift(2 * str.length, str, 'utf16le');\n    var out = [hdr, otext];\n    return bconcat(out);\n  }\n\n  /* 2.5.296 XLUnicodeStringNoCch */\n  function parse_XLUnicodeStringNoCch(blob, cch, opts) {\n    var retval;\n    if (opts) {\n      if (opts.biff >= 2 && opts.biff <= 5) return blob.read_shift(cch, 'cpstr');\n      if (opts.biff >= 12) return blob.read_shift(cch, 'dbcs-cont');\n    }\n    var fHighByte = blob.read_shift(1);\n    if (fHighByte === 0) {\n      retval = blob.read_shift(cch, 'sbcs-cont');\n    } else {\n      retval = blob.read_shift(cch, 'dbcs-cont');\n    }\n    return retval;\n  }\n\n  /* 2.5.294 XLUnicodeString */\n  function parse_XLUnicodeString(blob, length, opts) {\n    var cch = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n    if (cch === 0) {\n      blob.l++;\n      return \"\";\n    }\n    return parse_XLUnicodeStringNoCch(blob, cch, opts);\n  }\n  /* BIFF5 override */\n  function parse_XLUnicodeString2(blob, length, opts) {\n    if (opts.biff > 5) return parse_XLUnicodeString(blob, length, opts);\n    var cch = blob.read_shift(1);\n    if (cch === 0) {\n      blob.l++;\n      return \"\";\n    }\n    return blob.read_shift(cch, opts.biff <= 4 || !blob.lens ? 'cpstr' : 'sbcs-cont');\n  }\n  /* TODO: BIFF5 and lower, codepage awareness */\n  function write_XLUnicodeString(str, opts, o) {\n    if (!o) o = new_buf(3 + 2 * str.length);\n    o.write_shift(2, str.length);\n    o.write_shift(1, 1);\n    o.write_shift(31, str, 'utf16le');\n    return o;\n  }\n\n  /* [MS-XLS] 2.5.61 ControlInfo */\n  function parse_ControlInfo(blob) {\n    var flags = blob.read_shift(1);\n    blob.l++;\n    var accel = blob.read_shift(2);\n    blob.l += 2;\n    return [flags, accel];\n  }\n\n  /* [MS-OSHARED] 2.3.7.6 URLMoniker TODO: flags */\n  function parse_URLMoniker(blob) {\n    var len = blob.read_shift(4),\n      start = blob.l;\n    var extra = false;\n    if (len > 24) {\n      /* look ahead */\n      blob.l += len - 24;\n      if (blob.read_shift(16) === \"795881f43b1d7f48af2c825dc4852763\") extra = true;\n      blob.l = start;\n    }\n    var url = blob.read_shift((extra ? len - 24 : len) >> 1, 'utf16le').replace(chr0, \"\");\n    if (extra) blob.l += 24;\n    return url;\n  }\n\n  /* [MS-OSHARED] 2.3.7.8 FileMoniker TODO: all fields */\n  function parse_FileMoniker(blob) {\n    var cAnti = blob.read_shift(2);\n    var preamble = \"\";\n    while (cAnti-- > 0) preamble += \"../\";\n    var ansiPath = blob.read_shift(0, 'lpstr-ansi');\n    blob.l += 2; //var endServer = blob.read_shift(2);\n    if (blob.read_shift(2) != 0xDEAD) throw new Error(\"Bad FileMoniker\");\n    var sz = blob.read_shift(4);\n    if (sz === 0) return preamble + ansiPath.replace(/\\\\/g, \"/\");\n    var bytes = blob.read_shift(4);\n    if (blob.read_shift(2) != 3) throw new Error(\"Bad FileMoniker\");\n    var unicodePath = blob.read_shift(bytes >> 1, 'utf16le').replace(chr0, \"\");\n    return preamble + unicodePath;\n  }\n\n  /* [MS-OSHARED] 2.3.7.2 HyperlinkMoniker TODO: all the monikers */\n  function parse_HyperlinkMoniker(blob, length) {\n    var clsid = blob.read_shift(16);\n    length -= 16;\n    switch (clsid) {\n      case \"e0c9ea79f9bace118c8200aa004ba90b\":\n        return parse_URLMoniker(blob, length);\n      case \"0303000000000000c000000000000046\":\n        return parse_FileMoniker(blob, length);\n      default:\n        throw new Error(\"Unsupported Moniker \" + clsid);\n    }\n  }\n\n  /* [MS-OSHARED] 2.3.7.9 HyperlinkString */\n  function parse_HyperlinkString(blob) {\n    var len = blob.read_shift(4);\n    var o = len > 0 ? blob.read_shift(len, 'utf16le').replace(chr0, \"\") : \"\";\n    return o;\n  }\n  function write_HyperlinkString(str, o) {\n    if (!o) o = new_buf(6 + str.length * 2);\n    o.write_shift(4, 1 + str.length);\n    for (var i = 0; i < str.length; ++i) o.write_shift(2, str.charCodeAt(i));\n    o.write_shift(2, 0);\n    return o;\n  }\n\n  /* [MS-OSHARED] 2.3.7.1 Hyperlink Object */\n  function parse_Hyperlink(blob, length) {\n    var end = blob.l + length;\n    var sVer = blob.read_shift(4);\n    if (sVer !== 2) throw new Error(\"Unrecognized streamVersion: \" + sVer);\n    var flags = blob.read_shift(2);\n    blob.l += 2;\n    var displayName,\n      targetFrameName,\n      moniker,\n      oleMoniker,\n      Loc = \"\",\n      guid,\n      fileTime;\n    if (flags & 0x0010) displayName = parse_HyperlinkString(blob, end - blob.l);\n    if (flags & 0x0080) targetFrameName = parse_HyperlinkString(blob, end - blob.l);\n    if ((flags & 0x0101) === 0x0101) moniker = parse_HyperlinkString(blob, end - blob.l);\n    if ((flags & 0x0101) === 0x0001) oleMoniker = parse_HyperlinkMoniker(blob, end - blob.l);\n    if (flags & 0x0008) Loc = parse_HyperlinkString(blob, end - blob.l);\n    if (flags & 0x0020) guid = blob.read_shift(16);\n    if (flags & 0x0040) fileTime = parse_FILETIME(blob /*, 8*/);\n    blob.l = end;\n    var target = targetFrameName || moniker || oleMoniker || \"\";\n    if (target && Loc) target += \"#\" + Loc;\n    if (!target) target = \"#\" + Loc;\n    if (flags & 0x0002 && target.charAt(0) == \"/\" && target.charAt(1) != \"/\") target = \"file://\" + target;\n    var out = {\n      Target: target\n    };\n    if (guid) out.guid = guid;\n    if (fileTime) out.time = fileTime;\n    if (displayName) out.Tooltip = displayName;\n    return out;\n  }\n  function write_Hyperlink(hl) {\n    var out = new_buf(512),\n      i = 0;\n    var Target = hl.Target;\n    if (Target.slice(0, 7) == \"file://\") Target = Target.slice(7);\n    var hashidx = Target.indexOf(\"#\");\n    var F = hashidx > -1 ? 0x1f : 0x17;\n    switch (Target.charAt(0)) {\n      case \"#\":\n        F = 0x1c;\n        break;\n      case \".\":\n        F &= ~2;\n        break;\n    }\n    out.write_shift(4, 2);\n    out.write_shift(4, F);\n    var data = [8, 6815827, 6619237, 4849780, 83];\n    for (i = 0; i < data.length; ++i) out.write_shift(4, data[i]);\n    if (F == 0x1C) {\n      Target = Target.slice(1);\n      write_HyperlinkString(Target, out);\n    } else if (F & 0x02) {\n      data = \"e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b\".split(\" \");\n      for (i = 0; i < data.length; ++i) out.write_shift(1, parseInt(data[i], 16));\n      var Pretarget = hashidx > -1 ? Target.slice(0, hashidx) : Target;\n      out.write_shift(4, 2 * (Pretarget.length + 1));\n      for (i = 0; i < Pretarget.length; ++i) out.write_shift(2, Pretarget.charCodeAt(i));\n      out.write_shift(2, 0);\n      if (F & 0x08) write_HyperlinkString(hashidx > -1 ? Target.slice(hashidx + 1) : \"\", out);\n    } else {\n      data = \"03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46\".split(\" \");\n      for (i = 0; i < data.length; ++i) out.write_shift(1, parseInt(data[i], 16));\n      var P = 0;\n      while (Target.slice(P * 3, P * 3 + 3) == \"../\" || Target.slice(P * 3, P * 3 + 3) == \"..\\\\\") ++P;\n      out.write_shift(2, P);\n      out.write_shift(4, Target.length - 3 * P + 1);\n      for (i = 0; i < Target.length - 3 * P; ++i) out.write_shift(1, Target.charCodeAt(i + 3 * P) & 0xFF);\n      out.write_shift(1, 0);\n      out.write_shift(2, 0xFFFF);\n      out.write_shift(2, 0xDEAD);\n      for (i = 0; i < 6; ++i) out.write_shift(4, 0);\n    }\n    return out.slice(0, out.l);\n  }\n\n  /* 2.5.178 LongRGBA */\n  function parse_LongRGBA(blob) {\n    var r = blob.read_shift(1),\n      g = blob.read_shift(1),\n      b = blob.read_shift(1),\n      a = blob.read_shift(1);\n    return [r, g, b, a];\n  }\n\n  /* 2.5.177 LongRGB */\n  function parse_LongRGB(blob, length) {\n    var x = parse_LongRGBA(blob, length);\n    x[3] = 0;\n    return x;\n  }\n\n  /* [MS-XLS] 2.5.19 */\n  function parse_XLSCell(blob) {\n    var rw = blob.read_shift(2); // 0-indexed\n    var col = blob.read_shift(2);\n    var ixfe = blob.read_shift(2);\n    return {\n      r: rw,\n      c: col,\n      ixfe: ixfe\n    };\n  }\n  function write_XLSCell(R, C, ixfe, o) {\n    if (!o) o = new_buf(6);\n    o.write_shift(2, R);\n    o.write_shift(2, C);\n    o.write_shift(2, ixfe || 0);\n    return o;\n  }\n\n  /* [MS-XLS] 2.5.134 */\n  function parse_frtHeader(blob) {\n    var rt = blob.read_shift(2);\n    var flags = blob.read_shift(2); // TODO: parse these flags\n    blob.l += 8;\n    return {\n      type: rt,\n      flags: flags\n    };\n  }\n  function parse_OptXLUnicodeString(blob, length, opts) {\n    return length === 0 ? \"\" : parse_XLUnicodeString2(blob, length, opts);\n  }\n\n  /* [MS-XLS] 2.5.344 */\n  function parse_XTI(blob, length, opts) {\n    var w = opts.biff > 8 ? 4 : 2;\n    var iSupBook = blob.read_shift(w),\n      itabFirst = blob.read_shift(w, 'i'),\n      itabLast = blob.read_shift(w, 'i');\n    return [iSupBook, itabFirst, itabLast];\n  }\n\n  /* [MS-XLS] 2.5.218 */\n  function parse_RkRec(blob) {\n    var ixfe = blob.read_shift(2);\n    var RK = parse_RkNumber(blob);\n    return [ixfe, RK];\n  }\n\n  /* [MS-XLS] 2.5.1 */\n  function parse_AddinUdf(blob, length, opts) {\n    blob.l += 4;\n    length -= 4;\n    var l = blob.l + length;\n    var udfName = parse_ShortXLUnicodeString(blob, length, opts);\n    var cb = blob.read_shift(2);\n    l -= blob.l;\n    if (cb !== l) throw new Error(\"Malformed AddinUdf: padding = \" + l + \" != \" + cb);\n    blob.l += cb;\n    return udfName;\n  }\n\n  /* [MS-XLS] 2.5.209 TODO: Check sizes */\n  function parse_Ref8U(blob) {\n    var rwFirst = blob.read_shift(2);\n    var rwLast = blob.read_shift(2);\n    var colFirst = blob.read_shift(2);\n    var colLast = blob.read_shift(2);\n    return {\n      s: {\n        c: colFirst,\n        r: rwFirst\n      },\n      e: {\n        c: colLast,\n        r: rwLast\n      }\n    };\n  }\n  function write_Ref8U(r, o) {\n    if (!o) o = new_buf(8);\n    o.write_shift(2, r.s.r);\n    o.write_shift(2, r.e.r);\n    o.write_shift(2, r.s.c);\n    o.write_shift(2, r.e.c);\n    return o;\n  }\n\n  /* [MS-XLS] 2.5.211 */\n  function parse_RefU(blob) {\n    var rwFirst = blob.read_shift(2);\n    var rwLast = blob.read_shift(2);\n    var colFirst = blob.read_shift(1);\n    var colLast = blob.read_shift(1);\n    return {\n      s: {\n        c: colFirst,\n        r: rwFirst\n      },\n      e: {\n        c: colLast,\n        r: rwLast\n      }\n    };\n  }\n\n  /* [MS-XLS] 2.5.207 */\n  var parse_Ref = parse_RefU;\n\n  /* [MS-XLS] 2.5.143 */\n  function parse_FtCmo(blob) {\n    blob.l += 4;\n    var ot = blob.read_shift(2);\n    var id = blob.read_shift(2);\n    var flags = blob.read_shift(2);\n    blob.l += 12;\n    return [id, ot, flags];\n  }\n\n  /* [MS-XLS] 2.5.149 */\n  function parse_FtNts(blob) {\n    var out = {};\n    blob.l += 4;\n    blob.l += 16; // GUID TODO\n    out.fSharedNote = blob.read_shift(2);\n    blob.l += 4;\n    return out;\n  }\n\n  /* [MS-XLS] 2.5.142 */\n  function parse_FtCf(blob) {\n    var out = {};\n    blob.l += 4;\n    blob.cf = blob.read_shift(2);\n    return out;\n  }\n\n  /* [MS-XLS] 2.5.140 - 2.5.154 and friends */\n  function parse_FtSkip(blob) {\n    blob.l += 2;\n    blob.l += blob.read_shift(2);\n  }\n  var FtTab = {\n    0x00: parse_FtSkip,\n    /* FtEnd */\n    0x04: parse_FtSkip,\n    /* FtMacro */\n    0x05: parse_FtSkip,\n    /* FtButton */\n    0x06: parse_FtSkip,\n    /* FtGmo */\n    0x07: parse_FtCf,\n    /* FtCf */\n    0x08: parse_FtSkip,\n    /* FtPioGrbit */\n    0x09: parse_FtSkip,\n    /* FtPictFmla */\n    0x0A: parse_FtSkip,\n    /* FtCbls */\n    0x0B: parse_FtSkip,\n    /* FtRbo */\n    0x0C: parse_FtSkip,\n    /* FtSbs */\n    0x0D: parse_FtNts,\n    /* FtNts */\n    0x0E: parse_FtSkip,\n    /* FtSbsFmla */\n    0x0F: parse_FtSkip,\n    /* FtGboData */\n    0x10: parse_FtSkip,\n    /* FtEdoData */\n    0x11: parse_FtSkip,\n    /* FtRboData */\n    0x12: parse_FtSkip,\n    /* FtCblsData */\n    0x13: parse_FtSkip,\n    /* FtLbsData */\n    0x14: parse_FtSkip,\n    /* FtCblsFmla */\n    0x15: parse_FtCmo\n  };\n  function parse_FtArray(blob, length) {\n    var tgt = blob.l + length;\n    var fts = [];\n    while (blob.l < tgt) {\n      var ft = blob.read_shift(2);\n      blob.l -= 2;\n      try {\n        fts.push(FtTab[ft](blob, tgt - blob.l));\n      } catch (e) {\n        blob.l = tgt;\n        return fts;\n      }\n    }\n    if (blob.l != tgt) blob.l = tgt; //throw new Error(\"bad Object Ft-sequence\");\n    return fts;\n  }\n\n  /* --- 2.4 Records --- */\n\n  /* [MS-XLS] 2.4.21 */\n  function parse_BOF(blob, length) {\n    var o = {\n      BIFFVer: 0,\n      dt: 0\n    };\n    o.BIFFVer = blob.read_shift(2);\n    length -= 2;\n    if (length >= 2) {\n      o.dt = blob.read_shift(2);\n      blob.l -= 2;\n    }\n    switch (o.BIFFVer) {\n      case 0x0600: /* BIFF8 */\n      case 0x0500: /* BIFF5 */\n      case 0x0400: /* BIFF4 */\n      case 0x0300: /* BIFF3 */\n      case 0x0200: /* BIFF2 */\n      case 0x0002:\n      case 0x0007:\n        /* BIFF2 */\n        break;\n      default:\n        if (length > 6) throw new Error(\"Unexpected BIFF Ver \" + o.BIFFVer);\n    }\n    blob.read_shift(length);\n    return o;\n  }\n  function write_BOF(wb, t, o) {\n    var h = 0x0600,\n      w = 16;\n    switch (o.bookType) {\n      case 'biff8':\n        break;\n      case 'biff5':\n        h = 0x0500;\n        w = 8;\n        break;\n      case 'biff4':\n        h = 0x0004;\n        w = 6;\n        break;\n      case 'biff3':\n        h = 0x0003;\n        w = 6;\n        break;\n      case 'biff2':\n        h = 0x0002;\n        w = 4;\n        break;\n      case 'xla':\n        break;\n      default:\n        throw new Error(\"unsupported BIFF version\");\n    }\n    var out = new_buf(w);\n    out.write_shift(2, h);\n    out.write_shift(2, t);\n    if (w > 4) out.write_shift(2, 0x7262);\n    if (w > 6) out.write_shift(2, 0x07CD);\n    if (w > 8) {\n      out.write_shift(2, 0xC009);\n      out.write_shift(2, 0x0001);\n      out.write_shift(2, 0x0706);\n      out.write_shift(2, 0x0000);\n    }\n    return out;\n  }\n\n  /* [MS-XLS] 2.4.146 */\n  function parse_InterfaceHdr(blob, length) {\n    if (length === 0) return 0x04b0;\n    if (blob.read_shift(2) !== 0x04b0) {/* empty */}\n    return 0x04b0;\n  }\n\n  /* [MS-XLS] 2.4.349 */\n  function parse_WriteAccess(blob, length, opts) {\n    if (opts.enc) {\n      blob.l += length;\n      return \"\";\n    }\n    var l = blob.l;\n    // TODO: make sure XLUnicodeString doesnt overrun\n    var UserName = parse_XLUnicodeString2(blob, 0, opts);\n    blob.read_shift(length + l - blob.l);\n    return UserName;\n  }\n  function write_WriteAccess(s, opts) {\n    var b8 = !opts || opts.biff == 8;\n    var o = new_buf(b8 ? 112 : 54);\n    o.write_shift(opts.biff == 8 ? 2 : 1, 7);\n    if (b8) o.write_shift(1, 0);\n    o.write_shift(4, 0x33336853);\n    o.write_shift(4, 0x00534A74 | (b8 ? 0 : 0x20000000));\n    while (o.l < o.length) o.write_shift(1, b8 ? 0 : 32);\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.351 */\n  function parse_WsBool(blob, length, opts) {\n    var flags = opts && opts.biff == 8 || length == 2 ? blob.read_shift(2) : (blob.l += length, 0);\n    return {\n      fDialog: flags & 0x10,\n      fBelow: flags & 0x40,\n      fRight: flags & 0x80\n    };\n  }\n\n  /* [MS-XLS] 2.4.28 */\n  function parse_BoundSheet8(blob, length, opts) {\n    var pos = blob.read_shift(4);\n    var hidden = blob.read_shift(1) & 0x03;\n    var dt = blob.read_shift(1);\n    switch (dt) {\n      case 0:\n        dt = 'Worksheet';\n        break;\n      case 1:\n        dt = 'Macrosheet';\n        break;\n      case 2:\n        dt = 'Chartsheet';\n        break;\n      case 6:\n        dt = 'VBAModule';\n        break;\n    }\n    var name = parse_ShortXLUnicodeString(blob, 0, opts);\n    if (name.length === 0) name = \"Sheet1\";\n    return {\n      pos: pos,\n      hs: hidden,\n      dt: dt,\n      name: name\n    };\n  }\n  function write_BoundSheet8(data, opts) {\n    var w = !opts || opts.biff >= 8 ? 2 : 1;\n    var o = new_buf(8 + w * data.name.length);\n    o.write_shift(4, data.pos);\n    o.write_shift(1, data.hs || 0);\n    o.write_shift(1, data.dt);\n    o.write_shift(1, data.name.length);\n    if (opts.biff >= 8) o.write_shift(1, 1);\n    o.write_shift(w * data.name.length, data.name, opts.biff < 8 ? 'sbcs' : 'utf16le');\n    var out = o.slice(0, o.l);\n    out.l = o.l;\n    return out;\n  }\n\n  /* [MS-XLS] 2.4.265 TODO */\n  function parse_SST(blob, length) {\n    var end = blob.l + length;\n    var cnt = blob.read_shift(4);\n    var ucnt = blob.read_shift(4);\n    var strs = [];\n    for (var i = 0; i != ucnt && blob.l < end; ++i) {\n      strs.push(parse_XLUnicodeRichExtendedString(blob));\n    }\n    strs.Count = cnt;\n    strs.Unique = ucnt;\n    return strs;\n  }\n  function write_SST(sst, opts) {\n    var header = new_buf(8);\n    header.write_shift(4, sst.Count);\n    header.write_shift(4, sst.Unique);\n    var strs = [];\n    for (var j = 0; j < sst.length; ++j) strs[j] = write_XLUnicodeRichExtendedString(sst[j], opts);\n    var o = bconcat([header].concat(strs));\n    o.parts = [header.length].concat(strs.map(function (str) {\n      return str.length;\n    }));\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.107 */\n  function parse_ExtSST(blob, length) {\n    var extsst = {};\n    extsst.dsst = blob.read_shift(2);\n    blob.l += length - 2;\n    return extsst;\n  }\n\n  /* [MS-XLS] 2.4.221 TODO: check BIFF2-4 */\n  function parse_Row(blob) {\n    var z = {};\n    z.r = blob.read_shift(2);\n    z.c = blob.read_shift(2);\n    z.cnt = blob.read_shift(2) - z.c;\n    var miyRw = blob.read_shift(2);\n    blob.l += 4; // reserved(2), unused(2)\n    var flags = blob.read_shift(1); // various flags\n    blob.l += 3; // reserved(8), ixfe(12), flags(4)\n    if (flags & 0x07) z.level = flags & 0x07;\n    // collapsed: flags & 0x10\n    if (flags & 0x20) z.hidden = true;\n    if (flags & 0x40) z.hpt = miyRw / 20;\n    return z;\n  }\n\n  /* [MS-XLS] 2.4.125 */\n  function parse_ForceFullCalculation(blob) {\n    var header = parse_frtHeader(blob);\n    if (header.type != 0x08A3) throw new Error(\"Invalid Future Record \" + header.type);\n    var fullcalc = blob.read_shift(4);\n    return fullcalc !== 0x0;\n  }\n\n  /* [MS-XLS] 2.4.215 rt */\n  function parse_RecalcId(blob) {\n    blob.read_shift(2);\n    return blob.read_shift(4);\n  }\n\n  /* [MS-XLS] 2.4.87 */\n  function parse_DefaultRowHeight(blob, length, opts) {\n    var f = 0;\n    if (!(opts && opts.biff == 2)) {\n      f = blob.read_shift(2);\n    }\n    var miyRw = blob.read_shift(2);\n    if (opts && opts.biff == 2) {\n      f = 1 - (miyRw >> 15);\n      miyRw &= 0x7fff;\n    }\n    var fl = {\n      Unsynced: f & 1,\n      DyZero: (f & 2) >> 1,\n      ExAsc: (f & 4) >> 2,\n      ExDsc: (f & 8) >> 3\n    };\n    return [fl, miyRw];\n  }\n\n  /* [MS-XLS] 2.4.345 TODO */\n  function parse_Window1(blob) {\n    var xWn = blob.read_shift(2),\n      yWn = blob.read_shift(2),\n      dxWn = blob.read_shift(2),\n      dyWn = blob.read_shift(2);\n    var flags = blob.read_shift(2),\n      iTabCur = blob.read_shift(2),\n      iTabFirst = blob.read_shift(2);\n    var ctabSel = blob.read_shift(2),\n      wTabRatio = blob.read_shift(2);\n    return {\n      Pos: [xWn, yWn],\n      Dim: [dxWn, dyWn],\n      Flags: flags,\n      CurTab: iTabCur,\n      FirstTab: iTabFirst,\n      Selected: ctabSel,\n      TabRatio: wTabRatio\n    };\n  }\n  function write_Window1() {\n    var o = new_buf(18);\n    o.write_shift(2, 0);\n    o.write_shift(2, 0);\n    o.write_shift(2, 0x7260);\n    o.write_shift(2, 0x44c0);\n    o.write_shift(2, 0x38);\n    o.write_shift(2, 0);\n    o.write_shift(2, 0);\n    o.write_shift(2, 1);\n    o.write_shift(2, 0x01f4);\n    return o;\n  }\n  /* [MS-XLS] 2.4.346 TODO */\n  function parse_Window2(blob, length, opts) {\n    if (opts && opts.biff >= 2 && opts.biff < 5) return {};\n    var f = blob.read_shift(2);\n    return {\n      RTL: f & 0x40\n    };\n  }\n  function write_Window2(view) {\n    var o = new_buf(18),\n      f = 0x6b6;\n    if (view && view.RTL) f |= 0x40;\n    o.write_shift(2, f);\n    o.write_shift(4, 0);\n    o.write_shift(4, 64);\n    o.write_shift(4, 0);\n    o.write_shift(4, 0);\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.189 TODO */\n  function parse_Pane( /*blob, length, opts*/\n  ) {}\n\n  /* [MS-XLS] 2.4.122 TODO */\n  function parse_Font(blob, length, opts) {\n    var o = {\n      dyHeight: blob.read_shift(2),\n      fl: blob.read_shift(2)\n    };\n    switch (opts && opts.biff || 8) {\n      case 2:\n        break;\n      case 3:\n      case 4:\n        blob.l += 2;\n        break;\n      default:\n        blob.l += 10;\n        break;\n    }\n    o.name = parse_ShortXLUnicodeString(blob, 0, opts);\n    return o;\n  }\n  function write_Font(data, opts) {\n    var name = data.name || \"Arial\";\n    var b5 = opts && opts.biff == 5,\n      w = b5 ? 15 + name.length : 16 + 2 * name.length;\n    var o = new_buf(w);\n    o.write_shift(2, (data.sz || 12) * 20);\n    o.write_shift(4, 0);\n    o.write_shift(2, 400);\n    o.write_shift(4, 0);\n    o.write_shift(2, 0);\n    o.write_shift(1, name.length);\n    if (!b5) o.write_shift(1, 1);\n    o.write_shift((b5 ? 1 : 2) * name.length, name, b5 ? \"sbcs\" : \"utf16le\");\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.149 */\n  function parse_LabelSst(blob) {\n    var cell = parse_XLSCell(blob);\n    cell.isst = blob.read_shift(4);\n    return cell;\n  }\n  function write_LabelSst(R, C, v, os) {\n    var o = new_buf(10);\n    write_XLSCell(R, C, os, o);\n    o.write_shift(4, v);\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.148 */\n  function parse_Label(blob, length, opts) {\n    if (opts.biffguess && opts.biff == 2) opts.biff = 5;\n    var target = blob.l + length;\n    var cell = parse_XLSCell(blob, 6);\n    if (opts.biff == 2) blob.l++;\n    var str = parse_XLUnicodeString(blob, target - blob.l, opts);\n    cell.val = str;\n    return cell;\n  }\n  function write_Label(R, C, v, os, opts) {\n    var b8 = !opts || opts.biff == 8;\n    var o = new_buf(6 + 2 + +b8 + (1 + b8) * v.length);\n    write_XLSCell(R, C, os, o);\n    o.write_shift(2, v.length);\n    if (b8) o.write_shift(1, 1);\n    o.write_shift((1 + b8) * v.length, v, b8 ? 'utf16le' : 'sbcs');\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.126 Number Formats */\n  function parse_Format(blob, length, opts) {\n    var numFmtId = blob.read_shift(2);\n    var fmtstr = parse_XLUnicodeString2(blob, 0, opts);\n    return [numFmtId, fmtstr];\n  }\n  function write_Format(i, f, opts, o) {\n    var b5 = opts && opts.biff == 5;\n    if (!o) o = new_buf(b5 ? 3 + f.length : 5 + 2 * f.length);\n    o.write_shift(2, i);\n    o.write_shift(b5 ? 1 : 2, f.length);\n    if (!b5) o.write_shift(1, 1);\n    o.write_shift((b5 ? 1 : 2) * f.length, f, b5 ? 'sbcs' : 'utf16le');\n    var out = o.length > o.l ? o.slice(0, o.l) : o;\n    if (out.l == null) out.l = out.length;\n    return out;\n  }\n  var parse_BIFF2Format = parse_XLUnicodeString2;\n\n  /* [MS-XLS] 2.4.90 */\n  function parse_Dimensions(blob, length, opts) {\n    var end = blob.l + length;\n    var w = opts.biff == 8 || !opts.biff ? 4 : 2;\n    var r = blob.read_shift(w),\n      R = blob.read_shift(w);\n    var c = blob.read_shift(2),\n      C = blob.read_shift(2);\n    blob.l = end;\n    return {\n      s: {\n        r: r,\n        c: c\n      },\n      e: {\n        r: R,\n        c: C\n      }\n    };\n  }\n  function write_Dimensions(range, opts) {\n    var w = opts.biff == 8 || !opts.biff ? 4 : 2;\n    var o = new_buf(2 * w + 6);\n    o.write_shift(w, range.s.r);\n    o.write_shift(w, range.e.r + 1);\n    o.write_shift(2, range.s.c);\n    o.write_shift(2, range.e.c + 1);\n    o.write_shift(2, 0);\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.220 */\n  function parse_RK(blob) {\n    var rw = blob.read_shift(2),\n      col = blob.read_shift(2);\n    var rkrec = parse_RkRec(blob);\n    return {\n      r: rw,\n      c: col,\n      ixfe: rkrec[0],\n      rknum: rkrec[1]\n    };\n  }\n\n  /* [MS-XLS] 2.4.175 */\n  function parse_MulRk(blob, length) {\n    var target = blob.l + length - 2;\n    var rw = blob.read_shift(2),\n      col = blob.read_shift(2);\n    var rkrecs = [];\n    while (blob.l < target) rkrecs.push(parse_RkRec(blob));\n    if (blob.l !== target) throw new Error(\"MulRK read error\");\n    var lastcol = blob.read_shift(2);\n    if (rkrecs.length != lastcol - col + 1) throw new Error(\"MulRK length mismatch\");\n    return {\n      r: rw,\n      c: col,\n      C: lastcol,\n      rkrec: rkrecs\n    };\n  }\n  /* [MS-XLS] 2.4.174 */\n  function parse_MulBlank(blob, length) {\n    var target = blob.l + length - 2;\n    var rw = blob.read_shift(2),\n      col = blob.read_shift(2);\n    var ixfes = [];\n    while (blob.l < target) ixfes.push(blob.read_shift(2));\n    if (blob.l !== target) throw new Error(\"MulBlank read error\");\n    var lastcol = blob.read_shift(2);\n    if (ixfes.length != lastcol - col + 1) throw new Error(\"MulBlank length mismatch\");\n    return {\n      r: rw,\n      c: col,\n      C: lastcol,\n      ixfe: ixfes\n    };\n  }\n\n  /* [MS-XLS] 2.5.20 2.5.249 TODO: interpret values here */\n  function parse_CellStyleXF(blob, length, style, opts) {\n    var o = {};\n    var a = blob.read_shift(4),\n      b = blob.read_shift(4);\n    var c = blob.read_shift(4),\n      d = blob.read_shift(2);\n    o.patternType = XLSFillPattern[c >> 26];\n    if (!opts.cellStyles) return o;\n    o.alc = a & 0x07;\n    o.fWrap = a >> 3 & 0x01;\n    o.alcV = a >> 4 & 0x07;\n    o.fJustLast = a >> 7 & 0x01;\n    o.trot = a >> 8 & 0xFF;\n    o.cIndent = a >> 16 & 0x0F;\n    o.fShrinkToFit = a >> 20 & 0x01;\n    o.iReadOrder = a >> 22 & 0x02;\n    o.fAtrNum = a >> 26 & 0x01;\n    o.fAtrFnt = a >> 27 & 0x01;\n    o.fAtrAlc = a >> 28 & 0x01;\n    o.fAtrBdr = a >> 29 & 0x01;\n    o.fAtrPat = a >> 30 & 0x01;\n    o.fAtrProt = a >> 31 & 0x01;\n    o.dgLeft = b & 0x0F;\n    o.dgRight = b >> 4 & 0x0F;\n    o.dgTop = b >> 8 & 0x0F;\n    o.dgBottom = b >> 12 & 0x0F;\n    o.icvLeft = b >> 16 & 0x7F;\n    o.icvRight = b >> 23 & 0x7F;\n    o.grbitDiag = b >> 30 & 0x03;\n    o.icvTop = c & 0x7F;\n    o.icvBottom = c >> 7 & 0x7F;\n    o.icvDiag = c >> 14 & 0x7F;\n    o.dgDiag = c >> 21 & 0x0F;\n    o.icvFore = d & 0x7F;\n    o.icvBack = d >> 7 & 0x7F;\n    o.fsxButton = d >> 14 & 0x01;\n    return o;\n  }\n  //function parse_CellXF(blob, length, opts) {return parse_CellStyleXF(blob,length,0, opts);}\n  //function parse_StyleXF(blob, length, opts) {return parse_CellStyleXF(blob,length,1, opts);}\n\n  /* [MS-XLS] 2.4.353 TODO: actually do this right */\n  function parse_XF(blob, length, opts) {\n    var o = {};\n    o.ifnt = blob.read_shift(2);\n    o.numFmtId = blob.read_shift(2);\n    o.flags = blob.read_shift(2);\n    o.fStyle = o.flags >> 2 & 0x01;\n    length -= 6;\n    o.data = parse_CellStyleXF(blob, length, o.fStyle, opts);\n    return o;\n  }\n  function write_XF(data, ixfeP, opts, o) {\n    var b5 = opts && opts.biff == 5;\n    if (!o) o = new_buf(b5 ? 16 : 20);\n    o.write_shift(2, 0);\n    if (data.style) {\n      o.write_shift(2, data.numFmtId || 0);\n      o.write_shift(2, 0xFFF4);\n    } else {\n      o.write_shift(2, data.numFmtId || 0);\n      o.write_shift(2, ixfeP << 4);\n    }\n    var f = 0;\n    if (data.numFmtId > 0 && b5) f |= 0x0400;\n    o.write_shift(4, f);\n    o.write_shift(4, 0);\n    if (!b5) o.write_shift(4, 0);\n    o.write_shift(2, 0);\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.134 */\n  function parse_Guts(blob) {\n    blob.l += 4;\n    var out = [blob.read_shift(2), blob.read_shift(2)];\n    if (out[0] !== 0) out[0]--;\n    if (out[1] !== 0) out[1]--;\n    if (out[0] > 7 || out[1] > 7) throw new Error(\"Bad Gutters: \" + out.join(\"|\"));\n    return out;\n  }\n  function write_Guts(guts) {\n    var o = new_buf(8);\n    o.write_shift(4, 0);\n    o.write_shift(2, guts[0] ? guts[0] + 1 : 0);\n    o.write_shift(2, guts[1] ? guts[1] + 1 : 0);\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.24 */\n  function parse_BoolErr(blob, length, opts) {\n    var cell = parse_XLSCell(blob, 6);\n    if (opts.biff == 2 || length == 9) ++blob.l;\n    var val = parse_Bes(blob, 2);\n    cell.val = val;\n    cell.t = val === true || val === false ? 'b' : 'e';\n    return cell;\n  }\n  function write_BoolErr(R, C, v, os, opts, t) {\n    var o = new_buf(8);\n    write_XLSCell(R, C, os, o);\n    write_Bes(v, t, o);\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.180 Number */\n  function parse_Number(blob, length, opts) {\n    if (opts.biffguess && opts.biff == 2) opts.biff = 5;\n    var cell = parse_XLSCell(blob, 6);\n    var xnum = parse_Xnum(blob, 8);\n    cell.val = xnum;\n    return cell;\n  }\n  function write_Number(R, C, v, os) {\n    var o = new_buf(14);\n    write_XLSCell(R, C, os, o);\n    write_Xnum(v, o);\n    return o;\n  }\n  var parse_XLHeaderFooter = parse_OptXLUnicodeString; // TODO: parse 2.4.136\n\n  /* [MS-XLS] 2.4.271 */\n  function parse_SupBook(blob, length, opts) {\n    var end = blob.l + length;\n    var ctab = blob.read_shift(2);\n    var cch = blob.read_shift(2);\n    opts.sbcch = cch;\n    if (cch == 0x0401 || cch == 0x3A01) return [cch, ctab];\n    if (cch < 0x01 || cch > 0xff) throw new Error(\"Unexpected SupBook type: \" + cch);\n    var virtPath = parse_XLUnicodeStringNoCch(blob, cch);\n    /* TODO: 2.5.277 Virtual Path */\n    var rgst = [];\n    while (end > blob.l) rgst.push(parse_XLUnicodeString(blob));\n    return [cch, ctab, virtPath, rgst];\n  }\n\n  /* [MS-XLS] 2.4.105 TODO */\n  function parse_ExternName(blob, length, opts) {\n    var flags = blob.read_shift(2);\n    var body;\n    var o = {\n      fBuiltIn: flags & 0x01,\n      fWantAdvise: flags >>> 1 & 0x01,\n      fWantPict: flags >>> 2 & 0x01,\n      fOle: flags >>> 3 & 0x01,\n      fOleLink: flags >>> 4 & 0x01,\n      cf: flags >>> 5 & 0x3FF,\n      fIcon: flags >>> 15 & 0x01\n    };\n    if (opts.sbcch === 0x3A01) body = parse_AddinUdf(blob, length - 2, opts);\n    //else throw new Error(\"unsupported SupBook cch: \" + opts.sbcch);\n    o.body = body || blob.read_shift(length - 2);\n    if (typeof body === \"string\") o.Name = body;\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.150 TODO */\n  var XLSLblBuiltIn = [\"_xlnm.Consolidate_Area\", \"_xlnm.Auto_Open\", \"_xlnm.Auto_Close\", \"_xlnm.Extract\", \"_xlnm.Database\", \"_xlnm.Criteria\", \"_xlnm.Print_Area\", \"_xlnm.Print_Titles\", \"_xlnm.Recorder\", \"_xlnm.Data_Form\", \"_xlnm.Auto_Activate\", \"_xlnm.Auto_Deactivate\", \"_xlnm.Sheet_Title\", \"_xlnm._FilterDatabase\"];\n  function parse_Lbl(blob, length, opts) {\n    var target = blob.l + length;\n    var flags = blob.read_shift(2);\n    var chKey = blob.read_shift(1);\n    var cch = blob.read_shift(1);\n    var cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n    var itab = 0;\n    if (!opts || opts.biff >= 5) {\n      if (opts.biff != 5) blob.l += 2;\n      itab = blob.read_shift(2);\n      if (opts.biff == 5) blob.l += 2;\n      blob.l += 4;\n    }\n    var name = parse_XLUnicodeStringNoCch(blob, cch, opts);\n    if (flags & 0x20) name = XLSLblBuiltIn[name.charCodeAt(0)];\n    var npflen = target - blob.l;\n    if (opts && opts.biff == 2) --npflen;\n    /*jshint -W018 */\n    var rgce = target == blob.l || cce === 0 || !(npflen > 0) ? [] : parse_NameParsedFormula(blob, npflen, opts, cce);\n    /*jshint +W018 */\n    return {\n      chKey: chKey,\n      Name: name,\n      itab: itab,\n      rgce: rgce\n    };\n  }\n\n  /* [MS-XLS] 2.4.106 TODO: verify filename encoding */\n  function parse_ExternSheet(blob, length, opts) {\n    if (opts.biff < 8) return parse_BIFF5ExternSheet(blob, length, opts);\n    var o = [],\n      target = blob.l + length,\n      len = blob.read_shift(opts.biff > 8 ? 4 : 2);\n    while (len-- !== 0) o.push(parse_XTI(blob, opts.biff > 8 ? 12 : 6, opts));\n    // [iSupBook, itabFirst, itabLast];\n    if (blob.l != target) throw new Error(\"Bad ExternSheet: \" + blob.l + \" != \" + target);\n    return o;\n  }\n  function parse_BIFF5ExternSheet(blob, length, opts) {\n    if (blob[blob.l + 1] == 0x03) blob[blob.l]++;\n    var o = parse_ShortXLUnicodeString(blob, length, opts);\n    return o.charCodeAt(0) == 0x03 ? o.slice(1) : o;\n  }\n\n  /* [MS-XLS] 2.4.176 TODO: check older biff */\n  function parse_NameCmt(blob, length, opts) {\n    if (opts.biff < 8) {\n      blob.l += length;\n      return;\n    }\n    var cchName = blob.read_shift(2);\n    var cchComment = blob.read_shift(2);\n    var name = parse_XLUnicodeStringNoCch(blob, cchName, opts);\n    var comment = parse_XLUnicodeStringNoCch(blob, cchComment, opts);\n    return [name, comment];\n  }\n\n  /* [MS-XLS] 2.4.260 */\n  function parse_ShrFmla(blob, length, opts) {\n    var ref = parse_RefU(blob, 6);\n    blob.l++;\n    var cUse = blob.read_shift(1);\n    length -= 8;\n    return [parse_SharedParsedFormula(blob, length, opts), cUse, ref];\n  }\n\n  /* [MS-XLS] 2.4.4 TODO */\n  function parse_Array(blob, length, opts) {\n    var ref = parse_Ref(blob, 6);\n    /* TODO: fAlwaysCalc */\n    switch (opts.biff) {\n      case 2:\n        blob.l++;\n        length -= 7;\n        break;\n      case 3:\n      case 4:\n        blob.l += 2;\n        length -= 8;\n        break;\n      default:\n        blob.l += 6;\n        length -= 12;\n    }\n    return [ref, parse_ArrayParsedFormula(blob, length, opts, ref)];\n  }\n\n  /* [MS-XLS] 2.4.173 */\n  function parse_MTRSettings(blob) {\n    var fMTREnabled = blob.read_shift(4) !== 0x00;\n    var fUserSetThreadCount = blob.read_shift(4) !== 0x00;\n    var cUserThreadCount = blob.read_shift(4);\n    return [fMTREnabled, fUserSetThreadCount, cUserThreadCount];\n  }\n\n  /* [MS-XLS] 2.5.186 TODO: BIFF5 */\n  function parse_NoteSh(blob, length, opts) {\n    if (opts.biff < 8) return;\n    var row = blob.read_shift(2),\n      col = blob.read_shift(2);\n    var flags = blob.read_shift(2),\n      idObj = blob.read_shift(2);\n    var stAuthor = parse_XLUnicodeString2(blob, 0, opts);\n    if (opts.biff < 8) blob.read_shift(1);\n    return [{\n      r: row,\n      c: col\n    }, stAuthor, idObj, flags];\n  }\n\n  /* [MS-XLS] 2.4.179 */\n  function parse_Note(blob, length, opts) {\n    /* TODO: Support revisions */\n    return parse_NoteSh(blob, length, opts);\n  }\n\n  /* [MS-XLS] 2.4.168 */\n  function parse_MergeCells(blob, length) {\n    var merges = [];\n    var cmcs = blob.read_shift(2);\n    while (cmcs--) merges.push(parse_Ref8U(blob, length));\n    return merges;\n  }\n  function write_MergeCells(merges) {\n    var o = new_buf(2 + merges.length * 8);\n    o.write_shift(2, merges.length);\n    for (var i = 0; i < merges.length; ++i) write_Ref8U(merges[i], o);\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.181 TODO: parse all the things! */\n  function parse_Obj(blob, length, opts) {\n    if (opts && opts.biff < 8) return parse_BIFF5Obj(blob, length, opts);\n    var cmo = parse_FtCmo(blob, 22); // id, ot, flags\n    var fts = parse_FtArray(blob, length - 22, cmo[1]);\n    return {\n      cmo: cmo,\n      ft: fts\n    };\n  }\n  /* from older spec */\n  var parse_BIFF5OT = {\n    0x08: function (blob, length) {\n      var tgt = blob.l + length;\n      blob.l += 10; // todo\n      var cf = blob.read_shift(2);\n      blob.l += 4;\n      blob.l += 2; //var cbPictFmla = blob.read_shift(2);\n      blob.l += 2;\n      blob.l += 2; //var grbit = blob.read_shift(2);\n      blob.l += 4;\n      var cchName = blob.read_shift(1);\n      blob.l += cchName; // TODO: stName\n      blob.l = tgt; // TODO: fmla\n      return {\n        fmt: cf\n      };\n    }\n  };\n  function parse_BIFF5Obj(blob, length, opts) {\n    blob.l += 4; //var cnt = blob.read_shift(4);\n    var ot = blob.read_shift(2);\n    var id = blob.read_shift(2);\n    var grbit = blob.read_shift(2);\n    blob.l += 2; //var colL = blob.read_shift(2);\n    blob.l += 2; //var dxL = blob.read_shift(2);\n    blob.l += 2; //var rwT = blob.read_shift(2);\n    blob.l += 2; //var dyT = blob.read_shift(2);\n    blob.l += 2; //var colR = blob.read_shift(2);\n    blob.l += 2; //var dxR = blob.read_shift(2);\n    blob.l += 2; //var rwB = blob.read_shift(2);\n    blob.l += 2; //var dyB = blob.read_shift(2);\n    blob.l += 2; //var cbMacro = blob.read_shift(2);\n    blob.l += 6;\n    length -= 36;\n    var fts = [];\n    fts.push((parse_BIFF5OT[ot] || parsenoop)(blob, length, opts));\n    return {\n      cmo: [id, ot, grbit],\n      ft: fts\n    };\n  }\n\n  /* [MS-XLS] 2.4.329 TODO: parse properly */\n  function parse_TxO(blob, length, opts) {\n    var s = blob.l;\n    var texts = \"\";\n    try {\n      blob.l += 4;\n      var ot = (opts.lastobj || {\n        cmo: [0, 0]\n      }).cmo[1];\n      var controlInfo; // eslint-disable-line no-unused-vars\n      if ([0, 5, 7, 11, 12, 14].indexOf(ot) == -1) blob.l += 6;else controlInfo = parse_ControlInfo(blob, 6, opts); // eslint-disable-line no-unused-vars\n      var cchText = blob.read_shift(2);\n      /*var cbRuns = */\n      blob.read_shift(2);\n      /*var ifntEmpty = */\n      parseuint16(blob, 2);\n      var len = blob.read_shift(2);\n      blob.l += len;\n      //var fmla = parse_ObjFmla(blob, s + length - blob.l);\n\n      for (var i = 1; i < blob.lens.length - 1; ++i) {\n        if (blob.l - s != blob.lens[i]) throw new Error(\"TxO: bad continue record\");\n        var hdr = blob[blob.l];\n        var t = parse_XLUnicodeStringNoCch(blob, blob.lens[i + 1] - blob.lens[i] - 1);\n        texts += t;\n        if (texts.length >= (hdr ? cchText : 2 * cchText)) break;\n      }\n      if (texts.length !== cchText && texts.length !== cchText * 2) {\n        throw new Error(\"cchText: \" + cchText + \" != \" + texts.length);\n      }\n      blob.l = s + length;\n      /* [MS-XLS] 2.5.272 TxORuns */\n      //\tvar rgTxoRuns = [];\n      //\tfor(var j = 0; j != cbRuns/8-1; ++j) blob.l += 8;\n      //\tvar cchText2 = blob.read_shift(2);\n      //\tif(cchText2 !== cchText) throw new Error(\"TxOLastRun mismatch: \" + cchText2 + \" \" + cchText);\n      //\tblob.l += 6;\n      //\tif(s + length != blob.l) throw new Error(\"TxO \" + (s + length) + \", at \" + blob.l);\n      return {\n        t: texts\n      };\n    } catch (e) {\n      blob.l = s + length;\n      return {\n        t: texts\n      };\n    }\n  }\n\n  /* [MS-XLS] 2.4.140 */\n  function parse_HLink(blob, length) {\n    var ref = parse_Ref8U(blob, 8);\n    blob.l += 16; /* CLSID */\n    var hlink = parse_Hyperlink(blob, length - 24);\n    return [ref, hlink];\n  }\n  function write_HLink(hl) {\n    var O = new_buf(24);\n    var ref = decode_cell(hl[0]);\n    O.write_shift(2, ref.r);\n    O.write_shift(2, ref.r);\n    O.write_shift(2, ref.c);\n    O.write_shift(2, ref.c);\n    var clsid = \"d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b\".split(\" \");\n    for (var i = 0; i < 16; ++i) O.write_shift(1, parseInt(clsid[i], 16));\n    return bconcat([O, write_Hyperlink(hl[1])]);\n  }\n\n  /* [MS-XLS] 2.4.141 */\n  function parse_HLinkTooltip(blob, length) {\n    blob.read_shift(2);\n    var ref = parse_Ref8U(blob, 8);\n    var wzTooltip = blob.read_shift((length - 10) / 2, 'dbcs-cont');\n    wzTooltip = wzTooltip.replace(chr0, \"\");\n    return [ref, wzTooltip];\n  }\n  function write_HLinkTooltip(hl) {\n    var TT = hl[1].Tooltip;\n    var O = new_buf(10 + 2 * (TT.length + 1));\n    O.write_shift(2, 0x0800);\n    var ref = decode_cell(hl[0]);\n    O.write_shift(2, ref.r);\n    O.write_shift(2, ref.r);\n    O.write_shift(2, ref.c);\n    O.write_shift(2, ref.c);\n    for (var i = 0; i < TT.length; ++i) O.write_shift(2, TT.charCodeAt(i));\n    O.write_shift(2, 0);\n    return O;\n  }\n\n  /* [MS-XLS] 2.4.63 */\n  function parse_Country(blob) {\n    var o = [0, 0],\n      d;\n    d = blob.read_shift(2);\n    o[0] = CountryEnum[d] || d;\n    d = blob.read_shift(2);\n    o[1] = CountryEnum[d] || d;\n    return o;\n  }\n  function write_Country(o) {\n    if (!o) o = new_buf(4);\n    o.write_shift(2, 0x01);\n    o.write_shift(2, 0x01);\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.50 ClrtClient */\n  function parse_ClrtClient(blob) {\n    var ccv = blob.read_shift(2);\n    var o = [];\n    while (ccv-- > 0) o.push(parse_LongRGB(blob, 8));\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.188 */\n  function parse_Palette(blob) {\n    var ccv = blob.read_shift(2);\n    var o = [];\n    while (ccv-- > 0) o.push(parse_LongRGB(blob, 8));\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.354 */\n  function parse_XFCRC(blob) {\n    blob.l += 2;\n    var o = {\n      cxfs: 0,\n      crc: 0\n    };\n    o.cxfs = blob.read_shift(2);\n    o.crc = blob.read_shift(4);\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.53 TODO: parse flags */\n  /* [MS-XLSB] 2.4.323 TODO: parse flags */\n  function parse_ColInfo(blob, length, opts) {\n    if (!opts.cellStyles) return parsenoop(blob, length);\n    var w = opts && opts.biff >= 12 ? 4 : 2;\n    var colFirst = blob.read_shift(w);\n    var colLast = blob.read_shift(w);\n    var coldx = blob.read_shift(w);\n    var ixfe = blob.read_shift(w);\n    var flags = blob.read_shift(2);\n    if (w == 2) blob.l += 2;\n    var o = {\n      s: colFirst,\n      e: colLast,\n      w: coldx,\n      ixfe: ixfe,\n      flags: flags\n    };\n    if (opts.biff >= 5 || !opts.biff) o.level = flags >> 8 & 0x7;\n    return o;\n  }\n  function write_ColInfo(col, idx) {\n    var o = new_buf(12);\n    o.write_shift(2, idx);\n    o.write_shift(2, idx);\n    o.write_shift(2, col.width * 256);\n    o.write_shift(2, 0);\n    var f = 0;\n    if (col.hidden) f |= 1;\n    o.write_shift(1, f);\n    f = col.level || 0;\n    o.write_shift(1, f);\n    o.write_shift(2, 0);\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.257 */\n  function parse_Setup(blob, length) {\n    var o = {};\n    if (length < 32) return o;\n    blob.l += 16;\n    o.header = parse_Xnum(blob, 8);\n    o.footer = parse_Xnum(blob, 8);\n    blob.l += 2;\n    return o;\n  }\n\n  /* [MS-XLS] 2.4.261 */\n  function parse_ShtProps(blob, length, opts) {\n    var def = {\n      area: false\n    };\n    if (opts.biff != 5) {\n      blob.l += length;\n      return def;\n    }\n    var d = blob.read_shift(1);\n    blob.l += 3;\n    if (d & 0x10) def.area = true;\n    return def;\n  }\n\n  /* [MS-XLS] 2.4.241 */\n  function write_RRTabId(n) {\n    var out = new_buf(2 * n);\n    for (var i = 0; i < n; ++i) out.write_shift(2, i + 1);\n    return out;\n  }\n  var parse_Blank = parse_XLSCell; /* [MS-XLS] 2.4.20 Just the cell */\n  var parse_Scl = parseuint16a; /* [MS-XLS] 2.4.247 num, den */\n  var parse_String = parse_XLUnicodeString; /* [MS-XLS] 2.4.268 */\n\n  /* --- Specific to versions before BIFF8 --- */\n  function parse_ImData(blob) {\n    var cf = blob.read_shift(2);\n    var env = blob.read_shift(2);\n    var lcb = blob.read_shift(4);\n    var o = {\n      fmt: cf,\n      env: env,\n      len: lcb,\n      data: blob.slice(blob.l, blob.l + lcb)\n    };\n    blob.l += lcb;\n    return o;\n  }\n\n  /* BIFF2_??? where ??? is the name from [XLS] */\n  function parse_BIFF2STR(blob, length, opts) {\n    if (opts.biffguess && opts.biff == 5) opts.biff = 2;\n    var cell = parse_XLSCell(blob, 6);\n    ++blob.l;\n    var str = parse_XLUnicodeString2(blob, length - 7, opts);\n    cell.t = 'str';\n    cell.val = str;\n    return cell;\n  }\n  function parse_BIFF2NUM(blob) {\n    var cell = parse_XLSCell(blob, 6);\n    ++blob.l;\n    var num = parse_Xnum(blob, 8);\n    cell.t = 'n';\n    cell.val = num;\n    return cell;\n  }\n  function write_BIFF2NUM(r, c, val) {\n    var out = new_buf(15);\n    write_BIFF2Cell(out, r, c);\n    out.write_shift(8, val, 'f');\n    return out;\n  }\n  function parse_BIFF2INT(blob) {\n    var cell = parse_XLSCell(blob, 6);\n    ++blob.l;\n    var num = blob.read_shift(2);\n    cell.t = 'n';\n    cell.val = num;\n    return cell;\n  }\n  function write_BIFF2INT(r, c, val) {\n    var out = new_buf(9);\n    write_BIFF2Cell(out, r, c);\n    out.write_shift(2, val);\n    return out;\n  }\n  function parse_BIFF2STRING(blob) {\n    var cch = blob.read_shift(1);\n    if (cch === 0) {\n      blob.l++;\n      return \"\";\n    }\n    return blob.read_shift(cch, 'sbcs-cont');\n  }\n\n  /* TODO: convert to BIFF8 font struct */\n  function parse_BIFF2FONTXTRA(blob, length) {\n    blob.l += 6; // unknown\n    blob.l += 2; // font weight \"bls\"\n    blob.l += 1; // charset\n    blob.l += 3; // unknown\n    blob.l += 1; // font family\n    blob.l += length - 13;\n  }\n\n  /* TODO: parse rich text runs */\n  function parse_RString(blob, length, opts) {\n    var end = blob.l + length;\n    var cell = parse_XLSCell(blob, 6);\n    var cch = blob.read_shift(2);\n    var str = parse_XLUnicodeStringNoCch(blob, cch, opts);\n    blob.l = end;\n    cell.t = 'str';\n    cell.val = str;\n    return cell;\n  }\n  /* from js-harb (C) 2014-present  SheetJS */\n  var DBF_SUPPORTED_VERSIONS = [0x02, 0x03, 0x30, 0x31, 0x83, 0x8B, 0x8C, 0xF5];\n  var DBF = function () {\n    var dbf_codepage_map = {\n      /* Code Pages Supported by Visual FoxPro */\n      0x01: 437,\n      0x02: 850,\n      0x03: 1252,\n      0x04: 10000,\n      0x64: 852,\n      0x65: 866,\n      0x66: 865,\n      0x67: 861,\n      0x68: 895,\n      0x69: 620,\n      0x6A: 737,\n      0x6B: 857,\n      0x78: 950,\n      0x79: 949,\n      0x7A: 936,\n      0x7B: 932,\n      0x7C: 874,\n      0x7D: 1255,\n      0x7E: 1256,\n      0x96: 10007,\n      0x97: 10029,\n      0x98: 10006,\n      0xC8: 1250,\n      0xC9: 1251,\n      0xCA: 1254,\n      0xCB: 1253,\n      /* shapefile DBF extension */\n      0x00: 20127,\n      0x08: 865,\n      0x09: 437,\n      0x0A: 850,\n      0x0B: 437,\n      0x0D: 437,\n      0x0E: 850,\n      0x0F: 437,\n      0x10: 850,\n      0x11: 437,\n      0x12: 850,\n      0x13: 932,\n      0x14: 850,\n      0x15: 437,\n      0x16: 850,\n      0x17: 865,\n      0x18: 437,\n      0x19: 437,\n      0x1A: 850,\n      0x1B: 437,\n      0x1C: 863,\n      0x1D: 850,\n      0x1F: 852,\n      0x22: 852,\n      0x23: 852,\n      0x24: 860,\n      0x25: 850,\n      0x26: 866,\n      0x37: 850,\n      0x40: 852,\n      0x4D: 936,\n      0x4E: 949,\n      0x4F: 950,\n      0x50: 874,\n      0x57: 1252,\n      0x58: 1252,\n      0x59: 1252,\n      0x6C: 863,\n      0x86: 737,\n      0x87: 852,\n      0x88: 857,\n      0xCC: 1257,\n      0xFF: 16969\n    };\n    var dbf_reverse_map = evert({\n      0x01: 437,\n      0x02: 850,\n      0x03: 1252,\n      0x04: 10000,\n      0x64: 852,\n      0x65: 866,\n      0x66: 865,\n      0x67: 861,\n      0x68: 895,\n      0x69: 620,\n      0x6A: 737,\n      0x6B: 857,\n      0x78: 950,\n      0x79: 949,\n      0x7A: 936,\n      0x7B: 932,\n      0x7C: 874,\n      0x7D: 1255,\n      0x7E: 1256,\n      0x96: 10007,\n      0x97: 10029,\n      0x98: 10006,\n      0xC8: 1250,\n      0xC9: 1251,\n      0xCA: 1254,\n      0xCB: 1253,\n      0x00: 20127\n    });\n    /* TODO: find an actual specification */\n    function dbf_to_aoa(buf, opts) {\n      var out = [];\n      var d = new_raw_buf(1);\n      switch (opts.type) {\n        case 'base64':\n          d = s2a(Base64_decode(buf));\n          break;\n        case 'binary':\n          d = s2a(buf);\n          break;\n        case 'buffer':\n        case 'array':\n          d = buf;\n          break;\n      }\n      prep_blob(d, 0);\n\n      /* header */\n      var ft = d.read_shift(1);\n      var memo = !!(ft & 0x88);\n      var vfp = false,\n        l7 = false;\n      switch (ft) {\n        case 0x02:\n          break;\n        // dBASE II\n        case 0x03:\n          break;\n        // dBASE III\n        case 0x30:\n          vfp = true;\n          memo = true;\n          break;\n        // VFP\n        case 0x31:\n          vfp = true;\n          memo = true;\n          break;\n        // VFP with autoincrement\n        // 0x43 dBASE IV SQL table files\n        // 0x63 dBASE IV SQL system files\n        case 0x83:\n          break;\n        // dBASE III with memo\n        case 0x8B:\n          break;\n        // dBASE IV with memo\n        case 0x8C:\n          l7 = true;\n          break;\n        // dBASE Level 7 with memo\n        // case 0xCB dBASE IV SQL table files with memo\n        case 0xF5:\n          break;\n        // FoxPro 2.x with memo\n        // case 0xFB FoxBASE\n        default:\n          throw new Error(\"DBF Unsupported Version: \" + ft.toString(16));\n      }\n      var nrow = 0,\n        fpos = 0x0209;\n      if (ft == 0x02) nrow = d.read_shift(2);\n      d.l += 3; // dBASE II stores DDMMYY date, others use YYMMDD\n      if (ft != 0x02) nrow = d.read_shift(4);\n      if (nrow > 1048576) nrow = 1e6;\n      if (ft != 0x02) fpos = d.read_shift(2); // header length\n      var rlen = d.read_shift(2); // record length\n\n      var /*flags = 0,*/current_cp = opts.codepage || 1252;\n      if (ft != 0x02) {\n        // 20 reserved bytes\n        d.l += 16;\n        /*flags = */\n        d.read_shift(1);\n        //if(memo && ((flags & 0x02) === 0)) throw new Error(\"DBF Flags \" + flags.toString(16) + \" ft \" + ft.toString(16));\n\n        /* codepage present in FoxPro and dBASE Level 7 */\n        if (d[d.l] !== 0) current_cp = dbf_codepage_map[d[d.l]];\n        d.l += 1;\n        d.l += 2;\n      }\n      if (l7) d.l += 36; // Level 7: 32 byte \"Language driver name\", 4 byte reserved\n\n      var fields = [],\n        field = {};\n      var hend = Math.min(d.length, ft == 0x02 ? 0x209 : fpos - 10 - (vfp ? 264 : 0));\n      var ww = l7 ? 32 : 11;\n      while (d.l < hend && d[d.l] != 0x0d) {\n        field = {};\n        field.name = $cptable.utils.decode(current_cp, d.slice(d.l, d.l + ww)).replace(/[\\u0000\\r\\n].*$/g, \"\");\n        d.l += ww;\n        field.type = String.fromCharCode(d.read_shift(1));\n        if (ft != 0x02 && !l7) field.offset = d.read_shift(4);\n        field.len = d.read_shift(1);\n        if (ft == 0x02) field.offset = d.read_shift(2);\n        field.dec = d.read_shift(1);\n        if (field.name.length) fields.push(field);\n        if (ft != 0x02) d.l += l7 ? 13 : 14;\n        switch (field.type) {\n          case 'B':\n            // Double (VFP) / Binary (dBASE L7)\n            if ((!vfp || field.len != 8) && opts.WTF) console.log('Skipping ' + field.name + ':' + field.type);\n            break;\n          case 'G': // General (FoxPro and dBASE L7)\n          case 'P':\n            // Picture (FoxPro and dBASE L7)\n            if (opts.WTF) console.log('Skipping ' + field.name + ':' + field.type);\n            break;\n          case '+': // Autoincrement (dBASE L7 only)\n          case '0': // _NullFlags (VFP only)\n          case '@': // Timestamp (dBASE L7 only)\n          case 'C': // Character (dBASE II)\n          case 'D': // Date (dBASE III)\n          case 'F': // Float (dBASE IV)\n          case 'I': // Long (VFP and dBASE L7)\n          case 'L': // Logical (dBASE II)\n          case 'M': // Memo (dBASE III)\n          case 'N': // Number (dBASE II)\n          case 'O': // Double (dBASE L7 only)\n          case 'T': // Datetime (VFP only)\n          case 'Y':\n            // Currency (VFP only)\n            break;\n          default:\n            throw new Error('Unknown Field Type: ' + field.type);\n        }\n      }\n      if (d[d.l] !== 0x0D) d.l = fpos - 1;\n      if (d.read_shift(1) !== 0x0D) throw new Error(\"DBF Terminator not found \" + d.l + \" \" + d[d.l]);\n      d.l = fpos;\n\n      /* data */\n      var R = 0,\n        C = 0;\n      out[0] = [];\n      for (C = 0; C != fields.length; ++C) out[0][C] = fields[C].name;\n      while (nrow-- > 0) {\n        if (d[d.l] === 0x2A) {\n          // TODO: record marked as deleted -- create a hidden row?\n          d.l += rlen;\n          continue;\n        }\n        ++d.l;\n        out[++R] = [];\n        C = 0;\n        for (C = 0; C != fields.length; ++C) {\n          var dd = d.slice(d.l, d.l + fields[C].len);\n          d.l += fields[C].len;\n          prep_blob(dd, 0);\n          var s = $cptable.utils.decode(current_cp, dd);\n          switch (fields[C].type) {\n            case 'C':\n              // NOTE: it is conventional to write '  /  /  ' for empty dates\n              if (s.trim().length) out[R][C] = s.replace(/\\s+$/, \"\");\n              break;\n            case 'D':\n              if (s.length === 8) out[R][C] = new Date(+s.slice(0, 4), +s.slice(4, 6) - 1, +s.slice(6, 8));else out[R][C] = s;\n              break;\n            case 'F':\n              out[R][C] = parseFloat(s.trim());\n              break;\n            case '+':\n            case 'I':\n              out[R][C] = l7 ? dd.read_shift(-4, 'i') ^ 0x80000000 : dd.read_shift(4, 'i');\n              break;\n            case 'L':\n              switch (s.trim().toUpperCase()) {\n                case 'Y':\n                case 'T':\n                  out[R][C] = true;\n                  break;\n                case 'N':\n                case 'F':\n                  out[R][C] = false;\n                  break;\n                case '':\n                case '?':\n                  break;\n                default:\n                  throw new Error(\"DBF Unrecognized L:|\" + s + \"|\");\n              }\n              break;\n            case 'M':\n              /* TODO: handle memo files */\n              if (!memo) throw new Error(\"DBF Unexpected MEMO for type \" + ft.toString(16));\n              out[R][C] = \"##MEMO##\" + (l7 ? parseInt(s.trim(), 10) : dd.read_shift(4));\n              break;\n            case 'N':\n              s = s.replace(/\\u0000/g, \"\").trim();\n              // NOTE: dBASE II interprets \"  .  \" as 0\n              if (s && s != \".\") out[R][C] = +s || 0;\n              break;\n            case '@':\n              // NOTE: dBASE specs appear to be incorrect\n              out[R][C] = new Date(dd.read_shift(-8, 'f') - 0x388317533400);\n              break;\n            case 'T':\n              out[R][C] = new Date((dd.read_shift(4) - 0x253D8C) * 0x5265C00 + dd.read_shift(4));\n              break;\n            case 'Y':\n              out[R][C] = dd.read_shift(4, 'i') / 1e4 + dd.read_shift(4, 'i') / 1e4 * Math.pow(2, 32);\n              break;\n            case 'O':\n              out[R][C] = -dd.read_shift(-8, 'f');\n              break;\n            case 'B':\n              if (vfp && fields[C].len == 8) {\n                out[R][C] = dd.read_shift(8, 'f');\n                break;\n              }\n            /* falls through */\n            case 'G':\n            case 'P':\n              dd.l += fields[C].len;\n              break;\n            case '0':\n              if (fields[C].name === '_NullFlags') break;\n            /* falls through */\n            default:\n              throw new Error(\"DBF Unsupported data type \" + fields[C].type);\n          }\n        }\n      }\n      if (ft != 0x02) if (d.l < d.length && d[d.l++] != 0x1A) throw new Error(\"DBF EOF Marker missing \" + (d.l - 1) + \" of \" + d.length + \" \" + d[d.l - 1].toString(16));\n      if (opts && opts.sheetRows) out = out.slice(0, opts.sheetRows);\n      opts.DBF = fields;\n      return out;\n    }\n    function dbf_to_sheet(buf, opts) {\n      var o = opts || {};\n      if (!o.dateNF) o.dateNF = \"yyyymmdd\";\n      var ws = aoa_to_sheet(dbf_to_aoa(buf, o), o);\n      ws[\"!cols\"] = o.DBF.map(function (field) {\n        return {\n          wch: field.len,\n          DBF: field\n        };\n      });\n      delete o.DBF;\n      return ws;\n    }\n    function dbf_to_workbook(buf, opts) {\n      try {\n        return sheet_to_workbook(dbf_to_sheet(buf, opts), opts);\n      } catch (e) {\n        if (opts && opts.WTF) throw e;\n      }\n      return {\n        SheetNames: [],\n        Sheets: {}\n      };\n    }\n    var _RLEN = {\n      'B': 8,\n      'C': 250,\n      'L': 1,\n      'D': 8,\n      '?': 0,\n      '': 0\n    };\n    function sheet_to_dbf(ws, opts) {\n      var o = opts || {};\n      if (+o.codepage >= 0) set_cp(+o.codepage);\n      if (o.type == \"string\") throw new Error(\"Cannot write DBF to JS string\");\n      var ba = buf_array();\n      var aoa = sheet_to_json(ws, {\n        header: 1,\n        raw: true,\n        cellDates: true\n      });\n      var headers = aoa[0],\n        data = aoa.slice(1),\n        cols = ws[\"!cols\"] || [];\n      var i = 0,\n        j = 0,\n        hcnt = 0,\n        rlen = 1;\n      for (i = 0; i < headers.length; ++i) {\n        if (((cols[i] || {}).DBF || {}).name) {\n          headers[i] = cols[i].DBF.name;\n          ++hcnt;\n          continue;\n        }\n        if (headers[i] == null) continue;\n        ++hcnt;\n        if (typeof headers[i] === 'number') headers[i] = headers[i].toString(10);\n        if (typeof headers[i] !== 'string') throw new Error(\"DBF Invalid column name \" + headers[i] + \" |\" + typeof headers[i] + \"|\");\n        if (headers.indexOf(headers[i]) !== i) for (j = 0; j < 1024; ++j) if (headers.indexOf(headers[i] + \"_\" + j) == -1) {\n          headers[i] += \"_\" + j;\n          break;\n        }\n      }\n      var range = safe_decode_range(ws['!ref']);\n      var coltypes = [];\n      var colwidths = [];\n      var coldecimals = [];\n      for (i = 0; i <= range.e.c - range.s.c; ++i) {\n        var guess = '',\n          _guess = '',\n          maxlen = 0;\n        var col = [];\n        for (j = 0; j < data.length; ++j) {\n          if (data[j][i] != null) col.push(data[j][i]);\n        }\n        if (col.length == 0 || headers[i] == null) {\n          coltypes[i] = '?';\n          continue;\n        }\n        for (j = 0; j < col.length; ++j) {\n          switch (typeof col[j]) {\n            /* TODO: check if L2 compat is desired */\n            case 'number':\n              _guess = 'B';\n              break;\n            case 'string':\n              _guess = 'C';\n              break;\n            case 'boolean':\n              _guess = 'L';\n              break;\n            case 'object':\n              _guess = col[j] instanceof Date ? 'D' : 'C';\n              break;\n            default:\n              _guess = 'C';\n          }\n          maxlen = Math.max(maxlen, String(col[j]).length);\n          guess = guess && guess != _guess ? 'C' : _guess;\n          //if(guess == 'C') break;\n        }\n\n        if (maxlen > 250) maxlen = 250;\n        _guess = ((cols[i] || {}).DBF || {}).type;\n        /* TODO: more fine grained control over DBF type resolution */\n        if (_guess == 'C') {\n          if (cols[i].DBF.len > maxlen) maxlen = cols[i].DBF.len;\n        }\n        if (guess == 'B' && _guess == 'N') {\n          guess = 'N';\n          coldecimals[i] = cols[i].DBF.dec;\n          maxlen = cols[i].DBF.len;\n        }\n        colwidths[i] = guess == 'C' || _guess == 'N' ? maxlen : _RLEN[guess] || 0;\n        rlen += colwidths[i];\n        coltypes[i] = guess;\n      }\n      var h = ba.next(32);\n      h.write_shift(4, 0x13021130);\n      h.write_shift(4, data.length);\n      h.write_shift(2, 296 + 32 * hcnt);\n      h.write_shift(2, rlen);\n      for (i = 0; i < 4; ++i) h.write_shift(4, 0);\n      h.write_shift(4, 0x00000000 | (+dbf_reverse_map[current_ansi] || 0x03) << 8);\n      for (i = 0, j = 0; i < headers.length; ++i) {\n        if (headers[i] == null) continue;\n        var hf = ba.next(32);\n        var _f = (headers[i].slice(-10) + \"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\").slice(0, 11);\n        hf.write_shift(1, _f, \"sbcs\");\n        hf.write_shift(1, coltypes[i] == '?' ? 'C' : coltypes[i], \"sbcs\");\n        hf.write_shift(4, j);\n        hf.write_shift(1, colwidths[i] || _RLEN[coltypes[i]] || 0);\n        hf.write_shift(1, coldecimals[i] || 0);\n        hf.write_shift(1, 0x02);\n        hf.write_shift(4, 0);\n        hf.write_shift(1, 0);\n        hf.write_shift(4, 0);\n        hf.write_shift(4, 0);\n        j += colwidths[i] || _RLEN[coltypes[i]] || 0;\n      }\n      var hb = ba.next(264);\n      hb.write_shift(4, 0x0000000D);\n      for (i = 0; i < 65; ++i) hb.write_shift(4, 0x00000000);\n      for (i = 0; i < data.length; ++i) {\n        var rout = ba.next(rlen);\n        rout.write_shift(1, 0);\n        for (j = 0; j < headers.length; ++j) {\n          if (headers[j] == null) continue;\n          switch (coltypes[j]) {\n            case 'L':\n              rout.write_shift(1, data[i][j] == null ? 0x3F : data[i][j] ? 0x54 : 0x46);\n              break;\n            case 'B':\n              rout.write_shift(8, data[i][j] || 0, 'f');\n              break;\n            case 'N':\n              var _n = \"0\";\n              if (typeof data[i][j] == \"number\") _n = data[i][j].toFixed(coldecimals[j] || 0);\n              for (hcnt = 0; hcnt < colwidths[j] - _n.length; ++hcnt) rout.write_shift(1, 0x20);\n              rout.write_shift(1, _n, \"sbcs\");\n              break;\n            case 'D':\n              if (!data[i][j]) rout.write_shift(8, \"00000000\", \"sbcs\");else {\n                rout.write_shift(4, (\"0000\" + data[i][j].getFullYear()).slice(-4), \"sbcs\");\n                rout.write_shift(2, (\"00\" + (data[i][j].getMonth() + 1)).slice(-2), \"sbcs\");\n                rout.write_shift(2, (\"00\" + data[i][j].getDate()).slice(-2), \"sbcs\");\n              }\n              break;\n            case 'C':\n              var _s = String(data[i][j] != null ? data[i][j] : \"\").slice(0, colwidths[j]);\n              rout.write_shift(1, _s, \"sbcs\");\n              for (hcnt = 0; hcnt < colwidths[j] - _s.length; ++hcnt) rout.write_shift(1, 0x20);\n              break;\n          }\n        }\n        // data\n      }\n\n      ba.next(1).write_shift(1, 0x1A);\n      return ba.end();\n    }\n    return {\n      to_workbook: dbf_to_workbook,\n      to_sheet: dbf_to_sheet,\n      from_sheet: sheet_to_dbf\n    };\n  }();\n  var SYLK = function () {\n    /* TODO: stress test sequences */\n    var sylk_escapes = {\n      AA: 'À',\n      BA: 'Á',\n      CA: 'Â',\n      DA: 195,\n      HA: 'Ä',\n      JA: 197,\n      AE: 'È',\n      BE: 'É',\n      CE: 'Ê',\n      HE: 'Ë',\n      AI: 'Ì',\n      BI: 'Í',\n      CI: 'Î',\n      HI: 'Ï',\n      AO: 'Ò',\n      BO: 'Ó',\n      CO: 'Ô',\n      DO: 213,\n      HO: 'Ö',\n      AU: 'Ù',\n      BU: 'Ú',\n      CU: 'Û',\n      HU: 'Ü',\n      Aa: 'à',\n      Ba: 'á',\n      Ca: 'â',\n      Da: 227,\n      Ha: 'ä',\n      Ja: 229,\n      Ae: 'è',\n      Be: 'é',\n      Ce: 'ê',\n      He: 'ë',\n      Ai: 'ì',\n      Bi: 'í',\n      Ci: 'î',\n      Hi: 'ï',\n      Ao: 'ò',\n      Bo: 'ó',\n      Co: 'ô',\n      Do: 245,\n      Ho: 'ö',\n      Au: 'ù',\n      Bu: 'ú',\n      Cu: 'û',\n      Hu: 'ü',\n      KC: 'Ç',\n      Kc: 'ç',\n      q: 'æ',\n      z: 'œ',\n      a: 'Æ',\n      j: 'Œ',\n      DN: 209,\n      Dn: 241,\n      Hy: 255,\n      S: 169,\n      c: 170,\n      R: 174,\n      \"B \": 180,\n      0: 176,\n      1: 177,\n      2: 178,\n      3: 179,\n      5: 181,\n      6: 182,\n      7: 183,\n      Q: 185,\n      k: 186,\n      b: 208,\n      i: 216,\n      l: 222,\n      s: 240,\n      y: 248,\n      \"!\": 161,\n      '\"': 162,\n      \"#\": 163,\n      \"(\": 164,\n      \"%\": 165,\n      \"'\": 167,\n      \"H \": 168,\n      \"+\": 171,\n      \";\": 187,\n      \"<\": 188,\n      \"=\": 189,\n      \">\": 190,\n      \"?\": 191,\n      \"{\": 223\n    };\n    var sylk_char_regex = new RegExp(\"\\u001BN(\" + keys(sylk_escapes).join(\"|\").replace(/\\|\\|\\|/, \"|\\\\||\").replace(/([?()+])/g, \"\\\\$1\") + \"|\\\\|)\", \"gm\");\n    var sylk_char_fn = function (_, $1) {\n      var o = sylk_escapes[$1];\n      return typeof o == \"number\" ? _getansi(o) : o;\n    };\n    var decode_sylk_char = function ($$, $1, $2) {\n      var newcc = $1.charCodeAt(0) - 0x20 << 4 | $2.charCodeAt(0) - 0x30;\n      return newcc == 59 ? $$ : _getansi(newcc);\n    };\n    sylk_escapes[\"|\"] = 254;\n    /* TODO: find an actual specification */\n    function sylk_to_aoa(d, opts) {\n      switch (opts.type) {\n        case 'base64':\n          return sylk_to_aoa_str(Base64_decode(d), opts);\n        case 'binary':\n          return sylk_to_aoa_str(d, opts);\n        case 'buffer':\n          return sylk_to_aoa_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n        case 'array':\n          return sylk_to_aoa_str(cc2str(d), opts);\n      }\n      throw new Error(\"Unrecognized type \" + opts.type);\n    }\n    function sylk_to_aoa_str(str, opts) {\n      var records = str.split(/[\\n\\r]+/),\n        R = -1,\n        C = -1,\n        ri = 0,\n        rj = 0,\n        arr = [];\n      var formats = [];\n      var next_cell_format = null;\n      var sht = {},\n        rowinfo = [],\n        colinfo = [],\n        cw = [];\n      var Mval = 0,\n        j;\n      if (+opts.codepage >= 0) set_cp(+opts.codepage);\n      for (; ri !== records.length; ++ri) {\n        Mval = 0;\n        var rstr = records[ri].trim().replace(/\\x1B([\\x20-\\x2F])([\\x30-\\x3F])/g, decode_sylk_char).replace(sylk_char_regex, sylk_char_fn);\n        var record = rstr.replace(/;;/g, \"\\u0000\").split(\";\").map(function (x) {\n          return x.replace(/\\u0000/g, \";\");\n        });\n        var RT = record[0],\n          val;\n        if (rstr.length > 0) switch (RT) {\n          case 'ID':\n            break;\n          /* header */\n          case 'E':\n            break;\n          /* EOF */\n          case 'B':\n            break;\n          /* dimensions */\n          case 'O':\n            break;\n          /* options? */\n          case 'W':\n            break;\n          /* window? */\n          case 'P':\n            if (record[1].charAt(0) == 'P') formats.push(rstr.slice(3).replace(/;;/g, \";\"));\n            break;\n          case 'C':\n            var C_seen_K = false,\n              C_seen_X = false,\n              C_seen_S = false,\n              C_seen_E = false,\n              _R = -1,\n              _C = -1;\n            for (rj = 1; rj < record.length; ++rj) switch (record[rj].charAt(0)) {\n              case 'A':\n                break;\n              // TODO: comment\n              case 'X':\n                C = parseInt(record[rj].slice(1)) - 1;\n                C_seen_X = true;\n                break;\n              case 'Y':\n                R = parseInt(record[rj].slice(1)) - 1;\n                if (!C_seen_X) C = 0;\n                for (j = arr.length; j <= R; ++j) arr[j] = [];\n                break;\n              case 'K':\n                val = record[rj].slice(1);\n                if (val.charAt(0) === '\"') val = val.slice(1, val.length - 1);else if (val === 'TRUE') val = true;else if (val === 'FALSE') val = false;else if (!isNaN(fuzzynum(val))) {\n                  val = fuzzynum(val);\n                  if (next_cell_format !== null && fmt_is_date(next_cell_format)) val = numdate(val);\n                } else if (!isNaN(fuzzydate(val).getDate())) {\n                  val = parseDate(val);\n                }\n                if (typeof $cptable !== 'undefined' && typeof val == \"string\" && (opts || {}).type != \"string\" && (opts || {}).codepage) val = $cptable.utils.decode(opts.codepage, val);\n                C_seen_K = true;\n                break;\n              case 'E':\n                C_seen_E = true;\n                var formula = rc_to_a1(record[rj].slice(1), {\n                  r: R,\n                  c: C\n                });\n                arr[R][C] = [arr[R][C], formula];\n                break;\n              case 'S':\n                C_seen_S = true;\n                arr[R][C] = [arr[R][C], \"S5S\"];\n                break;\n              case 'G':\n                break;\n              // unknown\n              case 'R':\n                _R = parseInt(record[rj].slice(1)) - 1;\n                break;\n              case 'C':\n                _C = parseInt(record[rj].slice(1)) - 1;\n                break;\n              default:\n                if (opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n            }\n            if (C_seen_K) {\n              if (arr[R][C] && arr[R][C].length == 2) arr[R][C][0] = val;else arr[R][C] = val;\n              next_cell_format = null;\n            }\n            if (C_seen_S) {\n              if (C_seen_E) throw new Error(\"SYLK shared formula cannot have own formula\");\n              var shrbase = _R > -1 && arr[_R][_C];\n              if (!shrbase || !shrbase[1]) throw new Error(\"SYLK shared formula cannot find base\");\n              arr[R][C][1] = shift_formula_str(shrbase[1], {\n                r: R - _R,\n                c: C - _C\n              });\n            }\n            break;\n          case 'F':\n            var F_seen = 0;\n            for (rj = 1; rj < record.length; ++rj) switch (record[rj].charAt(0)) {\n              case 'X':\n                C = parseInt(record[rj].slice(1)) - 1;\n                ++F_seen;\n                break;\n              case 'Y':\n                R = parseInt(record[rj].slice(1)) - 1; /*C = 0;*/\n                for (j = arr.length; j <= R; ++j) arr[j] = [];\n                break;\n              case 'M':\n                Mval = parseInt(record[rj].slice(1)) / 20;\n                break;\n              case 'F':\n                break;\n              /* ??? */\n              case 'G':\n                break;\n              /* hide grid */\n              case 'P':\n                next_cell_format = formats[parseInt(record[rj].slice(1))];\n                break;\n              case 'S':\n                break;\n              /* cell style */\n              case 'D':\n                break;\n              /* column */\n              case 'N':\n                break;\n              /* font */\n              case 'W':\n                cw = record[rj].slice(1).split(\" \");\n                for (j = parseInt(cw[0], 10); j <= parseInt(cw[1], 10); ++j) {\n                  Mval = parseInt(cw[2], 10);\n                  colinfo[j - 1] = Mval === 0 ? {\n                    hidden: true\n                  } : {\n                    wch: Mval\n                  };\n                  process_col(colinfo[j - 1]);\n                }\n                break;\n              case 'C':\n                /* default column format */\n                C = parseInt(record[rj].slice(1)) - 1;\n                if (!colinfo[C]) colinfo[C] = {};\n                break;\n              case 'R':\n                /* row properties */\n                R = parseInt(record[rj].slice(1)) - 1;\n                if (!rowinfo[R]) rowinfo[R] = {};\n                if (Mval > 0) {\n                  rowinfo[R].hpt = Mval;\n                  rowinfo[R].hpx = pt2px(Mval);\n                } else if (Mval === 0) rowinfo[R].hidden = true;\n                break;\n              default:\n                if (opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n            }\n            if (F_seen < 1) next_cell_format = null;\n            break;\n          default:\n            if (opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n        }\n      }\n      if (rowinfo.length > 0) sht['!rows'] = rowinfo;\n      if (colinfo.length > 0) sht['!cols'] = colinfo;\n      if (opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n      return [arr, sht];\n    }\n    function sylk_to_sheet(d, opts) {\n      var aoasht = sylk_to_aoa(d, opts);\n      var aoa = aoasht[0],\n        ws = aoasht[1];\n      var o = aoa_to_sheet(aoa, opts);\n      keys(ws).forEach(function (k) {\n        o[k] = ws[k];\n      });\n      return o;\n    }\n    function sylk_to_workbook(d, opts) {\n      return sheet_to_workbook(sylk_to_sheet(d, opts), opts);\n    }\n    function write_ws_cell_sylk(cell, ws, R, C) {\n      var o = \"C;Y\" + (R + 1) + \";X\" + (C + 1) + \";K\";\n      switch (cell.t) {\n        case 'n':\n          o += cell.v || 0;\n          if (cell.f && !cell.F) o += \";E\" + a1_to_rc(cell.f, {\n            r: R,\n            c: C\n          });\n          break;\n        case 'b':\n          o += cell.v ? \"TRUE\" : \"FALSE\";\n          break;\n        case 'e':\n          o += cell.w || cell.v;\n          break;\n        case 'd':\n          o += '\"' + (cell.w || cell.v) + '\"';\n          break;\n        case 's':\n          o += '\"' + cell.v.replace(/\"/g, \"\").replace(/;/g, \";;\") + '\"';\n          break;\n      }\n      return o;\n    }\n    function write_ws_cols_sylk(out, cols) {\n      cols.forEach(function (col, i) {\n        var rec = \"F;W\" + (i + 1) + \" \" + (i + 1) + \" \";\n        if (col.hidden) rec += \"0\";else {\n          if (typeof col.width == 'number' && !col.wpx) col.wpx = width2px(col.width);\n          if (typeof col.wpx == 'number' && !col.wch) col.wch = px2char(col.wpx);\n          if (typeof col.wch == 'number') rec += Math.round(col.wch);\n        }\n        if (rec.charAt(rec.length - 1) != \" \") out.push(rec);\n      });\n    }\n    function write_ws_rows_sylk(out, rows) {\n      rows.forEach(function (row, i) {\n        var rec = \"F;\";\n        if (row.hidden) rec += \"M0;\";else if (row.hpt) rec += \"M\" + 20 * row.hpt + \";\";else if (row.hpx) rec += \"M\" + 20 * px2pt(row.hpx) + \";\";\n        if (rec.length > 2) out.push(rec + \"R\" + (i + 1));\n      });\n    }\n    function sheet_to_sylk(ws, opts) {\n      var preamble = [\"ID;PWXL;N;E\"],\n        o = [];\n      var r = safe_decode_range(ws['!ref']),\n        cell;\n      var dense = Array.isArray(ws);\n      var RS = \"\\r\\n\";\n      preamble.push(\"P;PGeneral\");\n      preamble.push(\"F;P0;DG0G8;M255\");\n      if (ws['!cols']) write_ws_cols_sylk(preamble, ws['!cols']);\n      if (ws['!rows']) write_ws_rows_sylk(preamble, ws['!rows']);\n      preamble.push(\"B;Y\" + (r.e.r - r.s.r + 1) + \";X\" + (r.e.c - r.s.c + 1) + \";D\" + [r.s.c, r.s.r, r.e.c, r.e.r].join(\" \"));\n      for (var R = r.s.r; R <= r.e.r; ++R) {\n        for (var C = r.s.c; C <= r.e.c; ++C) {\n          var coord = encode_cell({\n            r: R,\n            c: C\n          });\n          cell = dense ? (ws[R] || [])[C] : ws[coord];\n          if (!cell || cell.v == null && (!cell.f || cell.F)) continue;\n          o.push(write_ws_cell_sylk(cell, ws, R, C, opts));\n        }\n      }\n      return preamble.join(RS) + RS + o.join(RS) + RS + \"E\" + RS;\n    }\n    return {\n      to_workbook: sylk_to_workbook,\n      to_sheet: sylk_to_sheet,\n      from_sheet: sheet_to_sylk\n    };\n  }();\n  var DIF = function () {\n    function dif_to_aoa(d, opts) {\n      switch (opts.type) {\n        case 'base64':\n          return dif_to_aoa_str(Base64_decode(d), opts);\n        case 'binary':\n          return dif_to_aoa_str(d, opts);\n        case 'buffer':\n          return dif_to_aoa_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n        case 'array':\n          return dif_to_aoa_str(cc2str(d), opts);\n      }\n      throw new Error(\"Unrecognized type \" + opts.type);\n    }\n    function dif_to_aoa_str(str, opts) {\n      var records = str.split('\\n'),\n        R = -1,\n        C = -1,\n        ri = 0,\n        arr = [];\n      for (; ri !== records.length; ++ri) {\n        if (records[ri].trim() === 'BOT') {\n          arr[++R] = [];\n          C = 0;\n          continue;\n        }\n        if (R < 0) continue;\n        var metadata = records[ri].trim().split(\",\");\n        var type = metadata[0],\n          value = metadata[1];\n        ++ri;\n        var data = records[ri] || \"\";\n        while ((data.match(/[\"]/g) || []).length & 1 && ri < records.length - 1) data += \"\\n\" + records[++ri];\n        data = data.trim();\n        switch (+type) {\n          case -1:\n            if (data === 'BOT') {\n              arr[++R] = [];\n              C = 0;\n              continue;\n            } else if (data !== 'EOD') throw new Error(\"Unrecognized DIF special command \" + data);\n            break;\n          case 0:\n            if (data === 'TRUE') arr[R][C] = true;else if (data === 'FALSE') arr[R][C] = false;else if (!isNaN(fuzzynum(value))) arr[R][C] = fuzzynum(value);else if (!isNaN(fuzzydate(value).getDate())) arr[R][C] = parseDate(value);else arr[R][C] = value;\n            ++C;\n            break;\n          case 1:\n            data = data.slice(1, data.length - 1);\n            data = data.replace(/\"\"/g, '\"');\n            if (DIF_XL && data && data.match(/^=\".*\"$/)) data = data.slice(2, -1);\n            arr[R][C++] = data !== '' ? data : null;\n            break;\n        }\n        if (data === 'EOD') break;\n      }\n      if (opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n      return arr;\n    }\n    function dif_to_sheet(str, opts) {\n      return aoa_to_sheet(dif_to_aoa(str, opts), opts);\n    }\n    function dif_to_workbook(str, opts) {\n      return sheet_to_workbook(dif_to_sheet(str, opts), opts);\n    }\n    var sheet_to_dif = function () {\n      var push_field = function pf(o, topic, v, n, s) {\n        o.push(topic);\n        o.push(v + \",\" + n);\n        o.push('\"' + s.replace(/\"/g, '\"\"') + '\"');\n      };\n      var push_value = function po(o, type, v, s) {\n        o.push(type + \",\" + v);\n        o.push(type == 1 ? '\"' + s.replace(/\"/g, '\"\"') + '\"' : s);\n      };\n      return function sheet_to_dif(ws) {\n        var o = [];\n        var r = safe_decode_range(ws['!ref']),\n          cell;\n        var dense = Array.isArray(ws);\n        push_field(o, \"TABLE\", 0, 1, \"sheetjs\");\n        push_field(o, \"VECTORS\", 0, r.e.r - r.s.r + 1, \"\");\n        push_field(o, \"TUPLES\", 0, r.e.c - r.s.c + 1, \"\");\n        push_field(o, \"DATA\", 0, 0, \"\");\n        for (var R = r.s.r; R <= r.e.r; ++R) {\n          push_value(o, -1, 0, \"BOT\");\n          for (var C = r.s.c; C <= r.e.c; ++C) {\n            var coord = encode_cell({\n              r: R,\n              c: C\n            });\n            cell = dense ? (ws[R] || [])[C] : ws[coord];\n            if (!cell) {\n              push_value(o, 1, 0, \"\");\n              continue;\n            }\n            switch (cell.t) {\n              case 'n':\n                var val = DIF_XL ? cell.w : cell.v;\n                if (!val && cell.v != null) val = cell.v;\n                if (val == null) {\n                  if (DIF_XL && cell.f && !cell.F) push_value(o, 1, 0, \"=\" + cell.f);else push_value(o, 1, 0, \"\");\n                } else push_value(o, 0, val, \"V\");\n                break;\n              case 'b':\n                push_value(o, 0, cell.v ? 1 : 0, cell.v ? \"TRUE\" : \"FALSE\");\n                break;\n              case 's':\n                push_value(o, 1, 0, !DIF_XL || isNaN(cell.v) ? cell.v : '=\"' + cell.v + '\"');\n                break;\n              case 'd':\n                if (!cell.w) cell.w = SSF_format(cell.z || table_fmt[14], datenum(parseDate(cell.v)));\n                if (DIF_XL) push_value(o, 0, cell.w, \"V\");else push_value(o, 1, 0, cell.w);\n                break;\n              default:\n                push_value(o, 1, 0, \"\");\n            }\n          }\n        }\n        push_value(o, -1, 0, \"EOD\");\n        var RS = \"\\r\\n\";\n        var oo = o.join(RS);\n        //while((oo.length & 0x7F) != 0) oo += \"\\0\";\n        return oo;\n      };\n    }();\n    return {\n      to_workbook: dif_to_workbook,\n      to_sheet: dif_to_sheet,\n      from_sheet: sheet_to_dif\n    };\n  }();\n  var ETH = function () {\n    function decode(s) {\n      return s.replace(/\\\\b/g, \"\\\\\").replace(/\\\\c/g, \":\").replace(/\\\\n/g, \"\\n\");\n    }\n    function encode(s) {\n      return s.replace(/\\\\/g, \"\\\\b\").replace(/:/g, \"\\\\c\").replace(/\\n/g, \"\\\\n\");\n    }\n    function eth_to_aoa(str, opts) {\n      var records = str.split('\\n'),\n        R = -1,\n        C = -1,\n        ri = 0,\n        arr = [];\n      for (; ri !== records.length; ++ri) {\n        var record = records[ri].trim().split(\":\");\n        if (record[0] !== 'cell') continue;\n        var addr = decode_cell(record[1]);\n        if (arr.length <= addr.r) for (R = arr.length; R <= addr.r; ++R) if (!arr[R]) arr[R] = [];\n        R = addr.r;\n        C = addr.c;\n        switch (record[2]) {\n          case 't':\n            arr[R][C] = decode(record[3]);\n            break;\n          case 'v':\n            arr[R][C] = +record[3];\n            break;\n          case 'vtf':\n            var _f = record[record.length - 1];\n          /* falls through */\n          case 'vtc':\n            switch (record[3]) {\n              case 'nl':\n                arr[R][C] = +record[4] ? true : false;\n                break;\n              default:\n                arr[R][C] = +record[4];\n                break;\n            }\n            if (record[2] == 'vtf') arr[R][C] = [arr[R][C], _f];\n        }\n      }\n      if (opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n      return arr;\n    }\n    function eth_to_sheet(d, opts) {\n      return aoa_to_sheet(eth_to_aoa(d, opts), opts);\n    }\n    function eth_to_workbook(d, opts) {\n      return sheet_to_workbook(eth_to_sheet(d, opts), opts);\n    }\n    var header = [\"socialcalc:version:1.5\", \"MIME-Version: 1.0\", \"Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave\"].join(\"\\n\");\n    var sep = [\"--SocialCalcSpreadsheetControlSave\", \"Content-type: text/plain; charset=UTF-8\"].join(\"\\n\") + \"\\n\";\n\n    /* TODO: the other parts */\n    var meta = [\"# SocialCalc Spreadsheet Control Save\", \"part:sheet\"].join(\"\\n\");\n    var end = \"--SocialCalcSpreadsheetControlSave--\";\n    function sheet_to_eth_data(ws) {\n      if (!ws || !ws['!ref']) return \"\";\n      var o = [],\n        oo = [],\n        cell,\n        coord = \"\";\n      var r = decode_range(ws['!ref']);\n      var dense = Array.isArray(ws);\n      for (var R = r.s.r; R <= r.e.r; ++R) {\n        for (var C = r.s.c; C <= r.e.c; ++C) {\n          coord = encode_cell({\n            r: R,\n            c: C\n          });\n          cell = dense ? (ws[R] || [])[C] : ws[coord];\n          if (!cell || cell.v == null || cell.t === 'z') continue;\n          oo = [\"cell\", coord, 't'];\n          switch (cell.t) {\n            case 's':\n            case 'str':\n              oo.push(encode(cell.v));\n              break;\n            case 'n':\n              if (!cell.f) {\n                oo[2] = 'v';\n                oo[3] = cell.v;\n              } else {\n                oo[2] = 'vtf';\n                oo[3] = 'n';\n                oo[4] = cell.v;\n                oo[5] = encode(cell.f);\n              }\n              break;\n            case 'b':\n              oo[2] = 'vt' + (cell.f ? 'f' : 'c');\n              oo[3] = 'nl';\n              oo[4] = cell.v ? \"1\" : \"0\";\n              oo[5] = encode(cell.f || (cell.v ? 'TRUE' : 'FALSE'));\n              break;\n            case 'd':\n              var t = datenum(parseDate(cell.v));\n              oo[2] = 'vtc';\n              oo[3] = 'nd';\n              oo[4] = \"\" + t;\n              oo[5] = cell.w || SSF_format(cell.z || table_fmt[14], t);\n              break;\n            case 'e':\n              continue;\n          }\n          o.push(oo.join(\":\"));\n        }\n      }\n      o.push(\"sheet:c:\" + (r.e.c - r.s.c + 1) + \":r:\" + (r.e.r - r.s.r + 1) + \":tvf:1\");\n      o.push(\"valueformat:1:text-wiki\");\n      //o.push(\"copiedfrom:\" + ws['!ref']); // clipboard only\n      return o.join(\"\\n\");\n    }\n    function sheet_to_eth(ws) {\n      return [header, sep, meta, sep, sheet_to_eth_data(ws), end].join(\"\\n\");\n      // return [\"version:1.5\", sheet_to_eth_data(ws)].join(\"\\n\"); // clipboard form\n    }\n\n    return {\n      to_workbook: eth_to_workbook,\n      to_sheet: eth_to_sheet,\n      from_sheet: sheet_to_eth\n    };\n  }();\n  var PRN = function () {\n    function set_text_arr(data, arr, R, C, o) {\n      if (o.raw) arr[R][C] = data;else if (data === \"\") {/* empty */} else if (data === 'TRUE') arr[R][C] = true;else if (data === 'FALSE') arr[R][C] = false;else if (!isNaN(fuzzynum(data))) arr[R][C] = fuzzynum(data);else if (!isNaN(fuzzydate(data).getDate())) arr[R][C] = parseDate(data);else arr[R][C] = data;\n    }\n    function prn_to_aoa_str(f, opts) {\n      var o = opts || {};\n      var arr = [];\n      if (!f || f.length === 0) return arr;\n      var lines = f.split(/[\\r\\n]/);\n      var L = lines.length - 1;\n      while (L >= 0 && lines[L].length === 0) --L;\n      var start = 10,\n        idx = 0;\n      var R = 0;\n      for (; R <= L; ++R) {\n        idx = lines[R].indexOf(\" \");\n        if (idx == -1) idx = lines[R].length;else idx++;\n        start = Math.max(start, idx);\n      }\n      for (R = 0; R <= L; ++R) {\n        arr[R] = [];\n        /* TODO: confirm that widths are always 10 */\n        var C = 0;\n        set_text_arr(lines[R].slice(0, start).trim(), arr, R, C, o);\n        for (C = 1; C <= (lines[R].length - start) / 10 + 1; ++C) set_text_arr(lines[R].slice(start + (C - 1) * 10, start + C * 10).trim(), arr, R, C, o);\n      }\n      if (o.sheetRows) arr = arr.slice(0, o.sheetRows);\n      return arr;\n    }\n\n    // List of accepted CSV separators\n    var guess_seps = {\n      0x2C: ',',\n      0x09: \"\\t\",\n      0x3B: ';',\n      0x7C: '|'\n    };\n\n    // CSV separator weights to be used in case of equal numbers\n    var guess_sep_weights = {\n      0x2C: 3,\n      0x09: 2,\n      0x3B: 1,\n      0x7C: 0\n    };\n    function guess_sep(str) {\n      var cnt = {},\n        instr = false,\n        end = 0,\n        cc = 0;\n      for (; end < str.length; ++end) {\n        if ((cc = str.charCodeAt(end)) == 0x22) instr = !instr;else if (!instr && cc in guess_seps) cnt[cc] = (cnt[cc] || 0) + 1;\n      }\n      cc = [];\n      for (end in cnt) if (Object.prototype.hasOwnProperty.call(cnt, end)) {\n        cc.push([cnt[end], end]);\n      }\n      if (!cc.length) {\n        cnt = guess_sep_weights;\n        for (end in cnt) if (Object.prototype.hasOwnProperty.call(cnt, end)) {\n          cc.push([cnt[end], end]);\n        }\n      }\n      cc.sort(function (a, b) {\n        return a[0] - b[0] || guess_sep_weights[a[1]] - guess_sep_weights[b[1]];\n      });\n      return guess_seps[cc.pop()[1]] || 0x2C;\n    }\n    function dsv_to_sheet_str(str, opts) {\n      var o = opts || {};\n      var sep = \"\";\n      if (DENSE != null && o.dense == null) o.dense = DENSE;\n      var ws = o.dense ? [] : {};\n      var range = {\n        s: {\n          c: 0,\n          r: 0\n        },\n        e: {\n          c: 0,\n          r: 0\n        }\n      };\n      if (str.slice(0, 4) == \"sep=\") {\n        // If the line ends in \\r\\n\n        if (str.charCodeAt(5) == 13 && str.charCodeAt(6) == 10) {\n          sep = str.charAt(4);\n          str = str.slice(7);\n        }\n        // If line ends in \\r OR \\n\n        else if (str.charCodeAt(5) == 13 || str.charCodeAt(5) == 10) {\n          sep = str.charAt(4);\n          str = str.slice(6);\n        } else sep = guess_sep(str.slice(0, 1024));\n      } else if (o && o.FS) sep = o.FS;else sep = guess_sep(str.slice(0, 1024));\n      var R = 0,\n        C = 0,\n        v = 0;\n      var start = 0,\n        end = 0,\n        sepcc = sep.charCodeAt(0),\n        instr = false,\n        cc = 0,\n        startcc = str.charCodeAt(0);\n      str = str.replace(/\\r\\n/mg, \"\\n\");\n      var _re = o.dateNF != null ? dateNF_regex(o.dateNF) : null;\n      function finish_cell() {\n        var s = str.slice(start, end);\n        var cell = {};\n        if (s.charAt(0) == '\"' && s.charAt(s.length - 1) == '\"') s = s.slice(1, -1).replace(/\"\"/g, '\"');\n        if (s.length === 0) cell.t = 'z';else if (o.raw) {\n          cell.t = 's';\n          cell.v = s;\n        } else if (s.trim().length === 0) {\n          cell.t = 's';\n          cell.v = s;\n        } else if (s.charCodeAt(0) == 0x3D) {\n          if (s.charCodeAt(1) == 0x22 && s.charCodeAt(s.length - 1) == 0x22) {\n            cell.t = 's';\n            cell.v = s.slice(2, -1).replace(/\"\"/g, '\"');\n          } else if (fuzzyfmla(s)) {\n            cell.t = 'n';\n            cell.f = s.slice(1);\n          } else {\n            cell.t = 's';\n            cell.v = s;\n          }\n        } else if (s == \"TRUE\") {\n          cell.t = 'b';\n          cell.v = true;\n        } else if (s == \"FALSE\") {\n          cell.t = 'b';\n          cell.v = false;\n        } else if (!isNaN(v = fuzzynum(s))) {\n          cell.t = 'n';\n          if (o.cellText !== false) cell.w = s;\n          cell.v = v;\n        } else if (!isNaN(fuzzydate(s).getDate()) || _re && s.match(_re)) {\n          cell.z = o.dateNF || table_fmt[14];\n          var k = 0;\n          if (_re && s.match(_re)) {\n            s = dateNF_fix(s, o.dateNF, s.match(_re) || []);\n            k = 1;\n          }\n          if (o.cellDates) {\n            cell.t = 'd';\n            cell.v = parseDate(s, k);\n          } else {\n            cell.t = 'n';\n            cell.v = datenum(parseDate(s, k));\n          }\n          if (o.cellText !== false) cell.w = SSF_format(cell.z, cell.v instanceof Date ? datenum(cell.v) : cell.v);\n          if (!o.cellNF) delete cell.z;\n        } else {\n          cell.t = 's';\n          cell.v = s;\n        }\n        if (cell.t == 'z') {} else if (o.dense) {\n          if (!ws[R]) ws[R] = [];\n          ws[R][C] = cell;\n        } else ws[encode_cell({\n          c: C,\n          r: R\n        })] = cell;\n        start = end + 1;\n        startcc = str.charCodeAt(start);\n        if (range.e.c < C) range.e.c = C;\n        if (range.e.r < R) range.e.r = R;\n        if (cc == sepcc) ++C;else {\n          C = 0;\n          ++R;\n          if (o.sheetRows && o.sheetRows <= R) return true;\n        }\n      }\n      outer: for (; end < str.length; ++end) switch (cc = str.charCodeAt(end)) {\n        case 0x22:\n          if (startcc === 0x22) instr = !instr;\n          break;\n        case sepcc:\n        case 0x0a:\n        case 0x0d:\n          if (!instr && finish_cell()) break outer;\n          break;\n        default:\n          break;\n      }\n      if (end - start > 0) finish_cell();\n      ws['!ref'] = encode_range(range);\n      return ws;\n    }\n    function prn_to_sheet_str(str, opts) {\n      if (!(opts && opts.PRN)) return dsv_to_sheet_str(str, opts);\n      if (opts.FS) return dsv_to_sheet_str(str, opts);\n      if (str.slice(0, 4) == \"sep=\") return dsv_to_sheet_str(str, opts);\n      if (str.indexOf(\"\\t\") >= 0 || str.indexOf(\",\") >= 0 || str.indexOf(\";\") >= 0) return dsv_to_sheet_str(str, opts);\n      return aoa_to_sheet(prn_to_aoa_str(str, opts), opts);\n    }\n    function prn_to_sheet(d, opts) {\n      var str = \"\",\n        bytes = opts.type == 'string' ? [0, 0, 0, 0] : firstbyte(d, opts);\n      switch (opts.type) {\n        case 'base64':\n          str = Base64_decode(d);\n          break;\n        case 'binary':\n          str = d;\n          break;\n        case 'buffer':\n          if (opts.codepage == 65001) str = d.toString('utf8'); // TODO: test if buf\n          else if (opts.codepage && typeof $cptable !== 'undefined') str = $cptable.utils.decode(opts.codepage, d);else str = has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d);\n          break;\n        case 'array':\n          str = cc2str(d);\n          break;\n        case 'string':\n          str = d;\n          break;\n        default:\n          throw new Error(\"Unrecognized type \" + opts.type);\n      }\n      if (bytes[0] == 0xEF && bytes[1] == 0xBB && bytes[2] == 0xBF) str = utf8read(str.slice(3));else if (opts.type != 'string' && opts.type != 'buffer' && opts.codepage == 65001) str = utf8read(str);else if (opts.type == 'binary' && typeof $cptable !== 'undefined' && opts.codepage) str = $cptable.utils.decode(opts.codepage, $cptable.utils.encode(28591, str));\n      if (str.slice(0, 19) == \"socialcalc:version:\") return ETH.to_sheet(opts.type == 'string' ? str : utf8read(str), opts);\n      return prn_to_sheet_str(str, opts);\n    }\n    function prn_to_workbook(d, opts) {\n      return sheet_to_workbook(prn_to_sheet(d, opts), opts);\n    }\n    function sheet_to_prn(ws) {\n      var o = [];\n      var r = safe_decode_range(ws['!ref']),\n        cell;\n      var dense = Array.isArray(ws);\n      for (var R = r.s.r; R <= r.e.r; ++R) {\n        var oo = [];\n        for (var C = r.s.c; C <= r.e.c; ++C) {\n          var coord = encode_cell({\n            r: R,\n            c: C\n          });\n          cell = dense ? (ws[R] || [])[C] : ws[coord];\n          if (!cell || cell.v == null) {\n            oo.push(\"          \");\n            continue;\n          }\n          var w = (cell.w || (format_cell(cell), cell.w) || \"\").slice(0, 10);\n          while (w.length < 10) w += \" \";\n          oo.push(w + (C === 0 ? \" \" : \"\"));\n        }\n        o.push(oo.join(\"\"));\n      }\n      return o.join(\"\\n\");\n    }\n    return {\n      to_workbook: prn_to_workbook,\n      to_sheet: prn_to_sheet,\n      from_sheet: sheet_to_prn\n    };\n  }();\n\n  /* Excel defaults to SYLK but warns if data is not valid */\n  function read_wb_ID(d, opts) {\n    var o = opts || {},\n      OLD_WTF = !!o.WTF;\n    o.WTF = true;\n    try {\n      var out = SYLK.to_workbook(d, o);\n      o.WTF = OLD_WTF;\n      return out;\n    } catch (e) {\n      o.WTF = OLD_WTF;\n      if (!e.message.match(/SYLK bad record ID/) && OLD_WTF) throw e;\n      return PRN.to_workbook(d, opts);\n    }\n  }\n  var WK_ = function () {\n    function lotushopper(data, cb, opts) {\n      if (!data) return;\n      prep_blob(data, data.l || 0);\n      var Enum = opts.Enum || WK1Enum;\n      while (data.l < data.length) {\n        var RT = data.read_shift(2);\n        var R = Enum[RT] || Enum[0xFFFF];\n        var length = data.read_shift(2);\n        var tgt = data.l + length;\n        var d = R.f && R.f(data, length, opts);\n        data.l = tgt;\n        if (cb(d, R, RT)) return;\n      }\n    }\n    function lotus_to_workbook(d, opts) {\n      switch (opts.type) {\n        case 'base64':\n          return lotus_to_workbook_buf(s2a(Base64_decode(d)), opts);\n        case 'binary':\n          return lotus_to_workbook_buf(s2a(d), opts);\n        case 'buffer':\n        case 'array':\n          return lotus_to_workbook_buf(d, opts);\n      }\n      throw \"Unsupported type \" + opts.type;\n    }\n    function lotus_to_workbook_buf(d, opts) {\n      if (!d) return d;\n      var o = opts || {};\n      if (DENSE != null && o.dense == null) o.dense = DENSE;\n      var s = o.dense ? [] : {},\n        n = \"Sheet1\",\n        next_n = \"\",\n        sidx = 0;\n      var sheets = {},\n        snames = [],\n        realnames = [];\n      var refguess = {\n        s: {\n          r: 0,\n          c: 0\n        },\n        e: {\n          r: 0,\n          c: 0\n        }\n      };\n      var sheetRows = o.sheetRows || 0;\n      if (d[2] == 0x00) {\n        if (d[3] == 0x08 || d[3] == 0x09) {\n          if (d.length >= 16 && d[14] == 0x05 && d[15] === 0x6c) throw new Error(\"Unsupported Works 3 for Mac file\");\n        }\n      }\n      if (d[2] == 0x02) {\n        o.Enum = WK1Enum;\n        lotushopper(d, function (val, R, RT) {\n          switch (RT) {\n            case 0x00:\n              /* BOF */\n              o.vers = val;\n              if (val >= 0x1000) o.qpro = true;\n              break;\n            case 0x06:\n              refguess = val;\n              break;\n            /* RANGE */\n            case 0xCC:\n              if (val) next_n = val;\n              break;\n            /* SHEETNAMECS */\n            case 0xDE:\n              next_n = val;\n              break;\n            /* SHEETNAMELP */\n            case 0x0F: /* LABEL */\n            case 0x33:\n              /* STRING */\n              if (!o.qpro) val[1].v = val[1].v.slice(1);\n            /* falls through */\n            case 0x0D: /* INTEGER */\n            case 0x0E: /* NUMBER */\n            case 0x10:\n              /* FORMULA */\n              /* TODO: actual translation of the format code */\n              if (RT == 0x0E && (val[2] & 0x70) == 0x70 && (val[2] & 0x0F) > 1 && (val[2] & 0x0F) < 15) {\n                val[1].z = o.dateNF || table_fmt[14];\n                if (o.cellDates) {\n                  val[1].t = 'd';\n                  val[1].v = numdate(val[1].v);\n                }\n              }\n              if (o.qpro) {\n                if (val[3] > sidx) {\n                  s[\"!ref\"] = encode_range(refguess);\n                  sheets[n] = s;\n                  snames.push(n);\n                  s = o.dense ? [] : {};\n                  refguess = {\n                    s: {\n                      r: 0,\n                      c: 0\n                    },\n                    e: {\n                      r: 0,\n                      c: 0\n                    }\n                  };\n                  sidx = val[3];\n                  n = next_n || \"Sheet\" + (sidx + 1);\n                  next_n = \"\";\n                }\n              }\n              var tmpcell = o.dense ? (s[val[0].r] || [])[val[0].c] : s[encode_cell(val[0])];\n              if (tmpcell) {\n                tmpcell.t = val[1].t;\n                tmpcell.v = val[1].v;\n                if (val[1].z != null) tmpcell.z = val[1].z;\n                if (val[1].f != null) tmpcell.f = val[1].f;\n                break;\n              }\n              if (o.dense) {\n                if (!s[val[0].r]) s[val[0].r] = [];\n                s[val[0].r][val[0].c] = val[1];\n              } else s[encode_cell(val[0])] = val[1];\n              break;\n            default:\n          }\n        }, o);\n      } else if (d[2] == 0x1A || d[2] == 0x0E) {\n        o.Enum = WK3Enum;\n        if (d[2] == 0x0E) {\n          o.qpro = true;\n          d.l = 0;\n        }\n        lotushopper(d, function (val, R, RT) {\n          switch (RT) {\n            case 0xCC:\n              n = val;\n              break;\n            /* SHEETNAMECS */\n            case 0x16:\n              /* LABEL16 */\n              val[1].v = val[1].v.slice(1);\n            /* falls through */\n            case 0x17: /* NUMBER17 */\n            case 0x18: /* NUMBER18 */\n            case 0x19: /* FORMULA19 */\n            case 0x25: /* NUMBER25 */\n            case 0x27: /* NUMBER27 */\n            case 0x28:\n              /* FORMULA28 */\n              if (val[3] > sidx) {\n                s[\"!ref\"] = encode_range(refguess);\n                sheets[n] = s;\n                snames.push(n);\n                s = o.dense ? [] : {};\n                refguess = {\n                  s: {\n                    r: 0,\n                    c: 0\n                  },\n                  e: {\n                    r: 0,\n                    c: 0\n                  }\n                };\n                sidx = val[3];\n                n = \"Sheet\" + (sidx + 1);\n              }\n              if (sheetRows > 0 && val[0].r >= sheetRows) break;\n              if (o.dense) {\n                if (!s[val[0].r]) s[val[0].r] = [];\n                s[val[0].r][val[0].c] = val[1];\n              } else s[encode_cell(val[0])] = val[1];\n              if (refguess.e.c < val[0].c) refguess.e.c = val[0].c;\n              if (refguess.e.r < val[0].r) refguess.e.r = val[0].r;\n              break;\n            case 0x1B:\n              /* XFORMAT */\n              if (val[0x36b0]) realnames[val[0x36b0][0]] = val[0x36b0][1];\n              break;\n            case 0x0601:\n              /* SHEETINFOQP */\n              realnames[val[0]] = val[1];\n              if (val[0] == sidx) n = val[1];\n              break;\n            default:\n              break;\n          }\n        }, o);\n      } else throw new Error(\"Unrecognized LOTUS BOF \" + d[2]);\n      s[\"!ref\"] = encode_range(refguess);\n      sheets[next_n || n] = s;\n      snames.push(next_n || n);\n      if (!realnames.length) return {\n        SheetNames: snames,\n        Sheets: sheets\n      };\n      var osheets = {},\n        rnames = [];\n      /* TODO: verify no collisions */\n      for (var i = 0; i < realnames.length; ++i) if (sheets[snames[i]]) {\n        rnames.push(realnames[i] || snames[i]);\n        osheets[realnames[i]] = sheets[realnames[i]] || sheets[snames[i]];\n      } else {\n        rnames.push(realnames[i]);\n        osheets[realnames[i]] = {\n          \"!ref\": \"A1\"\n        };\n      }\n      return {\n        SheetNames: rnames,\n        Sheets: osheets\n      };\n    }\n    function sheet_to_wk1(ws, opts) {\n      var o = opts || {};\n      if (+o.codepage >= 0) set_cp(+o.codepage);\n      if (o.type == \"string\") throw new Error(\"Cannot write WK1 to JS string\");\n      var ba = buf_array();\n      var range = safe_decode_range(ws[\"!ref\"]);\n      var dense = Array.isArray(ws);\n      var cols = [];\n      write_biff_rec(ba, 0x00, write_BOF_WK1(0x0406));\n      write_biff_rec(ba, 0x06, write_RANGE(range));\n      var max_R = Math.min(range.e.r, 8191);\n      for (var R = range.s.r; R <= max_R; ++R) {\n        var rr = encode_row(R);\n        for (var C = range.s.c; C <= range.e.c; ++C) {\n          if (R === range.s.r) cols[C] = encode_col(C);\n          var ref = cols[C] + rr;\n          var cell = dense ? (ws[R] || [])[C] : ws[ref];\n          if (!cell || cell.t == \"z\") continue;\n          /* TODO: formula records */\n          if (cell.t == \"n\") {\n            if ((cell.v | 0) == cell.v && cell.v >= -32768 && cell.v <= 32767) write_biff_rec(ba, 0x0d, write_INTEGER(R, C, cell.v));else write_biff_rec(ba, 0x0e, write_NUMBER(R, C, cell.v));\n          } else {\n            var str = format_cell(cell);\n            write_biff_rec(ba, 0x0F, write_LABEL(R, C, str.slice(0, 239)));\n          }\n        }\n      }\n      write_biff_rec(ba, 0x01);\n      return ba.end();\n    }\n    function book_to_wk3(wb, opts) {\n      var o = opts || {};\n      if (+o.codepage >= 0) set_cp(+o.codepage);\n      if (o.type == \"string\") throw new Error(\"Cannot write WK3 to JS string\");\n      var ba = buf_array();\n      write_biff_rec(ba, 0x00, write_BOF_WK3(wb));\n      for (var i = 0, cnt = 0; i < wb.SheetNames.length; ++i) if ((wb.Sheets[wb.SheetNames[i]] || {})[\"!ref\"]) write_biff_rec(ba, 0x1b, write_XFORMAT_SHEETNAME(wb.SheetNames[i], cnt++));\n      var wsidx = 0;\n      for (i = 0; i < wb.SheetNames.length; ++i) {\n        var ws = wb.Sheets[wb.SheetNames[i]];\n        if (!ws || !ws[\"!ref\"]) continue;\n        var range = safe_decode_range(ws[\"!ref\"]);\n        var dense = Array.isArray(ws);\n        var cols = [];\n        var max_R = Math.min(range.e.r, 8191);\n        for (var R = range.s.r; R <= max_R; ++R) {\n          var rr = encode_row(R);\n          for (var C = range.s.c; C <= range.e.c; ++C) {\n            if (R === range.s.r) cols[C] = encode_col(C);\n            var ref = cols[C] + rr;\n            var cell = dense ? (ws[R] || [])[C] : ws[ref];\n            if (!cell || cell.t == \"z\") continue;\n            /* TODO: FORMULA19 NUMBER18 records */\n            if (cell.t == \"n\") {\n              write_biff_rec(ba, 0x17, write_NUMBER_17(R, C, wsidx, cell.v));\n            } else {\n              var str = format_cell(cell);\n              /* TODO: max len? */\n              write_biff_rec(ba, 0x16, write_LABEL_16(R, C, wsidx, str.slice(0, 239)));\n            }\n          }\n        }\n        ++wsidx;\n      }\n      write_biff_rec(ba, 0x01);\n      return ba.end();\n    }\n    function write_BOF_WK1(v) {\n      var out = new_buf(2);\n      out.write_shift(2, v);\n      return out;\n    }\n    function write_BOF_WK3(wb) {\n      var out = new_buf(26);\n      out.write_shift(2, 0x1000);\n      out.write_shift(2, 0x0004);\n      out.write_shift(4, 0x0000);\n      var rows = 0,\n        cols = 0,\n        wscnt = 0;\n      for (var i = 0; i < wb.SheetNames.length; ++i) {\n        var name = wb.SheetNames[i];\n        var ws = wb.Sheets[name];\n        if (!ws || !ws[\"!ref\"]) continue;\n        ++wscnt;\n        var range = decode_range(ws[\"!ref\"]);\n        if (rows < range.e.r) rows = range.e.r;\n        if (cols < range.e.c) cols = range.e.c;\n      }\n      if (rows > 8191) rows = 8191;\n      out.write_shift(2, rows);\n      out.write_shift(1, wscnt);\n      out.write_shift(1, cols);\n      out.write_shift(2, 0x00);\n      out.write_shift(2, 0x00);\n      out.write_shift(1, 0x01);\n      out.write_shift(1, 0x02);\n      out.write_shift(4, 0);\n      out.write_shift(4, 0);\n      return out;\n    }\n    function parse_RANGE(blob, length, opts) {\n      var o = {\n        s: {\n          c: 0,\n          r: 0\n        },\n        e: {\n          c: 0,\n          r: 0\n        }\n      };\n      if (length == 8 && opts.qpro) {\n        o.s.c = blob.read_shift(1);\n        blob.l++;\n        o.s.r = blob.read_shift(2);\n        o.e.c = blob.read_shift(1);\n        blob.l++;\n        o.e.r = blob.read_shift(2);\n        return o;\n      }\n      o.s.c = blob.read_shift(2);\n      o.s.r = blob.read_shift(2);\n      if (length == 12 && opts.qpro) blob.l += 2;\n      o.e.c = blob.read_shift(2);\n      o.e.r = blob.read_shift(2);\n      if (length == 12 && opts.qpro) blob.l += 2;\n      if (o.s.c == 0xFFFF) o.s.c = o.e.c = o.s.r = o.e.r = 0;\n      return o;\n    }\n    function write_RANGE(range) {\n      var out = new_buf(8);\n      out.write_shift(2, range.s.c);\n      out.write_shift(2, range.s.r);\n      out.write_shift(2, range.e.c);\n      out.write_shift(2, range.e.r);\n      return out;\n    }\n    function parse_cell(blob, length, opts) {\n      var o = [{\n        c: 0,\n        r: 0\n      }, {\n        t: 'n',\n        v: 0\n      }, 0, 0];\n      if (opts.qpro && opts.vers != 0x5120) {\n        o[0].c = blob.read_shift(1);\n        o[3] = blob.read_shift(1);\n        o[0].r = blob.read_shift(2);\n        blob.l += 2;\n      } else {\n        o[2] = blob.read_shift(1);\n        o[0].c = blob.read_shift(2);\n        o[0].r = blob.read_shift(2);\n      }\n      return o;\n    }\n    function parse_LABEL(blob, length, opts) {\n      var tgt = blob.l + length;\n      var o = parse_cell(blob, length, opts);\n      o[1].t = 's';\n      if (opts.vers == 0x5120) {\n        blob.l++;\n        var len = blob.read_shift(1);\n        o[1].v = blob.read_shift(len, 'utf8');\n        return o;\n      }\n      if (opts.qpro) blob.l++;\n      o[1].v = blob.read_shift(tgt - blob.l, 'cstr');\n      return o;\n    }\n    function write_LABEL(R, C, s) {\n      /* TODO: encoding */\n      var o = new_buf(7 + s.length);\n      o.write_shift(1, 0xFF);\n      o.write_shift(2, C);\n      o.write_shift(2, R);\n      o.write_shift(1, 0x27); // ??\n      for (var i = 0; i < o.length; ++i) {\n        var cc = s.charCodeAt(i);\n        o.write_shift(1, cc >= 0x80 ? 0x5F : cc);\n      }\n      o.write_shift(1, 0);\n      return o;\n    }\n    function parse_INTEGER(blob, length, opts) {\n      var o = parse_cell(blob, length, opts);\n      o[1].v = blob.read_shift(2, 'i');\n      return o;\n    }\n    function write_INTEGER(R, C, v) {\n      var o = new_buf(7);\n      o.write_shift(1, 0xFF);\n      o.write_shift(2, C);\n      o.write_shift(2, R);\n      o.write_shift(2, v, 'i');\n      return o;\n    }\n    function parse_NUMBER(blob, length, opts) {\n      var o = parse_cell(blob, length, opts);\n      o[1].v = blob.read_shift(8, 'f');\n      return o;\n    }\n    function write_NUMBER(R, C, v) {\n      var o = new_buf(13);\n      o.write_shift(1, 0xFF);\n      o.write_shift(2, C);\n      o.write_shift(2, R);\n      o.write_shift(8, v, 'f');\n      return o;\n    }\n    function parse_FORMULA(blob, length, opts) {\n      var tgt = blob.l + length;\n      var o = parse_cell(blob, length, opts);\n      /* TODO: formula */\n      o[1].v = blob.read_shift(8, 'f');\n      if (opts.qpro) blob.l = tgt;else {\n        var flen = blob.read_shift(2);\n        wk1_fmla_to_csf(blob.slice(blob.l, blob.l + flen), o);\n        blob.l += flen;\n      }\n      return o;\n    }\n    function wk1_parse_rc(B, V, col) {\n      var rel = V & 0x8000;\n      V &= ~0x8000;\n      V = (rel ? B : 0) + (V >= 0x2000 ? V - 0x4000 : V);\n      return (rel ? \"\" : \"$\") + (col ? encode_col(V) : encode_row(V));\n    }\n    /* var oprec = [\n    \t8, 8, 8, 8, 8, 8, 8, 8, 6, 4, 4, 5, 5, 7, 3, 3,\n    \t3, 3, 3, 3, 1, 1, 2, 6, 8, 8, 8, 8, 8, 8, 8, 8\n    ]; */\n    /* TODO: flesh out */\n    var FuncTab = {\n      0x33: [\"FALSE\", 0],\n      0x34: [\"TRUE\", 0],\n      0x46: [\"LEN\", 1],\n      0x50: [\"SUM\", 69],\n      0x51: [\"AVERAGEA\", 69],\n      0x52: [\"COUNTA\", 69],\n      0x53: [\"MINA\", 69],\n      0x54: [\"MAXA\", 69],\n      0x6F: [\"T\", 1]\n    };\n    var BinOpTab = [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\",\n    // eslint-disable-line no-mixed-spaces-and-tabs\n    \"\", \"+\", \"-\", \"*\", \"/\", \"^\", \"=\", \"<>\",\n    // eslint-disable-line no-mixed-spaces-and-tabs\n    \"<=\", \">=\", \"<\", \">\", \"\", \"\", \"\", \"\",\n    // eslint-disable-line no-mixed-spaces-and-tabs\n    \"&\", \"\", \"\", \"\", \"\", \"\", \"\", \"\" // eslint-disable-line no-mixed-spaces-and-tabs\n    ];\n\n    function wk1_fmla_to_csf(blob, o) {\n      prep_blob(blob, 0);\n      var out = [],\n        argc = 0,\n        R = \"\",\n        C = \"\",\n        argL = \"\",\n        argR = \"\";\n      while (blob.l < blob.length) {\n        var cc = blob[blob.l++];\n        switch (cc) {\n          case 0x00:\n            out.push(blob.read_shift(8, 'f'));\n            break;\n          case 0x01:\n            {\n              C = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n              R = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n              out.push(C + R);\n            }\n            break;\n          case 0x02:\n            {\n              var c = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n              var r = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n              C = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n              R = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n              out.push(c + r + \":\" + C + R);\n            }\n            break;\n          case 0x03:\n            if (blob.l < blob.length) {\n              console.error(\"WK1 premature formula end\");\n              return;\n            }\n            break;\n          case 0x04:\n            out.push(\"(\" + out.pop() + \")\");\n            break;\n          case 0x05:\n            out.push(blob.read_shift(2));\n            break;\n          case 0x06:\n            {\n              /* TODO: text encoding */\n              var Z = \"\";\n              while (cc = blob[blob.l++]) Z += String.fromCharCode(cc);\n              out.push('\"' + Z.replace(/\"/g, '\"\"') + '\"');\n            }\n            break;\n          case 0x08:\n            out.push(\"-\" + out.pop());\n            break;\n          case 0x17:\n            out.push(\"+\" + out.pop());\n            break;\n          case 0x16:\n            out.push(\"NOT(\" + out.pop() + \")\");\n            break;\n          case 0x14:\n          case 0x15:\n            {\n              argR = out.pop();\n              argL = out.pop();\n              out.push([\"AND\", \"OR\"][cc - 0x14] + \"(\" + argL + \",\" + argR + \")\");\n            }\n            break;\n          default:\n            if (cc < 0x20 && BinOpTab[cc]) {\n              argR = out.pop();\n              argL = out.pop();\n              out.push(argL + BinOpTab[cc] + argR);\n            } else if (FuncTab[cc]) {\n              argc = FuncTab[cc][1];\n              if (argc == 69) argc = blob[blob.l++];\n              if (argc > out.length) {\n                console.error(\"WK1 bad formula parse 0x\" + cc.toString(16) + \":|\" + out.join(\"|\") + \"|\");\n                return;\n              }\n              var args = out.slice(-argc);\n              out.length -= argc;\n              out.push(FuncTab[cc][0] + \"(\" + args.join(\",\") + \")\");\n            } else if (cc <= 0x07) return console.error(\"WK1 invalid opcode \" + cc.toString(16));else if (cc <= 0x18) return console.error(\"WK1 unsupported op \" + cc.toString(16));else if (cc <= 0x1E) return console.error(\"WK1 invalid opcode \" + cc.toString(16));else if (cc <= 0x73) return console.error(\"WK1 unsupported function opcode \" + cc.toString(16));\n            // possible future functions ??\n            else return console.error(\"WK1 unrecognized opcode \" + cc.toString(16));\n        }\n      }\n      if (out.length == 1) o[1].f = \"\" + out[0];else console.error(\"WK1 bad formula parse |\" + out.join(\"|\") + \"|\");\n    }\n    function parse_cell_3(blob) {\n      var o = [{\n        c: 0,\n        r: 0\n      }, {\n        t: 'n',\n        v: 0\n      }, 0];\n      o[0].r = blob.read_shift(2);\n      o[3] = blob[blob.l++];\n      o[0].c = blob[blob.l++];\n      return o;\n    }\n    function parse_LABEL_16(blob, length) {\n      var o = parse_cell_3(blob, length);\n      o[1].t = 's';\n      o[1].v = blob.read_shift(length - 4, 'cstr');\n      return o;\n    }\n    function write_LABEL_16(R, C, wsidx, s) {\n      /* TODO: encoding */\n      var o = new_buf(6 + s.length);\n      o.write_shift(2, R);\n      o.write_shift(1, wsidx);\n      o.write_shift(1, C);\n      o.write_shift(1, 0x27);\n      for (var i = 0; i < s.length; ++i) {\n        var cc = s.charCodeAt(i);\n        o.write_shift(1, cc >= 0x80 ? 0x5F : cc);\n      }\n      o.write_shift(1, 0);\n      return o;\n    }\n    function parse_NUMBER_18(blob, length) {\n      var o = parse_cell_3(blob, length);\n      o[1].v = blob.read_shift(2);\n      var v = o[1].v >> 1;\n      if (o[1].v & 0x1) {\n        switch (v & 0x07) {\n          case 0:\n            v = (v >> 3) * 5000;\n            break;\n          case 1:\n            v = (v >> 3) * 500;\n            break;\n          case 2:\n            v = (v >> 3) / 20;\n            break;\n          case 3:\n            v = (v >> 3) / 200;\n            break;\n          case 4:\n            v = (v >> 3) / 2000;\n            break;\n          case 5:\n            v = (v >> 3) / 20000;\n            break;\n          case 6:\n            v = (v >> 3) / 16;\n            break;\n          case 7:\n            v = (v >> 3) / 64;\n            break;\n        }\n      }\n      o[1].v = v;\n      return o;\n    }\n    function parse_NUMBER_17(blob, length) {\n      var o = parse_cell_3(blob, length);\n      var v1 = blob.read_shift(4);\n      var v2 = blob.read_shift(4);\n      var e = blob.read_shift(2);\n      if (e == 0xFFFF) {\n        if (v1 === 0 && v2 === 0xC0000000) {\n          o[1].t = \"e\";\n          o[1].v = 0x0F;\n        } // ERR -> #VALUE!\n        else if (v1 === 0 && v2 === 0xD0000000) {\n          o[1].t = \"e\";\n          o[1].v = 0x2A;\n        } // NA -> #N/A\n        else o[1].v = 0;\n        return o;\n      }\n      var s = e & 0x8000;\n      e = (e & 0x7FFF) - 16446;\n      o[1].v = (1 - s * 2) * (v2 * Math.pow(2, e + 32) + v1 * Math.pow(2, e));\n      return o;\n    }\n    function write_NUMBER_17(R, C, wsidx, v) {\n      var o = new_buf(14);\n      o.write_shift(2, R);\n      o.write_shift(1, wsidx);\n      o.write_shift(1, C);\n      if (v == 0) {\n        o.write_shift(4, 0);\n        o.write_shift(4, 0);\n        o.write_shift(2, 0xFFFF);\n        return o;\n      }\n      var s = 0,\n        e = 0,\n        v1 = 0,\n        v2 = 0;\n      if (v < 0) {\n        s = 1;\n        v = -v;\n      }\n      e = Math.log2(v) | 0;\n      v /= Math.pow(2, e - 31);\n      v2 = v >>> 0;\n      if ((v2 & 0x80000000) == 0) {\n        v /= 2;\n        ++e;\n        v2 = v >>> 0;\n      }\n      v -= v2;\n      v2 |= 0x80000000;\n      v2 >>>= 0;\n      v *= Math.pow(2, 32);\n      v1 = v >>> 0;\n      o.write_shift(4, v1);\n      o.write_shift(4, v2);\n      e += 0x3FFF + (s ? 0x8000 : 0);\n      o.write_shift(2, e);\n      return o;\n    }\n    function parse_FORMULA_19(blob, length) {\n      var o = parse_NUMBER_17(blob, 14);\n      blob.l += length - 14; /* TODO: WK3 formula */\n      return o;\n    }\n    function parse_NUMBER_25(blob, length) {\n      var o = parse_cell_3(blob, length);\n      var v1 = blob.read_shift(4);\n      o[1].v = v1 >> 6;\n      return o;\n    }\n    function parse_NUMBER_27(blob, length) {\n      var o = parse_cell_3(blob, length);\n      var v1 = blob.read_shift(8, 'f');\n      o[1].v = v1;\n      return o;\n    }\n    function parse_FORMULA_28(blob, length) {\n      var o = parse_NUMBER_27(blob, 14);\n      blob.l += length - 10; /* TODO: formula */\n      return o;\n    }\n    function parse_SHEETNAMECS(blob, length) {\n      return blob[blob.l + length - 1] == 0 ? blob.read_shift(length, 'cstr') : \"\";\n    }\n    function parse_SHEETNAMELP(blob, length) {\n      var len = blob[blob.l++];\n      if (len > length - 1) len = length - 1;\n      var o = \"\";\n      while (o.length < len) o += String.fromCharCode(blob[blob.l++]);\n      return o;\n    }\n    function parse_SHEETINFOQP(blob, length, opts) {\n      if (!opts.qpro || length < 21) return;\n      var id = blob.read_shift(1);\n      blob.l += 17;\n      blob.l += 1; //var len = blob.read_shift(1);\n      blob.l += 2;\n      var nm = blob.read_shift(length - 21, 'cstr');\n      return [id, nm];\n    }\n    function parse_XFORMAT(blob, length) {\n      var o = {},\n        tgt = blob.l + length;\n      while (blob.l < tgt) {\n        var dt = blob.read_shift(2);\n        if (dt == 0x36b0) {\n          o[dt] = [0, \"\"];\n          o[dt][0] = blob.read_shift(2);\n          while (blob[blob.l]) {\n            o[dt][1] += String.fromCharCode(blob[blob.l]);\n            blob.l++;\n          }\n          blob.l++;\n        }\n        // TODO: 0x3a99 ??\n      }\n\n      return o;\n    }\n    function write_XFORMAT_SHEETNAME(name, wsidx) {\n      var out = new_buf(5 + name.length);\n      out.write_shift(2, 0x36b0);\n      out.write_shift(2, wsidx);\n      for (var i = 0; i < name.length; ++i) {\n        var cc = name.charCodeAt(i);\n        out[out.l++] = cc > 0x7F ? 0x5F : cc;\n      }\n      out[out.l++] = 0;\n      return out;\n    }\n    var WK1Enum = {\n      0x0000: {\n        n: \"BOF\",\n        f: parseuint16\n      },\n      0x0001: {\n        n: \"EOF\"\n      },\n      0x0002: {\n        n: \"CALCMODE\"\n      },\n      0x0003: {\n        n: \"CALCORDER\"\n      },\n      0x0004: {\n        n: \"SPLIT\"\n      },\n      0x0005: {\n        n: \"SYNC\"\n      },\n      0x0006: {\n        n: \"RANGE\",\n        f: parse_RANGE\n      },\n      0x0007: {\n        n: \"WINDOW1\"\n      },\n      0x0008: {\n        n: \"COLW1\"\n      },\n      0x0009: {\n        n: \"WINTWO\"\n      },\n      0x000A: {\n        n: \"COLW2\"\n      },\n      0x000B: {\n        n: \"NAME\"\n      },\n      0x000C: {\n        n: \"BLANK\"\n      },\n      0x000D: {\n        n: \"INTEGER\",\n        f: parse_INTEGER\n      },\n      0x000E: {\n        n: \"NUMBER\",\n        f: parse_NUMBER\n      },\n      0x000F: {\n        n: \"LABEL\",\n        f: parse_LABEL\n      },\n      0x0010: {\n        n: \"FORMULA\",\n        f: parse_FORMULA\n      },\n      0x0018: {\n        n: \"TABLE\"\n      },\n      0x0019: {\n        n: \"ORANGE\"\n      },\n      0x001A: {\n        n: \"PRANGE\"\n      },\n      0x001B: {\n        n: \"SRANGE\"\n      },\n      0x001C: {\n        n: \"FRANGE\"\n      },\n      0x001D: {\n        n: \"KRANGE1\"\n      },\n      0x0020: {\n        n: \"HRANGE\"\n      },\n      0x0023: {\n        n: \"KRANGE2\"\n      },\n      0x0024: {\n        n: \"PROTEC\"\n      },\n      0x0025: {\n        n: \"FOOTER\"\n      },\n      0x0026: {\n        n: \"HEADER\"\n      },\n      0x0027: {\n        n: \"SETUP\"\n      },\n      0x0028: {\n        n: \"MARGINS\"\n      },\n      0x0029: {\n        n: \"LABELFMT\"\n      },\n      0x002A: {\n        n: \"TITLES\"\n      },\n      0x002B: {\n        n: \"SHEETJS\"\n      },\n      0x002D: {\n        n: \"GRAPH\"\n      },\n      0x002E: {\n        n: \"NGRAPH\"\n      },\n      0x002F: {\n        n: \"CALCCOUNT\"\n      },\n      0x0030: {\n        n: \"UNFORMATTED\"\n      },\n      0x0031: {\n        n: \"CURSORW12\"\n      },\n      0x0032: {\n        n: \"WINDOW\"\n      },\n      0x0033: {\n        n: \"STRING\",\n        f: parse_LABEL\n      },\n      0x0037: {\n        n: \"PASSWORD\"\n      },\n      0x0038: {\n        n: \"LOCKED\"\n      },\n      0x003C: {\n        n: \"QUERY\"\n      },\n      0x003D: {\n        n: \"QUERYNAME\"\n      },\n      0x003E: {\n        n: \"PRINT\"\n      },\n      0x003F: {\n        n: \"PRINTNAME\"\n      },\n      0x0040: {\n        n: \"GRAPH2\"\n      },\n      0x0041: {\n        n: \"GRAPHNAME\"\n      },\n      0x0042: {\n        n: \"ZOOM\"\n      },\n      0x0043: {\n        n: \"SYMSPLIT\"\n      },\n      0x0044: {\n        n: \"NSROWS\"\n      },\n      0x0045: {\n        n: \"NSCOLS\"\n      },\n      0x0046: {\n        n: \"RULER\"\n      },\n      0x0047: {\n        n: \"NNAME\"\n      },\n      0x0048: {\n        n: \"ACOMM\"\n      },\n      0x0049: {\n        n: \"AMACRO\"\n      },\n      0x004A: {\n        n: \"PARSE\"\n      },\n      0x0066: {\n        n: \"PRANGES??\"\n      },\n      0x0067: {\n        n: \"RRANGES??\"\n      },\n      0x0068: {\n        n: \"FNAME??\"\n      },\n      0x0069: {\n        n: \"MRANGES??\"\n      },\n      0x00CC: {\n        n: \"SHEETNAMECS\",\n        f: parse_SHEETNAMECS\n      },\n      0x00DE: {\n        n: \"SHEETNAMELP\",\n        f: parse_SHEETNAMELP\n      },\n      0xFFFF: {\n        n: \"\"\n      }\n    };\n    var WK3Enum = {\n      0x0000: {\n        n: \"BOF\"\n      },\n      0x0001: {\n        n: \"EOF\"\n      },\n      0x0002: {\n        n: \"PASSWORD\"\n      },\n      0x0003: {\n        n: \"CALCSET\"\n      },\n      0x0004: {\n        n: \"WINDOWSET\"\n      },\n      0x0005: {\n        n: \"SHEETCELLPTR\"\n      },\n      0x0006: {\n        n: \"SHEETLAYOUT\"\n      },\n      0x0007: {\n        n: \"COLUMNWIDTH\"\n      },\n      0x0008: {\n        n: \"HIDDENCOLUMN\"\n      },\n      0x0009: {\n        n: \"USERRANGE\"\n      },\n      0x000A: {\n        n: \"SYSTEMRANGE\"\n      },\n      0x000B: {\n        n: \"ZEROFORCE\"\n      },\n      0x000C: {\n        n: \"SORTKEYDIR\"\n      },\n      0x000D: {\n        n: \"FILESEAL\"\n      },\n      0x000E: {\n        n: \"DATAFILLNUMS\"\n      },\n      0x000F: {\n        n: \"PRINTMAIN\"\n      },\n      0x0010: {\n        n: \"PRINTSTRING\"\n      },\n      0x0011: {\n        n: \"GRAPHMAIN\"\n      },\n      0x0012: {\n        n: \"GRAPHSTRING\"\n      },\n      0x0013: {\n        n: \"??\"\n      },\n      0x0014: {\n        n: \"ERRCELL\"\n      },\n      0x0015: {\n        n: \"NACELL\"\n      },\n      0x0016: {\n        n: \"LABEL16\",\n        f: parse_LABEL_16\n      },\n      0x0017: {\n        n: \"NUMBER17\",\n        f: parse_NUMBER_17\n      },\n      0x0018: {\n        n: \"NUMBER18\",\n        f: parse_NUMBER_18\n      },\n      0x0019: {\n        n: \"FORMULA19\",\n        f: parse_FORMULA_19\n      },\n      0x001A: {\n        n: \"FORMULA1A\"\n      },\n      0x001B: {\n        n: \"XFORMAT\",\n        f: parse_XFORMAT\n      },\n      0x001C: {\n        n: \"DTLABELMISC\"\n      },\n      0x001D: {\n        n: \"DTLABELCELL\"\n      },\n      0x001E: {\n        n: \"GRAPHWINDOW\"\n      },\n      0x001F: {\n        n: \"CPA\"\n      },\n      0x0020: {\n        n: \"LPLAUTO\"\n      },\n      0x0021: {\n        n: \"QUERY\"\n      },\n      0x0022: {\n        n: \"HIDDENSHEET\"\n      },\n      0x0023: {\n        n: \"??\"\n      },\n      0x0025: {\n        n: \"NUMBER25\",\n        f: parse_NUMBER_25\n      },\n      0x0026: {\n        n: \"??\"\n      },\n      0x0027: {\n        n: \"NUMBER27\",\n        f: parse_NUMBER_27\n      },\n      0x0028: {\n        n: \"FORMULA28\",\n        f: parse_FORMULA_28\n      },\n      0x008E: {\n        n: \"??\"\n      },\n      0x0093: {\n        n: \"??\"\n      },\n      0x0096: {\n        n: \"??\"\n      },\n      0x0097: {\n        n: \"??\"\n      },\n      0x0098: {\n        n: \"??\"\n      },\n      0x0099: {\n        n: \"??\"\n      },\n      0x009A: {\n        n: \"??\"\n      },\n      0x009B: {\n        n: \"??\"\n      },\n      0x009C: {\n        n: \"??\"\n      },\n      0x00A3: {\n        n: \"??\"\n      },\n      0x00AE: {\n        n: \"??\"\n      },\n      0x00AF: {\n        n: \"??\"\n      },\n      0x00B0: {\n        n: \"??\"\n      },\n      0x00B1: {\n        n: \"??\"\n      },\n      0x00B8: {\n        n: \"??\"\n      },\n      0x00B9: {\n        n: \"??\"\n      },\n      0x00BA: {\n        n: \"??\"\n      },\n      0x00BB: {\n        n: \"??\"\n      },\n      0x00BC: {\n        n: \"??\"\n      },\n      0x00C3: {\n        n: \"??\"\n      },\n      0x00C9: {\n        n: \"??\"\n      },\n      0x00CC: {\n        n: \"SHEETNAMECS\",\n        f: parse_SHEETNAMECS\n      },\n      0x00CD: {\n        n: \"??\"\n      },\n      0x00CE: {\n        n: \"??\"\n      },\n      0x00CF: {\n        n: \"??\"\n      },\n      0x00D0: {\n        n: \"??\"\n      },\n      0x0100: {\n        n: \"??\"\n      },\n      0x0103: {\n        n: \"??\"\n      },\n      0x0104: {\n        n: \"??\"\n      },\n      0x0105: {\n        n: \"??\"\n      },\n      0x0106: {\n        n: \"??\"\n      },\n      0x0107: {\n        n: \"??\"\n      },\n      0x0109: {\n        n: \"??\"\n      },\n      0x010A: {\n        n: \"??\"\n      },\n      0x010B: {\n        n: \"??\"\n      },\n      0x010C: {\n        n: \"??\"\n      },\n      0x010E: {\n        n: \"??\"\n      },\n      0x010F: {\n        n: \"??\"\n      },\n      0x0180: {\n        n: \"??\"\n      },\n      0x0185: {\n        n: \"??\"\n      },\n      0x0186: {\n        n: \"??\"\n      },\n      0x0189: {\n        n: \"??\"\n      },\n      0x018C: {\n        n: \"??\"\n      },\n      0x0200: {\n        n: \"??\"\n      },\n      0x0202: {\n        n: \"??\"\n      },\n      0x0201: {\n        n: \"??\"\n      },\n      0x0204: {\n        n: \"??\"\n      },\n      0x0205: {\n        n: \"??\"\n      },\n      0x0280: {\n        n: \"??\"\n      },\n      0x0281: {\n        n: \"??\"\n      },\n      0x0282: {\n        n: \"??\"\n      },\n      0x0283: {\n        n: \"??\"\n      },\n      0x0284: {\n        n: \"??\"\n      },\n      0x0285: {\n        n: \"??\"\n      },\n      0x0286: {\n        n: \"??\"\n      },\n      0x0287: {\n        n: \"??\"\n      },\n      0x0288: {\n        n: \"??\"\n      },\n      0x0292: {\n        n: \"??\"\n      },\n      0x0293: {\n        n: \"??\"\n      },\n      0x0294: {\n        n: \"??\"\n      },\n      0x0295: {\n        n: \"??\"\n      },\n      0x0296: {\n        n: \"??\"\n      },\n      0x0299: {\n        n: \"??\"\n      },\n      0x029A: {\n        n: \"??\"\n      },\n      0x0300: {\n        n: \"??\"\n      },\n      0x0304: {\n        n: \"??\"\n      },\n      0x0601: {\n        n: \"SHEETINFOQP\",\n        f: parse_SHEETINFOQP\n      },\n      0x0640: {\n        n: \"??\"\n      },\n      0x0642: {\n        n: \"??\"\n      },\n      0x0701: {\n        n: \"??\"\n      },\n      0x0702: {\n        n: \"??\"\n      },\n      0x0703: {\n        n: \"??\"\n      },\n      0x0704: {\n        n: \"??\"\n      },\n      0x0780: {\n        n: \"??\"\n      },\n      0x0800: {\n        n: \"??\"\n      },\n      0x0801: {\n        n: \"??\"\n      },\n      0x0804: {\n        n: \"??\"\n      },\n      0x0A80: {\n        n: \"??\"\n      },\n      0x2AF6: {\n        n: \"??\"\n      },\n      0x3231: {\n        n: \"??\"\n      },\n      0x6E49: {\n        n: \"??\"\n      },\n      0x6F44: {\n        n: \"??\"\n      },\n      0xFFFF: {\n        n: \"\"\n      }\n    };\n    return {\n      sheet_to_wk1: sheet_to_wk1,\n      book_to_wk3: book_to_wk3,\n      to_workbook: lotus_to_workbook\n    };\n  }();\n  /* 18.4.7 rPr CT_RPrElt */\n  function parse_rpr(rpr) {\n    var font = {},\n      m = rpr.match(tagregex),\n      i = 0;\n    var pass = false;\n    if (m) for (; i != m.length; ++i) {\n      var y = parsexmltag(m[i]);\n      switch (y[0].replace(/\\w*:/g, \"\")) {\n        /* 18.8.12 condense CT_BooleanProperty */\n        /* ** not required . */\n        case '<condense':\n          break;\n        /* 18.8.17 extend CT_BooleanProperty */\n        /* ** not required . */\n        case '<extend':\n          break;\n        /* 18.8.36 shadow CT_BooleanProperty */\n        /* ** not required . */\n        case '<shadow':\n          if (!y.val) break;\n        /* falls through */\n        case '<shadow>':\n        case '<shadow/>':\n          font.shadow = 1;\n          break;\n        case '</shadow>':\n          break;\n\n        /* 18.4.1 charset CT_IntProperty TODO */\n        case '<charset':\n          if (y.val == '1') break;\n          font.cp = CS2CP[parseInt(y.val, 10)];\n          break;\n\n        /* 18.4.2 outline CT_BooleanProperty TODO */\n        case '<outline':\n          if (!y.val) break;\n        /* falls through */\n        case '<outline>':\n        case '<outline/>':\n          font.outline = 1;\n          break;\n        case '</outline>':\n          break;\n\n        /* 18.4.5 rFont CT_FontName */\n        case '<rFont':\n          font.name = y.val;\n          break;\n\n        /* 18.4.11 sz CT_FontSize */\n        case '<sz':\n          font.sz = y.val;\n          break;\n\n        /* 18.4.10 strike CT_BooleanProperty */\n        case '<strike':\n          if (!y.val) break;\n        /* falls through */\n        case '<strike>':\n        case '<strike/>':\n          font.strike = 1;\n          break;\n        case '</strike>':\n          break;\n\n        /* 18.4.13 u CT_UnderlineProperty */\n        case '<u':\n          if (!y.val) break;\n          switch (y.val) {\n            case 'double':\n              font.uval = \"double\";\n              break;\n            case 'singleAccounting':\n              font.uval = \"single-accounting\";\n              break;\n            case 'doubleAccounting':\n              font.uval = \"double-accounting\";\n              break;\n          }\n        /* falls through */\n        case '<u>':\n        case '<u/>':\n          font.u = 1;\n          break;\n        case '</u>':\n          break;\n\n        /* 18.8.2 b */\n        case '<b':\n          if (y.val == '0') break;\n        /* falls through */\n        case '<b>':\n        case '<b/>':\n          font.b = 1;\n          break;\n        case '</b>':\n          break;\n\n        /* 18.8.26 i */\n        case '<i':\n          if (y.val == '0') break;\n        /* falls through */\n        case '<i>':\n        case '<i/>':\n          font.i = 1;\n          break;\n        case '</i>':\n          break;\n\n        /* 18.3.1.15 color CT_Color TODO: tint, theme, auto, indexed */\n        case '<color':\n          if (y.rgb) font.color = y.rgb.slice(2, 8);\n          break;\n        case '<color>':\n        case '<color/>':\n        case '</color>':\n          break;\n\n        /* 18.8.18 family ST_FontFamily */\n        case '<family':\n          font.family = y.val;\n          break;\n        case '<family>':\n        case '<family/>':\n        case '</family>':\n          break;\n\n        /* 18.4.14 vertAlign CT_VerticalAlignFontProperty TODO */\n        case '<vertAlign':\n          font.valign = y.val;\n          break;\n        case '<vertAlign>':\n        case '<vertAlign/>':\n        case '</vertAlign>':\n          break;\n\n        /* 18.8.35 scheme CT_FontScheme TODO */\n        case '<scheme':\n          break;\n        case '<scheme>':\n        case '<scheme/>':\n        case '</scheme>':\n          break;\n\n        /* 18.2.10 extLst CT_ExtensionList ? */\n        case '<extLst':\n        case '<extLst>':\n        case '</extLst>':\n          break;\n        case '<ext':\n          pass = true;\n          break;\n        case '</ext>':\n          pass = false;\n          break;\n        default:\n          if (y[0].charCodeAt(1) !== 47 && !pass) throw new Error('Unrecognized rich format ' + y[0]);\n      }\n    }\n    return font;\n  }\n  var parse_rs = function () {\n    var tregex = matchtag(\"t\"),\n      rpregex = matchtag(\"rPr\");\n    /* 18.4.4 r CT_RElt */\n    function parse_r(r) {\n      /* 18.4.12 t ST_Xstring */\n      var t = r.match(tregex) /*, cp = 65001*/;\n      if (!t) return {\n        t: \"s\",\n        v: \"\"\n      };\n      var o = {\n        t: 's',\n        v: unescapexml(t[1])\n      };\n      var rpr = r.match(rpregex);\n      if (rpr) o.s = parse_rpr(rpr[1]);\n      return o;\n    }\n    var rregex = /<(?:\\w+:)?r>/g,\n      rend = /<\\/(?:\\w+:)?r>/;\n    return function parse_rs(rs) {\n      return rs.replace(rregex, \"\").split(rend).map(parse_r).filter(function (r) {\n        return r.v;\n      });\n    };\n  }();\n\n  /* Parse a list of <r> tags */\n  var rs_to_html = function parse_rs_factory() {\n    var nlregex = /(\\r\\n|\\n)/g;\n    function parse_rpr2(font, intro, outro) {\n      var style = [];\n      if (font.u) style.push(\"text-decoration: underline;\");\n      if (font.uval) style.push(\"text-underline-style:\" + font.uval + \";\");\n      if (font.sz) style.push(\"font-size:\" + font.sz + \"pt;\");\n      if (font.outline) style.push(\"text-effect: outline;\");\n      if (font.shadow) style.push(\"text-shadow: auto;\");\n      intro.push('<span style=\"' + style.join(\"\") + '\">');\n      if (font.b) {\n        intro.push(\"<b>\");\n        outro.push(\"</b>\");\n      }\n      if (font.i) {\n        intro.push(\"<i>\");\n        outro.push(\"</i>\");\n      }\n      if (font.strike) {\n        intro.push(\"<s>\");\n        outro.push(\"</s>\");\n      }\n      var align = font.valign || \"\";\n      if (align == \"superscript\" || align == \"super\") align = \"sup\";else if (align == \"subscript\") align = \"sub\";\n      if (align != \"\") {\n        intro.push(\"<\" + align + \">\");\n        outro.push(\"</\" + align + \">\");\n      }\n      outro.push(\"</span>\");\n      return font;\n    }\n\n    /* 18.4.4 r CT_RElt */\n    function r_to_html(r) {\n      var terms = [[], r.v, []];\n      if (!r.v) return \"\";\n      if (r.s) parse_rpr2(r.s, terms[0], terms[2]);\n      return terms[0].join(\"\") + terms[1].replace(nlregex, '<br/>') + terms[2].join(\"\");\n    }\n    return function parse_rs(rs) {\n      return rs.map(r_to_html).join(\"\");\n    };\n  }();\n\n  /* 18.4.8 si CT_Rst */\n  var sitregex = /<(?:\\w+:)?t[^>]*>([^<]*)<\\/(?:\\w+:)?t>/g,\n    sirregex = /<(?:\\w+:)?r>/;\n  var sirphregex = /<(?:\\w+:)?rPh.*?>([\\s\\S]*?)<\\/(?:\\w+:)?rPh>/g;\n  function parse_si(x, opts) {\n    var html = opts ? opts.cellHTML : true;\n    var z = {};\n    if (!x) return {\n      t: \"\"\n    };\n    //var y;\n    /* 18.4.12 t ST_Xstring (Plaintext String) */\n    // TODO: is whitespace actually valid here?\n    if (x.match(/^\\s*<(?:\\w+:)?t[^>]*>/)) {\n      z.t = unescapexml(utf8read(x.slice(x.indexOf(\">\") + 1).split(/<\\/(?:\\w+:)?t>/)[0] || \"\"));\n      z.r = utf8read(x);\n      if (html) z.h = escapehtml(z.t);\n    }\n    /* 18.4.4 r CT_RElt (Rich Text Run) */else if ( /*y = */x.match(sirregex)) {\n      z.r = utf8read(x);\n      z.t = unescapexml(utf8read((x.replace(sirphregex, '').match(sitregex) || []).join(\"\").replace(tagregex, \"\")));\n      if (html) z.h = rs_to_html(parse_rs(z.r));\n    }\n    /* 18.4.3 phoneticPr CT_PhoneticPr (TODO: needed for Asian support) */\n    /* 18.4.6 rPh CT_PhoneticRun (TODO: needed for Asian support) */\n    return z;\n  }\n\n  /* 18.4 Shared String Table */\n  var sstr0 = /<(?:\\w+:)?sst([^>]*)>([\\s\\S]*)<\\/(?:\\w+:)?sst>/;\n  var sstr1 = /<(?:\\w+:)?(?:si|sstItem)>/g;\n  var sstr2 = /<\\/(?:\\w+:)?(?:si|sstItem)>/;\n  function parse_sst_xml(data, opts) {\n    var s = [],\n      ss = \"\";\n    if (!data) return s;\n    /* 18.4.9 sst CT_Sst */\n    var sst = data.match(sstr0);\n    if (sst) {\n      ss = sst[2].replace(sstr1, \"\").split(sstr2);\n      for (var i = 0; i != ss.length; ++i) {\n        var o = parse_si(ss[i].trim(), opts);\n        if (o != null) s[s.length] = o;\n      }\n      sst = parsexmltag(sst[1]);\n      s.Count = sst.count;\n      s.Unique = sst.uniqueCount;\n    }\n    return s;\n  }\n  var straywsregex = /^\\s|\\s$|[\\t\\n\\r]/;\n  function write_sst_xml(sst, opts) {\n    if (!opts.bookSST) return \"\";\n    var o = [XML_HEADER];\n    o[o.length] = writextag('sst', null, {\n      xmlns: XMLNS_main[0],\n      count: sst.Count,\n      uniqueCount: sst.Unique\n    });\n    for (var i = 0; i != sst.length; ++i) {\n      if (sst[i] == null) continue;\n      var s = sst[i];\n      var sitag = \"<si>\";\n      if (s.r) sitag += s.r;else {\n        sitag += \"<t\";\n        if (!s.t) s.t = \"\";\n        if (s.t.match(straywsregex)) sitag += ' xml:space=\"preserve\"';\n        sitag += \">\" + escapexml(s.t) + \"</t>\";\n      }\n      sitag += \"</si>\";\n      o[o.length] = sitag;\n    }\n    if (o.length > 2) {\n      o[o.length] = '</sst>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n    return o.join(\"\");\n  }\n  /* [MS-XLSB] 2.4.221 BrtBeginSst */\n  function parse_BrtBeginSst(data) {\n    return [data.read_shift(4), data.read_shift(4)];\n  }\n\n  /* [MS-XLSB] 2.1.7.45 Shared Strings */\n  function parse_sst_bin(data, opts) {\n    var s = [];\n    var pass = false;\n    recordhopper(data, function hopper_sst(val, R, RT) {\n      switch (RT) {\n        case 0x009F:\n          /* BrtBeginSst */\n          s.Count = val[0];\n          s.Unique = val[1];\n          break;\n        case 0x0013:\n          /* BrtSSTItem */\n          s.push(val);\n          break;\n        case 0x00A0:\n          /* BrtEndSst */\n          return true;\n        case 0x0023:\n          /* BrtFRTBegin */\n          pass = true;\n          break;\n        case 0x0024:\n          /* BrtFRTEnd */\n          pass = false;\n          break;\n        default:\n          if (R.T) {}\n          if (!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n      }\n    });\n    return s;\n  }\n  function write_BrtBeginSst(sst, o) {\n    if (!o) o = new_buf(8);\n    o.write_shift(4, sst.Count);\n    o.write_shift(4, sst.Unique);\n    return o;\n  }\n  var write_BrtSSTItem = write_RichStr;\n  function write_sst_bin(sst) {\n    var ba = buf_array();\n    write_record(ba, 0x009F /* BrtBeginSst */, write_BrtBeginSst(sst));\n    for (var i = 0; i < sst.length; ++i) write_record(ba, 0x0013 /* BrtSSTItem */, write_BrtSSTItem(sst[i]));\n    /* FRTSST */\n    write_record(ba, 0x00A0 /* BrtEndSst */);\n    return ba.end();\n  }\n  function _JS2ANSI(str) {\n    if (typeof $cptable !== 'undefined') return $cptable.utils.encode(current_ansi, str);\n    var o = [],\n      oo = str.split(\"\");\n    for (var i = 0; i < oo.length; ++i) o[i] = oo[i].charCodeAt(0);\n    return o;\n  }\n\n  /* [MS-OFFCRYPTO] 2.1.4 Version */\n  function parse_CRYPTOVersion(blob, length) {\n    var o = {};\n    o.Major = blob.read_shift(2);\n    o.Minor = blob.read_shift(2);\n    if (length >= 4) blob.l += length - 4;\n    return o;\n  }\n\n  /* [MS-OFFCRYPTO] 2.1.5 DataSpaceVersionInfo */\n  function parse_DataSpaceVersionInfo(blob) {\n    var o = {};\n    o.id = blob.read_shift(0, 'lpp4');\n    o.R = parse_CRYPTOVersion(blob, 4);\n    o.U = parse_CRYPTOVersion(blob, 4);\n    o.W = parse_CRYPTOVersion(blob, 4);\n    return o;\n  }\n\n  /* [MS-OFFCRYPTO] 2.1.6.1 DataSpaceMapEntry Structure */\n  function parse_DataSpaceMapEntry(blob) {\n    var len = blob.read_shift(4);\n    var end = blob.l + len - 4;\n    var o = {};\n    var cnt = blob.read_shift(4);\n    var comps = [];\n    /* [MS-OFFCRYPTO] 2.1.6.2 DataSpaceReferenceComponent Structure */\n    while (cnt-- > 0) comps.push({\n      t: blob.read_shift(4),\n      v: blob.read_shift(0, 'lpp4')\n    });\n    o.name = blob.read_shift(0, 'lpp4');\n    o.comps = comps;\n    if (blob.l != end) throw new Error(\"Bad DataSpaceMapEntry: \" + blob.l + \" != \" + end);\n    return o;\n  }\n\n  /* [MS-OFFCRYPTO] 2.1.6 DataSpaceMap */\n  function parse_DataSpaceMap(blob) {\n    var o = [];\n    blob.l += 4; // must be 0x8\n    var cnt = blob.read_shift(4);\n    while (cnt-- > 0) o.push(parse_DataSpaceMapEntry(blob));\n    return o;\n  }\n\n  /* [MS-OFFCRYPTO] 2.1.7 DataSpaceDefinition */\n  function parse_DataSpaceDefinition(blob) {\n    var o = [];\n    blob.l += 4; // must be 0x8\n    var cnt = blob.read_shift(4);\n    while (cnt-- > 0) o.push(blob.read_shift(0, 'lpp4'));\n    return o;\n  }\n\n  /* [MS-OFFCRYPTO] 2.1.8 DataSpaceDefinition */\n  function parse_TransformInfoHeader(blob) {\n    var o = {};\n    /*var len = */\n    blob.read_shift(4);\n    blob.l += 4; // must be 0x1\n    o.id = blob.read_shift(0, 'lpp4');\n    o.name = blob.read_shift(0, 'lpp4');\n    o.R = parse_CRYPTOVersion(blob, 4);\n    o.U = parse_CRYPTOVersion(blob, 4);\n    o.W = parse_CRYPTOVersion(blob, 4);\n    return o;\n  }\n  function parse_Primary(blob) {\n    /* [MS-OFFCRYPTO] 2.2.6 IRMDSTransformInfo */\n    var hdr = parse_TransformInfoHeader(blob);\n    /* [MS-OFFCRYPTO] 2.1.9 EncryptionTransformInfo */\n    hdr.ename = blob.read_shift(0, '8lpp4');\n    hdr.blksz = blob.read_shift(4);\n    hdr.cmode = blob.read_shift(4);\n    if (blob.read_shift(4) != 0x04) throw new Error(\"Bad !Primary record\");\n    return hdr;\n  }\n\n  /* [MS-OFFCRYPTO] 2.3.2 Encryption Header */\n  function parse_EncryptionHeader(blob, length) {\n    var tgt = blob.l + length;\n    var o = {};\n    o.Flags = blob.read_shift(4) & 0x3F;\n    blob.l += 4;\n    o.AlgID = blob.read_shift(4);\n    var valid = false;\n    switch (o.AlgID) {\n      case 0x660E:\n      case 0x660F:\n      case 0x6610:\n        valid = o.Flags == 0x24;\n        break;\n      case 0x6801:\n        valid = o.Flags == 0x04;\n        break;\n      case 0:\n        valid = o.Flags == 0x10 || o.Flags == 0x04 || o.Flags == 0x24;\n        break;\n      default:\n        throw 'Unrecognized encryption algorithm: ' + o.AlgID;\n    }\n    if (!valid) throw new Error(\"Encryption Flags/AlgID mismatch\");\n    o.AlgIDHash = blob.read_shift(4);\n    o.KeySize = blob.read_shift(4);\n    o.ProviderType = blob.read_shift(4);\n    blob.l += 8;\n    o.CSPName = blob.read_shift(tgt - blob.l >> 1, 'utf16le');\n    blob.l = tgt;\n    return o;\n  }\n\n  /* [MS-OFFCRYPTO] 2.3.3 Encryption Verifier */\n  function parse_EncryptionVerifier(blob, length) {\n    var o = {},\n      tgt = blob.l + length;\n    blob.l += 4; // SaltSize must be 0x10\n    o.Salt = blob.slice(blob.l, blob.l + 16);\n    blob.l += 16;\n    o.Verifier = blob.slice(blob.l, blob.l + 16);\n    blob.l += 16;\n    /*var sz = */\n    blob.read_shift(4);\n    o.VerifierHash = blob.slice(blob.l, tgt);\n    blob.l = tgt;\n    return o;\n  }\n\n  /* [MS-OFFCRYPTO] 2.3.4.* EncryptionInfo Stream */\n  function parse_EncryptionInfo(blob) {\n    var vers = parse_CRYPTOVersion(blob);\n    switch (vers.Minor) {\n      case 0x02:\n        return [vers.Minor, parse_EncInfoStd(blob, vers)];\n      case 0x03:\n        return [vers.Minor, parse_EncInfoExt(blob, vers)];\n      case 0x04:\n        return [vers.Minor, parse_EncInfoAgl(blob, vers)];\n    }\n    throw new Error(\"ECMA-376 Encrypted file unrecognized Version: \" + vers.Minor);\n  }\n\n  /* [MS-OFFCRYPTO] 2.3.4.5  EncryptionInfo Stream (Standard Encryption) */\n  function parse_EncInfoStd(blob) {\n    var flags = blob.read_shift(4);\n    if ((flags & 0x3F) != 0x24) throw new Error(\"EncryptionInfo mismatch\");\n    var sz = blob.read_shift(4);\n    //var tgt = blob.l + sz;\n    var hdr = parse_EncryptionHeader(blob, sz);\n    var verifier = parse_EncryptionVerifier(blob, blob.length - blob.l);\n    return {\n      t: \"Std\",\n      h: hdr,\n      v: verifier\n    };\n  }\n  /* [MS-OFFCRYPTO] 2.3.4.6  EncryptionInfo Stream (Extensible Encryption) */\n  function parse_EncInfoExt() {\n    throw new Error(\"File is password-protected: ECMA-376 Extensible\");\n  }\n  /* [MS-OFFCRYPTO] 2.3.4.10 EncryptionInfo Stream (Agile Encryption) */\n  function parse_EncInfoAgl(blob) {\n    var KeyData = [\"saltSize\", \"blockSize\", \"keyBits\", \"hashSize\", \"cipherAlgorithm\", \"cipherChaining\", \"hashAlgorithm\", \"saltValue\"];\n    blob.l += 4;\n    var xml = blob.read_shift(blob.length - blob.l, 'utf8');\n    var o = {};\n    xml.replace(tagregex, function xml_agile(x) {\n      var y = parsexmltag(x);\n      switch (strip_ns(y[0])) {\n        case '<?xml':\n          break;\n        case '<encryption':\n        case '</encryption>':\n          break;\n        case '<keyData':\n          KeyData.forEach(function (k) {\n            o[k] = y[k];\n          });\n          break;\n        case '<dataIntegrity':\n          o.encryptedHmacKey = y.encryptedHmacKey;\n          o.encryptedHmacValue = y.encryptedHmacValue;\n          break;\n        case '<keyEncryptors>':\n        case '<keyEncryptors':\n          o.encs = [];\n          break;\n        case '</keyEncryptors>':\n          break;\n        case '<keyEncryptor':\n          o.uri = y.uri;\n          break;\n        case '</keyEncryptor>':\n          break;\n        case '<encryptedKey':\n          o.encs.push(y);\n          break;\n        default:\n          throw y[0];\n      }\n    });\n    return o;\n  }\n\n  /* [MS-OFFCRYPTO] 2.3.5.1 RC4 CryptoAPI Encryption Header */\n  function parse_RC4CryptoHeader(blob, length) {\n    var o = {};\n    var vers = o.EncryptionVersionInfo = parse_CRYPTOVersion(blob, 4);\n    length -= 4;\n    if (vers.Minor != 2) throw new Error('unrecognized minor version code: ' + vers.Minor);\n    if (vers.Major > 4 || vers.Major < 2) throw new Error('unrecognized major version code: ' + vers.Major);\n    o.Flags = blob.read_shift(4);\n    length -= 4;\n    var sz = blob.read_shift(4);\n    length -= 4;\n    o.EncryptionHeader = parse_EncryptionHeader(blob, sz);\n    length -= sz;\n    o.EncryptionVerifier = parse_EncryptionVerifier(blob, length);\n    return o;\n  }\n  /* [MS-OFFCRYPTO] 2.3.6.1 RC4 Encryption Header */\n  function parse_RC4Header(blob) {\n    var o = {};\n    var vers = o.EncryptionVersionInfo = parse_CRYPTOVersion(blob, 4);\n    if (vers.Major != 1 || vers.Minor != 1) throw 'unrecognized version code ' + vers.Major + ' : ' + vers.Minor;\n    o.Salt = blob.read_shift(16);\n    o.EncryptedVerifier = blob.read_shift(16);\n    o.EncryptedVerifierHash = blob.read_shift(16);\n    return o;\n  }\n\n  /* [MS-OFFCRYPTO] 2.3.7.1 Binary Document Password Verifier Derivation */\n  function crypto_CreatePasswordVerifier_Method1(Password) {\n    var Verifier = 0x0000,\n      PasswordArray;\n    var PasswordDecoded = _JS2ANSI(Password);\n    var len = PasswordDecoded.length + 1,\n      i,\n      PasswordByte;\n    var Intermediate1, Intermediate2, Intermediate3;\n    PasswordArray = new_raw_buf(len);\n    PasswordArray[0] = PasswordDecoded.length;\n    for (i = 1; i != len; ++i) PasswordArray[i] = PasswordDecoded[i - 1];\n    for (i = len - 1; i >= 0; --i) {\n      PasswordByte = PasswordArray[i];\n      Intermediate1 = (Verifier & 0x4000) === 0x0000 ? 0 : 1;\n      Intermediate2 = Verifier << 1 & 0x7FFF;\n      Intermediate3 = Intermediate1 | Intermediate2;\n      Verifier = Intermediate3 ^ PasswordByte;\n    }\n    return Verifier ^ 0xCE4B;\n  }\n\n  /* [MS-OFFCRYPTO] 2.3.7.2 Binary Document XOR Array Initialization */\n  var crypto_CreateXorArray_Method1 = function () {\n    var PadArray = [0xBB, 0xFF, 0xFF, 0xBA, 0xFF, 0xFF, 0xB9, 0x80, 0x00, 0xBE, 0x0F, 0x00, 0xBF, 0x0F, 0x00];\n    var InitialCode = [0xE1F0, 0x1D0F, 0xCC9C, 0x84C0, 0x110C, 0x0E10, 0xF1CE, 0x313E, 0x1872, 0xE139, 0xD40F, 0x84F9, 0x280C, 0xA96A, 0x4EC3];\n    var XorMatrix = [0xAEFC, 0x4DD9, 0x9BB2, 0x2745, 0x4E8A, 0x9D14, 0x2A09, 0x7B61, 0xF6C2, 0xFDA5, 0xEB6B, 0xC6F7, 0x9DCF, 0x2BBF, 0x4563, 0x8AC6, 0x05AD, 0x0B5A, 0x16B4, 0x2D68, 0x5AD0, 0x0375, 0x06EA, 0x0DD4, 0x1BA8, 0x3750, 0x6EA0, 0xDD40, 0xD849, 0xA0B3, 0x5147, 0xA28E, 0x553D, 0xAA7A, 0x44D5, 0x6F45, 0xDE8A, 0xAD35, 0x4A4B, 0x9496, 0x390D, 0x721A, 0xEB23, 0xC667, 0x9CEF, 0x29FF, 0x53FE, 0xA7FC, 0x5FD9, 0x47D3, 0x8FA6, 0x0F6D, 0x1EDA, 0x3DB4, 0x7B68, 0xF6D0, 0xB861, 0x60E3, 0xC1C6, 0x93AD, 0x377B, 0x6EF6, 0xDDEC, 0x45A0, 0x8B40, 0x06A1, 0x0D42, 0x1A84, 0x3508, 0x6A10, 0xAA51, 0x4483, 0x8906, 0x022D, 0x045A, 0x08B4, 0x1168, 0x76B4, 0xED68, 0xCAF1, 0x85C3, 0x1BA7, 0x374E, 0x6E9C, 0x3730, 0x6E60, 0xDCC0, 0xA9A1, 0x4363, 0x86C6, 0x1DAD, 0x3331, 0x6662, 0xCCC4, 0x89A9, 0x0373, 0x06E6, 0x0DCC, 0x1021, 0x2042, 0x4084, 0x8108, 0x1231, 0x2462, 0x48C4];\n    var Ror = function (Byte) {\n      return (Byte / 2 | Byte * 128) & 0xFF;\n    };\n    var XorRor = function (byte1, byte2) {\n      return Ror(byte1 ^ byte2);\n    };\n    var CreateXorKey_Method1 = function (Password) {\n      var XorKey = InitialCode[Password.length - 1];\n      var CurrentElement = 0x68;\n      for (var i = Password.length - 1; i >= 0; --i) {\n        var Char = Password[i];\n        for (var j = 0; j != 7; ++j) {\n          if (Char & 0x40) XorKey ^= XorMatrix[CurrentElement];\n          Char *= 2;\n          --CurrentElement;\n        }\n      }\n      return XorKey;\n    };\n    return function (password) {\n      var Password = _JS2ANSI(password);\n      var XorKey = CreateXorKey_Method1(Password);\n      var Index = Password.length;\n      var ObfuscationArray = new_raw_buf(16);\n      for (var i = 0; i != 16; ++i) ObfuscationArray[i] = 0x00;\n      var Temp, PasswordLastChar, PadIndex;\n      if ((Index & 1) === 1) {\n        Temp = XorKey >> 8;\n        ObfuscationArray[Index] = XorRor(PadArray[0], Temp);\n        --Index;\n        Temp = XorKey & 0xFF;\n        PasswordLastChar = Password[Password.length - 1];\n        ObfuscationArray[Index] = XorRor(PasswordLastChar, Temp);\n      }\n      while (Index > 0) {\n        --Index;\n        Temp = XorKey >> 8;\n        ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n        --Index;\n        Temp = XorKey & 0xFF;\n        ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n      }\n      Index = 15;\n      PadIndex = 15 - Password.length;\n      while (PadIndex > 0) {\n        Temp = XorKey >> 8;\n        ObfuscationArray[Index] = XorRor(PadArray[PadIndex], Temp);\n        --Index;\n        --PadIndex;\n        Temp = XorKey & 0xFF;\n        ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n        --Index;\n        --PadIndex;\n      }\n      return ObfuscationArray;\n    };\n  }();\n\n  /* [MS-OFFCRYPTO] 2.3.7.3 Binary Document XOR Data Transformation Method 1 */\n  var crypto_DecryptData_Method1 = function (password, Data, XorArrayIndex, XorArray, O) {\n    /* If XorArray is set, use it; if O is not set, make changes in-place */\n    if (!O) O = Data;\n    if (!XorArray) XorArray = crypto_CreateXorArray_Method1(password);\n    var Index, Value;\n    for (Index = 0; Index != Data.length; ++Index) {\n      Value = Data[Index];\n      Value ^= XorArray[XorArrayIndex];\n      Value = (Value >> 5 | Value << 3) & 0xFF;\n      O[Index] = Value;\n      ++XorArrayIndex;\n    }\n    return [O, XorArrayIndex, XorArray];\n  };\n  var crypto_MakeXorDecryptor = function (password) {\n    var XorArrayIndex = 0,\n      XorArray = crypto_CreateXorArray_Method1(password);\n    return function (Data) {\n      var O = crypto_DecryptData_Method1(\"\", Data, XorArrayIndex, XorArray);\n      XorArrayIndex = O[1];\n      return O[0];\n    };\n  };\n\n  /* 2.5.343 */\n  function parse_XORObfuscation(blob, length, opts, out) {\n    var o = {\n      key: parseuint16(blob),\n      verificationBytes: parseuint16(blob)\n    };\n    if (opts.password) o.verifier = crypto_CreatePasswordVerifier_Method1(opts.password);\n    out.valid = o.verificationBytes === o.verifier;\n    if (out.valid) out.insitu = crypto_MakeXorDecryptor(opts.password);\n    return o;\n  }\n\n  /* 2.4.117 */\n  function parse_FilePassHeader(blob, length, oo) {\n    var o = oo || {};\n    o.Info = blob.read_shift(2);\n    blob.l -= 2;\n    if (o.Info === 1) o.Data = parse_RC4Header(blob, length);else o.Data = parse_RC4CryptoHeader(blob, length);\n    return o;\n  }\n  function parse_FilePass(blob, length, opts) {\n    var o = {\n      Type: opts.biff >= 8 ? blob.read_shift(2) : 0\n    }; /* wEncryptionType */\n    if (o.Type) parse_FilePassHeader(blob, length - 2, o);else parse_XORObfuscation(blob, opts.biff >= 8 ? length : length - 2, opts, o);\n    return o;\n  }\n  var RTF = function () {\n    function rtf_to_sheet(d, opts) {\n      switch (opts.type) {\n        case 'base64':\n          return rtf_to_sheet_str(Base64_decode(d), opts);\n        case 'binary':\n          return rtf_to_sheet_str(d, opts);\n        case 'buffer':\n          return rtf_to_sheet_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n        case 'array':\n          return rtf_to_sheet_str(cc2str(d), opts);\n      }\n      throw new Error(\"Unrecognized type \" + opts.type);\n    }\n\n    /* TODO: this is a stub */\n    function rtf_to_sheet_str(str, opts) {\n      var o = opts || {};\n      var ws = o.dense ? [] : {};\n      var rows = str.match(/\\\\trowd.*?\\\\row\\b/g);\n      if (!rows.length) throw new Error(\"RTF missing table\");\n      var range = {\n        s: {\n          c: 0,\n          r: 0\n        },\n        e: {\n          c: 0,\n          r: rows.length - 1\n        }\n      };\n      rows.forEach(function (rowtf, R) {\n        if (Array.isArray(ws)) ws[R] = [];\n        var rtfre = /\\\\\\w+\\b/g;\n        var last_index = 0;\n        var res;\n        var C = -1;\n        while (res = rtfre.exec(rowtf)) {\n          switch (res[0]) {\n            case \"\\\\cell\":\n              var data = rowtf.slice(last_index, rtfre.lastIndex - res[0].length);\n              if (data[0] == \" \") data = data.slice(1);\n              ++C;\n              if (data.length) {\n                // TODO: value parsing, including codepage adjustments\n                var cell = {\n                  v: data,\n                  t: \"s\"\n                };\n                if (Array.isArray(ws)) ws[R][C] = cell;else ws[encode_cell({\n                  r: R,\n                  c: C\n                })] = cell;\n              }\n              break;\n          }\n          last_index = rtfre.lastIndex;\n        }\n        if (C > range.e.c) range.e.c = C;\n      });\n      ws['!ref'] = encode_range(range);\n      return ws;\n    }\n    function rtf_to_workbook(d, opts) {\n      return sheet_to_workbook(rtf_to_sheet(d, opts), opts);\n    }\n\n    /* TODO: this is a stub */\n    function sheet_to_rtf(ws) {\n      var o = [\"{\\\\rtf1\\\\ansi\"];\n      var r = safe_decode_range(ws['!ref']),\n        cell;\n      var dense = Array.isArray(ws);\n      for (var R = r.s.r; R <= r.e.r; ++R) {\n        o.push(\"\\\\trowd\\\\trautofit1\");\n        for (var C = r.s.c; C <= r.e.c; ++C) o.push(\"\\\\cellx\" + (C + 1));\n        o.push(\"\\\\pard\\\\intbl\");\n        for (C = r.s.c; C <= r.e.c; ++C) {\n          var coord = encode_cell({\n            r: R,\n            c: C\n          });\n          cell = dense ? (ws[R] || [])[C] : ws[coord];\n          if (!cell || cell.v == null && (!cell.f || cell.F)) continue;\n          o.push(\" \" + (cell.w || (format_cell(cell), cell.w)));\n          o.push(\"\\\\cell\");\n        }\n        o.push(\"\\\\pard\\\\intbl\\\\row\");\n      }\n      return o.join(\"\") + \"}\";\n    }\n    return {\n      to_workbook: rtf_to_workbook,\n      to_sheet: rtf_to_sheet,\n      from_sheet: sheet_to_rtf\n    };\n  }();\n  function hex2RGB(h) {\n    var o = h.slice(h[0] === \"#\" ? 1 : 0).slice(0, 6);\n    return [parseInt(o.slice(0, 2), 16), parseInt(o.slice(2, 4), 16), parseInt(o.slice(4, 6), 16)];\n  }\n  function rgb2Hex(rgb) {\n    for (var i = 0, o = 1; i != 3; ++i) o = o * 256 + (rgb[i] > 255 ? 255 : rgb[i] < 0 ? 0 : rgb[i]);\n    return o.toString(16).toUpperCase().slice(1);\n  }\n  function rgb2HSL(rgb) {\n    var R = rgb[0] / 255,\n      G = rgb[1] / 255,\n      B = rgb[2] / 255;\n    var M = Math.max(R, G, B),\n      m = Math.min(R, G, B),\n      C = M - m;\n    if (C === 0) return [0, 0, R];\n    var H6 = 0,\n      S = 0,\n      L2 = M + m;\n    S = C / (L2 > 1 ? 2 - L2 : L2);\n    switch (M) {\n      case R:\n        H6 = ((G - B) / C + 6) % 6;\n        break;\n      case G:\n        H6 = (B - R) / C + 2;\n        break;\n      case B:\n        H6 = (R - G) / C + 4;\n        break;\n    }\n    return [H6 / 6, S, L2 / 2];\n  }\n  function hsl2RGB(hsl) {\n    var H = hsl[0],\n      S = hsl[1],\n      L = hsl[2];\n    var C = S * 2 * (L < 0.5 ? L : 1 - L),\n      m = L - C / 2;\n    var rgb = [m, m, m],\n      h6 = 6 * H;\n    var X;\n    if (S !== 0) switch (h6 | 0) {\n      case 0:\n      case 6:\n        X = C * h6;\n        rgb[0] += C;\n        rgb[1] += X;\n        break;\n      case 1:\n        X = C * (2 - h6);\n        rgb[0] += X;\n        rgb[1] += C;\n        break;\n      case 2:\n        X = C * (h6 - 2);\n        rgb[1] += C;\n        rgb[2] += X;\n        break;\n      case 3:\n        X = C * (4 - h6);\n        rgb[1] += X;\n        rgb[2] += C;\n        break;\n      case 4:\n        X = C * (h6 - 4);\n        rgb[2] += C;\n        rgb[0] += X;\n        break;\n      case 5:\n        X = C * (6 - h6);\n        rgb[2] += X;\n        rgb[0] += C;\n        break;\n    }\n    for (var i = 0; i != 3; ++i) rgb[i] = Math.round(rgb[i] * 255);\n    return rgb;\n  }\n\n  /* 18.8.3 bgColor tint algorithm */\n  function rgb_tint(hex, tint) {\n    if (tint === 0) return hex;\n    var hsl = rgb2HSL(hex2RGB(hex));\n    if (tint < 0) hsl[2] = hsl[2] * (1 + tint);else hsl[2] = 1 - (1 - hsl[2]) * (1 - tint);\n    return rgb2Hex(hsl2RGB(hsl));\n  }\n\n  /* 18.3.1.13 width calculations */\n  /* [MS-OI29500] 2.1.595 Column Width & Formatting */\n  var DEF_MDW = 6,\n    MAX_MDW = 15,\n    MIN_MDW = 1,\n    MDW = DEF_MDW;\n  function width2px(width) {\n    return Math.floor((width + Math.round(128 / MDW) / 256) * MDW);\n  }\n  function px2char(px) {\n    return Math.floor((px - 5) / MDW * 100 + 0.5) / 100;\n  }\n  function char2width(chr) {\n    return Math.round((chr * MDW + 5) / MDW * 256) / 256;\n  }\n  //function px2char_(px) { return (((px - 5)/MDW * 100 + 0.5))/100; }\n  //function char2width_(chr) { return (((chr * MDW + 5)/MDW*256))/256; }\n  function cycle_width(collw) {\n    return char2width(px2char(width2px(collw)));\n  }\n  /* XLSX/XLSB/XLS specify width in units of MDW */\n  function find_mdw_colw(collw) {\n    var delta = Math.abs(collw - cycle_width(collw)),\n      _MDW = MDW;\n    if (delta > 0.005) for (MDW = MIN_MDW; MDW < MAX_MDW; ++MDW) if (Math.abs(collw - cycle_width(collw)) <= delta) {\n      delta = Math.abs(collw - cycle_width(collw));\n      _MDW = MDW;\n    }\n    MDW = _MDW;\n  }\n  /* XLML specifies width in terms of pixels */\n  /*function find_mdw_wpx(wpx) {\n  \tvar delta = Infinity, guess = 0, _MDW = MIN_MDW;\n  \tfor(MDW=MIN_MDW; MDW<MAX_MDW; ++MDW) {\n  \t\tguess = char2width_(px2char_(wpx))*256;\n  \t\tguess = (guess) % 1;\n  \t\tif(guess > 0.5) guess--;\n  \t\tif(Math.abs(guess) < delta) { delta = Math.abs(guess); _MDW = MDW; }\n  \t}\n  \tMDW = _MDW;\n  }*/\n\n  function process_col(coll) {\n    if (coll.width) {\n      coll.wpx = width2px(coll.width);\n      coll.wch = px2char(coll.wpx);\n      coll.MDW = MDW;\n    } else if (coll.wpx) {\n      coll.wch = px2char(coll.wpx);\n      coll.width = char2width(coll.wch);\n      coll.MDW = MDW;\n    } else if (typeof coll.wch == 'number') {\n      coll.width = char2width(coll.wch);\n      coll.wpx = width2px(coll.width);\n      coll.MDW = MDW;\n    }\n    if (coll.customWidth) delete coll.customWidth;\n  }\n  var DEF_PPI = 96,\n    PPI = DEF_PPI;\n  function px2pt(px) {\n    return px * 96 / PPI;\n  }\n  function pt2px(pt) {\n    return pt * PPI / 96;\n  }\n\n  /* [MS-EXSPXML3] 2.4.54 ST_enmPattern */\n  var XLMLPatternTypeMap = {\n    \"None\": \"none\",\n    \"Solid\": \"solid\",\n    \"Gray50\": \"mediumGray\",\n    \"Gray75\": \"darkGray\",\n    \"Gray25\": \"lightGray\",\n    \"HorzStripe\": \"darkHorizontal\",\n    \"VertStripe\": \"darkVertical\",\n    \"ReverseDiagStripe\": \"darkDown\",\n    \"DiagStripe\": \"darkUp\",\n    \"DiagCross\": \"darkGrid\",\n    \"ThickDiagCross\": \"darkTrellis\",\n    \"ThinHorzStripe\": \"lightHorizontal\",\n    \"ThinVertStripe\": \"lightVertical\",\n    \"ThinReverseDiagStripe\": \"lightDown\",\n    \"ThinHorzCross\": \"lightGrid\"\n  };\n\n  /* 18.8.5 borders CT_Borders */\n  function parse_borders(t, styles, themes, opts) {\n    styles.Borders = [];\n    var border = {};\n    var pass = false;\n    (t[0].match(tagregex) || []).forEach(function (x) {\n      var y = parsexmltag(x);\n      switch (strip_ns(y[0])) {\n        case '<borders':\n        case '<borders>':\n        case '</borders>':\n          break;\n\n        /* 18.8.4 border CT_Border */\n        case '<border':\n        case '<border>':\n        case '<border/>':\n          border = {};\n          if (y.diagonalUp) border.diagonalUp = parsexmlbool(y.diagonalUp);\n          if (y.diagonalDown) border.diagonalDown = parsexmlbool(y.diagonalDown);\n          styles.Borders.push(border);\n          break;\n        case '</border>':\n          break;\n\n        /* note: not in spec, appears to be CT_BorderPr */\n        case '<left/>':\n          break;\n        case '<left':\n        case '<left>':\n          break;\n        case '</left>':\n          break;\n\n        /* note: not in spec, appears to be CT_BorderPr */\n        case '<right/>':\n          break;\n        case '<right':\n        case '<right>':\n          break;\n        case '</right>':\n          break;\n\n        /* 18.8.43 top CT_BorderPr */\n        case '<top/>':\n          break;\n        case '<top':\n        case '<top>':\n          break;\n        case '</top>':\n          break;\n\n        /* 18.8.6 bottom CT_BorderPr */\n        case '<bottom/>':\n          break;\n        case '<bottom':\n        case '<bottom>':\n          break;\n        case '</bottom>':\n          break;\n\n        /* 18.8.13 diagonal CT_BorderPr */\n        case '<diagonal':\n        case '<diagonal>':\n        case '<diagonal/>':\n          break;\n        case '</diagonal>':\n          break;\n\n        /* 18.8.25 horizontal CT_BorderPr */\n        case '<horizontal':\n        case '<horizontal>':\n        case '<horizontal/>':\n          break;\n        case '</horizontal>':\n          break;\n\n        /* 18.8.44 vertical CT_BorderPr */\n        case '<vertical':\n        case '<vertical>':\n        case '<vertical/>':\n          break;\n        case '</vertical>':\n          break;\n\n        /* 18.8.37 start CT_BorderPr */\n        case '<start':\n        case '<start>':\n        case '<start/>':\n          break;\n        case '</start>':\n          break;\n\n        /* 18.8.16 end CT_BorderPr */\n        case '<end':\n        case '<end>':\n        case '<end/>':\n          break;\n        case '</end>':\n          break;\n\n        /* 18.8.? color CT_Color */\n        case '<color':\n        case '<color>':\n          break;\n        case '<color/>':\n        case '</color>':\n          break;\n\n        /* 18.2.10 extLst CT_ExtensionList ? */\n        case '<extLst':\n        case '<extLst>':\n        case '</extLst>':\n          break;\n        case '<ext':\n          pass = true;\n          break;\n        case '</ext>':\n          pass = false;\n          break;\n        default:\n          if (opts && opts.WTF) {\n            if (!pass) throw new Error('unrecognized ' + y[0] + ' in borders');\n          }\n      }\n    });\n  }\n\n  /* 18.8.21 fills CT_Fills */\n  function parse_fills(t, styles, themes, opts) {\n    styles.Fills = [];\n    var fill = {};\n    var pass = false;\n    (t[0].match(tagregex) || []).forEach(function (x) {\n      var y = parsexmltag(x);\n      switch (strip_ns(y[0])) {\n        case '<fills':\n        case '<fills>':\n        case '</fills>':\n          break;\n\n        /* 18.8.20 fill CT_Fill */\n        case '<fill>':\n        case '<fill':\n        case '<fill/>':\n          fill = {};\n          styles.Fills.push(fill);\n          break;\n        case '</fill>':\n          break;\n\n        /* 18.8.24 gradientFill CT_GradientFill */\n        case '<gradientFill>':\n          break;\n        case '<gradientFill':\n        case '</gradientFill>':\n          styles.Fills.push(fill);\n          fill = {};\n          break;\n\n        /* 18.8.32 patternFill CT_PatternFill */\n        case '<patternFill':\n        case '<patternFill>':\n          if (y.patternType) fill.patternType = y.patternType;\n          break;\n        case '<patternFill/>':\n        case '</patternFill>':\n          break;\n\n        /* 18.8.3 bgColor CT_Color */\n        case '<bgColor':\n          if (!fill.bgColor) fill.bgColor = {};\n          if (y.indexed) fill.bgColor.indexed = parseInt(y.indexed, 10);\n          if (y.theme) fill.bgColor.theme = parseInt(y.theme, 10);\n          if (y.tint) fill.bgColor.tint = parseFloat(y.tint);\n          /* Excel uses ARGB strings */\n          if (y.rgb) fill.bgColor.rgb = y.rgb.slice(-6);\n          break;\n        case '<bgColor/>':\n        case '</bgColor>':\n          break;\n\n        /* 18.8.19 fgColor CT_Color */\n        case '<fgColor':\n          if (!fill.fgColor) fill.fgColor = {};\n          if (y.theme) fill.fgColor.theme = parseInt(y.theme, 10);\n          if (y.tint) fill.fgColor.tint = parseFloat(y.tint);\n          /* Excel uses ARGB strings */\n          if (y.rgb != null) fill.fgColor.rgb = y.rgb.slice(-6);\n          break;\n        case '<fgColor/>':\n        case '</fgColor>':\n          break;\n\n        /* 18.8.38 stop CT_GradientStop */\n        case '<stop':\n        case '<stop/>':\n          break;\n        case '</stop>':\n          break;\n\n        /* 18.8.? color CT_Color */\n        case '<color':\n        case '<color/>':\n          break;\n        case '</color>':\n          break;\n\n        /* 18.2.10 extLst CT_ExtensionList ? */\n        case '<extLst':\n        case '<extLst>':\n        case '</extLst>':\n          break;\n        case '<ext':\n          pass = true;\n          break;\n        case '</ext>':\n          pass = false;\n          break;\n        default:\n          if (opts && opts.WTF) {\n            if (!pass) throw new Error('unrecognized ' + y[0] + ' in fills');\n          }\n      }\n    });\n  }\n\n  /* 18.8.23 fonts CT_Fonts */\n  function parse_fonts(t, styles, themes, opts) {\n    styles.Fonts = [];\n    var font = {};\n    var pass = false;\n    (t[0].match(tagregex) || []).forEach(function (x) {\n      var y = parsexmltag(x);\n      switch (strip_ns(y[0])) {\n        case '<fonts':\n        case '<fonts>':\n        case '</fonts>':\n          break;\n\n        /* 18.8.22 font CT_Font */\n        case '<font':\n        case '<font>':\n          break;\n        case '</font>':\n        case '<font/>':\n          styles.Fonts.push(font);\n          font = {};\n          break;\n\n        /* 18.8.29 name CT_FontName */\n        case '<name':\n          if (y.val) font.name = utf8read(y.val);\n          break;\n        case '<name/>':\n        case '</name>':\n          break;\n\n        /* 18.8.2  b CT_BooleanProperty */\n        case '<b':\n          font.bold = y.val ? parsexmlbool(y.val) : 1;\n          break;\n        case '<b/>':\n          font.bold = 1;\n          break;\n\n        /* 18.8.26 i CT_BooleanProperty */\n        case '<i':\n          font.italic = y.val ? parsexmlbool(y.val) : 1;\n          break;\n        case '<i/>':\n          font.italic = 1;\n          break;\n\n        /* 18.4.13 u CT_UnderlineProperty */\n        case '<u':\n          switch (y.val) {\n            case \"none\":\n              font.underline = 0x00;\n              break;\n            case \"single\":\n              font.underline = 0x01;\n              break;\n            case \"double\":\n              font.underline = 0x02;\n              break;\n            case \"singleAccounting\":\n              font.underline = 0x21;\n              break;\n            case \"doubleAccounting\":\n              font.underline = 0x22;\n              break;\n          }\n          break;\n        case '<u/>':\n          font.underline = 1;\n          break;\n\n        /* 18.4.10 strike CT_BooleanProperty */\n        case '<strike':\n          font.strike = y.val ? parsexmlbool(y.val) : 1;\n          break;\n        case '<strike/>':\n          font.strike = 1;\n          break;\n\n        /* 18.4.2  outline CT_BooleanProperty */\n        case '<outline':\n          font.outline = y.val ? parsexmlbool(y.val) : 1;\n          break;\n        case '<outline/>':\n          font.outline = 1;\n          break;\n\n        /* 18.8.36 shadow CT_BooleanProperty */\n        case '<shadow':\n          font.shadow = y.val ? parsexmlbool(y.val) : 1;\n          break;\n        case '<shadow/>':\n          font.shadow = 1;\n          break;\n\n        /* 18.8.12 condense CT_BooleanProperty */\n        case '<condense':\n          font.condense = y.val ? parsexmlbool(y.val) : 1;\n          break;\n        case '<condense/>':\n          font.condense = 1;\n          break;\n\n        /* 18.8.17 extend CT_BooleanProperty */\n        case '<extend':\n          font.extend = y.val ? parsexmlbool(y.val) : 1;\n          break;\n        case '<extend/>':\n          font.extend = 1;\n          break;\n\n        /* 18.4.11 sz CT_FontSize */\n        case '<sz':\n          if (y.val) font.sz = +y.val;\n          break;\n        case '<sz/>':\n        case '</sz>':\n          break;\n\n        /* 18.4.14 vertAlign CT_VerticalAlignFontProperty */\n        case '<vertAlign':\n          if (y.val) font.vertAlign = y.val;\n          break;\n        case '<vertAlign/>':\n        case '</vertAlign>':\n          break;\n\n        /* 18.8.18 family CT_FontFamily */\n        case '<family':\n          if (y.val) font.family = parseInt(y.val, 10);\n          break;\n        case '<family/>':\n        case '</family>':\n          break;\n\n        /* 18.8.35 scheme CT_FontScheme */\n        case '<scheme':\n          if (y.val) font.scheme = y.val;\n          break;\n        case '<scheme/>':\n        case '</scheme>':\n          break;\n\n        /* 18.4.1 charset CT_IntProperty */\n        case '<charset':\n          if (y.val == '1') break;\n          y.codepage = CS2CP[parseInt(y.val, 10)];\n          break;\n\n        /* 18.?.? color CT_Color */\n        case '<color':\n          if (!font.color) font.color = {};\n          if (y.auto) font.color.auto = parsexmlbool(y.auto);\n          if (y.rgb) font.color.rgb = y.rgb.slice(-6);else if (y.indexed) {\n            font.color.index = parseInt(y.indexed, 10);\n            var icv = XLSIcv[font.color.index];\n            if (font.color.index == 81) icv = XLSIcv[1];\n            if (!icv) icv = XLSIcv[1]; //throw new Error(x); // note: 206 is valid\n            font.color.rgb = icv[0].toString(16) + icv[1].toString(16) + icv[2].toString(16);\n          } else if (y.theme) {\n            font.color.theme = parseInt(y.theme, 10);\n            if (y.tint) font.color.tint = parseFloat(y.tint);\n            if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n              font.color.rgb = rgb_tint(themes.themeElements.clrScheme[font.color.theme].rgb, font.color.tint || 0);\n            }\n          }\n          break;\n        case '<color/>':\n        case '</color>':\n          break;\n\n        /* note: sometimes mc:AlternateContent appears bare */\n        case '<AlternateContent':\n          pass = true;\n          break;\n        case '</AlternateContent>':\n          pass = false;\n          break;\n\n        /* 18.2.10 extLst CT_ExtensionList ? */\n        case '<extLst':\n        case '<extLst>':\n        case '</extLst>':\n          break;\n        case '<ext':\n          pass = true;\n          break;\n        case '</ext>':\n          pass = false;\n          break;\n        default:\n          if (opts && opts.WTF) {\n            if (!pass) throw new Error('unrecognized ' + y[0] + ' in fonts');\n          }\n      }\n    });\n  }\n\n  /* 18.8.31 numFmts CT_NumFmts */\n  function parse_numFmts(t, styles, opts) {\n    styles.NumberFmt = [];\n    var k /*Array<number>*/ = keys(table_fmt);\n    for (var i = 0; i < k.length; ++i) styles.NumberFmt[k[i]] = table_fmt[k[i]];\n    var m = t[0].match(tagregex);\n    if (!m) return;\n    for (i = 0; i < m.length; ++i) {\n      var y = parsexmltag(m[i]);\n      switch (strip_ns(y[0])) {\n        case '<numFmts':\n        case '</numFmts>':\n        case '<numFmts/>':\n        case '<numFmts>':\n          break;\n        case '<numFmt':\n          {\n            var f = unescapexml(utf8read(y.formatCode)),\n              j = parseInt(y.numFmtId, 10);\n            styles.NumberFmt[j] = f;\n            if (j > 0) {\n              if (j > 0x188) {\n                for (j = 0x188; j > 0x3c; --j) if (styles.NumberFmt[j] == null) break;\n                styles.NumberFmt[j] = f;\n              }\n              SSF_load(f, j);\n            }\n          }\n          break;\n        case '</numFmt>':\n          break;\n        default:\n          if (opts.WTF) throw new Error('unrecognized ' + y[0] + ' in numFmts');\n      }\n    }\n  }\n  function write_numFmts(NF) {\n    var o = [\"<numFmts>\"];\n    [[5, 8], [23, 26], [41, 44], [/*63*/50, /*66],[164,*/392]].forEach(function (r) {\n      for (var i = r[0]; i <= r[1]; ++i) if (NF[i] != null) o[o.length] = writextag('numFmt', null, {\n        numFmtId: i,\n        formatCode: escapexml(NF[i])\n      });\n    });\n    if (o.length === 1) return \"\";\n    o[o.length] = \"</numFmts>\";\n    o[0] = writextag('numFmts', null, {\n      count: o.length - 2\n    }).replace(\"/>\", \">\");\n    return o.join(\"\");\n  }\n\n  /* 18.8.10 cellXfs CT_CellXfs */\n  var cellXF_uint = [\"numFmtId\", \"fillId\", \"fontId\", \"borderId\", \"xfId\"];\n  var cellXF_bool = [\"applyAlignment\", \"applyBorder\", \"applyFill\", \"applyFont\", \"applyNumberFormat\", \"applyProtection\", \"pivotButton\", \"quotePrefix\"];\n  function parse_cellXfs(t, styles, opts) {\n    styles.CellXf = [];\n    var xf;\n    var pass = false;\n    (t[0].match(tagregex) || []).forEach(function (x) {\n      var y = parsexmltag(x),\n        i = 0;\n      switch (strip_ns(y[0])) {\n        case '<cellXfs':\n        case '<cellXfs>':\n        case '<cellXfs/>':\n        case '</cellXfs>':\n          break;\n\n        /* 18.8.45 xf CT_Xf */\n        case '<xf':\n        case '<xf/>':\n          xf = y;\n          delete xf[0];\n          for (i = 0; i < cellXF_uint.length; ++i) if (xf[cellXF_uint[i]]) xf[cellXF_uint[i]] = parseInt(xf[cellXF_uint[i]], 10);\n          for (i = 0; i < cellXF_bool.length; ++i) if (xf[cellXF_bool[i]]) xf[cellXF_bool[i]] = parsexmlbool(xf[cellXF_bool[i]]);\n          if (styles.NumberFmt && xf.numFmtId > 0x188) {\n            for (i = 0x188; i > 0x3c; --i) if (styles.NumberFmt[xf.numFmtId] == styles.NumberFmt[i]) {\n              xf.numFmtId = i;\n              break;\n            }\n          }\n          styles.CellXf.push(xf);\n          break;\n        case '</xf>':\n          break;\n\n        /* 18.8.1 alignment CT_CellAlignment */\n        case '<alignment':\n        case '<alignment/>':\n          var alignment = {};\n          if (y.vertical) alignment.vertical = y.vertical;\n          if (y.horizontal) alignment.horizontal = y.horizontal;\n          if (y.textRotation != null) alignment.textRotation = y.textRotation;\n          if (y.indent) alignment.indent = y.indent;\n          if (y.wrapText) alignment.wrapText = parsexmlbool(y.wrapText);\n          xf.alignment = alignment;\n          break;\n        case '</alignment>':\n          break;\n\n        /* 18.8.33 protection CT_CellProtection */\n        case '<protection':\n          break;\n        case '</protection>':\n        case '<protection/>':\n          break;\n\n        /* note: sometimes mc:AlternateContent appears bare */\n        case '<AlternateContent':\n          pass = true;\n          break;\n        case '</AlternateContent>':\n          pass = false;\n          break;\n\n        /* 18.2.10 extLst CT_ExtensionList ? */\n        case '<extLst':\n        case '<extLst>':\n        case '</extLst>':\n          break;\n        case '<ext':\n          pass = true;\n          break;\n        case '</ext>':\n          pass = false;\n          break;\n        default:\n          if (opts && opts.WTF) {\n            if (!pass) throw new Error('unrecognized ' + y[0] + ' in cellXfs');\n          }\n      }\n    });\n  }\n  function write_cellXfs(cellXfs) {\n    var o = [];\n    o[o.length] = writextag('cellXfs', null);\n    cellXfs.forEach(function (c) {\n      o[o.length] = writextag('xf', null, c);\n    });\n    o[o.length] = \"</cellXfs>\";\n    if (o.length === 2) return \"\";\n    o[0] = writextag('cellXfs', null, {\n      count: o.length - 2\n    }).replace(\"/>\", \">\");\n    return o.join(\"\");\n  }\n\n  /* 18.8 Styles CT_Stylesheet*/\n  var parse_sty_xml = function make_pstyx() {\n    var numFmtRegex = /<(?:\\w+:)?numFmts([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?numFmts>/;\n    var cellXfRegex = /<(?:\\w+:)?cellXfs([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?cellXfs>/;\n    var fillsRegex = /<(?:\\w+:)?fills([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?fills>/;\n    var fontsRegex = /<(?:\\w+:)?fonts([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?fonts>/;\n    var bordersRegex = /<(?:\\w+:)?borders([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?borders>/;\n    return function parse_sty_xml(data, themes, opts) {\n      var styles = {};\n      if (!data) return styles;\n      data = data.replace(/<!--([\\s\\S]*?)-->/mg, \"\").replace(/<!DOCTYPE[^\\[]*\\[[^\\]]*\\]>/gm, \"\");\n      /* 18.8.39 styleSheet CT_Stylesheet */\n      var t;\n\n      /* 18.8.31 numFmts CT_NumFmts ? */\n      if (t = data.match(numFmtRegex)) parse_numFmts(t, styles, opts);\n\n      /* 18.8.23 fonts CT_Fonts ? */\n      if (t = data.match(fontsRegex)) parse_fonts(t, styles, themes, opts);\n\n      /* 18.8.21 fills CT_Fills ? */\n      if (t = data.match(fillsRegex)) parse_fills(t, styles, themes, opts);\n\n      /* 18.8.5  borders CT_Borders ? */\n      if (t = data.match(bordersRegex)) parse_borders(t, styles, themes, opts);\n\n      /* 18.8.9  cellStyleXfs CT_CellStyleXfs ? */\n      /* 18.8.8  cellStyles CT_CellStyles ? */\n\n      /* 18.8.10 cellXfs CT_CellXfs ? */\n      if (t = data.match(cellXfRegex)) parse_cellXfs(t, styles, opts);\n\n      /* 18.8.15 dxfs CT_Dxfs ? */\n      /* 18.8.42 tableStyles CT_TableStyles ? */\n      /* 18.8.11 colors CT_Colors ? */\n      /* 18.2.10 extLst CT_ExtensionList ? */\n\n      return styles;\n    };\n  }();\n  function write_sty_xml(wb, opts) {\n    var o = [XML_HEADER, writextag('styleSheet', null, {\n        'xmlns': XMLNS_main[0],\n        'xmlns:vt': XMLNS.vt\n      })],\n      w;\n    if (wb.SSF && (w = write_numFmts(wb.SSF)) != null) o[o.length] = w;\n    o[o.length] = '<fonts count=\"1\"><font><sz val=\"12\"/><color theme=\"1\"/><name val=\"Calibri\"/><family val=\"2\"/><scheme val=\"minor\"/></font></fonts>';\n    o[o.length] = '<fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills>';\n    o[o.length] = '<borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders>';\n    o[o.length] = '<cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs>';\n    if (w = write_cellXfs(opts.cellXfs)) o[o.length] = w;\n    o[o.length] = '<cellStyles count=\"1\"><cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\"/></cellStyles>';\n    o[o.length] = '<dxfs count=\"0\"/>';\n    o[o.length] = '<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\"/>';\n    if (o.length > 2) {\n      o[o.length] = '</styleSheet>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n    return o.join(\"\");\n  }\n  /* [MS-XLSB] 2.4.657 BrtFmt */\n  function parse_BrtFmt(data, length) {\n    var numFmtId = data.read_shift(2);\n    var stFmtCode = parse_XLWideString(data, length - 2);\n    return [numFmtId, stFmtCode];\n  }\n  function write_BrtFmt(i, f, o) {\n    if (!o) o = new_buf(6 + 4 * f.length);\n    o.write_shift(2, i);\n    write_XLWideString(f, o);\n    var out = o.length > o.l ? o.slice(0, o.l) : o;\n    if (o.l == null) o.l = o.length;\n    return out;\n  }\n\n  /* [MS-XLSB] 2.4.659 BrtFont TODO */\n  function parse_BrtFont(data, length, opts) {\n    var out = {};\n    out.sz = data.read_shift(2) / 20;\n    var grbit = parse_FontFlags(data, 2, opts);\n    if (grbit.fItalic) out.italic = 1;\n    if (grbit.fCondense) out.condense = 1;\n    if (grbit.fExtend) out.extend = 1;\n    if (grbit.fShadow) out.shadow = 1;\n    if (grbit.fOutline) out.outline = 1;\n    if (grbit.fStrikeout) out.strike = 1;\n    var bls = data.read_shift(2);\n    if (bls === 0x02BC) out.bold = 1;\n    switch (data.read_shift(2)) {\n      /* case 0: out.vertAlign = \"baseline\"; break; */\n      case 1:\n        out.vertAlign = \"superscript\";\n        break;\n      case 2:\n        out.vertAlign = \"subscript\";\n        break;\n    }\n    var underline = data.read_shift(1);\n    if (underline != 0) out.underline = underline;\n    var family = data.read_shift(1);\n    if (family > 0) out.family = family;\n    var bCharSet = data.read_shift(1);\n    if (bCharSet > 0) out.charset = bCharSet;\n    data.l++;\n    out.color = parse_BrtColor(data, 8);\n    switch (data.read_shift(1)) {\n      /* case 0: out.scheme = \"none\": break; */\n      case 1:\n        out.scheme = \"major\";\n        break;\n      case 2:\n        out.scheme = \"minor\";\n        break;\n    }\n    out.name = parse_XLWideString(data, length - 21);\n    return out;\n  }\n  function write_BrtFont(font, o) {\n    if (!o) o = new_buf(25 + 4 * 32);\n    o.write_shift(2, font.sz * 20);\n    write_FontFlags(font, o);\n    o.write_shift(2, font.bold ? 0x02BC : 0x0190);\n    var sss = 0;\n    if (font.vertAlign == \"superscript\") sss = 1;else if (font.vertAlign == \"subscript\") sss = 2;\n    o.write_shift(2, sss);\n    o.write_shift(1, font.underline || 0);\n    o.write_shift(1, font.family || 0);\n    o.write_shift(1, font.charset || 0);\n    o.write_shift(1, 0);\n    write_BrtColor(font.color, o);\n    var scheme = 0;\n    if (font.scheme == \"major\") scheme = 1;\n    if (font.scheme == \"minor\") scheme = 2;\n    o.write_shift(1, scheme);\n    write_XLWideString(font.name, o);\n    return o.length > o.l ? o.slice(0, o.l) : o;\n  }\n\n  /* [MS-XLSB] 2.4.650 BrtFill */\n  var XLSBFillPTNames = [\"none\", \"solid\", \"mediumGray\", \"darkGray\", \"lightGray\", \"darkHorizontal\", \"darkVertical\", \"darkDown\", \"darkUp\", \"darkGrid\", \"darkTrellis\", \"lightHorizontal\", \"lightVertical\", \"lightDown\", \"lightUp\", \"lightGrid\", \"lightTrellis\", \"gray125\", \"gray0625\"];\n  var rev_XLSBFillPTNames;\n  /* TODO: gradient fill representation */\n  var parse_BrtFill = parsenoop;\n  function write_BrtFill(fill, o) {\n    if (!o) o = new_buf(4 * 3 + 8 * 7 + 16 * 1);\n    if (!rev_XLSBFillPTNames) rev_XLSBFillPTNames = evert(XLSBFillPTNames);\n    var fls = rev_XLSBFillPTNames[fill.patternType];\n    if (fls == null) fls = 0x28;\n    o.write_shift(4, fls);\n    var j = 0;\n    if (fls != 0x28) {\n      /* TODO: custom FG Color */\n      write_BrtColor({\n        auto: 1\n      }, o);\n      /* TODO: custom BG Color */\n      write_BrtColor({\n        auto: 1\n      }, o);\n      for (; j < 12; ++j) o.write_shift(4, 0);\n    } else {\n      for (; j < 4; ++j) o.write_shift(4, 0);\n      for (; j < 12; ++j) o.write_shift(4, 0); /* TODO */\n      /* iGradientType */\n      /* xnumDegree */\n      /* xnumFillToLeft */\n      /* xnumFillToRight */\n      /* xnumFillToTop */\n      /* xnumFillToBottom */\n      /* cNumStop */\n      /* xfillGradientStop */\n    }\n\n    return o.length > o.l ? o.slice(0, o.l) : o;\n  }\n\n  /* [MS-XLSB] 2.4.824 BrtXF */\n  function parse_BrtXF(data, length) {\n    var tgt = data.l + length;\n    var ixfeParent = data.read_shift(2);\n    var ifmt = data.read_shift(2);\n    data.l = tgt;\n    return {\n      ixfe: ixfeParent,\n      numFmtId: ifmt\n    };\n  }\n  function write_BrtXF(data, ixfeP, o) {\n    if (!o) o = new_buf(16);\n    o.write_shift(2, ixfeP || 0);\n    o.write_shift(2, data.numFmtId || 0);\n    o.write_shift(2, 0); /* iFont */\n    o.write_shift(2, 0); /* iFill */\n    o.write_shift(2, 0); /* ixBorder */\n    o.write_shift(1, 0); /* trot */\n    o.write_shift(1, 0); /* indent */\n    var flow = 0;\n    o.write_shift(1, flow); /* flags */\n    o.write_shift(1, 0); /* flags */\n    o.write_shift(1, 0); /* xfGrbitAtr */\n    o.write_shift(1, 0);\n    return o;\n  }\n\n  /* [MS-XLSB] 2.5.4 Blxf TODO */\n  function write_Blxf(data, o) {\n    if (!o) o = new_buf(10);\n    o.write_shift(1, 0); /* dg */\n    o.write_shift(1, 0);\n    o.write_shift(4, 0); /* color */\n    o.write_shift(4, 0); /* color */\n    return o;\n  }\n  /* [MS-XLSB] 2.4.302 BrtBorder TODO */\n  var parse_BrtBorder = parsenoop;\n  function write_BrtBorder(border, o) {\n    if (!o) o = new_buf(51);\n    o.write_shift(1, 0); /* diagonal */\n    write_Blxf(null, o); /* top */\n    write_Blxf(null, o); /* bottom */\n    write_Blxf(null, o); /* left */\n    write_Blxf(null, o); /* right */\n    write_Blxf(null, o); /* diag */\n    return o.length > o.l ? o.slice(0, o.l) : o;\n  }\n\n  /* [MS-XLSB] 2.4.763 BrtStyle TODO */\n  function write_BrtStyle(style, o) {\n    if (!o) o = new_buf(12 + 4 * 10);\n    o.write_shift(4, style.xfId);\n    o.write_shift(2, 1);\n    o.write_shift(1, +style.builtinId);\n    o.write_shift(1, 0); /* iLevel */\n    write_XLNullableWideString(style.name || \"\", o);\n    return o.length > o.l ? o.slice(0, o.l) : o;\n  }\n\n  /* [MS-XLSB] 2.4.272 BrtBeginTableStyles */\n  function write_BrtBeginTableStyles(cnt, defTableStyle, defPivotStyle) {\n    var o = new_buf(4 + 256 * 2 * 4);\n    o.write_shift(4, cnt);\n    write_XLNullableWideString(defTableStyle, o);\n    write_XLNullableWideString(defPivotStyle, o);\n    return o.length > o.l ? o.slice(0, o.l) : o;\n  }\n\n  /* [MS-XLSB] 2.1.7.50 Styles */\n  function parse_sty_bin(data, themes, opts) {\n    var styles = {};\n    styles.NumberFmt = [];\n    for (var y in table_fmt) styles.NumberFmt[y] = table_fmt[y];\n    styles.CellXf = [];\n    styles.Fonts = [];\n    var state = [];\n    var pass = false;\n    recordhopper(data, function hopper_sty(val, R, RT) {\n      switch (RT) {\n        case 0x002C:\n          /* BrtFmt */\n          styles.NumberFmt[val[0]] = val[1];\n          SSF_load(val[1], val[0]);\n          break;\n        case 0x002B:\n          /* BrtFont */\n          styles.Fonts.push(val);\n          if (val.color.theme != null && themes && themes.themeElements && themes.themeElements.clrScheme) {\n            val.color.rgb = rgb_tint(themes.themeElements.clrScheme[val.color.theme].rgb, val.color.tint || 0);\n          }\n          break;\n        case 0x0401:\n          /* BrtKnownFonts */break;\n        case 0x002D:\n          /* BrtFill */\n          break;\n        case 0x002E:\n          /* BrtBorder */\n          break;\n        case 0x002F:\n          /* BrtXF */\n          if (state[state.length - 1] == 0x0269 /* BrtBeginCellXFs */) {\n            styles.CellXf.push(val);\n          }\n          break;\n        case 0x0030: /* BrtStyle */\n        case 0x01FB: /* BrtDXF */\n        case 0x023C: /* BrtMRUColor */\n        case 0x01DB:\n          /* BrtIndexedColor */\n          break;\n        case 0x0493: /* BrtDXF14 */\n        case 0x0836: /* BrtDXF15 */\n        case 0x046A: /* BrtSlicerStyleElement */\n        case 0x0200: /* BrtTableStyleElement */\n        case 0x082F: /* BrtTimelineStyleElement */\n        case 0x0C00:\n          /* BrtUid */\n          break;\n        case 0x0023:\n          /* BrtFRTBegin */\n          pass = true;\n          break;\n        case 0x0024:\n          /* BrtFRTEnd */\n          pass = false;\n          break;\n        case 0x0025:\n          /* BrtACBegin */\n          state.push(RT);\n          pass = true;\n          break;\n        case 0x0026:\n          /* BrtACEnd */\n          state.pop();\n          pass = false;\n          break;\n        default:\n          if (R.T > 0) state.push(RT);else if (R.T < 0) state.pop();else if (!pass || opts.WTF && state[state.length - 1] != 0x0025 /* BrtACBegin */) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n      }\n    });\n    return styles;\n  }\n  function write_FMTS_bin(ba, NF) {\n    if (!NF) return;\n    var cnt = 0;\n    [[5, 8], [23, 26], [41, 44], [/*63*/50, /*66],[164,*/392]].forEach(function (r) {\n      for (var i = r[0]; i <= r[1]; ++i) if (NF[i] != null) ++cnt;\n    });\n    if (cnt == 0) return;\n    write_record(ba, 0x0267 /* BrtBeginFmts */, write_UInt32LE(cnt));\n    [[5, 8], [23, 26], [41, 44], [/*63*/50, /*66],[164,*/392]].forEach(function (r) {\n      for (var i = r[0]; i <= r[1]; ++i) if (NF[i] != null) write_record(ba, 0x002C /* BrtFmt */, write_BrtFmt(i, NF[i]));\n    });\n    write_record(ba, 0x0268 /* BrtEndFmts */);\n  }\n\n  function write_FONTS_bin(ba) {\n    var cnt = 1;\n    if (cnt == 0) return;\n    write_record(ba, 0x0263 /* BrtBeginFonts */, write_UInt32LE(cnt));\n    write_record(ba, 0x002B /* BrtFont */, write_BrtFont({\n      sz: 12,\n      color: {\n        theme: 1\n      },\n      name: \"Calibri\",\n      family: 2,\n      scheme: \"minor\"\n    }));\n    /* 1*65491BrtFont [ACFONTS] */\n    write_record(ba, 0x0264 /* BrtEndFonts */);\n  }\n\n  function write_FILLS_bin(ba) {\n    var cnt = 2;\n    if (cnt == 0) return;\n    write_record(ba, 0x025B /* BrtBeginFills */, write_UInt32LE(cnt));\n    write_record(ba, 0x002D /* BrtFill */, write_BrtFill({\n      patternType: \"none\"\n    }));\n    write_record(ba, 0x002D /* BrtFill */, write_BrtFill({\n      patternType: \"gray125\"\n    }));\n    /* 1*65431BrtFill */\n    write_record(ba, 0x025C /* BrtEndFills */);\n  }\n\n  function write_BORDERS_bin(ba) {\n    var cnt = 1;\n    if (cnt == 0) return;\n    write_record(ba, 0x0265 /* BrtBeginBorders */, write_UInt32LE(cnt));\n    write_record(ba, 0x002E /* BrtBorder */, write_BrtBorder({}));\n    /* 1*65430BrtBorder */\n    write_record(ba, 0x0266 /* BrtEndBorders */);\n  }\n\n  function write_CELLSTYLEXFS_bin(ba) {\n    var cnt = 1;\n    write_record(ba, 0x0272 /* BrtBeginCellStyleXFs */, write_UInt32LE(cnt));\n    write_record(ba, 0x002F /* BrtXF */, write_BrtXF({\n      numFmtId: 0,\n      fontId: 0,\n      fillId: 0,\n      borderId: 0\n    }, 0xFFFF));\n    /* 1*65430(BrtXF *FRT) */\n    write_record(ba, 0x0273 /* BrtEndCellStyleXFs */);\n  }\n\n  function write_CELLXFS_bin(ba, data) {\n    write_record(ba, 0x0269 /* BrtBeginCellXFs */, write_UInt32LE(data.length));\n    data.forEach(function (c) {\n      write_record(ba, 0x002F /* BrtXF */, write_BrtXF(c, 0));\n    });\n    /* 1*65430(BrtXF *FRT) */\n    write_record(ba, 0x026A /* BrtEndCellXFs */);\n  }\n\n  function write_STYLES_bin(ba) {\n    var cnt = 1;\n    write_record(ba, 0x026B /* BrtBeginStyles */, write_UInt32LE(cnt));\n    write_record(ba, 0x0030 /* BrtStyle */, write_BrtStyle({\n      xfId: 0,\n      builtinId: 0,\n      name: \"Normal\"\n    }));\n    /* 1*65430(BrtStyle *FRT) */\n    write_record(ba, 0x026C /* BrtEndStyles */);\n  }\n\n  function write_DXFS_bin(ba) {\n    var cnt = 0;\n    write_record(ba, 0x01F9 /* BrtBeginDXFs */, write_UInt32LE(cnt));\n    /* *2147483647(BrtDXF *FRT) */\n    write_record(ba, 0x01FA /* BrtEndDXFs */);\n  }\n\n  function write_TABLESTYLES_bin(ba) {\n    var cnt = 0;\n    write_record(ba, 0x01FC /* BrtBeginTableStyles */, write_BrtBeginTableStyles(cnt, \"TableStyleMedium9\", \"PivotStyleMedium4\"));\n    /* *TABLESTYLE */\n    write_record(ba, 0x01FD /* BrtEndTableStyles */);\n  }\n\n  function write_COLORPALETTE_bin() {\n    return;\n    /* BrtBeginColorPalette [INDEXEDCOLORS] [MRUCOLORS] BrtEndColorPalette */\n  }\n\n  /* [MS-XLSB] 2.1.7.50 Styles */\n  function write_sty_bin(wb, opts) {\n    var ba = buf_array();\n    write_record(ba, 0x0116 /* BrtBeginStyleSheet */);\n    write_FMTS_bin(ba, wb.SSF);\n    write_FONTS_bin(ba, wb);\n    write_FILLS_bin(ba, wb);\n    write_BORDERS_bin(ba, wb);\n    write_CELLSTYLEXFS_bin(ba, wb);\n    write_CELLXFS_bin(ba, opts.cellXfs);\n    write_STYLES_bin(ba, wb);\n    write_DXFS_bin(ba, wb);\n    write_TABLESTYLES_bin(ba, wb);\n    write_COLORPALETTE_bin(ba, wb);\n    /* FRTSTYLESHEET*/\n    write_record(ba, 0x0117 /* BrtEndStyleSheet */);\n    return ba.end();\n  }\n  /* Even though theme layout is dk1 lt1 dk2 lt2, true order is lt1 dk1 lt2 dk2 */\n  var XLSXThemeClrScheme = ['</a:lt1>', '</a:dk1>', '</a:lt2>', '</a:dk2>', '</a:accent1>', '</a:accent2>', '</a:accent3>', '</a:accent4>', '</a:accent5>', '</a:accent6>', '</a:hlink>', '</a:folHlink>'];\n  /* 20.1.6.2 clrScheme CT_ColorScheme */\n  function parse_clrScheme(t, themes, opts) {\n    themes.themeElements.clrScheme = [];\n    var color = {};\n    (t[0].match(tagregex) || []).forEach(function (x) {\n      var y = parsexmltag(x);\n      switch (y[0]) {\n        /* 20.1.6.2 clrScheme (Color Scheme) CT_ColorScheme */\n        case '<a:clrScheme':\n        case '</a:clrScheme>':\n          break;\n\n        /* 20.1.2.3.32 srgbClr CT_SRgbColor */\n        case '<a:srgbClr':\n          color.rgb = y.val;\n          break;\n\n        /* 20.1.2.3.33 sysClr CT_SystemColor */\n        case '<a:sysClr':\n          color.rgb = y.lastClr;\n          break;\n\n        /* 20.1.4.1.1 accent1 (Accent 1) */\n        /* 20.1.4.1.2 accent2 (Accent 2) */\n        /* 20.1.4.1.3 accent3 (Accent 3) */\n        /* 20.1.4.1.4 accent4 (Accent 4) */\n        /* 20.1.4.1.5 accent5 (Accent 5) */\n        /* 20.1.4.1.6 accent6 (Accent 6) */\n        /* 20.1.4.1.9 dk1 (Dark 1) */\n        /* 20.1.4.1.10 dk2 (Dark 2) */\n        /* 20.1.4.1.15 folHlink (Followed Hyperlink) */\n        /* 20.1.4.1.19 hlink (Hyperlink) */\n        /* 20.1.4.1.22 lt1 (Light 1) */\n        /* 20.1.4.1.23 lt2 (Light 2) */\n        case '<a:dk1>':\n        case '</a:dk1>':\n        case '<a:lt1>':\n        case '</a:lt1>':\n        case '<a:dk2>':\n        case '</a:dk2>':\n        case '<a:lt2>':\n        case '</a:lt2>':\n        case '<a:accent1>':\n        case '</a:accent1>':\n        case '<a:accent2>':\n        case '</a:accent2>':\n        case '<a:accent3>':\n        case '</a:accent3>':\n        case '<a:accent4>':\n        case '</a:accent4>':\n        case '<a:accent5>':\n        case '</a:accent5>':\n        case '<a:accent6>':\n        case '</a:accent6>':\n        case '<a:hlink>':\n        case '</a:hlink>':\n        case '<a:folHlink>':\n        case '</a:folHlink>':\n          if (y[0].charAt(1) === '/') {\n            themes.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(y[0])] = color;\n            color = {};\n          } else {\n            color.name = y[0].slice(3, y[0].length - 1);\n          }\n          break;\n        default:\n          if (opts && opts.WTF) throw new Error('Unrecognized ' + y[0] + ' in clrScheme');\n      }\n    });\n  }\n\n  /* 20.1.4.1.18 fontScheme CT_FontScheme */\n  function parse_fontScheme() {}\n\n  /* 20.1.4.1.15 fmtScheme CT_StyleMatrix */\n  function parse_fmtScheme() {}\n  var clrsregex = /<a:clrScheme([^>]*)>[\\s\\S]*<\\/a:clrScheme>/;\n  var fntsregex = /<a:fontScheme([^>]*)>[\\s\\S]*<\\/a:fontScheme>/;\n  var fmtsregex = /<a:fmtScheme([^>]*)>[\\s\\S]*<\\/a:fmtScheme>/;\n\n  /* 20.1.6.10 themeElements CT_BaseStyles */\n  function parse_themeElements(data, themes, opts) {\n    themes.themeElements = {};\n    var t;\n    [/* clrScheme CT_ColorScheme */\n    ['clrScheme', clrsregex, parse_clrScheme], /* fontScheme CT_FontScheme */\n    ['fontScheme', fntsregex, parse_fontScheme], /* fmtScheme CT_StyleMatrix */\n    ['fmtScheme', fmtsregex, parse_fmtScheme]].forEach(function (m) {\n      if (!(t = data.match(m[1]))) throw new Error(m[0] + ' not found in themeElements');\n      m[2](t, themes, opts);\n    });\n  }\n  var themeltregex = /<a:themeElements([^>]*)>[\\s\\S]*<\\/a:themeElements>/;\n\n  /* 14.2.7 Theme Part */\n  function parse_theme_xml(data, opts) {\n    /* 20.1.6.9 theme CT_OfficeStyleSheet */\n    if (!data || data.length === 0) data = write_theme();\n    var t;\n    var themes = {};\n\n    /* themeElements CT_BaseStyles */\n    if (!(t = data.match(themeltregex))) throw new Error('themeElements not found in theme');\n    parse_themeElements(t[0], themes, opts);\n    themes.raw = data;\n    return themes;\n  }\n  function write_theme(Themes, opts) {\n    if (opts && opts.themeXLSX) return opts.themeXLSX;\n    if (Themes && typeof Themes.raw == \"string\") return Themes.raw;\n    var o = [XML_HEADER];\n    o[o.length] = '<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\">';\n    o[o.length] = '<a:themeElements>';\n    o[o.length] = '<a:clrScheme name=\"Office\">';\n    o[o.length] = '<a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1>';\n    o[o.length] = '<a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1>';\n    o[o.length] = '<a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2>';\n    o[o.length] = '<a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2>';\n    o[o.length] = '<a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1>';\n    o[o.length] = '<a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2>';\n    o[o.length] = '<a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3>';\n    o[o.length] = '<a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4>';\n    o[o.length] = '<a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5>';\n    o[o.length] = '<a:accent6><a:srgbClr val=\"F79646\"/></a:accent6>';\n    o[o.length] = '<a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink>';\n    o[o.length] = '<a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink>';\n    o[o.length] = '</a:clrScheme>';\n    o[o.length] = '<a:fontScheme name=\"Office\">';\n    o[o.length] = '<a:majorFont>';\n    o[o.length] = '<a:latin typeface=\"Cambria\"/>';\n    o[o.length] = '<a:ea typeface=\"\"/>';\n    o[o.length] = '<a:cs typeface=\"\"/>';\n    o[o.length] = '<a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/>';\n    o[o.length] = '<a:font script=\"Hang\" typeface=\"맑은 고딕\"/>';\n    o[o.length] = '<a:font script=\"Hans\" typeface=\"宋体\"/>';\n    o[o.length] = '<a:font script=\"Hant\" typeface=\"新細明體\"/>';\n    o[o.length] = '<a:font script=\"Arab\" typeface=\"Times New Roman\"/>';\n    o[o.length] = '<a:font script=\"Hebr\" typeface=\"Times New Roman\"/>';\n    o[o.length] = '<a:font script=\"Thai\" typeface=\"Tahoma\"/>';\n    o[o.length] = '<a:font script=\"Ethi\" typeface=\"Nyala\"/>';\n    o[o.length] = '<a:font script=\"Beng\" typeface=\"Vrinda\"/>';\n    o[o.length] = '<a:font script=\"Gujr\" typeface=\"Shruti\"/>';\n    o[o.length] = '<a:font script=\"Khmr\" typeface=\"MoolBoran\"/>';\n    o[o.length] = '<a:font script=\"Knda\" typeface=\"Tunga\"/>';\n    o[o.length] = '<a:font script=\"Guru\" typeface=\"Raavi\"/>';\n    o[o.length] = '<a:font script=\"Cans\" typeface=\"Euphemia\"/>';\n    o[o.length] = '<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';\n    o[o.length] = '<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';\n    o[o.length] = '<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';\n    o[o.length] = '<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';\n    o[o.length] = '<a:font script=\"Deva\" typeface=\"Mangal\"/>';\n    o[o.length] = '<a:font script=\"Telu\" typeface=\"Gautami\"/>';\n    o[o.length] = '<a:font script=\"Taml\" typeface=\"Latha\"/>';\n    o[o.length] = '<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';\n    o[o.length] = '<a:font script=\"Orya\" typeface=\"Kalinga\"/>';\n    o[o.length] = '<a:font script=\"Mlym\" typeface=\"Kartika\"/>';\n    o[o.length] = '<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';\n    o[o.length] = '<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';\n    o[o.length] = '<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';\n    o[o.length] = '<a:font script=\"Viet\" typeface=\"Times New Roman\"/>';\n    o[o.length] = '<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';\n    o[o.length] = '<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';\n    o[o.length] = '</a:majorFont>';\n    o[o.length] = '<a:minorFont>';\n    o[o.length] = '<a:latin typeface=\"Calibri\"/>';\n    o[o.length] = '<a:ea typeface=\"\"/>';\n    o[o.length] = '<a:cs typeface=\"\"/>';\n    o[o.length] = '<a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/>';\n    o[o.length] = '<a:font script=\"Hang\" typeface=\"맑은 고딕\"/>';\n    o[o.length] = '<a:font script=\"Hans\" typeface=\"宋体\"/>';\n    o[o.length] = '<a:font script=\"Hant\" typeface=\"新細明體\"/>';\n    o[o.length] = '<a:font script=\"Arab\" typeface=\"Arial\"/>';\n    o[o.length] = '<a:font script=\"Hebr\" typeface=\"Arial\"/>';\n    o[o.length] = '<a:font script=\"Thai\" typeface=\"Tahoma\"/>';\n    o[o.length] = '<a:font script=\"Ethi\" typeface=\"Nyala\"/>';\n    o[o.length] = '<a:font script=\"Beng\" typeface=\"Vrinda\"/>';\n    o[o.length] = '<a:font script=\"Gujr\" typeface=\"Shruti\"/>';\n    o[o.length] = '<a:font script=\"Khmr\" typeface=\"DaunPenh\"/>';\n    o[o.length] = '<a:font script=\"Knda\" typeface=\"Tunga\"/>';\n    o[o.length] = '<a:font script=\"Guru\" typeface=\"Raavi\"/>';\n    o[o.length] = '<a:font script=\"Cans\" typeface=\"Euphemia\"/>';\n    o[o.length] = '<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';\n    o[o.length] = '<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';\n    o[o.length] = '<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';\n    o[o.length] = '<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';\n    o[o.length] = '<a:font script=\"Deva\" typeface=\"Mangal\"/>';\n    o[o.length] = '<a:font script=\"Telu\" typeface=\"Gautami\"/>';\n    o[o.length] = '<a:font script=\"Taml\" typeface=\"Latha\"/>';\n    o[o.length] = '<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';\n    o[o.length] = '<a:font script=\"Orya\" typeface=\"Kalinga\"/>';\n    o[o.length] = '<a:font script=\"Mlym\" typeface=\"Kartika\"/>';\n    o[o.length] = '<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';\n    o[o.length] = '<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';\n    o[o.length] = '<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';\n    o[o.length] = '<a:font script=\"Viet\" typeface=\"Arial\"/>';\n    o[o.length] = '<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';\n    o[o.length] = '<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';\n    o[o.length] = '</a:minorFont>';\n    o[o.length] = '</a:fontScheme>';\n    o[o.length] = '<a:fmtScheme name=\"Office\">';\n    o[o.length] = '<a:fillStyleLst>';\n    o[o.length] = '<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';\n    o[o.length] = '<a:gradFill rotWithShape=\"1\">';\n    o[o.length] = '<a:gsLst>';\n    o[o.length] = '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n    o[o.length] = '<a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n    o[o.length] = '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n    o[o.length] = '</a:gsLst>';\n    o[o.length] = '<a:lin ang=\"16200000\" scaled=\"1\"/>';\n    o[o.length] = '</a:gradFill>';\n    o[o.length] = '<a:gradFill rotWithShape=\"1\">';\n    o[o.length] = '<a:gsLst>';\n    o[o.length] = '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs>';\n    o[o.length] = '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n    o[o.length] = '</a:gsLst>';\n    o[o.length] = '<a:lin ang=\"16200000\" scaled=\"0\"/>';\n    o[o.length] = '</a:gradFill>';\n    o[o.length] = '</a:fillStyleLst>';\n    o[o.length] = '<a:lnStyleLst>';\n    o[o.length] = '<a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n    o[o.length] = '<a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n    o[o.length] = '<a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n    o[o.length] = '</a:lnStyleLst>';\n    o[o.length] = '<a:effectStyleLst>';\n    o[o.length] = '<a:effectStyle>';\n    o[o.length] = '<a:effectLst>';\n    o[o.length] = '<a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw>';\n    o[o.length] = '</a:effectLst>';\n    o[o.length] = '</a:effectStyle>';\n    o[o.length] = '<a:effectStyle>';\n    o[o.length] = '<a:effectLst>';\n    o[o.length] = '<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';\n    o[o.length] = '</a:effectLst>';\n    o[o.length] = '</a:effectStyle>';\n    o[o.length] = '<a:effectStyle>';\n    o[o.length] = '<a:effectLst>';\n    o[o.length] = '<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';\n    o[o.length] = '</a:effectLst>';\n    o[o.length] = '<a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d>';\n    o[o.length] = '<a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d>';\n    o[o.length] = '</a:effectStyle>';\n    o[o.length] = '</a:effectStyleLst>';\n    o[o.length] = '<a:bgFillStyleLst>';\n    o[o.length] = '<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';\n    o[o.length] = '<a:gradFill rotWithShape=\"1\">';\n    o[o.length] = '<a:gsLst>';\n    o[o.length] = '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n    o[o.length] = '<a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n    o[o.length] = '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs>';\n    o[o.length] = '</a:gsLst>';\n    o[o.length] = '<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path>';\n    o[o.length] = '</a:gradFill>';\n    o[o.length] = '<a:gradFill rotWithShape=\"1\">';\n    o[o.length] = '<a:gsLst>';\n    o[o.length] = '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n    o[o.length] = '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs>';\n    o[o.length] = '</a:gsLst>';\n    o[o.length] = '<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path>';\n    o[o.length] = '</a:gradFill>';\n    o[o.length] = '</a:bgFillStyleLst>';\n    o[o.length] = '</a:fmtScheme>';\n    o[o.length] = '</a:themeElements>';\n    o[o.length] = '<a:objectDefaults>';\n    o[o.length] = '<a:spDef>';\n    o[o.length] = '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style>';\n    o[o.length] = '</a:spDef>';\n    o[o.length] = '<a:lnDef>';\n    o[o.length] = '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style>';\n    o[o.length] = '</a:lnDef>';\n    o[o.length] = '</a:objectDefaults>';\n    o[o.length] = '<a:extraClrSchemeLst/>';\n    o[o.length] = '</a:theme>';\n    return o.join(\"\");\n  }\n  /* [MS-XLS] 2.4.326 TODO: payload is a zip file */\n  function parse_Theme(blob, length, opts) {\n    var end = blob.l + length;\n    var dwThemeVersion = blob.read_shift(4);\n    if (dwThemeVersion === 124226) return;\n    if (!opts.cellStyles) {\n      blob.l = end;\n      return;\n    }\n    var data = blob.slice(blob.l);\n    blob.l = end;\n    var zip;\n    try {\n      zip = zip_read(data, {\n        type: \"array\"\n      });\n    } catch (e) {\n      return;\n    }\n    var themeXML = getzipstr(zip, \"theme/theme/theme1.xml\", true);\n    if (!themeXML) return;\n    return parse_theme_xml(themeXML, opts);\n  }\n\n  /* 2.5.49 */\n  function parse_ColorTheme(blob) {\n    return blob.read_shift(4);\n  }\n\n  /* 2.5.155 */\n  function parse_FullColorExt(blob) {\n    var o = {};\n    o.xclrType = blob.read_shift(2);\n    o.nTintShade = blob.read_shift(2);\n    switch (o.xclrType) {\n      case 0:\n        blob.l += 4;\n        break;\n      case 1:\n        o.xclrValue = parse_IcvXF(blob, 4);\n        break;\n      case 2:\n        o.xclrValue = parse_LongRGBA(blob, 4);\n        break;\n      case 3:\n        o.xclrValue = parse_ColorTheme(blob, 4);\n        break;\n      case 4:\n        blob.l += 4;\n        break;\n    }\n    blob.l += 8;\n    return o;\n  }\n\n  /* 2.5.164 TODO: read 7 bits*/\n  function parse_IcvXF(blob, length) {\n    return parsenoop(blob, length);\n  }\n\n  /* 2.5.280 */\n  function parse_XFExtGradient(blob, length) {\n    return parsenoop(blob, length);\n  }\n\n  /* [MS-XLS] 2.5.108 */\n  function parse_ExtProp(blob) {\n    var extType = blob.read_shift(2);\n    var cb = blob.read_shift(2) - 4;\n    var o = [extType];\n    switch (extType) {\n      case 0x04:\n      case 0x05:\n      case 0x07:\n      case 0x08:\n      case 0x09:\n      case 0x0A:\n      case 0x0B:\n      case 0x0D:\n        o[1] = parse_FullColorExt(blob, cb);\n        break;\n      case 0x06:\n        o[1] = parse_XFExtGradient(blob, cb);\n        break;\n      case 0x0E:\n      case 0x0F:\n        o[1] = blob.read_shift(cb === 1 ? 1 : 2);\n        break;\n      default:\n        throw new Error(\"Unrecognized ExtProp type: \" + extType + \" \" + cb);\n    }\n    return o;\n  }\n\n  /* 2.4.355 */\n  function parse_XFExt(blob, length) {\n    var end = blob.l + length;\n    blob.l += 2;\n    var ixfe = blob.read_shift(2);\n    blob.l += 2;\n    var cexts = blob.read_shift(2);\n    var ext = [];\n    while (cexts-- > 0) ext.push(parse_ExtProp(blob, end - blob.l));\n    return {\n      ixfe: ixfe,\n      ext: ext\n    };\n  }\n\n  /* xf is an XF, see parse_XFExt for xfext */\n  function update_xfext(xf, xfext) {\n    xfext.forEach(function (xfe) {\n      switch (xfe[0]) {\n        /* 2.5.108 extPropData */\n        case 0x04:\n          break;\n        /* foreground color */\n        case 0x05:\n          break;\n        /* background color */\n        case 0x06:\n          break;\n        /* gradient fill */\n        case 0x07:\n          break;\n        /* top cell border color */\n        case 0x08:\n          break;\n        /* bottom cell border color */\n        case 0x09:\n          break;\n        /* left cell border color */\n        case 0x0a:\n          break;\n        /* right cell border color */\n        case 0x0b:\n          break;\n        /* diagonal cell border color */\n        case 0x0d:\n          /* text color */\n          break;\n        case 0x0e:\n          break;\n        /* font scheme */\n        case 0x0f:\n          break;\n        /* indentation level */\n      }\n    });\n  }\n\n  function parse_BrtMdtinfo(data, length) {\n    return {\n      flags: data.read_shift(4),\n      version: data.read_shift(4),\n      name: parse_XLWideString(data, length - 8)\n    };\n  }\n  function write_BrtMdtinfo(data) {\n    var o = new_buf(12 + 2 * data.name.length);\n    o.write_shift(4, data.flags);\n    o.write_shift(4, data.version);\n    write_XLWideString(data.name, o);\n    return o.slice(0, o.l);\n  }\n  function parse_BrtMdb(data) {\n    var out = [];\n    var cnt = data.read_shift(4);\n    while (cnt-- > 0) out.push([data.read_shift(4), data.read_shift(4)]);\n    return out;\n  }\n  function write_BrtMdb(mdb) {\n    var o = new_buf(4 + 8 * mdb.length);\n    o.write_shift(4, mdb.length);\n    for (var i = 0; i < mdb.length; ++i) {\n      o.write_shift(4, mdb[i][0]);\n      o.write_shift(4, mdb[i][1]);\n    }\n    return o;\n  }\n  function write_BrtBeginEsfmd(cnt, name) {\n    var o = new_buf(8 + 2 * name.length);\n    o.write_shift(4, cnt);\n    write_XLWideString(name, o);\n    return o.slice(0, o.l);\n  }\n  function parse_BrtBeginEsmdb(data) {\n    data.l += 4;\n    return data.read_shift(4) != 0;\n  }\n  function write_BrtBeginEsmdb(cnt, cm) {\n    var o = new_buf(8);\n    o.write_shift(4, cnt);\n    o.write_shift(4, cm ? 1 : 0);\n    return o;\n  }\n  function parse_xlmeta_bin(data, name, _opts) {\n    var out = {\n      Types: [],\n      Cell: [],\n      Value: []\n    };\n    var opts = _opts || {};\n    var state = [];\n    var pass = false;\n    var metatype = 2;\n    recordhopper(data, function (val, R, RT) {\n      switch (RT) {\n        case 335:\n          out.Types.push({\n            name: val.name\n          });\n          break;\n        case 51:\n          val.forEach(function (r) {\n            if (metatype == 1) out.Cell.push({\n              type: out.Types[r[0] - 1].name,\n              index: r[1]\n            });else if (metatype == 0) out.Value.push({\n              type: out.Types[r[0] - 1].name,\n              index: r[1]\n            });\n          });\n          break;\n        case 337:\n          metatype = val ? 1 : 0;\n          break;\n        case 338:\n          metatype = 2;\n          break;\n        case 35:\n          state.push(RT);\n          pass = true;\n          break;\n        case 36:\n          state.pop();\n          pass = false;\n          break;\n        default:\n          if (R.T) {} else if (!pass || opts.WTF && state[state.length - 1] != 35) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n      }\n    });\n    return out;\n  }\n  function write_xlmeta_bin() {\n    var ba = buf_array();\n    write_record(ba, 332);\n    write_record(ba, 334, write_UInt32LE(1));\n    write_record(ba, 335, write_BrtMdtinfo({\n      name: \"XLDAPR\",\n      version: 12e4,\n      flags: 3496657072\n    }));\n    write_record(ba, 336);\n    write_record(ba, 339, write_BrtBeginEsfmd(1, \"XLDAPR\"));\n    write_record(ba, 52);\n    write_record(ba, 35, write_UInt32LE(514));\n    write_record(ba, 4096, write_UInt32LE(0));\n    write_record(ba, 4097, writeuint16(1));\n    write_record(ba, 36);\n    write_record(ba, 53);\n    write_record(ba, 340);\n    write_record(ba, 337, write_BrtBeginEsmdb(1, true));\n    write_record(ba, 51, write_BrtMdb([[1, 0]]));\n    write_record(ba, 338);\n    write_record(ba, 333);\n    return ba.end();\n  }\n  function parse_xlmeta_xml(data, name, opts) {\n    var out = {\n      Types: [],\n      Cell: [],\n      Value: []\n    };\n    if (!data) return out;\n    var pass = false;\n    var metatype = 2;\n    var lastmeta;\n    data.replace(tagregex, function (x) {\n      var y = parsexmltag(x);\n      switch (strip_ns(y[0])) {\n        case \"<?xml\":\n          break;\n        case \"<metadata\":\n        case \"</metadata>\":\n          break;\n        case \"<metadataTypes\":\n        case \"</metadataTypes>\":\n          break;\n        case \"<metadataType\":\n          out.Types.push({\n            name: y.name\n          });\n          break;\n        case \"</metadataType>\":\n          break;\n        case \"<futureMetadata\":\n          for (var j = 0; j < out.Types.length; ++j) if (out.Types[j].name == y.name) lastmeta = out.Types[j];\n          break;\n        case \"</futureMetadata>\":\n          break;\n        case \"<bk>\":\n          break;\n        case \"</bk>\":\n          break;\n        case \"<rc\":\n          if (metatype == 1) out.Cell.push({\n            type: out.Types[y.t - 1].name,\n            index: +y.v\n          });else if (metatype == 0) out.Value.push({\n            type: out.Types[y.t - 1].name,\n            index: +y.v\n          });\n          break;\n        case \"</rc>\":\n          break;\n        case \"<cellMetadata\":\n          metatype = 1;\n          break;\n        case \"</cellMetadata>\":\n          metatype = 2;\n          break;\n        case \"<valueMetadata\":\n          metatype = 0;\n          break;\n        case \"</valueMetadata>\":\n          metatype = 2;\n          break;\n        case \"<extLst\":\n        case \"<extLst>\":\n        case \"</extLst>\":\n        case \"<extLst/>\":\n          break;\n        case \"<ext\":\n          pass = true;\n          break;\n        case \"</ext>\":\n          pass = false;\n          break;\n        case \"<rvb\":\n          if (!lastmeta) break;\n          if (!lastmeta.offsets) lastmeta.offsets = [];\n          lastmeta.offsets.push(+y.i);\n          break;\n        default:\n          if (!pass && opts.WTF) throw new Error(\"unrecognized \" + y[0] + \" in metadata\");\n      }\n      return x;\n    });\n    return out;\n  }\n  function write_xlmeta_xml() {\n    var o = [XML_HEADER];\n    o.push('<metadata xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:xlrd=\"http://schemas.microsoft.com/office/spreadsheetml/2017/richdata\" xmlns:xda=\"http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray\">\\n  <metadataTypes count=\"1\">\\n    <metadataType name=\"XLDAPR\" minSupportedVersion=\"120000\" copy=\"1\" pasteAll=\"1\" pasteValues=\"1\" merge=\"1\" splitFirst=\"1\" rowColShift=\"1\" clearFormats=\"1\" clearComments=\"1\" assign=\"1\" coerce=\"1\" cellMeta=\"1\"/>\\n  </metadataTypes>\\n  <futureMetadata name=\"XLDAPR\" count=\"1\">\\n    <bk>\\n      <extLst>\\n        <ext uri=\"{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}\">\\n          <xda:dynamicArrayProperties fDynamic=\"1\" fCollapsed=\"0\"/>\\n        </ext>\\n      </extLst>\\n    </bk>\\n  </futureMetadata>\\n  <cellMetadata count=\"1\">\\n    <bk>\\n      <rc t=\"1\" v=\"0\"/>\\n    </bk>\\n  </cellMetadata>\\n</metadata>');\n    return o.join(\"\");\n  }\n  /* 18.6 Calculation Chain */\n  function parse_cc_xml(data) {\n    var d = [];\n    if (!data) return d;\n    var i = 1;\n    (data.match(tagregex) || []).forEach(function (x) {\n      var y = parsexmltag(x);\n      switch (y[0]) {\n        case '<?xml':\n          break;\n        /* 18.6.2  calcChain CT_CalcChain 1 */\n        case '<calcChain':\n        case '<calcChain>':\n        case '</calcChain>':\n          break;\n        /* 18.6.1  c CT_CalcCell 1 */\n        case '<c':\n          delete y[0];\n          if (y.i) i = y.i;else y.i = i;\n          d.push(y);\n          break;\n      }\n    });\n    return d;\n  }\n\n  //function write_cc_xml(data, opts) { }\n\n  /* [MS-XLSB] 2.6.4.1 */\n  function parse_BrtCalcChainItem$(data) {\n    var out = {};\n    out.i = data.read_shift(4);\n    var cell = {};\n    cell.r = data.read_shift(4);\n    cell.c = data.read_shift(4);\n    out.r = encode_cell(cell);\n    var flags = data.read_shift(1);\n    if (flags & 0x2) out.l = '1';\n    if (flags & 0x8) out.a = '1';\n    return out;\n  }\n\n  /* 18.6 Calculation Chain */\n  function parse_cc_bin(data, name, opts) {\n    var out = [];\n    var pass = false;\n    recordhopper(data, function hopper_cc(val, R, RT) {\n      switch (RT) {\n        case 0x003F:\n          /* 'BrtCalcChainItem$' */\n          out.push(val);\n          break;\n        default:\n          if (R.T) {/* empty */} else if (!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n      }\n    });\n    return out;\n  }\n\n  //function write_cc_bin(data, opts) { }\n  /* 18.14 Supplementary Workbook Data */\n  function parse_xlink_xml() {\n    //var opts = _opts || {};\n    //if(opts.WTF) throw \"XLSX External Link\";\n  }\n\n  /* [MS-XLSB] 2.1.7.25 External Link */\n  function parse_xlink_bin(data, rel, name, _opts) {\n    if (!data) return data;\n    var opts = _opts || {};\n    var pass = false,\n      end = false;\n    recordhopper(data, function xlink_parse(val, R, RT) {\n      if (end) return;\n      switch (RT) {\n        case 0x0167: /* 'BrtSupTabs' */\n        case 0x016B: /* 'BrtExternTableStart' */\n        case 0x016C: /* 'BrtExternTableEnd' */\n        case 0x016E: /* 'BrtExternRowHdr' */\n        case 0x016F: /* 'BrtExternCellBlank' */\n        case 0x0170: /* 'BrtExternCellReal' */\n        case 0x0171: /* 'BrtExternCellBool' */\n        case 0x0172: /* 'BrtExternCellError' */\n        case 0x0173: /* 'BrtExternCellString' */\n        case 0x01D8: /* 'BrtExternValueMeta' */\n        case 0x0241: /* 'BrtSupNameStart' */\n        case 0x0242: /* 'BrtSupNameValueStart' */\n        case 0x0243: /* 'BrtSupNameValueEnd' */\n        case 0x0244: /* 'BrtSupNameNum' */\n        case 0x0245: /* 'BrtSupNameErr' */\n        case 0x0246: /* 'BrtSupNameSt' */\n        case 0x0247: /* 'BrtSupNameNil' */\n        case 0x0248: /* 'BrtSupNameBool' */\n        case 0x0249: /* 'BrtSupNameFmla' */\n        case 0x024A: /* 'BrtSupNameBits' */\n        case 0x024B:\n          /* 'BrtSupNameEnd' */\n          break;\n        case 0x0023:\n          /* 'BrtFRTBegin' */\n          pass = true;\n          break;\n        case 0x0024:\n          /* 'BrtFRTEnd' */\n          pass = false;\n          break;\n        default:\n          if (R.T) {/* empty */} else if (!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n      }\n    }, opts);\n  }\n  /* 20.5 DrawingML - SpreadsheetML Drawing */\n  /* 20.5.2.35 wsDr CT_Drawing */\n  function parse_drawing(data, rels) {\n    if (!data) return \"??\";\n    /*\n      Chartsheet Drawing:\n       - 20.5.2.35 wsDr CT_Drawing\n        - 20.5.2.1  absoluteAnchor CT_AbsoluteAnchor\n         - 20.5.2.16 graphicFrame CT_GraphicalObjectFrame\n          - 20.1.2.2.16 graphic CT_GraphicalObject\n           - 20.1.2.2.17 graphicData CT_GraphicalObjectData\n             - chart reference\n       the actual type is based on the URI of the graphicData\n    \tTODO: handle embedded charts and other types of graphics\n    */\n    var id = (data.match(/<c:chart [^>]*r:id=\"([^\"]*)\"/) || [\"\", \"\"])[1];\n    return rels['!id'][id].Target;\n  }\n\n  /* L.5.5.2 SpreadsheetML Comments + VML Schema */\n  var _shapeid = 1024;\n  function write_comments_vml(rId, comments) {\n    var csize = [21600, 21600];\n    /* L.5.2.1.2 Path Attribute */\n    var bbox = [\"m0,0l0\", csize[1], csize[0], csize[1], csize[0], \"0xe\"].join(\",\");\n    var o = [writextag(\"xml\", null, {\n      'xmlns:v': XLMLNS.v,\n      'xmlns:o': XLMLNS.o,\n      'xmlns:x': XLMLNS.x,\n      'xmlns:mv': XLMLNS.mv\n    }).replace(/\\/>/, \">\"), writextag(\"o:shapelayout\", writextag(\"o:idmap\", null, {\n      'v:ext': \"edit\",\n      'data': rId\n    }), {\n      'v:ext': \"edit\"\n    }), writextag(\"v:shapetype\", [writextag(\"v:stroke\", null, {\n      joinstyle: \"miter\"\n    }), writextag(\"v:path\", null, {\n      gradientshapeok: \"t\",\n      'o:connecttype': \"rect\"\n    })].join(\"\"), {\n      id: \"_x0000_t202\",\n      'o:spt': 202,\n      coordsize: csize.join(\",\"),\n      path: bbox\n    })];\n    while (_shapeid < rId * 1000) _shapeid += 1000;\n    comments.forEach(function (x) {\n      var c = decode_cell(x[0]);\n      var fillopts = {\n        'color2': \"#BEFF82\",\n        'type': \"gradient\"\n      };\n      if (fillopts.type == \"gradient\") fillopts.angle = \"-180\";\n      var fillparm = fillopts.type == \"gradient\" ? writextag(\"o:fill\", null, {\n        type: \"gradientUnscaled\",\n        'v:ext': \"view\"\n      }) : null;\n      var fillxml = writextag('v:fill', fillparm, fillopts);\n      var shadata = {\n        on: \"t\",\n        'obscured': \"t\"\n      };\n      ++_shapeid;\n      o = o.concat(['<v:shape' + wxt_helper({\n        id: '_x0000_s' + _shapeid,\n        type: \"#_x0000_t202\",\n        style: \"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10\" + (x[1].hidden ? \";visibility:hidden\" : \"\"),\n        fillcolor: \"#ECFAD4\",\n        strokecolor: \"#edeaa1\"\n      }) + '>', fillxml, writextag(\"v:shadow\", null, shadata), writextag(\"v:path\", null, {\n        'o:connecttype': \"none\"\n      }), '<v:textbox><div style=\"text-align:left\"></div></v:textbox>', '<x:ClientData ObjectType=\"Note\">', '<x:MoveWithCells/>', '<x:SizeWithCells/>', /* Part 4 19.4.2.3 Anchor (Anchor) */\n      writetag('x:Anchor', [c.c + 1, 0, c.r + 1, 0, c.c + 3, 20, c.r + 5, 20].join(\",\")), writetag('x:AutoFill', \"False\"), writetag('x:Row', String(c.r)), writetag('x:Column', String(c.c)), x[1].hidden ? '' : '<x:Visible/>', '</x:ClientData>', '</v:shape>']);\n    });\n    o.push('</xml>');\n    return o.join(\"\");\n  }\n  function sheet_insert_comments(sheet, comments, threaded, people) {\n    var dense = Array.isArray(sheet);\n    var cell;\n    comments.forEach(function (comment) {\n      var r = decode_cell(comment.ref);\n      if (dense) {\n        if (!sheet[r.r]) sheet[r.r] = [];\n        cell = sheet[r.r][r.c];\n      } else cell = sheet[comment.ref];\n      if (!cell) {\n        cell = {\n          t: \"z\"\n        };\n        if (dense) sheet[r.r][r.c] = cell;else sheet[comment.ref] = cell;\n        var range = safe_decode_range(sheet[\"!ref\"] || \"BDWGO1000001:A1\");\n        if (range.s.r > r.r) range.s.r = r.r;\n        if (range.e.r < r.r) range.e.r = r.r;\n        if (range.s.c > r.c) range.s.c = r.c;\n        if (range.e.c < r.c) range.e.c = r.c;\n        var encoded = encode_range(range);\n        if (encoded !== sheet[\"!ref\"]) sheet[\"!ref\"] = encoded;\n      }\n      if (!cell.c) cell.c = [];\n      var o = {\n        a: comment.author,\n        t: comment.t,\n        r: comment.r,\n        T: threaded\n      };\n      if (comment.h) o.h = comment.h;\n\n      /* threaded comments always override */\n      for (var i = cell.c.length - 1; i >= 0; --i) {\n        if (!threaded && cell.c[i].T) return;\n        if (threaded && !cell.c[i].T) cell.c.splice(i, 1);\n      }\n      if (threaded && people) for (i = 0; i < people.length; ++i) {\n        if (o.a == people[i].id) {\n          o.a = people[i].name || o.a;\n          break;\n        }\n      }\n      cell.c.push(o);\n    });\n  }\n\n  /* 18.7 Comments */\n  function parse_comments_xml(data, opts) {\n    /* 18.7.6 CT_Comments */\n    if (data.match(/<(?:\\w+:)?comments *\\/>/)) return [];\n    var authors = [];\n    var commentList = [];\n    var authtag = data.match(/<(?:\\w+:)?authors>([\\s\\S]*)<\\/(?:\\w+:)?authors>/);\n    if (authtag && authtag[1]) authtag[1].split(/<\\/\\w*:?author>/).forEach(function (x) {\n      if (x === \"\" || x.trim() === \"\") return;\n      var a = x.match(/<(?:\\w+:)?author[^>]*>(.*)/);\n      if (a) authors.push(a[1]);\n    });\n    var cmnttag = data.match(/<(?:\\w+:)?commentList>([\\s\\S]*)<\\/(?:\\w+:)?commentList>/);\n    if (cmnttag && cmnttag[1]) cmnttag[1].split(/<\\/\\w*:?comment>/).forEach(function (x) {\n      if (x === \"\" || x.trim() === \"\") return;\n      var cm = x.match(/<(?:\\w+:)?comment[^>]*>/);\n      if (!cm) return;\n      var y = parsexmltag(cm[0]);\n      var comment = {\n        author: y.authorId && authors[y.authorId] || \"sheetjsghost\",\n        ref: y.ref,\n        guid: y.guid\n      };\n      var cell = decode_cell(y.ref);\n      if (opts.sheetRows && opts.sheetRows <= cell.r) return;\n      var textMatch = x.match(/<(?:\\w+:)?text>([\\s\\S]*)<\\/(?:\\w+:)?text>/);\n      var rt = !!textMatch && !!textMatch[1] && parse_si(textMatch[1]) || {\n        r: \"\",\n        t: \"\",\n        h: \"\"\n      };\n      comment.r = rt.r;\n      if (rt.r == \"<t></t>\") rt.t = rt.h = \"\";\n      comment.t = (rt.t || \"\").replace(/\\r\\n/g, \"\\n\").replace(/\\r/g, \"\\n\");\n      if (opts.cellHTML) comment.h = rt.h;\n      commentList.push(comment);\n    });\n    return commentList;\n  }\n  function write_comments_xml(data) {\n    var o = [XML_HEADER, writextag('comments', null, {\n      'xmlns': XMLNS_main[0]\n    })];\n    var iauthor = [];\n    o.push(\"<authors>\");\n    data.forEach(function (x) {\n      x[1].forEach(function (w) {\n        var a = escapexml(w.a);\n        if (iauthor.indexOf(a) == -1) {\n          iauthor.push(a);\n          o.push(\"<author>\" + a + \"</author>\");\n        }\n        if (w.T && w.ID && iauthor.indexOf(\"tc=\" + w.ID) == -1) {\n          iauthor.push(\"tc=\" + w.ID);\n          o.push(\"<author>\" + \"tc=\" + w.ID + \"</author>\");\n        }\n      });\n    });\n    if (iauthor.length == 0) {\n      iauthor.push(\"SheetJ5\");\n      o.push(\"<author>SheetJ5</author>\");\n    }\n    o.push(\"</authors>\");\n    o.push(\"<commentList>\");\n    data.forEach(function (d) {\n      /* 18.7.3 CT_Comment */\n      var lastauthor = 0,\n        ts = [];\n      if (d[1][0] && d[1][0].T && d[1][0].ID) lastauthor = iauthor.indexOf(\"tc=\" + d[1][0].ID);else d[1].forEach(function (c) {\n        if (c.a) lastauthor = iauthor.indexOf(escapexml(c.a));\n        ts.push(c.t || \"\");\n      });\n      o.push('<comment ref=\"' + d[0] + '\" authorId=\"' + lastauthor + '\"><text>');\n      if (ts.length <= 1) o.push(writetag(\"t\", escapexml(ts[0] || \"\")));else {\n        /* based on Threaded Comments -> Comments projection */\n        var t = \"Comment:\\n    \" + ts[0] + \"\\n\";\n        for (var i = 1; i < ts.length; ++i) t += \"Reply:\\n    \" + ts[i] + \"\\n\";\n        o.push(writetag(\"t\", escapexml(t)));\n      }\n      o.push('</text></comment>');\n    });\n    o.push(\"</commentList>\");\n    if (o.length > 2) {\n      o[o.length] = '</comments>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n    return o.join(\"\");\n  }\n\n  /* [MS-XLSX] 2.1.17 */\n  function parse_tcmnt_xml(data, opts) {\n    var out = [];\n    var pass = false,\n      comment = {},\n      tidx = 0;\n    data.replace(tagregex, function xml_tcmnt(x, idx) {\n      var y = parsexmltag(x);\n      switch (strip_ns(y[0])) {\n        case '<?xml':\n          break;\n\n        /* 2.6.207 ThreadedComments CT_ThreadedComments */\n        case '<ThreadedComments':\n          break;\n        case '</ThreadedComments>':\n          break;\n\n        /* 2.6.205 threadedComment CT_ThreadedComment */\n        case '<threadedComment':\n          comment = {\n            author: y.personId,\n            guid: y.id,\n            ref: y.ref,\n            T: 1\n          };\n          break;\n        case '</threadedComment>':\n          if (comment.t != null) out.push(comment);\n          break;\n        case '<text>':\n        case '<text':\n          tidx = idx + x.length;\n          break;\n        case '</text>':\n          comment.t = data.slice(tidx, idx).replace(/\\r\\n/g, \"\\n\").replace(/\\r/g, \"\\n\");\n          break;\n\n        /* 2.6.206 mentions CT_ThreadedCommentMentions TODO */\n        case '<mentions':\n        case '<mentions>':\n          pass = true;\n          break;\n        case '</mentions>':\n          pass = false;\n          break;\n\n        /* 2.6.202 mention CT_Mention TODO */\n\n        /* 18.2.10 extLst CT_ExtensionList ? */\n        case '<extLst':\n        case '<extLst>':\n        case '</extLst>':\n        case '<extLst/>':\n          break;\n        /* 18.2.7  ext CT_Extension + */\n        case '<ext':\n          pass = true;\n          break;\n        case '</ext>':\n          pass = false;\n          break;\n        default:\n          if (!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in threaded comments');\n      }\n      return x;\n    });\n    return out;\n  }\n  function write_tcmnt_xml(comments, people, opts) {\n    var o = [XML_HEADER, writextag('ThreadedComments', null, {\n      'xmlns': XMLNS.TCMNT\n    }).replace(/[\\/]>/, \">\")];\n    comments.forEach(function (carr) {\n      var rootid = \"\";\n      (carr[1] || []).forEach(function (c, idx) {\n        if (!c.T) {\n          delete c.ID;\n          return;\n        }\n        if (c.a && people.indexOf(c.a) == -1) people.push(c.a);\n        var tcopts = {\n          ref: carr[0],\n          id: \"{54EE7951-7262-4200-6969-\" + (\"000000000000\" + opts.tcid++).slice(-12) + \"}\"\n        };\n        if (idx == 0) rootid = tcopts.id;else tcopts.parentId = rootid;\n        c.ID = tcopts.id;\n        if (c.a) tcopts.personId = \"{54EE7950-7262-4200-6969-\" + (\"000000000000\" + people.indexOf(c.a)).slice(-12) + \"}\";\n        o.push(writextag('threadedComment', writetag('text', c.t || \"\"), tcopts));\n      });\n    });\n    o.push('</ThreadedComments>');\n    return o.join(\"\");\n  }\n\n  /* [MS-XLSX] 2.1.18 */\n  function parse_people_xml(data, opts) {\n    var out = [];\n    var pass = false;\n    data.replace(tagregex, function xml_tcmnt(x) {\n      var y = parsexmltag(x);\n      switch (strip_ns(y[0])) {\n        case '<?xml':\n          break;\n\n        /* 2.4.85 personList CT_PersonList */\n        case '<personList':\n          break;\n        case '</personList>':\n          break;\n\n        /* 2.6.203 person CT_Person TODO: providers */\n        case '<person':\n          out.push({\n            name: y.displayname,\n            id: y.id\n          });\n          break;\n        case '</person>':\n          break;\n\n        /* 18.2.10 extLst CT_ExtensionList ? */\n        case '<extLst':\n        case '<extLst>':\n        case '</extLst>':\n        case '<extLst/>':\n          break;\n        /* 18.2.7  ext CT_Extension + */\n        case '<ext':\n          pass = true;\n          break;\n        case '</ext>':\n          pass = false;\n          break;\n        default:\n          if (!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in threaded comments');\n      }\n      return x;\n    });\n    return out;\n  }\n  function write_people_xml(people /*, opts*/) {\n    var o = [XML_HEADER, writextag('personList', null, {\n      'xmlns': XMLNS.TCMNT,\n      'xmlns:x': XMLNS_main[0]\n    }).replace(/[\\/]>/, \">\")];\n    people.forEach(function (person, idx) {\n      o.push(writextag('person', null, {\n        displayName: person,\n        id: \"{54EE7950-7262-4200-6969-\" + (\"000000000000\" + idx).slice(-12) + \"}\",\n        userId: person,\n        providerId: \"None\"\n      }));\n    });\n    o.push(\"</personList>\");\n    return o.join(\"\");\n  }\n  /* [MS-XLSB] 2.4.28 BrtBeginComment */\n  function parse_BrtBeginComment(data) {\n    var out = {};\n    out.iauthor = data.read_shift(4);\n    var rfx = parse_UncheckedRfX(data, 16);\n    out.rfx = rfx.s;\n    out.ref = encode_cell(rfx.s);\n    data.l += 16; /*var guid = parse_GUID(data); */\n    return out;\n  }\n  function write_BrtBeginComment(data, o) {\n    if (o == null) o = new_buf(36);\n    o.write_shift(4, data[1].iauthor);\n    write_UncheckedRfX(data[0], o);\n    o.write_shift(4, 0);\n    o.write_shift(4, 0);\n    o.write_shift(4, 0);\n    o.write_shift(4, 0);\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.327 BrtCommentAuthor */\n  var parse_BrtCommentAuthor = parse_XLWideString;\n  function write_BrtCommentAuthor(data) {\n    return write_XLWideString(data.slice(0, 54));\n  }\n\n  /* [MS-XLSB] 2.1.7.8 Comments */\n  function parse_comments_bin(data, opts) {\n    var out = [];\n    var authors = [];\n    var c = {};\n    var pass = false;\n    recordhopper(data, function hopper_cmnt(val, R, RT) {\n      switch (RT) {\n        case 0x0278:\n          /* 'BrtCommentAuthor' */\n          authors.push(val);\n          break;\n        case 0x027B:\n          /* 'BrtBeginComment' */\n          c = val;\n          break;\n        case 0x027D:\n          /* 'BrtCommentText' */\n          c.t = val.t;\n          c.h = val.h;\n          c.r = val.r;\n          break;\n        case 0x027C:\n          /* 'BrtEndComment' */\n          c.author = authors[c.iauthor];\n          delete c.iauthor;\n          if (opts.sheetRows && c.rfx && opts.sheetRows <= c.rfx.r) break;\n          if (!c.t) c.t = \"\";\n          delete c.rfx;\n          out.push(c);\n          break;\n        case 0x0C00:\n          /* 'BrtUid' */\n          break;\n        case 0x0023:\n          /* 'BrtFRTBegin' */\n          pass = true;\n          break;\n        case 0x0024:\n          /* 'BrtFRTEnd' */\n          pass = false;\n          break;\n        case 0x0025:\n          /* 'BrtACBegin' */break;\n        case 0x0026:\n          /* 'BrtACEnd' */break;\n        default:\n          if (R.T) {/* empty */} else if (!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n      }\n    });\n    return out;\n  }\n  function write_comments_bin(data) {\n    var ba = buf_array();\n    var iauthor = [];\n    write_record(ba, 0x0274 /* BrtBeginComments */);\n\n    write_record(ba, 0x0276 /* BrtBeginCommentAuthors */);\n    data.forEach(function (comment) {\n      comment[1].forEach(function (c) {\n        if (iauthor.indexOf(c.a) > -1) return;\n        iauthor.push(c.a.slice(0, 54));\n        write_record(ba, 0x0278 /* BrtCommentAuthor */, write_BrtCommentAuthor(c.a));\n      });\n    });\n    write_record(ba, 0x0277 /* BrtEndCommentAuthors */);\n\n    write_record(ba, 0x0279 /* BrtBeginCommentList */);\n    data.forEach(function (comment) {\n      comment[1].forEach(function (c) {\n        c.iauthor = iauthor.indexOf(c.a);\n        var range = {\n          s: decode_cell(comment[0]),\n          e: decode_cell(comment[0])\n        };\n        write_record(ba, 0x027B /* BrtBeginComment */, write_BrtBeginComment([range, c]));\n        if (c.t && c.t.length > 0) write_record(ba, 0x027D /* BrtCommentText */, write_BrtCommentText(c));\n        write_record(ba, 0x027C /* BrtEndComment */);\n        delete c.iauthor;\n      });\n    });\n    write_record(ba, 0x027A /* BrtEndCommentList */);\n\n    write_record(ba, 0x0275 /* BrtEndComments */);\n    return ba.end();\n  }\n  var CT_VBA = \"application/vnd.ms-office.vbaProject\";\n  function make_vba_xls(cfb) {\n    var newcfb = CFB.utils.cfb_new({\n      root: \"R\"\n    });\n    cfb.FullPaths.forEach(function (p, i) {\n      if (p.slice(-1) === \"/\" || !p.match(/_VBA_PROJECT_CUR/)) return;\n      var newpath = p.replace(/^[^\\/]*/, \"R\").replace(/\\/_VBA_PROJECT_CUR\\u0000*/, \"\");\n      CFB.utils.cfb_add(newcfb, newpath, cfb.FileIndex[i].content);\n    });\n    return CFB.write(newcfb);\n  }\n  function fill_vba_xls(cfb, vba) {\n    vba.FullPaths.forEach(function (p, i) {\n      if (i == 0) return;\n      var newpath = p.replace(/[^\\/]*[\\/]/, \"/_VBA_PROJECT_CUR/\");\n      if (newpath.slice(-1) !== \"/\") CFB.utils.cfb_add(cfb, newpath, vba.FileIndex[i].content);\n    });\n  }\n  var VBAFMTS = [\"xlsb\", \"xlsm\", \"xlam\", \"biff8\", \"xla\"];\n  /* macro and dialog sheet stubs */\n  function parse_ds_bin() {\n    return {\n      '!type': 'dialog'\n    };\n  }\n  function parse_ds_xml() {\n    return {\n      '!type': 'dialog'\n    };\n  }\n  function parse_ms_bin() {\n    return {\n      '!type': 'macro'\n    };\n  }\n  function parse_ms_xml() {\n    return {\n      '!type': 'macro'\n    };\n  }\n  /* TODO: it will be useful to parse the function str */\n  var rc_to_a1 = function () {\n    var rcregex = /(^|[^A-Za-z_])R(\\[?-?\\d+\\]|[1-9]\\d*|)C(\\[?-?\\d+\\]|[1-9]\\d*|)(?![A-Za-z0-9_])/g;\n    var rcbase = {\n      r: 0,\n      c: 0\n    };\n    function rcfunc($$, $1, $2, $3) {\n      var cRel = false,\n        rRel = false;\n      if ($2.length == 0) rRel = true;else if ($2.charAt(0) == \"[\") {\n        rRel = true;\n        $2 = $2.slice(1, -1);\n      }\n      if ($3.length == 0) cRel = true;else if ($3.charAt(0) == \"[\") {\n        cRel = true;\n        $3 = $3.slice(1, -1);\n      }\n      var R = $2.length > 0 ? parseInt($2, 10) | 0 : 0,\n        C = $3.length > 0 ? parseInt($3, 10) | 0 : 0;\n      if (cRel) C += rcbase.c;else --C;\n      if (rRel) R += rcbase.r;else --R;\n      return $1 + (cRel ? \"\" : \"$\") + encode_col(C) + (rRel ? \"\" : \"$\") + encode_row(R);\n    }\n    return function rc_to_a1(fstr, base) {\n      rcbase = base;\n      return fstr.replace(rcregex, rcfunc);\n    };\n  }();\n  var crefregex = /(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})(?![_.\\(A-Za-z0-9])/g;\n  var a1_to_rc = function () {\n    return function a1_to_rc(fstr, base) {\n      return fstr.replace(crefregex, function ($0, $1, $2, $3, $4, $5) {\n        var c = decode_col($3) - ($2 ? 0 : base.c);\n        var r = decode_row($5) - ($4 ? 0 : base.r);\n        var R = r == 0 ? \"\" : !$4 ? \"[\" + r + \"]\" : r + 1;\n        var C = c == 0 ? \"\" : !$2 ? \"[\" + c + \"]\" : c + 1;\n        return $1 + \"R\" + R + \"C\" + C;\n      });\n    };\n  }();\n\n  /* no defined name can collide with a valid cell address A1:XFD1048576 ... except LOG10! */\n  function shift_formula_str(f, delta) {\n    return f.replace(crefregex, function ($0, $1, $2, $3, $4, $5) {\n      return $1 + ($2 == \"$\" ? $2 + $3 : encode_col(decode_col($3) + delta.c)) + ($4 == \"$\" ? $4 + $5 : encode_row(decode_row($5) + delta.r));\n    });\n  }\n  function shift_formula_xlsx(f, range, cell) {\n    var r = decode_range(range),\n      s = r.s,\n      c = decode_cell(cell);\n    var delta = {\n      r: c.r - s.r,\n      c: c.c - s.c\n    };\n    return shift_formula_str(f, delta);\n  }\n\n  /* TODO: parse formula */\n  function fuzzyfmla(f) {\n    if (f.length == 1) return false;\n    return true;\n  }\n  function _xlfn(f) {\n    return f.replace(/_xlfn\\./g, \"\");\n  }\n  function parseread1(blob) {\n    blob.l += 1;\n    return;\n  }\n\n  /* [MS-XLS] 2.5.51 */\n  function parse_ColRelU(blob, length) {\n    var c = blob.read_shift(length == 1 ? 1 : 2);\n    return [c & 0x3FFF, c >> 14 & 1, c >> 15 & 1];\n  }\n\n  /* [MS-XLS] 2.5.198.105 ; [MS-XLSB] 2.5.97.89 */\n  function parse_RgceArea(blob, length, opts) {\n    var w = 2;\n    if (opts) {\n      if (opts.biff >= 2 && opts.biff <= 5) return parse_RgceArea_BIFF2(blob, length, opts);else if (opts.biff == 12) w = 4;\n    }\n    var r = blob.read_shift(w),\n      R = blob.read_shift(w);\n    var c = parse_ColRelU(blob, 2);\n    var C = parse_ColRelU(blob, 2);\n    return {\n      s: {\n        r: r,\n        c: c[0],\n        cRel: c[1],\n        rRel: c[2]\n      },\n      e: {\n        r: R,\n        c: C[0],\n        cRel: C[1],\n        rRel: C[2]\n      }\n    };\n  }\n  /* BIFF 2-5 encodes flags in the row field */\n  function parse_RgceArea_BIFF2(blob) {\n    var r = parse_ColRelU(blob, 2),\n      R = parse_ColRelU(blob, 2);\n    var c = blob.read_shift(1);\n    var C = blob.read_shift(1);\n    return {\n      s: {\n        r: r[0],\n        c: c,\n        cRel: r[1],\n        rRel: r[2]\n      },\n      e: {\n        r: R[0],\n        c: C,\n        cRel: R[1],\n        rRel: R[2]\n      }\n    };\n  }\n\n  /* [MS-XLS] 2.5.198.105 ; [MS-XLSB] 2.5.97.90 */\n  function parse_RgceAreaRel(blob, length, opts) {\n    if (opts.biff < 8) return parse_RgceArea_BIFF2(blob, length, opts);\n    var r = blob.read_shift(opts.biff == 12 ? 4 : 2),\n      R = blob.read_shift(opts.biff == 12 ? 4 : 2);\n    var c = parse_ColRelU(blob, 2);\n    var C = parse_ColRelU(blob, 2);\n    return {\n      s: {\n        r: r,\n        c: c[0],\n        cRel: c[1],\n        rRel: c[2]\n      },\n      e: {\n        r: R,\n        c: C[0],\n        cRel: C[1],\n        rRel: C[2]\n      }\n    };\n  }\n\n  /* [MS-XLS] 2.5.198.109 ; [MS-XLSB] 2.5.97.91 */\n  function parse_RgceLoc(blob, length, opts) {\n    if (opts && opts.biff >= 2 && opts.biff <= 5) return parse_RgceLoc_BIFF2(blob, length, opts);\n    var r = blob.read_shift(opts && opts.biff == 12 ? 4 : 2);\n    var c = parse_ColRelU(blob, 2);\n    return {\n      r: r,\n      c: c[0],\n      cRel: c[1],\n      rRel: c[2]\n    };\n  }\n  function parse_RgceLoc_BIFF2(blob) {\n    var r = parse_ColRelU(blob, 2);\n    var c = blob.read_shift(1);\n    return {\n      r: r[0],\n      c: c,\n      cRel: r[1],\n      rRel: r[2]\n    };\n  }\n\n  /* [MS-XLS] 2.5.198.107, 2.5.47 */\n  function parse_RgceElfLoc(blob) {\n    var r = blob.read_shift(2);\n    var c = blob.read_shift(2);\n    return {\n      r: r,\n      c: c & 0xFF,\n      fQuoted: !!(c & 0x4000),\n      cRel: c >> 15,\n      rRel: c >> 15\n    };\n  }\n\n  /* [MS-XLS] 2.5.198.111 ; [MS-XLSB] 2.5.97.92 TODO */\n  function parse_RgceLocRel(blob, length, opts) {\n    var biff = opts && opts.biff ? opts.biff : 8;\n    if (biff >= 2 && biff <= 5) return parse_RgceLocRel_BIFF2(blob, length, opts);\n    var r = blob.read_shift(biff >= 12 ? 4 : 2);\n    var cl = blob.read_shift(2);\n    var cRel = (cl & 0x4000) >> 14,\n      rRel = (cl & 0x8000) >> 15;\n    cl &= 0x3FFF;\n    if (rRel == 1) while (r > 0x7FFFF) r -= 0x100000;\n    if (cRel == 1) while (cl > 0x1FFF) cl = cl - 0x4000;\n    return {\n      r: r,\n      c: cl,\n      cRel: cRel,\n      rRel: rRel\n    };\n  }\n  function parse_RgceLocRel_BIFF2(blob) {\n    var rl = blob.read_shift(2);\n    var c = blob.read_shift(1);\n    var rRel = (rl & 0x8000) >> 15,\n      cRel = (rl & 0x4000) >> 14;\n    rl &= 0x3FFF;\n    if (rRel == 1 && rl >= 0x2000) rl = rl - 0x4000;\n    if (cRel == 1 && c >= 0x80) c = c - 0x100;\n    return {\n      r: rl,\n      c: c,\n      cRel: cRel,\n      rRel: rRel\n    };\n  }\n\n  /* [MS-XLS] 2.5.198.27 ; [MS-XLSB] 2.5.97.18 */\n  function parse_PtgArea(blob, length, opts) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    var area = parse_RgceArea(blob, opts.biff >= 2 && opts.biff <= 5 ? 6 : 8, opts);\n    return [type, area];\n  }\n\n  /* [MS-XLS] 2.5.198.28 ; [MS-XLSB] 2.5.97.19 */\n  function parse_PtgArea3d(blob, length, opts) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    var ixti = blob.read_shift(2, 'i');\n    var w = 8;\n    if (opts) switch (opts.biff) {\n      case 5:\n        blob.l += 12;\n        w = 6;\n        break;\n      case 12:\n        w = 12;\n        break;\n    }\n    var area = parse_RgceArea(blob, w, opts);\n    return [type, ixti, area];\n  }\n\n  /* [MS-XLS] 2.5.198.29 ; [MS-XLSB] 2.5.97.20 */\n  function parse_PtgAreaErr(blob, length, opts) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    blob.l += opts && opts.biff > 8 ? 12 : opts.biff < 8 ? 6 : 8;\n    return [type];\n  }\n  /* [MS-XLS] 2.5.198.30 ; [MS-XLSB] 2.5.97.21 */\n  function parse_PtgAreaErr3d(blob, length, opts) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    var ixti = blob.read_shift(2);\n    var w = 8;\n    if (opts) switch (opts.biff) {\n      case 5:\n        blob.l += 12;\n        w = 6;\n        break;\n      case 12:\n        w = 12;\n        break;\n    }\n    blob.l += w;\n    return [type, ixti];\n  }\n\n  /* [MS-XLS] 2.5.198.31 ; [MS-XLSB] 2.5.97.22 */\n  function parse_PtgAreaN(blob, length, opts) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    var area = parse_RgceAreaRel(blob, length - 1, opts);\n    return [type, area];\n  }\n\n  /* [MS-XLS] 2.5.198.32 ; [MS-XLSB] 2.5.97.23 */\n  function parse_PtgArray(blob, length, opts) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    blob.l += opts.biff == 2 ? 6 : opts.biff == 12 ? 14 : 7;\n    return [type];\n  }\n\n  /* [MS-XLS] 2.5.198.33 ; [MS-XLSB] 2.5.97.24 */\n  function parse_PtgAttrBaxcel(blob) {\n    var bitSemi = blob[blob.l + 1] & 0x01; /* 1 = volatile */\n    var bitBaxcel = 1;\n    blob.l += 4;\n    return [bitSemi, bitBaxcel];\n  }\n\n  /* [MS-XLS] 2.5.198.34 ; [MS-XLSB] 2.5.97.25 */\n  function parse_PtgAttrChoose(blob, length, opts) {\n    blob.l += 2;\n    var offset = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n    var o = [];\n    /* offset is 1 less than the number of elements */\n    for (var i = 0; i <= offset; ++i) o.push(blob.read_shift(opts && opts.biff == 2 ? 1 : 2));\n    return o;\n  }\n\n  /* [MS-XLS] 2.5.198.35 ; [MS-XLSB] 2.5.97.26 */\n  function parse_PtgAttrGoto(blob, length, opts) {\n    var bitGoto = blob[blob.l + 1] & 0xFF ? 1 : 0;\n    blob.l += 2;\n    return [bitGoto, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n  }\n\n  /* [MS-XLS] 2.5.198.36 ; [MS-XLSB] 2.5.97.27 */\n  function parse_PtgAttrIf(blob, length, opts) {\n    var bitIf = blob[blob.l + 1] & 0xFF ? 1 : 0;\n    blob.l += 2;\n    return [bitIf, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n  }\n\n  /* [MS-XLSB] 2.5.97.28 */\n  function parse_PtgAttrIfError(blob) {\n    var bitIf = blob[blob.l + 1] & 0xFF ? 1 : 0;\n    blob.l += 2;\n    return [bitIf, blob.read_shift(2)];\n  }\n\n  /* [MS-XLS] 2.5.198.37 ; [MS-XLSB] 2.5.97.29 */\n  function parse_PtgAttrSemi(blob, length, opts) {\n    var bitSemi = blob[blob.l + 1] & 0xFF ? 1 : 0;\n    blob.l += opts && opts.biff == 2 ? 3 : 4;\n    return [bitSemi];\n  }\n\n  /* [MS-XLS] 2.5.198.40 ; [MS-XLSB] 2.5.97.32 */\n  function parse_PtgAttrSpaceType(blob) {\n    var type = blob.read_shift(1),\n      cch = blob.read_shift(1);\n    return [type, cch];\n  }\n\n  /* [MS-XLS] 2.5.198.38 ; [MS-XLSB] 2.5.97.30 */\n  function parse_PtgAttrSpace(blob) {\n    blob.read_shift(2);\n    return parse_PtgAttrSpaceType(blob, 2);\n  }\n\n  /* [MS-XLS] 2.5.198.39 ; [MS-XLSB] 2.5.97.31 */\n  function parse_PtgAttrSpaceSemi(blob) {\n    blob.read_shift(2);\n    return parse_PtgAttrSpaceType(blob, 2);\n  }\n\n  /* [MS-XLS] 2.5.198.84 ; [MS-XLSB] 2.5.97.68 TODO */\n  function parse_PtgRef(blob, length, opts) {\n    //var ptg = blob[blob.l] & 0x1F;\n    var type = (blob[blob.l] & 0x60) >> 5;\n    blob.l += 1;\n    var loc = parse_RgceLoc(blob, 0, opts);\n    return [type, loc];\n  }\n\n  /* [MS-XLS] 2.5.198.88 ; [MS-XLSB] 2.5.97.72 TODO */\n  function parse_PtgRefN(blob, length, opts) {\n    var type = (blob[blob.l] & 0x60) >> 5;\n    blob.l += 1;\n    var loc = parse_RgceLocRel(blob, 0, opts);\n    return [type, loc];\n  }\n\n  /* [MS-XLS] 2.5.198.85 ; [MS-XLSB] 2.5.97.69 TODO */\n  function parse_PtgRef3d(blob, length, opts) {\n    var type = (blob[blob.l] & 0x60) >> 5;\n    blob.l += 1;\n    var ixti = blob.read_shift(2); // XtiIndex\n    if (opts && opts.biff == 5) blob.l += 12;\n    var loc = parse_RgceLoc(blob, 0, opts); // TODO: or RgceLocRel\n    return [type, ixti, loc];\n  }\n\n  /* [MS-XLS] 2.5.198.62 ; [MS-XLSB] 2.5.97.45 TODO */\n  function parse_PtgFunc(blob, length, opts) {\n    //var ptg = blob[blob.l] & 0x1F;\n    var type = (blob[blob.l] & 0x60) >> 5;\n    blob.l += 1;\n    var iftab = blob.read_shift(opts && opts.biff <= 3 ? 1 : 2);\n    return [FtabArgc[iftab], Ftab[iftab], type];\n  }\n  /* [MS-XLS] 2.5.198.63 ; [MS-XLSB] 2.5.97.46 TODO */\n  function parse_PtgFuncVar(blob, length, opts) {\n    var type = blob[blob.l++];\n    var cparams = blob.read_shift(1),\n      tab = opts && opts.biff <= 3 ? [type == 0x58 ? -1 : 0, blob.read_shift(1)] : parsetab(blob);\n    return [cparams, (tab[0] === 0 ? Ftab : Cetab)[tab[1]]];\n  }\n  function parsetab(blob) {\n    return [blob[blob.l + 1] >> 7, blob.read_shift(2) & 0x7FFF];\n  }\n\n  /* [MS-XLS] 2.5.198.41 ; [MS-XLSB] 2.5.97.33 */\n  function parse_PtgAttrSum(blob, length, opts) {\n    blob.l += opts && opts.biff == 2 ? 3 : 4;\n    return;\n  }\n\n  /* [MS-XLS] 2.5.198.58 ; [MS-XLSB] 2.5.97.40 */\n  function parse_PtgExp(blob, length, opts) {\n    blob.l++;\n    if (opts && opts.biff == 12) return [blob.read_shift(4, 'i'), 0];\n    var row = blob.read_shift(2);\n    var col = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n    return [row, col];\n  }\n\n  /* [MS-XLS] 2.5.198.57 ; [MS-XLSB] 2.5.97.39 */\n  function parse_PtgErr(blob) {\n    blob.l++;\n    return BErr[blob.read_shift(1)];\n  }\n\n  /* [MS-XLS] 2.5.198.66 ; [MS-XLSB] 2.5.97.49 */\n  function parse_PtgInt(blob) {\n    blob.l++;\n    return blob.read_shift(2);\n  }\n\n  /* [MS-XLS] 2.5.198.42 ; [MS-XLSB] 2.5.97.34 */\n  function parse_PtgBool(blob) {\n    blob.l++;\n    return blob.read_shift(1) !== 0;\n  }\n\n  /* [MS-XLS] 2.5.198.79 ; [MS-XLSB] 2.5.97.63 */\n  function parse_PtgNum(blob) {\n    blob.l++;\n    return parse_Xnum(blob, 8);\n  }\n\n  /* [MS-XLS] 2.5.198.89 ; [MS-XLSB] 2.5.97.74 */\n  function parse_PtgStr(blob, length, opts) {\n    blob.l++;\n    return parse_ShortXLUnicodeString(blob, length - 1, opts);\n  }\n\n  /* [MS-XLS] 2.5.192.112 + 2.5.192.11{3,4,5,6,7} */\n  /* [MS-XLSB] 2.5.97.93 + 2.5.97.9{4,5,6,7} */\n  function parse_SerAr(blob, biff) {\n    var val = [blob.read_shift(1)];\n    if (biff == 12) switch (val[0]) {\n      case 0x02:\n        val[0] = 0x04;\n        break;\n      /* SerBool */\n      case 0x04:\n        val[0] = 0x10;\n        break;\n      /* SerErr */\n      case 0x00:\n        val[0] = 0x01;\n        break;\n      /* SerNum */\n      case 0x01:\n        val[0] = 0x02;\n        break;\n      /* SerStr */\n    }\n\n    switch (val[0]) {\n      case 0x04:\n        /* SerBool -- boolean */\n        val[1] = parsebool(blob, 1) ? 'TRUE' : 'FALSE';\n        if (biff != 12) blob.l += 7;\n        break;\n      case 0x25: /* appears to be an alias */\n      case 0x10:\n        /* SerErr -- error */\n        val[1] = BErr[blob[blob.l]];\n        blob.l += biff == 12 ? 4 : 8;\n        break;\n      case 0x00:\n        /* SerNil -- honestly, I'm not sure how to reproduce this */\n        blob.l += 8;\n        break;\n      case 0x01:\n        /* SerNum -- Xnum */\n        val[1] = parse_Xnum(blob, 8);\n        break;\n      case 0x02:\n        /* SerStr -- XLUnicodeString (<256 chars) */\n        val[1] = parse_XLUnicodeString2(blob, 0, {\n          biff: biff > 0 && biff < 8 ? 2 : biff\n        });\n        break;\n      default:\n        throw new Error(\"Bad SerAr: \" + val[0]);\n      /* Unreachable */\n    }\n\n    return val;\n  }\n\n  /* [MS-XLS] 2.5.198.61 ; [MS-XLSB] 2.5.97.44 */\n  function parse_PtgExtraMem(blob, cce, opts) {\n    var count = blob.read_shift(opts.biff == 12 ? 4 : 2);\n    var out = [];\n    for (var i = 0; i != count; ++i) out.push((opts.biff == 12 ? parse_UncheckedRfX : parse_Ref8U)(blob, 8));\n    return out;\n  }\n\n  /* [MS-XLS] 2.5.198.59 ; [MS-XLSB] 2.5.97.41 */\n  function parse_PtgExtraArray(blob, length, opts) {\n    var rows = 0,\n      cols = 0;\n    if (opts.biff == 12) {\n      rows = blob.read_shift(4); // DRw\n      cols = blob.read_shift(4); // DCol\n    } else {\n      cols = 1 + blob.read_shift(1); //DColByteU\n      rows = 1 + blob.read_shift(2); //DRw\n    }\n\n    if (opts.biff >= 2 && opts.biff < 8) {\n      --rows;\n      if (--cols == 0) cols = 0x100;\n    }\n    // $FlowIgnore\n    for (var i = 0, o = []; i != rows && (o[i] = []); ++i) for (var j = 0; j != cols; ++j) o[i][j] = parse_SerAr(blob, opts.biff);\n    return o;\n  }\n\n  /* [MS-XLS] 2.5.198.76 ; [MS-XLSB] 2.5.97.60 */\n  function parse_PtgName(blob, length, opts) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    var w = !opts || opts.biff >= 8 ? 4 : 2;\n    var nameindex = blob.read_shift(w);\n    switch (opts.biff) {\n      case 2:\n        blob.l += 5;\n        break;\n      case 3:\n      case 4:\n        blob.l += 8;\n        break;\n      case 5:\n        blob.l += 12;\n        break;\n    }\n    return [type, 0, nameindex];\n  }\n\n  /* [MS-XLS] 2.5.198.77 ; [MS-XLSB] 2.5.97.61 */\n  function parse_PtgNameX(blob, length, opts) {\n    if (opts.biff == 5) return parse_PtgNameX_BIFF5(blob, length, opts);\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    var ixti = blob.read_shift(2); // XtiIndex\n    var nameindex = blob.read_shift(4);\n    return [type, ixti, nameindex];\n  }\n  function parse_PtgNameX_BIFF5(blob) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    var ixti = blob.read_shift(2, 'i'); // XtiIndex\n    blob.l += 8;\n    var nameindex = blob.read_shift(2);\n    blob.l += 12;\n    return [type, ixti, nameindex];\n  }\n\n  /* [MS-XLS] 2.5.198.70 ; [MS-XLSB] 2.5.97.54 */\n  function parse_PtgMemArea(blob, length, opts) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    blob.l += opts && opts.biff == 2 ? 3 : 4;\n    var cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n    return [type, cce];\n  }\n\n  /* [MS-XLS] 2.5.198.72 ; [MS-XLSB] 2.5.97.56 */\n  function parse_PtgMemFunc(blob, length, opts) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    var cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n    return [type, cce];\n  }\n\n  /* [MS-XLS] 2.5.198.86 ; [MS-XLSB] 2.5.97.69 */\n  function parse_PtgRefErr(blob, length, opts) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    blob.l += 4;\n    if (opts.biff < 8) blob.l--;\n    if (opts.biff == 12) blob.l += 2;\n    return [type];\n  }\n\n  /* [MS-XLS] 2.5.198.87 ; [MS-XLSB] 2.5.97.71 */\n  function parse_PtgRefErr3d(blob, length, opts) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    var ixti = blob.read_shift(2);\n    var w = 4;\n    if (opts) switch (opts.biff) {\n      case 5:\n        w = 15;\n        break;\n      case 12:\n        w = 6;\n        break;\n    }\n    blob.l += w;\n    return [type, ixti];\n  }\n\n  /* [MS-XLS] 2.5.198.71 ; [MS-XLSB] 2.5.97.55 */\n  var parse_PtgMemErr = parsenoop;\n  /* [MS-XLS] 2.5.198.73  ; [MS-XLSB] 2.5.97.57 */\n  var parse_PtgMemNoMem = parsenoop;\n  /* [MS-XLS] 2.5.198.92 */\n  var parse_PtgTbl = parsenoop;\n  function parse_PtgElfLoc(blob, length, opts) {\n    blob.l += 2;\n    return [parse_RgceElfLoc(blob, 4, opts)];\n  }\n  function parse_PtgElfNoop(blob) {\n    blob.l += 6;\n    return [];\n  }\n  /* [MS-XLS] 2.5.198.46 */\n  var parse_PtgElfCol = parse_PtgElfLoc;\n  /* [MS-XLS] 2.5.198.47 */\n  var parse_PtgElfColS = parse_PtgElfNoop;\n  /* [MS-XLS] 2.5.198.48 */\n  var parse_PtgElfColSV = parse_PtgElfNoop;\n  /* [MS-XLS] 2.5.198.49 */\n  var parse_PtgElfColV = parse_PtgElfLoc;\n  /* [MS-XLS] 2.5.198.50 */\n  function parse_PtgElfLel(blob) {\n    blob.l += 2;\n    return [parseuint16(blob), blob.read_shift(2) & 0x01];\n  }\n  /* [MS-XLS] 2.5.198.51 */\n  var parse_PtgElfRadical = parse_PtgElfLoc;\n  /* [MS-XLS] 2.5.198.52 */\n  var parse_PtgElfRadicalLel = parse_PtgElfLel;\n  /* [MS-XLS] 2.5.198.53 */\n  var parse_PtgElfRadicalS = parse_PtgElfNoop;\n  /* [MS-XLS] 2.5.198.54 */\n  var parse_PtgElfRw = parse_PtgElfLoc;\n  /* [MS-XLS] 2.5.198.55 */\n  var parse_PtgElfRwV = parse_PtgElfLoc;\n\n  /* [MS-XLSB] 2.5.97.52 TODO */\n  var PtgListRT = [\"Data\", \"All\", \"Headers\", \"??\", \"?Data2\", \"??\", \"?DataHeaders\", \"??\", \"Totals\", \"??\", \"??\", \"??\", \"?DataTotals\", \"??\", \"??\", \"??\", \"?Current\"];\n  function parse_PtgList(blob) {\n    blob.l += 2;\n    var ixti = blob.read_shift(2);\n    var flags = blob.read_shift(2);\n    var idx = blob.read_shift(4);\n    var c = blob.read_shift(2);\n    var C = blob.read_shift(2);\n    var rt = PtgListRT[flags >> 2 & 0x1F];\n    return {\n      ixti: ixti,\n      coltype: flags & 0x3,\n      rt: rt,\n      idx: idx,\n      c: c,\n      C: C\n    };\n  }\n  /* [MS-XLS] 2.5.198.91 ; [MS-XLSB] 2.5.97.76 */\n  function parse_PtgSxName(blob) {\n    blob.l += 2;\n    return [blob.read_shift(4)];\n  }\n\n  /* [XLS] old spec */\n  function parse_PtgSheet(blob, length, opts) {\n    blob.l += 5;\n    blob.l += 2;\n    blob.l += opts.biff == 2 ? 1 : 4;\n    return [\"PTGSHEET\"];\n  }\n  function parse_PtgEndSheet(blob, length, opts) {\n    blob.l += opts.biff == 2 ? 4 : 5;\n    return [\"PTGENDSHEET\"];\n  }\n  function parse_PtgMemAreaN(blob) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    var cce = blob.read_shift(2);\n    return [type, cce];\n  }\n  function parse_PtgMemNoMemN(blob) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    var cce = blob.read_shift(2);\n    return [type, cce];\n  }\n  function parse_PtgAttrNoop(blob) {\n    blob.l += 4;\n    return [0, 0];\n  }\n\n  /* [MS-XLS] 2.5.198.25 ; [MS-XLSB] 2.5.97.16 */\n  var PtgTypes = {\n    0x01: {\n      n: 'PtgExp',\n      f: parse_PtgExp\n    },\n    0x02: {\n      n: 'PtgTbl',\n      f: parse_PtgTbl\n    },\n    0x03: {\n      n: 'PtgAdd',\n      f: parseread1\n    },\n    0x04: {\n      n: 'PtgSub',\n      f: parseread1\n    },\n    0x05: {\n      n: 'PtgMul',\n      f: parseread1\n    },\n    0x06: {\n      n: 'PtgDiv',\n      f: parseread1\n    },\n    0x07: {\n      n: 'PtgPower',\n      f: parseread1\n    },\n    0x08: {\n      n: 'PtgConcat',\n      f: parseread1\n    },\n    0x09: {\n      n: 'PtgLt',\n      f: parseread1\n    },\n    0x0A: {\n      n: 'PtgLe',\n      f: parseread1\n    },\n    0x0B: {\n      n: 'PtgEq',\n      f: parseread1\n    },\n    0x0C: {\n      n: 'PtgGe',\n      f: parseread1\n    },\n    0x0D: {\n      n: 'PtgGt',\n      f: parseread1\n    },\n    0x0E: {\n      n: 'PtgNe',\n      f: parseread1\n    },\n    0x0F: {\n      n: 'PtgIsect',\n      f: parseread1\n    },\n    0x10: {\n      n: 'PtgUnion',\n      f: parseread1\n    },\n    0x11: {\n      n: 'PtgRange',\n      f: parseread1\n    },\n    0x12: {\n      n: 'PtgUplus',\n      f: parseread1\n    },\n    0x13: {\n      n: 'PtgUminus',\n      f: parseread1\n    },\n    0x14: {\n      n: 'PtgPercent',\n      f: parseread1\n    },\n    0x15: {\n      n: 'PtgParen',\n      f: parseread1\n    },\n    0x16: {\n      n: 'PtgMissArg',\n      f: parseread1\n    },\n    0x17: {\n      n: 'PtgStr',\n      f: parse_PtgStr\n    },\n    0x1A: {\n      n: 'PtgSheet',\n      f: parse_PtgSheet\n    },\n    0x1B: {\n      n: 'PtgEndSheet',\n      f: parse_PtgEndSheet\n    },\n    0x1C: {\n      n: 'PtgErr',\n      f: parse_PtgErr\n    },\n    0x1D: {\n      n: 'PtgBool',\n      f: parse_PtgBool\n    },\n    0x1E: {\n      n: 'PtgInt',\n      f: parse_PtgInt\n    },\n    0x1F: {\n      n: 'PtgNum',\n      f: parse_PtgNum\n    },\n    0x20: {\n      n: 'PtgArray',\n      f: parse_PtgArray\n    },\n    0x21: {\n      n: 'PtgFunc',\n      f: parse_PtgFunc\n    },\n    0x22: {\n      n: 'PtgFuncVar',\n      f: parse_PtgFuncVar\n    },\n    0x23: {\n      n: 'PtgName',\n      f: parse_PtgName\n    },\n    0x24: {\n      n: 'PtgRef',\n      f: parse_PtgRef\n    },\n    0x25: {\n      n: 'PtgArea',\n      f: parse_PtgArea\n    },\n    0x26: {\n      n: 'PtgMemArea',\n      f: parse_PtgMemArea\n    },\n    0x27: {\n      n: 'PtgMemErr',\n      f: parse_PtgMemErr\n    },\n    0x28: {\n      n: 'PtgMemNoMem',\n      f: parse_PtgMemNoMem\n    },\n    0x29: {\n      n: 'PtgMemFunc',\n      f: parse_PtgMemFunc\n    },\n    0x2A: {\n      n: 'PtgRefErr',\n      f: parse_PtgRefErr\n    },\n    0x2B: {\n      n: 'PtgAreaErr',\n      f: parse_PtgAreaErr\n    },\n    0x2C: {\n      n: 'PtgRefN',\n      f: parse_PtgRefN\n    },\n    0x2D: {\n      n: 'PtgAreaN',\n      f: parse_PtgAreaN\n    },\n    0x2E: {\n      n: 'PtgMemAreaN',\n      f: parse_PtgMemAreaN\n    },\n    0x2F: {\n      n: 'PtgMemNoMemN',\n      f: parse_PtgMemNoMemN\n    },\n    0x39: {\n      n: 'PtgNameX',\n      f: parse_PtgNameX\n    },\n    0x3A: {\n      n: 'PtgRef3d',\n      f: parse_PtgRef3d\n    },\n    0x3B: {\n      n: 'PtgArea3d',\n      f: parse_PtgArea3d\n    },\n    0x3C: {\n      n: 'PtgRefErr3d',\n      f: parse_PtgRefErr3d\n    },\n    0x3D: {\n      n: 'PtgAreaErr3d',\n      f: parse_PtgAreaErr3d\n    },\n    0xFF: {}\n  };\n  /* These are duplicated in the PtgTypes table */\n  var PtgDupes = {\n    0x40: 0x20,\n    0x60: 0x20,\n    0x41: 0x21,\n    0x61: 0x21,\n    0x42: 0x22,\n    0x62: 0x22,\n    0x43: 0x23,\n    0x63: 0x23,\n    0x44: 0x24,\n    0x64: 0x24,\n    0x45: 0x25,\n    0x65: 0x25,\n    0x46: 0x26,\n    0x66: 0x26,\n    0x47: 0x27,\n    0x67: 0x27,\n    0x48: 0x28,\n    0x68: 0x28,\n    0x49: 0x29,\n    0x69: 0x29,\n    0x4A: 0x2A,\n    0x6A: 0x2A,\n    0x4B: 0x2B,\n    0x6B: 0x2B,\n    0x4C: 0x2C,\n    0x6C: 0x2C,\n    0x4D: 0x2D,\n    0x6D: 0x2D,\n    0x4E: 0x2E,\n    0x6E: 0x2E,\n    0x4F: 0x2F,\n    0x6F: 0x2F,\n    0x58: 0x22,\n    0x78: 0x22,\n    0x59: 0x39,\n    0x79: 0x39,\n    0x5A: 0x3A,\n    0x7A: 0x3A,\n    0x5B: 0x3B,\n    0x7B: 0x3B,\n    0x5C: 0x3C,\n    0x7C: 0x3C,\n    0x5D: 0x3D,\n    0x7D: 0x3D\n  };\n  var Ptg18 = {\n    0x01: {\n      n: 'PtgElfLel',\n      f: parse_PtgElfLel\n    },\n    0x02: {\n      n: 'PtgElfRw',\n      f: parse_PtgElfRw\n    },\n    0x03: {\n      n: 'PtgElfCol',\n      f: parse_PtgElfCol\n    },\n    0x06: {\n      n: 'PtgElfRwV',\n      f: parse_PtgElfRwV\n    },\n    0x07: {\n      n: 'PtgElfColV',\n      f: parse_PtgElfColV\n    },\n    0x0A: {\n      n: 'PtgElfRadical',\n      f: parse_PtgElfRadical\n    },\n    0x0B: {\n      n: 'PtgElfRadicalS',\n      f: parse_PtgElfRadicalS\n    },\n    0x0D: {\n      n: 'PtgElfColS',\n      f: parse_PtgElfColS\n    },\n    0x0F: {\n      n: 'PtgElfColSV',\n      f: parse_PtgElfColSV\n    },\n    0x10: {\n      n: 'PtgElfRadicalLel',\n      f: parse_PtgElfRadicalLel\n    },\n    0x19: {\n      n: 'PtgList',\n      f: parse_PtgList\n    },\n    0x1D: {\n      n: 'PtgSxName',\n      f: parse_PtgSxName\n    },\n    0xFF: {}\n  };\n  var Ptg19 = {\n    0x00: {\n      n: 'PtgAttrNoop',\n      f: parse_PtgAttrNoop\n    },\n    0x01: {\n      n: 'PtgAttrSemi',\n      f: parse_PtgAttrSemi\n    },\n    0x02: {\n      n: 'PtgAttrIf',\n      f: parse_PtgAttrIf\n    },\n    0x04: {\n      n: 'PtgAttrChoose',\n      f: parse_PtgAttrChoose\n    },\n    0x08: {\n      n: 'PtgAttrGoto',\n      f: parse_PtgAttrGoto\n    },\n    0x10: {\n      n: 'PtgAttrSum',\n      f: parse_PtgAttrSum\n    },\n    0x20: {\n      n: 'PtgAttrBaxcel',\n      f: parse_PtgAttrBaxcel\n    },\n    0x21: {\n      n: 'PtgAttrBaxcel',\n      f: parse_PtgAttrBaxcel\n    },\n    0x40: {\n      n: 'PtgAttrSpace',\n      f: parse_PtgAttrSpace\n    },\n    0x41: {\n      n: 'PtgAttrSpaceSemi',\n      f: parse_PtgAttrSpaceSemi\n    },\n    0x80: {\n      n: 'PtgAttrIfError',\n      f: parse_PtgAttrIfError\n    },\n    0xFF: {}\n  };\n\n  /* [MS-XLS] 2.5.198.103 ; [MS-XLSB] 2.5.97.87 */\n  function parse_RgbExtra(blob, length, rgce, opts) {\n    if (opts.biff < 8) return parsenoop(blob, length);\n    var target = blob.l + length;\n    var o = [];\n    for (var i = 0; i !== rgce.length; ++i) {\n      switch (rgce[i][0]) {\n        case 'PtgArray':\n          /* PtgArray -> PtgExtraArray */\n          rgce[i][1] = parse_PtgExtraArray(blob, 0, opts);\n          o.push(rgce[i][1]);\n          break;\n        case 'PtgMemArea':\n          /* PtgMemArea -> PtgExtraMem */\n          rgce[i][2] = parse_PtgExtraMem(blob, rgce[i][1], opts);\n          o.push(rgce[i][2]);\n          break;\n        case 'PtgExp':\n          /* PtgExp -> PtgExtraCol */\n          if (opts && opts.biff == 12) {\n            rgce[i][1][1] = blob.read_shift(4);\n            o.push(rgce[i][1]);\n          }\n          break;\n        case 'PtgList': /* TODO: PtgList -> PtgExtraList */\n        case 'PtgElfRadicalS': /* TODO: PtgElfRadicalS -> PtgExtraElf */\n        case 'PtgElfColS': /* TODO: PtgElfColS -> PtgExtraElf */\n        case 'PtgElfColSV':\n          /* TODO: PtgElfColSV -> PtgExtraElf */\n          throw \"Unsupported \" + rgce[i][0];\n        default:\n          break;\n      }\n    }\n    length = target - blob.l;\n    /* note: this is technically an error but Excel disregards */\n    //if(target !== blob.l && blob.l !== target - length) throw new Error(target + \" != \" + blob.l);\n    if (length !== 0) o.push(parsenoop(blob, length));\n    return o;\n  }\n\n  /* [MS-XLS] 2.5.198.104 ; [MS-XLSB] 2.5.97.88 */\n  function parse_Rgce(blob, length, opts) {\n    var target = blob.l + length;\n    var R,\n      id,\n      ptgs = [];\n    while (target != blob.l) {\n      length = target - blob.l;\n      id = blob[blob.l];\n      R = PtgTypes[id] || PtgTypes[PtgDupes[id]];\n      if (id === 0x18 || id === 0x19) R = (id === 0x18 ? Ptg18 : Ptg19)[blob[blob.l + 1]];\n      if (!R || !R.f) {\n        /*ptgs.push*/parsenoop(blob, length);\n      } else {\n        ptgs.push([R.n, R.f(blob, length, opts)]);\n      }\n    }\n    return ptgs;\n  }\n  function stringify_array(f) {\n    var o = [];\n    for (var i = 0; i < f.length; ++i) {\n      var x = f[i],\n        r = [];\n      for (var j = 0; j < x.length; ++j) {\n        var y = x[j];\n        if (y) switch (y[0]) {\n          // TODO: handle embedded quotes\n          case 0x02:\n            r.push('\"' + y[1].replace(/\"/g, '\"\"') + '\"');\n            break;\n          default:\n            r.push(y[1]);\n        } else r.push(\"\");\n      }\n      o.push(r.join(\",\"));\n    }\n    return o.join(\";\");\n  }\n\n  /* [MS-XLS] 2.2.2 ; [MS-XLSB] 2.2.2 TODO */\n  var PtgBinOp = {\n    PtgAdd: \"+\",\n    PtgConcat: \"&\",\n    PtgDiv: \"/\",\n    PtgEq: \"=\",\n    PtgGe: \">=\",\n    PtgGt: \">\",\n    PtgLe: \"<=\",\n    PtgLt: \"<\",\n    PtgMul: \"*\",\n    PtgNe: \"<>\",\n    PtgPower: \"^\",\n    PtgSub: \"-\"\n  };\n\n  // List of invalid characters needs to be tested further\n  function formula_quote_sheet_name(sname, opts) {\n    if (!sname && !(opts && opts.biff <= 5 && opts.biff >= 2)) throw new Error(\"empty sheet name\");\n    if (/[^\\w\\u4E00-\\u9FFF\\u3040-\\u30FF]/.test(sname)) return \"'\" + sname + \"'\";\n    return sname;\n  }\n  function get_ixti_raw(supbooks, ixti, opts) {\n    if (!supbooks) return \"SH33TJSERR0\";\n    if (opts.biff > 8 && (!supbooks.XTI || !supbooks.XTI[ixti])) return supbooks.SheetNames[ixti];\n    if (!supbooks.XTI) return \"SH33TJSERR6\";\n    var XTI = supbooks.XTI[ixti];\n    if (opts.biff < 8) {\n      if (ixti > 10000) ixti -= 65536;\n      if (ixti < 0) ixti = -ixti;\n      return ixti == 0 ? \"\" : supbooks.XTI[ixti - 1];\n    }\n    if (!XTI) return \"SH33TJSERR1\";\n    var o = \"\";\n    if (opts.biff > 8) switch (supbooks[XTI[0]][0]) {\n      case 0x0165:\n        /* 'BrtSupSelf' */\n        o = XTI[1] == -1 ? \"#REF\" : supbooks.SheetNames[XTI[1]];\n        return XTI[1] == XTI[2] ? o : o + \":\" + supbooks.SheetNames[XTI[2]];\n      case 0x0166:\n        /* 'BrtSupSame' */\n        if (opts.SID != null) return supbooks.SheetNames[opts.SID];\n        return \"SH33TJSSAME\" + supbooks[XTI[0]][0];\n      case 0x0163: /* 'BrtSupBookSrc' */\n      /* falls through */\n      default:\n        return \"SH33TJSSRC\" + supbooks[XTI[0]][0];\n    }\n    switch (supbooks[XTI[0]][0][0]) {\n      case 0x0401:\n        o = XTI[1] == -1 ? \"#REF\" : supbooks.SheetNames[XTI[1]] || \"SH33TJSERR3\";\n        return XTI[1] == XTI[2] ? o : o + \":\" + supbooks.SheetNames[XTI[2]];\n      case 0x3A01:\n        return supbooks[XTI[0]].slice(1).map(function (name) {\n          return name.Name;\n        }).join(\";;\");\n      //return \"SH33TJSERR8\";\n      default:\n        if (!supbooks[XTI[0]][0][3]) return \"SH33TJSERR2\";\n        o = XTI[1] == -1 ? \"#REF\" : supbooks[XTI[0]][0][3][XTI[1]] || \"SH33TJSERR4\";\n        return XTI[1] == XTI[2] ? o : o + \":\" + supbooks[XTI[0]][0][3][XTI[2]];\n    }\n  }\n  function get_ixti(supbooks, ixti, opts) {\n    var ixtiraw = get_ixti_raw(supbooks, ixti, opts);\n    return ixtiraw == \"#REF\" ? ixtiraw : formula_quote_sheet_name(ixtiraw, opts);\n  }\n  function stringify_formula(formula /*Array<any>*/, range, cell, supbooks, opts) {\n    var biff = opts && opts.biff || 8;\n    var _range = /*range != null ? range :*/{\n      s: {\n        c: 0,\n        r: 0\n      },\n      e: {\n        c: 0,\n        r: 0\n      }\n    };\n    var stack = [],\n      e1,\n      e2,\n      c,\n      ixti = 0,\n      nameidx = 0,\n      r,\n      sname = \"\";\n    if (!formula[0] || !formula[0][0]) return \"\";\n    var last_sp = -1,\n      sp = \"\";\n    for (var ff = 0, fflen = formula[0].length; ff < fflen; ++ff) {\n      var f = formula[0][ff];\n      switch (f[0]) {\n        case 'PtgUminus':\n          /* [MS-XLS] 2.5.198.93 */\n          stack.push(\"-\" + stack.pop());\n          break;\n        case 'PtgUplus':\n          /* [MS-XLS] 2.5.198.95 */\n          stack.push(\"+\" + stack.pop());\n          break;\n        case 'PtgPercent':\n          /* [MS-XLS] 2.5.198.81 */\n          stack.push(stack.pop() + \"%\");\n          break;\n        case 'PtgAdd': /* [MS-XLS] 2.5.198.26 */\n        case 'PtgConcat': /* [MS-XLS] 2.5.198.43 */\n        case 'PtgDiv': /* [MS-XLS] 2.5.198.45 */\n        case 'PtgEq': /* [MS-XLS] 2.5.198.56 */\n        case 'PtgGe': /* [MS-XLS] 2.5.198.64 */\n        case 'PtgGt': /* [MS-XLS] 2.5.198.65 */\n        case 'PtgLe': /* [MS-XLS] 2.5.198.68 */\n        case 'PtgLt': /* [MS-XLS] 2.5.198.69 */\n        case 'PtgMul': /* [MS-XLS] 2.5.198.75 */\n        case 'PtgNe': /* [MS-XLS] 2.5.198.78 */\n        case 'PtgPower': /* [MS-XLS] 2.5.198.82 */\n        case 'PtgSub':\n          /* [MS-XLS] 2.5.198.90 */\n          e1 = stack.pop();\n          e2 = stack.pop();\n          if (last_sp >= 0) {\n            switch (formula[0][last_sp][1][0]) {\n              case 0:\n                // $FlowIgnore\n                sp = fill(\" \", formula[0][last_sp][1][1]);\n                break;\n              case 1:\n                // $FlowIgnore\n                sp = fill(\"\\r\", formula[0][last_sp][1][1]);\n                break;\n              default:\n                sp = \"\";\n                // $FlowIgnore\n                if (opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + formula[0][last_sp][1][0]);\n            }\n            e2 = e2 + sp;\n            last_sp = -1;\n          }\n          stack.push(e2 + PtgBinOp[f[0]] + e1);\n          break;\n        case 'PtgIsect':\n          /* [MS-XLS] 2.5.198.67 */\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \" \" + e1);\n          break;\n        case 'PtgUnion':\n          /* [MS-XLS] 2.5.198.94 */\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \",\" + e1);\n          break;\n        case 'PtgRange':\n          /* [MS-XLS] 2.5.198.83 */\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \":\" + e1);\n          break;\n        case 'PtgAttrChoose':\n          /* [MS-XLS] 2.5.198.34 */\n          break;\n        case 'PtgAttrGoto':\n          /* [MS-XLS] 2.5.198.35 */\n          break;\n        case 'PtgAttrIf':\n          /* [MS-XLS] 2.5.198.36 */\n          break;\n        case 'PtgAttrIfError':\n          /* [MS-XLSB] 2.5.97.28 */\n          break;\n        case 'PtgRef':\n          /* [MS-XLS] 2.5.198.84 */\n          c = shift_cell_xls(f[1][1], _range, opts);\n          stack.push(encode_cell_xls(c, biff));\n          break;\n        case 'PtgRefN':\n          /* [MS-XLS] 2.5.198.88 */\n          c = cell ? shift_cell_xls(f[1][1], cell, opts) : f[1][1];\n          stack.push(encode_cell_xls(c, biff));\n          break;\n        case 'PtgRef3d':\n          /* [MS-XLS] 2.5.198.85 */\n          ixti = f[1][1];\n          c = shift_cell_xls(f[1][2], _range, opts);\n          sname = get_ixti(supbooks, ixti, opts);\n          var w = sname; /* IE9 fails on defined names */ // eslint-disable-line no-unused-vars\n          stack.push(sname + \"!\" + encode_cell_xls(c, biff));\n          break;\n        case 'PtgFunc': /* [MS-XLS] 2.5.198.62 */\n        case 'PtgFuncVar':\n          /* [MS-XLS] 2.5.198.63 */\n          /* f[1] = [argc, func, type] */\n          var argc = f[1][0],\n            func = f[1][1];\n          if (!argc) argc = 0;\n          argc &= 0x7F;\n          var args = argc == 0 ? [] : stack.slice(-argc);\n          stack.length -= argc;\n          if (func === 'User') func = args.shift();\n          stack.push(func + \"(\" + args.join(\",\") + \")\");\n          break;\n        case 'PtgBool':\n          /* [MS-XLS] 2.5.198.42 */\n          stack.push(f[1] ? \"TRUE\" : \"FALSE\");\n          break;\n        case 'PtgInt':\n          /* [MS-XLS] 2.5.198.66 */\n          stack.push(f[1]);\n          break;\n        case 'PtgNum':\n          /* [MS-XLS] 2.5.198.79 TODO: precision? */\n          stack.push(String(f[1]));\n          break;\n        case 'PtgStr':\n          /* [MS-XLS] 2.5.198.89 */\n          // $FlowIgnore\n          stack.push('\"' + f[1].replace(/\"/g, '\"\"') + '\"');\n          break;\n        case 'PtgErr':\n          /* [MS-XLS] 2.5.198.57 */\n          stack.push(f[1]);\n          break;\n        case 'PtgAreaN':\n          /* [MS-XLS] 2.5.198.31 TODO */\n          r = shift_range_xls(f[1][1], cell ? {\n            s: cell\n          } : _range, opts);\n          stack.push(encode_range_xls(r, opts));\n          break;\n        case 'PtgArea':\n          /* [MS-XLS] 2.5.198.27 TODO: fixed points */\n          r = shift_range_xls(f[1][1], _range, opts);\n          stack.push(encode_range_xls(r, opts));\n          break;\n        case 'PtgArea3d':\n          /* [MS-XLS] 2.5.198.28 TODO */\n          ixti = f[1][1];\n          r = f[1][2];\n          sname = get_ixti(supbooks, ixti, opts);\n          stack.push(sname + \"!\" + encode_range_xls(r, opts));\n          break;\n        case 'PtgAttrSum':\n          /* [MS-XLS] 2.5.198.41 */\n          stack.push(\"SUM(\" + stack.pop() + \")\");\n          break;\n        case 'PtgAttrBaxcel': /* [MS-XLS] 2.5.198.33 */\n        case 'PtgAttrSemi':\n          /* [MS-XLS] 2.5.198.37 */\n          break;\n        case 'PtgName':\n          /* [MS-XLS] 2.5.198.76 ; [MS-XLSB] 2.5.97.60 TODO: revisions */\n          /* f[1] = type, 0, nameindex */\n          nameidx = f[1][2];\n          var lbl = (supbooks.names || [])[nameidx - 1] || (supbooks[0] || [])[nameidx];\n          var name = lbl ? lbl.Name : \"SH33TJSNAME\" + String(nameidx);\n          /* [MS-XLSB] 2.5.97.10 Ftab -- last verified 20220204 */\n          if (name && name.slice(0, 6) == \"_xlfn.\" && !opts.xlfn) name = name.slice(6);\n          stack.push(name);\n          break;\n        case 'PtgNameX':\n          /* [MS-XLS] 2.5.198.77 ; [MS-XLSB] 2.5.97.61 TODO: revisions */\n          /* f[1] = type, ixti, nameindex */\n          var bookidx = f[1][1];\n          nameidx = f[1][2];\n          var externbook;\n          /* TODO: Properly handle missing values -- this should be using get_ixti_raw primarily */\n          if (opts.biff <= 5) {\n            if (bookidx < 0) bookidx = -bookidx;\n            if (supbooks[bookidx]) externbook = supbooks[bookidx][nameidx];\n          } else {\n            var o = \"\";\n            if (((supbooks[bookidx] || [])[0] || [])[0] == 0x3A01) {/* empty */} else if (((supbooks[bookidx] || [])[0] || [])[0] == 0x0401) {\n              if (supbooks[bookidx][nameidx] && supbooks[bookidx][nameidx].itab > 0) {\n                o = supbooks.SheetNames[supbooks[bookidx][nameidx].itab - 1] + \"!\";\n              }\n            } else o = supbooks.SheetNames[nameidx - 1] + \"!\";\n            if (supbooks[bookidx] && supbooks[bookidx][nameidx]) o += supbooks[bookidx][nameidx].Name;else if (supbooks[0] && supbooks[0][nameidx]) o += supbooks[0][nameidx].Name;else {\n              var ixtidata = (get_ixti_raw(supbooks, bookidx, opts) || \"\").split(\";;\");\n              if (ixtidata[nameidx - 1]) o = ixtidata[nameidx - 1]; // TODO: confirm this is correct\n              else o += \"SH33TJSERRX\";\n            }\n            stack.push(o);\n            break;\n          }\n          if (!externbook) externbook = {\n            Name: \"SH33TJSERRY\"\n          };\n          stack.push(externbook.Name);\n          break;\n        case 'PtgParen':\n          /* [MS-XLS] 2.5.198.80 */\n          var lp = '(',\n            rp = ')';\n          if (last_sp >= 0) {\n            sp = \"\";\n            switch (formula[0][last_sp][1][0]) {\n              // $FlowIgnore\n              case 2:\n                lp = fill(\" \", formula[0][last_sp][1][1]) + lp;\n                break;\n              // $FlowIgnore\n              case 3:\n                lp = fill(\"\\r\", formula[0][last_sp][1][1]) + lp;\n                break;\n              // $FlowIgnore\n              case 4:\n                rp = fill(\" \", formula[0][last_sp][1][1]) + rp;\n                break;\n              // $FlowIgnore\n              case 5:\n                rp = fill(\"\\r\", formula[0][last_sp][1][1]) + rp;\n                break;\n              default:\n                // $FlowIgnore\n                if (opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + formula[0][last_sp][1][0]);\n            }\n            last_sp = -1;\n          }\n          stack.push(lp + stack.pop() + rp);\n          break;\n        case 'PtgRefErr':\n          /* [MS-XLS] 2.5.198.86 */\n          stack.push('#REF!');\n          break;\n        case 'PtgRefErr3d':\n          /* [MS-XLS] 2.5.198.87 */\n          stack.push('#REF!');\n          break;\n        case 'PtgExp':\n          /* [MS-XLS] 2.5.198.58 TODO */\n          c = {\n            c: f[1][1],\n            r: f[1][0]\n          };\n          var q = {\n            c: cell.c,\n            r: cell.r\n          };\n          if (supbooks.sharedf[encode_cell(c)]) {\n            var parsedf = supbooks.sharedf[encode_cell(c)];\n            stack.push(stringify_formula(parsedf, _range, q, supbooks, opts));\n          } else {\n            var fnd = false;\n            for (e1 = 0; e1 != supbooks.arrayf.length; ++e1) {\n              /* TODO: should be something like range_has */\n              e2 = supbooks.arrayf[e1];\n              if (c.c < e2[0].s.c || c.c > e2[0].e.c) continue;\n              if (c.r < e2[0].s.r || c.r > e2[0].e.r) continue;\n              stack.push(stringify_formula(e2[1], _range, q, supbooks, opts));\n              fnd = true;\n              break;\n            }\n            if (!fnd) stack.push(f[1]);\n          }\n          break;\n        case 'PtgArray':\n          /* [MS-XLS] 2.5.198.32 TODO */\n          stack.push(\"{\" + stringify_array(f[1]) + \"}\");\n          break;\n        case 'PtgMemArea':\n          /* [MS-XLS] 2.5.198.70 TODO: confirm this is a non-display */\n          //stack.push(\"(\" + f[2].map(encode_range).join(\",\") + \")\");\n          break;\n        case 'PtgAttrSpace': /* [MS-XLS] 2.5.198.38 */\n        case 'PtgAttrSpaceSemi':\n          /* [MS-XLS] 2.5.198.39 */\n          last_sp = ff;\n          break;\n        case 'PtgTbl':\n          /* [MS-XLS] 2.5.198.92 TODO */\n          break;\n        case 'PtgMemErr':\n          /* [MS-XLS] 2.5.198.71 */\n          break;\n        case 'PtgMissArg':\n          /* [MS-XLS] 2.5.198.74 */\n          stack.push(\"\");\n          break;\n        case 'PtgAreaErr':\n          /* [MS-XLS] 2.5.198.29 */\n          stack.push(\"#REF!\");\n          break;\n        case 'PtgAreaErr3d':\n          /* [MS-XLS] 2.5.198.30 */\n          stack.push(\"#REF!\");\n          break;\n        case 'PtgList':\n          /* [MS-XLSB] 2.5.97.52 */\n          // $FlowIgnore\n          stack.push(\"Table\" + f[1].idx + \"[#\" + f[1].rt + \"]\");\n          break;\n        case 'PtgMemAreaN':\n        case 'PtgMemNoMemN':\n        case 'PtgAttrNoop':\n        case 'PtgSheet':\n        case 'PtgEndSheet':\n          break;\n        case 'PtgMemFunc':\n          /* [MS-XLS] 2.5.198.72 TODO */\n          break;\n        case 'PtgMemNoMem':\n          /* [MS-XLS] 2.5.198.73 TODO */\n          break;\n        case 'PtgElfCol': /* [MS-XLS] 2.5.198.46 */\n        case 'PtgElfColS': /* [MS-XLS] 2.5.198.47 */\n        case 'PtgElfColSV': /* [MS-XLS] 2.5.198.48 */\n        case 'PtgElfColV': /* [MS-XLS] 2.5.198.49 */\n        case 'PtgElfLel': /* [MS-XLS] 2.5.198.50 */\n        case 'PtgElfRadical': /* [MS-XLS] 2.5.198.51 */\n        case 'PtgElfRadicalLel': /* [MS-XLS] 2.5.198.52 */\n        case 'PtgElfRadicalS': /* [MS-XLS] 2.5.198.53 */\n        case 'PtgElfRw': /* [MS-XLS] 2.5.198.54 */\n        case 'PtgElfRwV':\n          /* [MS-XLS] 2.5.198.55 */\n          throw new Error(\"Unsupported ELFs\");\n        case 'PtgSxName':\n          /* [MS-XLS] 2.5.198.91 TODO -- find a test case */\n          throw new Error('Unrecognized Formula Token: ' + String(f));\n        default:\n          throw new Error('Unrecognized Formula Token: ' + String(f));\n      }\n      var PtgNonDisp = ['PtgAttrSpace', 'PtgAttrSpaceSemi', 'PtgAttrGoto'];\n      if (opts.biff != 3) if (last_sp >= 0 && PtgNonDisp.indexOf(formula[0][ff][0]) == -1) {\n        f = formula[0][last_sp];\n        var _left = true;\n        switch (f[1][0]) {\n          /* note: some bad XLSB files omit the PtgParen */\n          case 4:\n            _left = false;\n          /* falls through */\n          case 0:\n            // $FlowIgnore\n            sp = fill(\" \", f[1][1]);\n            break;\n          case 5:\n            _left = false;\n          /* falls through */\n          case 1:\n            // $FlowIgnore\n            sp = fill(\"\\r\", f[1][1]);\n            break;\n          default:\n            sp = \"\";\n            // $FlowIgnore\n            if (opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + f[1][0]);\n        }\n        stack.push((_left ? sp : \"\") + stack.pop() + (_left ? \"\" : sp));\n        last_sp = -1;\n      }\n    }\n    if (stack.length > 1 && opts.WTF) throw new Error(\"bad formula stack\");\n    return stack[0];\n  }\n\n  /* [MS-XLS] 2.5.198.1 TODO */\n  function parse_ArrayParsedFormula(blob, length, opts) {\n    var target = blob.l + length,\n      len = opts.biff == 2 ? 1 : 2;\n    var rgcb,\n      cce = blob.read_shift(len); // length of rgce\n    if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n    var rgce = parse_Rgce(blob, cce, opts);\n    if (length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\n    blob.l = target;\n    return [rgce, rgcb];\n  }\n\n  /* [MS-XLS] 2.5.198.3 TODO */\n  function parse_XLSCellParsedFormula(blob, length, opts) {\n    var target = blob.l + length,\n      len = opts.biff == 2 ? 1 : 2;\n    var rgcb,\n      cce = blob.read_shift(len); // length of rgce\n    if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n    var rgce = parse_Rgce(blob, cce, opts);\n    if (length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\n    blob.l = target;\n    return [rgce, rgcb];\n  }\n\n  /* [MS-XLS] 2.5.198.21 */\n  function parse_NameParsedFormula(blob, length, opts, cce) {\n    var target = blob.l + length;\n    var rgce = parse_Rgce(blob, cce, opts);\n    var rgcb;\n    if (target !== blob.l) rgcb = parse_RgbExtra(blob, target - blob.l, rgce, opts);\n    return [rgce, rgcb];\n  }\n\n  /* [MS-XLS] 2.5.198.118 TODO */\n  function parse_SharedParsedFormula(blob, length, opts) {\n    var target = blob.l + length;\n    var rgcb,\n      cce = blob.read_shift(2); // length of rgce\n    var rgce = parse_Rgce(blob, cce, opts);\n    if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n    if (length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\n    return [rgce, rgcb];\n  }\n\n  /* [MS-XLS] 2.5.133 TODO: how to emit empty strings? */\n  function parse_FormulaValue(blob) {\n    var b;\n    if (__readUInt16LE(blob, blob.l + 6) !== 0xFFFF) return [parse_Xnum(blob), 'n'];\n    switch (blob[blob.l]) {\n      case 0x00:\n        blob.l += 8;\n        return [\"String\", 's'];\n      case 0x01:\n        b = blob[blob.l + 2] === 0x1;\n        blob.l += 8;\n        return [b, 'b'];\n      case 0x02:\n        b = blob[blob.l + 2];\n        blob.l += 8;\n        return [b, 'e'];\n      case 0x03:\n        blob.l += 8;\n        return [\"\", 's'];\n    }\n    return [];\n  }\n  function write_FormulaValue(value) {\n    if (value == null) {\n      // Blank String Value\n      var o = new_buf(8);\n      o.write_shift(1, 0x03);\n      o.write_shift(1, 0);\n      o.write_shift(2, 0);\n      o.write_shift(2, 0);\n      o.write_shift(2, 0xFFFF);\n      return o;\n    } else if (typeof value == \"number\") return write_Xnum(value);\n    return write_Xnum(0);\n  }\n\n  /* [MS-XLS] 2.4.127 TODO */\n  function parse_Formula(blob, length, opts) {\n    var end = blob.l + length;\n    var cell = parse_XLSCell(blob, 6);\n    if (opts.biff == 2) ++blob.l;\n    var val = parse_FormulaValue(blob, 8);\n    var flags = blob.read_shift(1);\n    if (opts.biff != 2) {\n      blob.read_shift(1);\n      if (opts.biff >= 5) {\n        /*var chn = */blob.read_shift(4);\n      }\n    }\n    var cbf = parse_XLSCellParsedFormula(blob, end - blob.l, opts);\n    return {\n      cell: cell,\n      val: val[0],\n      formula: cbf,\n      shared: flags >> 3 & 1,\n      tt: val[1]\n    };\n  }\n  function write_Formula(cell, R, C, opts, os) {\n    // Cell\n    var o1 = write_XLSCell(R, C, os);\n\n    // FormulaValue\n    var o2 = write_FormulaValue(cell.v);\n\n    // flags + cache\n    var o3 = new_buf(6);\n    var flags = 0x01 | 0x20;\n    o3.write_shift(2, flags);\n    o3.write_shift(4, 0);\n\n    // CellParsedFormula\n    var bf = new_buf(cell.bf.length);\n    for (var i = 0; i < cell.bf.length; ++i) bf[i] = cell.bf[i];\n    var out = bconcat([o1, o2, o3, bf]);\n    return out;\n  }\n\n  /* XLSB Parsed Formula records have the same shape */\n  function parse_XLSBParsedFormula(data, length, opts) {\n    var cce = data.read_shift(4);\n    var rgce = parse_Rgce(data, cce, opts);\n    var cb = data.read_shift(4);\n    var rgcb = cb > 0 ? parse_RgbExtra(data, cb, rgce, opts) : null;\n    return [rgce, rgcb];\n  }\n\n  /* [MS-XLSB] 2.5.97.1 ArrayParsedFormula */\n  var parse_XLSBArrayParsedFormula = parse_XLSBParsedFormula;\n  /* [MS-XLSB] 2.5.97.4 CellParsedFormula */\n  var parse_XLSBCellParsedFormula = parse_XLSBParsedFormula;\n  /* [MS-XLSB] 2.5.97.8 DVParsedFormula */\n  //var parse_XLSBDVParsedFormula = parse_XLSBParsedFormula;\n  /* [MS-XLSB] 2.5.97.9 FRTParsedFormula */\n  //var parse_XLSBFRTParsedFormula = parse_XLSBParsedFormula2;\n  /* [MS-XLSB] 2.5.97.12 NameParsedFormula */\n  var parse_XLSBNameParsedFormula = parse_XLSBParsedFormula;\n  /* [MS-XLSB] 2.5.97.98 SharedParsedFormula */\n  var parse_XLSBSharedParsedFormula = parse_XLSBParsedFormula;\n  var Cetab = {\n    0: \"BEEP\",\n    1: \"OPEN\",\n    2: \"OPEN.LINKS\",\n    3: \"CLOSE.ALL\",\n    4: \"SAVE\",\n    5: \"SAVE.AS\",\n    6: \"FILE.DELETE\",\n    7: \"PAGE.SETUP\",\n    8: \"PRINT\",\n    9: \"PRINTER.SETUP\",\n    10: \"QUIT\",\n    11: \"NEW.WINDOW\",\n    12: \"ARRANGE.ALL\",\n    13: \"WINDOW.SIZE\",\n    14: \"WINDOW.MOVE\",\n    15: \"FULL\",\n    16: \"CLOSE\",\n    17: \"RUN\",\n    22: \"SET.PRINT.AREA\",\n    23: \"SET.PRINT.TITLES\",\n    24: \"SET.PAGE.BREAK\",\n    25: \"REMOVE.PAGE.BREAK\",\n    26: \"FONT\",\n    27: \"DISPLAY\",\n    28: \"PROTECT.DOCUMENT\",\n    29: \"PRECISION\",\n    30: \"A1.R1C1\",\n    31: \"CALCULATE.NOW\",\n    32: \"CALCULATION\",\n    34: \"DATA.FIND\",\n    35: \"EXTRACT\",\n    36: \"DATA.DELETE\",\n    37: \"SET.DATABASE\",\n    38: \"SET.CRITERIA\",\n    39: \"SORT\",\n    40: \"DATA.SERIES\",\n    41: \"TABLE\",\n    42: \"FORMAT.NUMBER\",\n    43: \"ALIGNMENT\",\n    44: \"STYLE\",\n    45: \"BORDER\",\n    46: \"CELL.PROTECTION\",\n    47: \"COLUMN.WIDTH\",\n    48: \"UNDO\",\n    49: \"CUT\",\n    50: \"COPY\",\n    51: \"PASTE\",\n    52: \"CLEAR\",\n    53: \"PASTE.SPECIAL\",\n    54: \"EDIT.DELETE\",\n    55: \"INSERT\",\n    56: \"FILL.RIGHT\",\n    57: \"FILL.DOWN\",\n    61: \"DEFINE.NAME\",\n    62: \"CREATE.NAMES\",\n    63: \"FORMULA.GOTO\",\n    64: \"FORMULA.FIND\",\n    65: \"SELECT.LAST.CELL\",\n    66: \"SHOW.ACTIVE.CELL\",\n    67: \"GALLERY.AREA\",\n    68: \"GALLERY.BAR\",\n    69: \"GALLERY.COLUMN\",\n    70: \"GALLERY.LINE\",\n    71: \"GALLERY.PIE\",\n    72: \"GALLERY.SCATTER\",\n    73: \"COMBINATION\",\n    74: \"PREFERRED\",\n    75: \"ADD.OVERLAY\",\n    76: \"GRIDLINES\",\n    77: \"SET.PREFERRED\",\n    78: \"AXES\",\n    79: \"LEGEND\",\n    80: \"ATTACH.TEXT\",\n    81: \"ADD.ARROW\",\n    82: \"SELECT.CHART\",\n    83: \"SELECT.PLOT.AREA\",\n    84: \"PATTERNS\",\n    85: \"MAIN.CHART\",\n    86: \"OVERLAY\",\n    87: \"SCALE\",\n    88: \"FORMAT.LEGEND\",\n    89: \"FORMAT.TEXT\",\n    90: \"EDIT.REPEAT\",\n    91: \"PARSE\",\n    92: \"JUSTIFY\",\n    93: \"HIDE\",\n    94: \"UNHIDE\",\n    95: \"WORKSPACE\",\n    96: \"FORMULA\",\n    97: \"FORMULA.FILL\",\n    98: \"FORMULA.ARRAY\",\n    99: \"DATA.FIND.NEXT\",\n    100: \"DATA.FIND.PREV\",\n    101: \"FORMULA.FIND.NEXT\",\n    102: \"FORMULA.FIND.PREV\",\n    103: \"ACTIVATE\",\n    104: \"ACTIVATE.NEXT\",\n    105: \"ACTIVATE.PREV\",\n    106: \"UNLOCKED.NEXT\",\n    107: \"UNLOCKED.PREV\",\n    108: \"COPY.PICTURE\",\n    109: \"SELECT\",\n    110: \"DELETE.NAME\",\n    111: \"DELETE.FORMAT\",\n    112: \"VLINE\",\n    113: \"HLINE\",\n    114: \"VPAGE\",\n    115: \"HPAGE\",\n    116: \"VSCROLL\",\n    117: \"HSCROLL\",\n    118: \"ALERT\",\n    119: \"NEW\",\n    120: \"CANCEL.COPY\",\n    121: \"SHOW.CLIPBOARD\",\n    122: \"MESSAGE\",\n    124: \"PASTE.LINK\",\n    125: \"APP.ACTIVATE\",\n    126: \"DELETE.ARROW\",\n    127: \"ROW.HEIGHT\",\n    128: \"FORMAT.MOVE\",\n    129: \"FORMAT.SIZE\",\n    130: \"FORMULA.REPLACE\",\n    131: \"SEND.KEYS\",\n    132: \"SELECT.SPECIAL\",\n    133: \"APPLY.NAMES\",\n    134: \"REPLACE.FONT\",\n    135: \"FREEZE.PANES\",\n    136: \"SHOW.INFO\",\n    137: \"SPLIT\",\n    138: \"ON.WINDOW\",\n    139: \"ON.DATA\",\n    140: \"DISABLE.INPUT\",\n    142: \"OUTLINE\",\n    143: \"LIST.NAMES\",\n    144: \"FILE.CLOSE\",\n    145: \"SAVE.WORKBOOK\",\n    146: \"DATA.FORM\",\n    147: \"COPY.CHART\",\n    148: \"ON.TIME\",\n    149: \"WAIT\",\n    150: \"FORMAT.FONT\",\n    151: \"FILL.UP\",\n    152: \"FILL.LEFT\",\n    153: \"DELETE.OVERLAY\",\n    155: \"SHORT.MENUS\",\n    159: \"SET.UPDATE.STATUS\",\n    161: \"COLOR.PALETTE\",\n    162: \"DELETE.STYLE\",\n    163: \"WINDOW.RESTORE\",\n    164: \"WINDOW.MAXIMIZE\",\n    166: \"CHANGE.LINK\",\n    167: \"CALCULATE.DOCUMENT\",\n    168: \"ON.KEY\",\n    169: \"APP.RESTORE\",\n    170: \"APP.MOVE\",\n    171: \"APP.SIZE\",\n    172: \"APP.MINIMIZE\",\n    173: \"APP.MAXIMIZE\",\n    174: \"BRING.TO.FRONT\",\n    175: \"SEND.TO.BACK\",\n    185: \"MAIN.CHART.TYPE\",\n    186: \"OVERLAY.CHART.TYPE\",\n    187: \"SELECT.END\",\n    188: \"OPEN.MAIL\",\n    189: \"SEND.MAIL\",\n    190: \"STANDARD.FONT\",\n    191: \"CONSOLIDATE\",\n    192: \"SORT.SPECIAL\",\n    193: \"GALLERY.3D.AREA\",\n    194: \"GALLERY.3D.COLUMN\",\n    195: \"GALLERY.3D.LINE\",\n    196: \"GALLERY.3D.PIE\",\n    197: \"VIEW.3D\",\n    198: \"GOAL.SEEK\",\n    199: \"WORKGROUP\",\n    200: \"FILL.GROUP\",\n    201: \"UPDATE.LINK\",\n    202: \"PROMOTE\",\n    203: \"DEMOTE\",\n    204: \"SHOW.DETAIL\",\n    206: \"UNGROUP\",\n    207: \"OBJECT.PROPERTIES\",\n    208: \"SAVE.NEW.OBJECT\",\n    209: \"SHARE\",\n    210: \"SHARE.NAME\",\n    211: \"DUPLICATE\",\n    212: \"APPLY.STYLE\",\n    213: \"ASSIGN.TO.OBJECT\",\n    214: \"OBJECT.PROTECTION\",\n    215: \"HIDE.OBJECT\",\n    216: \"SET.EXTRACT\",\n    217: \"CREATE.PUBLISHER\",\n    218: \"SUBSCRIBE.TO\",\n    219: \"ATTRIBUTES\",\n    220: \"SHOW.TOOLBAR\",\n    222: \"PRINT.PREVIEW\",\n    223: \"EDIT.COLOR\",\n    224: \"SHOW.LEVELS\",\n    225: \"FORMAT.MAIN\",\n    226: \"FORMAT.OVERLAY\",\n    227: \"ON.RECALC\",\n    228: \"EDIT.SERIES\",\n    229: \"DEFINE.STYLE\",\n    240: \"LINE.PRINT\",\n    243: \"ENTER.DATA\",\n    249: \"GALLERY.RADAR\",\n    250: \"MERGE.STYLES\",\n    251: \"EDITION.OPTIONS\",\n    252: \"PASTE.PICTURE\",\n    253: \"PASTE.PICTURE.LINK\",\n    254: \"SPELLING\",\n    256: \"ZOOM\",\n    259: \"INSERT.OBJECT\",\n    260: \"WINDOW.MINIMIZE\",\n    265: \"SOUND.NOTE\",\n    266: \"SOUND.PLAY\",\n    267: \"FORMAT.SHAPE\",\n    268: \"EXTEND.POLYGON\",\n    269: \"FORMAT.AUTO\",\n    272: \"GALLERY.3D.BAR\",\n    273: \"GALLERY.3D.SURFACE\",\n    274: \"FILL.AUTO\",\n    276: \"CUSTOMIZE.TOOLBAR\",\n    277: \"ADD.TOOL\",\n    278: \"EDIT.OBJECT\",\n    279: \"ON.DOUBLECLICK\",\n    280: \"ON.ENTRY\",\n    281: \"WORKBOOK.ADD\",\n    282: \"WORKBOOK.MOVE\",\n    283: \"WORKBOOK.COPY\",\n    284: \"WORKBOOK.OPTIONS\",\n    285: \"SAVE.WORKSPACE\",\n    288: \"CHART.WIZARD\",\n    289: \"DELETE.TOOL\",\n    290: \"MOVE.TOOL\",\n    291: \"WORKBOOK.SELECT\",\n    292: \"WORKBOOK.ACTIVATE\",\n    293: \"ASSIGN.TO.TOOL\",\n    295: \"COPY.TOOL\",\n    296: \"RESET.TOOL\",\n    297: \"CONSTRAIN.NUMERIC\",\n    298: \"PASTE.TOOL\",\n    302: \"WORKBOOK.NEW\",\n    305: \"SCENARIO.CELLS\",\n    306: \"SCENARIO.DELETE\",\n    307: \"SCENARIO.ADD\",\n    308: \"SCENARIO.EDIT\",\n    309: \"SCENARIO.SHOW\",\n    310: \"SCENARIO.SHOW.NEXT\",\n    311: \"SCENARIO.SUMMARY\",\n    312: \"PIVOT.TABLE.WIZARD\",\n    313: \"PIVOT.FIELD.PROPERTIES\",\n    314: \"PIVOT.FIELD\",\n    315: \"PIVOT.ITEM\",\n    316: \"PIVOT.ADD.FIELDS\",\n    318: \"OPTIONS.CALCULATION\",\n    319: \"OPTIONS.EDIT\",\n    320: \"OPTIONS.VIEW\",\n    321: \"ADDIN.MANAGER\",\n    322: \"MENU.EDITOR\",\n    323: \"ATTACH.TOOLBARS\",\n    324: \"VBAActivate\",\n    325: \"OPTIONS.CHART\",\n    328: \"VBA.INSERT.FILE\",\n    330: \"VBA.PROCEDURE.DEFINITION\",\n    336: \"ROUTING.SLIP\",\n    338: \"ROUTE.DOCUMENT\",\n    339: \"MAIL.LOGON\",\n    342: \"INSERT.PICTURE\",\n    343: \"EDIT.TOOL\",\n    344: \"GALLERY.DOUGHNUT\",\n    350: \"CHART.TREND\",\n    352: \"PIVOT.ITEM.PROPERTIES\",\n    354: \"WORKBOOK.INSERT\",\n    355: \"OPTIONS.TRANSITION\",\n    356: \"OPTIONS.GENERAL\",\n    370: \"FILTER.ADVANCED\",\n    373: \"MAIL.ADD.MAILER\",\n    374: \"MAIL.DELETE.MAILER\",\n    375: \"MAIL.REPLY\",\n    376: \"MAIL.REPLY.ALL\",\n    377: \"MAIL.FORWARD\",\n    378: \"MAIL.NEXT.LETTER\",\n    379: \"DATA.LABEL\",\n    380: \"INSERT.TITLE\",\n    381: \"FONT.PROPERTIES\",\n    382: \"MACRO.OPTIONS\",\n    383: \"WORKBOOK.HIDE\",\n    384: \"WORKBOOK.UNHIDE\",\n    385: \"WORKBOOK.DELETE\",\n    386: \"WORKBOOK.NAME\",\n    388: \"GALLERY.CUSTOM\",\n    390: \"ADD.CHART.AUTOFORMAT\",\n    391: \"DELETE.CHART.AUTOFORMAT\",\n    392: \"CHART.ADD.DATA\",\n    393: \"AUTO.OUTLINE\",\n    394: \"TAB.ORDER\",\n    395: \"SHOW.DIALOG\",\n    396: \"SELECT.ALL\",\n    397: \"UNGROUP.SHEETS\",\n    398: \"SUBTOTAL.CREATE\",\n    399: \"SUBTOTAL.REMOVE\",\n    400: \"RENAME.OBJECT\",\n    412: \"WORKBOOK.SCROLL\",\n    413: \"WORKBOOK.NEXT\",\n    414: \"WORKBOOK.PREV\",\n    415: \"WORKBOOK.TAB.SPLIT\",\n    416: \"FULL.SCREEN\",\n    417: \"WORKBOOK.PROTECT\",\n    420: \"SCROLLBAR.PROPERTIES\",\n    421: \"PIVOT.SHOW.PAGES\",\n    422: \"TEXT.TO.COLUMNS\",\n    423: \"FORMAT.CHARTTYPE\",\n    424: \"LINK.FORMAT\",\n    425: \"TRACER.DISPLAY\",\n    430: \"TRACER.NAVIGATE\",\n    431: \"TRACER.CLEAR\",\n    432: \"TRACER.ERROR\",\n    433: \"PIVOT.FIELD.GROUP\",\n    434: \"PIVOT.FIELD.UNGROUP\",\n    435: \"CHECKBOX.PROPERTIES\",\n    436: \"LABEL.PROPERTIES\",\n    437: \"LISTBOX.PROPERTIES\",\n    438: \"EDITBOX.PROPERTIES\",\n    439: \"PIVOT.REFRESH\",\n    440: \"LINK.COMBO\",\n    441: \"OPEN.TEXT\",\n    442: \"HIDE.DIALOG\",\n    443: \"SET.DIALOG.FOCUS\",\n    444: \"ENABLE.OBJECT\",\n    445: \"PUSHBUTTON.PROPERTIES\",\n    446: \"SET.DIALOG.DEFAULT\",\n    447: \"FILTER\",\n    448: \"FILTER.SHOW.ALL\",\n    449: \"CLEAR.OUTLINE\",\n    450: \"FUNCTION.WIZARD\",\n    451: \"ADD.LIST.ITEM\",\n    452: \"SET.LIST.ITEM\",\n    453: \"REMOVE.LIST.ITEM\",\n    454: \"SELECT.LIST.ITEM\",\n    455: \"SET.CONTROL.VALUE\",\n    456: \"SAVE.COPY.AS\",\n    458: \"OPTIONS.LISTS.ADD\",\n    459: \"OPTIONS.LISTS.DELETE\",\n    460: \"SERIES.AXES\",\n    461: \"SERIES.X\",\n    462: \"SERIES.Y\",\n    463: \"ERRORBAR.X\",\n    464: \"ERRORBAR.Y\",\n    465: \"FORMAT.CHART\",\n    466: \"SERIES.ORDER\",\n    467: \"MAIL.LOGOFF\",\n    468: \"CLEAR.ROUTING.SLIP\",\n    469: \"APP.ACTIVATE.MICROSOFT\",\n    470: \"MAIL.EDIT.MAILER\",\n    471: \"ON.SHEET\",\n    472: \"STANDARD.WIDTH\",\n    473: \"SCENARIO.MERGE\",\n    474: \"SUMMARY.INFO\",\n    475: \"FIND.FILE\",\n    476: \"ACTIVE.CELL.FONT\",\n    477: \"ENABLE.TIPWIZARD\",\n    478: \"VBA.MAKE.ADDIN\",\n    480: \"INSERTDATATABLE\",\n    481: \"WORKGROUP.OPTIONS\",\n    482: \"MAIL.SEND.MAILER\",\n    485: \"AUTOCORRECT\",\n    489: \"POST.DOCUMENT\",\n    491: \"PICKLIST\",\n    493: \"VIEW.SHOW\",\n    494: \"VIEW.DEFINE\",\n    495: \"VIEW.DELETE\",\n    509: \"SHEET.BACKGROUND\",\n    510: \"INSERT.MAP.OBJECT\",\n    511: \"OPTIONS.MENONO\",\n    517: \"MSOCHECKS\",\n    518: \"NORMAL\",\n    519: \"LAYOUT\",\n    520: \"RM.PRINT.AREA\",\n    521: \"CLEAR.PRINT.AREA\",\n    522: \"ADD.PRINT.AREA\",\n    523: \"MOVE.BRK\",\n    545: \"HIDECURR.NOTE\",\n    546: \"HIDEALL.NOTES\",\n    547: \"DELETE.NOTE\",\n    548: \"TRAVERSE.NOTES\",\n    549: \"ACTIVATE.NOTES\",\n    620: \"PROTECT.REVISIONS\",\n    621: \"UNPROTECT.REVISIONS\",\n    647: \"OPTIONS.ME\",\n    653: \"WEB.PUBLISH\",\n    667: \"NEWWEBQUERY\",\n    673: \"PIVOT.TABLE.CHART\",\n    753: \"OPTIONS.SAVE\",\n    755: \"OPTIONS.SPELL\",\n    808: \"HIDEALL.INKANNOTS\"\n  };\n  var Ftab = {\n    0: \"COUNT\",\n    1: \"IF\",\n    2: \"ISNA\",\n    3: \"ISERROR\",\n    4: \"SUM\",\n    5: \"AVERAGE\",\n    6: \"MIN\",\n    7: \"MAX\",\n    8: \"ROW\",\n    9: \"COLUMN\",\n    10: \"NA\",\n    11: \"NPV\",\n    12: \"STDEV\",\n    13: \"DOLLAR\",\n    14: \"FIXED\",\n    15: \"SIN\",\n    16: \"COS\",\n    17: \"TAN\",\n    18: \"ATAN\",\n    19: \"PI\",\n    20: \"SQRT\",\n    21: \"EXP\",\n    22: \"LN\",\n    23: \"LOG10\",\n    24: \"ABS\",\n    25: \"INT\",\n    26: \"SIGN\",\n    27: \"ROUND\",\n    28: \"LOOKUP\",\n    29: \"INDEX\",\n    30: \"REPT\",\n    31: \"MID\",\n    32: \"LEN\",\n    33: \"VALUE\",\n    34: \"TRUE\",\n    35: \"FALSE\",\n    36: \"AND\",\n    37: \"OR\",\n    38: \"NOT\",\n    39: \"MOD\",\n    40: \"DCOUNT\",\n    41: \"DSUM\",\n    42: \"DAVERAGE\",\n    43: \"DMIN\",\n    44: \"DMAX\",\n    45: \"DSTDEV\",\n    46: \"VAR\",\n    47: \"DVAR\",\n    48: \"TEXT\",\n    49: \"LINEST\",\n    50: \"TREND\",\n    51: \"LOGEST\",\n    52: \"GROWTH\",\n    53: \"GOTO\",\n    54: \"HALT\",\n    55: \"RETURN\",\n    56: \"PV\",\n    57: \"FV\",\n    58: \"NPER\",\n    59: \"PMT\",\n    60: \"RATE\",\n    61: \"MIRR\",\n    62: \"IRR\",\n    63: \"RAND\",\n    64: \"MATCH\",\n    65: \"DATE\",\n    66: \"TIME\",\n    67: \"DAY\",\n    68: \"MONTH\",\n    69: \"YEAR\",\n    70: \"WEEKDAY\",\n    71: \"HOUR\",\n    72: \"MINUTE\",\n    73: \"SECOND\",\n    74: \"NOW\",\n    75: \"AREAS\",\n    76: \"ROWS\",\n    77: \"COLUMNS\",\n    78: \"OFFSET\",\n    79: \"ABSREF\",\n    80: \"RELREF\",\n    81: \"ARGUMENT\",\n    82: \"SEARCH\",\n    83: \"TRANSPOSE\",\n    84: \"ERROR\",\n    85: \"STEP\",\n    86: \"TYPE\",\n    87: \"ECHO\",\n    88: \"SET.NAME\",\n    89: \"CALLER\",\n    90: \"DEREF\",\n    91: \"WINDOWS\",\n    92: \"SERIES\",\n    93: \"DOCUMENTS\",\n    94: \"ACTIVE.CELL\",\n    95: \"SELECTION\",\n    96: \"RESULT\",\n    97: \"ATAN2\",\n    98: \"ASIN\",\n    99: \"ACOS\",\n    100: \"CHOOSE\",\n    101: \"HLOOKUP\",\n    102: \"VLOOKUP\",\n    103: \"LINKS\",\n    104: \"INPUT\",\n    105: \"ISREF\",\n    106: \"GET.FORMULA\",\n    107: \"GET.NAME\",\n    108: \"SET.VALUE\",\n    109: \"LOG\",\n    110: \"EXEC\",\n    111: \"CHAR\",\n    112: \"LOWER\",\n    113: \"UPPER\",\n    114: \"PROPER\",\n    115: \"LEFT\",\n    116: \"RIGHT\",\n    117: \"EXACT\",\n    118: \"TRIM\",\n    119: \"REPLACE\",\n    120: \"SUBSTITUTE\",\n    121: \"CODE\",\n    122: \"NAMES\",\n    123: \"DIRECTORY\",\n    124: \"FIND\",\n    125: \"CELL\",\n    126: \"ISERR\",\n    127: \"ISTEXT\",\n    128: \"ISNUMBER\",\n    129: \"ISBLANK\",\n    130: \"T\",\n    131: \"N\",\n    132: \"FOPEN\",\n    133: \"FCLOSE\",\n    134: \"FSIZE\",\n    135: \"FREADLN\",\n    136: \"FREAD\",\n    137: \"FWRITELN\",\n    138: \"FWRITE\",\n    139: \"FPOS\",\n    140: \"DATEVALUE\",\n    141: \"TIMEVALUE\",\n    142: \"SLN\",\n    143: \"SYD\",\n    144: \"DDB\",\n    145: \"GET.DEF\",\n    146: \"REFTEXT\",\n    147: \"TEXTREF\",\n    148: \"INDIRECT\",\n    149: \"REGISTER\",\n    150: \"CALL\",\n    151: \"ADD.BAR\",\n    152: \"ADD.MENU\",\n    153: \"ADD.COMMAND\",\n    154: \"ENABLE.COMMAND\",\n    155: \"CHECK.COMMAND\",\n    156: \"RENAME.COMMAND\",\n    157: \"SHOW.BAR\",\n    158: \"DELETE.MENU\",\n    159: \"DELETE.COMMAND\",\n    160: \"GET.CHART.ITEM\",\n    161: \"DIALOG.BOX\",\n    162: \"CLEAN\",\n    163: \"MDETERM\",\n    164: \"MINVERSE\",\n    165: \"MMULT\",\n    166: \"FILES\",\n    167: \"IPMT\",\n    168: \"PPMT\",\n    169: \"COUNTA\",\n    170: \"CANCEL.KEY\",\n    171: \"FOR\",\n    172: \"WHILE\",\n    173: \"BREAK\",\n    174: \"NEXT\",\n    175: \"INITIATE\",\n    176: \"REQUEST\",\n    177: \"POKE\",\n    178: \"EXECUTE\",\n    179: \"TERMINATE\",\n    180: \"RESTART\",\n    181: \"HELP\",\n    182: \"GET.BAR\",\n    183: \"PRODUCT\",\n    184: \"FACT\",\n    185: \"GET.CELL\",\n    186: \"GET.WORKSPACE\",\n    187: \"GET.WINDOW\",\n    188: \"GET.DOCUMENT\",\n    189: \"DPRODUCT\",\n    190: \"ISNONTEXT\",\n    191: \"GET.NOTE\",\n    192: \"NOTE\",\n    193: \"STDEVP\",\n    194: \"VARP\",\n    195: \"DSTDEVP\",\n    196: \"DVARP\",\n    197: \"TRUNC\",\n    198: \"ISLOGICAL\",\n    199: \"DCOUNTA\",\n    200: \"DELETE.BAR\",\n    201: \"UNREGISTER\",\n    204: \"USDOLLAR\",\n    205: \"FINDB\",\n    206: \"SEARCHB\",\n    207: \"REPLACEB\",\n    208: \"LEFTB\",\n    209: \"RIGHTB\",\n    210: \"MIDB\",\n    211: \"LENB\",\n    212: \"ROUNDUP\",\n    213: \"ROUNDDOWN\",\n    214: \"ASC\",\n    215: \"DBCS\",\n    216: \"RANK\",\n    219: \"ADDRESS\",\n    220: \"DAYS360\",\n    221: \"TODAY\",\n    222: \"VDB\",\n    223: \"ELSE\",\n    224: \"ELSE.IF\",\n    225: \"END.IF\",\n    226: \"FOR.CELL\",\n    227: \"MEDIAN\",\n    228: \"SUMPRODUCT\",\n    229: \"SINH\",\n    230: \"COSH\",\n    231: \"TANH\",\n    232: \"ASINH\",\n    233: \"ACOSH\",\n    234: \"ATANH\",\n    235: \"DGET\",\n    236: \"CREATE.OBJECT\",\n    237: \"VOLATILE\",\n    238: \"LAST.ERROR\",\n    239: \"CUSTOM.UNDO\",\n    240: \"CUSTOM.REPEAT\",\n    241: \"FORMULA.CONVERT\",\n    242: \"GET.LINK.INFO\",\n    243: \"TEXT.BOX\",\n    244: \"INFO\",\n    245: \"GROUP\",\n    246: \"GET.OBJECT\",\n    247: \"DB\",\n    248: \"PAUSE\",\n    251: \"RESUME\",\n    252: \"FREQUENCY\",\n    253: \"ADD.TOOLBAR\",\n    254: \"DELETE.TOOLBAR\",\n    255: \"User\",\n    256: \"RESET.TOOLBAR\",\n    257: \"EVALUATE\",\n    258: \"GET.TOOLBAR\",\n    259: \"GET.TOOL\",\n    260: \"SPELLING.CHECK\",\n    261: \"ERROR.TYPE\",\n    262: \"APP.TITLE\",\n    263: \"WINDOW.TITLE\",\n    264: \"SAVE.TOOLBAR\",\n    265: \"ENABLE.TOOL\",\n    266: \"PRESS.TOOL\",\n    267: \"REGISTER.ID\",\n    268: \"GET.WORKBOOK\",\n    269: \"AVEDEV\",\n    270: \"BETADIST\",\n    271: \"GAMMALN\",\n    272: \"BETAINV\",\n    273: \"BINOMDIST\",\n    274: \"CHIDIST\",\n    275: \"CHIINV\",\n    276: \"COMBIN\",\n    277: \"CONFIDENCE\",\n    278: \"CRITBINOM\",\n    279: \"EVEN\",\n    280: \"EXPONDIST\",\n    281: \"FDIST\",\n    282: \"FINV\",\n    283: \"FISHER\",\n    284: \"FISHERINV\",\n    285: \"FLOOR\",\n    286: \"GAMMADIST\",\n    287: \"GAMMAINV\",\n    288: \"CEILING\",\n    289: \"HYPGEOMDIST\",\n    290: \"LOGNORMDIST\",\n    291: \"LOGINV\",\n    292: \"NEGBINOMDIST\",\n    293: \"NORMDIST\",\n    294: \"NORMSDIST\",\n    295: \"NORMINV\",\n    296: \"NORMSINV\",\n    297: \"STANDARDIZE\",\n    298: \"ODD\",\n    299: \"PERMUT\",\n    300: \"POISSON\",\n    301: \"TDIST\",\n    302: \"WEIBULL\",\n    303: \"SUMXMY2\",\n    304: \"SUMX2MY2\",\n    305: \"SUMX2PY2\",\n    306: \"CHITEST\",\n    307: \"CORREL\",\n    308: \"COVAR\",\n    309: \"FORECAST\",\n    310: \"FTEST\",\n    311: \"INTERCEPT\",\n    312: \"PEARSON\",\n    313: \"RSQ\",\n    314: \"STEYX\",\n    315: \"SLOPE\",\n    316: \"TTEST\",\n    317: \"PROB\",\n    318: \"DEVSQ\",\n    319: \"GEOMEAN\",\n    320: \"HARMEAN\",\n    321: \"SUMSQ\",\n    322: \"KURT\",\n    323: \"SKEW\",\n    324: \"ZTEST\",\n    325: \"LARGE\",\n    326: \"SMALL\",\n    327: \"QUARTILE\",\n    328: \"PERCENTILE\",\n    329: \"PERCENTRANK\",\n    330: \"MODE\",\n    331: \"TRIMMEAN\",\n    332: \"TINV\",\n    334: \"MOVIE.COMMAND\",\n    335: \"GET.MOVIE\",\n    336: \"CONCATENATE\",\n    337: \"POWER\",\n    338: \"PIVOT.ADD.DATA\",\n    339: \"GET.PIVOT.TABLE\",\n    340: \"GET.PIVOT.FIELD\",\n    341: \"GET.PIVOT.ITEM\",\n    342: \"RADIANS\",\n    343: \"DEGREES\",\n    344: \"SUBTOTAL\",\n    345: \"SUMIF\",\n    346: \"COUNTIF\",\n    347: \"COUNTBLANK\",\n    348: \"SCENARIO.GET\",\n    349: \"OPTIONS.LISTS.GET\",\n    350: \"ISPMT\",\n    351: \"DATEDIF\",\n    352: \"DATESTRING\",\n    353: \"NUMBERSTRING\",\n    354: \"ROMAN\",\n    355: \"OPEN.DIALOG\",\n    356: \"SAVE.DIALOG\",\n    357: \"VIEW.GET\",\n    358: \"GETPIVOTDATA\",\n    359: \"HYPERLINK\",\n    360: \"PHONETIC\",\n    361: \"AVERAGEA\",\n    362: \"MAXA\",\n    363: \"MINA\",\n    364: \"STDEVPA\",\n    365: \"VARPA\",\n    366: \"STDEVA\",\n    367: \"VARA\",\n    368: \"BAHTTEXT\",\n    369: \"THAIDAYOFWEEK\",\n    370: \"THAIDIGIT\",\n    371: \"THAIMONTHOFYEAR\",\n    372: \"THAINUMSOUND\",\n    373: \"THAINUMSTRING\",\n    374: \"THAISTRINGLENGTH\",\n    375: \"ISTHAIDIGIT\",\n    376: \"ROUNDBAHTDOWN\",\n    377: \"ROUNDBAHTUP\",\n    378: \"THAIYEAR\",\n    379: \"RTD\",\n    380: \"CUBEVALUE\",\n    381: \"CUBEMEMBER\",\n    382: \"CUBEMEMBERPROPERTY\",\n    383: \"CUBERANKEDMEMBER\",\n    384: \"HEX2BIN\",\n    385: \"HEX2DEC\",\n    386: \"HEX2OCT\",\n    387: \"DEC2BIN\",\n    388: \"DEC2HEX\",\n    389: \"DEC2OCT\",\n    390: \"OCT2BIN\",\n    391: \"OCT2HEX\",\n    392: \"OCT2DEC\",\n    393: \"BIN2DEC\",\n    394: \"BIN2OCT\",\n    395: \"BIN2HEX\",\n    396: \"IMSUB\",\n    397: \"IMDIV\",\n    398: \"IMPOWER\",\n    399: \"IMABS\",\n    400: \"IMSQRT\",\n    401: \"IMLN\",\n    402: \"IMLOG2\",\n    403: \"IMLOG10\",\n    404: \"IMSIN\",\n    405: \"IMCOS\",\n    406: \"IMEXP\",\n    407: \"IMARGUMENT\",\n    408: \"IMCONJUGATE\",\n    409: \"IMAGINARY\",\n    410: \"IMREAL\",\n    411: \"COMPLEX\",\n    412: \"IMSUM\",\n    413: \"IMPRODUCT\",\n    414: \"SERIESSUM\",\n    415: \"FACTDOUBLE\",\n    416: \"SQRTPI\",\n    417: \"QUOTIENT\",\n    418: \"DELTA\",\n    419: \"GESTEP\",\n    420: \"ISEVEN\",\n    421: \"ISODD\",\n    422: \"MROUND\",\n    423: \"ERF\",\n    424: \"ERFC\",\n    425: \"BESSELJ\",\n    426: \"BESSELK\",\n    427: \"BESSELY\",\n    428: \"BESSELI\",\n    429: \"XIRR\",\n    430: \"XNPV\",\n    431: \"PRICEMAT\",\n    432: \"YIELDMAT\",\n    433: \"INTRATE\",\n    434: \"RECEIVED\",\n    435: \"DISC\",\n    436: \"PRICEDISC\",\n    437: \"YIELDDISC\",\n    438: \"TBILLEQ\",\n    439: \"TBILLPRICE\",\n    440: \"TBILLYIELD\",\n    441: \"PRICE\",\n    442: \"YIELD\",\n    443: \"DOLLARDE\",\n    444: \"DOLLARFR\",\n    445: \"NOMINAL\",\n    446: \"EFFECT\",\n    447: \"CUMPRINC\",\n    448: \"CUMIPMT\",\n    449: \"EDATE\",\n    450: \"EOMONTH\",\n    451: \"YEARFRAC\",\n    452: \"COUPDAYBS\",\n    453: \"COUPDAYS\",\n    454: \"COUPDAYSNC\",\n    455: \"COUPNCD\",\n    456: \"COUPNUM\",\n    457: \"COUPPCD\",\n    458: \"DURATION\",\n    459: \"MDURATION\",\n    460: \"ODDLPRICE\",\n    461: \"ODDLYIELD\",\n    462: \"ODDFPRICE\",\n    463: \"ODDFYIELD\",\n    464: \"RANDBETWEEN\",\n    465: \"WEEKNUM\",\n    466: \"AMORDEGRC\",\n    467: \"AMORLINC\",\n    468: \"CONVERT\",\n    724: \"SHEETJS\",\n    469: \"ACCRINT\",\n    470: \"ACCRINTM\",\n    471: \"WORKDAY\",\n    472: \"NETWORKDAYS\",\n    473: \"GCD\",\n    474: \"MULTINOMIAL\",\n    475: \"LCM\",\n    476: \"FVSCHEDULE\",\n    477: \"CUBEKPIMEMBER\",\n    478: \"CUBESET\",\n    479: \"CUBESETCOUNT\",\n    480: \"IFERROR\",\n    481: \"COUNTIFS\",\n    482: \"SUMIFS\",\n    483: \"AVERAGEIF\",\n    484: \"AVERAGEIFS\"\n  };\n  var FtabArgc = {\n    2: 1,\n    3: 1,\n    10: 0,\n    15: 1,\n    16: 1,\n    17: 1,\n    18: 1,\n    19: 0,\n    20: 1,\n    21: 1,\n    22: 1,\n    23: 1,\n    24: 1,\n    25: 1,\n    26: 1,\n    27: 2,\n    30: 2,\n    31: 3,\n    32: 1,\n    33: 1,\n    34: 0,\n    35: 0,\n    38: 1,\n    39: 2,\n    40: 3,\n    41: 3,\n    42: 3,\n    43: 3,\n    44: 3,\n    45: 3,\n    47: 3,\n    48: 2,\n    53: 1,\n    61: 3,\n    63: 0,\n    65: 3,\n    66: 3,\n    67: 1,\n    68: 1,\n    69: 1,\n    70: 1,\n    71: 1,\n    72: 1,\n    73: 1,\n    74: 0,\n    75: 1,\n    76: 1,\n    77: 1,\n    79: 2,\n    80: 2,\n    83: 1,\n    85: 0,\n    86: 1,\n    89: 0,\n    90: 1,\n    94: 0,\n    95: 0,\n    97: 2,\n    98: 1,\n    99: 1,\n    101: 3,\n    102: 3,\n    105: 1,\n    106: 1,\n    108: 2,\n    111: 1,\n    112: 1,\n    113: 1,\n    114: 1,\n    117: 2,\n    118: 1,\n    119: 4,\n    121: 1,\n    126: 1,\n    127: 1,\n    128: 1,\n    129: 1,\n    130: 1,\n    131: 1,\n    133: 1,\n    134: 1,\n    135: 1,\n    136: 2,\n    137: 2,\n    138: 2,\n    140: 1,\n    141: 1,\n    142: 3,\n    143: 4,\n    144: 4,\n    161: 1,\n    162: 1,\n    163: 1,\n    164: 1,\n    165: 2,\n    172: 1,\n    175: 2,\n    176: 2,\n    177: 3,\n    178: 2,\n    179: 1,\n    184: 1,\n    186: 1,\n    189: 3,\n    190: 1,\n    195: 3,\n    196: 3,\n    197: 1,\n    198: 1,\n    199: 3,\n    201: 1,\n    207: 4,\n    210: 3,\n    211: 1,\n    212: 2,\n    213: 2,\n    214: 1,\n    215: 1,\n    225: 0,\n    229: 1,\n    230: 1,\n    231: 1,\n    232: 1,\n    233: 1,\n    234: 1,\n    235: 3,\n    244: 1,\n    247: 4,\n    252: 2,\n    257: 1,\n    261: 1,\n    271: 1,\n    273: 4,\n    274: 2,\n    275: 2,\n    276: 2,\n    277: 3,\n    278: 3,\n    279: 1,\n    280: 3,\n    281: 3,\n    282: 3,\n    283: 1,\n    284: 1,\n    285: 2,\n    286: 4,\n    287: 3,\n    288: 2,\n    289: 4,\n    290: 3,\n    291: 3,\n    292: 3,\n    293: 4,\n    294: 1,\n    295: 3,\n    296: 1,\n    297: 3,\n    298: 1,\n    299: 2,\n    300: 3,\n    301: 3,\n    302: 4,\n    303: 2,\n    304: 2,\n    305: 2,\n    306: 2,\n    307: 2,\n    308: 2,\n    309: 3,\n    310: 2,\n    311: 2,\n    312: 2,\n    313: 2,\n    314: 2,\n    315: 2,\n    316: 4,\n    325: 2,\n    326: 2,\n    327: 2,\n    328: 2,\n    331: 2,\n    332: 2,\n    337: 2,\n    342: 1,\n    343: 1,\n    346: 2,\n    347: 1,\n    350: 4,\n    351: 3,\n    352: 1,\n    353: 2,\n    360: 1,\n    368: 1,\n    369: 1,\n    370: 1,\n    371: 1,\n    372: 1,\n    373: 1,\n    374: 1,\n    375: 1,\n    376: 1,\n    377: 1,\n    378: 1,\n    382: 3,\n    385: 1,\n    392: 1,\n    393: 1,\n    396: 2,\n    397: 2,\n    398: 2,\n    399: 1,\n    400: 1,\n    401: 1,\n    402: 1,\n    403: 1,\n    404: 1,\n    405: 1,\n    406: 1,\n    407: 1,\n    408: 1,\n    409: 1,\n    410: 1,\n    414: 4,\n    415: 1,\n    416: 1,\n    417: 2,\n    420: 1,\n    421: 1,\n    422: 2,\n    424: 1,\n    425: 2,\n    426: 2,\n    427: 2,\n    428: 2,\n    430: 3,\n    438: 3,\n    439: 3,\n    440: 3,\n    443: 2,\n    444: 2,\n    445: 2,\n    446: 2,\n    447: 6,\n    448: 6,\n    449: 2,\n    450: 2,\n    464: 2,\n    468: 3,\n    476: 2,\n    479: 1,\n    480: 2,\n    65535: 0\n  };\n  /* Part 3 TODO: actually parse formulae */\n  function ods_to_csf_formula(f) {\n    if (f.slice(0, 3) == \"of:\") f = f.slice(3);\n    /* 5.2 Basic Expressions */\n    if (f.charCodeAt(0) == 61) {\n      f = f.slice(1);\n      if (f.charCodeAt(0) == 61) f = f.slice(1);\n    }\n    f = f.replace(/COM\\.MICROSOFT\\./g, \"\");\n    /* Part 3 Section 5.8 References */\n    f = f.replace(/\\[((?:\\.[A-Z]+[0-9]+)(?::\\.[A-Z]+[0-9]+)?)\\]/g, function ($$, $1) {\n      return $1.replace(/\\./g, \"\");\n    });\n    /* TODO: something other than this */\n    f = f.replace(/\\[.(#[A-Z]*[?!])\\]/g, \"$1\");\n    return f.replace(/[;~]/g, \",\").replace(/\\|/g, \";\");\n  }\n  function csf_to_ods_formula(f) {\n    var o = \"of:=\" + f.replace(crefregex, \"$1[.$2$3$4$5]\").replace(/\\]:\\[/g, \":\");\n    /* TODO: something other than this */\n    return o.replace(/;/g, \"|\").replace(/,/g, \";\");\n  }\n  function ods_to_csf_3D(r) {\n    var a = r.split(\":\");\n    var s = a[0].split(\".\")[0];\n    return [s, a[0].split(\".\")[1] + (a.length > 1 ? \":\" + (a[1].split(\".\")[1] || a[1].split(\".\")[0]) : \"\")];\n  }\n  function csf_to_ods_3D(r) {\n    return r.replace(/\\./, \"!\");\n  }\n  var strs = {}; // shared strings\n  var _ssfopts = {}; // spreadsheet formatting options\n\n  /*global Map */\n  var browser_has_Map = typeof Map !== 'undefined';\n  function get_sst_id(sst, str, rev) {\n    var i = 0,\n      len = sst.length;\n    if (rev) {\n      if (browser_has_Map ? rev.has(str) : Object.prototype.hasOwnProperty.call(rev, str)) {\n        var revarr = browser_has_Map ? rev.get(str) : rev[str];\n        for (; i < revarr.length; ++i) {\n          if (sst[revarr[i]].t === str) {\n            sst.Count++;\n            return revarr[i];\n          }\n        }\n      }\n    } else for (; i < len; ++i) {\n      if (sst[i].t === str) {\n        sst.Count++;\n        return i;\n      }\n    }\n    sst[len] = {\n      t: str\n    };\n    sst.Count++;\n    sst.Unique++;\n    if (rev) {\n      if (browser_has_Map) {\n        if (!rev.has(str)) rev.set(str, []);\n        rev.get(str).push(len);\n      } else {\n        if (!Object.prototype.hasOwnProperty.call(rev, str)) rev[str] = [];\n        rev[str].push(len);\n      }\n    }\n    return len;\n  }\n  function col_obj_w(C, col) {\n    var p = {\n      min: C + 1,\n      max: C + 1\n    };\n    /* wch (chars), wpx (pixels) */\n    var wch = -1;\n    if (col.MDW) MDW = col.MDW;\n    if (col.width != null) p.customWidth = 1;else if (col.wpx != null) wch = px2char(col.wpx);else if (col.wch != null) wch = col.wch;\n    if (wch > -1) {\n      p.width = char2width(wch);\n      p.customWidth = 1;\n    } else if (col.width != null) p.width = col.width;\n    if (col.hidden) p.hidden = true;\n    if (col.level != null) {\n      p.outlineLevel = p.level = col.level;\n    }\n    return p;\n  }\n  function default_margins(margins, mode) {\n    if (!margins) return;\n    var defs = [0.7, 0.7, 0.75, 0.75, 0.3, 0.3];\n    if (mode == 'xlml') defs = [1, 1, 1, 1, 0.5, 0.5];\n    if (margins.left == null) margins.left = defs[0];\n    if (margins.right == null) margins.right = defs[1];\n    if (margins.top == null) margins.top = defs[2];\n    if (margins.bottom == null) margins.bottom = defs[3];\n    if (margins.header == null) margins.header = defs[4];\n    if (margins.footer == null) margins.footer = defs[5];\n  }\n  function get_cell_style(styles, cell, opts) {\n    var z = opts.revssf[cell.z != null ? cell.z : \"General\"];\n    var i = 0x3c,\n      len = styles.length;\n    if (z == null && opts.ssf) {\n      for (; i < 0x188; ++i) if (opts.ssf[i] == null) {\n        SSF_load(cell.z, i);\n        // $FlowIgnore\n        opts.ssf[i] = cell.z;\n        opts.revssf[cell.z] = z = i;\n        break;\n      }\n    }\n    for (i = 0; i != len; ++i) if (styles[i].numFmtId === z) return i;\n    styles[len] = {\n      numFmtId: z,\n      fontId: 0,\n      fillId: 0,\n      borderId: 0,\n      xfId: 0,\n      applyNumberFormat: 1\n    };\n    return len;\n  }\n  function safe_format(p, fmtid, fillid, opts, themes, styles) {\n    try {\n      if (opts.cellNF) p.z = table_fmt[fmtid];\n    } catch (e) {\n      if (opts.WTF) throw e;\n    }\n    if (p.t === 'z' && !opts.cellStyles) return;\n    if (p.t === 'd' && typeof p.v === 'string') p.v = parseDate(p.v);\n    if ((!opts || opts.cellText !== false) && p.t !== 'z') try {\n      if (table_fmt[fmtid] == null) SSF_load(SSFImplicit[fmtid] || \"General\", fmtid);\n      if (p.t === 'e') p.w = p.w || BErr[p.v];else if (fmtid === 0) {\n        if (p.t === 'n') {\n          if ((p.v | 0) === p.v) p.w = p.v.toString(10);else p.w = SSF_general_num(p.v);\n        } else if (p.t === 'd') {\n          var dd = datenum(p.v);\n          if ((dd | 0) === dd) p.w = dd.toString(10);else p.w = SSF_general_num(dd);\n        } else if (p.v === undefined) return \"\";else p.w = SSF_general(p.v, _ssfopts);\n      } else if (p.t === 'd') p.w = SSF_format(fmtid, datenum(p.v), _ssfopts);else p.w = SSF_format(fmtid, p.v, _ssfopts);\n    } catch (e) {\n      if (opts.WTF) throw e;\n    }\n    if (!opts.cellStyles) return;\n    if (fillid != null) try {\n      p.s = styles.Fills[fillid];\n      if (p.s.fgColor && p.s.fgColor.theme && !p.s.fgColor.rgb) {\n        p.s.fgColor.rgb = rgb_tint(themes.themeElements.clrScheme[p.s.fgColor.theme].rgb, p.s.fgColor.tint || 0);\n        if (opts.WTF) p.s.fgColor.raw_rgb = themes.themeElements.clrScheme[p.s.fgColor.theme].rgb;\n      }\n      if (p.s.bgColor && p.s.bgColor.theme) {\n        p.s.bgColor.rgb = rgb_tint(themes.themeElements.clrScheme[p.s.bgColor.theme].rgb, p.s.bgColor.tint || 0);\n        if (opts.WTF) p.s.bgColor.raw_rgb = themes.themeElements.clrScheme[p.s.bgColor.theme].rgb;\n      }\n    } catch (e) {\n      if (opts.WTF && styles.Fills) throw e;\n    }\n  }\n  function check_ws(ws, sname, i) {\n    if (ws && ws['!ref']) {\n      var range = safe_decode_range(ws['!ref']);\n      if (range.e.c < range.s.c || range.e.r < range.s.r) throw new Error(\"Bad range (\" + i + \"): \" + ws['!ref']);\n    }\n  }\n  function parse_ws_xml_dim(ws, s) {\n    var d = safe_decode_range(s);\n    if (d.s.r <= d.e.r && d.s.c <= d.e.c && d.s.r >= 0 && d.s.c >= 0) ws[\"!ref\"] = encode_range(d);\n  }\n  var mergecregex = /<(?:\\w:)?mergeCell ref=\"[A-Z0-9:]+\"\\s*[\\/]?>/g;\n  var sheetdataregex = /<(?:\\w+:)?sheetData[^>]*>([\\s\\S]*)<\\/(?:\\w+:)?sheetData>/;\n  var hlinkregex = /<(?:\\w:)?hyperlink [^>]*>/mg;\n  var dimregex = /\"(\\w*:\\w*)\"/;\n  var colregex = /<(?:\\w:)?col\\b[^>]*[\\/]?>/g;\n  var afregex = /<(?:\\w:)?autoFilter[^>]*([\\/]|>([\\s\\S]*)<\\/(?:\\w:)?autoFilter)>/g;\n  var marginregex = /<(?:\\w:)?pageMargins[^>]*\\/>/g;\n  var sheetprregex = /<(?:\\w:)?sheetPr\\b(?:[^>a-z][^>]*)?\\/>/;\n  var sheetprregex2 = /<(?:\\w:)?sheetPr[^>]*(?:[\\/]|>([\\s\\S]*)<\\/(?:\\w:)?sheetPr)>/;\n  var svsregex = /<(?:\\w:)?sheetViews[^>]*(?:[\\/]|>([\\s\\S]*)<\\/(?:\\w:)?sheetViews)>/;\n\n  /* 18.3 Worksheets */\n  function parse_ws_xml(data, opts, idx, rels, wb, themes, styles) {\n    if (!data) return data;\n    if (!rels) rels = {\n      '!id': {}\n    };\n    if (DENSE != null && opts.dense == null) opts.dense = DENSE;\n\n    /* 18.3.1.99 worksheet CT_Worksheet */\n    var s = opts.dense ? [] : {};\n    var refguess = {\n      s: {\n        r: 2000000,\n        c: 2000000\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    var data1 = \"\",\n      data2 = \"\";\n    var mtch = data.match(sheetdataregex);\n    if (mtch) {\n      data1 = data.slice(0, mtch.index);\n      data2 = data.slice(mtch.index + mtch[0].length);\n    } else data1 = data2 = data;\n\n    /* 18.3.1.82 sheetPr CT_SheetPr */\n    var sheetPr = data1.match(sheetprregex);\n    if (sheetPr) parse_ws_xml_sheetpr(sheetPr[0], s, wb, idx);else if (sheetPr = data1.match(sheetprregex2)) parse_ws_xml_sheetpr2(sheetPr[0], sheetPr[1] || \"\", s, wb, idx, styles, themes);\n\n    /* 18.3.1.35 dimension CT_SheetDimension */\n    var ridx = (data1.match(/<(?:\\w*:)?dimension/) || {\n      index: -1\n    }).index;\n    if (ridx > 0) {\n      var ref = data1.slice(ridx, ridx + 50).match(dimregex);\n      if (ref) parse_ws_xml_dim(s, ref[1]);\n    }\n\n    /* 18.3.1.88 sheetViews CT_SheetViews */\n    var svs = data1.match(svsregex);\n    if (svs && svs[1]) parse_ws_xml_sheetviews(svs[1], wb);\n\n    /* 18.3.1.17 cols CT_Cols */\n    var columns = [];\n    if (opts.cellStyles) {\n      /* 18.3.1.13 col CT_Col */\n      var cols = data1.match(colregex);\n      if (cols) parse_ws_xml_cols(columns, cols);\n    }\n\n    /* 18.3.1.80 sheetData CT_SheetData ? */\n    if (mtch) parse_ws_xml_data(mtch[1], s, opts, refguess, themes, styles);\n\n    /* 18.3.1.2  autoFilter CT_AutoFilter */\n    var afilter = data2.match(afregex);\n    if (afilter) s['!autofilter'] = parse_ws_xml_autofilter(afilter[0]);\n\n    /* 18.3.1.55 mergeCells CT_MergeCells */\n    var merges = [];\n    var _merge = data2.match(mergecregex);\n    if (_merge) for (ridx = 0; ridx != _merge.length; ++ridx) merges[ridx] = safe_decode_range(_merge[ridx].slice(_merge[ridx].indexOf(\"\\\"\") + 1));\n\n    /* 18.3.1.48 hyperlinks CT_Hyperlinks */\n    var hlink = data2.match(hlinkregex);\n    if (hlink) parse_ws_xml_hlinks(s, hlink, rels);\n\n    /* 18.3.1.62 pageMargins CT_PageMargins */\n    var margins = data2.match(marginregex);\n    if (margins) s['!margins'] = parse_ws_xml_margins(parsexmltag(margins[0]));\n    if (!s[\"!ref\"] && refguess.e.c >= refguess.s.c && refguess.e.r >= refguess.s.r) s[\"!ref\"] = encode_range(refguess);\n    if (opts.sheetRows > 0 && s[\"!ref\"]) {\n      var tmpref = safe_decode_range(s[\"!ref\"]);\n      if (opts.sheetRows <= +tmpref.e.r) {\n        tmpref.e.r = opts.sheetRows - 1;\n        if (tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n        if (tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n        if (tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n        if (tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n        s[\"!fullref\"] = s[\"!ref\"];\n        s[\"!ref\"] = encode_range(tmpref);\n      }\n    }\n    if (columns.length > 0) s[\"!cols\"] = columns;\n    if (merges.length > 0) s[\"!merges\"] = merges;\n    return s;\n  }\n  function write_ws_xml_merges(merges) {\n    if (merges.length === 0) return \"\";\n    var o = '<mergeCells count=\"' + merges.length + '\">';\n    for (var i = 0; i != merges.length; ++i) o += '<mergeCell ref=\"' + encode_range(merges[i]) + '\"/>';\n    return o + '</mergeCells>';\n  }\n\n  /* 18.3.1.82-3 sheetPr CT_ChartsheetPr / CT_SheetPr */\n  function parse_ws_xml_sheetpr(sheetPr, s, wb, idx) {\n    var data = parsexmltag(sheetPr);\n    if (!wb.Sheets[idx]) wb.Sheets[idx] = {};\n    if (data.codeName) wb.Sheets[idx].CodeName = unescapexml(utf8read(data.codeName));\n  }\n  function parse_ws_xml_sheetpr2(sheetPr, body, s, wb, idx) {\n    parse_ws_xml_sheetpr(sheetPr.slice(0, sheetPr.indexOf(\">\")), s, wb, idx);\n  }\n  function write_ws_xml_sheetpr(ws, wb, idx, opts, o) {\n    var needed = false;\n    var props = {},\n      payload = null;\n    if (opts.bookType !== 'xlsx' && wb.vbaraw) {\n      var cname = wb.SheetNames[idx];\n      try {\n        if (wb.Workbook) cname = wb.Workbook.Sheets[idx].CodeName || cname;\n      } catch (e) {}\n      needed = true;\n      props.codeName = utf8write(escapexml(cname));\n    }\n    if (ws && ws[\"!outline\"]) {\n      var outlineprops = {\n        summaryBelow: 1,\n        summaryRight: 1\n      };\n      if (ws[\"!outline\"].above) outlineprops.summaryBelow = 0;\n      if (ws[\"!outline\"].left) outlineprops.summaryRight = 0;\n      payload = (payload || \"\") + writextag('outlinePr', null, outlineprops);\n    }\n    if (!needed && !payload) return;\n    o[o.length] = writextag('sheetPr', payload, props);\n  }\n\n  /* 18.3.1.85 sheetProtection CT_SheetProtection */\n  var sheetprot_deffalse = [\"objects\", \"scenarios\", \"selectLockedCells\", \"selectUnlockedCells\"];\n  var sheetprot_deftrue = [\"formatColumns\", \"formatRows\", \"formatCells\", \"insertColumns\", \"insertRows\", \"insertHyperlinks\", \"deleteColumns\", \"deleteRows\", \"sort\", \"autoFilter\", \"pivotTables\"];\n  function write_ws_xml_protection(sp) {\n    // algorithmName, hashValue, saltValue, spinCount\n    var o = {\n      sheet: 1\n    };\n    sheetprot_deffalse.forEach(function (n) {\n      if (sp[n] != null && sp[n]) o[n] = \"1\";\n    });\n    sheetprot_deftrue.forEach(function (n) {\n      if (sp[n] != null && !sp[n]) o[n] = \"0\";\n    });\n    /* TODO: algorithm */\n    if (sp.password) o.password = crypto_CreatePasswordVerifier_Method1(sp.password).toString(16).toUpperCase();\n    return writextag('sheetProtection', null, o);\n  }\n  function parse_ws_xml_hlinks(s, data, rels) {\n    var dense = Array.isArray(s);\n    for (var i = 0; i != data.length; ++i) {\n      var val = parsexmltag(utf8read(data[i]), true);\n      if (!val.ref) return;\n      var rel = ((rels || {})['!id'] || [])[val.id];\n      if (rel) {\n        val.Target = rel.Target;\n        if (val.location) val.Target += \"#\" + unescapexml(val.location);\n      } else {\n        val.Target = \"#\" + unescapexml(val.location);\n        rel = {\n          Target: val.Target,\n          TargetMode: 'Internal'\n        };\n      }\n      val.Rel = rel;\n      if (val.tooltip) {\n        val.Tooltip = val.tooltip;\n        delete val.tooltip;\n      }\n      var rng = safe_decode_range(val.ref);\n      for (var R = rng.s.r; R <= rng.e.r; ++R) for (var C = rng.s.c; C <= rng.e.c; ++C) {\n        var addr = encode_cell({\n          c: C,\n          r: R\n        });\n        if (dense) {\n          if (!s[R]) s[R] = [];\n          if (!s[R][C]) s[R][C] = {\n            t: \"z\",\n            v: undefined\n          };\n          s[R][C].l = val;\n        } else {\n          if (!s[addr]) s[addr] = {\n            t: \"z\",\n            v: undefined\n          };\n          s[addr].l = val;\n        }\n      }\n    }\n  }\n  function parse_ws_xml_margins(margin) {\n    var o = {};\n    [\"left\", \"right\", \"top\", \"bottom\", \"header\", \"footer\"].forEach(function (k) {\n      if (margin[k]) o[k] = parseFloat(margin[k]);\n    });\n    return o;\n  }\n  function write_ws_xml_margins(margin) {\n    default_margins(margin);\n    return writextag('pageMargins', null, margin);\n  }\n  function parse_ws_xml_cols(columns, cols) {\n    var seencol = false;\n    for (var coli = 0; coli != cols.length; ++coli) {\n      var coll = parsexmltag(cols[coli], true);\n      if (coll.hidden) coll.hidden = parsexmlbool(coll.hidden);\n      var colm = parseInt(coll.min, 10) - 1,\n        colM = parseInt(coll.max, 10) - 1;\n      if (coll.outlineLevel) coll.level = +coll.outlineLevel || 0;\n      delete coll.min;\n      delete coll.max;\n      coll.width = +coll.width;\n      if (!seencol && coll.width) {\n        seencol = true;\n        find_mdw_colw(coll.width);\n      }\n      process_col(coll);\n      while (colm <= colM) columns[colm++] = dup(coll);\n    }\n  }\n  function write_ws_xml_cols(ws, cols) {\n    var o = [\"<cols>\"],\n      col;\n    for (var i = 0; i != cols.length; ++i) {\n      if (!(col = cols[i])) continue;\n      o[o.length] = writextag('col', null, col_obj_w(i, col));\n    }\n    o[o.length] = \"</cols>\";\n    return o.join(\"\");\n  }\n  function parse_ws_xml_autofilter(data) {\n    var o = {\n      ref: (data.match(/ref=\"([^\"]*)\"/) || [])[1]\n    };\n    return o;\n  }\n  function write_ws_xml_autofilter(data, ws, wb, idx) {\n    var ref = typeof data.ref == \"string\" ? data.ref : encode_range(data.ref);\n    if (!wb.Workbook) wb.Workbook = {\n      Sheets: []\n    };\n    if (!wb.Workbook.Names) wb.Workbook.Names = [];\n    var names = wb.Workbook.Names;\n    var range = decode_range(ref);\n    if (range.s.r == range.e.r) {\n      range.e.r = decode_range(ws[\"!ref\"]).e.r;\n      ref = encode_range(range);\n    }\n    for (var i = 0; i < names.length; ++i) {\n      var name = names[i];\n      if (name.Name != '_xlnm._FilterDatabase') continue;\n      if (name.Sheet != idx) continue;\n      name.Ref = \"'\" + wb.SheetNames[idx] + \"'!\" + ref;\n      break;\n    }\n    if (i == names.length) names.push({\n      Name: '_xlnm._FilterDatabase',\n      Sheet: idx,\n      Ref: \"'\" + wb.SheetNames[idx] + \"'!\" + ref\n    });\n    return writextag(\"autoFilter\", null, {\n      ref: ref\n    });\n  }\n\n  /* 18.3.1.88 sheetViews CT_SheetViews */\n  /* 18.3.1.87 sheetView CT_SheetView */\n  var sviewregex = /<(?:\\w:)?sheetView(?:[^>a-z][^>]*)?\\/?>/;\n  function parse_ws_xml_sheetviews(data, wb) {\n    if (!wb.Views) wb.Views = [{}];\n    (data.match(sviewregex) || []).forEach(function (r, i) {\n      var tag = parsexmltag(r);\n      // $FlowIgnore\n      if (!wb.Views[i]) wb.Views[i] = {};\n      // $FlowIgnore\n      if (+tag.zoomScale) wb.Views[i].zoom = +tag.zoomScale;\n      // $FlowIgnore\n      if (parsexmlbool(tag.rightToLeft)) wb.Views[i].RTL = true;\n    });\n  }\n  function write_ws_xml_sheetviews(ws, opts, idx, wb) {\n    var sview = {\n      workbookViewId: \"0\"\n    };\n    // $FlowIgnore\n    if ((((wb || {}).Workbook || {}).Views || [])[0]) sview.rightToLeft = wb.Workbook.Views[0].RTL ? \"1\" : \"0\";\n    return writextag(\"sheetViews\", writextag(\"sheetView\", null, sview), {});\n  }\n  function write_ws_xml_cell(cell, ref, ws, opts) {\n    if (cell.c) ws['!comments'].push([ref, cell.c]);\n    if (cell.v === undefined && typeof cell.f !== \"string\" || cell.t === 'z' && !cell.f) return \"\";\n    var vv = \"\";\n    var oldt = cell.t,\n      oldv = cell.v;\n    if (cell.t !== \"z\") switch (cell.t) {\n      case 'b':\n        vv = cell.v ? \"1\" : \"0\";\n        break;\n      case 'n':\n        vv = '' + cell.v;\n        break;\n      case 'e':\n        vv = BErr[cell.v];\n        break;\n      case 'd':\n        if (opts && opts.cellDates) vv = parseDate(cell.v, -1).toISOString();else {\n          cell = dup(cell);\n          cell.t = 'n';\n          vv = '' + (cell.v = datenum(parseDate(cell.v)));\n        }\n        if (typeof cell.z === 'undefined') cell.z = table_fmt[14];\n        break;\n      default:\n        vv = cell.v;\n        break;\n    }\n    var v = writetag('v', escapexml(vv)),\n      o = {\n        r: ref\n      };\n    /* TODO: cell style */\n    var os = get_cell_style(opts.cellXfs, cell, opts);\n    if (os !== 0) o.s = os;\n    switch (cell.t) {\n      case 'n':\n        break;\n      case 'd':\n        o.t = \"d\";\n        break;\n      case 'b':\n        o.t = \"b\";\n        break;\n      case 'e':\n        o.t = \"e\";\n        break;\n      case 'z':\n        break;\n      default:\n        if (cell.v == null) {\n          delete cell.t;\n          break;\n        }\n        if (cell.v.length > 32767) throw new Error(\"Text length must not exceed 32767 characters\");\n        if (opts && opts.bookSST) {\n          v = writetag('v', '' + get_sst_id(opts.Strings, cell.v, opts.revStrings));\n          o.t = \"s\";\n          break;\n        }\n        o.t = \"str\";\n        break;\n    }\n    if (cell.t != oldt) {\n      cell.t = oldt;\n      cell.v = oldv;\n    }\n    if (typeof cell.f == \"string\" && cell.f) {\n      var ff = cell.F && cell.F.slice(0, ref.length) == ref ? {\n        t: \"array\",\n        ref: cell.F\n      } : null;\n      v = writextag('f', escapexml(cell.f), ff) + (cell.v != null ? v : \"\");\n    }\n    if (cell.l) ws['!links'].push([ref, cell.l]);\n    if (cell.D) o.cm = 1;\n    return writextag('c', v, o);\n  }\n  var parse_ws_xml_data = function () {\n    var cellregex = /<(?:\\w+:)?c[ \\/>]/,\n      rowregex = /<\\/(?:\\w+:)?row>/;\n    var rregex = /r=[\"']([^\"']*)[\"']/,\n      isregex = /<(?:\\w+:)?is>([\\S\\s]*?)<\\/(?:\\w+:)?is>/;\n    var refregex = /ref=[\"']([^\"']*)[\"']/;\n    var match_v = matchtag(\"v\"),\n      match_f = matchtag(\"f\");\n    return function parse_ws_xml_data(sdata, s, opts, guess, themes, styles) {\n      var ri = 0,\n        x = \"\",\n        cells = [],\n        cref = [],\n        idx = 0,\n        i = 0,\n        cc = 0,\n        d = \"\",\n        p;\n      var tag,\n        tagr = 0,\n        tagc = 0;\n      var sstr, ftag;\n      var fmtid = 0,\n        fillid = 0;\n      var do_format = Array.isArray(styles.CellXf),\n        cf;\n      var arrayf = [];\n      var sharedf = [];\n      var dense = Array.isArray(s);\n      var rows = [],\n        rowobj = {},\n        rowrite = false;\n      var sheetStubs = !!opts.sheetStubs;\n      for (var marr = sdata.split(rowregex), mt = 0, marrlen = marr.length; mt != marrlen; ++mt) {\n        x = marr[mt].trim();\n        var xlen = x.length;\n        if (xlen === 0) continue;\n\n        /* 18.3.1.73 row CT_Row */\n        var rstarti = 0;\n        outa: for (ri = 0; ri < xlen; ++ri) switch ( /*x.charCodeAt(ri)*/x[ri]) {\n          case \">\" /*62*/:\n            if ( /*x.charCodeAt(ri-1) != 47*/x[ri - 1] != \"/\") {\n              ++ri;\n              break outa;\n            }\n            if (opts && opts.cellStyles) {\n              // TODO: avoid duplication\n              tag = parsexmltag(x.slice(rstarti, ri), true);\n              tagr = tag.r != null ? parseInt(tag.r, 10) : tagr + 1;\n              tagc = -1;\n              if (opts.sheetRows && opts.sheetRows < tagr) continue;\n              rowobj = {};\n              rowrite = false;\n              if (tag.ht) {\n                rowrite = true;\n                rowobj.hpt = parseFloat(tag.ht);\n                rowobj.hpx = pt2px(rowobj.hpt);\n              }\n              if (tag.hidden == \"1\") {\n                rowrite = true;\n                rowobj.hidden = true;\n              }\n              if (tag.outlineLevel != null) {\n                rowrite = true;\n                rowobj.level = +tag.outlineLevel;\n              }\n              if (rowrite) rows[tagr - 1] = rowobj;\n            }\n            break;\n          case \"<\" /*60*/:\n            rstarti = ri;\n            break;\n        }\n        if (rstarti >= ri) break;\n        tag = parsexmltag(x.slice(rstarti, ri), true);\n        tagr = tag.r != null ? parseInt(tag.r, 10) : tagr + 1;\n        tagc = -1;\n        if (opts.sheetRows && opts.sheetRows < tagr) continue;\n        if (guess.s.r > tagr - 1) guess.s.r = tagr - 1;\n        if (guess.e.r < tagr - 1) guess.e.r = tagr - 1;\n        if (opts && opts.cellStyles) {\n          rowobj = {};\n          rowrite = false;\n          if (tag.ht) {\n            rowrite = true;\n            rowobj.hpt = parseFloat(tag.ht);\n            rowobj.hpx = pt2px(rowobj.hpt);\n          }\n          if (tag.hidden == \"1\") {\n            rowrite = true;\n            rowobj.hidden = true;\n          }\n          if (tag.outlineLevel != null) {\n            rowrite = true;\n            rowobj.level = +tag.outlineLevel;\n          }\n          if (rowrite) rows[tagr - 1] = rowobj;\n        }\n\n        /* 18.3.1.4 c CT_Cell */\n        cells = x.slice(ri).split(cellregex);\n        for (var rslice = 0; rslice != cells.length; ++rslice) if (cells[rslice].trim().charAt(0) != \"<\") break;\n        cells = cells.slice(rslice);\n        for (ri = 0; ri != cells.length; ++ri) {\n          x = cells[ri].trim();\n          if (x.length === 0) continue;\n          cref = x.match(rregex);\n          idx = ri;\n          i = 0;\n          cc = 0;\n          x = \"<c \" + (x.slice(0, 1) == \"<\" ? \">\" : \"\") + x;\n          if (cref != null && cref.length === 2) {\n            idx = 0;\n            d = cref[1];\n            for (i = 0; i != d.length; ++i) {\n              if ((cc = d.charCodeAt(i) - 64) < 1 || cc > 26) break;\n              idx = 26 * idx + cc;\n            }\n            --idx;\n            tagc = idx;\n          } else ++tagc;\n          for (i = 0; i != x.length; ++i) if (x.charCodeAt(i) === 62) break;\n          ++i;\n          tag = parsexmltag(x.slice(0, i), true);\n          if (!tag.r) tag.r = encode_cell({\n            r: tagr - 1,\n            c: tagc\n          });\n          d = x.slice(i);\n          p = {\n            t: \"\"\n          };\n          if ((cref = d.match(match_v)) != null && cref[1] !== '') p.v = unescapexml(cref[1]);\n          if (opts.cellFormula) {\n            if ((cref = d.match(match_f)) != null && cref[1] !== '') {\n              /* TODO: match against XLSXFutureFunctions */\n              p.f = unescapexml(utf8read(cref[1])).replace(/\\r\\n/g, \"\\n\");\n              if (!opts.xlfn) p.f = _xlfn(p.f);\n              if (cref[0].indexOf('t=\"array\"') > -1) {\n                p.F = (d.match(refregex) || [])[1];\n                if (p.F.indexOf(\":\") > -1) arrayf.push([safe_decode_range(p.F), p.F]);\n              } else if (cref[0].indexOf('t=\"shared\"') > -1) {\n                // TODO: parse formula\n                ftag = parsexmltag(cref[0]);\n                var ___f = unescapexml(utf8read(cref[1]));\n                if (!opts.xlfn) ___f = _xlfn(___f);\n                sharedf[parseInt(ftag.si, 10)] = [ftag, ___f, tag.r];\n              }\n            } else if (cref = d.match(/<f[^>]*\\/>/)) {\n              ftag = parsexmltag(cref[0]);\n              if (sharedf[ftag.si]) p.f = shift_formula_xlsx(sharedf[ftag.si][1], sharedf[ftag.si][2] /*[0].ref*/, tag.r);\n            }\n            /* TODO: factor out contains logic */\n            var _tag = decode_cell(tag.r);\n            for (i = 0; i < arrayf.length; ++i) if (_tag.r >= arrayf[i][0].s.r && _tag.r <= arrayf[i][0].e.r) if (_tag.c >= arrayf[i][0].s.c && _tag.c <= arrayf[i][0].e.c) p.F = arrayf[i][1];\n          }\n          if (tag.t == null && p.v === undefined) {\n            if (p.f || p.F) {\n              p.v = 0;\n              p.t = \"n\";\n            } else if (!sheetStubs) continue;else p.t = \"z\";\n          } else p.t = tag.t || \"n\";\n          if (guess.s.c > tagc) guess.s.c = tagc;\n          if (guess.e.c < tagc) guess.e.c = tagc;\n          /* 18.18.11 t ST_CellType */\n          switch (p.t) {\n            case 'n':\n              if (p.v == \"\" || p.v == null) {\n                if (!sheetStubs) continue;\n                p.t = 'z';\n              } else p.v = parseFloat(p.v);\n              break;\n            case 's':\n              if (typeof p.v == 'undefined') {\n                if (!sheetStubs) continue;\n                p.t = 'z';\n              } else {\n                sstr = strs[parseInt(p.v, 10)];\n                p.v = sstr.t;\n                p.r = sstr.r;\n                if (opts.cellHTML) p.h = sstr.h;\n              }\n              break;\n            case 'str':\n              p.t = \"s\";\n              p.v = p.v != null ? utf8read(p.v) : '';\n              if (opts.cellHTML) p.h = escapehtml(p.v);\n              break;\n            case 'inlineStr':\n              cref = d.match(isregex);\n              p.t = 's';\n              if (cref != null && (sstr = parse_si(cref[1]))) {\n                p.v = sstr.t;\n                if (opts.cellHTML) p.h = sstr.h;\n              } else p.v = \"\";\n              break;\n            case 'b':\n              p.v = parsexmlbool(p.v);\n              break;\n            case 'd':\n              if (opts.cellDates) p.v = parseDate(p.v, 1);else {\n                p.v = datenum(parseDate(p.v, 1));\n                p.t = 'n';\n              }\n              break;\n            /* error string in .w, number in .v */\n            case 'e':\n              if (!opts || opts.cellText !== false) p.w = p.v;\n              p.v = RBErr[p.v];\n              break;\n          }\n          /* formatting */\n          fmtid = fillid = 0;\n          cf = null;\n          if (do_format && tag.s !== undefined) {\n            cf = styles.CellXf[tag.s];\n            if (cf != null) {\n              if (cf.numFmtId != null) fmtid = cf.numFmtId;\n              if (opts.cellStyles) {\n                if (cf.fillId != null) fillid = cf.fillId;\n              }\n            }\n          }\n          safe_format(p, fmtid, fillid, opts, themes, styles);\n          if (opts.cellDates && do_format && p.t == 'n' && fmt_is_date(table_fmt[fmtid])) {\n            p.t = 'd';\n            p.v = numdate(p.v);\n          }\n          if (tag.cm && opts.xlmeta) {\n            var cm = (opts.xlmeta.Cell || [])[+tag.cm - 1];\n            if (cm && cm.type == 'XLDAPR') p.D = true;\n          }\n          if (dense) {\n            var _r = decode_cell(tag.r);\n            if (!s[_r.r]) s[_r.r] = [];\n            s[_r.r][_r.c] = p;\n          } else s[tag.r] = p;\n        }\n      }\n      if (rows.length > 0) s['!rows'] = rows;\n    };\n  }();\n  function write_ws_xml_data(ws, opts, idx, wb) {\n    var o = [],\n      r = [],\n      range = safe_decode_range(ws['!ref']),\n      cell = \"\",\n      ref,\n      rr = \"\",\n      cols = [],\n      R = 0,\n      C = 0,\n      rows = ws['!rows'];\n    var dense = Array.isArray(ws);\n    var params = {\n        r: rr\n      },\n      row,\n      height = -1;\n    for (C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);\n    for (R = range.s.r; R <= range.e.r; ++R) {\n      r = [];\n      rr = encode_row(R);\n      for (C = range.s.c; C <= range.e.c; ++C) {\n        ref = cols[C] + rr;\n        var _cell = dense ? (ws[R] || [])[C] : ws[ref];\n        if (_cell === undefined) continue;\n        if ((cell = write_ws_xml_cell(_cell, ref, ws, opts, idx, wb)) != null) r.push(cell);\n      }\n      if (r.length > 0 || rows && rows[R]) {\n        params = {\n          r: rr\n        };\n        if (rows && rows[R]) {\n          row = rows[R];\n          if (row.hidden) params.hidden = 1;\n          height = -1;\n          if (row.hpx) height = px2pt(row.hpx);else if (row.hpt) height = row.hpt;\n          if (height > -1) {\n            params.ht = height;\n            params.customHeight = 1;\n          }\n          if (row.level) {\n            params.outlineLevel = row.level;\n          }\n        }\n        o[o.length] = writextag('row', r.join(\"\"), params);\n      }\n    }\n    if (rows) for (; R < rows.length; ++R) {\n      if (rows && rows[R]) {\n        params = {\n          r: R + 1\n        };\n        row = rows[R];\n        if (row.hidden) params.hidden = 1;\n        height = -1;\n        if (row.hpx) height = px2pt(row.hpx);else if (row.hpt) height = row.hpt;\n        if (height > -1) {\n          params.ht = height;\n          params.customHeight = 1;\n        }\n        if (row.level) {\n          params.outlineLevel = row.level;\n        }\n        o[o.length] = writextag('row', \"\", params);\n      }\n    }\n    return o.join(\"\");\n  }\n  function write_ws_xml(idx, opts, wb, rels) {\n    var o = [XML_HEADER, writextag('worksheet', null, {\n      'xmlns': XMLNS_main[0],\n      'xmlns:r': XMLNS.r\n    })];\n    var s = wb.SheetNames[idx],\n      sidx = 0,\n      rdata = \"\";\n    var ws = wb.Sheets[s];\n    if (ws == null) ws = {};\n    var ref = ws['!ref'] || 'A1';\n    var range = safe_decode_range(ref);\n    if (range.e.c > 0x3FFF || range.e.r > 0xFFFFF) {\n      if (opts.WTF) throw new Error(\"Range \" + ref + \" exceeds format limit A1:XFD1048576\");\n      range.e.c = Math.min(range.e.c, 0x3FFF);\n      range.e.r = Math.min(range.e.c, 0xFFFFF);\n      ref = encode_range(range);\n    }\n    if (!rels) rels = {};\n    ws['!comments'] = [];\n    var _drawing = [];\n    write_ws_xml_sheetpr(ws, wb, idx, opts, o);\n    o[o.length] = writextag('dimension', null, {\n      'ref': ref\n    });\n    o[o.length] = write_ws_xml_sheetviews(ws, opts, idx, wb);\n\n    /* TODO: store in WB, process styles */\n    if (opts.sheetFormat) o[o.length] = writextag('sheetFormatPr', null, {\n      defaultRowHeight: opts.sheetFormat.defaultRowHeight || '16',\n      baseColWidth: opts.sheetFormat.baseColWidth || '10',\n      outlineLevelRow: opts.sheetFormat.outlineLevelRow || '7'\n    });\n    if (ws['!cols'] != null && ws['!cols'].length > 0) o[o.length] = write_ws_xml_cols(ws, ws['!cols']);\n    o[sidx = o.length] = '<sheetData/>';\n    ws['!links'] = [];\n    if (ws['!ref'] != null) {\n      rdata = write_ws_xml_data(ws, opts, idx, wb, rels);\n      if (rdata.length > 0) o[o.length] = rdata;\n    }\n    if (o.length > sidx + 1) {\n      o[o.length] = '</sheetData>';\n      o[sidx] = o[sidx].replace(\"/>\", \">\");\n    }\n\n    /* sheetCalcPr */\n\n    if (ws['!protect']) o[o.length] = write_ws_xml_protection(ws['!protect']);\n\n    /* protectedRanges */\n    /* scenarios */\n\n    if (ws['!autofilter'] != null) o[o.length] = write_ws_xml_autofilter(ws['!autofilter'], ws, wb, idx);\n\n    /* sortState */\n    /* dataConsolidate */\n    /* customSheetViews */\n\n    if (ws['!merges'] != null && ws['!merges'].length > 0) o[o.length] = write_ws_xml_merges(ws['!merges']);\n\n    /* phoneticPr */\n    /* conditionalFormatting */\n    /* dataValidations */\n\n    var relc = -1,\n      rel,\n      rId = -1;\n    if (ws['!links'].length > 0) {\n      o[o.length] = \"<hyperlinks>\";\n      ws['!links'].forEach(function (l) {\n        if (!l[1].Target) return;\n        rel = {\n          \"ref\": l[0]\n        };\n        if (l[1].Target.charAt(0) != \"#\") {\n          rId = add_rels(rels, -1, escapexml(l[1].Target).replace(/#.*$/, \"\"), RELS.HLINK);\n          rel[\"r:id\"] = \"rId\" + rId;\n        }\n        if ((relc = l[1].Target.indexOf(\"#\")) > -1) rel.location = escapexml(l[1].Target.slice(relc + 1));\n        if (l[1].Tooltip) rel.tooltip = escapexml(l[1].Tooltip);\n        o[o.length] = writextag(\"hyperlink\", null, rel);\n      });\n      o[o.length] = \"</hyperlinks>\";\n    }\n    delete ws['!links'];\n\n    /* printOptions */\n\n    if (ws['!margins'] != null) o[o.length] = write_ws_xml_margins(ws['!margins']);\n\n    /* pageSetup */\n    /* headerFooter */\n    /* rowBreaks */\n    /* colBreaks */\n    /* customProperties */\n    /* cellWatches */\n\n    if (!opts || opts.ignoreEC || opts.ignoreEC == void 0) o[o.length] = writetag(\"ignoredErrors\", writextag(\"ignoredError\", null, {\n      numberStoredAsText: 1,\n      sqref: ref\n    }));\n\n    /* smartTags */\n\n    if (_drawing.length > 0) {\n      rId = add_rels(rels, -1, \"../drawings/drawing\" + (idx + 1) + \".xml\", RELS.DRAW);\n      o[o.length] = writextag(\"drawing\", null, {\n        \"r:id\": \"rId\" + rId\n      });\n      ws['!drawing'] = _drawing;\n    }\n    if (ws['!comments'].length > 0) {\n      rId = add_rels(rels, -1, \"../drawings/vmlDrawing\" + (idx + 1) + \".vml\", RELS.VML);\n      o[o.length] = writextag(\"legacyDrawing\", null, {\n        \"r:id\": \"rId\" + rId\n      });\n      ws['!legacy'] = rId;\n    }\n\n    /* legacyDrawingHF */\n    /* picture */\n    /* oleObjects */\n    /* controls */\n    /* webPublishItems */\n    /* tableParts */\n    /* extLst */\n\n    if (o.length > 1) {\n      o[o.length] = '</worksheet>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n    return o.join(\"\");\n  }\n\n  /* [MS-XLSB] 2.4.726 BrtRowHdr */\n  function parse_BrtRowHdr(data, length) {\n    var z = {};\n    var tgt = data.l + length;\n    z.r = data.read_shift(4);\n    data.l += 4; // TODO: ixfe\n    var miyRw = data.read_shift(2);\n    data.l += 1; // TODO: top/bot padding\n    var flags = data.read_shift(1);\n    data.l = tgt;\n    if (flags & 0x07) z.level = flags & 0x07;\n    if (flags & 0x10) z.hidden = true;\n    if (flags & 0x20) z.hpt = miyRw / 20;\n    return z;\n  }\n  function write_BrtRowHdr(R, range, ws) {\n    var o = new_buf(17 + 8 * 16);\n    var row = (ws['!rows'] || [])[R] || {};\n    o.write_shift(4, R);\n    o.write_shift(4, 0); /* TODO: ixfe */\n\n    var miyRw = 0x0140;\n    if (row.hpx) miyRw = px2pt(row.hpx) * 20;else if (row.hpt) miyRw = row.hpt * 20;\n    o.write_shift(2, miyRw);\n    o.write_shift(1, 0); /* top/bot padding */\n\n    var flags = 0x0;\n    if (row.level) flags |= row.level;\n    if (row.hidden) flags |= 0x10;\n    if (row.hpx || row.hpt) flags |= 0x20;\n    o.write_shift(1, flags);\n    o.write_shift(1, 0); /* phonetic guide */\n\n    /* [MS-XLSB] 2.5.8 BrtColSpan explains the mechanism */\n    var ncolspan = 0,\n      lcs = o.l;\n    o.l += 4;\n    var caddr = {\n      r: R,\n      c: 0\n    };\n    for (var i = 0; i < 16; ++i) {\n      if (range.s.c > i + 1 << 10 || range.e.c < i << 10) continue;\n      var first = -1,\n        last = -1;\n      for (var j = i << 10; j < i + 1 << 10; ++j) {\n        caddr.c = j;\n        var cell = Array.isArray(ws) ? (ws[caddr.r] || [])[caddr.c] : ws[encode_cell(caddr)];\n        if (cell) {\n          if (first < 0) first = j;\n          last = j;\n        }\n      }\n      if (first < 0) continue;\n      ++ncolspan;\n      o.write_shift(4, first);\n      o.write_shift(4, last);\n    }\n    var l = o.l;\n    o.l = lcs;\n    o.write_shift(4, ncolspan);\n    o.l = l;\n    return o.length > o.l ? o.slice(0, o.l) : o;\n  }\n  function write_row_header(ba, ws, range, R) {\n    var o = write_BrtRowHdr(R, range, ws);\n    if (o.length > 17 || (ws['!rows'] || [])[R]) write_record(ba, 0x0000 /* BrtRowHdr */, o);\n  }\n\n  /* [MS-XLSB] 2.4.820 BrtWsDim */\n  var parse_BrtWsDim = parse_UncheckedRfX;\n  var write_BrtWsDim = write_UncheckedRfX;\n\n  /* [MS-XLSB] 2.4.821 BrtWsFmtInfo */\n  function parse_BrtWsFmtInfo() {}\n  //function write_BrtWsFmtInfo(ws, o) { }\n\n  /* [MS-XLSB] 2.4.823 BrtWsProp */\n  function parse_BrtWsProp(data, length) {\n    var z = {};\n    var f = data[data.l];\n    ++data.l;\n    z.above = !(f & 0x40);\n    z.left = !(f & 0x80);\n    /* TODO: pull flags */\n    data.l += 18;\n    z.name = parse_XLSBCodeName(data, length - 19);\n    return z;\n  }\n  function write_BrtWsProp(str, outl, o) {\n    if (o == null) o = new_buf(84 + 4 * str.length);\n    var f = 0xC0;\n    if (outl) {\n      if (outl.above) f &= ~0x40;\n      if (outl.left) f &= ~0x80;\n    }\n    o.write_shift(1, f);\n    for (var i = 1; i < 3; ++i) o.write_shift(1, 0);\n    write_BrtColor({\n      auto: 1\n    }, o);\n    o.write_shift(-4, -1);\n    o.write_shift(-4, -1);\n    write_XLSBCodeName(str, o);\n    return o.slice(0, o.l);\n  }\n\n  /* [MS-XLSB] 2.4.306 BrtCellBlank */\n  function parse_BrtCellBlank(data) {\n    var cell = parse_XLSBCell(data);\n    return [cell];\n  }\n  function write_BrtCellBlank(cell, ncell, o) {\n    if (o == null) o = new_buf(8);\n    return write_XLSBCell(ncell, o);\n  }\n  function parse_BrtShortBlank(data) {\n    var cell = parse_XLSBShortCell(data);\n    return [cell];\n  }\n  function write_BrtShortBlank(cell, ncell, o) {\n    if (o == null) o = new_buf(4);\n    return write_XLSBShortCell(ncell, o);\n  }\n\n  /* [MS-XLSB] 2.4.307 BrtCellBool */\n  function parse_BrtCellBool(data) {\n    var cell = parse_XLSBCell(data);\n    var fBool = data.read_shift(1);\n    return [cell, fBool, 'b'];\n  }\n  function write_BrtCellBool(cell, ncell, o) {\n    if (o == null) o = new_buf(9);\n    write_XLSBCell(ncell, o);\n    o.write_shift(1, cell.v ? 1 : 0);\n    return o;\n  }\n  function parse_BrtShortBool(data) {\n    var cell = parse_XLSBShortCell(data);\n    var fBool = data.read_shift(1);\n    return [cell, fBool, 'b'];\n  }\n  function write_BrtShortBool(cell, ncell, o) {\n    if (o == null) o = new_buf(5);\n    write_XLSBShortCell(ncell, o);\n    o.write_shift(1, cell.v ? 1 : 0);\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.308 BrtCellError */\n  function parse_BrtCellError(data) {\n    var cell = parse_XLSBCell(data);\n    var bError = data.read_shift(1);\n    return [cell, bError, 'e'];\n  }\n  function write_BrtCellError(cell, ncell, o) {\n    if (o == null) o = new_buf(9);\n    write_XLSBCell(ncell, o);\n    o.write_shift(1, cell.v);\n    return o;\n  }\n  function parse_BrtShortError(data) {\n    var cell = parse_XLSBShortCell(data);\n    var bError = data.read_shift(1);\n    return [cell, bError, 'e'];\n  }\n  function write_BrtShortError(cell, ncell, o) {\n    if (o == null) o = new_buf(8);\n    write_XLSBShortCell(ncell, o);\n    o.write_shift(1, cell.v);\n    o.write_shift(2, 0);\n    o.write_shift(1, 0);\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.311 BrtCellIsst */\n  function parse_BrtCellIsst(data) {\n    var cell = parse_XLSBCell(data);\n    var isst = data.read_shift(4);\n    return [cell, isst, 's'];\n  }\n  function write_BrtCellIsst(cell, ncell, o) {\n    if (o == null) o = new_buf(12);\n    write_XLSBCell(ncell, o);\n    o.write_shift(4, ncell.v);\n    return o;\n  }\n  function parse_BrtShortIsst(data) {\n    var cell = parse_XLSBShortCell(data);\n    var isst = data.read_shift(4);\n    return [cell, isst, 's'];\n  }\n  function write_BrtShortIsst(cell, ncell, o) {\n    if (o == null) o = new_buf(8);\n    write_XLSBShortCell(ncell, o);\n    o.write_shift(4, ncell.v);\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.313 BrtCellReal */\n  function parse_BrtCellReal(data) {\n    var cell = parse_XLSBCell(data);\n    var value = parse_Xnum(data);\n    return [cell, value, 'n'];\n  }\n  function write_BrtCellReal(cell, ncell, o) {\n    if (o == null) o = new_buf(16);\n    write_XLSBCell(ncell, o);\n    write_Xnum(cell.v, o);\n    return o;\n  }\n  function parse_BrtShortReal(data) {\n    var cell = parse_XLSBShortCell(data);\n    var value = parse_Xnum(data);\n    return [cell, value, 'n'];\n  }\n  function write_BrtShortReal(cell, ncell, o) {\n    if (o == null) o = new_buf(12);\n    write_XLSBShortCell(ncell, o);\n    write_Xnum(cell.v, o);\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.314 BrtCellRk */\n  function parse_BrtCellRk(data) {\n    var cell = parse_XLSBCell(data);\n    var value = parse_RkNumber(data);\n    return [cell, value, 'n'];\n  }\n  function write_BrtCellRk(cell, ncell, o) {\n    if (o == null) o = new_buf(12);\n    write_XLSBCell(ncell, o);\n    write_RkNumber(cell.v, o);\n    return o;\n  }\n  function parse_BrtShortRk(data) {\n    var cell = parse_XLSBShortCell(data);\n    var value = parse_RkNumber(data);\n    return [cell, value, 'n'];\n  }\n  function write_BrtShortRk(cell, ncell, o) {\n    if (o == null) o = new_buf(8);\n    write_XLSBShortCell(ncell, o);\n    write_RkNumber(cell.v, o);\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.323 BrtCellRString */\n  function parse_BrtCellRString(data) {\n    var cell = parse_XLSBCell(data);\n    var value = parse_RichStr(data);\n    return [cell, value, 'is'];\n  }\n\n  /* [MS-XLSB] 2.4.317 BrtCellSt */\n  function parse_BrtCellSt(data) {\n    var cell = parse_XLSBCell(data);\n    var value = parse_XLWideString(data);\n    return [cell, value, 'str'];\n  }\n  function write_BrtCellSt(cell, ncell, o) {\n    if (o == null) o = new_buf(12 + 4 * cell.v.length);\n    write_XLSBCell(ncell, o);\n    write_XLWideString(cell.v, o);\n    return o.length > o.l ? o.slice(0, o.l) : o;\n  }\n  function parse_BrtShortSt(data) {\n    var cell = parse_XLSBShortCell(data);\n    var value = parse_XLWideString(data);\n    return [cell, value, 'str'];\n  }\n  function write_BrtShortSt(cell, ncell, o) {\n    if (o == null) o = new_buf(8 + 4 * cell.v.length);\n    write_XLSBShortCell(ncell, o);\n    write_XLWideString(cell.v, o);\n    return o.length > o.l ? o.slice(0, o.l) : o;\n  }\n\n  /* [MS-XLSB] 2.4.653 BrtFmlaBool */\n  function parse_BrtFmlaBool(data, length, opts) {\n    var end = data.l + length;\n    var cell = parse_XLSBCell(data);\n    cell.r = opts['!row'];\n    var value = data.read_shift(1);\n    var o = [cell, value, 'b'];\n    if (opts.cellFormula) {\n      data.l += 2;\n      var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n      o[3] = stringify_formula(formula, null /*range*/, cell, opts.supbooks, opts); /* TODO */\n    } else data.l = end;\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.654 BrtFmlaError */\n  function parse_BrtFmlaError(data, length, opts) {\n    var end = data.l + length;\n    var cell = parse_XLSBCell(data);\n    cell.r = opts['!row'];\n    var value = data.read_shift(1);\n    var o = [cell, value, 'e'];\n    if (opts.cellFormula) {\n      data.l += 2;\n      var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n      o[3] = stringify_formula(formula, null /*range*/, cell, opts.supbooks, opts); /* TODO */\n    } else data.l = end;\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.655 BrtFmlaNum */\n  function parse_BrtFmlaNum(data, length, opts) {\n    var end = data.l + length;\n    var cell = parse_XLSBCell(data);\n    cell.r = opts['!row'];\n    var value = parse_Xnum(data);\n    var o = [cell, value, 'n'];\n    if (opts.cellFormula) {\n      data.l += 2;\n      var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n      o[3] = stringify_formula(formula, null /*range*/, cell, opts.supbooks, opts); /* TODO */\n    } else data.l = end;\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.656 BrtFmlaString */\n  function parse_BrtFmlaString(data, length, opts) {\n    var end = data.l + length;\n    var cell = parse_XLSBCell(data);\n    cell.r = opts['!row'];\n    var value = parse_XLWideString(data);\n    var o = [cell, value, 'str'];\n    if (opts.cellFormula) {\n      data.l += 2;\n      var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n      o[3] = stringify_formula(formula, null /*range*/, cell, opts.supbooks, opts); /* TODO */\n    } else data.l = end;\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.682 BrtMergeCell */\n  var parse_BrtMergeCell = parse_UncheckedRfX;\n  var write_BrtMergeCell = write_UncheckedRfX;\n  /* [MS-XLSB] 2.4.107 BrtBeginMergeCells */\n  function write_BrtBeginMergeCells(cnt, o) {\n    if (o == null) o = new_buf(4);\n    o.write_shift(4, cnt);\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.662 BrtHLink */\n  function parse_BrtHLink(data, length) {\n    var end = data.l + length;\n    var rfx = parse_UncheckedRfX(data, 16);\n    var relId = parse_XLNullableWideString(data);\n    var loc = parse_XLWideString(data);\n    var tooltip = parse_XLWideString(data);\n    var display = parse_XLWideString(data);\n    data.l = end;\n    var o = {\n      rfx: rfx,\n      relId: relId,\n      loc: loc,\n      display: display\n    };\n    if (tooltip) o.Tooltip = tooltip;\n    return o;\n  }\n  function write_BrtHLink(l, rId) {\n    var o = new_buf(50 + 4 * (l[1].Target.length + (l[1].Tooltip || \"\").length));\n    write_UncheckedRfX({\n      s: decode_cell(l[0]),\n      e: decode_cell(l[0])\n    }, o);\n    write_RelID(\"rId\" + rId, o);\n    var locidx = l[1].Target.indexOf(\"#\");\n    var loc = locidx == -1 ? \"\" : l[1].Target.slice(locidx + 1);\n    write_XLWideString(loc || \"\", o);\n    write_XLWideString(l[1].Tooltip || \"\", o);\n    write_XLWideString(\"\", o);\n    return o.slice(0, o.l);\n  }\n\n  /* [MS-XLSB] 2.4.692 BrtPane */\n  function parse_BrtPane( /*data, length, opts*/\n  ) {}\n\n  /* [MS-XLSB] 2.4.6 BrtArrFmla */\n  function parse_BrtArrFmla(data, length, opts) {\n    var end = data.l + length;\n    var rfx = parse_RfX(data, 16);\n    var fAlwaysCalc = data.read_shift(1);\n    var o = [rfx];\n    o[2] = fAlwaysCalc;\n    if (opts.cellFormula) {\n      var formula = parse_XLSBArrayParsedFormula(data, end - data.l, opts);\n      o[1] = formula;\n    } else data.l = end;\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.750 BrtShrFmla */\n  function parse_BrtShrFmla(data, length, opts) {\n    var end = data.l + length;\n    var rfx = parse_UncheckedRfX(data, 16);\n    var o = [rfx];\n    if (opts.cellFormula) {\n      var formula = parse_XLSBSharedParsedFormula(data, end - data.l, opts);\n      o[1] = formula;\n      data.l = end;\n    } else data.l = end;\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.323 BrtColInfo */\n  /* TODO: once XLS ColInfo is set, combine the functions */\n  function write_BrtColInfo(C, col, o) {\n    if (o == null) o = new_buf(18);\n    var p = col_obj_w(C, col);\n    o.write_shift(-4, C);\n    o.write_shift(-4, C);\n    o.write_shift(4, (p.width || 10) * 256);\n    o.write_shift(4, 0 /*ixfe*/); // style\n    var flags = 0;\n    if (col.hidden) flags |= 0x01;\n    if (typeof p.width == 'number') flags |= 0x02;\n    if (col.level) flags |= col.level << 8;\n    o.write_shift(2, flags); // bit flag\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.678 BrtMargins */\n  var BrtMarginKeys = [\"left\", \"right\", \"top\", \"bottom\", \"header\", \"footer\"];\n  function parse_BrtMargins(data) {\n    var margins = {};\n    BrtMarginKeys.forEach(function (k) {\n      margins[k] = parse_Xnum(data, 8);\n    });\n    return margins;\n  }\n  function write_BrtMargins(margins, o) {\n    if (o == null) o = new_buf(6 * 8);\n    default_margins(margins);\n    BrtMarginKeys.forEach(function (k) {\n      write_Xnum(margins[k], o);\n    });\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.299 BrtBeginWsView */\n  function parse_BrtBeginWsView(data) {\n    var f = data.read_shift(2);\n    data.l += 28;\n    return {\n      RTL: f & 0x20\n    };\n  }\n  function write_BrtBeginWsView(ws, Workbook, o) {\n    if (o == null) o = new_buf(30);\n    var f = 0x39c;\n    if ((((Workbook || {}).Views || [])[0] || {}).RTL) f |= 0x20;\n    o.write_shift(2, f); // bit flag\n    o.write_shift(4, 0);\n    o.write_shift(4, 0); // view first row\n    o.write_shift(4, 0); // view first col\n    o.write_shift(1, 0); // gridline color ICV\n    o.write_shift(1, 0);\n    o.write_shift(2, 0);\n    o.write_shift(2, 100); // zoom scale\n    o.write_shift(2, 0);\n    o.write_shift(2, 0);\n    o.write_shift(2, 0);\n    o.write_shift(4, 0); // workbook view id\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.309 BrtCellIgnoreEC */\n  function write_BrtCellIgnoreEC(ref) {\n    var o = new_buf(24);\n    o.write_shift(4, 4);\n    o.write_shift(4, 1);\n    write_UncheckedRfX(ref, o);\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.748 BrtSheetProtection */\n  function write_BrtSheetProtection(sp, o) {\n    if (o == null) o = new_buf(16 * 4 + 2);\n    o.write_shift(2, sp.password ? crypto_CreatePasswordVerifier_Method1(sp.password) : 0);\n    o.write_shift(4, 1); // this record should not be written if no protection\n    [[\"objects\", false],\n    // fObjects\n    [\"scenarios\", false],\n    // fScenarios\n    [\"formatCells\", true],\n    // fFormatCells\n    [\"formatColumns\", true],\n    // fFormatColumns\n    [\"formatRows\", true],\n    // fFormatRows\n    [\"insertColumns\", true],\n    // fInsertColumns\n    [\"insertRows\", true],\n    // fInsertRows\n    [\"insertHyperlinks\", true],\n    // fInsertHyperlinks\n    [\"deleteColumns\", true],\n    // fDeleteColumns\n    [\"deleteRows\", true],\n    // fDeleteRows\n    [\"selectLockedCells\", false],\n    // fSelLockedCells\n    [\"sort\", true],\n    // fSort\n    [\"autoFilter\", true],\n    // fAutoFilter\n    [\"pivotTables\", true],\n    // fPivotTables\n    [\"selectUnlockedCells\", false] // fSelUnlockedCells\n    ].forEach(function (n) {\n      if (n[1]) o.write_shift(4, sp[n[0]] != null && !sp[n[0]] ? 1 : 0);else o.write_shift(4, sp[n[0]] != null && sp[n[0]] ? 0 : 1);\n    });\n    return o;\n  }\n  function parse_BrtDVal( /*data, length, opts*/\n  ) {}\n  function parse_BrtDVal14( /*data, length, opts*/\n  ) {}\n  /* [MS-XLSB] 2.1.7.61 Worksheet */\n  function parse_ws_bin(data, _opts, idx, rels, wb, themes, styles) {\n    if (!data) return data;\n    var opts = _opts || {};\n    if (!rels) rels = {\n      '!id': {}\n    };\n    if (DENSE != null && opts.dense == null) opts.dense = DENSE;\n    var s = opts.dense ? [] : {};\n    var ref;\n    var refguess = {\n      s: {\n        r: 2000000,\n        c: 2000000\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    var state = [];\n    var pass = false,\n      end = false;\n    var row, p, cf, R, C, addr, sstr, rr, cell;\n    var merges = [];\n    opts.biff = 12;\n    opts['!row'] = 0;\n    var ai = 0,\n      af = false;\n    var arrayf = [];\n    var sharedf = {};\n    var supbooks = opts.supbooks || wb.supbooks || [[]];\n    supbooks.sharedf = sharedf;\n    supbooks.arrayf = arrayf;\n    supbooks.SheetNames = wb.SheetNames || wb.Sheets.map(function (x) {\n      return x.name;\n    });\n    if (!opts.supbooks) {\n      opts.supbooks = supbooks;\n      if (wb.Names) for (var i = 0; i < wb.Names.length; ++i) supbooks[0][i + 1] = wb.Names[i];\n    }\n    var colinfo = [],\n      rowinfo = [];\n    var seencol = false;\n    XLSBRecordEnum[0x0010] = {\n      n: \"BrtShortReal\",\n      f: parse_BrtShortReal\n    };\n    var cm, vm;\n    recordhopper(data, function ws_parse(val, RR, RT) {\n      if (end) return;\n      switch (RT) {\n        case 0x0094:\n          /* 'BrtWsDim' */\n          ref = val;\n          break;\n        case 0x0000:\n          /* 'BrtRowHdr' */\n          row = val;\n          if (opts.sheetRows && opts.sheetRows <= row.r) end = true;\n          rr = encode_row(R = row.r);\n          opts['!row'] = row.r;\n          if (val.hidden || val.hpt || val.level != null) {\n            if (val.hpt) val.hpx = pt2px(val.hpt);\n            rowinfo[val.r] = val;\n          }\n          break;\n        case 0x0002: /* 'BrtCellRk' */\n        case 0x0003: /* 'BrtCellError' */\n        case 0x0004: /* 'BrtCellBool' */\n        case 0x0005: /* 'BrtCellReal' */\n        case 0x0006: /* 'BrtCellSt' */\n        case 0x0007: /* 'BrtCellIsst' */\n        case 0x0008: /* 'BrtFmlaString' */\n        case 0x0009: /* 'BrtFmlaNum' */\n        case 0x000A: /* 'BrtFmlaBool' */\n        case 0x000B: /* 'BrtFmlaError' */\n        case 0x000D: /* 'BrtShortRk' */\n        case 0x000E: /* 'BrtShortError' */\n        case 0x000F: /* 'BrtShortBool' */\n        case 0x0010: /* 'BrtShortReal' */\n        case 0x0011: /* 'BrtShortSt' */\n        case 0x0012: /* 'BrtShortIsst' */\n        case 0x003E:\n          /* 'BrtCellRString' */\n          p = {\n            t: val[2]\n          };\n          switch (val[2]) {\n            case 'n':\n              p.v = val[1];\n              break;\n            case 's':\n              sstr = strs[val[1]];\n              p.v = sstr.t;\n              p.r = sstr.r;\n              break;\n            case 'b':\n              p.v = val[1] ? true : false;\n              break;\n            case 'e':\n              p.v = val[1];\n              if (opts.cellText !== false) p.w = BErr[p.v];\n              break;\n            case 'str':\n              p.t = 's';\n              p.v = val[1];\n              break;\n            case 'is':\n              p.t = 's';\n              p.v = val[1].t;\n              break;\n          }\n          if (cf = styles.CellXf[val[0].iStyleRef]) safe_format(p, cf.numFmtId, null, opts, themes, styles);\n          C = val[0].c == -1 ? C + 1 : val[0].c;\n          if (opts.dense) {\n            if (!s[R]) s[R] = [];\n            s[R][C] = p;\n          } else s[encode_col(C) + rr] = p;\n          if (opts.cellFormula) {\n            af = false;\n            for (ai = 0; ai < arrayf.length; ++ai) {\n              var aii = arrayf[ai];\n              if (row.r >= aii[0].s.r && row.r <= aii[0].e.r) if (C >= aii[0].s.c && C <= aii[0].e.c) {\n                p.F = encode_range(aii[0]);\n                af = true;\n              }\n            }\n            if (!af && val.length > 3) p.f = val[3];\n          }\n          if (refguess.s.r > row.r) refguess.s.r = row.r;\n          if (refguess.s.c > C) refguess.s.c = C;\n          if (refguess.e.r < row.r) refguess.e.r = row.r;\n          if (refguess.e.c < C) refguess.e.c = C;\n          if (opts.cellDates && cf && p.t == 'n' && fmt_is_date(table_fmt[cf.numFmtId])) {\n            var _d = SSF_parse_date_code(p.v);\n            if (_d) {\n              p.t = 'd';\n              p.v = new Date(_d.y, _d.m - 1, _d.d, _d.H, _d.M, _d.S, _d.u);\n            }\n          }\n          if (cm) {\n            if (cm.type == 'XLDAPR') p.D = true;\n            cm = void 0;\n          }\n          if (vm) vm = void 0;\n          break;\n        case 0x0001: /* 'BrtCellBlank' */\n        case 0x000C:\n          /* 'BrtShortBlank' */\n          if (!opts.sheetStubs || pass) break;\n          p = {\n            t: 'z',\n            v: void 0\n          };\n          C = val[0].c == -1 ? C + 1 : val[0].c;\n          if (opts.dense) {\n            if (!s[R]) s[R] = [];\n            s[R][C] = p;\n          } else s[encode_col(C) + rr] = p;\n          if (refguess.s.r > row.r) refguess.s.r = row.r;\n          if (refguess.s.c > C) refguess.s.c = C;\n          if (refguess.e.r < row.r) refguess.e.r = row.r;\n          if (refguess.e.c < C) refguess.e.c = C;\n          if (cm) {\n            if (cm.type == 'XLDAPR') p.D = true;\n            cm = void 0;\n          }\n          if (vm) vm = void 0;\n          break;\n        case 0x00B0:\n          /* 'BrtMergeCell' */\n          merges.push(val);\n          break;\n        case 0x0031:\n          {\n            /* 'BrtCellMeta' */\n            cm = ((opts.xlmeta || {}).Cell || [])[val - 1];\n          }\n          break;\n        case 0x01EE:\n          /* 'BrtHLink' */\n          var rel = rels['!id'][val.relId];\n          if (rel) {\n            val.Target = rel.Target;\n            if (val.loc) val.Target += \"#\" + val.loc;\n            val.Rel = rel;\n          } else if (val.relId == '') {\n            val.Target = \"#\" + val.loc;\n          }\n          for (R = val.rfx.s.r; R <= val.rfx.e.r; ++R) for (C = val.rfx.s.c; C <= val.rfx.e.c; ++C) {\n            if (opts.dense) {\n              if (!s[R]) s[R] = [];\n              if (!s[R][C]) s[R][C] = {\n                t: 'z',\n                v: undefined\n              };\n              s[R][C].l = val;\n            } else {\n              addr = encode_cell({\n                c: C,\n                r: R\n              });\n              if (!s[addr]) s[addr] = {\n                t: 'z',\n                v: undefined\n              };\n              s[addr].l = val;\n            }\n          }\n          break;\n        case 0x01AA:\n          /* 'BrtArrFmla' */\n          if (!opts.cellFormula) break;\n          arrayf.push(val);\n          cell = opts.dense ? s[R][C] : s[encode_col(C) + rr];\n          cell.f = stringify_formula(val[1], refguess, {\n            r: row.r,\n            c: C\n          }, supbooks, opts);\n          cell.F = encode_range(val[0]);\n          break;\n        case 0x01AB:\n          /* 'BrtShrFmla' */\n          if (!opts.cellFormula) break;\n          sharedf[encode_cell(val[0].s)] = val[1];\n          cell = opts.dense ? s[R][C] : s[encode_col(C) + rr];\n          cell.f = stringify_formula(val[1], refguess, {\n            r: row.r,\n            c: C\n          }, supbooks, opts);\n          break;\n\n        /* identical to 'ColInfo' in XLS */\n        case 0x003C:\n          /* 'BrtColInfo' */\n          if (!opts.cellStyles) break;\n          while (val.e >= val.s) {\n            colinfo[val.e--] = {\n              width: val.w / 256,\n              hidden: !!(val.flags & 0x01),\n              level: val.level\n            };\n            if (!seencol) {\n              seencol = true;\n              find_mdw_colw(val.w / 256);\n            }\n            process_col(colinfo[val.e + 1]);\n          }\n          break;\n        case 0x00A1:\n          /* 'BrtBeginAFilter' */\n          s['!autofilter'] = {\n            ref: encode_range(val)\n          };\n          break;\n        case 0x01DC:\n          /* 'BrtMargins' */\n          s['!margins'] = val;\n          break;\n        case 0x0093:\n          /* 'BrtWsProp' */\n          if (!wb.Sheets[idx]) wb.Sheets[idx] = {};\n          if (val.name) wb.Sheets[idx].CodeName = val.name;\n          if (val.above || val.left) s['!outline'] = {\n            above: val.above,\n            left: val.left\n          };\n          break;\n        case 0x0089:\n          /* 'BrtBeginWsView' */\n          if (!wb.Views) wb.Views = [{}];\n          if (!wb.Views[0]) wb.Views[0] = {};\n          if (val.RTL) wb.Views[0].RTL = true;\n          break;\n        case 0x01E5:\n          /* 'BrtWsFmtInfo' */\n          break;\n        case 0x0040: /* 'BrtDVal' */\n        case 0x041D:\n          /* 'BrtDVal14' */\n          break;\n        case 0x0097:\n          /* 'BrtPane' */\n          break;\n        case 0x0098: /* 'BrtSel' */\n        case 0x00AF: /* 'BrtAFilterDateGroupItem' */\n        case 0x0284: /* 'BrtActiveX' */\n        case 0x0271: /* 'BrtBigName' */\n        case 0x0232: /* 'BrtBkHim' */\n        case 0x018C: /* 'BrtBrk' */\n        case 0x0458: /* 'BrtCFIcon' */\n        case 0x047A: /* 'BrtCFRuleExt' */\n        case 0x01D7: /* 'BrtCFVO' */\n        case 0x041A: /* 'BrtCFVO14' */\n        case 0x0289: /* 'BrtCellIgnoreEC' */\n        case 0x0451: /* 'BrtCellIgnoreEC14' */\n        case 0x024D: /* 'BrtCellSmartTagProperty' */\n        case 0x025F: /* 'BrtCellWatch' */\n        case 0x0234: /* 'BrtColor' */\n        case 0x041F: /* 'BrtColor14' */\n        case 0x00A8: /* 'BrtColorFilter' */\n        case 0x00AE: /* 'BrtCustomFilter' */\n        case 0x049C: /* 'BrtCustomFilter14' */\n        case 0x01F3: /* 'BrtDRef' */\n        case 0x01FB: /* 'BrtDXF' */\n        case 0x0226: /* 'BrtDrawing' */\n        case 0x00AB: /* 'BrtDynamicFilter' */\n        case 0x00A7: /* 'BrtFilter' */\n        case 0x0499: /* 'BrtFilter14' */\n        case 0x00A9: /* 'BrtIconFilter' */\n        case 0x049D: /* 'BrtIconFilter14' */\n        case 0x0227: /* 'BrtLegacyDrawing' */\n        case 0x0228: /* 'BrtLegacyDrawingHF' */\n        case 0x0295: /* 'BrtListPart' */\n        case 0x027F: /* 'BrtOleObject' */\n        case 0x01DE: /* 'BrtPageSetup' */\n        case 0x0219: /* 'BrtPhoneticInfo' */\n        case 0x01DD: /* 'BrtPrintOptions' */\n        case 0x0218: /* 'BrtRangeProtection' */\n        case 0x044F: /* 'BrtRangeProtection14' */\n        case 0x02A8: /* 'BrtRangeProtectionIso' */\n        case 0x0450: /* 'BrtRangeProtectionIso14' */\n        case 0x0400: /* 'BrtRwDescent' */\n        case 0x0297: /* 'BrtSheetCalcProp' */\n        case 0x0217: /* 'BrtSheetProtection' */\n        case 0x02A6: /* 'BrtSheetProtectionIso' */\n        case 0x01F8: /* 'BrtSlc' */\n        case 0x0413: /* 'BrtSparkline' */\n        case 0x01AC: /* 'BrtTable' */\n        case 0x00AA: /* 'BrtTop10Filter' */\n        case 0x0C00: /* 'BrtUid' */\n        case 0x0032: /* 'BrtValueMeta' */\n        case 0x0816: /* 'BrtWebExtension' */\n        case 0x0415:\n          /* 'BrtWsFmtInfoEx14' */\n          break;\n        case 0x0023:\n          /* 'BrtFRTBegin' */\n          pass = true;\n          break;\n        case 0x0024:\n          /* 'BrtFRTEnd' */\n          pass = false;\n          break;\n        case 0x0025:\n          /* 'BrtACBegin' */\n          state.push(RT);\n          pass = true;\n          break;\n        case 0x0026:\n          /* 'BrtACEnd' */\n          state.pop();\n          pass = false;\n          break;\n        default:\n          if (RR.T) {/* empty */} else if (!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n      }\n    }, opts);\n    delete opts.supbooks;\n    delete opts['!row'];\n    if (!s[\"!ref\"] && (refguess.s.r < 2000000 || ref && (ref.e.r > 0 || ref.e.c > 0 || ref.s.r > 0 || ref.s.c > 0))) s[\"!ref\"] = encode_range(ref || refguess);\n    if (opts.sheetRows && s[\"!ref\"]) {\n      var tmpref = safe_decode_range(s[\"!ref\"]);\n      if (opts.sheetRows <= +tmpref.e.r) {\n        tmpref.e.r = opts.sheetRows - 1;\n        if (tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n        if (tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n        if (tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n        if (tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n        s[\"!fullref\"] = s[\"!ref\"];\n        s[\"!ref\"] = encode_range(tmpref);\n      }\n    }\n    if (merges.length > 0) s[\"!merges\"] = merges;\n    if (colinfo.length > 0) s[\"!cols\"] = colinfo;\n    if (rowinfo.length > 0) s[\"!rows\"] = rowinfo;\n    return s;\n  }\n\n  /* TODO: something useful -- this is a stub */\n  function write_ws_bin_cell(ba, cell, R, C, opts, ws, last_seen) {\n    if (cell.v === undefined) return false;\n    var vv = \"\";\n    switch (cell.t) {\n      case 'b':\n        vv = cell.v ? \"1\" : \"0\";\n        break;\n      case 'd':\n        // no BrtCellDate :(\n        cell = dup(cell);\n        cell.z = cell.z || table_fmt[14];\n        cell.v = datenum(parseDate(cell.v));\n        cell.t = 'n';\n        break;\n      /* falls through */\n      case 'n':\n      case 'e':\n        vv = '' + cell.v;\n        break;\n      default:\n        vv = cell.v;\n        break;\n    }\n    var o = {\n      r: R,\n      c: C\n    };\n    /* TODO: cell style */\n    o.s = get_cell_style(opts.cellXfs, cell, opts);\n    if (cell.l) ws['!links'].push([encode_cell(o), cell.l]);\n    if (cell.c) ws['!comments'].push([encode_cell(o), cell.c]);\n    switch (cell.t) {\n      case 's':\n      case 'str':\n        if (opts.bookSST) {\n          vv = get_sst_id(opts.Strings, cell.v, opts.revStrings);\n          o.t = \"s\";\n          o.v = vv;\n          if (last_seen) write_record(ba, 0x0012 /* BrtShortIsst */, write_BrtShortIsst(cell, o));else write_record(ba, 0x0007 /* BrtCellIsst */, write_BrtCellIsst(cell, o));\n        } else {\n          o.t = \"str\";\n          if (last_seen) write_record(ba, 0x0011 /* BrtShortSt */, write_BrtShortSt(cell, o));else write_record(ba, 0x0006 /* BrtCellSt */, write_BrtCellSt(cell, o));\n        }\n        return true;\n      case 'n':\n        /* TODO: determine threshold for Real vs RK */\n        if (cell.v == (cell.v | 0) && cell.v > -1000 && cell.v < 1000) {\n          if (last_seen) write_record(ba, 0x000D /* BrtShortRk */, write_BrtShortRk(cell, o));else write_record(ba, 0x0002 /* BrtCellRk */, write_BrtCellRk(cell, o));\n        } else {\n          if (last_seen) write_record(ba, 0x0010 /* BrtShortReal */, write_BrtShortReal(cell, o));else write_record(ba, 0x0005 /* BrtCellReal */, write_BrtCellReal(cell, o));\n        }\n        return true;\n      case 'b':\n        o.t = \"b\";\n        if (last_seen) write_record(ba, 0x000F /* BrtShortBool */, write_BrtShortBool(cell, o));else write_record(ba, 0x0004 /* BrtCellBool */, write_BrtCellBool(cell, o));\n        return true;\n      case 'e':\n        o.t = \"e\";\n        if (last_seen) write_record(ba, 0x000E /* BrtShortError */, write_BrtShortError(cell, o));else write_record(ba, 0x0003 /* BrtCellError */, write_BrtCellError(cell, o));\n        return true;\n    }\n    if (last_seen) write_record(ba, 0x000C /* BrtShortBlank */, write_BrtShortBlank(cell, o));else write_record(ba, 0x0001 /* BrtCellBlank */, write_BrtCellBlank(cell, o));\n    return true;\n  }\n  function write_CELLTABLE(ba, ws, idx, opts) {\n    var range = safe_decode_range(ws['!ref'] || \"A1\"),\n      ref,\n      rr = \"\",\n      cols = [];\n    write_record(ba, 0x0091 /* BrtBeginSheetData */);\n    var dense = Array.isArray(ws);\n    var cap = range.e.r;\n    if (ws['!rows']) cap = Math.max(range.e.r, ws['!rows'].length - 1);\n    for (var R = range.s.r; R <= cap; ++R) {\n      rr = encode_row(R);\n      /* [ACCELLTABLE] */\n      /* BrtRowHdr */\n      write_row_header(ba, ws, range, R);\n      var last_seen = false;\n      if (R <= range.e.r) for (var C = range.s.c; C <= range.e.c; ++C) {\n        /* *16384CELL */\n        if (R === range.s.r) cols[C] = encode_col(C);\n        ref = cols[C] + rr;\n        var cell = dense ? (ws[R] || [])[C] : ws[ref];\n        if (!cell) {\n          last_seen = false;\n          continue;\n        }\n        /* write cell */\n        last_seen = write_ws_bin_cell(ba, cell, R, C, opts, ws, last_seen);\n      }\n    }\n    write_record(ba, 0x0092 /* BrtEndSheetData */);\n  }\n\n  function write_MERGECELLS(ba, ws) {\n    if (!ws || !ws['!merges']) return;\n    write_record(ba, 0x00B1 /* BrtBeginMergeCells */, write_BrtBeginMergeCells(ws['!merges'].length));\n    ws['!merges'].forEach(function (m) {\n      write_record(ba, 0x00B0 /* BrtMergeCell */, write_BrtMergeCell(m));\n    });\n    write_record(ba, 0x00B2 /* BrtEndMergeCells */);\n  }\n\n  function write_COLINFOS(ba, ws) {\n    if (!ws || !ws['!cols']) return;\n    write_record(ba, 0x0186 /* BrtBeginColInfos */);\n    ws['!cols'].forEach(function (m, i) {\n      if (m) write_record(ba, 0x003C /* 'BrtColInfo' */, write_BrtColInfo(i, m));\n    });\n    write_record(ba, 0x0187 /* BrtEndColInfos */);\n  }\n\n  function write_IGNOREECS(ba, ws) {\n    if (!ws || !ws['!ref']) return;\n    write_record(ba, 0x0288 /* BrtBeginCellIgnoreECs */);\n    write_record(ba, 0x0289 /* BrtCellIgnoreEC */, write_BrtCellIgnoreEC(safe_decode_range(ws['!ref'])));\n    write_record(ba, 0x028A /* BrtEndCellIgnoreECs */);\n  }\n\n  function write_HLINKS(ba, ws, rels) {\n    /* *BrtHLink */\n    ws['!links'].forEach(function (l) {\n      if (!l[1].Target) return;\n      var rId = add_rels(rels, -1, l[1].Target.replace(/#.*$/, \"\"), RELS.HLINK);\n      write_record(ba, 0x01EE /* BrtHLink */, write_BrtHLink(l, rId));\n    });\n    delete ws['!links'];\n  }\n  function write_LEGACYDRAWING(ba, ws, idx, rels) {\n    /* [BrtLegacyDrawing] */\n    if (ws['!comments'].length > 0) {\n      var rId = add_rels(rels, -1, \"../drawings/vmlDrawing\" + (idx + 1) + \".vml\", RELS.VML);\n      write_record(ba, 0x0227 /* BrtLegacyDrawing */, write_RelID(\"rId\" + rId));\n      ws['!legacy'] = rId;\n    }\n  }\n  function write_AUTOFILTER(ba, ws, wb, idx) {\n    if (!ws['!autofilter']) return;\n    var data = ws['!autofilter'];\n    var ref = typeof data.ref === \"string\" ? data.ref : encode_range(data.ref);\n\n    /* Update FilterDatabase defined name for the worksheet */\n    if (!wb.Workbook) wb.Workbook = {\n      Sheets: []\n    };\n    if (!wb.Workbook.Names) wb.Workbook.Names = [];\n    var names = wb.Workbook.Names;\n    var range = decode_range(ref);\n    if (range.s.r == range.e.r) {\n      range.e.r = decode_range(ws[\"!ref\"]).e.r;\n      ref = encode_range(range);\n    }\n    for (var i = 0; i < names.length; ++i) {\n      var name = names[i];\n      if (name.Name != '_xlnm._FilterDatabase') continue;\n      if (name.Sheet != idx) continue;\n      name.Ref = \"'\" + wb.SheetNames[idx] + \"'!\" + ref;\n      break;\n    }\n    if (i == names.length) names.push({\n      Name: '_xlnm._FilterDatabase',\n      Sheet: idx,\n      Ref: \"'\" + wb.SheetNames[idx] + \"'!\" + ref\n    });\n    write_record(ba, 0x00A1 /* BrtBeginAFilter */, write_UncheckedRfX(safe_decode_range(ref)));\n    /* *FILTERCOLUMN */\n    /* [SORTSTATE] */\n    /* BrtEndAFilter */\n    write_record(ba, 0x00A2 /* BrtEndAFilter */);\n  }\n\n  function write_WSVIEWS2(ba, ws, Workbook) {\n    write_record(ba, 0x0085 /* BrtBeginWsViews */);\n    {\n      /* 1*WSVIEW2 */\n      /* [ACUID] */\n      write_record(ba, 0x0089 /* BrtBeginWsView */, write_BrtBeginWsView(ws, Workbook));\n      /* [BrtPane] */\n      /* *4BrtSel */\n      /* *4SXSELECT */\n      /* *FRT */\n      write_record(ba, 0x008A /* BrtEndWsView */);\n    }\n    /* *FRT */\n    write_record(ba, 0x0086 /* BrtEndWsViews */);\n  }\n\n  function write_WSFMTINFO() {\n    /* [ACWSFMTINFO] */\n    // write_record(ba, 0x01E5 /* BrtWsFmtInfo */, write_BrtWsFmtInfo(ws));\n  }\n  function write_SHEETPROTECT(ba, ws) {\n    if (!ws['!protect']) return;\n    /* [BrtSheetProtectionIso] */\n    write_record(ba, 0x0217 /* BrtSheetProtection */, write_BrtSheetProtection(ws['!protect']));\n  }\n  function write_ws_bin(idx, opts, wb, rels) {\n    var ba = buf_array();\n    var s = wb.SheetNames[idx],\n      ws = wb.Sheets[s] || {};\n    var c = s;\n    try {\n      if (wb && wb.Workbook) c = wb.Workbook.Sheets[idx].CodeName || c;\n    } catch (e) {}\n    var r = safe_decode_range(ws['!ref'] || \"A1\");\n    if (r.e.c > 0x3FFF || r.e.r > 0xFFFFF) {\n      if (opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:XFD1048576\");\n      r.e.c = Math.min(r.e.c, 0x3FFF);\n      r.e.r = Math.min(r.e.c, 0xFFFFF);\n    }\n    ws['!links'] = [];\n    /* passed back to write_zip and removed there */\n    ws['!comments'] = [];\n    write_record(ba, 0x0081 /* BrtBeginSheet */);\n    if (wb.vbaraw || ws['!outline']) write_record(ba, 0x0093 /* BrtWsProp */, write_BrtWsProp(c, ws['!outline']));\n    write_record(ba, 0x0094 /* BrtWsDim */, write_BrtWsDim(r));\n    write_WSVIEWS2(ba, ws, wb.Workbook);\n    write_WSFMTINFO(ba, ws);\n    write_COLINFOS(ba, ws, idx, opts, wb);\n    write_CELLTABLE(ba, ws, idx, opts, wb);\n    /* [BrtSheetCalcProp] */\n    write_SHEETPROTECT(ba, ws);\n    /* *([BrtRangeProtectionIso] BrtRangeProtection) */\n    /* [SCENMAN] */\n    write_AUTOFILTER(ba, ws, wb, idx);\n    /* [SORTSTATE] */\n    /* [DCON] */\n    /* [USERSHVIEWS] */\n    write_MERGECELLS(ba, ws);\n    /* [BrtPhoneticInfo] */\n    /* *CONDITIONALFORMATTING */\n    /* [DVALS] */\n    write_HLINKS(ba, ws, rels);\n    /* [BrtPrintOptions] */\n    if (ws['!margins']) write_record(ba, 0x01DC /* BrtMargins */, write_BrtMargins(ws['!margins']));\n    /* [BrtPageSetup] */\n    /* [HEADERFOOTER] */\n    /* [RWBRK] */\n    /* [COLBRK] */\n    /* *BrtBigName */\n    /* [CELLWATCHES] */\n    if (!opts || opts.ignoreEC || opts.ignoreEC == void 0) write_IGNOREECS(ba, ws);\n    /* [SMARTTAGS] */\n    /* [BrtDrawing] */\n    write_LEGACYDRAWING(ba, ws, idx, rels);\n    /* [BrtLegacyDrawingHF] */\n    /* [BrtBkHim] */\n    /* [OLEOBJECTS] */\n    /* [ACTIVEXCONTROLS] */\n    /* [WEBPUBITEMS] */\n    /* [LISTPARTS] */\n    /* FRTWORKSHEET */\n    write_record(ba, 0x0082 /* BrtEndSheet */);\n    return ba.end();\n  }\n  function parse_Cache(data) {\n    var col = [];\n    var num = data.match(/^<c:numCache>/);\n    var f;\n\n    /* 21.2.2.150 pt CT_NumVal */\n    (data.match(/<c:pt idx=\"(\\d*)\">(.*?)<\\/c:pt>/mg) || []).forEach(function (pt) {\n      var q = pt.match(/<c:pt idx=\"(\\d*?)\"><c:v>(.*)<\\/c:v><\\/c:pt>/);\n      if (!q) return;\n      col[+q[1]] = num ? +q[2] : q[2];\n    });\n\n    /* 21.2.2.71 formatCode CT_Xstring */\n    var nf = unescapexml((data.match(/<c:formatCode>([\\s\\S]*?)<\\/c:formatCode>/) || [\"\", \"General\"])[1]);\n    (data.match(/<c:f>(.*?)<\\/c:f>/mg) || []).forEach(function (F) {\n      f = F.replace(/<.*?>/g, \"\");\n    });\n    return [col, nf, f];\n  }\n\n  /* 21.2 DrawingML - Charts */\n  function parse_chart(data, name, opts, rels, wb, csheet) {\n    var cs = csheet || {\n      \"!type\": \"chart\"\n    };\n    if (!data) return csheet;\n    /* 21.2.2.27 chart CT_Chart */\n\n    var C = 0,\n      R = 0,\n      col = \"A\";\n    var refguess = {\n      s: {\n        r: 2000000,\n        c: 2000000\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n\n    /* 21.2.2.120 numCache CT_NumData */\n    (data.match(/<c:numCache>[\\s\\S]*?<\\/c:numCache>/gm) || []).forEach(function (nc) {\n      var cache = parse_Cache(nc);\n      refguess.s.r = refguess.s.c = 0;\n      refguess.e.c = C;\n      col = encode_col(C);\n      cache[0].forEach(function (n, i) {\n        cs[col + encode_row(i)] = {\n          t: 'n',\n          v: n,\n          z: cache[1]\n        };\n        R = i;\n      });\n      if (refguess.e.r < R) refguess.e.r = R;\n      ++C;\n    });\n    if (C > 0) cs[\"!ref\"] = encode_range(refguess);\n    return cs;\n  }\n  /* 18.3 Worksheets also covers Chartsheets */\n  function parse_cs_xml(data, opts, idx, rels, wb) {\n    if (!data) return data;\n    /* 18.3.1.12 chartsheet CT_ChartSheet */\n    if (!rels) rels = {\n      '!id': {}\n    };\n    var s = {\n      '!type': \"chart\",\n      '!drawel': null,\n      '!rel': \"\"\n    };\n    var m;\n\n    /* 18.3.1.83 sheetPr CT_ChartsheetPr */\n    var sheetPr = data.match(sheetprregex);\n    if (sheetPr) parse_ws_xml_sheetpr(sheetPr[0], s, wb, idx);\n\n    /* 18.3.1.36 drawing CT_Drawing */\n    if (m = data.match(/drawing r:id=\"(.*?)\"/)) s['!rel'] = m[1];\n    if (rels['!id'][s['!rel']]) s['!drawel'] = rels['!id'][s['!rel']];\n    return s;\n  }\n  function write_cs_xml(idx, opts, wb, rels) {\n    var o = [XML_HEADER, writextag('chartsheet', null, {\n      'xmlns': XMLNS_main[0],\n      'xmlns:r': XMLNS.r\n    })];\n    o[o.length] = writextag(\"drawing\", null, {\n      \"r:id\": \"rId1\"\n    });\n    add_rels(rels, -1, \"../drawings/drawing\" + (idx + 1) + \".xml\", RELS.DRAW);\n    if (o.length > 2) {\n      o[o.length] = '</chartsheet>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n    return o.join(\"\");\n  }\n\n  /* [MS-XLSB] 2.4.331 BrtCsProp */\n  function parse_BrtCsProp(data, length) {\n    data.l += 10;\n    var name = parse_XLWideString(data, length - 10);\n    return {\n      name: name\n    };\n  }\n\n  /* [MS-XLSB] 2.1.7.7 Chart Sheet */\n  function parse_cs_bin(data, opts, idx, rels, wb) {\n    if (!data) return data;\n    if (!rels) rels = {\n      '!id': {}\n    };\n    var s = {\n      '!type': \"chart\",\n      '!drawel': null,\n      '!rel': \"\"\n    };\n    var state = [];\n    var pass = false;\n    recordhopper(data, function cs_parse(val, R, RT) {\n      switch (RT) {\n        case 0x0226:\n          /* 'BrtDrawing' */\n          s['!rel'] = val;\n          break;\n        case 0x028B:\n          /* 'BrtCsProp' */\n          if (!wb.Sheets[idx]) wb.Sheets[idx] = {};\n          if (val.name) wb.Sheets[idx].CodeName = val.name;\n          break;\n        case 0x0232: /* 'BrtBkHim' */\n        case 0x028C: /* 'BrtCsPageSetup' */\n        case 0x029D: /* 'BrtCsProtection' */\n        case 0x02A7: /* 'BrtCsProtectionIso' */\n        case 0x0227: /* 'BrtLegacyDrawing' */\n        case 0x0228: /* 'BrtLegacyDrawingHF' */\n        case 0x01DC: /* 'BrtMargins' */\n        case 0x0C00:\n          /* 'BrtUid' */\n          break;\n        case 0x0023:\n          /* 'BrtFRTBegin' */\n          pass = true;\n          break;\n        case 0x0024:\n          /* 'BrtFRTEnd' */\n          pass = false;\n          break;\n        case 0x0025:\n          /* 'BrtACBegin' */\n          state.push(RT);\n          break;\n        case 0x0026:\n          /* 'BrtACEnd' */\n          state.pop();\n          break;\n        default:\n          if (R.T > 0) state.push(RT);else if (R.T < 0) state.pop();else if (!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n      }\n    }, opts);\n    if (rels['!id'][s['!rel']]) s['!drawel'] = rels['!id'][s['!rel']];\n    return s;\n  }\n  function write_cs_bin() {\n    var ba = buf_array();\n    write_record(ba, 0x0081 /* BrtBeginSheet */);\n    /* [BrtCsProp] */\n    /* CSVIEWS */\n    /* [[BrtCsProtectionIso] BrtCsProtection] */\n    /* [USERCSVIEWS] */\n    /* [BrtMargins] */\n    /* [BrtCsPageSetup] */\n    /* [HEADERFOOTER] */\n    /* BrtDrawing */\n    /* [BrtLegacyDrawing] */\n    /* [BrtLegacyDrawingHF] */\n    /* [BrtBkHim] */\n    /* [WEBPUBITEMS] */\n    /* FRTCHARTSHEET */\n    write_record(ba, 0x0082 /* BrtEndSheet */);\n    return ba.end();\n  }\n  /* 18.2.28 (CT_WorkbookProtection) Defaults */\n  var WBPropsDef = [['allowRefreshQuery', false, \"bool\"], ['autoCompressPictures', true, \"bool\"], ['backupFile', false, \"bool\"], ['checkCompatibility', false, \"bool\"], ['CodeName', ''], ['date1904', false, \"bool\"], ['defaultThemeVersion', 0, \"int\"], ['filterPrivacy', false, \"bool\"], ['hidePivotFieldList', false, \"bool\"], ['promptedSolutions', false, \"bool\"], ['publishItems', false, \"bool\"], ['refreshAllConnections', false, \"bool\"], ['saveExternalLinkValues', true, \"bool\"], ['showBorderUnselectedTables', true, \"bool\"], ['showInkAnnotation', true, \"bool\"], ['showObjects', 'all'], ['showPivotChartFilter', false, \"bool\"], ['updateLinks', 'userSet']];\n\n  /* 18.2.30 (CT_BookView) Defaults */\n  var WBViewDef = [['activeTab', 0, \"int\"], ['autoFilterDateGrouping', true, \"bool\"], ['firstSheet', 0, \"int\"], ['minimized', false, \"bool\"], ['showHorizontalScroll', true, \"bool\"], ['showSheetTabs', true, \"bool\"], ['showVerticalScroll', true, \"bool\"], ['tabRatio', 600, \"int\"], ['visibility', 'visible']\n  //window{Height,Width}, {x,y}Window\n  ];\n\n  /* 18.2.19 (CT_Sheet) Defaults */\n  var SheetDef = [\n    //['state', 'visible']\n  ];\n\n  /* 18.2.2  (CT_CalcPr) Defaults */\n  var CalcPrDef = [['calcCompleted', 'true'], ['calcMode', 'auto'], ['calcOnSave', 'true'], ['concurrentCalc', 'true'], ['fullCalcOnLoad', 'false'], ['fullPrecision', 'true'], ['iterate', 'false'], ['iterateCount', '100'], ['iterateDelta', '0.001'], ['refMode', 'A1']];\n\n  /* 18.2.3 (CT_CustomWorkbookView) Defaults */\n  /*var CustomWBViewDef = [\n  \t['autoUpdate', 'false'],\n  \t['changesSavedWin', 'false'],\n  \t['includeHiddenRowCol', 'true'],\n  \t['includePrintSettings', 'true'],\n  \t['maximized', 'false'],\n  \t['minimized', 'false'],\n  \t['onlySync', 'false'],\n  \t['personalView', 'false'],\n  \t['showComments', 'commIndicator'],\n  \t['showFormulaBar', 'true'],\n  \t['showHorizontalScroll', 'true'],\n  \t['showObjects', 'all'],\n  \t['showSheetTabs', 'true'],\n  \t['showStatusbar', 'true'],\n  \t['showVerticalScroll', 'true'],\n  \t['tabRatio', '600'],\n  \t['xWindow', '0'],\n  \t['yWindow', '0']\n  ];*/\n\n  function push_defaults_array(target, defaults) {\n    for (var j = 0; j != target.length; ++j) {\n      var w = target[j];\n      for (var i = 0; i != defaults.length; ++i) {\n        var z = defaults[i];\n        if (w[z[0]] == null) w[z[0]] = z[1];else switch (z[2]) {\n          case \"bool\":\n            if (typeof w[z[0]] == \"string\") w[z[0]] = parsexmlbool(w[z[0]]);\n            break;\n          case \"int\":\n            if (typeof w[z[0]] == \"string\") w[z[0]] = parseInt(w[z[0]], 10);\n            break;\n        }\n      }\n    }\n  }\n  function push_defaults(target, defaults) {\n    for (var i = 0; i != defaults.length; ++i) {\n      var z = defaults[i];\n      if (target[z[0]] == null) target[z[0]] = z[1];else switch (z[2]) {\n        case \"bool\":\n          if (typeof target[z[0]] == \"string\") target[z[0]] = parsexmlbool(target[z[0]]);\n          break;\n        case \"int\":\n          if (typeof target[z[0]] == \"string\") target[z[0]] = parseInt(target[z[0]], 10);\n          break;\n      }\n    }\n  }\n  function parse_wb_defaults(wb) {\n    push_defaults(wb.WBProps, WBPropsDef);\n    push_defaults(wb.CalcPr, CalcPrDef);\n    push_defaults_array(wb.WBView, WBViewDef);\n    push_defaults_array(wb.Sheets, SheetDef);\n    _ssfopts.date1904 = parsexmlbool(wb.WBProps.date1904);\n  }\n  function safe1904(wb) {\n    /* TODO: store date1904 somewhere else */\n    if (!wb.Workbook) return \"false\";\n    if (!wb.Workbook.WBProps) return \"false\";\n    return parsexmlbool(wb.Workbook.WBProps.date1904) ? \"true\" : \"false\";\n  }\n  var badchars = \"][*?\\/\\\\\".split(\"\");\n  function check_ws_name(n, safe) {\n    if (n.length > 31) {\n      if (safe) return false;\n      throw new Error(\"Sheet names cannot exceed 31 chars\");\n    }\n    var _good = true;\n    badchars.forEach(function (c) {\n      if (n.indexOf(c) == -1) return;\n      if (!safe) throw new Error(\"Sheet name cannot contain : \\\\ / ? * [ ]\");\n      _good = false;\n    });\n    return _good;\n  }\n  function check_wb_names(N, S, codes) {\n    N.forEach(function (n, i) {\n      check_ws_name(n);\n      for (var j = 0; j < i; ++j) if (n == N[j]) throw new Error(\"Duplicate Sheet Name: \" + n);\n      if (codes) {\n        var cn = S && S[i] && S[i].CodeName || n;\n        if (cn.charCodeAt(0) == 95 && cn.length > 22) throw new Error(\"Bad Code Name: Worksheet\" + cn);\n      }\n    });\n  }\n  function check_wb(wb) {\n    if (!wb || !wb.SheetNames || !wb.Sheets) throw new Error(\"Invalid Workbook\");\n    if (!wb.SheetNames.length) throw new Error(\"Workbook is empty\");\n    var Sheets = wb.Workbook && wb.Workbook.Sheets || [];\n    check_wb_names(wb.SheetNames, Sheets, !!wb.vbaraw);\n    for (var i = 0; i < wb.SheetNames.length; ++i) check_ws(wb.Sheets[wb.SheetNames[i]], wb.SheetNames[i], i);\n    /* TODO: validate workbook */\n  }\n  /* 18.2 Workbook */\n  var wbnsregex = /<\\w+:workbook/;\n  function parse_wb_xml(data, opts) {\n    if (!data) throw new Error(\"Could not find file\");\n    var wb = {\n      AppVersion: {},\n      WBProps: {},\n      WBView: [],\n      Sheets: [],\n      CalcPr: {},\n      Names: [],\n      xmlns: \"\"\n    };\n    var pass = false,\n      xmlns = \"xmlns\";\n    var dname = {},\n      dnstart = 0;\n    data.replace(tagregex, function xml_wb(x, idx) {\n      var y = parsexmltag(x);\n      switch (strip_ns(y[0])) {\n        case '<?xml':\n          break;\n\n        /* 18.2.27 workbook CT_Workbook 1 */\n        case '<workbook':\n          if (x.match(wbnsregex)) xmlns = \"xmlns\" + x.match(/<(\\w+):/)[1];\n          wb.xmlns = y[xmlns];\n          break;\n        case '</workbook>':\n          break;\n\n        /* 18.2.13 fileVersion CT_FileVersion ? */\n        case '<fileVersion':\n          delete y[0];\n          wb.AppVersion = y;\n          break;\n        case '<fileVersion/>':\n        case '</fileVersion>':\n          break;\n\n        /* 18.2.12 fileSharing CT_FileSharing ? */\n        case '<fileSharing':\n          break;\n        case '<fileSharing/>':\n          break;\n\n        /* 18.2.28 workbookPr CT_WorkbookPr ? */\n        case '<workbookPr':\n        case '<workbookPr/>':\n          WBPropsDef.forEach(function (w) {\n            if (y[w[0]] == null) return;\n            switch (w[2]) {\n              case \"bool\":\n                wb.WBProps[w[0]] = parsexmlbool(y[w[0]]);\n                break;\n              case \"int\":\n                wb.WBProps[w[0]] = parseInt(y[w[0]], 10);\n                break;\n              default:\n                wb.WBProps[w[0]] = y[w[0]];\n            }\n          });\n          if (y.codeName) wb.WBProps.CodeName = utf8read(y.codeName);\n          break;\n        case '</workbookPr>':\n          break;\n\n        /* 18.2.29 workbookProtection CT_WorkbookProtection ? */\n        case '<workbookProtection':\n          break;\n        case '<workbookProtection/>':\n          break;\n\n        /* 18.2.1  bookViews CT_BookViews ? */\n        case '<bookViews':\n        case '<bookViews>':\n        case '</bookViews>':\n          break;\n        /* 18.2.30   workbookView CT_BookView + */\n        case '<workbookView':\n        case '<workbookView/>':\n          delete y[0];\n          wb.WBView.push(y);\n          break;\n        case '</workbookView>':\n          break;\n\n        /* 18.2.20 sheets CT_Sheets 1 */\n        case '<sheets':\n        case '<sheets>':\n        case '</sheets>':\n          break;\n        // aggregate sheet\n        /* 18.2.19   sheet CT_Sheet + */\n        case '<sheet':\n          switch (y.state) {\n            case \"hidden\":\n              y.Hidden = 1;\n              break;\n            case \"veryHidden\":\n              y.Hidden = 2;\n              break;\n            default:\n              y.Hidden = 0;\n          }\n          delete y.state;\n          y.name = unescapexml(utf8read(y.name));\n          delete y[0];\n          wb.Sheets.push(y);\n          break;\n        case '</sheet>':\n          break;\n\n        /* 18.2.15 functionGroups CT_FunctionGroups ? */\n        case '<functionGroups':\n        case '<functionGroups/>':\n          break;\n        /* 18.2.14   functionGroup CT_FunctionGroup + */\n        case '<functionGroup':\n          break;\n\n        /* 18.2.9  externalReferences CT_ExternalReferences ? */\n        case '<externalReferences':\n        case '</externalReferences>':\n        case '<externalReferences>':\n          break;\n        /* 18.2.8    externalReference CT_ExternalReference + */\n        case '<externalReference':\n          break;\n\n        /* 18.2.6  definedNames CT_DefinedNames ? */\n        case '<definedNames/>':\n          break;\n        case '<definedNames>':\n        case '<definedNames':\n          pass = true;\n          break;\n        case '</definedNames>':\n          pass = false;\n          break;\n        /* 18.2.5    definedName CT_DefinedName + */\n        case '<definedName':\n          {\n            dname = {};\n            dname.Name = utf8read(y.name);\n            if (y.comment) dname.Comment = y.comment;\n            if (y.localSheetId) dname.Sheet = +y.localSheetId;\n            if (parsexmlbool(y.hidden || \"0\")) dname.Hidden = true;\n            dnstart = idx + x.length;\n          }\n          break;\n        case '</definedName>':\n          {\n            dname.Ref = unescapexml(utf8read(data.slice(dnstart, idx)));\n            wb.Names.push(dname);\n          }\n          break;\n        case '<definedName/>':\n          break;\n\n        /* 18.2.2  calcPr CT_CalcPr ? */\n        case '<calcPr':\n          delete y[0];\n          wb.CalcPr = y;\n          break;\n        case '<calcPr/>':\n          delete y[0];\n          wb.CalcPr = y;\n          break;\n        case '</calcPr>':\n          break;\n\n        /* 18.2.16 oleSize CT_OleSize ? (ref required) */\n        case '<oleSize':\n          break;\n\n        /* 18.2.4  customWorkbookViews CT_CustomWorkbookViews ? */\n        case '<customWorkbookViews>':\n        case '</customWorkbookViews>':\n        case '<customWorkbookViews':\n          break;\n        /* 18.2.3  customWorkbookView CT_CustomWorkbookView + */\n        case '<customWorkbookView':\n        case '</customWorkbookView>':\n          break;\n\n        /* 18.2.18 pivotCaches CT_PivotCaches ? */\n        case '<pivotCaches>':\n        case '</pivotCaches>':\n        case '<pivotCaches':\n          break;\n        /* 18.2.17 pivotCache CT_PivotCache ? */\n        case '<pivotCache':\n          break;\n\n        /* 18.2.21 smartTagPr CT_SmartTagPr ? */\n        case '<smartTagPr':\n        case '<smartTagPr/>':\n          break;\n\n        /* 18.2.23 smartTagTypes CT_SmartTagTypes ? */\n        case '<smartTagTypes':\n        case '<smartTagTypes>':\n        case '</smartTagTypes>':\n          break;\n        /* 18.2.22 smartTagType CT_SmartTagType ? */\n        case '<smartTagType':\n          break;\n\n        /* 18.2.24 webPublishing CT_WebPublishing ? */\n        case '<webPublishing':\n        case '<webPublishing/>':\n          break;\n\n        /* 18.2.11 fileRecoveryPr CT_FileRecoveryPr ? */\n        case '<fileRecoveryPr':\n        case '<fileRecoveryPr/>':\n          break;\n\n        /* 18.2.26 webPublishObjects CT_WebPublishObjects ? */\n        case '<webPublishObjects>':\n        case '<webPublishObjects':\n        case '</webPublishObjects>':\n          break;\n        /* 18.2.25 webPublishObject CT_WebPublishObject ? */\n        case '<webPublishObject':\n          break;\n\n        /* 18.2.10 extLst CT_ExtensionList ? */\n        case '<extLst':\n        case '<extLst>':\n        case '</extLst>':\n        case '<extLst/>':\n          break;\n        /* 18.2.7  ext CT_Extension + */\n        case '<ext':\n          pass = true;\n          break;\n        //TODO: check with versions of excel\n        case '</ext>':\n          pass = false;\n          break;\n\n        /* Others */\n        case '<ArchID':\n          break;\n        case '<AlternateContent':\n        case '<AlternateContent>':\n          pass = true;\n          break;\n        case '</AlternateContent>':\n          pass = false;\n          break;\n\n        /* TODO */\n        case '<revisionPtr':\n          break;\n        default:\n          if (!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in workbook');\n      }\n      return x;\n    });\n    if (XMLNS_main.indexOf(wb.xmlns) === -1) throw new Error(\"Unknown Namespace: \" + wb.xmlns);\n    parse_wb_defaults(wb);\n    return wb;\n  }\n  function write_wb_xml(wb) {\n    var o = [XML_HEADER];\n    o[o.length] = writextag('workbook', null, {\n      'xmlns': XMLNS_main[0],\n      //'xmlns:mx': XMLNS.mx,\n      //'xmlns:s': XMLNS_main[0],\n      'xmlns:r': XMLNS.r\n    });\n    var write_names = wb.Workbook && (wb.Workbook.Names || []).length > 0;\n\n    /* fileVersion */\n    /* fileSharing */\n\n    var workbookPr = {\n      codeName: \"ThisWorkbook\"\n    };\n    if (wb.Workbook && wb.Workbook.WBProps) {\n      WBPropsDef.forEach(function (x) {\n        if (wb.Workbook.WBProps[x[0]] == null) return;\n        if (wb.Workbook.WBProps[x[0]] == x[1]) return;\n        workbookPr[x[0]] = wb.Workbook.WBProps[x[0]];\n      });\n      if (wb.Workbook.WBProps.CodeName) {\n        workbookPr.codeName = wb.Workbook.WBProps.CodeName;\n        delete workbookPr.CodeName;\n      }\n    }\n    o[o.length] = writextag('workbookPr', null, workbookPr);\n\n    /* workbookProtection */\n\n    var sheets = wb.Workbook && wb.Workbook.Sheets || [];\n    var i = 0;\n\n    /* bookViews only written if first worksheet is hidden */\n    if (sheets && sheets[0] && !!sheets[0].Hidden) {\n      o[o.length] = \"<bookViews>\";\n      for (i = 0; i != wb.SheetNames.length; ++i) {\n        if (!sheets[i]) break;\n        if (!sheets[i].Hidden) break;\n      }\n      if (i == wb.SheetNames.length) i = 0;\n      o[o.length] = '<workbookView firstSheet=\"' + i + '\" activeTab=\"' + i + '\"/>';\n      o[o.length] = \"</bookViews>\";\n    }\n    o[o.length] = \"<sheets>\";\n    for (i = 0; i != wb.SheetNames.length; ++i) {\n      var sht = {\n        name: escapexml(wb.SheetNames[i].slice(0, 31))\n      };\n      sht.sheetId = \"\" + (i + 1);\n      sht[\"r:id\"] = \"rId\" + (i + 1);\n      if (sheets[i]) switch (sheets[i].Hidden) {\n        case 1:\n          sht.state = \"hidden\";\n          break;\n        case 2:\n          sht.state = \"veryHidden\";\n          break;\n      }\n      o[o.length] = writextag('sheet', null, sht);\n    }\n    o[o.length] = \"</sheets>\";\n\n    /* functionGroups */\n    /* externalReferences */\n\n    if (write_names) {\n      o[o.length] = \"<definedNames>\";\n      if (wb.Workbook && wb.Workbook.Names) wb.Workbook.Names.forEach(function (n) {\n        var d = {\n          name: n.Name\n        };\n        if (n.Comment) d.comment = n.Comment;\n        if (n.Sheet != null) d.localSheetId = \"\" + n.Sheet;\n        if (n.Hidden) d.hidden = \"1\";\n        if (!n.Ref) return;\n        o[o.length] = writextag('definedName', escapexml(n.Ref), d);\n      });\n      o[o.length] = \"</definedNames>\";\n    }\n\n    /* calcPr */\n    /* oleSize */\n    /* customWorkbookViews */\n    /* pivotCaches */\n    /* smartTagPr */\n    /* smartTagTypes */\n    /* webPublishing */\n    /* fileRecoveryPr */\n    /* webPublishObjects */\n    /* extLst */\n\n    if (o.length > 2) {\n      o[o.length] = '</workbook>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n    return o.join(\"\");\n  }\n  /* [MS-XLSB] 2.4.304 BrtBundleSh */\n  function parse_BrtBundleSh(data, length) {\n    var z = {};\n    z.Hidden = data.read_shift(4); //hsState ST_SheetState\n    z.iTabID = data.read_shift(4);\n    z.strRelID = parse_RelID(data, length - 8);\n    z.name = parse_XLWideString(data);\n    return z;\n  }\n  function write_BrtBundleSh(data, o) {\n    if (!o) o = new_buf(127);\n    o.write_shift(4, data.Hidden);\n    o.write_shift(4, data.iTabID);\n    write_RelID(data.strRelID, o);\n    write_XLWideString(data.name.slice(0, 31), o);\n    return o.length > o.l ? o.slice(0, o.l) : o;\n  }\n\n  /* [MS-XLSB] 2.4.815 BrtWbProp */\n  function parse_BrtWbProp(data, length) {\n    var o = {};\n    var flags = data.read_shift(4);\n    o.defaultThemeVersion = data.read_shift(4);\n    var strName = length > 8 ? parse_XLWideString(data) : \"\";\n    if (strName.length > 0) o.CodeName = strName;\n    o.autoCompressPictures = !!(flags & 0x10000);\n    o.backupFile = !!(flags & 0x40);\n    o.checkCompatibility = !!(flags & 0x1000);\n    o.date1904 = !!(flags & 0x01);\n    o.filterPrivacy = !!(flags & 0x08);\n    o.hidePivotFieldList = !!(flags & 0x400);\n    o.promptedSolutions = !!(flags & 0x10);\n    o.publishItems = !!(flags & 0x800);\n    o.refreshAllConnections = !!(flags & 0x40000);\n    o.saveExternalLinkValues = !!(flags & 0x80);\n    o.showBorderUnselectedTables = !!(flags & 0x04);\n    o.showInkAnnotation = !!(flags & 0x20);\n    o.showObjects = [\"all\", \"placeholders\", \"none\"][flags >> 13 & 0x03];\n    o.showPivotChartFilter = !!(flags & 0x8000);\n    o.updateLinks = [\"userSet\", \"never\", \"always\"][flags >> 8 & 0x03];\n    return o;\n  }\n  function write_BrtWbProp(data, o) {\n    if (!o) o = new_buf(72);\n    var flags = 0;\n    if (data) {\n      /* TODO: mirror parse_BrtWbProp fields */\n      if (data.filterPrivacy) flags |= 0x08;\n    }\n    o.write_shift(4, flags);\n    o.write_shift(4, 0);\n    write_XLSBCodeName(data && data.CodeName || \"ThisWorkbook\", o);\n    return o.slice(0, o.l);\n  }\n  function parse_BrtFRTArchID$(data, length) {\n    var o = {};\n    data.read_shift(4);\n    o.ArchID = data.read_shift(4);\n    data.l += length - 8;\n    return o;\n  }\n\n  /* [MS-XLSB] 2.4.687 BrtName */\n  function parse_BrtName(data, length, opts) {\n    var end = data.l + length;\n    data.l += 4; //var flags = data.read_shift(4);\n    data.l += 1; //var chKey = data.read_shift(1);\n    var itab = data.read_shift(4);\n    var name = parse_XLNameWideString(data);\n    var formula = parse_XLSBNameParsedFormula(data, 0, opts);\n    var comment = parse_XLNullableWideString(data);\n    //if(0 /* fProc */) {\n    // unusedstring1: XLNullableWideString\n    // description: XLNullableWideString\n    // helpTopic: XLNullableWideString\n    // unusedstring2: XLNullableWideString\n    //}\n    data.l = end;\n    var out = {\n      Name: name,\n      Ptg: formula\n    };\n    if (itab < 0xFFFFFFF) out.Sheet = itab;\n    if (comment) out.Comment = comment;\n    return out;\n  }\n\n  /* [MS-XLSB] 2.1.7.61 Workbook */\n  function parse_wb_bin(data, opts) {\n    var wb = {\n      AppVersion: {},\n      WBProps: {},\n      WBView: [],\n      Sheets: [],\n      CalcPr: {},\n      xmlns: \"\"\n    };\n    var state = [];\n    var pass = false;\n    if (!opts) opts = {};\n    opts.biff = 12;\n    var Names = [];\n    var supbooks = [[]];\n    supbooks.SheetNames = [];\n    supbooks.XTI = [];\n    XLSBRecordEnum[0x0010] = {\n      n: \"BrtFRTArchID$\",\n      f: parse_BrtFRTArchID$\n    };\n    recordhopper(data, function hopper_wb(val, R, RT) {\n      switch (RT) {\n        case 0x009C:\n          /* 'BrtBundleSh' */\n          supbooks.SheetNames.push(val.name);\n          wb.Sheets.push(val);\n          break;\n        case 0x0099:\n          /* 'BrtWbProp' */\n          wb.WBProps = val;\n          break;\n        case 0x0027:\n          /* 'BrtName' */\n          if (val.Sheet != null) opts.SID = val.Sheet;\n          val.Ref = stringify_formula(val.Ptg, null, null, supbooks, opts);\n          delete opts.SID;\n          delete val.Ptg;\n          Names.push(val);\n          break;\n        case 0x040C:\n          /* 'BrtNameExt' */break;\n        case 0x0165: /* 'BrtSupSelf' */\n        case 0x0166: /* 'BrtSupSame' */\n        case 0x0163: /* 'BrtSupBookSrc' */\n        case 0x029B:\n          /* 'BrtSupAddin' */\n          if (!supbooks[0].length) supbooks[0] = [RT, val];else supbooks.push([RT, val]);\n          supbooks[supbooks.length - 1].XTI = [];\n          break;\n        case 0x016A:\n          /* 'BrtExternSheet' */\n          if (supbooks.length === 0) {\n            supbooks[0] = [];\n            supbooks[0].XTI = [];\n          }\n          supbooks[supbooks.length - 1].XTI = supbooks[supbooks.length - 1].XTI.concat(val);\n          supbooks.XTI = supbooks.XTI.concat(val);\n          break;\n        case 0x0169:\n          /* 'BrtPlaceholderName' */\n          break;\n        case 0x0817: /* 'BrtAbsPath15' */\n        case 0x009E: /* 'BrtBookView' */\n        case 0x008F: /* 'BrtBeginBundleShs' */\n        case 0x0298: /* 'BrtBeginFnGroup' */\n        case 0x0161:\n          /* 'BrtBeginExternals' */\n          break;\n\n        /* case 'BrtModelTimeGroupingCalcCol' */\n        case 0x0C00: /* 'BrtUid' */\n        case 0x0C01: /* 'BrtRevisionPtr' */\n        case 0x0216: /* 'BrtBookProtection' */\n        case 0x02A5: /* 'BrtBookProtectionIso' */\n        case 0x009D: /* 'BrtCalcProp' */\n        case 0x0262: /* 'BrtCrashRecErr' */\n        case 0x0802: /* 'BrtDecoupledPivotCacheID' */\n        case 0x009B: /* 'BrtFileRecover' */\n        case 0x0224: /* 'BrtFileSharing' */\n        case 0x02A4: /* 'BrtFileSharingIso' */\n        case 0x0080: /* 'BrtFileVersion' */\n        case 0x0299: /* 'BrtFnGroup' */\n        case 0x0850: /* 'BrtModelRelationship' */\n        case 0x084D: /* 'BrtModelTable' */\n        case 0x0225: /* 'BrtOleSize' */\n        case 0x0805: /* 'BrtPivotTableRef' */\n        case 0x0254: /* 'BrtSmartTagType' */\n        case 0x081C: /* 'BrtTableSlicerCacheID' */\n        case 0x081B: /* 'BrtTableSlicerCacheIDs' */\n        case 0x0822: /* 'BrtTimelineCachePivotCacheID' */\n        case 0x018D: /* 'BrtUserBookView' */\n        case 0x009A: /* 'BrtWbFactoid' */\n        case 0x045D: /* 'BrtWbProp14' */\n        case 0x0229: /* 'BrtWebOpt' */\n        case 0x082B:\n          /* 'BrtWorkBookPr15' */\n          break;\n        case 0x0023:\n          /* 'BrtFRTBegin' */\n          state.push(RT);\n          pass = true;\n          break;\n        case 0x0024:\n          /* 'BrtFRTEnd' */\n          state.pop();\n          pass = false;\n          break;\n        case 0x0025:\n          /* 'BrtACBegin' */\n          state.push(RT);\n          pass = true;\n          break;\n        case 0x0026:\n          /* 'BrtACEnd' */\n          state.pop();\n          pass = false;\n          break;\n        case 0x0010:\n          /* 'BrtFRTArchID$' */break;\n        default:\n          if (R.T) {/* empty */} else if (!pass || opts.WTF && state[state.length - 1] != 0x0025 /* BrtACBegin */ && state[state.length - 1] != 0x0023 /* BrtFRTBegin */) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n      }\n    }, opts);\n    parse_wb_defaults(wb);\n\n    // $FlowIgnore\n    wb.Names = Names;\n    wb.supbooks = supbooks;\n    return wb;\n  }\n  function write_BUNDLESHS(ba, wb) {\n    write_record(ba, 0x008F /* BrtBeginBundleShs */);\n    for (var idx = 0; idx != wb.SheetNames.length; ++idx) {\n      var viz = wb.Workbook && wb.Workbook.Sheets && wb.Workbook.Sheets[idx] && wb.Workbook.Sheets[idx].Hidden || 0;\n      var d = {\n        Hidden: viz,\n        iTabID: idx + 1,\n        strRelID: 'rId' + (idx + 1),\n        name: wb.SheetNames[idx]\n      };\n      write_record(ba, 0x009C /* BrtBundleSh */, write_BrtBundleSh(d));\n    }\n    write_record(ba, 0x0090 /* BrtEndBundleShs */);\n  }\n\n  /* [MS-XLSB] 2.4.649 BrtFileVersion */\n  function write_BrtFileVersion(data, o) {\n    if (!o) o = new_buf(127);\n    for (var i = 0; i != 4; ++i) o.write_shift(4, 0);\n    write_XLWideString(\"SheetJS\", o);\n    write_XLWideString(XLSX.version, o);\n    write_XLWideString(XLSX.version, o);\n    write_XLWideString(\"7262\", o);\n    return o.length > o.l ? o.slice(0, o.l) : o;\n  }\n\n  /* [MS-XLSB] 2.4.301 BrtBookView */\n  function write_BrtBookView(idx, o) {\n    if (!o) o = new_buf(29);\n    o.write_shift(-4, 0);\n    o.write_shift(-4, 460);\n    o.write_shift(4, 28800);\n    o.write_shift(4, 17600);\n    o.write_shift(4, 500);\n    o.write_shift(4, idx);\n    o.write_shift(4, idx);\n    var flags = 0x78;\n    o.write_shift(1, flags);\n    return o.length > o.l ? o.slice(0, o.l) : o;\n  }\n  function write_BOOKVIEWS(ba, wb) {\n    /* required if hidden tab appears before visible tab */\n    if (!wb.Workbook || !wb.Workbook.Sheets) return;\n    var sheets = wb.Workbook.Sheets;\n    var i = 0,\n      vistab = -1,\n      hidden = -1;\n    for (; i < sheets.length; ++i) {\n      if (!sheets[i] || !sheets[i].Hidden && vistab == -1) vistab = i;else if (sheets[i].Hidden == 1 && hidden == -1) hidden = i;\n    }\n    if (hidden > vistab) return;\n    write_record(ba, 0x0087 /* BrtBeginBookViews */);\n    write_record(ba, 0x009E /* BrtBookView */, write_BrtBookView(vistab));\n    /* 1*(BrtBookView *FRT) */\n    write_record(ba, 0x0088 /* BrtEndBookViews */);\n  }\n\n  /* [MS-XLSB] 2.4.305 BrtCalcProp */\n  /*function write_BrtCalcProp(data, o) {\n  \tif(!o) o = new_buf(26);\n  \to.write_shift(4,0); // force recalc\n  \to.write_shift(4,1);\n  \to.write_shift(4,0);\n  \twrite_Xnum(0, o);\n  \to.write_shift(-4, 1023);\n  \to.write_shift(1, 0x33);\n  \to.write_shift(1, 0x00);\n  \treturn o;\n  }*/\n\n  /* [MS-XLSB] 2.4.646 BrtFileRecover */\n  /*function write_BrtFileRecover(data, o) {\n  \tif(!o) o = new_buf(1);\n  \to.write_shift(1,0);\n  \treturn o;\n  }*/\n\n  /* [MS-XLSB] 2.1.7.61 Workbook */\n  function write_wb_bin(wb, opts) {\n    var ba = buf_array();\n    write_record(ba, 0x0083 /* BrtBeginBook */);\n    write_record(ba, 0x0080 /* BrtFileVersion */, write_BrtFileVersion());\n    /* [[BrtFileSharingIso] BrtFileSharing] */\n    write_record(ba, 0x0099 /* BrtWbProp */, write_BrtWbProp(wb.Workbook && wb.Workbook.WBProps || null));\n    /* [ACABSPATH] */\n    /* [[BrtBookProtectionIso] BrtBookProtection] */\n    write_BOOKVIEWS(ba, wb, opts);\n    write_BUNDLESHS(ba, wb, opts);\n    /* [FNGROUP] */\n    /* [EXTERNALS] */\n    /* *BrtName */\n    /* write_record(ba, 0x009D BrtCalcProp, write_BrtCalcProp()); */\n    /* [BrtOleSize] */\n    /* *(BrtUserBookView *FRT) */\n    /* [PIVOTCACHEIDS] */\n    /* [BrtWbFactoid] */\n    /* [SMARTTAGTYPES] */\n    /* [BrtWebOpt] */\n    /* write_record(ba, 0x009B BrtFileRecover, write_BrtFileRecover()); */\n    /* [WEBPUBITEMS] */\n    /* [CRERRS] */\n    /* FRTWORKBOOK */\n    write_record(ba, 0x0084 /* BrtEndBook */);\n\n    return ba.end();\n  }\n  function parse_wb(data, name, opts) {\n    if (name.slice(-4) === \".bin\") return parse_wb_bin(data, opts);\n    return parse_wb_xml(data, opts);\n  }\n  function parse_ws(data, name, idx, opts, rels, wb, themes, styles) {\n    if (name.slice(-4) === \".bin\") return parse_ws_bin(data, opts, idx, rels, wb, themes, styles);\n    return parse_ws_xml(data, opts, idx, rels, wb, themes, styles);\n  }\n  function parse_cs(data, name, idx, opts, rels, wb, themes, styles) {\n    if (name.slice(-4) === \".bin\") return parse_cs_bin(data, opts, idx, rels, wb, themes, styles);\n    return parse_cs_xml(data, opts, idx, rels, wb, themes, styles);\n  }\n  function parse_ms(data, name, idx, opts, rels, wb, themes, styles) {\n    if (name.slice(-4) === \".bin\") return parse_ms_bin(data, opts, idx, rels, wb, themes, styles);\n    return parse_ms_xml(data, opts, idx, rels, wb, themes, styles);\n  }\n  function parse_ds(data, name, idx, opts, rels, wb, themes, styles) {\n    if (name.slice(-4) === \".bin\") return parse_ds_bin(data, opts, idx, rels, wb, themes, styles);\n    return parse_ds_xml(data, opts, idx, rels, wb, themes, styles);\n  }\n  function parse_sty(data, name, themes, opts) {\n    if (name.slice(-4) === \".bin\") return parse_sty_bin(data, themes, opts);\n    return parse_sty_xml(data, themes, opts);\n  }\n  function parse_theme(data, name, opts) {\n    return parse_theme_xml(data, opts);\n  }\n  function parse_sst(data, name, opts) {\n    if (name.slice(-4) === \".bin\") return parse_sst_bin(data, opts);\n    return parse_sst_xml(data, opts);\n  }\n  function parse_cmnt(data, name, opts) {\n    if (name.slice(-4) === \".bin\") return parse_comments_bin(data, opts);\n    return parse_comments_xml(data, opts);\n  }\n  function parse_cc(data, name, opts) {\n    if (name.slice(-4) === \".bin\") return parse_cc_bin(data, name, opts);\n    return parse_cc_xml(data, name, opts);\n  }\n  function parse_xlink(data, rel, name, opts) {\n    if (name.slice(-4) === \".bin\") return parse_xlink_bin(data, rel, name, opts);\n    return parse_xlink_xml(data, rel, name, opts);\n  }\n  function parse_xlmeta(data, name, opts) {\n    if (name.slice(-4) === \".bin\") return parse_xlmeta_bin(data, name, opts);\n    return parse_xlmeta_xml(data, name, opts);\n  }\n  function write_wb(wb, name, opts) {\n    return (name.slice(-4) === \".bin\" ? write_wb_bin : write_wb_xml)(wb, opts);\n  }\n  function write_ws(data, name, opts, wb, rels) {\n    return (name.slice(-4) === \".bin\" ? write_ws_bin : write_ws_xml)(data, opts, wb, rels);\n  }\n\n  // eslint-disable-next-line no-unused-vars\n  function write_cs(data, name, opts, wb, rels) {\n    return (name.slice(-4) === \".bin\" ? write_cs_bin : write_cs_xml)(data, opts, wb, rels);\n  }\n  function write_sty(data, name, opts) {\n    return (name.slice(-4) === \".bin\" ? write_sty_bin : write_sty_xml)(data, opts);\n  }\n  function write_sst(data, name, opts) {\n    return (name.slice(-4) === \".bin\" ? write_sst_bin : write_sst_xml)(data, opts);\n  }\n  function write_cmnt(data, name, opts) {\n    return (name.slice(-4) === \".bin\" ? write_comments_bin : write_comments_xml)(data, opts);\n  }\n  /*\n  function write_cc(data, name:string, opts) {\n  \treturn (name.slice(-4)===\".bin\" ? write_cc_bin : write_cc_xml)(data, opts);\n  }\n  */\n\n  function write_xlmeta(name) {\n    return (name.slice(-4) === \".bin\" ? write_xlmeta_bin : write_xlmeta_xml)();\n  }\n  var attregexg2 = /([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\n  var attregex2 = /([\\w:]+)=((?:\")(?:[^\"]*)(?:\")|(?:')(?:[^']*)(?:'))/;\n  function xlml_parsexmltag(tag, skip_root) {\n    var words = tag.split(/\\s+/);\n    var z = [];\n    if (!skip_root) z[0] = words[0];\n    if (words.length === 1) return z;\n    var m = tag.match(attregexg2),\n      y,\n      j,\n      w,\n      i;\n    if (m) for (i = 0; i != m.length; ++i) {\n      y = m[i].match(attregex2);\n      if ((j = y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].slice(1, y[2].length - 1);else {\n        if (y[1].slice(0, 6) === \"xmlns:\") w = \"xmlns\" + y[1].slice(6);else w = y[1].slice(j + 1);\n        z[w] = y[2].slice(1, y[2].length - 1);\n      }\n    }\n    return z;\n  }\n  function xlml_parsexmltagobj(tag) {\n    var words = tag.split(/\\s+/);\n    var z = {};\n    if (words.length === 1) return z;\n    var m = tag.match(attregexg2),\n      y,\n      j,\n      w,\n      i;\n    if (m) for (i = 0; i != m.length; ++i) {\n      y = m[i].match(attregex2);\n      if ((j = y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].slice(1, y[2].length - 1);else {\n        if (y[1].slice(0, 6) === \"xmlns:\") w = \"xmlns\" + y[1].slice(6);else w = y[1].slice(j + 1);\n        z[w] = y[2].slice(1, y[2].length - 1);\n      }\n    }\n    return z;\n  }\n\n  // ----\n\n  /* map from xlml named formats to SSF TODO: localize */\n  var XLMLFormatMap;\n  function xlml_format(format, value) {\n    var fmt = XLMLFormatMap[format] || unescapexml(format);\n    if (fmt === \"General\") return SSF_general(value);\n    return SSF_format(fmt, value);\n  }\n  function xlml_set_custprop(Custprops, key, cp, val) {\n    var oval = val;\n    switch ((cp[0].match(/dt:dt=\"([\\w.]+)\"/) || [\"\", \"\"])[1]) {\n      case \"boolean\":\n        oval = parsexmlbool(val);\n        break;\n      case \"i2\":\n      case \"int\":\n        oval = parseInt(val, 10);\n        break;\n      case \"r4\":\n      case \"float\":\n        oval = parseFloat(val);\n        break;\n      case \"date\":\n      case \"dateTime.tz\":\n        oval = parseDate(val);\n        break;\n      case \"i8\":\n      case \"string\":\n      case \"fixed\":\n      case \"uuid\":\n      case \"bin.base64\":\n        break;\n      default:\n        throw new Error(\"bad custprop:\" + cp[0]);\n    }\n    Custprops[unescapexml(key)] = oval;\n  }\n  function safe_format_xlml(cell, nf, o) {\n    if (cell.t === 'z') return;\n    if (!o || o.cellText !== false) try {\n      if (cell.t === 'e') {\n        cell.w = cell.w || BErr[cell.v];\n      } else if (nf === \"General\") {\n        if (cell.t === 'n') {\n          if ((cell.v | 0) === cell.v) cell.w = cell.v.toString(10);else cell.w = SSF_general_num(cell.v);\n        } else cell.w = SSF_general(cell.v);\n      } else cell.w = xlml_format(nf || \"General\", cell.v);\n    } catch (e) {\n      if (o.WTF) throw e;\n    }\n    try {\n      var z = XLMLFormatMap[nf] || nf || \"General\";\n      if (o.cellNF) cell.z = z;\n      if (o.cellDates && cell.t == 'n' && fmt_is_date(z)) {\n        var _d = SSF_parse_date_code(cell.v);\n        if (_d) {\n          cell.t = 'd';\n          cell.v = new Date(_d.y, _d.m - 1, _d.d, _d.H, _d.M, _d.S, _d.u);\n        }\n      }\n    } catch (e) {\n      if (o.WTF) throw e;\n    }\n  }\n  function process_style_xlml(styles, stag, opts) {\n    if (opts.cellStyles) {\n      if (stag.Interior) {\n        var I = stag.Interior;\n        if (I.Pattern) I.patternType = XLMLPatternTypeMap[I.Pattern] || I.Pattern;\n      }\n    }\n    styles[stag.ID] = stag;\n  }\n\n  /* TODO: there must exist some form of OSP-blessed spec */\n  function parse_xlml_data(xml, ss, data, cell, base, styles, csty, row, arrayf, o) {\n    var nf = \"General\",\n      sid = cell.StyleID,\n      S = {};\n    o = o || {};\n    var interiors = [];\n    var i = 0;\n    if (sid === undefined && row) sid = row.StyleID;\n    if (sid === undefined && csty) sid = csty.StyleID;\n    while (styles[sid] !== undefined) {\n      if (styles[sid].nf) nf = styles[sid].nf;\n      if (styles[sid].Interior) interiors.push(styles[sid].Interior);\n      if (!styles[sid].Parent) break;\n      sid = styles[sid].Parent;\n    }\n    switch (data.Type) {\n      case 'Boolean':\n        cell.t = 'b';\n        cell.v = parsexmlbool(xml);\n        break;\n      case 'String':\n        cell.t = 's';\n        cell.r = xlml_fixstr(unescapexml(xml));\n        cell.v = xml.indexOf(\"<\") > -1 ? unescapexml(ss || xml).replace(/<.*?>/g, \"\") : cell.r; // todo: BR etc\n        break;\n      case 'DateTime':\n        if (xml.slice(-1) != \"Z\") xml += \"Z\";\n        cell.v = (parseDate(xml) - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n        if (cell.v !== cell.v) cell.v = unescapexml(xml);else if (cell.v < 60) cell.v = cell.v - 1;\n        if (!nf || nf == \"General\") nf = \"yyyy-mm-dd\";\n      /* falls through */\n      case 'Number':\n        if (cell.v === undefined) cell.v = +xml;\n        if (!cell.t) cell.t = 'n';\n        break;\n      case 'Error':\n        cell.t = 'e';\n        cell.v = RBErr[xml];\n        if (o.cellText !== false) cell.w = xml;\n        break;\n      default:\n        if (xml == \"\" && ss == \"\") {\n          cell.t = 'z';\n        } else {\n          cell.t = 's';\n          cell.v = xlml_fixstr(ss || xml);\n        }\n        break;\n    }\n    safe_format_xlml(cell, nf, o);\n    if (o.cellFormula !== false) {\n      if (cell.Formula) {\n        var fstr = unescapexml(cell.Formula);\n        /* strictly speaking, the leading = is required but some writers omit */\n        if (fstr.charCodeAt(0) == 61 /* = */) fstr = fstr.slice(1);\n        cell.f = rc_to_a1(fstr, base);\n        delete cell.Formula;\n        if (cell.ArrayRange == \"RC\") cell.F = rc_to_a1(\"RC:RC\", base);else if (cell.ArrayRange) {\n          cell.F = rc_to_a1(cell.ArrayRange, base);\n          arrayf.push([safe_decode_range(cell.F), cell.F]);\n        }\n      } else {\n        for (i = 0; i < arrayf.length; ++i) if (base.r >= arrayf[i][0].s.r && base.r <= arrayf[i][0].e.r) if (base.c >= arrayf[i][0].s.c && base.c <= arrayf[i][0].e.c) cell.F = arrayf[i][1];\n      }\n    }\n    if (o.cellStyles) {\n      interiors.forEach(function (x) {\n        if (!S.patternType && x.patternType) S.patternType = x.patternType;\n      });\n      cell.s = S;\n    }\n    if (cell.StyleID !== undefined) cell.ixfe = cell.StyleID;\n  }\n  function xlml_clean_comment(comment) {\n    comment.t = comment.v || \"\";\n    comment.t = comment.t.replace(/\\r\\n/g, \"\\n\").replace(/\\r/g, \"\\n\");\n    comment.v = comment.w = comment.ixfe = undefined;\n  }\n\n  /* TODO: Everything */\n  function parse_xlml_xml(d, _opts) {\n    var opts = _opts || {};\n    make_ssf();\n    var str = debom(xlml_normalize(d));\n    if (opts.type == 'binary' || opts.type == 'array' || opts.type == 'base64') {\n      if (typeof $cptable !== 'undefined') str = $cptable.utils.decode(65001, char_codes(str));else str = utf8read(str);\n    }\n    var opening = str.slice(0, 1024).toLowerCase(),\n      ishtml = false;\n    opening = opening.replace(/\".*?\"/g, \"\");\n    if ((opening.indexOf(\">\") & 1023) > Math.min(opening.indexOf(\",\") & 1023, opening.indexOf(\";\") & 1023)) {\n      var _o = dup(opts);\n      _o.type = \"string\";\n      return PRN.to_workbook(str, _o);\n    }\n    if (opening.indexOf(\"<?xml\") == -1) [\"html\", \"table\", \"head\", \"meta\", \"script\", \"style\", \"div\"].forEach(function (tag) {\n      if (opening.indexOf(\"<\" + tag) >= 0) ishtml = true;\n    });\n    if (ishtml) return html_to_workbook(str, opts);\n    XLMLFormatMap = {\n      \"General Number\": \"General\",\n      \"General Date\": table_fmt[22],\n      \"Long Date\": \"dddd, mmmm dd, yyyy\",\n      \"Medium Date\": table_fmt[15],\n      \"Short Date\": table_fmt[14],\n      \"Long Time\": table_fmt[19],\n      \"Medium Time\": table_fmt[18],\n      \"Short Time\": table_fmt[20],\n      \"Currency\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n      \"Fixed\": table_fmt[2],\n      \"Standard\": table_fmt[4],\n      \"Percent\": table_fmt[10],\n      \"Scientific\": table_fmt[11],\n      \"Yes/No\": '\"Yes\";\"Yes\";\"No\";@',\n      \"True/False\": '\"True\";\"True\";\"False\";@',\n      \"On/Off\": '\"Yes\";\"Yes\";\"No\";@'\n    };\n    var Rn;\n    var state = [],\n      tmp;\n    if (DENSE != null && opts.dense == null) opts.dense = DENSE;\n    var sheets = {},\n      sheetnames = [],\n      cursheet = opts.dense ? [] : {},\n      sheetname = \"\";\n    var cell = {},\n      row = {}; // eslint-disable-line no-unused-vars\n    var dtag = xlml_parsexmltag('<Data ss:Type=\"String\">'),\n      didx = 0;\n    var c = 0,\n      r = 0;\n    var refguess = {\n      s: {\n        r: 2000000,\n        c: 2000000\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    var styles = {},\n      stag = {};\n    var ss = \"\",\n      fidx = 0;\n    var merges = [];\n    var Props = {},\n      Custprops = {},\n      pidx = 0,\n      cp = [];\n    var comments = [],\n      comment = {};\n    var cstys = [],\n      csty,\n      seencol = false;\n    var arrayf = [];\n    var rowinfo = [],\n      rowobj = {},\n      cc = 0,\n      rr = 0;\n    var Workbook = {\n        Sheets: [],\n        WBProps: {\n          date1904: false\n        }\n      },\n      wsprops = {};\n    xlmlregex.lastIndex = 0;\n    str = str.replace(/<!--([\\s\\S]*?)-->/mg, \"\");\n    var raw_Rn3 = \"\";\n    while (Rn = xlmlregex.exec(str)) switch (Rn[3] = (raw_Rn3 = Rn[3]).toLowerCase()) {\n      case 'data' /*case 'Data'*/:\n        if (raw_Rn3 == \"data\") {\n          if (Rn[1] === '/') {\n            if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n          } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], true]);\n          break;\n        }\n        if (state[state.length - 1][1]) break;\n        if (Rn[1] === '/') parse_xlml_data(str.slice(didx, Rn.index), ss, dtag, state[state.length - 1][0] == /*\"Comment\"*/\"comment\" ? comment : cell, {\n          c: c,\n          r: r\n        }, styles, cstys[c], row, arrayf, opts);else {\n          ss = \"\";\n          dtag = xlml_parsexmltag(Rn[0]);\n          didx = Rn.index + Rn[0].length;\n        }\n        break;\n      case 'cell' /*case 'Cell'*/:\n        if (Rn[1] === '/') {\n          if (comments.length > 0) cell.c = comments;\n          if ((!opts.sheetRows || opts.sheetRows > r) && cell.v !== undefined) {\n            if (opts.dense) {\n              if (!cursheet[r]) cursheet[r] = [];\n              cursheet[r][c] = cell;\n            } else cursheet[encode_col(c) + encode_row(r)] = cell;\n          }\n          if (cell.HRef) {\n            cell.l = {\n              Target: unescapexml(cell.HRef)\n            };\n            if (cell.HRefScreenTip) cell.l.Tooltip = cell.HRefScreenTip;\n            delete cell.HRef;\n            delete cell.HRefScreenTip;\n          }\n          if (cell.MergeAcross || cell.MergeDown) {\n            cc = c + (parseInt(cell.MergeAcross, 10) | 0);\n            rr = r + (parseInt(cell.MergeDown, 10) | 0);\n            merges.push({\n              s: {\n                c: c,\n                r: r\n              },\n              e: {\n                c: cc,\n                r: rr\n              }\n            });\n          }\n          if (!opts.sheetStubs) {\n            if (cell.MergeAcross) c = cc + 1;else ++c;\n          } else if (cell.MergeAcross || cell.MergeDown) {\n            for (var cma = c; cma <= cc; ++cma) {\n              for (var cmd = r; cmd <= rr; ++cmd) {\n                if (cma > c || cmd > r) {\n                  if (opts.dense) {\n                    if (!cursheet[cmd]) cursheet[cmd] = [];\n                    cursheet[cmd][cma] = {\n                      t: 'z'\n                    };\n                  } else cursheet[encode_col(cma) + encode_row(cmd)] = {\n                    t: 'z'\n                  };\n                }\n              }\n            }\n            c = cc + 1;\n          } else ++c;\n        } else {\n          cell = xlml_parsexmltagobj(Rn[0]);\n          if (cell.Index) c = +cell.Index - 1;\n          if (c < refguess.s.c) refguess.s.c = c;\n          if (c > refguess.e.c) refguess.e.c = c;\n          if (Rn[0].slice(-2) === \"/>\") ++c;\n          comments = [];\n        }\n        break;\n      case 'row' /*case 'Row'*/:\n        if (Rn[1] === '/' || Rn[0].slice(-2) === \"/>\") {\n          if (r < refguess.s.r) refguess.s.r = r;\n          if (r > refguess.e.r) refguess.e.r = r;\n          if (Rn[0].slice(-2) === \"/>\") {\n            row = xlml_parsexmltag(Rn[0]);\n            if (row.Index) r = +row.Index - 1;\n          }\n          c = 0;\n          ++r;\n        } else {\n          row = xlml_parsexmltag(Rn[0]);\n          if (row.Index) r = +row.Index - 1;\n          rowobj = {};\n          if (row.AutoFitHeight == \"0\" || row.Height) {\n            rowobj.hpx = parseInt(row.Height, 10);\n            rowobj.hpt = px2pt(rowobj.hpx);\n            rowinfo[r] = rowobj;\n          }\n          if (row.Hidden == \"1\") {\n            rowobj.hidden = true;\n            rowinfo[r] = rowobj;\n          }\n        }\n        break;\n      case 'worksheet' /*case 'Worksheet'*/:\n        /* TODO: read range from FullRows/FullColumns */\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n          sheetnames.push(sheetname);\n          if (refguess.s.r <= refguess.e.r && refguess.s.c <= refguess.e.c) {\n            cursheet[\"!ref\"] = encode_range(refguess);\n            if (opts.sheetRows && opts.sheetRows <= refguess.e.r) {\n              cursheet[\"!fullref\"] = cursheet[\"!ref\"];\n              refguess.e.r = opts.sheetRows - 1;\n              cursheet[\"!ref\"] = encode_range(refguess);\n            }\n          }\n          if (merges.length) cursheet[\"!merges\"] = merges;\n          if (cstys.length > 0) cursheet[\"!cols\"] = cstys;\n          if (rowinfo.length > 0) cursheet[\"!rows\"] = rowinfo;\n          sheets[sheetname] = cursheet;\n        } else {\n          refguess = {\n            s: {\n              r: 2000000,\n              c: 2000000\n            },\n            e: {\n              r: 0,\n              c: 0\n            }\n          };\n          r = c = 0;\n          state.push([Rn[3], false]);\n          tmp = xlml_parsexmltag(Rn[0]);\n          sheetname = unescapexml(tmp.Name);\n          cursheet = opts.dense ? [] : {};\n          merges = [];\n          arrayf = [];\n          rowinfo = [];\n          wsprops = {\n            name: sheetname,\n            Hidden: 0\n          };\n          Workbook.Sheets.push(wsprops);\n        }\n        break;\n      case 'table' /*case 'Table'*/:\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n        } else if (Rn[0].slice(-2) == \"/>\") break;else {\n          state.push([Rn[3], false]);\n          cstys = [];\n          seencol = false;\n        }\n        break;\n      case 'style' /*case 'Style'*/:\n        if (Rn[1] === '/') process_style_xlml(styles, stag, opts);else stag = xlml_parsexmltag(Rn[0]);\n        break;\n      case 'numberformat' /*case 'NumberFormat'*/:\n        stag.nf = unescapexml(xlml_parsexmltag(Rn[0]).Format || \"General\");\n        if (XLMLFormatMap[stag.nf]) stag.nf = XLMLFormatMap[stag.nf];\n        for (var ssfidx = 0; ssfidx != 0x188; ++ssfidx) if (table_fmt[ssfidx] == stag.nf) break;\n        if (ssfidx == 0x188) for (ssfidx = 0x39; ssfidx != 0x188; ++ssfidx) if (table_fmt[ssfidx] == null) {\n          SSF_load(stag.nf, ssfidx);\n          break;\n        }\n        break;\n      case 'column' /*case 'Column'*/:\n        if (state[state.length - 1][0] !== /*'Table'*/'table') break;\n        csty = xlml_parsexmltag(Rn[0]);\n        if (csty.Hidden) {\n          csty.hidden = true;\n          delete csty.Hidden;\n        }\n        if (csty.Width) csty.wpx = parseInt(csty.Width, 10);\n        if (!seencol && csty.wpx > 10) {\n          seencol = true;\n          MDW = DEF_MDW; //find_mdw_wpx(csty.wpx);\n          for (var _col = 0; _col < cstys.length; ++_col) if (cstys[_col]) process_col(cstys[_col]);\n        }\n        if (seencol) process_col(csty);\n        cstys[csty.Index - 1 || cstys.length] = csty;\n        for (var i = 0; i < +csty.Span; ++i) cstys[cstys.length] = dup(csty);\n        break;\n      case 'namedrange' /*case 'NamedRange'*/:\n        if (Rn[1] === '/') break;\n        if (!Workbook.Names) Workbook.Names = [];\n        var _NamedRange = parsexmltag(Rn[0]);\n        var _DefinedName = {\n          Name: _NamedRange.Name,\n          Ref: rc_to_a1(_NamedRange.RefersTo.slice(1), {\n            r: 0,\n            c: 0\n          })\n        };\n        if (Workbook.Sheets.length > 0) _DefinedName.Sheet = Workbook.Sheets.length - 1;\n        Workbook.Names.push(_DefinedName);\n        break;\n      case 'namedcell' /*case 'NamedCell'*/:\n        break;\n      case 'b' /*case 'B'*/:\n        break;\n      case 'i' /*case 'I'*/:\n        break;\n      case 'u' /*case 'U'*/:\n        break;\n      case 's' /*case 'S'*/:\n        break;\n      case 'em' /*case 'EM'*/:\n        break;\n      case 'h2' /*case 'H2'*/:\n        break;\n      case 'h3' /*case 'H3'*/:\n        break;\n      case 'sub' /*case 'Sub'*/:\n        break;\n      case 'sup' /*case 'Sup'*/:\n        break;\n      case 'span' /*case 'Span'*/:\n        break;\n      case 'alignment' /*case 'Alignment'*/:\n        break;\n      case 'borders' /*case 'Borders'*/:\n        break;\n      case 'border' /*case 'Border'*/:\n        break;\n      case 'font' /*case 'Font'*/:\n        if (Rn[0].slice(-2) === \"/>\") break;else if (Rn[1] === \"/\") ss += str.slice(fidx, Rn.index);else fidx = Rn.index + Rn[0].length;\n        break;\n      case 'interior' /*case 'Interior'*/:\n        if (!opts.cellStyles) break;\n        stag.Interior = xlml_parsexmltag(Rn[0]);\n        break;\n      case 'protection' /*case 'Protection'*/:\n        break;\n      case 'author' /*case 'Author'*/:\n      case 'title' /*case 'Title'*/:\n      case 'description' /*case 'Description'*/:\n      case 'created' /*case 'Created'*/:\n      case 'keywords' /*case 'Keywords'*/:\n      case 'subject' /*case 'Subject'*/:\n      case 'category' /*case 'Category'*/:\n      case 'company' /*case 'Company'*/:\n      case 'lastauthor' /*case 'LastAuthor'*/:\n      case 'lastsaved' /*case 'LastSaved'*/:\n      case 'lastprinted' /*case 'LastPrinted'*/:\n      case 'version' /*case 'Version'*/:\n      case 'revision' /*case 'Revision'*/:\n      case 'totaltime' /*case 'TotalTime'*/:\n      case 'hyperlinkbase' /*case 'HyperlinkBase'*/:\n      case 'manager' /*case 'Manager'*/:\n      case 'contentstatus' /*case 'ContentStatus'*/:\n      case 'identifier' /*case 'Identifier'*/:\n      case 'language' /*case 'Language'*/:\n      case 'appname' /*case 'AppName'*/:\n        if (Rn[0].slice(-2) === \"/>\") break;else if (Rn[1] === \"/\") xlml_set_prop(Props, raw_Rn3, str.slice(pidx, Rn.index));else pidx = Rn.index + Rn[0].length;\n        break;\n      case 'paragraphs' /*case 'Paragraphs'*/:\n        break;\n      case 'styles' /*case 'Styles'*/:\n      case 'workbook' /*case 'Workbook'*/:\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n        } else state.push([Rn[3], false]);\n        break;\n      case 'comment' /*case 'Comment'*/:\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n          xlml_clean_comment(comment);\n          comments.push(comment);\n        } else {\n          state.push([Rn[3], false]);\n          tmp = xlml_parsexmltag(Rn[0]);\n          comment = {\n            a: tmp.Author\n          };\n        }\n        break;\n      case 'autofilter' /*case 'AutoFilter'*/:\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n        } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') {\n          var AutoFilter = xlml_parsexmltag(Rn[0]);\n          cursheet['!autofilter'] = {\n            ref: rc_to_a1(AutoFilter.Range).replace(/\\$/g, \"\")\n          };\n          state.push([Rn[3], true]);\n        }\n        break;\n      case 'name' /*case 'Name'*/:\n        break;\n      case 'datavalidation' /*case 'DataValidation'*/:\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n        } else {\n          if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], true]);\n        }\n        break;\n      case 'pixelsperinch' /*case 'PixelsPerInch'*/:\n        break;\n      case 'componentoptions' /*case 'ComponentOptions'*/:\n      case 'documentproperties' /*case 'DocumentProperties'*/:\n      case 'customdocumentproperties' /*case 'CustomDocumentProperties'*/:\n      case 'officedocumentsettings' /*case 'OfficeDocumentSettings'*/:\n      case 'pivottable' /*case 'PivotTable'*/:\n      case 'pivotcache' /*case 'PivotCache'*/:\n      case 'names' /*case 'Names'*/:\n      case 'mapinfo' /*case 'MapInfo'*/:\n      case 'pagebreaks' /*case 'PageBreaks'*/:\n      case 'querytable' /*case 'QueryTable'*/:\n      case 'sorting' /*case 'Sorting'*/:\n      case 'schema' /*case 'Schema'*/: //case 'data' /*case 'data'*/:\n      case 'conditionalformatting' /*case 'ConditionalFormatting'*/:\n      case 'smarttagtype' /*case 'SmartTagType'*/:\n      case 'smarttags' /*case 'SmartTags'*/:\n      case 'excelworkbook' /*case 'ExcelWorkbook'*/:\n      case 'workbookoptions' /*case 'WorkbookOptions'*/:\n      case 'worksheetoptions' /*case 'WorksheetOptions'*/:\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n        } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], true]);\n        break;\n      case 'null' /*case 'Null'*/:\n        break;\n      default:\n        /* FODS file root is <office:document> */\n        if (state.length == 0 && Rn[3] == \"document\") return parse_fods(str, opts);\n        /* UOS file root is <uof:UOF> */\n        if (state.length == 0 && Rn[3] == \"uof\" /*\"UOF\"*/) return parse_fods(str, opts);\n        var seen = true;\n        switch (state[state.length - 1][0]) {\n          /* OfficeDocumentSettings */\n          case 'officedocumentsettings' /*case 'OfficeDocumentSettings'*/:\n            switch (Rn[3]) {\n              case 'allowpng' /*case 'AllowPNG'*/:\n                break;\n              case 'removepersonalinformation' /*case 'RemovePersonalInformation'*/:\n                break;\n              case 'downloadcomponents' /*case 'DownloadComponents'*/:\n                break;\n              case 'locationofcomponents' /*case 'LocationOfComponents'*/:\n                break;\n              case 'colors' /*case 'Colors'*/:\n                break;\n              case 'color' /*case 'Color'*/:\n                break;\n              case 'index' /*case 'Index'*/:\n                break;\n              case 'rgb' /*case 'RGB'*/:\n                break;\n              case 'targetscreensize' /*case 'TargetScreenSize'*/:\n                break;\n              case 'readonlyrecommended' /*case 'ReadOnlyRecommended'*/:\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* ComponentOptions */\n          case 'componentoptions' /*case 'ComponentOptions'*/:\n            switch (Rn[3]) {\n              case 'toolbar' /*case 'Toolbar'*/:\n                break;\n              case 'hideofficelogo' /*case 'HideOfficeLogo'*/:\n                break;\n              case 'spreadsheetautofit' /*case 'SpreadsheetAutoFit'*/:\n                break;\n              case 'label' /*case 'Label'*/:\n                break;\n              case 'caption' /*case 'Caption'*/:\n                break;\n              case 'maxheight' /*case 'MaxHeight'*/:\n                break;\n              case 'maxwidth' /*case 'MaxWidth'*/:\n                break;\n              case 'nextsheetnumber' /*case 'NextSheetNumber'*/:\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* ExcelWorkbook */\n          case 'excelworkbook' /*case 'ExcelWorkbook'*/:\n            switch (Rn[3]) {\n              case 'date1904' /*case 'Date1904'*/:\n                Workbook.WBProps.date1904 = true;\n                break;\n              case 'windowheight' /*case 'WindowHeight'*/:\n                break;\n              case 'windowwidth' /*case 'WindowWidth'*/:\n                break;\n              case 'windowtopx' /*case 'WindowTopX'*/:\n                break;\n              case 'windowtopy' /*case 'WindowTopY'*/:\n                break;\n              case 'tabratio' /*case 'TabRatio'*/:\n                break;\n              case 'protectstructure' /*case 'ProtectStructure'*/:\n                break;\n              case 'protectwindow' /*case 'ProtectWindow'*/:\n                break;\n              case 'protectwindows' /*case 'ProtectWindows'*/:\n                break;\n              case 'activesheet' /*case 'ActiveSheet'*/:\n                break;\n              case 'displayinknotes' /*case 'DisplayInkNotes'*/:\n                break;\n              case 'firstvisiblesheet' /*case 'FirstVisibleSheet'*/:\n                break;\n              case 'supbook' /*case 'SupBook'*/:\n                break;\n              case 'sheetname' /*case 'SheetName'*/:\n                break;\n              case 'sheetindex' /*case 'SheetIndex'*/:\n                break;\n              case 'sheetindexfirst' /*case 'SheetIndexFirst'*/:\n                break;\n              case 'sheetindexlast' /*case 'SheetIndexLast'*/:\n                break;\n              case 'dll' /*case 'Dll'*/:\n                break;\n              case 'acceptlabelsinformulas' /*case 'AcceptLabelsInFormulas'*/:\n                break;\n              case 'donotsavelinkvalues' /*case 'DoNotSaveLinkValues'*/:\n                break;\n              case 'iteration' /*case 'Iteration'*/:\n                break;\n              case 'maxiterations' /*case 'MaxIterations'*/:\n                break;\n              case 'maxchange' /*case 'MaxChange'*/:\n                break;\n              case 'path' /*case 'Path'*/:\n                break;\n              case 'xct' /*case 'Xct'*/:\n                break;\n              case 'count' /*case 'Count'*/:\n                break;\n              case 'selectedsheets' /*case 'SelectedSheets'*/:\n                break;\n              case 'calculation' /*case 'Calculation'*/:\n                break;\n              case 'uncalced' /*case 'Uncalced'*/:\n                break;\n              case 'startupprompt' /*case 'StartupPrompt'*/:\n                break;\n              case 'crn' /*case 'Crn'*/:\n                break;\n              case 'externname' /*case 'ExternName'*/:\n                break;\n              case 'formula' /*case 'Formula'*/:\n                break;\n              case 'colfirst' /*case 'ColFirst'*/:\n                break;\n              case 'collast' /*case 'ColLast'*/:\n                break;\n              case 'wantadvise' /*case 'WantAdvise'*/:\n                break;\n              case 'boolean' /*case 'Boolean'*/:\n                break;\n              case 'error' /*case 'Error'*/:\n                break;\n              case 'text' /*case 'Text'*/:\n                break;\n              case 'ole' /*case 'OLE'*/:\n                break;\n              case 'noautorecover' /*case 'NoAutoRecover'*/:\n                break;\n              case 'publishobjects' /*case 'PublishObjects'*/:\n                break;\n              case 'donotcalculatebeforesave' /*case 'DoNotCalculateBeforeSave'*/:\n                break;\n              case 'number' /*case 'Number'*/:\n                break;\n              case 'refmoder1c1' /*case 'RefModeR1C1'*/:\n                break;\n              case 'embedsavesmarttags' /*case 'EmbedSaveSmartTags'*/:\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* WorkbookOptions */\n          case 'workbookoptions' /*case 'WorkbookOptions'*/:\n            switch (Rn[3]) {\n              case 'owcversion' /*case 'OWCVersion'*/:\n                break;\n              case 'height' /*case 'Height'*/:\n                break;\n              case 'width' /*case 'Width'*/:\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* WorksheetOptions */\n          case 'worksheetoptions' /*case 'WorksheetOptions'*/:\n            switch (Rn[3]) {\n              case 'visible' /*case 'Visible'*/:\n                if (Rn[0].slice(-2) === \"/>\") {/* empty */} else if (Rn[1] === \"/\") switch (str.slice(pidx, Rn.index)) {\n                  case \"SheetHidden\":\n                    wsprops.Hidden = 1;\n                    break;\n                  case \"SheetVeryHidden\":\n                    wsprops.Hidden = 2;\n                    break;\n                } else pidx = Rn.index + Rn[0].length;\n                break;\n              case 'header' /*case 'Header'*/:\n                if (!cursheet['!margins']) default_margins(cursheet['!margins'] = {}, 'xlml');\n                if (!isNaN(+parsexmltag(Rn[0]).Margin)) cursheet['!margins'].header = +parsexmltag(Rn[0]).Margin;\n                break;\n              case 'footer' /*case 'Footer'*/:\n                if (!cursheet['!margins']) default_margins(cursheet['!margins'] = {}, 'xlml');\n                if (!isNaN(+parsexmltag(Rn[0]).Margin)) cursheet['!margins'].footer = +parsexmltag(Rn[0]).Margin;\n                break;\n              case 'pagemargins' /*case 'PageMargins'*/:\n                var pagemargins = parsexmltag(Rn[0]);\n                if (!cursheet['!margins']) default_margins(cursheet['!margins'] = {}, 'xlml');\n                if (!isNaN(+pagemargins.Top)) cursheet['!margins'].top = +pagemargins.Top;\n                if (!isNaN(+pagemargins.Left)) cursheet['!margins'].left = +pagemargins.Left;\n                if (!isNaN(+pagemargins.Right)) cursheet['!margins'].right = +pagemargins.Right;\n                if (!isNaN(+pagemargins.Bottom)) cursheet['!margins'].bottom = +pagemargins.Bottom;\n                break;\n              case 'displayrighttoleft' /*case 'DisplayRightToLeft'*/:\n                if (!Workbook.Views) Workbook.Views = [];\n                if (!Workbook.Views[0]) Workbook.Views[0] = {};\n                Workbook.Views[0].RTL = true;\n                break;\n              case 'freezepanes' /*case 'FreezePanes'*/:\n                break;\n              case 'frozennosplit' /*case 'FrozenNoSplit'*/:\n                break;\n              case 'splithorizontal' /*case 'SplitHorizontal'*/:\n              case 'splitvertical' /*case 'SplitVertical'*/:\n                break;\n              case 'donotdisplaygridlines' /*case 'DoNotDisplayGridlines'*/:\n                break;\n              case 'activerow' /*case 'ActiveRow'*/:\n                break;\n              case 'activecol' /*case 'ActiveCol'*/:\n                break;\n              case 'toprowbottompane' /*case 'TopRowBottomPane'*/:\n                break;\n              case 'leftcolumnrightpane' /*case 'LeftColumnRightPane'*/:\n                break;\n              case 'unsynced' /*case 'Unsynced'*/:\n                break;\n              case 'print' /*case 'Print'*/:\n                break;\n              case 'printerrors' /*case 'PrintErrors'*/:\n                break;\n              case 'panes' /*case 'Panes'*/:\n                break;\n              case 'scale' /*case 'Scale'*/:\n                break;\n              case 'pane' /*case 'Pane'*/:\n                break;\n              case 'number' /*case 'Number'*/:\n                break;\n              case 'layout' /*case 'Layout'*/:\n                break;\n              case 'pagesetup' /*case 'PageSetup'*/:\n                break;\n              case 'selected' /*case 'Selected'*/:\n                break;\n              case 'protectobjects' /*case 'ProtectObjects'*/:\n                break;\n              case 'enableselection' /*case 'EnableSelection'*/:\n                break;\n              case 'protectscenarios' /*case 'ProtectScenarios'*/:\n                break;\n              case 'validprinterinfo' /*case 'ValidPrinterInfo'*/:\n                break;\n              case 'horizontalresolution' /*case 'HorizontalResolution'*/:\n                break;\n              case 'verticalresolution' /*case 'VerticalResolution'*/:\n                break;\n              case 'numberofcopies' /*case 'NumberofCopies'*/:\n                break;\n              case 'activepane' /*case 'ActivePane'*/:\n                break;\n              case 'toprowvisible' /*case 'TopRowVisible'*/:\n                break;\n              case 'leftcolumnvisible' /*case 'LeftColumnVisible'*/:\n                break;\n              case 'fittopage' /*case 'FitToPage'*/:\n                break;\n              case 'rangeselection' /*case 'RangeSelection'*/:\n                break;\n              case 'papersizeindex' /*case 'PaperSizeIndex'*/:\n                break;\n              case 'pagelayoutzoom' /*case 'PageLayoutZoom'*/:\n                break;\n              case 'pagebreakzoom' /*case 'PageBreakZoom'*/:\n                break;\n              case 'filteron' /*case 'FilterOn'*/:\n                break;\n              case 'fitwidth' /*case 'FitWidth'*/:\n                break;\n              case 'fitheight' /*case 'FitHeight'*/:\n                break;\n              case 'commentslayout' /*case 'CommentsLayout'*/:\n                break;\n              case 'zoom' /*case 'Zoom'*/:\n                break;\n              case 'lefttoright' /*case 'LeftToRight'*/:\n                break;\n              case 'gridlines' /*case 'Gridlines'*/:\n                break;\n              case 'allowsort' /*case 'AllowSort'*/:\n                break;\n              case 'allowfilter' /*case 'AllowFilter'*/:\n                break;\n              case 'allowinsertrows' /*case 'AllowInsertRows'*/:\n                break;\n              case 'allowdeleterows' /*case 'AllowDeleteRows'*/:\n                break;\n              case 'allowinsertcols' /*case 'AllowInsertCols'*/:\n                break;\n              case 'allowdeletecols' /*case 'AllowDeleteCols'*/:\n                break;\n              case 'allowinserthyperlinks' /*case 'AllowInsertHyperlinks'*/:\n                break;\n              case 'allowformatcells' /*case 'AllowFormatCells'*/:\n                break;\n              case 'allowsizecols' /*case 'AllowSizeCols'*/:\n                break;\n              case 'allowsizerows' /*case 'AllowSizeRows'*/:\n                break;\n              case 'nosummaryrowsbelowdetail' /*case 'NoSummaryRowsBelowDetail'*/:\n                if (!cursheet[\"!outline\"]) cursheet[\"!outline\"] = {};\n                cursheet[\"!outline\"].above = true;\n                break;\n              case 'tabcolorindex' /*case 'TabColorIndex'*/:\n                break;\n              case 'donotdisplayheadings' /*case 'DoNotDisplayHeadings'*/:\n                break;\n              case 'showpagelayoutzoom' /*case 'ShowPageLayoutZoom'*/:\n                break;\n              case 'nosummarycolumnsrightdetail' /*case 'NoSummaryColumnsRightDetail'*/:\n                if (!cursheet[\"!outline\"]) cursheet[\"!outline\"] = {};\n                cursheet[\"!outline\"].left = true;\n                break;\n              case 'blackandwhite' /*case 'BlackAndWhite'*/:\n                break;\n              case 'donotdisplayzeros' /*case 'DoNotDisplayZeros'*/:\n                break;\n              case 'displaypagebreak' /*case 'DisplayPageBreak'*/:\n                break;\n              case 'rowcolheadings' /*case 'RowColHeadings'*/:\n                break;\n              case 'donotdisplayoutline' /*case 'DoNotDisplayOutline'*/:\n                break;\n              case 'noorientation' /*case 'NoOrientation'*/:\n                break;\n              case 'allowusepivottables' /*case 'AllowUsePivotTables'*/:\n                break;\n              case 'zeroheight' /*case 'ZeroHeight'*/:\n                break;\n              case 'viewablerange' /*case 'ViewableRange'*/:\n                break;\n              case 'selection' /*case 'Selection'*/:\n                break;\n              case 'protectcontents' /*case 'ProtectContents'*/:\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* PivotTable */\n          case 'pivottable' /*case 'PivotTable'*/:\n          case 'pivotcache' /*case 'PivotCache'*/:\n            switch (Rn[3]) {\n              case 'immediateitemsondrop' /*case 'ImmediateItemsOnDrop'*/:\n                break;\n              case 'showpagemultipleitemlabel' /*case 'ShowPageMultipleItemLabel'*/:\n                break;\n              case 'compactrowindent' /*case 'CompactRowIndent'*/:\n                break;\n              case 'location' /*case 'Location'*/:\n                break;\n              case 'pivotfield' /*case 'PivotField'*/:\n                break;\n              case 'orientation' /*case 'Orientation'*/:\n                break;\n              case 'layoutform' /*case 'LayoutForm'*/:\n                break;\n              case 'layoutsubtotallocation' /*case 'LayoutSubtotalLocation'*/:\n                break;\n              case 'layoutcompactrow' /*case 'LayoutCompactRow'*/:\n                break;\n              case 'position' /*case 'Position'*/:\n                break;\n              case 'pivotitem' /*case 'PivotItem'*/:\n                break;\n              case 'datatype' /*case 'DataType'*/:\n                break;\n              case 'datafield' /*case 'DataField'*/:\n                break;\n              case 'sourcename' /*case 'SourceName'*/:\n                break;\n              case 'parentfield' /*case 'ParentField'*/:\n                break;\n              case 'ptlineitems' /*case 'PTLineItems'*/:\n                break;\n              case 'ptlineitem' /*case 'PTLineItem'*/:\n                break;\n              case 'countofsameitems' /*case 'CountOfSameItems'*/:\n                break;\n              case 'item' /*case 'Item'*/:\n                break;\n              case 'itemtype' /*case 'ItemType'*/:\n                break;\n              case 'ptsource' /*case 'PTSource'*/:\n                break;\n              case 'cacheindex' /*case 'CacheIndex'*/:\n                break;\n              case 'consolidationreference' /*case 'ConsolidationReference'*/:\n                break;\n              case 'filename' /*case 'FileName'*/:\n                break;\n              case 'reference' /*case 'Reference'*/:\n                break;\n              case 'nocolumngrand' /*case 'NoColumnGrand'*/:\n                break;\n              case 'norowgrand' /*case 'NoRowGrand'*/:\n                break;\n              case 'blanklineafteritems' /*case 'BlankLineAfterItems'*/:\n                break;\n              case 'hidden' /*case 'Hidden'*/:\n                break;\n              case 'subtotal' /*case 'Subtotal'*/:\n                break;\n              case 'basefield' /*case 'BaseField'*/:\n                break;\n              case 'mapchilditems' /*case 'MapChildItems'*/:\n                break;\n              case 'function' /*case 'Function'*/:\n                break;\n              case 'refreshonfileopen' /*case 'RefreshOnFileOpen'*/:\n                break;\n              case 'printsettitles' /*case 'PrintSetTitles'*/:\n                break;\n              case 'mergelabels' /*case 'MergeLabels'*/:\n                break;\n              case 'defaultversion' /*case 'DefaultVersion'*/:\n                break;\n              case 'refreshname' /*case 'RefreshName'*/:\n                break;\n              case 'refreshdate' /*case 'RefreshDate'*/:\n                break;\n              case 'refreshdatecopy' /*case 'RefreshDateCopy'*/:\n                break;\n              case 'versionlastrefresh' /*case 'VersionLastRefresh'*/:\n                break;\n              case 'versionlastupdate' /*case 'VersionLastUpdate'*/:\n                break;\n              case 'versionupdateablemin' /*case 'VersionUpdateableMin'*/:\n                break;\n              case 'versionrefreshablemin' /*case 'VersionRefreshableMin'*/:\n                break;\n              case 'calculation' /*case 'Calculation'*/:\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* PageBreaks */\n          case 'pagebreaks' /*case 'PageBreaks'*/:\n            switch (Rn[3]) {\n              case 'colbreaks' /*case 'ColBreaks'*/:\n                break;\n              case 'colbreak' /*case 'ColBreak'*/:\n                break;\n              case 'rowbreaks' /*case 'RowBreaks'*/:\n                break;\n              case 'rowbreak' /*case 'RowBreak'*/:\n                break;\n              case 'colstart' /*case 'ColStart'*/:\n                break;\n              case 'colend' /*case 'ColEnd'*/:\n                break;\n              case 'rowend' /*case 'RowEnd'*/:\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* AutoFilter */\n          case 'autofilter' /*case 'AutoFilter'*/:\n            switch (Rn[3]) {\n              case 'autofiltercolumn' /*case 'AutoFilterColumn'*/:\n                break;\n              case 'autofiltercondition' /*case 'AutoFilterCondition'*/:\n                break;\n              case 'autofilterand' /*case 'AutoFilterAnd'*/:\n                break;\n              case 'autofilteror' /*case 'AutoFilterOr'*/:\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* QueryTable */\n          case 'querytable' /*case 'QueryTable'*/:\n            switch (Rn[3]) {\n              case 'id' /*case 'Id'*/:\n                break;\n              case 'autoformatfont' /*case 'AutoFormatFont'*/:\n                break;\n              case 'autoformatpattern' /*case 'AutoFormatPattern'*/:\n                break;\n              case 'querysource' /*case 'QuerySource'*/:\n                break;\n              case 'querytype' /*case 'QueryType'*/:\n                break;\n              case 'enableredirections' /*case 'EnableRedirections'*/:\n                break;\n              case 'refreshedinxl9' /*case 'RefreshedInXl9'*/:\n                break;\n              case 'urlstring' /*case 'URLString'*/:\n                break;\n              case 'htmltables' /*case 'HTMLTables'*/:\n                break;\n              case 'connection' /*case 'Connection'*/:\n                break;\n              case 'commandtext' /*case 'CommandText'*/:\n                break;\n              case 'refreshinfo' /*case 'RefreshInfo'*/:\n                break;\n              case 'notitles' /*case 'NoTitles'*/:\n                break;\n              case 'nextid' /*case 'NextId'*/:\n                break;\n              case 'columninfo' /*case 'ColumnInfo'*/:\n                break;\n              case 'overwritecells' /*case 'OverwriteCells'*/:\n                break;\n              case 'donotpromptforfile' /*case 'DoNotPromptForFile'*/:\n                break;\n              case 'textwizardsettings' /*case 'TextWizardSettings'*/:\n                break;\n              case 'source' /*case 'Source'*/:\n                break;\n              case 'number' /*case 'Number'*/:\n                break;\n              case 'decimal' /*case 'Decimal'*/:\n                break;\n              case 'thousandseparator' /*case 'ThousandSeparator'*/:\n                break;\n              case 'trailingminusnumbers' /*case 'TrailingMinusNumbers'*/:\n                break;\n              case 'formatsettings' /*case 'FormatSettings'*/:\n                break;\n              case 'fieldtype' /*case 'FieldType'*/:\n                break;\n              case 'delimiters' /*case 'Delimiters'*/:\n                break;\n              case 'tab' /*case 'Tab'*/:\n                break;\n              case 'comma' /*case 'Comma'*/:\n                break;\n              case 'autoformatname' /*case 'AutoFormatName'*/:\n                break;\n              case 'versionlastedit' /*case 'VersionLastEdit'*/:\n                break;\n              case 'versionlastrefresh' /*case 'VersionLastRefresh'*/:\n                break;\n              default:\n                seen = false;\n            }\n            break;\n          case 'datavalidation' /*case 'DataValidation'*/:\n            switch (Rn[3]) {\n              case 'range' /*case 'Range'*/:\n                break;\n              case 'type' /*case 'Type'*/:\n                break;\n              case 'min' /*case 'Min'*/:\n                break;\n              case 'max' /*case 'Max'*/:\n                break;\n              case 'sort' /*case 'Sort'*/:\n                break;\n              case 'descending' /*case 'Descending'*/:\n                break;\n              case 'order' /*case 'Order'*/:\n                break;\n              case 'casesensitive' /*case 'CaseSensitive'*/:\n                break;\n              case 'value' /*case 'Value'*/:\n                break;\n              case 'errorstyle' /*case 'ErrorStyle'*/:\n                break;\n              case 'errormessage' /*case 'ErrorMessage'*/:\n                break;\n              case 'errortitle' /*case 'ErrorTitle'*/:\n                break;\n              case 'inputmessage' /*case 'InputMessage'*/:\n                break;\n              case 'inputtitle' /*case 'InputTitle'*/:\n                break;\n              case 'combohide' /*case 'ComboHide'*/:\n                break;\n              case 'inputhide' /*case 'InputHide'*/:\n                break;\n              case 'condition' /*case 'Condition'*/:\n                break;\n              case 'qualifier' /*case 'Qualifier'*/:\n                break;\n              case 'useblank' /*case 'UseBlank'*/:\n                break;\n              case 'value1' /*case 'Value1'*/:\n                break;\n              case 'value2' /*case 'Value2'*/:\n                break;\n              case 'format' /*case 'Format'*/:\n                break;\n              case 'cellrangelist' /*case 'CellRangeList'*/:\n                break;\n              default:\n                seen = false;\n            }\n            break;\n          case 'sorting' /*case 'Sorting'*/:\n          case 'conditionalformatting' /*case 'ConditionalFormatting'*/:\n            switch (Rn[3]) {\n              case 'range' /*case 'Range'*/:\n                break;\n              case 'type' /*case 'Type'*/:\n                break;\n              case 'min' /*case 'Min'*/:\n                break;\n              case 'max' /*case 'Max'*/:\n                break;\n              case 'sort' /*case 'Sort'*/:\n                break;\n              case 'descending' /*case 'Descending'*/:\n                break;\n              case 'order' /*case 'Order'*/:\n                break;\n              case 'casesensitive' /*case 'CaseSensitive'*/:\n                break;\n              case 'value' /*case 'Value'*/:\n                break;\n              case 'errorstyle' /*case 'ErrorStyle'*/:\n                break;\n              case 'errormessage' /*case 'ErrorMessage'*/:\n                break;\n              case 'errortitle' /*case 'ErrorTitle'*/:\n                break;\n              case 'cellrangelist' /*case 'CellRangeList'*/:\n                break;\n              case 'inputmessage' /*case 'InputMessage'*/:\n                break;\n              case 'inputtitle' /*case 'InputTitle'*/:\n                break;\n              case 'combohide' /*case 'ComboHide'*/:\n                break;\n              case 'inputhide' /*case 'InputHide'*/:\n                break;\n              case 'condition' /*case 'Condition'*/:\n                break;\n              case 'qualifier' /*case 'Qualifier'*/:\n                break;\n              case 'useblank' /*case 'UseBlank'*/:\n                break;\n              case 'value1' /*case 'Value1'*/:\n                break;\n              case 'value2' /*case 'Value2'*/:\n                break;\n              case 'format' /*case 'Format'*/:\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* MapInfo (schema) */\n          case 'mapinfo' /*case 'MapInfo'*/:\n          case 'schema' /*case 'Schema'*/:\n          case 'data' /*case 'data'*/:\n            switch (Rn[3]) {\n              case 'map' /*case 'Map'*/:\n                break;\n              case 'entry' /*case 'Entry'*/:\n                break;\n              case 'range' /*case 'Range'*/:\n                break;\n              case 'xpath' /*case 'XPath'*/:\n                break;\n              case 'field' /*case 'Field'*/:\n                break;\n              case 'xsdtype' /*case 'XSDType'*/:\n                break;\n              case 'filteron' /*case 'FilterOn'*/:\n                break;\n              case 'aggregate' /*case 'Aggregate'*/:\n                break;\n              case 'elementtype' /*case 'ElementType'*/:\n                break;\n              case 'attributetype' /*case 'AttributeType'*/:\n                break;\n              /* These are from xsd (XML Schema Definition) */\n              case 'schema' /*case 'schema'*/:\n              case 'element' /*case 'element'*/:\n              case 'complextype' /*case 'complexType'*/:\n              case 'datatype' /*case 'datatype'*/:\n              case 'all' /*case 'all'*/:\n              case 'attribute' /*case 'attribute'*/:\n              case 'extends' /*case 'extends'*/:\n                break;\n              case 'row' /*case 'row'*/:\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* SmartTags (can be anything) */\n          case 'smarttags' /*case 'SmartTags'*/:\n            break;\n          default:\n            seen = false;\n            break;\n        }\n        if (seen) break;\n        /* CustomDocumentProperties */\n        if (Rn[3].match(/!\\[CDATA/)) break;\n        if (!state[state.length - 1][1]) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n        if (state[state.length - 1][0] === /*'CustomDocumentProperties'*/'customdocumentproperties') {\n          if (Rn[0].slice(-2) === \"/>\") break;else if (Rn[1] === \"/\") xlml_set_custprop(Custprops, raw_Rn3, cp, str.slice(pidx, Rn.index));else {\n            cp = Rn;\n            pidx = Rn.index + Rn[0].length;\n          }\n          break;\n        }\n        if (opts.WTF) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n    }\n    var out = {};\n    if (!opts.bookSheets && !opts.bookProps) out.Sheets = sheets;\n    out.SheetNames = sheetnames;\n    out.Workbook = Workbook;\n    out.SSF = dup(table_fmt);\n    out.Props = Props;\n    out.Custprops = Custprops;\n    return out;\n  }\n  function parse_xlml(data, opts) {\n    fix_read_opts(opts = opts || {});\n    switch (opts.type || \"base64\") {\n      case \"base64\":\n        return parse_xlml_xml(Base64_decode(data), opts);\n      case \"binary\":\n      case \"buffer\":\n      case \"file\":\n        return parse_xlml_xml(data, opts);\n      case \"array\":\n        return parse_xlml_xml(a2s(data), opts);\n    }\n  }\n\n  /* TODO */\n  function write_props_xlml(wb, opts) {\n    var o = [];\n    /* DocumentProperties */\n    if (wb.Props) o.push(xlml_write_docprops(wb.Props, opts));\n    /* CustomDocumentProperties */\n    if (wb.Custprops) o.push(xlml_write_custprops(wb.Props, wb.Custprops, opts));\n    return o.join(\"\");\n  }\n  /* TODO */\n  function write_wb_xlml() {\n    /* OfficeDocumentSettings */\n    /* ExcelWorkbook */\n    return \"\";\n  }\n  /* TODO */\n  function write_sty_xlml(wb, opts) {\n    /* Styles */\n    var styles = ['<Style ss:ID=\"Default\" ss:Name=\"Normal\"><NumberFormat/></Style>'];\n    opts.cellXfs.forEach(function (xf, id) {\n      var payload = [];\n      payload.push(writextag('NumberFormat', null, {\n        \"ss:Format\": escapexml(table_fmt[xf.numFmtId])\n      }));\n      var o = {\n        \"ss:ID\": \"s\" + (21 + id)\n      };\n      styles.push(writextag('Style', payload.join(\"\"), o));\n    });\n    return writextag(\"Styles\", styles.join(\"\"));\n  }\n  function write_name_xlml(n) {\n    return writextag(\"NamedRange\", null, {\n      \"ss:Name\": n.Name,\n      \"ss:RefersTo\": \"=\" + a1_to_rc(n.Ref, {\n        r: 0,\n        c: 0\n      })\n    });\n  }\n  function write_names_xlml(wb) {\n    if (!((wb || {}).Workbook || {}).Names) return \"\";\n    var names = wb.Workbook.Names;\n    var out = [];\n    for (var i = 0; i < names.length; ++i) {\n      var n = names[i];\n      if (n.Sheet != null) continue;\n      if (n.Name.match(/^_xlfn\\./)) continue;\n      out.push(write_name_xlml(n));\n    }\n    return writextag(\"Names\", out.join(\"\"));\n  }\n  function write_ws_xlml_names(ws, opts, idx, wb) {\n    if (!ws) return \"\";\n    if (!((wb || {}).Workbook || {}).Names) return \"\";\n    var names = wb.Workbook.Names;\n    var out = [];\n    for (var i = 0; i < names.length; ++i) {\n      var n = names[i];\n      if (n.Sheet != idx) continue;\n      /*switch(n.Name) {\n      \tcase \"_\": continue;\n      }*/\n      if (n.Name.match(/^_xlfn\\./)) continue;\n      out.push(write_name_xlml(n));\n    }\n    return out.join(\"\");\n  }\n  /* WorksheetOptions */\n  function write_ws_xlml_wsopts(ws, opts, idx, wb) {\n    if (!ws) return \"\";\n    var o = [];\n    /* NOTE: spec technically allows any order, but stick with implied order */\n\n    /* FitToPage */\n    /* DoNotDisplayColHeaders */\n    /* DoNotDisplayRowHeaders */\n    /* ViewableRange */\n    /* Selection */\n    /* GridlineColor */\n    /* Name */\n    /* ExcelWorksheetType */\n    /* IntlMacro */\n    /* Unsynced */\n    /* Selected */\n    /* CodeName */\n\n    if (ws['!margins']) {\n      o.push(\"<PageSetup>\");\n      if (ws['!margins'].header) o.push(writextag(\"Header\", null, {\n        'x:Margin': ws['!margins'].header\n      }));\n      if (ws['!margins'].footer) o.push(writextag(\"Footer\", null, {\n        'x:Margin': ws['!margins'].footer\n      }));\n      o.push(writextag(\"PageMargins\", null, {\n        'x:Bottom': ws['!margins'].bottom || \"0.75\",\n        'x:Left': ws['!margins'].left || \"0.7\",\n        'x:Right': ws['!margins'].right || \"0.7\",\n        'x:Top': ws['!margins'].top || \"0.75\"\n      }));\n      o.push(\"</PageSetup>\");\n    }\n\n    /* PageSetup */\n    /* DisplayPageBreak */\n    /* TransitionExpressionEvaluation */\n    /* TransitionFormulaEntry */\n    /* Print */\n    /* Zoom */\n    /* PageLayoutZoom */\n    /* PageBreakZoom */\n    /* ShowPageBreakZoom */\n    /* DefaultRowHeight */\n    /* DefaultColumnWidth */\n    /* StandardWidth */\n\n    if (wb && wb.Workbook && wb.Workbook.Sheets && wb.Workbook.Sheets[idx]) {\n      /* Visible */\n      if (wb.Workbook.Sheets[idx].Hidden) o.push(writextag(\"Visible\", wb.Workbook.Sheets[idx].Hidden == 1 ? \"SheetHidden\" : \"SheetVeryHidden\", {}));else {\n        /* Selected */\n        for (var i = 0; i < idx; ++i) if (wb.Workbook.Sheets[i] && !wb.Workbook.Sheets[i].Hidden) break;\n        if (i == idx) o.push(\"<Selected/>\");\n      }\n    }\n\n    /* LeftColumnVisible */\n\n    if (((((wb || {}).Workbook || {}).Views || [])[0] || {}).RTL) o.push(\"<DisplayRightToLeft/>\");\n\n    /* GridlineColorIndex */\n    /* DisplayFormulas */\n    /* DoNotDisplayGridlines */\n    /* DoNotDisplayHeadings */\n    /* DoNotDisplayOutline */\n    /* ApplyAutomaticOutlineStyles */\n    /* NoSummaryRowsBelowDetail */\n    /* NoSummaryColumnsRightDetail */\n    /* DoNotDisplayZeros */\n    /* ActiveRow */\n    /* ActiveColumn */\n    /* FilterOn */\n    /* RangeSelection */\n    /* TopRowVisible */\n    /* TopRowBottomPane */\n    /* LeftColumnRightPane */\n    /* ActivePane */\n    /* SplitHorizontal */\n    /* SplitVertical */\n    /* FreezePanes */\n    /* FrozenNoSplit */\n    /* TabColorIndex */\n    /* Panes */\n\n    /* NOTE: Password not supported in XLML Format */\n    if (ws['!protect']) {\n      o.push(writetag(\"ProtectContents\", \"True\"));\n      if (ws['!protect'].objects) o.push(writetag(\"ProtectObjects\", \"True\"));\n      if (ws['!protect'].scenarios) o.push(writetag(\"ProtectScenarios\", \"True\"));\n      if (ws['!protect'].selectLockedCells != null && !ws['!protect'].selectLockedCells) o.push(writetag(\"EnableSelection\", \"NoSelection\"));else if (ws['!protect'].selectUnlockedCells != null && !ws['!protect'].selectUnlockedCells) o.push(writetag(\"EnableSelection\", \"UnlockedCells\"));\n      [[\"formatCells\", \"AllowFormatCells\"], [\"formatColumns\", \"AllowSizeCols\"], [\"formatRows\", \"AllowSizeRows\"], [\"insertColumns\", \"AllowInsertCols\"], [\"insertRows\", \"AllowInsertRows\"], [\"insertHyperlinks\", \"AllowInsertHyperlinks\"], [\"deleteColumns\", \"AllowDeleteCols\"], [\"deleteRows\", \"AllowDeleteRows\"], [\"sort\", \"AllowSort\"], [\"autoFilter\", \"AllowFilter\"], [\"pivotTables\", \"AllowUsePivotTables\"]].forEach(function (x) {\n        if (ws['!protect'][x[0]]) o.push(\"<\" + x[1] + \"/>\");\n      });\n    }\n    if (o.length == 0) return \"\";\n    return writextag(\"WorksheetOptions\", o.join(\"\"), {\n      xmlns: XLMLNS.x\n    });\n  }\n  function write_ws_xlml_comment(comments) {\n    return comments.map(function (c) {\n      // TODO: formatted text\n      var t = xlml_unfixstr(c.t || \"\");\n      var d = writextag(\"ss:Data\", t, {\n        \"xmlns\": \"http://www.w3.org/TR/REC-html40\"\n      });\n      return writextag(\"Comment\", d, {\n        \"ss:Author\": c.a\n      });\n    }).join(\"\");\n  }\n  function write_ws_xlml_cell(cell, ref, ws, opts, idx, wb, addr) {\n    if (!cell || cell.v == undefined && cell.f == undefined) return \"\";\n    var attr = {};\n    if (cell.f) attr[\"ss:Formula\"] = \"=\" + escapexml(a1_to_rc(cell.f, addr));\n    if (cell.F && cell.F.slice(0, ref.length) == ref) {\n      var end = decode_cell(cell.F.slice(ref.length + 1));\n      attr[\"ss:ArrayRange\"] = \"RC:R\" + (end.r == addr.r ? \"\" : \"[\" + (end.r - addr.r) + \"]\") + \"C\" + (end.c == addr.c ? \"\" : \"[\" + (end.c - addr.c) + \"]\");\n    }\n    if (cell.l && cell.l.Target) {\n      attr[\"ss:HRef\"] = escapexml(cell.l.Target);\n      if (cell.l.Tooltip) attr[\"x:HRefScreenTip\"] = escapexml(cell.l.Tooltip);\n    }\n    if (ws['!merges']) {\n      var marr = ws['!merges'];\n      for (var mi = 0; mi != marr.length; ++mi) {\n        if (marr[mi].s.c != addr.c || marr[mi].s.r != addr.r) continue;\n        if (marr[mi].e.c > marr[mi].s.c) attr['ss:MergeAcross'] = marr[mi].e.c - marr[mi].s.c;\n        if (marr[mi].e.r > marr[mi].s.r) attr['ss:MergeDown'] = marr[mi].e.r - marr[mi].s.r;\n      }\n    }\n    var t = \"\",\n      p = \"\";\n    switch (cell.t) {\n      case 'z':\n        if (!opts.sheetStubs) return \"\";\n        break;\n      case 'n':\n        t = 'Number';\n        p = String(cell.v);\n        break;\n      case 'b':\n        t = 'Boolean';\n        p = cell.v ? \"1\" : \"0\";\n        break;\n      case 'e':\n        t = 'Error';\n        p = BErr[cell.v];\n        break;\n      case 'd':\n        t = 'DateTime';\n        p = new Date(cell.v).toISOString();\n        if (cell.z == null) cell.z = cell.z || table_fmt[14];\n        break;\n      case 's':\n        t = 'String';\n        p = escapexlml(cell.v || \"\");\n        break;\n    }\n    /* TODO: cell style */\n    var os = get_cell_style(opts.cellXfs, cell, opts);\n    attr[\"ss:StyleID\"] = \"s\" + (21 + os);\n    attr[\"ss:Index\"] = addr.c + 1;\n    var _v = cell.v != null ? p : \"\";\n    var m = cell.t == 'z' ? \"\" : '<Data ss:Type=\"' + t + '\">' + _v + '</Data>';\n    if ((cell.c || []).length > 0) m += write_ws_xlml_comment(cell.c);\n    return writextag(\"Cell\", m, attr);\n  }\n  function write_ws_xlml_row(R, row) {\n    var o = '<Row ss:Index=\"' + (R + 1) + '\"';\n    if (row) {\n      if (row.hpt && !row.hpx) row.hpx = pt2px(row.hpt);\n      if (row.hpx) o += ' ss:AutoFitHeight=\"0\" ss:Height=\"' + row.hpx + '\"';\n      if (row.hidden) o += ' ss:Hidden=\"1\"';\n    }\n    return o + '>';\n  }\n  /* TODO */\n  function write_ws_xlml_table(ws, opts, idx, wb) {\n    if (!ws['!ref']) return \"\";\n    var range = safe_decode_range(ws['!ref']);\n    var marr = ws['!merges'] || [],\n      mi = 0;\n    var o = [];\n    if (ws['!cols']) ws['!cols'].forEach(function (n, i) {\n      process_col(n);\n      var w = !!n.width;\n      var p = col_obj_w(i, n);\n      var k = {\n        \"ss:Index\": i + 1\n      };\n      if (w) k['ss:Width'] = width2px(p.width);\n      if (n.hidden) k['ss:Hidden'] = \"1\";\n      o.push(writextag(\"Column\", null, k));\n    });\n    var dense = Array.isArray(ws);\n    for (var R = range.s.r; R <= range.e.r; ++R) {\n      var row = [write_ws_xlml_row(R, (ws['!rows'] || [])[R])];\n      for (var C = range.s.c; C <= range.e.c; ++C) {\n        var skip = false;\n        for (mi = 0; mi != marr.length; ++mi) {\n          if (marr[mi].s.c > C) continue;\n          if (marr[mi].s.r > R) continue;\n          if (marr[mi].e.c < C) continue;\n          if (marr[mi].e.r < R) continue;\n          if (marr[mi].s.c != C || marr[mi].s.r != R) skip = true;\n          break;\n        }\n        if (skip) continue;\n        var addr = {\n          r: R,\n          c: C\n        };\n        var ref = encode_cell(addr),\n          cell = dense ? (ws[R] || [])[C] : ws[ref];\n        row.push(write_ws_xlml_cell(cell, ref, ws, opts, idx, wb, addr));\n      }\n      row.push(\"</Row>\");\n      if (row.length > 2) o.push(row.join(\"\"));\n    }\n    return o.join(\"\");\n  }\n  function write_ws_xlml(idx, opts, wb) {\n    var o = [];\n    var s = wb.SheetNames[idx];\n    var ws = wb.Sheets[s];\n    var t = ws ? write_ws_xlml_names(ws, opts, idx, wb) : \"\";\n    if (t.length > 0) o.push(\"<Names>\" + t + \"</Names>\");\n\n    /* Table */\n    t = ws ? write_ws_xlml_table(ws, opts, idx, wb) : \"\";\n    if (t.length > 0) o.push(\"<Table>\" + t + \"</Table>\");\n\n    /* WorksheetOptions */\n    o.push(write_ws_xlml_wsopts(ws, opts, idx, wb));\n    return o.join(\"\");\n  }\n  function write_xlml(wb, opts) {\n    if (!opts) opts = {};\n    if (!wb.SSF) wb.SSF = dup(table_fmt);\n    if (wb.SSF) {\n      make_ssf();\n      SSF_load_table(wb.SSF);\n      // $FlowIgnore\n      opts.revssf = evert_num(wb.SSF);\n      opts.revssf[wb.SSF[65535]] = 0;\n      opts.ssf = wb.SSF;\n      opts.cellXfs = [];\n      get_cell_style(opts.cellXfs, {}, {\n        revssf: {\n          \"General\": 0\n        }\n      });\n    }\n    var d = [];\n    d.push(write_props_xlml(wb, opts));\n    d.push(write_wb_xlml(wb, opts));\n    d.push(\"\");\n    d.push(\"\");\n    for (var i = 0; i < wb.SheetNames.length; ++i) d.push(writextag(\"Worksheet\", write_ws_xlml(i, opts, wb), {\n      \"ss:Name\": escapexml(wb.SheetNames[i])\n    }));\n    d[2] = write_sty_xlml(wb, opts);\n    d[3] = write_names_xlml(wb, opts);\n    return XML_HEADER + writextag(\"Workbook\", d.join(\"\"), {\n      'xmlns': XLMLNS.ss,\n      'xmlns:o': XLMLNS.o,\n      'xmlns:x': XLMLNS.x,\n      'xmlns:ss': XLMLNS.ss,\n      'xmlns:dt': XLMLNS.dt,\n      'xmlns:html': XLMLNS.html\n    });\n  }\n  /* [MS-OLEDS] 2.3.8 CompObjStream */\n  function parse_compobj(obj) {\n    var v = {};\n    var o = obj.content;\n    /* [MS-OLEDS] 2.3.7 CompObjHeader -- All fields MUST be ignored */\n    o.l = 28;\n    v.AnsiUserType = o.read_shift(0, \"lpstr-ansi\");\n    v.AnsiClipboardFormat = parse_ClipboardFormatOrAnsiString(o);\n    if (o.length - o.l <= 4) return v;\n    var m = o.read_shift(4);\n    if (m == 0 || m > 40) return v;\n    o.l -= 4;\n    v.Reserved1 = o.read_shift(0, \"lpstr-ansi\");\n    if (o.length - o.l <= 4) return v;\n    m = o.read_shift(4);\n    if (m !== 0x71b239f4) return v;\n    v.UnicodeClipboardFormat = parse_ClipboardFormatOrUnicodeString(o);\n    m = o.read_shift(4);\n    if (m == 0 || m > 40) return v;\n    o.l -= 4;\n    v.Reserved2 = o.read_shift(0, \"lpwstr\");\n  }\n\n  /*\n  \tContinue logic for:\n  \t- 2.4.58 Continue          0x003c\n  \t- 2.4.59 ContinueBigName   0x043c\n  \t- 2.4.60 ContinueFrt       0x0812\n  \t- 2.4.61 ContinueFrt11     0x0875\n  \t- 2.4.62 ContinueFrt12     0x087f\n  */\n  var CONTINUE_RT = [0x003c, 0x043c, 0x0812, 0x0875, 0x087f];\n  function slurp(RecordType, R, blob, length, opts) {\n    var l = length;\n    var bufs = [];\n    var d = blob.slice(blob.l, blob.l + l);\n    if (opts && opts.enc && opts.enc.insitu && d.length > 0) switch (RecordType) {\n      case 0x0009:\n      case 0x0209:\n      case 0x0409:\n      case 0x0809 /* BOF */:\n      case 0x002f /* FilePass */:\n      case 0x0195 /* FileLock */:\n      case 0x00e1 /* InterfaceHdr */:\n      case 0x0196 /* RRDInfo */:\n      case 0x0138 /* RRDHead */:\n      case 0x0194 /* UsrExcl */:\n      case 0x000a /* EOF */:\n        break;\n      case 0x0085 /* BoundSheet8 */:\n        break;\n      default:\n        opts.enc.insitu(d);\n    }\n    bufs.push(d);\n    blob.l += l;\n    var nextrt = __readUInt16LE(blob, blob.l),\n      next = XLSRecordEnum[nextrt];\n    var start = 0;\n    while (next != null && CONTINUE_RT.indexOf(nextrt) > -1) {\n      l = __readUInt16LE(blob, blob.l + 2);\n      start = blob.l + 4;\n      if (nextrt == 0x0812 /* ContinueFrt */) start += 4;else if (nextrt == 0x0875 || nextrt == 0x087f) {\n        start += 12;\n      }\n      d = blob.slice(start, blob.l + 4 + l);\n      bufs.push(d);\n      blob.l += 4 + l;\n      next = XLSRecordEnum[nextrt = __readUInt16LE(blob, blob.l)];\n    }\n    var b = bconcat(bufs);\n    prep_blob(b, 0);\n    var ll = 0;\n    b.lens = [];\n    for (var j = 0; j < bufs.length; ++j) {\n      b.lens.push(ll);\n      ll += bufs[j].length;\n    }\n    if (b.length < length) throw \"XLS Record 0x\" + RecordType.toString(16) + \" Truncated: \" + b.length + \" < \" + length;\n    return R.f(b, b.length, opts);\n  }\n  function safe_format_xf(p, opts, date1904) {\n    if (p.t === 'z') return;\n    if (!p.XF) return;\n    var fmtid = 0;\n    try {\n      fmtid = p.z || p.XF.numFmtId || 0;\n      if (opts.cellNF) p.z = table_fmt[fmtid];\n    } catch (e) {\n      if (opts.WTF) throw e;\n    }\n    if (!opts || opts.cellText !== false) try {\n      if (p.t === 'e') {\n        p.w = p.w || BErr[p.v];\n      } else if (fmtid === 0 || fmtid == \"General\") {\n        if (p.t === 'n') {\n          if ((p.v | 0) === p.v) p.w = p.v.toString(10);else p.w = SSF_general_num(p.v);\n        } else p.w = SSF_general(p.v);\n      } else p.w = SSF_format(fmtid, p.v, {\n        date1904: !!date1904,\n        dateNF: opts && opts.dateNF\n      });\n    } catch (e) {\n      if (opts.WTF) throw e;\n    }\n    if (opts.cellDates && fmtid && p.t == 'n' && fmt_is_date(table_fmt[fmtid] || String(fmtid))) {\n      var _d = SSF_parse_date_code(p.v);\n      if (_d) {\n        p.t = 'd';\n        p.v = new Date(_d.y, _d.m - 1, _d.d, _d.H, _d.M, _d.S, _d.u);\n      }\n    }\n  }\n  function make_cell(val, ixfe, t) {\n    return {\n      v: val,\n      ixfe: ixfe,\n      t: t\n    };\n  }\n\n  // 2.3.2\n  function parse_workbook(blob, options) {\n    var wb = {\n      opts: {}\n    };\n    var Sheets = {};\n    if (DENSE != null && options.dense == null) options.dense = DENSE;\n    var out = options.dense ? [] : {};\n    var Directory = {};\n    var range = {};\n    var last_formula = null;\n    var sst = [];\n    var cur_sheet = \"\";\n    var Preamble = {};\n    var lastcell,\n      last_cell = \"\",\n      cc,\n      cmnt,\n      rngC,\n      rngR;\n    var sharedf = {};\n    var arrayf = [];\n    var temp_val;\n    var country;\n    var XFs = []; /* XF records */\n    var palette = [];\n    var Workbook = {\n        Sheets: [],\n        WBProps: {\n          date1904: false\n        },\n        Views: [{}]\n      },\n      wsprops = {};\n    var get_rgb = function getrgb(icv) {\n      if (icv < 8) return XLSIcv[icv];\n      if (icv < 64) return palette[icv - 8] || XLSIcv[icv];\n      return XLSIcv[icv];\n    };\n    var process_cell_style = function pcs(cell, line, options) {\n      var xfd = line.XF.data;\n      if (!xfd || !xfd.patternType || !options || !options.cellStyles) return;\n      line.s = {};\n      line.s.patternType = xfd.patternType;\n      var t;\n      if (t = rgb2Hex(get_rgb(xfd.icvFore))) {\n        line.s.fgColor = {\n          rgb: t\n        };\n      }\n      if (t = rgb2Hex(get_rgb(xfd.icvBack))) {\n        line.s.bgColor = {\n          rgb: t\n        };\n      }\n    };\n    var addcell = function addcell(cell, line, options) {\n      if (file_depth > 1) return;\n      if (options.sheetRows && cell.r >= options.sheetRows) return;\n      if (options.cellStyles && line.XF && line.XF.data) process_cell_style(cell, line, options);\n      delete line.ixfe;\n      delete line.XF;\n      lastcell = cell;\n      last_cell = encode_cell(cell);\n      if (!range || !range.s || !range.e) range = {\n        s: {\n          r: 0,\n          c: 0\n        },\n        e: {\n          r: 0,\n          c: 0\n        }\n      };\n      if (cell.r < range.s.r) range.s.r = cell.r;\n      if (cell.c < range.s.c) range.s.c = cell.c;\n      if (cell.r + 1 > range.e.r) range.e.r = cell.r + 1;\n      if (cell.c + 1 > range.e.c) range.e.c = cell.c + 1;\n      if (options.cellFormula && line.f) {\n        for (var afi = 0; afi < arrayf.length; ++afi) {\n          if (arrayf[afi][0].s.c > cell.c || arrayf[afi][0].s.r > cell.r) continue;\n          if (arrayf[afi][0].e.c < cell.c || arrayf[afi][0].e.r < cell.r) continue;\n          line.F = encode_range(arrayf[afi][0]);\n          if (arrayf[afi][0].s.c != cell.c || arrayf[afi][0].s.r != cell.r) delete line.f;\n          if (line.f) line.f = \"\" + stringify_formula(arrayf[afi][1], range, cell, supbooks, opts);\n          break;\n        }\n      }\n      {\n        if (options.dense) {\n          if (!out[cell.r]) out[cell.r] = [];\n          out[cell.r][cell.c] = line;\n        } else out[last_cell] = line;\n      }\n    };\n    var opts = {\n      enc: false,\n      // encrypted\n      sbcch: 0,\n      // cch in the preceding SupBook\n      snames: [],\n      // sheetnames\n      sharedf: sharedf,\n      // shared formulae by address\n      arrayf: arrayf,\n      // array formulae array\n      rrtabid: [],\n      // RRTabId\n      lastuser: \"\",\n      // Last User from WriteAccess\n      biff: 8,\n      // BIFF version\n      codepage: 0,\n      // CP from CodePage record\n      winlocked: 0,\n      // fLockWn from WinProtect\n      cellStyles: !!options && !!options.cellStyles,\n      WTF: !!options && !!options.wtf\n    };\n    if (options.password) opts.password = options.password;\n    var themes;\n    var merges = [];\n    var objects = [];\n    var colinfo = [],\n      rowinfo = [];\n    var seencol = false;\n    var supbooks = []; // 1-indexed, will hold extern names\n    supbooks.SheetNames = opts.snames;\n    supbooks.sharedf = opts.sharedf;\n    supbooks.arrayf = opts.arrayf;\n    supbooks.names = [];\n    supbooks.XTI = [];\n    var last_RT = 0;\n    var file_depth = 0; /* TODO: make a real stack */\n    var BIFF2Fmt = 0,\n      BIFF2FmtTable = [];\n    var FilterDatabases = []; /* TODO: sort out supbooks and process elsewhere */\n    var last_lbl;\n\n    /* explicit override for some broken writers */\n    opts.codepage = 1200;\n    set_cp(1200);\n    var seen_codepage = false;\n    while (blob.l < blob.length - 1) {\n      var s = blob.l;\n      var RecordType = blob.read_shift(2);\n      if (RecordType === 0 && last_RT === 0x000a /* EOF */) break;\n      var length = blob.l === blob.length ? 0 : blob.read_shift(2);\n      var R = XLSRecordEnum[RecordType];\n      //console.log(RecordType.toString(16), RecordType, R, blob.l, length, blob.length);\n      //if(!R) console.log(blob.slice(blob.l, blob.l + length));\n      if (R && R.f) {\n        if (options.bookSheets) {\n          if (last_RT === 0x0085 /* BoundSheet8 */ && RecordType !== 0x0085 /* R.n !== 'BoundSheet8' */) break;\n        }\n        last_RT = RecordType;\n        if (R.r === 2 || R.r == 12) {\n          var rt = blob.read_shift(2);\n          length -= 2;\n          if (!opts.enc && rt !== RecordType && ((rt & 0xFF) << 8 | rt >> 8) !== RecordType) throw new Error(\"rt mismatch: \" + rt + \"!=\" + RecordType);\n          if (R.r == 12) {\n            blob.l += 10;\n            length -= 10;\n          } // skip FRT\n        }\n        //console.error(R,blob.l,length,blob.length);\n        var val = {};\n        if (RecordType === 0x000a /* EOF */) val = R.f(blob, length, opts);else val = slurp(RecordType, R, blob, length, opts);\n        if (file_depth == 0 && [0x0009, 0x0209, 0x0409, 0x0809].indexOf(last_RT) === -1 /* 'BOF' */) continue;\n        switch (RecordType) {\n          case 0x0022 /* Date1904 */:\n            wb.opts.Date1904 = Workbook.WBProps.date1904 = val;\n            break;\n          case 0x0086 /* WriteProtect */:\n            wb.opts.WriteProtect = true;\n            break;\n          case 0x002f /* FilePass */:\n            if (!opts.enc) blob.l = 0;\n            opts.enc = val;\n            if (!options.password) throw new Error(\"File is password-protected\");\n            if (val.valid == null) throw new Error(\"Encryption scheme unsupported\");\n            if (!val.valid) throw new Error(\"Password is incorrect\");\n            break;\n          case 0x005c /* WriteAccess */:\n            opts.lastuser = val;\n            break;\n          case 0x0042 /* CodePage */:\n            var cpval = Number(val);\n            /* overrides based on test cases */\n            switch (cpval) {\n              case 0x5212:\n                cpval = 1200;\n                break;\n              case 0x8000:\n                cpval = 10000;\n                break;\n              case 0x8001:\n                cpval = 1252;\n                break;\n            }\n            set_cp(opts.codepage = cpval);\n            seen_codepage = true;\n            break;\n          case 0x013d /* RRTabId */:\n            opts.rrtabid = val;\n            break;\n          case 0x0019 /* WinProtect */:\n            opts.winlocked = val;\n            break;\n          case 0x01b7 /* RefreshAll */:\n            wb.opts[\"RefreshAll\"] = val;\n            break;\n          case 0x000c /* CalcCount */:\n            wb.opts[\"CalcCount\"] = val;\n            break;\n          case 0x0010 /* CalcDelta */:\n            wb.opts[\"CalcDelta\"] = val;\n            break;\n          case 0x0011 /* CalcIter */:\n            wb.opts[\"CalcIter\"] = val;\n            break;\n          case 0x000d /* CalcMode */:\n            wb.opts[\"CalcMode\"] = val;\n            break;\n          case 0x000e /* CalcPrecision */:\n            wb.opts[\"CalcPrecision\"] = val;\n            break;\n          case 0x005f /* CalcSaveRecalc */:\n            wb.opts[\"CalcSaveRecalc\"] = val;\n            break;\n          case 0x000f /* CalcRefMode */:\n            opts.CalcRefMode = val;\n            break;\n          // TODO: implement R1C1\n          case 0x08a3 /* ForceFullCalculation */:\n            wb.opts.FullCalc = val;\n            break;\n          case 0x0081 /* WsBool */:\n            if (val.fDialog) out[\"!type\"] = \"dialog\";\n            if (!val.fBelow) (out[\"!outline\"] || (out[\"!outline\"] = {})).above = true;\n            if (!val.fRight) (out[\"!outline\"] || (out[\"!outline\"] = {})).left = true;\n            break;\n          // TODO\n          case 0x00e0 /* XF */:\n            XFs.push(val);\n            break;\n          case 0x01ae /* SupBook */:\n            supbooks.push([val]);\n            supbooks[supbooks.length - 1].XTI = [];\n            break;\n          case 0x0023:\n          case 0x0223 /* ExternName */:\n            supbooks[supbooks.length - 1].push(val);\n            break;\n          case 0x0018:\n          case 0x0218 /* Lbl */:\n            last_lbl = {\n              Name: val.Name,\n              Ref: stringify_formula(val.rgce, range, null, supbooks, opts)\n            };\n            if (val.itab > 0) last_lbl.Sheet = val.itab - 1;\n            supbooks.names.push(last_lbl);\n            if (!supbooks[0]) {\n              supbooks[0] = [];\n              supbooks[0].XTI = [];\n            }\n            supbooks[supbooks.length - 1].push(val);\n            if (val.Name == \"_xlnm._FilterDatabase\" && val.itab > 0) if (val.rgce && val.rgce[0] && val.rgce[0][0] && val.rgce[0][0][0] == 'PtgArea3d') FilterDatabases[val.itab - 1] = {\n              ref: encode_range(val.rgce[0][0][1][2])\n            };\n            break;\n          case 0x0016 /* ExternCount */:\n            opts.ExternCount = val;\n            break;\n          case 0x0017 /* ExternSheet */:\n            if (supbooks.length == 0) {\n              supbooks[0] = [];\n              supbooks[0].XTI = [];\n            }\n            supbooks[supbooks.length - 1].XTI = supbooks[supbooks.length - 1].XTI.concat(val);\n            supbooks.XTI = supbooks.XTI.concat(val);\n            break;\n          case 0x0894 /* NameCmt */:\n            /* TODO: search for correct name */\n            if (opts.biff < 8) break;\n            if (last_lbl != null) last_lbl.Comment = val[1];\n            break;\n          case 0x0012 /* Protect */:\n            out[\"!protect\"] = val;\n            break;\n          /* for sheet or book */\n          case 0x0013 /* Password */:\n            if (val !== 0 && opts.WTF) console.error(\"Password verifier: \" + val);\n            break;\n          case 0x0085 /* BoundSheet8 */:\n            {\n              Directory[val.pos] = val;\n              opts.snames.push(val.name);\n            }\n            break;\n          case 0x000a /* EOF */:\n            {\n              if (--file_depth) break;\n              if (range.e) {\n                if (range.e.r > 0 && range.e.c > 0) {\n                  range.e.r--;\n                  range.e.c--;\n                  out[\"!ref\"] = encode_range(range);\n                  if (options.sheetRows && options.sheetRows <= range.e.r) {\n                    var tmpri = range.e.r;\n                    range.e.r = options.sheetRows - 1;\n                    out[\"!fullref\"] = out[\"!ref\"];\n                    out[\"!ref\"] = encode_range(range);\n                    range.e.r = tmpri;\n                  }\n                  range.e.r++;\n                  range.e.c++;\n                }\n                if (merges.length > 0) out[\"!merges\"] = merges;\n                if (objects.length > 0) out[\"!objects\"] = objects;\n                if (colinfo.length > 0) out[\"!cols\"] = colinfo;\n                if (rowinfo.length > 0) out[\"!rows\"] = rowinfo;\n                Workbook.Sheets.push(wsprops);\n              }\n              if (cur_sheet === \"\") Preamble = out;else Sheets[cur_sheet] = out;\n              out = options.dense ? [] : {};\n            }\n            break;\n          case 0x0009:\n          case 0x0209:\n          case 0x0409:\n          case 0x0809 /* BOF */:\n            {\n              if (opts.biff === 8) opts.biff = {\n                0x0009: 2,\n                0x0209: 3,\n                0x0409: 4\n              }[RecordType] || {\n                0x0200: 2,\n                0x0300: 3,\n                0x0400: 4,\n                0x0500: 5,\n                0x0600: 8,\n                0x0002: 2,\n                0x0007: 2\n              }[val.BIFFVer] || 8;\n              opts.biffguess = val.BIFFVer == 0;\n              if (val.BIFFVer == 0 && val.dt == 0x1000) {\n                opts.biff = 5;\n                seen_codepage = true;\n                set_cp(opts.codepage = 28591);\n              }\n              if (opts.biff == 8 && val.BIFFVer == 0 && val.dt == 16) opts.biff = 2;\n              if (file_depth++) break;\n              out = options.dense ? [] : {};\n              if (opts.biff < 8 && !seen_codepage) {\n                seen_codepage = true;\n                set_cp(opts.codepage = options.codepage || 1252);\n              }\n              if (opts.biff < 5 || val.BIFFVer == 0 && val.dt == 0x1000) {\n                if (cur_sheet === \"\") cur_sheet = \"Sheet1\";\n                range = {\n                  s: {\n                    r: 0,\n                    c: 0\n                  },\n                  e: {\n                    r: 0,\n                    c: 0\n                  }\n                };\n                /* fake BoundSheet8 */\n                var fakebs8 = {\n                  pos: blob.l - length,\n                  name: cur_sheet\n                };\n                Directory[fakebs8.pos] = fakebs8;\n                opts.snames.push(cur_sheet);\n              } else cur_sheet = (Directory[s] || {\n                name: \"\"\n              }).name;\n              if (val.dt == 0x20) out[\"!type\"] = \"chart\";\n              if (val.dt == 0x40) out[\"!type\"] = \"macro\";\n              merges = [];\n              objects = [];\n              opts.arrayf = arrayf = [];\n              colinfo = [];\n              rowinfo = [];\n              seencol = false;\n              wsprops = {\n                Hidden: (Directory[s] || {\n                  hs: 0\n                }).hs,\n                name: cur_sheet\n              };\n            }\n            break;\n          case 0x0203 /* Number */:\n          case 0x0003 /* BIFF2NUM */:\n          case 0x0002 /* BIFF2INT */:\n            {\n              if (out[\"!type\"] == \"chart\") if (options.dense ? (out[val.r] || [])[val.c] : out[encode_cell({\n                c: val.c,\n                r: val.r\n              })]) ++val.c;\n              temp_val = {\n                ixfe: val.ixfe,\n                XF: XFs[val.ixfe] || {},\n                v: val.val,\n                t: 'n'\n              };\n              if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n              safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell({\n                c: val.c,\n                r: val.r\n              }, temp_val, options);\n            }\n            break;\n          case 0x0005:\n          case 0x0205 /* BoolErr */:\n            {\n              temp_val = {\n                ixfe: val.ixfe,\n                XF: XFs[val.ixfe],\n                v: val.val,\n                t: val.t\n              };\n              if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n              safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell({\n                c: val.c,\n                r: val.r\n              }, temp_val, options);\n            }\n            break;\n          case 0x027e /* RK */:\n            {\n              temp_val = {\n                ixfe: val.ixfe,\n                XF: XFs[val.ixfe],\n                v: val.rknum,\n                t: 'n'\n              };\n              if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n              safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell({\n                c: val.c,\n                r: val.r\n              }, temp_val, options);\n            }\n            break;\n          case 0x00bd /* MulRk */:\n            {\n              for (var j = val.c; j <= val.C; ++j) {\n                var ixfe = val.rkrec[j - val.c][0];\n                temp_val = {\n                  ixfe: ixfe,\n                  XF: XFs[ixfe],\n                  v: val.rkrec[j - val.c][1],\n                  t: 'n'\n                };\n                if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n                safe_format_xf(temp_val, options, wb.opts.Date1904);\n                addcell({\n                  c: j,\n                  r: val.r\n                }, temp_val, options);\n              }\n            }\n            break;\n          case 0x0006:\n          case 0x0206:\n          case 0x0406 /* Formula */:\n            {\n              if (val.val == 'String') {\n                last_formula = val;\n                break;\n              }\n              temp_val = make_cell(val.val, val.cell.ixfe, val.tt);\n              temp_val.XF = XFs[temp_val.ixfe];\n              if (options.cellFormula) {\n                var _f = val.formula;\n                if (_f && _f[0] && _f[0][0] && _f[0][0][0] == 'PtgExp') {\n                  var _fr = _f[0][0][1][0],\n                    _fc = _f[0][0][1][1];\n                  var _fe = encode_cell({\n                    r: _fr,\n                    c: _fc\n                  });\n                  if (sharedf[_fe]) temp_val.f = \"\" + stringify_formula(val.formula, range, val.cell, supbooks, opts);else temp_val.F = ((options.dense ? (out[_fr] || [])[_fc] : out[_fe]) || {}).F;\n                } else temp_val.f = \"\" + stringify_formula(val.formula, range, val.cell, supbooks, opts);\n              }\n              if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n              safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell(val.cell, temp_val, options);\n              last_formula = val;\n            }\n            break;\n          case 0x0007:\n          case 0x0207 /* String */:\n            {\n              if (last_formula) {\n                /* technically always true */\n                last_formula.val = val;\n                temp_val = make_cell(val, last_formula.cell.ixfe, 's');\n                temp_val.XF = XFs[temp_val.ixfe];\n                if (options.cellFormula) {\n                  temp_val.f = \"\" + stringify_formula(last_formula.formula, range, last_formula.cell, supbooks, opts);\n                }\n                if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n                safe_format_xf(temp_val, options, wb.opts.Date1904);\n                addcell(last_formula.cell, temp_val, options);\n                last_formula = null;\n              } else throw new Error(\"String record expects Formula\");\n            }\n            break;\n          case 0x0021:\n          case 0x0221 /* Array */:\n            {\n              arrayf.push(val);\n              var _arraystart = encode_cell(val[0].s);\n              cc = options.dense ? (out[val[0].s.r] || [])[val[0].s.c] : out[_arraystart];\n              if (options.cellFormula && cc) {\n                if (!last_formula) break; /* technically unreachable */\n                if (!_arraystart || !cc) break;\n                cc.f = \"\" + stringify_formula(val[1], range, val[0], supbooks, opts);\n                cc.F = encode_range(val[0]);\n              }\n            }\n            break;\n          case 0x04bc /* ShrFmla */:\n            {\n              if (!options.cellFormula) break;\n              if (last_cell) {\n                /* TODO: capture range */\n                if (!last_formula) break; /* technically unreachable */\n                sharedf[encode_cell(last_formula.cell)] = val[0];\n                cc = options.dense ? (out[last_formula.cell.r] || [])[last_formula.cell.c] : out[encode_cell(last_formula.cell)];\n                (cc || {}).f = \"\" + stringify_formula(val[0], range, lastcell, supbooks, opts);\n              }\n            }\n            break;\n          case 0x00fd /* LabelSst */:\n            temp_val = make_cell(sst[val.isst].t, val.ixfe, 's');\n            if (sst[val.isst].h) temp_val.h = sst[val.isst].h;\n            temp_val.XF = XFs[temp_val.ixfe];\n            if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell({\n              c: val.c,\n              r: val.r\n            }, temp_val, options);\n            break;\n          case 0x0201 /* Blank */:\n            if (options.sheetStubs) {\n              temp_val = {\n                ixfe: val.ixfe,\n                XF: XFs[val.ixfe],\n                t: 'z'\n              };\n              if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n              safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell({\n                c: val.c,\n                r: val.r\n              }, temp_val, options);\n            }\n            break;\n          case 0x00be /* MulBlank */:\n            if (options.sheetStubs) {\n              for (var _j = val.c; _j <= val.C; ++_j) {\n                var _ixfe = val.ixfe[_j - val.c];\n                temp_val = {\n                  ixfe: _ixfe,\n                  XF: XFs[_ixfe],\n                  t: 'z'\n                };\n                if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n                safe_format_xf(temp_val, options, wb.opts.Date1904);\n                addcell({\n                  c: _j,\n                  r: val.r\n                }, temp_val, options);\n              }\n            }\n            break;\n          case 0x00d6 /* RString */:\n          case 0x0204 /* Label */:\n          case 0x0004 /* BIFF2STR */:\n            temp_val = make_cell(val.val, val.ixfe, 's');\n            temp_val.XF = XFs[temp_val.ixfe];\n            if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell({\n              c: val.c,\n              r: val.r\n            }, temp_val, options);\n            break;\n          case 0x0000:\n          case 0x0200 /* Dimensions */:\n            {\n              if (file_depth === 1) range = val; /* TODO: stack */\n            }\n            break;\n          case 0x00fc /* SST */:\n            {\n              sst = val;\n            }\n            break;\n          case 0x041e /* Format */:\n            {\n              /* val = [id, fmt] */\n              if (opts.biff == 4) {\n                BIFF2FmtTable[BIFF2Fmt++] = val[1];\n                for (var b4idx = 0; b4idx < BIFF2Fmt + 163; ++b4idx) if (table_fmt[b4idx] == val[1]) break;\n                if (b4idx >= 163) SSF_load(val[1], BIFF2Fmt + 163);\n              } else SSF_load(val[1], val[0]);\n            }\n            break;\n          case 0x001e /* BIFF2FORMAT */:\n            {\n              BIFF2FmtTable[BIFF2Fmt++] = val;\n              for (var b2idx = 0; b2idx < BIFF2Fmt + 163; ++b2idx) if (table_fmt[b2idx] == val) break;\n              if (b2idx >= 163) SSF_load(val, BIFF2Fmt + 163);\n            }\n            break;\n          case 0x00e5 /* MergeCells */:\n            merges = merges.concat(val);\n            break;\n          case 0x005d /* Obj */:\n            objects[val.cmo[0]] = opts.lastobj = val;\n            break;\n          case 0x01b6 /* TxO */:\n            opts.lastobj.TxO = val;\n            break;\n          case 0x007f /* ImData */:\n            opts.lastobj.ImData = val;\n            break;\n          case 0x01b8 /* HLink */:\n            {\n              for (rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR) for (rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\n                cc = options.dense ? (out[rngR] || [])[rngC] : out[encode_cell({\n                  c: rngC,\n                  r: rngR\n                })];\n                if (cc) cc.l = val[1];\n              }\n            }\n            break;\n          case 0x0800 /* HLinkTooltip */:\n            {\n              for (rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR) for (rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\n                cc = options.dense ? (out[rngR] || [])[rngC] : out[encode_cell({\n                  c: rngC,\n                  r: rngR\n                })];\n                if (cc && cc.l) cc.l.Tooltip = val[1];\n              }\n            }\n            break;\n          case 0x001c /* Note */:\n            {\n              if (opts.biff <= 5 && opts.biff >= 2) break; /* TODO: BIFF5 */\n              cc = options.dense ? (out[val[0].r] || [])[val[0].c] : out[encode_cell(val[0])];\n              var noteobj = objects[val[2]];\n              if (!cc) {\n                if (options.dense) {\n                  if (!out[val[0].r]) out[val[0].r] = [];\n                  cc = out[val[0].r][val[0].c] = {\n                    t: \"z\"\n                  };\n                } else {\n                  cc = out[encode_cell(val[0])] = {\n                    t: \"z\"\n                  };\n                }\n                range.e.r = Math.max(range.e.r, val[0].r);\n                range.s.r = Math.min(range.s.r, val[0].r);\n                range.e.c = Math.max(range.e.c, val[0].c);\n                range.s.c = Math.min(range.s.c, val[0].c);\n              }\n              if (!cc.c) cc.c = [];\n              cmnt = {\n                a: val[1],\n                t: noteobj.TxO.t\n              };\n              cc.c.push(cmnt);\n            }\n            break;\n          case 0x087d /* XFExt */:\n            update_xfext(XFs[val.ixfe], val.ext);\n            break;\n          case 0x007d /* ColInfo */:\n            {\n              if (!opts.cellStyles) break;\n              while (val.e >= val.s) {\n                colinfo[val.e--] = {\n                  width: val.w / 256,\n                  level: val.level || 0,\n                  hidden: !!(val.flags & 1)\n                };\n                if (!seencol) {\n                  seencol = true;\n                  find_mdw_colw(val.w / 256);\n                }\n                process_col(colinfo[val.e + 1]);\n              }\n            }\n            break;\n          case 0x0208 /* Row */:\n            {\n              var rowobj = {};\n              if (val.level != null) {\n                rowinfo[val.r] = rowobj;\n                rowobj.level = val.level;\n              }\n              if (val.hidden) {\n                rowinfo[val.r] = rowobj;\n                rowobj.hidden = true;\n              }\n              if (val.hpt) {\n                rowinfo[val.r] = rowobj;\n                rowobj.hpt = val.hpt;\n                rowobj.hpx = pt2px(val.hpt);\n              }\n            }\n            break;\n          case 0x0026 /* LeftMargin */:\n          case 0x0027 /* RightMargin */:\n          case 0x0028 /* TopMargin */:\n          case 0x0029 /* BottomMargin */:\n            if (!out['!margins']) default_margins(out['!margins'] = {});\n            out['!margins'][{\n              0x26: \"left\",\n              0x27: \"right\",\n              0x28: \"top\",\n              0x29: \"bottom\"\n            }[RecordType]] = val;\n            break;\n          case 0x00a1 /* Setup */:\n            // TODO\n            if (!out['!margins']) default_margins(out['!margins'] = {});\n            out['!margins'].header = val.header;\n            out['!margins'].footer = val.footer;\n            break;\n          case 0x023e /* Window2 */:\n            // TODO\n            // $FlowIgnore\n            if (val.RTL) Workbook.Views[0].RTL = true;\n            break;\n          case 0x0092 /* Palette */:\n            palette = val;\n            break;\n          case 0x0896 /* Theme */:\n            themes = val;\n            break;\n          case 0x008c /* Country */:\n            country = val;\n            break;\n          case 0x01ba /* CodeName */:\n            {\n              if (!cur_sheet) Workbook.WBProps.CodeName = val || \"ThisWorkbook\";else wsprops.CodeName = val || wsprops.name;\n            }\n            break;\n        }\n      } else {\n        if (!R) console.error(\"Missing Info for XLS Record 0x\" + RecordType.toString(16));\n        blob.l += length;\n      }\n    }\n    wb.SheetNames = keys(Directory).sort(function (a, b) {\n      return Number(a) - Number(b);\n    }).map(function (x) {\n      return Directory[x].name;\n    });\n    if (!options.bookSheets) wb.Sheets = Sheets;\n    if (!wb.SheetNames.length && Preamble[\"!ref\"]) {\n      wb.SheetNames.push(\"Sheet1\");\n      /*jshint -W069 */\n      if (wb.Sheets) wb.Sheets[\"Sheet1\"] = Preamble;\n      /*jshint +W069 */\n    } else wb.Preamble = Preamble;\n    if (wb.Sheets) FilterDatabases.forEach(function (r, i) {\n      wb.Sheets[wb.SheetNames[i]]['!autofilter'] = r;\n    });\n    wb.Strings = sst;\n    wb.SSF = dup(table_fmt);\n    if (opts.enc) wb.Encryption = opts.enc;\n    if (themes) wb.Themes = themes;\n    wb.Metadata = {};\n    if (country !== undefined) wb.Metadata.Country = country;\n    if (supbooks.names.length > 0) Workbook.Names = supbooks.names;\n    wb.Workbook = Workbook;\n    return wb;\n  }\n\n  /* TODO: split props*/\n  var PSCLSID = {\n    SI: \"e0859ff2f94f6810ab9108002b27b3d9\",\n    DSI: \"02d5cdd59c2e1b10939708002b2cf9ae\",\n    UDI: \"05d5cdd59c2e1b10939708002b2cf9ae\"\n  };\n  function parse_xls_props(cfb, props, o) {\n    /* [MS-OSHARED] 2.3.3.2.2 Document Summary Information Property Set */\n    var DSI = CFB.find(cfb, '/!DocumentSummaryInformation');\n    if (DSI && DSI.size > 0) try {\n      var DocSummary = parse_PropertySetStream(DSI, DocSummaryPIDDSI, PSCLSID.DSI);\n      for (var d in DocSummary) props[d] = DocSummary[d];\n    } catch (e) {\n      if (o.WTF) throw e; /* empty */\n    }\n\n    /* [MS-OSHARED] 2.3.3.2.1 Summary Information Property Set*/\n    var SI = CFB.find(cfb, '/!SummaryInformation');\n    if (SI && SI.size > 0) try {\n      var Summary = parse_PropertySetStream(SI, SummaryPIDSI, PSCLSID.SI);\n      for (var s in Summary) if (props[s] == null) props[s] = Summary[s];\n    } catch (e) {\n      if (o.WTF) throw e; /* empty */\n    }\n\n    if (props.HeadingPairs && props.TitlesOfParts) {\n      load_props_pairs(props.HeadingPairs, props.TitlesOfParts, props, o);\n      delete props.HeadingPairs;\n      delete props.TitlesOfParts;\n    }\n  }\n  function write_xls_props(wb, cfb) {\n    var DSEntries = [],\n      SEntries = [],\n      CEntries = [];\n    var i = 0,\n      Keys;\n    var DocSummaryRE = evert_key(DocSummaryPIDDSI, \"n\");\n    var SummaryRE = evert_key(SummaryPIDSI, \"n\");\n    if (wb.Props) {\n      Keys = keys(wb.Props);\n      // $FlowIgnore\n      for (i = 0; i < Keys.length; ++i) (Object.prototype.hasOwnProperty.call(DocSummaryRE, Keys[i]) ? DSEntries : Object.prototype.hasOwnProperty.call(SummaryRE, Keys[i]) ? SEntries : CEntries).push([Keys[i], wb.Props[Keys[i]]]);\n    }\n    if (wb.Custprops) {\n      Keys = keys(wb.Custprops);\n      // $FlowIgnore\n      for (i = 0; i < Keys.length; ++i) if (!Object.prototype.hasOwnProperty.call(wb.Props || {}, Keys[i])) (Object.prototype.hasOwnProperty.call(DocSummaryRE, Keys[i]) ? DSEntries : Object.prototype.hasOwnProperty.call(SummaryRE, Keys[i]) ? SEntries : CEntries).push([Keys[i], wb.Custprops[Keys[i]]]);\n    }\n    var CEntries2 = [];\n    for (i = 0; i < CEntries.length; ++i) {\n      if (XLSPSSkip.indexOf(CEntries[i][0]) > -1 || PseudoPropsPairs.indexOf(CEntries[i][0]) > -1) continue;\n      if (CEntries[i][1] == null) continue;\n      CEntries2.push(CEntries[i]);\n    }\n    if (SEntries.length) CFB.utils.cfb_add(cfb, \"/\\u0005SummaryInformation\", write_PropertySetStream(SEntries, PSCLSID.SI, SummaryRE, SummaryPIDSI));\n    if (DSEntries.length || CEntries2.length) CFB.utils.cfb_add(cfb, \"/\\u0005DocumentSummaryInformation\", write_PropertySetStream(DSEntries, PSCLSID.DSI, DocSummaryRE, DocSummaryPIDDSI, CEntries2.length ? CEntries2 : null, PSCLSID.UDI));\n  }\n  function parse_xlscfb(cfb, options) {\n    if (!options) options = {};\n    fix_read_opts(options);\n    reset_cp();\n    if (options.codepage) set_ansi(options.codepage);\n    var CompObj, WB;\n    if (cfb.FullPaths) {\n      if (CFB.find(cfb, '/encryption')) throw new Error(\"File is password-protected\");\n      CompObj = CFB.find(cfb, '!CompObj');\n      WB = CFB.find(cfb, '/Workbook') || CFB.find(cfb, '/Book');\n    } else {\n      switch (options.type) {\n        case 'base64':\n          cfb = s2a(Base64_decode(cfb));\n          break;\n        case 'binary':\n          cfb = s2a(cfb);\n          break;\n        case 'buffer':\n          break;\n        case 'array':\n          if (!Array.isArray(cfb)) cfb = Array.prototype.slice.call(cfb);\n          break;\n      }\n      prep_blob(cfb, 0);\n      WB = {\n        content: cfb\n      };\n    }\n    var WorkbookP;\n    var _data;\n    if (CompObj) parse_compobj(CompObj);\n    if (options.bookProps && !options.bookSheets) WorkbookP = {};else {\n      var T = has_buf ? 'buffer' : 'array';\n      if (WB && WB.content) WorkbookP = parse_workbook(WB.content, options);\n      /* Quattro Pro 7-8 */else if ((_data = CFB.find(cfb, 'PerfectOffice_MAIN')) && _data.content) WorkbookP = WK_.to_workbook(_data.content, (options.type = T, options));\n      /* Quattro Pro 9 */else if ((_data = CFB.find(cfb, 'NativeContent_MAIN')) && _data.content) WorkbookP = WK_.to_workbook(_data.content, (options.type = T, options));\n      /* Works 4 for Mac */else if ((_data = CFB.find(cfb, 'MN0')) && _data.content) throw new Error(\"Unsupported Works 4 for Mac file\");else throw new Error(\"Cannot find Workbook stream\");\n      if (options.bookVBA && cfb.FullPaths && CFB.find(cfb, '/_VBA_PROJECT_CUR/VBA/dir')) WorkbookP.vbaraw = make_vba_xls(cfb);\n    }\n    var props = {};\n    if (cfb.FullPaths) parse_xls_props(cfb, props, options);\n    WorkbookP.Props = WorkbookP.Custprops = props; /* TODO: split up properties */\n    if (options.bookFiles) WorkbookP.cfb = cfb;\n    /*WorkbookP.CompObjP = CompObjP; // TODO: storage? */\n    return WorkbookP;\n  }\n  function write_xlscfb(wb, opts) {\n    var o = opts || {};\n    var cfb = CFB.utils.cfb_new({\n      root: \"R\"\n    });\n    var wbpath = \"/Workbook\";\n    switch (o.bookType || \"xls\") {\n      case \"xls\":\n        o.bookType = \"biff8\";\n      /* falls through */\n      case \"xla\":\n        if (!o.bookType) o.bookType = \"xla\";\n      /* falls through */\n      case \"biff8\":\n        wbpath = \"/Workbook\";\n        o.biff = 8;\n        break;\n      case \"biff5\":\n        wbpath = \"/Book\";\n        o.biff = 5;\n        break;\n      default:\n        throw new Error(\"invalid type \" + o.bookType + \" for XLS CFB\");\n    }\n    CFB.utils.cfb_add(cfb, wbpath, write_biff_buf(wb, o));\n    if (o.biff == 8 && (wb.Props || wb.Custprops)) write_xls_props(wb, cfb);\n    // TODO: SI, DSI, CO\n    if (o.biff == 8 && wb.vbaraw) fill_vba_xls(cfb, CFB.read(wb.vbaraw, {\n      type: typeof wb.vbaraw == \"string\" ? \"binary\" : \"buffer\"\n    }));\n    return cfb;\n  }\n  /* [MS-XLSB] 2.3 Record Enumeration */\n  var XLSBRecordEnum = {\n    0x0000: {\n      /* n:\"BrtRowHdr\", */f: parse_BrtRowHdr\n    },\n    0x0001: {\n      /* n:\"BrtCellBlank\", */f: parse_BrtCellBlank\n    },\n    0x0002: {\n      /* n:\"BrtCellRk\", */f: parse_BrtCellRk\n    },\n    0x0003: {\n      /* n:\"BrtCellError\", */f: parse_BrtCellError\n    },\n    0x0004: {\n      /* n:\"BrtCellBool\", */f: parse_BrtCellBool\n    },\n    0x0005: {\n      /* n:\"BrtCellReal\", */f: parse_BrtCellReal\n    },\n    0x0006: {\n      /* n:\"BrtCellSt\", */f: parse_BrtCellSt\n    },\n    0x0007: {\n      /* n:\"BrtCellIsst\", */f: parse_BrtCellIsst\n    },\n    0x0008: {\n      /* n:\"BrtFmlaString\", */f: parse_BrtFmlaString\n    },\n    0x0009: {\n      /* n:\"BrtFmlaNum\", */f: parse_BrtFmlaNum\n    },\n    0x000A: {\n      /* n:\"BrtFmlaBool\", */f: parse_BrtFmlaBool\n    },\n    0x000B: {\n      /* n:\"BrtFmlaError\", */f: parse_BrtFmlaError\n    },\n    0x000C: {\n      /* n:\"BrtShortBlank\", */f: parse_BrtShortBlank\n    },\n    0x000D: {\n      /* n:\"BrtShortRk\", */f: parse_BrtShortRk\n    },\n    0x000E: {\n      /* n:\"BrtShortError\", */f: parse_BrtShortError\n    },\n    0x000F: {\n      /* n:\"BrtShortBool\", */f: parse_BrtShortBool\n    },\n    0x0010: {\n      /* n:\"BrtShortReal\", */f: parse_BrtShortReal\n    },\n    0x0011: {\n      /* n:\"BrtShortSt\", */f: parse_BrtShortSt\n    },\n    0x0012: {\n      /* n:\"BrtShortIsst\", */f: parse_BrtShortIsst\n    },\n    0x0013: {\n      /* n:\"BrtSSTItem\", */f: parse_RichStr\n    },\n    0x0014: {/* n:\"BrtPCDIMissing\" */},\n    0x0015: {/* n:\"BrtPCDINumber\" */},\n    0x0016: {/* n:\"BrtPCDIBoolean\" */},\n    0x0017: {/* n:\"BrtPCDIError\" */},\n    0x0018: {/* n:\"BrtPCDIString\" */},\n    0x0019: {/* n:\"BrtPCDIDatetime\" */},\n    0x001A: {/* n:\"BrtPCDIIndex\" */},\n    0x001B: {/* n:\"BrtPCDIAMissing\" */},\n    0x001C: {/* n:\"BrtPCDIANumber\" */},\n    0x001D: {/* n:\"BrtPCDIABoolean\" */},\n    0x001E: {/* n:\"BrtPCDIAError\" */},\n    0x001F: {/* n:\"BrtPCDIAString\" */},\n    0x0020: {/* n:\"BrtPCDIADatetime\" */},\n    0x0021: {/* n:\"BrtPCRRecord\" */},\n    0x0022: {/* n:\"BrtPCRRecordDt\" */},\n    0x0023: {\n      /* n:\"BrtFRTBegin\", */T: 1\n    },\n    0x0024: {\n      /* n:\"BrtFRTEnd\", */T: -1\n    },\n    0x0025: {\n      /* n:\"BrtACBegin\", */T: 1\n    },\n    0x0026: {\n      /* n:\"BrtACEnd\", */T: -1\n    },\n    0x0027: {\n      /* n:\"BrtName\", */f: parse_BrtName\n    },\n    0x0028: {/* n:\"BrtIndexRowBlock\" */},\n    0x002A: {/* n:\"BrtIndexBlock\" */},\n    0x002B: {\n      /* n:\"BrtFont\", */f: parse_BrtFont\n    },\n    0x002C: {\n      /* n:\"BrtFmt\", */f: parse_BrtFmt\n    },\n    0x002D: {\n      /* n:\"BrtFill\", */f: parse_BrtFill\n    },\n    0x002E: {\n      /* n:\"BrtBorder\", */f: parse_BrtBorder\n    },\n    0x002F: {\n      /* n:\"BrtXF\", */f: parse_BrtXF\n    },\n    0x0030: {/* n:\"BrtStyle\" */},\n    0x0031: {\n      /* n:\"BrtCellMeta\", */f: parse_Int32LE\n    },\n    0x0032: {/* n:\"BrtValueMeta\" */},\n    0x0033: {\n      /* n:\"BrtMdb\" */f: parse_BrtMdb\n    },\n    0x0034: {\n      /* n:\"BrtBeginFmd\", */T: 1\n    },\n    0x0035: {\n      /* n:\"BrtEndFmd\", */T: -1\n    },\n    0x0036: {\n      /* n:\"BrtBeginMdx\", */T: 1\n    },\n    0x0037: {\n      /* n:\"BrtEndMdx\", */T: -1\n    },\n    0x0038: {\n      /* n:\"BrtBeginMdxTuple\", */T: 1\n    },\n    0x0039: {\n      /* n:\"BrtEndMdxTuple\", */T: -1\n    },\n    0x003A: {/* n:\"BrtMdxMbrIstr\" */},\n    0x003B: {/* n:\"BrtStr\" */},\n    0x003C: {\n      /* n:\"BrtColInfo\", */f: parse_ColInfo\n    },\n    0x003E: {\n      /* n:\"BrtCellRString\", */f: parse_BrtCellRString\n    },\n    0x003F: {\n      /* n:\"BrtCalcChainItem$\", */f: parse_BrtCalcChainItem$\n    },\n    0x0040: {\n      /* n:\"BrtDVal\", */f: parse_BrtDVal\n    },\n    0x0041: {/* n:\"BrtSxvcellNum\" */},\n    0x0042: {/* n:\"BrtSxvcellStr\" */},\n    0x0043: {/* n:\"BrtSxvcellBool\" */},\n    0x0044: {/* n:\"BrtSxvcellErr\" */},\n    0x0045: {/* n:\"BrtSxvcellDate\" */},\n    0x0046: {/* n:\"BrtSxvcellNil\" */},\n    0x0080: {/* n:\"BrtFileVersion\" */},\n    0x0081: {\n      /* n:\"BrtBeginSheet\", */T: 1\n    },\n    0x0082: {\n      /* n:\"BrtEndSheet\", */T: -1\n    },\n    0x0083: {\n      /* n:\"BrtBeginBook\", */T: 1,\n      f: parsenoop,\n      p: 0\n    },\n    0x0084: {\n      /* n:\"BrtEndBook\", */T: -1\n    },\n    0x0085: {\n      /* n:\"BrtBeginWsViews\", */T: 1\n    },\n    0x0086: {\n      /* n:\"BrtEndWsViews\", */T: -1\n    },\n    0x0087: {\n      /* n:\"BrtBeginBookViews\", */T: 1\n    },\n    0x0088: {\n      /* n:\"BrtEndBookViews\", */T: -1\n    },\n    0x0089: {\n      /* n:\"BrtBeginWsView\", */T: 1,\n      f: parse_BrtBeginWsView\n    },\n    0x008A: {\n      /* n:\"BrtEndWsView\", */T: -1\n    },\n    0x008B: {\n      /* n:\"BrtBeginCsViews\", */T: 1\n    },\n    0x008C: {\n      /* n:\"BrtEndCsViews\", */T: -1\n    },\n    0x008D: {\n      /* n:\"BrtBeginCsView\", */T: 1\n    },\n    0x008E: {\n      /* n:\"BrtEndCsView\", */T: -1\n    },\n    0x008F: {\n      /* n:\"BrtBeginBundleShs\", */T: 1\n    },\n    0x0090: {\n      /* n:\"BrtEndBundleShs\", */T: -1\n    },\n    0x0091: {\n      /* n:\"BrtBeginSheetData\", */T: 1\n    },\n    0x0092: {\n      /* n:\"BrtEndSheetData\", */T: -1\n    },\n    0x0093: {\n      /* n:\"BrtWsProp\", */f: parse_BrtWsProp\n    },\n    0x0094: {\n      /* n:\"BrtWsDim\", */f: parse_BrtWsDim,\n      p: 16\n    },\n    0x0097: {\n      /* n:\"BrtPane\", */f: parse_BrtPane\n    },\n    0x0098: {/* n:\"BrtSel\" */},\n    0x0099: {\n      /* n:\"BrtWbProp\", */f: parse_BrtWbProp\n    },\n    0x009A: {/* n:\"BrtWbFactoid\" */},\n    0x009B: {/* n:\"BrtFileRecover\" */},\n    0x009C: {\n      /* n:\"BrtBundleSh\", */f: parse_BrtBundleSh\n    },\n    0x009D: {/* n:\"BrtCalcProp\" */},\n    0x009E: {/* n:\"BrtBookView\" */},\n    0x009F: {\n      /* n:\"BrtBeginSst\", */T: 1,\n      f: parse_BrtBeginSst\n    },\n    0x00A0: {\n      /* n:\"BrtEndSst\", */T: -1\n    },\n    0x00A1: {\n      /* n:\"BrtBeginAFilter\", */T: 1,\n      f: parse_UncheckedRfX\n    },\n    0x00A2: {\n      /* n:\"BrtEndAFilter\", */T: -1\n    },\n    0x00A3: {\n      /* n:\"BrtBeginFilterColumn\", */T: 1\n    },\n    0x00A4: {\n      /* n:\"BrtEndFilterColumn\", */T: -1\n    },\n    0x00A5: {\n      /* n:\"BrtBeginFilters\", */T: 1\n    },\n    0x00A6: {\n      /* n:\"BrtEndFilters\", */T: -1\n    },\n    0x00A7: {/* n:\"BrtFilter\" */},\n    0x00A8: {/* n:\"BrtColorFilter\" */},\n    0x00A9: {/* n:\"BrtIconFilter\" */},\n    0x00AA: {/* n:\"BrtTop10Filter\" */},\n    0x00AB: {/* n:\"BrtDynamicFilter\" */},\n    0x00AC: {\n      /* n:\"BrtBeginCustomFilters\", */T: 1\n    },\n    0x00AD: {\n      /* n:\"BrtEndCustomFilters\", */T: -1\n    },\n    0x00AE: {/* n:\"BrtCustomFilter\" */},\n    0x00AF: {/* n:\"BrtAFilterDateGroupItem\" */},\n    0x00B0: {\n      /* n:\"BrtMergeCell\", */f: parse_BrtMergeCell\n    },\n    0x00B1: {\n      /* n:\"BrtBeginMergeCells\", */T: 1\n    },\n    0x00B2: {\n      /* n:\"BrtEndMergeCells\", */T: -1\n    },\n    0x00B3: {\n      /* n:\"BrtBeginPivotCacheDef\", */T: 1\n    },\n    0x00B4: {\n      /* n:\"BrtEndPivotCacheDef\", */T: -1\n    },\n    0x00B5: {\n      /* n:\"BrtBeginPCDFields\", */T: 1\n    },\n    0x00B6: {\n      /* n:\"BrtEndPCDFields\", */T: -1\n    },\n    0x00B7: {\n      /* n:\"BrtBeginPCDField\", */T: 1\n    },\n    0x00B8: {\n      /* n:\"BrtEndPCDField\", */T: -1\n    },\n    0x00B9: {\n      /* n:\"BrtBeginPCDSource\", */T: 1\n    },\n    0x00BA: {\n      /* n:\"BrtEndPCDSource\", */T: -1\n    },\n    0x00BB: {\n      /* n:\"BrtBeginPCDSRange\", */T: 1\n    },\n    0x00BC: {\n      /* n:\"BrtEndPCDSRange\", */T: -1\n    },\n    0x00BD: {\n      /* n:\"BrtBeginPCDFAtbl\", */T: 1\n    },\n    0x00BE: {\n      /* n:\"BrtEndPCDFAtbl\", */T: -1\n    },\n    0x00BF: {\n      /* n:\"BrtBeginPCDIRun\", */T: 1\n    },\n    0x00C0: {\n      /* n:\"BrtEndPCDIRun\", */T: -1\n    },\n    0x00C1: {\n      /* n:\"BrtBeginPivotCacheRecords\", */T: 1\n    },\n    0x00C2: {\n      /* n:\"BrtEndPivotCacheRecords\", */T: -1\n    },\n    0x00C3: {\n      /* n:\"BrtBeginPCDHierarchies\", */T: 1\n    },\n    0x00C4: {\n      /* n:\"BrtEndPCDHierarchies\", */T: -1\n    },\n    0x00C5: {\n      /* n:\"BrtBeginPCDHierarchy\", */T: 1\n    },\n    0x00C6: {\n      /* n:\"BrtEndPCDHierarchy\", */T: -1\n    },\n    0x00C7: {\n      /* n:\"BrtBeginPCDHFieldsUsage\", */T: 1\n    },\n    0x00C8: {\n      /* n:\"BrtEndPCDHFieldsUsage\", */T: -1\n    },\n    0x00C9: {\n      /* n:\"BrtBeginExtConnection\", */T: 1\n    },\n    0x00CA: {\n      /* n:\"BrtEndExtConnection\", */T: -1\n    },\n    0x00CB: {\n      /* n:\"BrtBeginECDbProps\", */T: 1\n    },\n    0x00CC: {\n      /* n:\"BrtEndECDbProps\", */T: -1\n    },\n    0x00CD: {\n      /* n:\"BrtBeginECOlapProps\", */T: 1\n    },\n    0x00CE: {\n      /* n:\"BrtEndECOlapProps\", */T: -1\n    },\n    0x00CF: {\n      /* n:\"BrtBeginPCDSConsol\", */T: 1\n    },\n    0x00D0: {\n      /* n:\"BrtEndPCDSConsol\", */T: -1\n    },\n    0x00D1: {\n      /* n:\"BrtBeginPCDSCPages\", */T: 1\n    },\n    0x00D2: {\n      /* n:\"BrtEndPCDSCPages\", */T: -1\n    },\n    0x00D3: {\n      /* n:\"BrtBeginPCDSCPage\", */T: 1\n    },\n    0x00D4: {\n      /* n:\"BrtEndPCDSCPage\", */T: -1\n    },\n    0x00D5: {\n      /* n:\"BrtBeginPCDSCPItem\", */T: 1\n    },\n    0x00D6: {\n      /* n:\"BrtEndPCDSCPItem\", */T: -1\n    },\n    0x00D7: {\n      /* n:\"BrtBeginPCDSCSets\", */T: 1\n    },\n    0x00D8: {\n      /* n:\"BrtEndPCDSCSets\", */T: -1\n    },\n    0x00D9: {\n      /* n:\"BrtBeginPCDSCSet\", */T: 1\n    },\n    0x00DA: {\n      /* n:\"BrtEndPCDSCSet\", */T: -1\n    },\n    0x00DB: {\n      /* n:\"BrtBeginPCDFGroup\", */T: 1\n    },\n    0x00DC: {\n      /* n:\"BrtEndPCDFGroup\", */T: -1\n    },\n    0x00DD: {\n      /* n:\"BrtBeginPCDFGItems\", */T: 1\n    },\n    0x00DE: {\n      /* n:\"BrtEndPCDFGItems\", */T: -1\n    },\n    0x00DF: {\n      /* n:\"BrtBeginPCDFGRange\", */T: 1\n    },\n    0x00E0: {\n      /* n:\"BrtEndPCDFGRange\", */T: -1\n    },\n    0x00E1: {\n      /* n:\"BrtBeginPCDFGDiscrete\", */T: 1\n    },\n    0x00E2: {\n      /* n:\"BrtEndPCDFGDiscrete\", */T: -1\n    },\n    0x00E3: {\n      /* n:\"BrtBeginPCDSDTupleCache\", */T: 1\n    },\n    0x00E4: {\n      /* n:\"BrtEndPCDSDTupleCache\", */T: -1\n    },\n    0x00E5: {\n      /* n:\"BrtBeginPCDSDTCEntries\", */T: 1\n    },\n    0x00E6: {\n      /* n:\"BrtEndPCDSDTCEntries\", */T: -1\n    },\n    0x00E7: {\n      /* n:\"BrtBeginPCDSDTCEMembers\", */T: 1\n    },\n    0x00E8: {\n      /* n:\"BrtEndPCDSDTCEMembers\", */T: -1\n    },\n    0x00E9: {\n      /* n:\"BrtBeginPCDSDTCEMember\", */T: 1\n    },\n    0x00EA: {\n      /* n:\"BrtEndPCDSDTCEMember\", */T: -1\n    },\n    0x00EB: {\n      /* n:\"BrtBeginPCDSDTCQueries\", */T: 1\n    },\n    0x00EC: {\n      /* n:\"BrtEndPCDSDTCQueries\", */T: -1\n    },\n    0x00ED: {\n      /* n:\"BrtBeginPCDSDTCQuery\", */T: 1\n    },\n    0x00EE: {\n      /* n:\"BrtEndPCDSDTCQuery\", */T: -1\n    },\n    0x00EF: {\n      /* n:\"BrtBeginPCDSDTCSets\", */T: 1\n    },\n    0x00F0: {\n      /* n:\"BrtEndPCDSDTCSets\", */T: -1\n    },\n    0x00F1: {\n      /* n:\"BrtBeginPCDSDTCSet\", */T: 1\n    },\n    0x00F2: {\n      /* n:\"BrtEndPCDSDTCSet\", */T: -1\n    },\n    0x00F3: {\n      /* n:\"BrtBeginPCDCalcItems\", */T: 1\n    },\n    0x00F4: {\n      /* n:\"BrtEndPCDCalcItems\", */T: -1\n    },\n    0x00F5: {\n      /* n:\"BrtBeginPCDCalcItem\", */T: 1\n    },\n    0x00F6: {\n      /* n:\"BrtEndPCDCalcItem\", */T: -1\n    },\n    0x00F7: {\n      /* n:\"BrtBeginPRule\", */T: 1\n    },\n    0x00F8: {\n      /* n:\"BrtEndPRule\", */T: -1\n    },\n    0x00F9: {\n      /* n:\"BrtBeginPRFilters\", */T: 1\n    },\n    0x00FA: {\n      /* n:\"BrtEndPRFilters\", */T: -1\n    },\n    0x00FB: {\n      /* n:\"BrtBeginPRFilter\", */T: 1\n    },\n    0x00FC: {\n      /* n:\"BrtEndPRFilter\", */T: -1\n    },\n    0x00FD: {\n      /* n:\"BrtBeginPNames\", */T: 1\n    },\n    0x00FE: {\n      /* n:\"BrtEndPNames\", */T: -1\n    },\n    0x00FF: {\n      /* n:\"BrtBeginPName\", */T: 1\n    },\n    0x0100: {\n      /* n:\"BrtEndPName\", */T: -1\n    },\n    0x0101: {\n      /* n:\"BrtBeginPNPairs\", */T: 1\n    },\n    0x0102: {\n      /* n:\"BrtEndPNPairs\", */T: -1\n    },\n    0x0103: {\n      /* n:\"BrtBeginPNPair\", */T: 1\n    },\n    0x0104: {\n      /* n:\"BrtEndPNPair\", */T: -1\n    },\n    0x0105: {\n      /* n:\"BrtBeginECWebProps\", */T: 1\n    },\n    0x0106: {\n      /* n:\"BrtEndECWebProps\", */T: -1\n    },\n    0x0107: {\n      /* n:\"BrtBeginEcWpTables\", */T: 1\n    },\n    0x0108: {\n      /* n:\"BrtEndECWPTables\", */T: -1\n    },\n    0x0109: {\n      /* n:\"BrtBeginECParams\", */T: 1\n    },\n    0x010A: {\n      /* n:\"BrtEndECParams\", */T: -1\n    },\n    0x010B: {\n      /* n:\"BrtBeginECParam\", */T: 1\n    },\n    0x010C: {\n      /* n:\"BrtEndECParam\", */T: -1\n    },\n    0x010D: {\n      /* n:\"BrtBeginPCDKPIs\", */T: 1\n    },\n    0x010E: {\n      /* n:\"BrtEndPCDKPIs\", */T: -1\n    },\n    0x010F: {\n      /* n:\"BrtBeginPCDKPI\", */T: 1\n    },\n    0x0110: {\n      /* n:\"BrtEndPCDKPI\", */T: -1\n    },\n    0x0111: {\n      /* n:\"BrtBeginDims\", */T: 1\n    },\n    0x0112: {\n      /* n:\"BrtEndDims\", */T: -1\n    },\n    0x0113: {\n      /* n:\"BrtBeginDim\", */T: 1\n    },\n    0x0114: {\n      /* n:\"BrtEndDim\", */T: -1\n    },\n    0x0115: {/* n:\"BrtIndexPartEnd\" */},\n    0x0116: {\n      /* n:\"BrtBeginStyleSheet\", */T: 1\n    },\n    0x0117: {\n      /* n:\"BrtEndStyleSheet\", */T: -1\n    },\n    0x0118: {\n      /* n:\"BrtBeginSXView\", */T: 1\n    },\n    0x0119: {\n      /* n:\"BrtEndSXVI\", */T: -1\n    },\n    0x011A: {\n      /* n:\"BrtBeginSXVI\", */T: 1\n    },\n    0x011B: {\n      /* n:\"BrtBeginSXVIs\", */T: 1\n    },\n    0x011C: {\n      /* n:\"BrtEndSXVIs\", */T: -1\n    },\n    0x011D: {\n      /* n:\"BrtBeginSXVD\", */T: 1\n    },\n    0x011E: {\n      /* n:\"BrtEndSXVD\", */T: -1\n    },\n    0x011F: {\n      /* n:\"BrtBeginSXVDs\", */T: 1\n    },\n    0x0120: {\n      /* n:\"BrtEndSXVDs\", */T: -1\n    },\n    0x0121: {\n      /* n:\"BrtBeginSXPI\", */T: 1\n    },\n    0x0122: {\n      /* n:\"BrtEndSXPI\", */T: -1\n    },\n    0x0123: {\n      /* n:\"BrtBeginSXPIs\", */T: 1\n    },\n    0x0124: {\n      /* n:\"BrtEndSXPIs\", */T: -1\n    },\n    0x0125: {\n      /* n:\"BrtBeginSXDI\", */T: 1\n    },\n    0x0126: {\n      /* n:\"BrtEndSXDI\", */T: -1\n    },\n    0x0127: {\n      /* n:\"BrtBeginSXDIs\", */T: 1\n    },\n    0x0128: {\n      /* n:\"BrtEndSXDIs\", */T: -1\n    },\n    0x0129: {\n      /* n:\"BrtBeginSXLI\", */T: 1\n    },\n    0x012A: {\n      /* n:\"BrtEndSXLI\", */T: -1\n    },\n    0x012B: {\n      /* n:\"BrtBeginSXLIRws\", */T: 1\n    },\n    0x012C: {\n      /* n:\"BrtEndSXLIRws\", */T: -1\n    },\n    0x012D: {\n      /* n:\"BrtBeginSXLICols\", */T: 1\n    },\n    0x012E: {\n      /* n:\"BrtEndSXLICols\", */T: -1\n    },\n    0x012F: {\n      /* n:\"BrtBeginSXFormat\", */T: 1\n    },\n    0x0130: {\n      /* n:\"BrtEndSXFormat\", */T: -1\n    },\n    0x0131: {\n      /* n:\"BrtBeginSXFormats\", */T: 1\n    },\n    0x0132: {\n      /* n:\"BrtEndSxFormats\", */T: -1\n    },\n    0x0133: {\n      /* n:\"BrtBeginSxSelect\", */T: 1\n    },\n    0x0134: {\n      /* n:\"BrtEndSxSelect\", */T: -1\n    },\n    0x0135: {\n      /* n:\"BrtBeginISXVDRws\", */T: 1\n    },\n    0x0136: {\n      /* n:\"BrtEndISXVDRws\", */T: -1\n    },\n    0x0137: {\n      /* n:\"BrtBeginISXVDCols\", */T: 1\n    },\n    0x0138: {\n      /* n:\"BrtEndISXVDCols\", */T: -1\n    },\n    0x0139: {\n      /* n:\"BrtEndSXLocation\", */T: -1\n    },\n    0x013A: {\n      /* n:\"BrtBeginSXLocation\", */T: 1\n    },\n    0x013B: {\n      /* n:\"BrtEndSXView\", */T: -1\n    },\n    0x013C: {\n      /* n:\"BrtBeginSXTHs\", */T: 1\n    },\n    0x013D: {\n      /* n:\"BrtEndSXTHs\", */T: -1\n    },\n    0x013E: {\n      /* n:\"BrtBeginSXTH\", */T: 1\n    },\n    0x013F: {\n      /* n:\"BrtEndSXTH\", */T: -1\n    },\n    0x0140: {\n      /* n:\"BrtBeginISXTHRws\", */T: 1\n    },\n    0x0141: {\n      /* n:\"BrtEndISXTHRws\", */T: -1\n    },\n    0x0142: {\n      /* n:\"BrtBeginISXTHCols\", */T: 1\n    },\n    0x0143: {\n      /* n:\"BrtEndISXTHCols\", */T: -1\n    },\n    0x0144: {\n      /* n:\"BrtBeginSXTDMPS\", */T: 1\n    },\n    0x0145: {\n      /* n:\"BrtEndSXTDMPs\", */T: -1\n    },\n    0x0146: {\n      /* n:\"BrtBeginSXTDMP\", */T: 1\n    },\n    0x0147: {\n      /* n:\"BrtEndSXTDMP\", */T: -1\n    },\n    0x0148: {\n      /* n:\"BrtBeginSXTHItems\", */T: 1\n    },\n    0x0149: {\n      /* n:\"BrtEndSXTHItems\", */T: -1\n    },\n    0x014A: {\n      /* n:\"BrtBeginSXTHItem\", */T: 1\n    },\n    0x014B: {\n      /* n:\"BrtEndSXTHItem\", */T: -1\n    },\n    0x014C: {\n      /* n:\"BrtBeginMetadata\", */T: 1\n    },\n    0x014D: {\n      /* n:\"BrtEndMetadata\", */T: -1\n    },\n    0x014E: {\n      /* n:\"BrtBeginEsmdtinfo\", */T: 1\n    },\n    0x014F: {\n      /* n:\"BrtMdtinfo\", */f: parse_BrtMdtinfo\n    },\n    0x0150: {\n      /* n:\"BrtEndEsmdtinfo\", */T: -1\n    },\n    0x0151: {\n      /* n:\"BrtBeginEsmdb\", */f: parse_BrtBeginEsmdb,\n      T: 1\n    },\n    0x0152: {\n      /* n:\"BrtEndEsmdb\", */T: -1\n    },\n    0x0153: {\n      /* n:\"BrtBeginEsfmd\", */T: 1\n    },\n    0x0154: {\n      /* n:\"BrtEndEsfmd\", */T: -1\n    },\n    0x0155: {\n      /* n:\"BrtBeginSingleCells\", */T: 1\n    },\n    0x0156: {\n      /* n:\"BrtEndSingleCells\", */T: -1\n    },\n    0x0157: {\n      /* n:\"BrtBeginList\", */T: 1\n    },\n    0x0158: {\n      /* n:\"BrtEndList\", */T: -1\n    },\n    0x0159: {\n      /* n:\"BrtBeginListCols\", */T: 1\n    },\n    0x015A: {\n      /* n:\"BrtEndListCols\", */T: -1\n    },\n    0x015B: {\n      /* n:\"BrtBeginListCol\", */T: 1\n    },\n    0x015C: {\n      /* n:\"BrtEndListCol\", */T: -1\n    },\n    0x015D: {\n      /* n:\"BrtBeginListXmlCPr\", */T: 1\n    },\n    0x015E: {\n      /* n:\"BrtEndListXmlCPr\", */T: -1\n    },\n    0x015F: {/* n:\"BrtListCCFmla\" */},\n    0x0160: {/* n:\"BrtListTrFmla\" */},\n    0x0161: {\n      /* n:\"BrtBeginExternals\", */T: 1\n    },\n    0x0162: {\n      /* n:\"BrtEndExternals\", */T: -1\n    },\n    0x0163: {\n      /* n:\"BrtSupBookSrc\", */f: parse_RelID\n    },\n    0x0165: {/* n:\"BrtSupSelf\" */},\n    0x0166: {/* n:\"BrtSupSame\" */},\n    0x0167: {/* n:\"BrtSupTabs\" */},\n    0x0168: {\n      /* n:\"BrtBeginSupBook\", */T: 1\n    },\n    0x0169: {/* n:\"BrtPlaceholderName\" */},\n    0x016A: {\n      /* n:\"BrtExternSheet\", */f: parse_ExternSheet\n    },\n    0x016B: {/* n:\"BrtExternTableStart\" */},\n    0x016C: {/* n:\"BrtExternTableEnd\" */},\n    0x016E: {/* n:\"BrtExternRowHdr\" */},\n    0x016F: {/* n:\"BrtExternCellBlank\" */},\n    0x0170: {/* n:\"BrtExternCellReal\" */},\n    0x0171: {/* n:\"BrtExternCellBool\" */},\n    0x0172: {/* n:\"BrtExternCellError\" */},\n    0x0173: {/* n:\"BrtExternCellString\" */},\n    0x0174: {\n      /* n:\"BrtBeginEsmdx\", */T: 1\n    },\n    0x0175: {\n      /* n:\"BrtEndEsmdx\", */T: -1\n    },\n    0x0176: {\n      /* n:\"BrtBeginMdxSet\", */T: 1\n    },\n    0x0177: {\n      /* n:\"BrtEndMdxSet\", */T: -1\n    },\n    0x0178: {\n      /* n:\"BrtBeginMdxMbrProp\", */T: 1\n    },\n    0x0179: {\n      /* n:\"BrtEndMdxMbrProp\", */T: -1\n    },\n    0x017A: {\n      /* n:\"BrtBeginMdxKPI\", */T: 1\n    },\n    0x017B: {\n      /* n:\"BrtEndMdxKPI\", */T: -1\n    },\n    0x017C: {\n      /* n:\"BrtBeginEsstr\", */T: 1\n    },\n    0x017D: {\n      /* n:\"BrtEndEsstr\", */T: -1\n    },\n    0x017E: {\n      /* n:\"BrtBeginPRFItem\", */T: 1\n    },\n    0x017F: {\n      /* n:\"BrtEndPRFItem\", */T: -1\n    },\n    0x0180: {\n      /* n:\"BrtBeginPivotCacheIDs\", */T: 1\n    },\n    0x0181: {\n      /* n:\"BrtEndPivotCacheIDs\", */T: -1\n    },\n    0x0182: {\n      /* n:\"BrtBeginPivotCacheID\", */T: 1\n    },\n    0x0183: {\n      /* n:\"BrtEndPivotCacheID\", */T: -1\n    },\n    0x0184: {\n      /* n:\"BrtBeginISXVIs\", */T: 1\n    },\n    0x0185: {\n      /* n:\"BrtEndISXVIs\", */T: -1\n    },\n    0x0186: {\n      /* n:\"BrtBeginColInfos\", */T: 1\n    },\n    0x0187: {\n      /* n:\"BrtEndColInfos\", */T: -1\n    },\n    0x0188: {\n      /* n:\"BrtBeginRwBrk\", */T: 1\n    },\n    0x0189: {\n      /* n:\"BrtEndRwBrk\", */T: -1\n    },\n    0x018A: {\n      /* n:\"BrtBeginColBrk\", */T: 1\n    },\n    0x018B: {\n      /* n:\"BrtEndColBrk\", */T: -1\n    },\n    0x018C: {/* n:\"BrtBrk\" */},\n    0x018D: {/* n:\"BrtUserBookView\" */},\n    0x018E: {/* n:\"BrtInfo\" */},\n    0x018F: {/* n:\"BrtCUsr\" */},\n    0x0190: {/* n:\"BrtUsr\" */},\n    0x0191: {\n      /* n:\"BrtBeginUsers\", */T: 1\n    },\n    0x0193: {/* n:\"BrtEOF\" */},\n    0x0194: {/* n:\"BrtUCR\" */},\n    0x0195: {/* n:\"BrtRRInsDel\" */},\n    0x0196: {/* n:\"BrtRREndInsDel\" */},\n    0x0197: {/* n:\"BrtRRMove\" */},\n    0x0198: {/* n:\"BrtRREndMove\" */},\n    0x0199: {/* n:\"BrtRRChgCell\" */},\n    0x019A: {/* n:\"BrtRREndChgCell\" */},\n    0x019B: {/* n:\"BrtRRHeader\" */},\n    0x019C: {/* n:\"BrtRRUserView\" */},\n    0x019D: {/* n:\"BrtRRRenSheet\" */},\n    0x019E: {/* n:\"BrtRRInsertSh\" */},\n    0x019F: {/* n:\"BrtRRDefName\" */},\n    0x01A0: {/* n:\"BrtRRNote\" */},\n    0x01A1: {/* n:\"BrtRRConflict\" */},\n    0x01A2: {/* n:\"BrtRRTQSIF\" */},\n    0x01A3: {/* n:\"BrtRRFormat\" */},\n    0x01A4: {/* n:\"BrtRREndFormat\" */},\n    0x01A5: {/* n:\"BrtRRAutoFmt\" */},\n    0x01A6: {\n      /* n:\"BrtBeginUserShViews\", */T: 1\n    },\n    0x01A7: {\n      /* n:\"BrtBeginUserShView\", */T: 1\n    },\n    0x01A8: {\n      /* n:\"BrtEndUserShView\", */T: -1\n    },\n    0x01A9: {\n      /* n:\"BrtEndUserShViews\", */T: -1\n    },\n    0x01AA: {\n      /* n:\"BrtArrFmla\", */f: parse_BrtArrFmla\n    },\n    0x01AB: {\n      /* n:\"BrtShrFmla\", */f: parse_BrtShrFmla\n    },\n    0x01AC: {/* n:\"BrtTable\" */},\n    0x01AD: {\n      /* n:\"BrtBeginExtConnections\", */T: 1\n    },\n    0x01AE: {\n      /* n:\"BrtEndExtConnections\", */T: -1\n    },\n    0x01AF: {\n      /* n:\"BrtBeginPCDCalcMems\", */T: 1\n    },\n    0x01B0: {\n      /* n:\"BrtEndPCDCalcMems\", */T: -1\n    },\n    0x01B1: {\n      /* n:\"BrtBeginPCDCalcMem\", */T: 1\n    },\n    0x01B2: {\n      /* n:\"BrtEndPCDCalcMem\", */T: -1\n    },\n    0x01B3: {\n      /* n:\"BrtBeginPCDHGLevels\", */T: 1\n    },\n    0x01B4: {\n      /* n:\"BrtEndPCDHGLevels\", */T: -1\n    },\n    0x01B5: {\n      /* n:\"BrtBeginPCDHGLevel\", */T: 1\n    },\n    0x01B6: {\n      /* n:\"BrtEndPCDHGLevel\", */T: -1\n    },\n    0x01B7: {\n      /* n:\"BrtBeginPCDHGLGroups\", */T: 1\n    },\n    0x01B8: {\n      /* n:\"BrtEndPCDHGLGroups\", */T: -1\n    },\n    0x01B9: {\n      /* n:\"BrtBeginPCDHGLGroup\", */T: 1\n    },\n    0x01BA: {\n      /* n:\"BrtEndPCDHGLGroup\", */T: -1\n    },\n    0x01BB: {\n      /* n:\"BrtBeginPCDHGLGMembers\", */T: 1\n    },\n    0x01BC: {\n      /* n:\"BrtEndPCDHGLGMembers\", */T: -1\n    },\n    0x01BD: {\n      /* n:\"BrtBeginPCDHGLGMember\", */T: 1\n    },\n    0x01BE: {\n      /* n:\"BrtEndPCDHGLGMember\", */T: -1\n    },\n    0x01BF: {\n      /* n:\"BrtBeginQSI\", */T: 1\n    },\n    0x01C0: {\n      /* n:\"BrtEndQSI\", */T: -1\n    },\n    0x01C1: {\n      /* n:\"BrtBeginQSIR\", */T: 1\n    },\n    0x01C2: {\n      /* n:\"BrtEndQSIR\", */T: -1\n    },\n    0x01C3: {\n      /* n:\"BrtBeginDeletedNames\", */T: 1\n    },\n    0x01C4: {\n      /* n:\"BrtEndDeletedNames\", */T: -1\n    },\n    0x01C5: {\n      /* n:\"BrtBeginDeletedName\", */T: 1\n    },\n    0x01C6: {\n      /* n:\"BrtEndDeletedName\", */T: -1\n    },\n    0x01C7: {\n      /* n:\"BrtBeginQSIFs\", */T: 1\n    },\n    0x01C8: {\n      /* n:\"BrtEndQSIFs\", */T: -1\n    },\n    0x01C9: {\n      /* n:\"BrtBeginQSIF\", */T: 1\n    },\n    0x01CA: {\n      /* n:\"BrtEndQSIF\", */T: -1\n    },\n    0x01CB: {\n      /* n:\"BrtBeginAutoSortScope\", */T: 1\n    },\n    0x01CC: {\n      /* n:\"BrtEndAutoSortScope\", */T: -1\n    },\n    0x01CD: {\n      /* n:\"BrtBeginConditionalFormatting\", */T: 1\n    },\n    0x01CE: {\n      /* n:\"BrtEndConditionalFormatting\", */T: -1\n    },\n    0x01CF: {\n      /* n:\"BrtBeginCFRule\", */T: 1\n    },\n    0x01D0: {\n      /* n:\"BrtEndCFRule\", */T: -1\n    },\n    0x01D1: {\n      /* n:\"BrtBeginIconSet\", */T: 1\n    },\n    0x01D2: {\n      /* n:\"BrtEndIconSet\", */T: -1\n    },\n    0x01D3: {\n      /* n:\"BrtBeginDatabar\", */T: 1\n    },\n    0x01D4: {\n      /* n:\"BrtEndDatabar\", */T: -1\n    },\n    0x01D5: {\n      /* n:\"BrtBeginColorScale\", */T: 1\n    },\n    0x01D6: {\n      /* n:\"BrtEndColorScale\", */T: -1\n    },\n    0x01D7: {/* n:\"BrtCFVO\" */},\n    0x01D8: {/* n:\"BrtExternValueMeta\" */},\n    0x01D9: {\n      /* n:\"BrtBeginColorPalette\", */T: 1\n    },\n    0x01DA: {\n      /* n:\"BrtEndColorPalette\", */T: -1\n    },\n    0x01DB: {/* n:\"BrtIndexedColor\" */},\n    0x01DC: {\n      /* n:\"BrtMargins\", */f: parse_BrtMargins\n    },\n    0x01DD: {/* n:\"BrtPrintOptions\" */},\n    0x01DE: {/* n:\"BrtPageSetup\" */},\n    0x01DF: {\n      /* n:\"BrtBeginHeaderFooter\", */T: 1\n    },\n    0x01E0: {\n      /* n:\"BrtEndHeaderFooter\", */T: -1\n    },\n    0x01E1: {\n      /* n:\"BrtBeginSXCrtFormat\", */T: 1\n    },\n    0x01E2: {\n      /* n:\"BrtEndSXCrtFormat\", */T: -1\n    },\n    0x01E3: {\n      /* n:\"BrtBeginSXCrtFormats\", */T: 1\n    },\n    0x01E4: {\n      /* n:\"BrtEndSXCrtFormats\", */T: -1\n    },\n    0x01E5: {\n      /* n:\"BrtWsFmtInfo\", */f: parse_BrtWsFmtInfo\n    },\n    0x01E6: {\n      /* n:\"BrtBeginMgs\", */T: 1\n    },\n    0x01E7: {\n      /* n:\"BrtEndMGs\", */T: -1\n    },\n    0x01E8: {\n      /* n:\"BrtBeginMGMaps\", */T: 1\n    },\n    0x01E9: {\n      /* n:\"BrtEndMGMaps\", */T: -1\n    },\n    0x01EA: {\n      /* n:\"BrtBeginMG\", */T: 1\n    },\n    0x01EB: {\n      /* n:\"BrtEndMG\", */T: -1\n    },\n    0x01EC: {\n      /* n:\"BrtBeginMap\", */T: 1\n    },\n    0x01ED: {\n      /* n:\"BrtEndMap\", */T: -1\n    },\n    0x01EE: {\n      /* n:\"BrtHLink\", */f: parse_BrtHLink\n    },\n    0x01EF: {\n      /* n:\"BrtBeginDCon\", */T: 1\n    },\n    0x01F0: {\n      /* n:\"BrtEndDCon\", */T: -1\n    },\n    0x01F1: {\n      /* n:\"BrtBeginDRefs\", */T: 1\n    },\n    0x01F2: {\n      /* n:\"BrtEndDRefs\", */T: -1\n    },\n    0x01F3: {/* n:\"BrtDRef\" */},\n    0x01F4: {\n      /* n:\"BrtBeginScenMan\", */T: 1\n    },\n    0x01F5: {\n      /* n:\"BrtEndScenMan\", */T: -1\n    },\n    0x01F6: {\n      /* n:\"BrtBeginSct\", */T: 1\n    },\n    0x01F7: {\n      /* n:\"BrtEndSct\", */T: -1\n    },\n    0x01F8: {/* n:\"BrtSlc\" */},\n    0x01F9: {\n      /* n:\"BrtBeginDXFs\", */T: 1\n    },\n    0x01FA: {\n      /* n:\"BrtEndDXFs\", */T: -1\n    },\n    0x01FB: {/* n:\"BrtDXF\" */},\n    0x01FC: {\n      /* n:\"BrtBeginTableStyles\", */T: 1\n    },\n    0x01FD: {\n      /* n:\"BrtEndTableStyles\", */T: -1\n    },\n    0x01FE: {\n      /* n:\"BrtBeginTableStyle\", */T: 1\n    },\n    0x01FF: {\n      /* n:\"BrtEndTableStyle\", */T: -1\n    },\n    0x0200: {/* n:\"BrtTableStyleElement\" */},\n    0x0201: {/* n:\"BrtTableStyleClient\" */},\n    0x0202: {\n      /* n:\"BrtBeginVolDeps\", */T: 1\n    },\n    0x0203: {\n      /* n:\"BrtEndVolDeps\", */T: -1\n    },\n    0x0204: {\n      /* n:\"BrtBeginVolType\", */T: 1\n    },\n    0x0205: {\n      /* n:\"BrtEndVolType\", */T: -1\n    },\n    0x0206: {\n      /* n:\"BrtBeginVolMain\", */T: 1\n    },\n    0x0207: {\n      /* n:\"BrtEndVolMain\", */T: -1\n    },\n    0x0208: {\n      /* n:\"BrtBeginVolTopic\", */T: 1\n    },\n    0x0209: {\n      /* n:\"BrtEndVolTopic\", */T: -1\n    },\n    0x020A: {/* n:\"BrtVolSubtopic\" */},\n    0x020B: {/* n:\"BrtVolRef\" */},\n    0x020C: {/* n:\"BrtVolNum\" */},\n    0x020D: {/* n:\"BrtVolErr\" */},\n    0x020E: {/* n:\"BrtVolStr\" */},\n    0x020F: {/* n:\"BrtVolBool\" */},\n    0x0210: {\n      /* n:\"BrtBeginCalcChain$\", */T: 1\n    },\n    0x0211: {\n      /* n:\"BrtEndCalcChain$\", */T: -1\n    },\n    0x0212: {\n      /* n:\"BrtBeginSortState\", */T: 1\n    },\n    0x0213: {\n      /* n:\"BrtEndSortState\", */T: -1\n    },\n    0x0214: {\n      /* n:\"BrtBeginSortCond\", */T: 1\n    },\n    0x0215: {\n      /* n:\"BrtEndSortCond\", */T: -1\n    },\n    0x0216: {/* n:\"BrtBookProtection\" */},\n    0x0217: {/* n:\"BrtSheetProtection\" */},\n    0x0218: {/* n:\"BrtRangeProtection\" */},\n    0x0219: {/* n:\"BrtPhoneticInfo\" */},\n    0x021A: {\n      /* n:\"BrtBeginECTxtWiz\", */T: 1\n    },\n    0x021B: {\n      /* n:\"BrtEndECTxtWiz\", */T: -1\n    },\n    0x021C: {\n      /* n:\"BrtBeginECTWFldInfoLst\", */T: 1\n    },\n    0x021D: {\n      /* n:\"BrtEndECTWFldInfoLst\", */T: -1\n    },\n    0x021E: {\n      /* n:\"BrtBeginECTwFldInfo\", */T: 1\n    },\n    0x0224: {/* n:\"BrtFileSharing\" */},\n    0x0225: {/* n:\"BrtOleSize\" */},\n    0x0226: {\n      /* n:\"BrtDrawing\", */f: parse_RelID\n    },\n    0x0227: {/* n:\"BrtLegacyDrawing\" */},\n    0x0228: {/* n:\"BrtLegacyDrawingHF\" */},\n    0x0229: {/* n:\"BrtWebOpt\" */},\n    0x022A: {\n      /* n:\"BrtBeginWebPubItems\", */T: 1\n    },\n    0x022B: {\n      /* n:\"BrtEndWebPubItems\", */T: -1\n    },\n    0x022C: {\n      /* n:\"BrtBeginWebPubItem\", */T: 1\n    },\n    0x022D: {\n      /* n:\"BrtEndWebPubItem\", */T: -1\n    },\n    0x022E: {\n      /* n:\"BrtBeginSXCondFmt\", */T: 1\n    },\n    0x022F: {\n      /* n:\"BrtEndSXCondFmt\", */T: -1\n    },\n    0x0230: {\n      /* n:\"BrtBeginSXCondFmts\", */T: 1\n    },\n    0x0231: {\n      /* n:\"BrtEndSXCondFmts\", */T: -1\n    },\n    0x0232: {/* n:\"BrtBkHim\" */},\n    0x0234: {/* n:\"BrtColor\" */},\n    0x0235: {\n      /* n:\"BrtBeginIndexedColors\", */T: 1\n    },\n    0x0236: {\n      /* n:\"BrtEndIndexedColors\", */T: -1\n    },\n    0x0239: {\n      /* n:\"BrtBeginMRUColors\", */T: 1\n    },\n    0x023A: {\n      /* n:\"BrtEndMRUColors\", */T: -1\n    },\n    0x023C: {/* n:\"BrtMRUColor\" */},\n    0x023D: {\n      /* n:\"BrtBeginDVals\", */T: 1\n    },\n    0x023E: {\n      /* n:\"BrtEndDVals\", */T: -1\n    },\n    0x0241: {/* n:\"BrtSupNameStart\" */},\n    0x0242: {/* n:\"BrtSupNameValueStart\" */},\n    0x0243: {/* n:\"BrtSupNameValueEnd\" */},\n    0x0244: {/* n:\"BrtSupNameNum\" */},\n    0x0245: {/* n:\"BrtSupNameErr\" */},\n    0x0246: {/* n:\"BrtSupNameSt\" */},\n    0x0247: {/* n:\"BrtSupNameNil\" */},\n    0x0248: {/* n:\"BrtSupNameBool\" */},\n    0x0249: {/* n:\"BrtSupNameFmla\" */},\n    0x024A: {/* n:\"BrtSupNameBits\" */},\n    0x024B: {/* n:\"BrtSupNameEnd\" */},\n    0x024C: {\n      /* n:\"BrtEndSupBook\", */T: -1\n    },\n    0x024D: {/* n:\"BrtCellSmartTagProperty\" */},\n    0x024E: {\n      /* n:\"BrtBeginCellSmartTag\", */T: 1\n    },\n    0x024F: {\n      /* n:\"BrtEndCellSmartTag\", */T: -1\n    },\n    0x0250: {\n      /* n:\"BrtBeginCellSmartTags\", */T: 1\n    },\n    0x0251: {\n      /* n:\"BrtEndCellSmartTags\", */T: -1\n    },\n    0x0252: {\n      /* n:\"BrtBeginSmartTags\", */T: 1\n    },\n    0x0253: {\n      /* n:\"BrtEndSmartTags\", */T: -1\n    },\n    0x0254: {/* n:\"BrtSmartTagType\" */},\n    0x0255: {\n      /* n:\"BrtBeginSmartTagTypes\", */T: 1\n    },\n    0x0256: {\n      /* n:\"BrtEndSmartTagTypes\", */T: -1\n    },\n    0x0257: {\n      /* n:\"BrtBeginSXFilters\", */T: 1\n    },\n    0x0258: {\n      /* n:\"BrtEndSXFilters\", */T: -1\n    },\n    0x0259: {\n      /* n:\"BrtBeginSXFILTER\", */T: 1\n    },\n    0x025A: {\n      /* n:\"BrtEndSXFilter\", */T: -1\n    },\n    0x025B: {\n      /* n:\"BrtBeginFills\", */T: 1\n    },\n    0x025C: {\n      /* n:\"BrtEndFills\", */T: -1\n    },\n    0x025D: {\n      /* n:\"BrtBeginCellWatches\", */T: 1\n    },\n    0x025E: {\n      /* n:\"BrtEndCellWatches\", */T: -1\n    },\n    0x025F: {/* n:\"BrtCellWatch\" */},\n    0x0260: {\n      /* n:\"BrtBeginCRErrs\", */T: 1\n    },\n    0x0261: {\n      /* n:\"BrtEndCRErrs\", */T: -1\n    },\n    0x0262: {/* n:\"BrtCrashRecErr\" */},\n    0x0263: {\n      /* n:\"BrtBeginFonts\", */T: 1\n    },\n    0x0264: {\n      /* n:\"BrtEndFonts\", */T: -1\n    },\n    0x0265: {\n      /* n:\"BrtBeginBorders\", */T: 1\n    },\n    0x0266: {\n      /* n:\"BrtEndBorders\", */T: -1\n    },\n    0x0267: {\n      /* n:\"BrtBeginFmts\", */T: 1\n    },\n    0x0268: {\n      /* n:\"BrtEndFmts\", */T: -1\n    },\n    0x0269: {\n      /* n:\"BrtBeginCellXFs\", */T: 1\n    },\n    0x026A: {\n      /* n:\"BrtEndCellXFs\", */T: -1\n    },\n    0x026B: {\n      /* n:\"BrtBeginStyles\", */T: 1\n    },\n    0x026C: {\n      /* n:\"BrtEndStyles\", */T: -1\n    },\n    0x0271: {/* n:\"BrtBigName\" */},\n    0x0272: {\n      /* n:\"BrtBeginCellStyleXFs\", */T: 1\n    },\n    0x0273: {\n      /* n:\"BrtEndCellStyleXFs\", */T: -1\n    },\n    0x0274: {\n      /* n:\"BrtBeginComments\", */T: 1\n    },\n    0x0275: {\n      /* n:\"BrtEndComments\", */T: -1\n    },\n    0x0276: {\n      /* n:\"BrtBeginCommentAuthors\", */T: 1\n    },\n    0x0277: {\n      /* n:\"BrtEndCommentAuthors\", */T: -1\n    },\n    0x0278: {\n      /* n:\"BrtCommentAuthor\", */f: parse_BrtCommentAuthor\n    },\n    0x0279: {\n      /* n:\"BrtBeginCommentList\", */T: 1\n    },\n    0x027A: {\n      /* n:\"BrtEndCommentList\", */T: -1\n    },\n    0x027B: {\n      /* n:\"BrtBeginComment\", */T: 1,\n      f: parse_BrtBeginComment\n    },\n    0x027C: {\n      /* n:\"BrtEndComment\", */T: -1\n    },\n    0x027D: {\n      /* n:\"BrtCommentText\", */f: parse_BrtCommentText\n    },\n    0x027E: {\n      /* n:\"BrtBeginOleObjects\", */T: 1\n    },\n    0x027F: {/* n:\"BrtOleObject\" */},\n    0x0280: {\n      /* n:\"BrtEndOleObjects\", */T: -1\n    },\n    0x0281: {\n      /* n:\"BrtBeginSxrules\", */T: 1\n    },\n    0x0282: {\n      /* n:\"BrtEndSxRules\", */T: -1\n    },\n    0x0283: {\n      /* n:\"BrtBeginActiveXControls\", */T: 1\n    },\n    0x0284: {/* n:\"BrtActiveX\" */},\n    0x0285: {\n      /* n:\"BrtEndActiveXControls\", */T: -1\n    },\n    0x0286: {\n      /* n:\"BrtBeginPCDSDTCEMembersSortBy\", */T: 1\n    },\n    0x0288: {\n      /* n:\"BrtBeginCellIgnoreECs\", */T: 1\n    },\n    0x0289: {/* n:\"BrtCellIgnoreEC\" */},\n    0x028A: {\n      /* n:\"BrtEndCellIgnoreECs\", */T: -1\n    },\n    0x028B: {\n      /* n:\"BrtCsProp\", */f: parse_BrtCsProp\n    },\n    0x028C: {/* n:\"BrtCsPageSetup\" */},\n    0x028D: {\n      /* n:\"BrtBeginUserCsViews\", */T: 1\n    },\n    0x028E: {\n      /* n:\"BrtEndUserCsViews\", */T: -1\n    },\n    0x028F: {\n      /* n:\"BrtBeginUserCsView\", */T: 1\n    },\n    0x0290: {\n      /* n:\"BrtEndUserCsView\", */T: -1\n    },\n    0x0291: {\n      /* n:\"BrtBeginPcdSFCIEntries\", */T: 1\n    },\n    0x0292: {\n      /* n:\"BrtEndPCDSFCIEntries\", */T: -1\n    },\n    0x0293: {/* n:\"BrtPCDSFCIEntry\" */},\n    0x0294: {\n      /* n:\"BrtBeginListParts\", */T: 1\n    },\n    0x0295: {/* n:\"BrtListPart\" */},\n    0x0296: {\n      /* n:\"BrtEndListParts\", */T: -1\n    },\n    0x0297: {/* n:\"BrtSheetCalcProp\" */},\n    0x0298: {\n      /* n:\"BrtBeginFnGroup\", */T: 1\n    },\n    0x0299: {/* n:\"BrtFnGroup\" */},\n    0x029A: {\n      /* n:\"BrtEndFnGroup\", */T: -1\n    },\n    0x029B: {/* n:\"BrtSupAddin\" */},\n    0x029C: {/* n:\"BrtSXTDMPOrder\" */},\n    0x029D: {/* n:\"BrtCsProtection\" */},\n    0x029F: {\n      /* n:\"BrtBeginWsSortMap\", */T: 1\n    },\n    0x02A0: {\n      /* n:\"BrtEndWsSortMap\", */T: -1\n    },\n    0x02A1: {\n      /* n:\"BrtBeginRRSort\", */T: 1\n    },\n    0x02A2: {\n      /* n:\"BrtEndRRSort\", */T: -1\n    },\n    0x02A3: {/* n:\"BrtRRSortItem\" */},\n    0x02A4: {/* n:\"BrtFileSharingIso\" */},\n    0x02A5: {/* n:\"BrtBookProtectionIso\" */},\n    0x02A6: {/* n:\"BrtSheetProtectionIso\" */},\n    0x02A7: {/* n:\"BrtCsProtectionIso\" */},\n    0x02A8: {/* n:\"BrtRangeProtectionIso\" */},\n    0x02A9: {/* n:\"BrtDValList\" */},\n    0x0400: {/* n:\"BrtRwDescent\" */},\n    0x0401: {/* n:\"BrtKnownFonts\" */},\n    0x0402: {\n      /* n:\"BrtBeginSXTupleSet\", */T: 1\n    },\n    0x0403: {\n      /* n:\"BrtEndSXTupleSet\", */T: -1\n    },\n    0x0404: {\n      /* n:\"BrtBeginSXTupleSetHeader\", */T: 1\n    },\n    0x0405: {\n      /* n:\"BrtEndSXTupleSetHeader\", */T: -1\n    },\n    0x0406: {/* n:\"BrtSXTupleSetHeaderItem\" */},\n    0x0407: {\n      /* n:\"BrtBeginSXTupleSetData\", */T: 1\n    },\n    0x0408: {\n      /* n:\"BrtEndSXTupleSetData\", */T: -1\n    },\n    0x0409: {\n      /* n:\"BrtBeginSXTupleSetRow\", */T: 1\n    },\n    0x040A: {\n      /* n:\"BrtEndSXTupleSetRow\", */T: -1\n    },\n    0x040B: {/* n:\"BrtSXTupleSetRowItem\" */},\n    0x040C: {/* n:\"BrtNameExt\" */},\n    0x040D: {/* n:\"BrtPCDH14\" */},\n    0x040E: {\n      /* n:\"BrtBeginPCDCalcMem14\", */T: 1\n    },\n    0x040F: {\n      /* n:\"BrtEndPCDCalcMem14\", */T: -1\n    },\n    0x0410: {/* n:\"BrtSXTH14\" */},\n    0x0411: {\n      /* n:\"BrtBeginSparklineGroup\", */T: 1\n    },\n    0x0412: {\n      /* n:\"BrtEndSparklineGroup\", */T: -1\n    },\n    0x0413: {/* n:\"BrtSparkline\" */},\n    0x0414: {/* n:\"BrtSXDI14\" */},\n    0x0415: {/* n:\"BrtWsFmtInfoEx14\" */},\n    0x0416: {\n      /* n:\"BrtBeginConditionalFormatting14\", */T: 1\n    },\n    0x0417: {\n      /* n:\"BrtEndConditionalFormatting14\", */T: -1\n    },\n    0x0418: {\n      /* n:\"BrtBeginCFRule14\", */T: 1\n    },\n    0x0419: {\n      /* n:\"BrtEndCFRule14\", */T: -1\n    },\n    0x041A: {/* n:\"BrtCFVO14\" */},\n    0x041B: {\n      /* n:\"BrtBeginDatabar14\", */T: 1\n    },\n    0x041C: {\n      /* n:\"BrtBeginIconSet14\", */T: 1\n    },\n    0x041D: {\n      /* n:\"BrtDVal14\", */f: parse_BrtDVal14\n    },\n    0x041E: {\n      /* n:\"BrtBeginDVals14\", */T: 1\n    },\n    0x041F: {/* n:\"BrtColor14\" */},\n    0x0420: {\n      /* n:\"BrtBeginSparklines\", */T: 1\n    },\n    0x0421: {\n      /* n:\"BrtEndSparklines\", */T: -1\n    },\n    0x0422: {\n      /* n:\"BrtBeginSparklineGroups\", */T: 1\n    },\n    0x0423: {\n      /* n:\"BrtEndSparklineGroups\", */T: -1\n    },\n    0x0425: {/* n:\"BrtSXVD14\" */},\n    0x0426: {\n      /* n:\"BrtBeginSXView14\", */T: 1\n    },\n    0x0427: {\n      /* n:\"BrtEndSXView14\", */T: -1\n    },\n    0x0428: {\n      /* n:\"BrtBeginSXView16\", */T: 1\n    },\n    0x0429: {\n      /* n:\"BrtEndSXView16\", */T: -1\n    },\n    0x042A: {\n      /* n:\"BrtBeginPCD14\", */T: 1\n    },\n    0x042B: {\n      /* n:\"BrtEndPCD14\", */T: -1\n    },\n    0x042C: {\n      /* n:\"BrtBeginExtConn14\", */T: 1\n    },\n    0x042D: {\n      /* n:\"BrtEndExtConn14\", */T: -1\n    },\n    0x042E: {\n      /* n:\"BrtBeginSlicerCacheIDs\", */T: 1\n    },\n    0x042F: {\n      /* n:\"BrtEndSlicerCacheIDs\", */T: -1\n    },\n    0x0430: {\n      /* n:\"BrtBeginSlicerCacheID\", */T: 1\n    },\n    0x0431: {\n      /* n:\"BrtEndSlicerCacheID\", */T: -1\n    },\n    0x0433: {\n      /* n:\"BrtBeginSlicerCache\", */T: 1\n    },\n    0x0434: {\n      /* n:\"BrtEndSlicerCache\", */T: -1\n    },\n    0x0435: {\n      /* n:\"BrtBeginSlicerCacheDef\", */T: 1\n    },\n    0x0436: {\n      /* n:\"BrtEndSlicerCacheDef\", */T: -1\n    },\n    0x0437: {\n      /* n:\"BrtBeginSlicersEx\", */T: 1\n    },\n    0x0438: {\n      /* n:\"BrtEndSlicersEx\", */T: -1\n    },\n    0x0439: {\n      /* n:\"BrtBeginSlicerEx\", */T: 1\n    },\n    0x043A: {\n      /* n:\"BrtEndSlicerEx\", */T: -1\n    },\n    0x043B: {\n      /* n:\"BrtBeginSlicer\", */T: 1\n    },\n    0x043C: {\n      /* n:\"BrtEndSlicer\", */T: -1\n    },\n    0x043D: {/* n:\"BrtSlicerCachePivotTables\" */},\n    0x043E: {\n      /* n:\"BrtBeginSlicerCacheOlapImpl\", */T: 1\n    },\n    0x043F: {\n      /* n:\"BrtEndSlicerCacheOlapImpl\", */T: -1\n    },\n    0x0440: {\n      /* n:\"BrtBeginSlicerCacheLevelsData\", */T: 1\n    },\n    0x0441: {\n      /* n:\"BrtEndSlicerCacheLevelsData\", */T: -1\n    },\n    0x0442: {\n      /* n:\"BrtBeginSlicerCacheLevelData\", */T: 1\n    },\n    0x0443: {\n      /* n:\"BrtEndSlicerCacheLevelData\", */T: -1\n    },\n    0x0444: {\n      /* n:\"BrtBeginSlicerCacheSiRanges\", */T: 1\n    },\n    0x0445: {\n      /* n:\"BrtEndSlicerCacheSiRanges\", */T: -1\n    },\n    0x0446: {\n      /* n:\"BrtBeginSlicerCacheSiRange\", */T: 1\n    },\n    0x0447: {\n      /* n:\"BrtEndSlicerCacheSiRange\", */T: -1\n    },\n    0x0448: {/* n:\"BrtSlicerCacheOlapItem\" */},\n    0x0449: {\n      /* n:\"BrtBeginSlicerCacheSelections\", */T: 1\n    },\n    0x044A: {/* n:\"BrtSlicerCacheSelection\" */},\n    0x044B: {\n      /* n:\"BrtEndSlicerCacheSelections\", */T: -1\n    },\n    0x044C: {\n      /* n:\"BrtBeginSlicerCacheNative\", */T: 1\n    },\n    0x044D: {\n      /* n:\"BrtEndSlicerCacheNative\", */T: -1\n    },\n    0x044E: {/* n:\"BrtSlicerCacheNativeItem\" */},\n    0x044F: {/* n:\"BrtRangeProtection14\" */},\n    0x0450: {/* n:\"BrtRangeProtectionIso14\" */},\n    0x0451: {/* n:\"BrtCellIgnoreEC14\" */},\n    0x0457: {/* n:\"BrtList14\" */},\n    0x0458: {/* n:\"BrtCFIcon\" */},\n    0x0459: {\n      /* n:\"BrtBeginSlicerCachesPivotCacheIDs\", */T: 1\n    },\n    0x045A: {\n      /* n:\"BrtEndSlicerCachesPivotCacheIDs\", */T: -1\n    },\n    0x045B: {\n      /* n:\"BrtBeginSlicers\", */T: 1\n    },\n    0x045C: {\n      /* n:\"BrtEndSlicers\", */T: -1\n    },\n    0x045D: {/* n:\"BrtWbProp14\" */},\n    0x045E: {\n      /* n:\"BrtBeginSXEdit\", */T: 1\n    },\n    0x045F: {\n      /* n:\"BrtEndSXEdit\", */T: -1\n    },\n    0x0460: {\n      /* n:\"BrtBeginSXEdits\", */T: 1\n    },\n    0x0461: {\n      /* n:\"BrtEndSXEdits\", */T: -1\n    },\n    0x0462: {\n      /* n:\"BrtBeginSXChange\", */T: 1\n    },\n    0x0463: {\n      /* n:\"BrtEndSXChange\", */T: -1\n    },\n    0x0464: {\n      /* n:\"BrtBeginSXChanges\", */T: 1\n    },\n    0x0465: {\n      /* n:\"BrtEndSXChanges\", */T: -1\n    },\n    0x0466: {/* n:\"BrtSXTupleItems\" */},\n    0x0468: {\n      /* n:\"BrtBeginSlicerStyle\", */T: 1\n    },\n    0x0469: {\n      /* n:\"BrtEndSlicerStyle\", */T: -1\n    },\n    0x046A: {/* n:\"BrtSlicerStyleElement\" */},\n    0x046B: {\n      /* n:\"BrtBeginStyleSheetExt14\", */T: 1\n    },\n    0x046C: {\n      /* n:\"BrtEndStyleSheetExt14\", */T: -1\n    },\n    0x046D: {\n      /* n:\"BrtBeginSlicerCachesPivotCacheID\", */T: 1\n    },\n    0x046E: {\n      /* n:\"BrtEndSlicerCachesPivotCacheID\", */T: -1\n    },\n    0x046F: {\n      /* n:\"BrtBeginConditionalFormattings\", */T: 1\n    },\n    0x0470: {\n      /* n:\"BrtEndConditionalFormattings\", */T: -1\n    },\n    0x0471: {\n      /* n:\"BrtBeginPCDCalcMemExt\", */T: 1\n    },\n    0x0472: {\n      /* n:\"BrtEndPCDCalcMemExt\", */T: -1\n    },\n    0x0473: {\n      /* n:\"BrtBeginPCDCalcMemsExt\", */T: 1\n    },\n    0x0474: {\n      /* n:\"BrtEndPCDCalcMemsExt\", */T: -1\n    },\n    0x0475: {/* n:\"BrtPCDField14\" */},\n    0x0476: {\n      /* n:\"BrtBeginSlicerStyles\", */T: 1\n    },\n    0x0477: {\n      /* n:\"BrtEndSlicerStyles\", */T: -1\n    },\n    0x0478: {\n      /* n:\"BrtBeginSlicerStyleElements\", */T: 1\n    },\n    0x0479: {\n      /* n:\"BrtEndSlicerStyleElements\", */T: -1\n    },\n    0x047A: {/* n:\"BrtCFRuleExt\" */},\n    0x047B: {\n      /* n:\"BrtBeginSXCondFmt14\", */T: 1\n    },\n    0x047C: {\n      /* n:\"BrtEndSXCondFmt14\", */T: -1\n    },\n    0x047D: {\n      /* n:\"BrtBeginSXCondFmts14\", */T: 1\n    },\n    0x047E: {\n      /* n:\"BrtEndSXCondFmts14\", */T: -1\n    },\n    0x0480: {\n      /* n:\"BrtBeginSortCond14\", */T: 1\n    },\n    0x0481: {\n      /* n:\"BrtEndSortCond14\", */T: -1\n    },\n    0x0482: {\n      /* n:\"BrtEndDVals14\", */T: -1\n    },\n    0x0483: {\n      /* n:\"BrtEndIconSet14\", */T: -1\n    },\n    0x0484: {\n      /* n:\"BrtEndDatabar14\", */T: -1\n    },\n    0x0485: {\n      /* n:\"BrtBeginColorScale14\", */T: 1\n    },\n    0x0486: {\n      /* n:\"BrtEndColorScale14\", */T: -1\n    },\n    0x0487: {\n      /* n:\"BrtBeginSxrules14\", */T: 1\n    },\n    0x0488: {\n      /* n:\"BrtEndSxrules14\", */T: -1\n    },\n    0x0489: {\n      /* n:\"BrtBeginPRule14\", */T: 1\n    },\n    0x048A: {\n      /* n:\"BrtEndPRule14\", */T: -1\n    },\n    0x048B: {\n      /* n:\"BrtBeginPRFilters14\", */T: 1\n    },\n    0x048C: {\n      /* n:\"BrtEndPRFilters14\", */T: -1\n    },\n    0x048D: {\n      /* n:\"BrtBeginPRFilter14\", */T: 1\n    },\n    0x048E: {\n      /* n:\"BrtEndPRFilter14\", */T: -1\n    },\n    0x048F: {\n      /* n:\"BrtBeginPRFItem14\", */T: 1\n    },\n    0x0490: {\n      /* n:\"BrtEndPRFItem14\", */T: -1\n    },\n    0x0491: {\n      /* n:\"BrtBeginCellIgnoreECs14\", */T: 1\n    },\n    0x0492: {\n      /* n:\"BrtEndCellIgnoreECs14\", */T: -1\n    },\n    0x0493: {/* n:\"BrtDxf14\" */},\n    0x0494: {\n      /* n:\"BrtBeginDxF14s\", */T: 1\n    },\n    0x0495: {\n      /* n:\"BrtEndDxf14s\", */T: -1\n    },\n    0x0499: {/* n:\"BrtFilter14\" */},\n    0x049A: {\n      /* n:\"BrtBeginCustomFilters14\", */T: 1\n    },\n    0x049C: {/* n:\"BrtCustomFilter14\" */},\n    0x049D: {/* n:\"BrtIconFilter14\" */},\n    0x049E: {/* n:\"BrtPivotCacheConnectionName\" */},\n    0x0800: {\n      /* n:\"BrtBeginDecoupledPivotCacheIDs\", */T: 1\n    },\n    0x0801: {\n      /* n:\"BrtEndDecoupledPivotCacheIDs\", */T: -1\n    },\n    0x0802: {/* n:\"BrtDecoupledPivotCacheID\" */},\n    0x0803: {\n      /* n:\"BrtBeginPivotTableRefs\", */T: 1\n    },\n    0x0804: {\n      /* n:\"BrtEndPivotTableRefs\", */T: -1\n    },\n    0x0805: {/* n:\"BrtPivotTableRef\" */},\n    0x0806: {/* n:\"BrtSlicerCacheBookPivotTables\" */},\n    0x0807: {\n      /* n:\"BrtBeginSxvcells\", */T: 1\n    },\n    0x0808: {\n      /* n:\"BrtEndSxvcells\", */T: -1\n    },\n    0x0809: {\n      /* n:\"BrtBeginSxRow\", */T: 1\n    },\n    0x080A: {\n      /* n:\"BrtEndSxRow\", */T: -1\n    },\n    0x080C: {/* n:\"BrtPcdCalcMem15\" */},\n    0x0813: {/* n:\"BrtQsi15\" */},\n    0x0814: {\n      /* n:\"BrtBeginWebExtensions\", */T: 1\n    },\n    0x0815: {\n      /* n:\"BrtEndWebExtensions\", */T: -1\n    },\n    0x0816: {/* n:\"BrtWebExtension\" */},\n    0x0817: {/* n:\"BrtAbsPath15\" */},\n    0x0818: {\n      /* n:\"BrtBeginPivotTableUISettings\", */T: 1\n    },\n    0x0819: {\n      /* n:\"BrtEndPivotTableUISettings\", */T: -1\n    },\n    0x081B: {/* n:\"BrtTableSlicerCacheIDs\" */},\n    0x081C: {/* n:\"BrtTableSlicerCacheID\" */},\n    0x081D: {\n      /* n:\"BrtBeginTableSlicerCache\", */T: 1\n    },\n    0x081E: {\n      /* n:\"BrtEndTableSlicerCache\", */T: -1\n    },\n    0x081F: {/* n:\"BrtSxFilter15\" */},\n    0x0820: {\n      /* n:\"BrtBeginTimelineCachePivotCacheIDs\", */T: 1\n    },\n    0x0821: {\n      /* n:\"BrtEndTimelineCachePivotCacheIDs\", */T: -1\n    },\n    0x0822: {/* n:\"BrtTimelineCachePivotCacheID\" */},\n    0x0823: {\n      /* n:\"BrtBeginTimelineCacheIDs\", */T: 1\n    },\n    0x0824: {\n      /* n:\"BrtEndTimelineCacheIDs\", */T: -1\n    },\n    0x0825: {\n      /* n:\"BrtBeginTimelineCacheID\", */T: 1\n    },\n    0x0826: {\n      /* n:\"BrtEndTimelineCacheID\", */T: -1\n    },\n    0x0827: {\n      /* n:\"BrtBeginTimelinesEx\", */T: 1\n    },\n    0x0828: {\n      /* n:\"BrtEndTimelinesEx\", */T: -1\n    },\n    0x0829: {\n      /* n:\"BrtBeginTimelineEx\", */T: 1\n    },\n    0x082A: {\n      /* n:\"BrtEndTimelineEx\", */T: -1\n    },\n    0x082B: {/* n:\"BrtWorkBookPr15\" */},\n    0x082C: {/* n:\"BrtPCDH15\" */},\n    0x082D: {\n      /* n:\"BrtBeginTimelineStyle\", */T: 1\n    },\n    0x082E: {\n      /* n:\"BrtEndTimelineStyle\", */T: -1\n    },\n    0x082F: {/* n:\"BrtTimelineStyleElement\" */},\n    0x0830: {\n      /* n:\"BrtBeginTimelineStylesheetExt15\", */T: 1\n    },\n    0x0831: {\n      /* n:\"BrtEndTimelineStylesheetExt15\", */T: -1\n    },\n    0x0832: {\n      /* n:\"BrtBeginTimelineStyles\", */T: 1\n    },\n    0x0833: {\n      /* n:\"BrtEndTimelineStyles\", */T: -1\n    },\n    0x0834: {\n      /* n:\"BrtBeginTimelineStyleElements\", */T: 1\n    },\n    0x0835: {\n      /* n:\"BrtEndTimelineStyleElements\", */T: -1\n    },\n    0x0836: {/* n:\"BrtDxf15\" */},\n    0x0837: {\n      /* n:\"BrtBeginDxfs15\", */T: 1\n    },\n    0x0838: {\n      /* n:\"BrtEndDxfs15\", */T: -1\n    },\n    0x0839: {/* n:\"BrtSlicerCacheHideItemsWithNoData\" */},\n    0x083A: {\n      /* n:\"BrtBeginItemUniqueNames\", */T: 1\n    },\n    0x083B: {\n      /* n:\"BrtEndItemUniqueNames\", */T: -1\n    },\n    0x083C: {/* n:\"BrtItemUniqueName\" */},\n    0x083D: {\n      /* n:\"BrtBeginExtConn15\", */T: 1\n    },\n    0x083E: {\n      /* n:\"BrtEndExtConn15\", */T: -1\n    },\n    0x083F: {\n      /* n:\"BrtBeginOledbPr15\", */T: 1\n    },\n    0x0840: {\n      /* n:\"BrtEndOledbPr15\", */T: -1\n    },\n    0x0841: {\n      /* n:\"BrtBeginDataFeedPr15\", */T: 1\n    },\n    0x0842: {\n      /* n:\"BrtEndDataFeedPr15\", */T: -1\n    },\n    0x0843: {/* n:\"BrtTextPr15\" */},\n    0x0844: {/* n:\"BrtRangePr15\" */},\n    0x0845: {/* n:\"BrtDbCommand15\" */},\n    0x0846: {\n      /* n:\"BrtBeginDbTables15\", */T: 1\n    },\n    0x0847: {\n      /* n:\"BrtEndDbTables15\", */T: -1\n    },\n    0x0848: {/* n:\"BrtDbTable15\" */},\n    0x0849: {\n      /* n:\"BrtBeginDataModel\", */T: 1\n    },\n    0x084A: {\n      /* n:\"BrtEndDataModel\", */T: -1\n    },\n    0x084B: {\n      /* n:\"BrtBeginModelTables\", */T: 1\n    },\n    0x084C: {\n      /* n:\"BrtEndModelTables\", */T: -1\n    },\n    0x084D: {/* n:\"BrtModelTable\" */},\n    0x084E: {\n      /* n:\"BrtBeginModelRelationships\", */T: 1\n    },\n    0x084F: {\n      /* n:\"BrtEndModelRelationships\", */T: -1\n    },\n    0x0850: {/* n:\"BrtModelRelationship\" */},\n    0x0851: {\n      /* n:\"BrtBeginECTxtWiz15\", */T: 1\n    },\n    0x0852: {\n      /* n:\"BrtEndECTxtWiz15\", */T: -1\n    },\n    0x0853: {\n      /* n:\"BrtBeginECTWFldInfoLst15\", */T: 1\n    },\n    0x0854: {\n      /* n:\"BrtEndECTWFldInfoLst15\", */T: -1\n    },\n    0x0855: {\n      /* n:\"BrtBeginECTWFldInfo15\", */T: 1\n    },\n    0x0856: {/* n:\"BrtFieldListActiveItem\" */},\n    0x0857: {/* n:\"BrtPivotCacheIdVersion\" */},\n    0x0858: {/* n:\"BrtSXDI15\" */},\n    0x0859: {\n      /* n:\"BrtBeginModelTimeGroupings\", */T: 1\n    },\n    0x085A: {\n      /* n:\"BrtEndModelTimeGroupings\", */T: -1\n    },\n    0x085B: {\n      /* n:\"BrtBeginModelTimeGrouping\", */T: 1\n    },\n    0x085C: {\n      /* n:\"BrtEndModelTimeGrouping\", */T: -1\n    },\n    0x085D: {/* n:\"BrtModelTimeGroupingCalcCol\" */},\n    0x0C00: {/* n:\"BrtUid\" */},\n    0x0C01: {/* n:\"BrtRevisionPtr\" */},\n    0x1000: {\n      /* n:\"BrtBeginDynamicArrayPr\", */T: 1\n    },\n    0x1001: {\n      /* n:\"BrtEndDynamicArrayPr\", */T: -1\n    },\n    0x138A: {\n      /* n:\"BrtBeginRichValueBlock\", */T: 1\n    },\n    0x138B: {\n      /* n:\"BrtEndRichValueBlock\", */T: -1\n    },\n    0x13D9: {\n      /* n:\"BrtBeginRichFilters\", */T: 1\n    },\n    0x13DA: {\n      /* n:\"BrtEndRichFilters\", */T: -1\n    },\n    0x13DB: {/* n:\"BrtRichFilter\" */},\n    0x13DC: {\n      /* n:\"BrtBeginRichFilterColumn\", */T: 1\n    },\n    0x13DD: {\n      /* n:\"BrtEndRichFilterColumn\", */T: -1\n    },\n    0x13DE: {\n      /* n:\"BrtBeginCustomRichFilters\", */T: 1\n    },\n    0x13DF: {\n      /* n:\"BrtEndCustomRichFilters\", */T: -1\n    },\n    0x13E0: {/* n:\"BrtCustomRichFilter\" */},\n    0x13E1: {/* n:\"BrtTop10RichFilter\" */},\n    0x13E2: {/* n:\"BrtDynamicRichFilter\" */},\n    0x13E4: {\n      /* n:\"BrtBeginRichSortCondition\", */T: 1\n    },\n    0x13E5: {\n      /* n:\"BrtEndRichSortCondition\", */T: -1\n    },\n    0x13E6: {/* n:\"BrtRichFilterDateGroupItem\" */},\n    0x13E7: {\n      /* n:\"BrtBeginCalcFeatures\", */T: 1\n    },\n    0x13E8: {\n      /* n:\"BrtEndCalcFeatures\", */T: -1\n    },\n    0x13E9: {/* n:\"BrtCalcFeature\" */},\n    0x13EB: {/* n:\"BrtExternalLinksPr\" */},\n    0xFFFF: {\n      n: \"\"\n    }\n  };\n\n  /* [MS-XLS] 2.3 Record Enumeration (and other sources) */\n  var XLSRecordEnum = {\n    /* [MS-XLS] 2.3 Record Enumeration 2021-08-17 */\n    0x0006: {\n      /* n:\"Formula\", */f: parse_Formula\n    },\n    0x000a: {\n      /* n:\"EOF\", */f: parsenoop2\n    },\n    0x000c: {\n      /* n:\"CalcCount\", */f: parseuint16\n    },\n    //\n    0x000d: {\n      /* n:\"CalcMode\", */f: parseuint16\n    },\n    //\n    0x000e: {\n      /* n:\"CalcPrecision\", */f: parsebool\n    },\n    //\n    0x000f: {\n      /* n:\"CalcRefMode\", */f: parsebool\n    },\n    //\n    0x0010: {\n      /* n:\"CalcDelta\", */f: parse_Xnum\n    },\n    //\n    0x0011: {\n      /* n:\"CalcIter\", */f: parsebool\n    },\n    //\n    0x0012: {\n      /* n:\"Protect\", */f: parsebool\n    },\n    0x0013: {\n      /* n:\"Password\", */f: parseuint16\n    },\n    0x0014: {\n      /* n:\"Header\", */f: parse_XLHeaderFooter\n    },\n    0x0015: {\n      /* n:\"Footer\", */f: parse_XLHeaderFooter\n    },\n    0x0017: {\n      /* n:\"ExternSheet\", */f: parse_ExternSheet\n    },\n    0x0018: {\n      /* n:\"Lbl\", */f: parse_Lbl\n    },\n    0x0019: {\n      /* n:\"WinProtect\", */f: parsebool\n    },\n    0x001a: {/* n:\"VerticalPageBreaks\", */},\n    0x001b: {/* n:\"HorizontalPageBreaks\", */},\n    0x001c: {\n      /* n:\"Note\", */f: parse_Note\n    },\n    0x001d: {/* n:\"Selection\", */},\n    0x0022: {\n      /* n:\"Date1904\", */f: parsebool\n    },\n    0x0023: {\n      /* n:\"ExternName\", */f: parse_ExternName\n    },\n    0x0026: {\n      /* n:\"LeftMargin\", */f: parse_Xnum\n    },\n    // *\n    0x0027: {\n      /* n:\"RightMargin\", */f: parse_Xnum\n    },\n    // *\n    0x0028: {\n      /* n:\"TopMargin\", */f: parse_Xnum\n    },\n    // *\n    0x0029: {\n      /* n:\"BottomMargin\", */f: parse_Xnum\n    },\n    // *\n    0x002a: {\n      /* n:\"PrintRowCol\", */f: parsebool\n    },\n    0x002b: {\n      /* n:\"PrintGrid\", */f: parsebool\n    },\n    0x002f: {\n      /* n:\"FilePass\", */f: parse_FilePass\n    },\n    0x0031: {\n      /* n:\"Font\", */f: parse_Font\n    },\n    0x0033: {\n      /* n:\"PrintSize\", */f: parseuint16\n    },\n    0x003c: {/* n:\"Continue\", */},\n    0x003d: {\n      /* n:\"Window1\", */f: parse_Window1\n    },\n    0x0040: {\n      /* n:\"Backup\", */f: parsebool\n    },\n    0x0041: {\n      /* n:\"Pane\", */f: parse_Pane\n    },\n    0x0042: {\n      /* n:\"CodePage\", */f: parseuint16\n    },\n    0x004d: {/* n:\"Pls\", */},\n    0x0050: {/* n:\"DCon\", */},\n    0x0051: {/* n:\"DConRef\", */},\n    0x0052: {/* n:\"DConName\", */},\n    0x0055: {\n      /* n:\"DefColWidth\", */f: parseuint16\n    },\n    0x0059: {/* n:\"XCT\", */},\n    0x005a: {/* n:\"CRN\", */},\n    0x005b: {/* n:\"FileSharing\", */},\n    0x005c: {\n      /* n:\"WriteAccess\", */f: parse_WriteAccess\n    },\n    0x005d: {\n      /* n:\"Obj\", */f: parse_Obj\n    },\n    0x005e: {/* n:\"Uncalced\", */},\n    0x005f: {\n      /* n:\"CalcSaveRecalc\", */f: parsebool\n    },\n    //\n    0x0060: {/* n:\"Template\", */},\n    0x0061: {/* n:\"Intl\", */},\n    0x0063: {\n      /* n:\"ObjProtect\", */f: parsebool\n    },\n    0x007d: {\n      /* n:\"ColInfo\", */f: parse_ColInfo\n    },\n    0x0080: {\n      /* n:\"Guts\", */f: parse_Guts\n    },\n    0x0081: {\n      /* n:\"WsBool\", */f: parse_WsBool\n    },\n    0x0082: {\n      /* n:\"GridSet\", */f: parseuint16\n    },\n    0x0083: {\n      /* n:\"HCenter\", */f: parsebool\n    },\n    0x0084: {\n      /* n:\"VCenter\", */f: parsebool\n    },\n    0x0085: {\n      /* n:\"BoundSheet8\", */f: parse_BoundSheet8\n    },\n    0x0086: {/* n:\"WriteProtect\", */},\n    0x008c: {\n      /* n:\"Country\", */f: parse_Country\n    },\n    0x008d: {\n      /* n:\"HideObj\", */f: parseuint16\n    },\n    0x0090: {/* n:\"Sort\", */},\n    0x0092: {\n      /* n:\"Palette\", */f: parse_Palette\n    },\n    0x0097: {/* n:\"Sync\", */},\n    0x0098: {/* n:\"LPr\", */},\n    0x0099: {/* n:\"DxGCol\", */},\n    0x009a: {/* n:\"FnGroupName\", */},\n    0x009b: {/* n:\"FilterMode\", */},\n    0x009c: {\n      /* n:\"BuiltInFnGroupCount\", */f: parseuint16\n    },\n    0x009d: {/* n:\"AutoFilterInfo\", */},\n    0x009e: {/* n:\"AutoFilter\", */},\n    0x00a0: {\n      /* n:\"Scl\", */f: parse_Scl\n    },\n    0x00a1: {\n      /* n:\"Setup\", */f: parse_Setup\n    },\n    0x00ae: {/* n:\"ScenMan\", */},\n    0x00af: {/* n:\"SCENARIO\", */},\n    0x00b0: {/* n:\"SxView\", */},\n    0x00b1: {/* n:\"Sxvd\", */},\n    0x00b2: {/* n:\"SXVI\", */},\n    0x00b4: {/* n:\"SxIvd\", */},\n    0x00b5: {/* n:\"SXLI\", */},\n    0x00b6: {/* n:\"SXPI\", */},\n    0x00b8: {/* n:\"DocRoute\", */},\n    0x00b9: {/* n:\"RecipName\", */},\n    0x00bd: {\n      /* n:\"MulRk\", */f: parse_MulRk\n    },\n    0x00be: {\n      /* n:\"MulBlank\", */f: parse_MulBlank\n    },\n    0x00c1: {\n      /* n:\"Mms\", */f: parsenoop2\n    },\n    0x00c5: {/* n:\"SXDI\", */},\n    0x00c6: {/* n:\"SXDB\", */},\n    0x00c7: {/* n:\"SXFDB\", */},\n    0x00c8: {/* n:\"SXDBB\", */},\n    0x00c9: {/* n:\"SXNum\", */},\n    0x00ca: {\n      /* n:\"SxBool\", */f: parsebool\n    },\n    0x00cb: {/* n:\"SxErr\", */},\n    0x00cc: {/* n:\"SXInt\", */},\n    0x00cd: {/* n:\"SXString\", */},\n    0x00ce: {/* n:\"SXDtr\", */},\n    0x00cf: {/* n:\"SxNil\", */},\n    0x00d0: {/* n:\"SXTbl\", */},\n    0x00d1: {/* n:\"SXTBRGIITM\", */},\n    0x00d2: {/* n:\"SxTbpg\", */},\n    0x00d3: {/* n:\"ObProj\", */},\n    0x00d5: {/* n:\"SXStreamID\", */},\n    0x00d7: {/* n:\"DBCell\", */},\n    0x00d8: {/* n:\"SXRng\", */},\n    0x00d9: {/* n:\"SxIsxoper\", */},\n    0x00da: {\n      /* n:\"BookBool\", */f: parseuint16\n    },\n    0x00dc: {/* n:\"DbOrParamQry\", */},\n    0x00dd: {\n      /* n:\"ScenarioProtect\", */f: parsebool\n    },\n    0x00de: {/* n:\"OleObjectSize\", */},\n    0x00e0: {\n      /* n:\"XF\", */f: parse_XF\n    },\n    0x00e1: {\n      /* n:\"InterfaceHdr\", */f: parse_InterfaceHdr\n    },\n    0x00e2: {\n      /* n:\"InterfaceEnd\", */f: parsenoop2\n    },\n    0x00e3: {/* n:\"SXVS\", */},\n    0x00e5: {\n      /* n:\"MergeCells\", */f: parse_MergeCells\n    },\n    0x00e9: {/* n:\"BkHim\", */},\n    0x00eb: {/* n:\"MsoDrawingGroup\", */},\n    0x00ec: {/* n:\"MsoDrawing\", */},\n    0x00ed: {/* n:\"MsoDrawingSelection\", */},\n    0x00ef: {/* n:\"PhoneticInfo\", */},\n    0x00f0: {/* n:\"SxRule\", */},\n    0x00f1: {/* n:\"SXEx\", */},\n    0x00f2: {/* n:\"SxFilt\", */},\n    0x00f4: {/* n:\"SxDXF\", */},\n    0x00f5: {/* n:\"SxItm\", */},\n    0x00f6: {/* n:\"SxName\", */},\n    0x00f7: {/* n:\"SxSelect\", */},\n    0x00f8: {/* n:\"SXPair\", */},\n    0x00f9: {/* n:\"SxFmla\", */},\n    0x00fb: {/* n:\"SxFormat\", */},\n    0x00fc: {\n      /* n:\"SST\", */f: parse_SST\n    },\n    0x00fd: {\n      /* n:\"LabelSst\", */f: parse_LabelSst\n    },\n    0x00ff: {\n      /* n:\"ExtSST\", */f: parse_ExtSST\n    },\n    0x0100: {/* n:\"SXVDEx\", */},\n    0x0103: {/* n:\"SXFormula\", */},\n    0x0122: {/* n:\"SXDBEx\", */},\n    0x0137: {/* n:\"RRDInsDel\", */},\n    0x0138: {/* n:\"RRDHead\", */},\n    0x013b: {/* n:\"RRDChgCell\", */},\n    0x013d: {\n      /* n:\"RRTabId\", */f: parseuint16a\n    },\n    0x013e: {/* n:\"RRDRenSheet\", */},\n    0x013f: {/* n:\"RRSort\", */},\n    0x0140: {/* n:\"RRDMove\", */},\n    0x014a: {/* n:\"RRFormat\", */},\n    0x014b: {/* n:\"RRAutoFmt\", */},\n    0x014d: {/* n:\"RRInsertSh\", */},\n    0x014e: {/* n:\"RRDMoveBegin\", */},\n    0x014f: {/* n:\"RRDMoveEnd\", */},\n    0x0150: {/* n:\"RRDInsDelBegin\", */},\n    0x0151: {/* n:\"RRDInsDelEnd\", */},\n    0x0152: {/* n:\"RRDConflict\", */},\n    0x0153: {/* n:\"RRDDefName\", */},\n    0x0154: {/* n:\"RRDRstEtxp\", */},\n    0x015f: {/* n:\"LRng\", */},\n    0x0160: {\n      /* n:\"UsesELFs\", */f: parsebool\n    },\n    0x0161: {\n      /* n:\"DSF\", */f: parsenoop2\n    },\n    0x0191: {/* n:\"CUsr\", */},\n    0x0192: {/* n:\"CbUsr\", */},\n    0x0193: {/* n:\"UsrInfo\", */},\n    0x0194: {/* n:\"UsrExcl\", */},\n    0x0195: {/* n:\"FileLock\", */},\n    0x0196: {/* n:\"RRDInfo\", */},\n    0x0197: {/* n:\"BCUsrs\", */},\n    0x0198: {/* n:\"UsrChk\", */},\n    0x01a9: {/* n:\"UserBView\", */},\n    0x01aa: {/* n:\"UserSViewBegin\", */},\n    0x01ab: {/* n:\"UserSViewEnd\", */},\n    0x01ac: {/* n:\"RRDUserView\", */},\n    0x01ad: {/* n:\"Qsi\", */},\n    0x01ae: {\n      /* n:\"SupBook\", */f: parse_SupBook\n    },\n    0x01af: {\n      /* n:\"Prot4Rev\", */f: parsebool\n    },\n    0x01b0: {/* n:\"CondFmt\", */},\n    0x01b1: {/* n:\"CF\", */},\n    0x01b2: {/* n:\"DVal\", */},\n    0x01b5: {/* n:\"DConBin\", */},\n    0x01b6: {\n      /* n:\"TxO\", */f: parse_TxO\n    },\n    0x01b7: {\n      /* n:\"RefreshAll\", */f: parsebool\n    },\n    //\n    0x01b8: {\n      /* n:\"HLink\", */f: parse_HLink\n    },\n    0x01b9: {/* n:\"Lel\", */},\n    0x01ba: {\n      /* n:\"CodeName\", */f: parse_XLUnicodeString\n    },\n    0x01bb: {/* n:\"SXFDBType\", */},\n    0x01bc: {\n      /* n:\"Prot4RevPass\", */f: parseuint16\n    },\n    0x01bd: {/* n:\"ObNoMacros\", */},\n    0x01be: {/* n:\"Dv\", */},\n    0x01c0: {\n      /* n:\"Excel9File\", */f: parsenoop2\n    },\n    0x01c1: {\n      /* n:\"RecalcId\", */f: parse_RecalcId,\n      r: 2\n    },\n    0x01c2: {\n      /* n:\"EntExU2\", */f: parsenoop2\n    },\n    0x0200: {\n      /* n:\"Dimensions\", */f: parse_Dimensions\n    },\n    0x0201: {\n      /* n:\"Blank\", */f: parse_Blank\n    },\n    0x0203: {\n      /* n:\"Number\", */f: parse_Number\n    },\n    0x0204: {\n      /* n:\"Label\", */f: parse_Label\n    },\n    0x0205: {\n      /* n:\"BoolErr\", */f: parse_BoolErr\n    },\n    0x0207: {\n      /* n:\"String\", */f: parse_String\n    },\n    0x0208: {\n      /* n:\"Row\", */f: parse_Row\n    },\n    0x020b: {/* n:\"Index\", */},\n    0x0221: {\n      /* n:\"Array\", */f: parse_Array\n    },\n    0x0225: {\n      /* n:\"DefaultRowHeight\", */f: parse_DefaultRowHeight\n    },\n    0x0236: {/* n:\"Table\", */},\n    0x023e: {\n      /* n:\"Window2\", */f: parse_Window2\n    },\n    0x027e: {\n      /* n:\"RK\", */f: parse_RK\n    },\n    0x0293: {/* n:\"Style\", */},\n    0x0418: {/* n:\"BigName\", */},\n    0x041e: {\n      /* n:\"Format\", */f: parse_Format\n    },\n    0x043c: {/* n:\"ContinueBigName\", */},\n    0x04bc: {\n      /* n:\"ShrFmla\", */f: parse_ShrFmla\n    },\n    0x0800: {\n      /* n:\"HLinkTooltip\", */f: parse_HLinkTooltip\n    },\n    0x0801: {/* n:\"WebPub\", */},\n    0x0802: {/* n:\"QsiSXTag\", */},\n    0x0803: {/* n:\"DBQueryExt\", */},\n    0x0804: {/* n:\"ExtString\", */},\n    0x0805: {/* n:\"TxtQry\", */},\n    0x0806: {/* n:\"Qsir\", */},\n    0x0807: {/* n:\"Qsif\", */},\n    0x0808: {/* n:\"RRDTQSIF\", */},\n    0x0809: {\n      /* n:\"BOF\", */f: parse_BOF\n    },\n    0x080a: {/* n:\"OleDbConn\", */},\n    0x080b: {/* n:\"WOpt\", */},\n    0x080c: {/* n:\"SXViewEx\", */},\n    0x080d: {/* n:\"SXTH\", */},\n    0x080e: {/* n:\"SXPIEx\", */},\n    0x080f: {/* n:\"SXVDTEx\", */},\n    0x0810: {/* n:\"SXViewEx9\", */},\n    0x0812: {/* n:\"ContinueFrt\", */},\n    0x0813: {/* n:\"RealTimeData\", */},\n    0x0850: {/* n:\"ChartFrtInfo\", */},\n    0x0851: {/* n:\"FrtWrapper\", */},\n    0x0852: {/* n:\"StartBlock\", */},\n    0x0853: {/* n:\"EndBlock\", */},\n    0x0854: {/* n:\"StartObject\", */},\n    0x0855: {/* n:\"EndObject\", */},\n    0x0856: {/* n:\"CatLab\", */},\n    0x0857: {/* n:\"YMult\", */},\n    0x0858: {/* n:\"SXViewLink\", */},\n    0x0859: {/* n:\"PivotChartBits\", */},\n    0x085a: {/* n:\"FrtFontList\", */},\n    0x0862: {/* n:\"SheetExt\", */},\n    0x0863: {\n      /* n:\"BookExt\", */r: 12\n    },\n    0x0864: {/* n:\"SXAddl\", */},\n    0x0865: {/* n:\"CrErr\", */},\n    0x0866: {/* n:\"HFPicture\", */},\n    0x0867: {\n      /* n:\"FeatHdr\", */f: parsenoop2\n    },\n    0x0868: {/* n:\"Feat\", */},\n    0x086a: {/* n:\"DataLabExt\", */},\n    0x086b: {/* n:\"DataLabExtContents\", */},\n    0x086c: {/* n:\"CellWatch\", */},\n    0x0871: {/* n:\"FeatHdr11\", */},\n    0x0872: {/* n:\"Feature11\", */},\n    0x0874: {/* n:\"DropDownObjIds\", */},\n    0x0875: {/* n:\"ContinueFrt11\", */},\n    0x0876: {/* n:\"DConn\", */},\n    0x0877: {/* n:\"List12\", */},\n    0x0878: {/* n:\"Feature12\", */},\n    0x0879: {/* n:\"CondFmt12\", */},\n    0x087a: {/* n:\"CF12\", */},\n    0x087b: {/* n:\"CFEx\", */},\n    0x087c: {\n      /* n:\"XFCRC\", */f: parse_XFCRC,\n      r: 12\n    },\n    0x087d: {\n      /* n:\"XFExt\", */f: parse_XFExt,\n      r: 12\n    },\n    0x087e: {/* n:\"AutoFilter12\", */},\n    0x087f: {/* n:\"ContinueFrt12\", */},\n    0x0884: {/* n:\"MDTInfo\", */},\n    0x0885: {/* n:\"MDXStr\", */},\n    0x0886: {/* n:\"MDXTuple\", */},\n    0x0887: {/* n:\"MDXSet\", */},\n    0x0888: {/* n:\"MDXProp\", */},\n    0x0889: {/* n:\"MDXKPI\", */},\n    0x088a: {/* n:\"MDB\", */},\n    0x088b: {/* n:\"PLV\", */},\n    0x088c: {\n      /* n:\"Compat12\", */f: parsebool,\n      r: 12\n    },\n    0x088d: {/* n:\"DXF\", */},\n    0x088e: {\n      /* n:\"TableStyles\", */r: 12\n    },\n    0x088f: {/* n:\"TableStyle\", */},\n    0x0890: {/* n:\"TableStyleElement\", */},\n    0x0892: {/* n:\"StyleExt\", */},\n    0x0893: {/* n:\"NamePublish\", */},\n    0x0894: {\n      /* n:\"NameCmt\", */f: parse_NameCmt,\n      r: 12\n    },\n    0x0895: {/* n:\"SortData\", */},\n    0x0896: {\n      /* n:\"Theme\", */f: parse_Theme,\n      r: 12\n    },\n    0x0897: {/* n:\"GUIDTypeLib\", */},\n    0x0898: {/* n:\"FnGrp12\", */},\n    0x0899: {/* n:\"NameFnGrp12\", */},\n    0x089a: {\n      /* n:\"MTRSettings\", */f: parse_MTRSettings,\n      r: 12\n    },\n    0x089b: {\n      /* n:\"CompressPictures\", */f: parsenoop2\n    },\n    0x089c: {/* n:\"HeaderFooter\", */},\n    0x089d: {/* n:\"CrtLayout12\", */},\n    0x089e: {/* n:\"CrtMlFrt\", */},\n    0x089f: {/* n:\"CrtMlFrtContinue\", */},\n    0x08a3: {\n      /* n:\"ForceFullCalculation\", */f: parse_ForceFullCalculation\n    },\n    0x08a4: {/* n:\"ShapePropsStream\", */},\n    0x08a5: {/* n:\"TextPropsStream\", */},\n    0x08a6: {/* n:\"RichTextStream\", */},\n    0x08a7: {/* n:\"CrtLayout12A\", */},\n    0x1001: {/* n:\"Units\", */},\n    0x1002: {/* n:\"Chart\", */},\n    0x1003: {/* n:\"Series\", */},\n    0x1006: {/* n:\"DataFormat\", */},\n    0x1007: {/* n:\"LineFormat\", */},\n    0x1009: {/* n:\"MarkerFormat\", */},\n    0x100a: {/* n:\"AreaFormat\", */},\n    0x100b: {/* n:\"PieFormat\", */},\n    0x100c: {/* n:\"AttachedLabel\", */},\n    0x100d: {/* n:\"SeriesText\", */},\n    0x1014: {/* n:\"ChartFormat\", */},\n    0x1015: {/* n:\"Legend\", */},\n    0x1016: {/* n:\"SeriesList\", */},\n    0x1017: {/* n:\"Bar\", */},\n    0x1018: {/* n:\"Line\", */},\n    0x1019: {/* n:\"Pie\", */},\n    0x101a: {/* n:\"Area\", */},\n    0x101b: {/* n:\"Scatter\", */},\n    0x101c: {/* n:\"CrtLine\", */},\n    0x101d: {/* n:\"Axis\", */},\n    0x101e: {/* n:\"Tick\", */},\n    0x101f: {/* n:\"ValueRange\", */},\n    0x1020: {/* n:\"CatSerRange\", */},\n    0x1021: {/* n:\"AxisLine\", */},\n    0x1022: {/* n:\"CrtLink\", */},\n    0x1024: {/* n:\"DefaultText\", */},\n    0x1025: {/* n:\"Text\", */},\n    0x1026: {\n      /* n:\"FontX\", */f: parseuint16\n    },\n    0x1027: {/* n:\"ObjectLink\", */},\n    0x1032: {/* n:\"Frame\", */},\n    0x1033: {/* n:\"Begin\", */},\n    0x1034: {/* n:\"End\", */},\n    0x1035: {/* n:\"PlotArea\", */},\n    0x103a: {/* n:\"Chart3d\", */},\n    0x103c: {/* n:\"PicF\", */},\n    0x103d: {/* n:\"DropBar\", */},\n    0x103e: {/* n:\"Radar\", */},\n    0x103f: {/* n:\"Surf\", */},\n    0x1040: {/* n:\"RadarArea\", */},\n    0x1041: {/* n:\"AxisParent\", */},\n    0x1043: {/* n:\"LegendException\", */},\n    0x1044: {\n      /* n:\"ShtProps\", */f: parse_ShtProps\n    },\n    0x1045: {/* n:\"SerToCrt\", */},\n    0x1046: {/* n:\"AxesUsed\", */},\n    0x1048: {/* n:\"SBaseRef\", */},\n    0x104a: {/* n:\"SerParent\", */},\n    0x104b: {/* n:\"SerAuxTrend\", */},\n    0x104e: {/* n:\"IFmtRecord\", */},\n    0x104f: {/* n:\"Pos\", */},\n    0x1050: {/* n:\"AlRuns\", */},\n    0x1051: {/* n:\"BRAI\", */},\n    0x105b: {/* n:\"SerAuxErrBar\", */},\n    0x105c: {\n      /* n:\"ClrtClient\", */f: parse_ClrtClient\n    },\n    0x105d: {/* n:\"SerFmt\", */},\n    0x105f: {/* n:\"Chart3DBarShape\", */},\n    0x1060: {/* n:\"Fbi\", */},\n    0x1061: {/* n:\"BopPop\", */},\n    0x1062: {/* n:\"AxcExt\", */},\n    0x1063: {/* n:\"Dat\", */},\n    0x1064: {/* n:\"PlotGrowth\", */},\n    0x1065: {/* n:\"SIIndex\", */},\n    0x1066: {/* n:\"GelFrame\", */},\n    0x1067: {/* n:\"BopPopCustom\", */},\n    0x1068: {/* n:\"Fbi2\", */},\n    0x0000: {\n      /* n:\"Dimensions\", */f: parse_Dimensions\n    },\n    0x0001: {/* n:\"BIFF2BLANK\", */},\n    0x0002: {\n      /* n:\"BIFF2INT\", */f: parse_BIFF2INT\n    },\n    0x0003: {\n      /* n:\"BIFF2NUM\", */f: parse_BIFF2NUM\n    },\n    0x0004: {\n      /* n:\"BIFF2STR\", */f: parse_BIFF2STR\n    },\n    0x0005: {\n      /* n:\"BoolErr\", */f: parse_BoolErr\n    },\n    0x0007: {\n      /* n:\"String\", */f: parse_BIFF2STRING\n    },\n    0x0008: {/* n:\"BIFF2ROW\", */},\n    0x0009: {\n      /* n:\"BOF\", */f: parse_BOF\n    },\n    0x000b: {/* n:\"Index\", */},\n    0x0016: {\n      /* n:\"ExternCount\", */f: parseuint16\n    },\n    0x001e: {\n      /* n:\"BIFF2FORMAT\", */f: parse_BIFF2Format\n    },\n    0x001f: {/* n:\"BIFF2FMTCNT\", */},\n    /* 16-bit cnt of BIFF2FORMAT records */\n    0x0020: {/* n:\"BIFF2COLINFO\", */},\n    0x0021: {\n      /* n:\"Array\", */f: parse_Array\n    },\n    0x0024: {/* n:\"COLWIDTH\", */},\n    0x0025: {\n      /* n:\"DefaultRowHeight\", */f: parse_DefaultRowHeight\n    },\n    // 0x2c ??\n    // 0x2d ??\n    // 0x2e ??\n    // 0x30 FONTCOUNT: number of fonts\n    0x0032: {\n      /* n:\"BIFF2FONTXTRA\", */f: parse_BIFF2FONTXTRA\n    },\n    // 0x35: INFOOPTS\n    // 0x36: TABLE (BIFF2 only)\n    // 0x37: TABLE2 (BIFF2 only)\n    // 0x38: WNDESK\n    // 0x39 ??\n    // 0x3a: BEGINPREF\n    // 0x3b: ENDPREF\n    0x003e: {/* n:\"BIFF2WINDOW2\", */},\n    // 0x3f ??\n    // 0x46: SHOWSCROLL\n    // 0x47: SHOWFORMULA\n    // 0x48: STATUSBAR\n    // 0x49: SHORTMENUS\n    // 0x4A:\n    // 0x4B:\n    // 0x4C:\n    // 0x4E:\n    // 0x4F:\n    // 0x58: TOOLBAR (BIFF3)\n\n    /* - - - */\n    0x0034: {/* n:\"DDEObjName\", */},\n    0x0043: {/* n:\"BIFF2XF\", */},\n    0x0044: {\n      /* n:\"BIFF2XFINDEX\", */f: parseuint16\n    },\n    0x0045: {/* n:\"BIFF2FONTCLR\", */},\n    0x0056: {/* n:\"BIFF4FMTCNT\", */},\n    /* 16-bit cnt, similar to BIFF2 */\n    0x007e: {/* n:\"RK\", */},\n    /* Not necessarily same as 0x027e */\n    0x007f: {\n      /* n:\"ImData\", */f: parse_ImData\n    },\n    0x0087: {/* n:\"Addin\", */},\n    0x0088: {/* n:\"Edg\", */},\n    0x0089: {/* n:\"Pub\", */},\n    // 0x8A\n    // 0x8B LH: alternate menu key flag (BIFF3/4)\n    // 0x8E\n    // 0x8F\n    0x0091: {/* n:\"Sub\", */},\n    // 0x93 STYLE\n    0x0094: {/* n:\"LHRecord\", */},\n    0x0095: {/* n:\"LHNGraph\", */},\n    0x0096: {/* n:\"Sound\", */},\n    // 0xA2 FNPROTO: function prototypes (BIFF4)\n    // 0xA3\n    // 0xA8\n    0x00a9: {/* n:\"CoordList\", */},\n    0x00ab: {/* n:\"GCW\", */},\n    0x00bc: {/* n:\"ShrFmla\", */},\n    /* Not necessarily same as 0x04bc */\n    0x00bf: {/* n:\"ToolbarHdr\", */},\n    0x00c0: {/* n:\"ToolbarEnd\", */},\n    0x00c2: {/* n:\"AddMenu\", */},\n    0x00c3: {/* n:\"DelMenu\", */},\n    0x00d6: {\n      /* n:\"RString\", */f: parse_RString\n    },\n    0x00df: {/* n:\"UDDesc\", */},\n    0x00ea: {/* n:\"TabIdConf\", */},\n    0x0162: {/* n:\"XL5Modify\", */},\n    0x01a5: {/* n:\"FileSharing2\", */},\n    0x0206: {\n      /* n:\"Formula\", */f: parse_Formula\n    },\n    0x0209: {\n      /* n:\"BOF\", */f: parse_BOF\n    },\n    0x0218: {\n      /* n:\"Lbl\", */f: parse_Lbl\n    },\n    0x0223: {\n      /* n:\"ExternName\", */f: parse_ExternName\n    },\n    0x0231: {/* n:\"Font\", */},\n    0x0243: {/* n:\"BIFF3XF\", */},\n    0x0406: {\n      /* n:\"Formula\", */f: parse_Formula\n    },\n    0x0409: {\n      /* n:\"BOF\", */f: parse_BOF\n    },\n    0x0443: {/* n:\"BIFF4XF\", */},\n    0x086d: {/* n:\"FeatInfo\", */},\n    0x0873: {/* n:\"FeatInfo11\", */},\n    0x0881: {/* n:\"SXAddl12\", */},\n    0x08c0: {/* n:\"AutoWebPub\", */},\n    0x08c1: {/* n:\"ListObj\", */},\n    0x08c2: {/* n:\"ListField\", */},\n    0x08c3: {/* n:\"ListDV\", */},\n    0x08c4: {/* n:\"ListCondFmt\", */},\n    0x08c5: {/* n:\"ListCF\", */},\n    0x08c6: {/* n:\"FMQry\", */},\n    0x08c7: {/* n:\"FMSQry\", */},\n    0x08c8: {/* n:\"PLV\", */},\n    0x08c9: {/* n:\"LnExt\", */},\n    0x08ca: {/* n:\"MkrExt\", */},\n    0x08cb: {/* n:\"CrtCoopt\", */},\n    0x08d6: {\n      /* n:\"FRTArchId$\", */r: 12\n    },\n    0x7262: {}\n  };\n  function write_biff_rec(ba, type, payload, length) {\n    var t = type;\n    if (isNaN(t)) return;\n    var len = length || (payload || []).length || 0;\n    var o = ba.next(4);\n    o.write_shift(2, t);\n    o.write_shift(2, len);\n    if (len > 0 && is_buf(payload)) ba.push(payload);\n  }\n  function write_biff_continue(ba, type, payload, length) {\n    var len = length || (payload || []).length || 0;\n    if (len <= 8224) return write_biff_rec(ba, type, payload, len);\n    var t = type;\n    if (isNaN(t)) return;\n    var parts = payload.parts || [],\n      sidx = 0;\n    var i = 0,\n      w = 0;\n    while (w + (parts[sidx] || 8224) <= 8224) {\n      w += parts[sidx] || 8224;\n      sidx++;\n    }\n    var o = ba.next(4);\n    o.write_shift(2, t);\n    o.write_shift(2, w);\n    ba.push(payload.slice(i, i + w));\n    i += w;\n    while (i < len) {\n      o = ba.next(4);\n      o.write_shift(2, 0x3c); // TODO: figure out correct continue type\n      w = 0;\n      while (w + (parts[sidx] || 8224) <= 8224) {\n        w += parts[sidx] || 8224;\n        sidx++;\n      }\n      o.write_shift(2, w);\n      ba.push(payload.slice(i, i + w));\n      i += w;\n    }\n  }\n  function write_BIFF2Cell(out, r, c) {\n    if (!out) out = new_buf(7);\n    out.write_shift(2, r);\n    out.write_shift(2, c);\n    out.write_shift(2, 0);\n    out.write_shift(1, 0);\n    return out;\n  }\n  function write_BIFF2BERR(r, c, val, t) {\n    var out = new_buf(9);\n    write_BIFF2Cell(out, r, c);\n    write_Bes(val, t || 'b', out);\n    return out;\n  }\n\n  /* TODO: codepage, large strings */\n  function write_BIFF2LABEL(r, c, val) {\n    var out = new_buf(8 + 2 * val.length);\n    write_BIFF2Cell(out, r, c);\n    out.write_shift(1, val.length);\n    out.write_shift(val.length, val, 'sbcs');\n    return out.l < out.length ? out.slice(0, out.l) : out;\n  }\n  function write_ws_biff2_cell(ba, cell, R, C) {\n    if (cell.v != null) switch (cell.t) {\n      case 'd':\n      case 'n':\n        var v = cell.t == 'd' ? datenum(parseDate(cell.v)) : cell.v;\n        if (v == (v | 0) && v >= 0 && v < 65536) write_biff_rec(ba, 0x0002, write_BIFF2INT(R, C, v));else write_biff_rec(ba, 0x0003, write_BIFF2NUM(R, C, v));\n        return;\n      case 'b':\n      case 'e':\n        write_biff_rec(ba, 0x0005, write_BIFF2BERR(R, C, cell.v, cell.t));\n        return;\n      /* TODO: codepage, sst */\n      case 's':\n      case 'str':\n        write_biff_rec(ba, 0x0004, write_BIFF2LABEL(R, C, (cell.v || \"\").slice(0, 255)));\n        return;\n    }\n    write_biff_rec(ba, 0x0001, write_BIFF2Cell(null, R, C));\n  }\n  function write_ws_biff2(ba, ws, idx, opts) {\n    var dense = Array.isArray(ws);\n    var range = safe_decode_range(ws['!ref'] || \"A1\"),\n      ref,\n      rr = \"\",\n      cols = [];\n    if (range.e.c > 0xFF || range.e.r > 0x3FFF) {\n      if (opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:IV16384\");\n      range.e.c = Math.min(range.e.c, 0xFF);\n      range.e.r = Math.min(range.e.c, 0x3FFF);\n      ref = encode_range(range);\n    }\n    for (var R = range.s.r; R <= range.e.r; ++R) {\n      rr = encode_row(R);\n      for (var C = range.s.c; C <= range.e.c; ++C) {\n        if (R === range.s.r) cols[C] = encode_col(C);\n        ref = cols[C] + rr;\n        var cell = dense ? (ws[R] || [])[C] : ws[ref];\n        if (!cell) continue;\n        /* write cell */\n        write_ws_biff2_cell(ba, cell, R, C, opts);\n      }\n    }\n  }\n\n  /* Based on test files */\n  function write_biff2_buf(wb, opts) {\n    var o = opts || {};\n    if (DENSE != null && o.dense == null) o.dense = DENSE;\n    var ba = buf_array();\n    var idx = 0;\n    for (var i = 0; i < wb.SheetNames.length; ++i) if (wb.SheetNames[i] == o.sheet) idx = i;\n    if (idx == 0 && !!o.sheet && wb.SheetNames[0] != o.sheet) throw new Error(\"Sheet not found: \" + o.sheet);\n    write_biff_rec(ba, o.biff == 4 ? 0x0409 : o.biff == 3 ? 0x0209 : 0x0009, write_BOF(wb, 0x10, o));\n    /* ... */\n    write_ws_biff2(ba, wb.Sheets[wb.SheetNames[idx]], idx, o, wb);\n    /* ... */\n    write_biff_rec(ba, 0x000A);\n    return ba.end();\n  }\n  function write_FONTS_biff8(ba, data, opts) {\n    write_biff_rec(ba, 0x0031 /* Font */, write_Font({\n      sz: 12,\n      color: {\n        theme: 1\n      },\n      name: \"Arial\",\n      family: 2,\n      scheme: \"minor\"\n    }, opts));\n  }\n  function write_FMTS_biff8(ba, NF, opts) {\n    if (!NF) return;\n    [[5, 8], [23, 26], [41, 44], [/*63*/50, /*66],[164,*/392]].forEach(function (r) {\n      for (var i = r[0]; i <= r[1]; ++i) if (NF[i] != null) write_biff_rec(ba, 0x041E /* Format */, write_Format(i, NF[i], opts));\n    });\n  }\n  function write_FEAT(ba, ws) {\n    /* [MS-XLS] 2.4.112 */\n    var o = new_buf(19);\n    o.write_shift(4, 0x867);\n    o.write_shift(4, 0);\n    o.write_shift(4, 0);\n    o.write_shift(2, 3);\n    o.write_shift(1, 1);\n    o.write_shift(4, 0);\n    write_biff_rec(ba, 0x0867 /* FeatHdr */, o);\n    /* [MS-XLS] 2.4.111 */\n    o = new_buf(39);\n    o.write_shift(4, 0x868);\n    o.write_shift(4, 0);\n    o.write_shift(4, 0);\n    o.write_shift(2, 3);\n    o.write_shift(1, 0);\n    o.write_shift(4, 0);\n    o.write_shift(2, 1);\n    o.write_shift(4, 4);\n    o.write_shift(2, 0);\n    write_Ref8U(safe_decode_range(ws['!ref'] || \"A1\"), o);\n    o.write_shift(4, 4);\n    write_biff_rec(ba, 0x0868 /* Feat */, o);\n  }\n  function write_CELLXFS_biff8(ba, opts) {\n    for (var i = 0; i < 16; ++i) write_biff_rec(ba, 0x00e0 /* XF */, write_XF({\n      numFmtId: 0,\n      style: true\n    }, 0, opts));\n    opts.cellXfs.forEach(function (c) {\n      write_biff_rec(ba, 0x00e0 /* XF */, write_XF(c, 0, opts));\n    });\n  }\n  function write_ws_biff8_hlinks(ba, ws) {\n    for (var R = 0; R < ws['!links'].length; ++R) {\n      var HL = ws['!links'][R];\n      write_biff_rec(ba, 0x01b8 /* HLink */, write_HLink(HL));\n      if (HL[1].Tooltip) write_biff_rec(ba, 0x0800 /* HLinkTooltip */, write_HLinkTooltip(HL));\n    }\n    delete ws['!links'];\n  }\n  function write_ws_cols_biff8(ba, cols) {\n    if (!cols) return;\n    var cnt = 0;\n    cols.forEach(function (col, idx) {\n      if (++cnt <= 256 && col) {\n        write_biff_rec(ba, 0x007d /* ColInfo */, write_ColInfo(col_obj_w(idx, col), idx));\n      }\n    });\n  }\n  function write_ws_biff8_cell(ba, cell, R, C, opts) {\n    var os = 16 + get_cell_style(opts.cellXfs, cell, opts);\n    if (cell.v == null && !cell.bf) {\n      write_biff_rec(ba, 0x0201 /* Blank */, write_XLSCell(R, C, os));\n      return;\n    }\n    if (cell.bf) write_biff_rec(ba, 0x0006 /* Formula */, write_Formula(cell, R, C, opts, os));else switch (cell.t) {\n      case 'd':\n      case 'n':\n        var v = cell.t == 'd' ? datenum(parseDate(cell.v)) : cell.v;\n        /* TODO: emit RK as appropriate */\n        write_biff_rec(ba, 0x0203 /* Number */, write_Number(R, C, v, os, opts));\n        break;\n      case 'b':\n      case 'e':\n        write_biff_rec(ba, 0x0205 /* BoolErr */, write_BoolErr(R, C, cell.v, os, opts, cell.t));\n        break;\n      /* TODO: codepage, sst */\n      case 's':\n      case 'str':\n        if (opts.bookSST) {\n          var isst = get_sst_id(opts.Strings, cell.v, opts.revStrings);\n          write_biff_rec(ba, 0x00fd /* LabelSst */, write_LabelSst(R, C, isst, os, opts));\n        } else write_biff_rec(ba, 0x0204 /* Label */, write_Label(R, C, (cell.v || \"\").slice(0, 255), os, opts));\n        break;\n      default:\n        write_biff_rec(ba, 0x0201 /* Blank */, write_XLSCell(R, C, os));\n    }\n  }\n\n  /* [MS-XLS] 2.1.7.20.5 */\n  function write_ws_biff8(idx, opts, wb) {\n    var ba = buf_array();\n    var s = wb.SheetNames[idx],\n      ws = wb.Sheets[s] || {};\n    var _WB = (wb || {}).Workbook || {};\n    var _sheet = (_WB.Sheets || [])[idx] || {};\n    var dense = Array.isArray(ws);\n    var b8 = opts.biff == 8;\n    var ref,\n      rr = \"\",\n      cols = [];\n    var range = safe_decode_range(ws['!ref'] || \"A1\");\n    var MAX_ROWS = b8 ? 65536 : 16384;\n    if (range.e.c > 0xFF || range.e.r >= MAX_ROWS) {\n      if (opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:IV16384\");\n      range.e.c = Math.min(range.e.c, 0xFF);\n      range.e.r = Math.min(range.e.c, MAX_ROWS - 1);\n    }\n    write_biff_rec(ba, 0x0809, write_BOF(wb, 0x10, opts));\n    /* [Uncalced] Index */\n    write_biff_rec(ba, 0x000d /* CalcMode */, writeuint16(1));\n    write_biff_rec(ba, 0x000c /* CalcCount */, writeuint16(100));\n    write_biff_rec(ba, 0x000f /* CalcRefMode */, writebool(true));\n    write_biff_rec(ba, 0x0011 /* CalcIter */, writebool(false));\n    write_biff_rec(ba, 0x0010 /* CalcDelta */, write_Xnum(0.001));\n    write_biff_rec(ba, 0x005f /* CalcSaveRecalc */, writebool(true));\n    write_biff_rec(ba, 0x002a /* PrintRowCol */, writebool(false));\n    write_biff_rec(ba, 0x002b /* PrintGrid */, writebool(false));\n    write_biff_rec(ba, 0x0082 /* GridSet */, writeuint16(1));\n    write_biff_rec(ba, 0x0080 /* Guts */, write_Guts([0, 0]));\n    /* DefaultRowHeight WsBool [Sync] [LPr] [HorizontalPageBreaks] [VerticalPageBreaks] */\n    /* Header (string) */\n    /* Footer (string) */\n    write_biff_rec(ba, 0x0083 /* HCenter */, writebool(false));\n    write_biff_rec(ba, 0x0084 /* VCenter */, writebool(false));\n    /* ... */\n    if (b8) write_ws_cols_biff8(ba, ws[\"!cols\"]);\n    /* ... */\n    write_biff_rec(ba, 0x200, write_Dimensions(range, opts));\n    /* ... */\n\n    if (b8) ws['!links'] = [];\n    for (var R = range.s.r; R <= range.e.r; ++R) {\n      rr = encode_row(R);\n      for (var C = range.s.c; C <= range.e.c; ++C) {\n        if (R === range.s.r) cols[C] = encode_col(C);\n        ref = cols[C] + rr;\n        var cell = dense ? (ws[R] || [])[C] : ws[ref];\n        if (!cell) continue;\n        /* write cell */\n        write_ws_biff8_cell(ba, cell, R, C, opts);\n        if (b8 && cell.l) ws['!links'].push([ref, cell.l]);\n      }\n    }\n    var cname = _sheet.CodeName || _sheet.name || s;\n    /* ... */\n    if (b8) write_biff_rec(ba, 0x023e /* Window2 */, write_Window2((_WB.Views || [])[0]));\n    /* ... */\n    if (b8 && (ws['!merges'] || []).length) write_biff_rec(ba, 0x00e5 /* MergeCells */, write_MergeCells(ws['!merges']));\n    /* [LRng] *QUERYTABLE [PHONETICINFO] CONDFMTS */\n    if (b8) write_ws_biff8_hlinks(ba, ws);\n    /* [DVAL] */\n    write_biff_rec(ba, 0x01ba /* CodeName */, write_XLUnicodeString(cname, opts));\n    /* *WebPub *CellWatch [SheetExt] */\n    if (b8) write_FEAT(ba, ws);\n    /* *FEAT11 *RECORD12 */\n    write_biff_rec(ba, 0x000a /* EOF */);\n    return ba.end();\n  }\n\n  /* [MS-XLS] 2.1.7.20.3 */\n  function write_biff8_global(wb, bufs, opts) {\n    var A = buf_array();\n    var _WB = (wb || {}).Workbook || {};\n    var _sheets = _WB.Sheets || [];\n    var _wb = _WB.WBProps || {};\n    var b8 = opts.biff == 8,\n      b5 = opts.biff == 5;\n    write_biff_rec(A, 0x0809, write_BOF(wb, 0x05, opts));\n    if (opts.bookType == \"xla\") write_biff_rec(A, 0x0087 /* Addin */);\n    write_biff_rec(A, 0x00e1 /* InterfaceHdr */, b8 ? writeuint16(0x04b0) : null);\n    write_biff_rec(A, 0x00c1 /* Mms */, writezeroes(2));\n    if (b5) write_biff_rec(A, 0x00bf /* ToolbarHdr */);\n    if (b5) write_biff_rec(A, 0x00c0 /* ToolbarEnd */);\n    write_biff_rec(A, 0x00e2 /* InterfaceEnd */);\n    write_biff_rec(A, 0x005c /* WriteAccess */, write_WriteAccess(\"SheetJS\", opts));\n    /* [FileSharing] */\n    write_biff_rec(A, 0x0042 /* CodePage */, writeuint16(b8 ? 0x04b0 : 0x04E4));\n    /* *2047 Lel */\n    if (b8) write_biff_rec(A, 0x0161 /* DSF */, writeuint16(0));\n    if (b8) write_biff_rec(A, 0x01c0 /* Excel9File */);\n    write_biff_rec(A, 0x013d /* RRTabId */, write_RRTabId(wb.SheetNames.length));\n    if (b8 && wb.vbaraw) write_biff_rec(A, 0x00d3 /* ObProj */);\n    /* [ObNoMacros] */\n    if (b8 && wb.vbaraw) {\n      var cname = _wb.CodeName || \"ThisWorkbook\";\n      write_biff_rec(A, 0x01ba /* CodeName */, write_XLUnicodeString(cname, opts));\n    }\n    write_biff_rec(A, 0x009c /* BuiltInFnGroupCount */, writeuint16(0x11));\n    /* *FnGroupName *FnGrp12 */\n    /* *Lbl */\n    /* [OleObjectSize] */\n    write_biff_rec(A, 0x0019 /* WinProtect */, writebool(false));\n    write_biff_rec(A, 0x0012 /* Protect */, writebool(false));\n    write_biff_rec(A, 0x0013 /* Password */, writeuint16(0));\n    if (b8) write_biff_rec(A, 0x01af /* Prot4Rev */, writebool(false));\n    if (b8) write_biff_rec(A, 0x01bc /* Prot4RevPass */, writeuint16(0));\n    write_biff_rec(A, 0x003d /* Window1 */, write_Window1(opts));\n    write_biff_rec(A, 0x0040 /* Backup */, writebool(false));\n    write_biff_rec(A, 0x008d /* HideObj */, writeuint16(0));\n    write_biff_rec(A, 0x0022 /* Date1904 */, writebool(safe1904(wb) == \"true\"));\n    write_biff_rec(A, 0x000e /* CalcPrecision */, writebool(true));\n    if (b8) write_biff_rec(A, 0x01b7 /* RefreshAll */, writebool(false));\n    write_biff_rec(A, 0x00DA /* BookBool */, writeuint16(0));\n    /* ... */\n    write_FONTS_biff8(A, wb, opts);\n    write_FMTS_biff8(A, wb.SSF, opts);\n    write_CELLXFS_biff8(A, opts);\n    /* ... */\n    if (b8) write_biff_rec(A, 0x0160 /* UsesELFs */, writebool(false));\n    var a = A.end();\n    var C = buf_array();\n    /* METADATA [MTRSettings] [ForceFullCalculation] */\n    if (b8) write_biff_rec(C, 0x008C, write_Country());\n    /* *SUPBOOK *LBL *RTD [RecalcId] *HFPicture *MSODRAWINGGROUP */\n\n    /* BIFF8: [SST *Continue] ExtSST */\n    if (b8 && opts.Strings) write_biff_continue(C, 0x00FC, write_SST(opts.Strings, opts));\n\n    /* *WebPub [WOpt] [CrErr] [BookExt] *FeatHdr *DConn [THEME] [CompressPictures] [Compat12] [GUIDTypeLib] */\n    write_biff_rec(C, 0x000A /* EOF */);\n    var c = C.end();\n    var B = buf_array();\n    var blen = 0,\n      j = 0;\n    for (j = 0; j < wb.SheetNames.length; ++j) blen += (b8 ? 12 : 11) + (b8 ? 2 : 1) * wb.SheetNames[j].length;\n    var start = a.length + blen + c.length;\n    for (j = 0; j < wb.SheetNames.length; ++j) {\n      var _sheet = _sheets[j] || {};\n      write_biff_rec(B, 0x0085 /* BoundSheet8 */, write_BoundSheet8({\n        pos: start,\n        hs: _sheet.Hidden || 0,\n        dt: 0,\n        name: wb.SheetNames[j]\n      }, opts));\n      start += bufs[j].length;\n    }\n    /* 1*BoundSheet8 */\n    var b = B.end();\n    if (blen != b.length) throw new Error(\"BS8 \" + blen + \" != \" + b.length);\n    var out = [];\n    if (a.length) out.push(a);\n    if (b.length) out.push(b);\n    if (c.length) out.push(c);\n    return bconcat(out);\n  }\n\n  /* [MS-XLS] 2.1.7.20 Workbook Stream */\n  function write_biff8_buf(wb, opts) {\n    var o = opts || {};\n    var bufs = [];\n    if (wb && !wb.SSF) {\n      wb.SSF = dup(table_fmt);\n    }\n    if (wb && wb.SSF) {\n      make_ssf();\n      SSF_load_table(wb.SSF);\n      // $FlowIgnore\n      o.revssf = evert_num(wb.SSF);\n      o.revssf[wb.SSF[65535]] = 0;\n      o.ssf = wb.SSF;\n    }\n    o.Strings = [];\n    o.Strings.Count = 0;\n    o.Strings.Unique = 0;\n    fix_write_opts(o);\n    o.cellXfs = [];\n    get_cell_style(o.cellXfs, {}, {\n      revssf: {\n        \"General\": 0\n      }\n    });\n    if (!wb.Props) wb.Props = {};\n    for (var i = 0; i < wb.SheetNames.length; ++i) bufs[bufs.length] = write_ws_biff8(i, o, wb);\n    bufs.unshift(write_biff8_global(wb, bufs, o));\n    return bconcat(bufs);\n  }\n  function write_biff_buf(wb, opts) {\n    for (var i = 0; i <= wb.SheetNames.length; ++i) {\n      var ws = wb.Sheets[wb.SheetNames[i]];\n      if (!ws || !ws[\"!ref\"]) continue;\n      var range = decode_range(ws[\"!ref\"]);\n      if (range.e.c > 255) {\n        // note: 255 is IV\n        if (typeof console != \"undefined\" && console.error) console.error(\"Worksheet '\" + wb.SheetNames[i] + \"' extends beyond column IV (255).  Data may be lost.\");\n      }\n    }\n    var o = opts || {};\n    switch (o.biff || 2) {\n      case 8:\n      case 5:\n        return write_biff8_buf(wb, opts);\n      case 4:\n      case 3:\n      case 2:\n        return write_biff2_buf(wb, opts);\n    }\n    throw new Error(\"invalid type \" + o.bookType + \" for BIFF\");\n  }\n  /* note: browser DOM element cannot see mso- style attrs, must parse */\n  function html_to_sheet(str, _opts) {\n    var opts = _opts || {};\n    if (DENSE != null && opts.dense == null) opts.dense = DENSE;\n    var ws = opts.dense ? [] : {};\n    str = str.replace(/<!--.*?-->/g, \"\");\n    var mtch = str.match(/<table/i);\n    if (!mtch) throw new Error(\"Invalid HTML: could not find <table>\");\n    var mtch2 = str.match(/<\\/table/i);\n    var i = mtch.index,\n      j = mtch2 && mtch2.index || str.length;\n    var rows = split_regex(str.slice(i, j), /(:?<tr[^>]*>)/i, \"<tr>\");\n    var R = -1,\n      C = 0,\n      RS = 0,\n      CS = 0;\n    var range = {\n      s: {\n        r: 10000000,\n        c: 10000000\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    var merges = [];\n    for (i = 0; i < rows.length; ++i) {\n      var row = rows[i].trim();\n      var hd = row.slice(0, 3).toLowerCase();\n      if (hd == \"<tr\") {\n        ++R;\n        if (opts.sheetRows && opts.sheetRows <= R) {\n          --R;\n          break;\n        }\n        C = 0;\n        continue;\n      }\n      if (hd != \"<td\" && hd != \"<th\") continue;\n      var cells = row.split(/<\\/t[dh]>/i);\n      for (j = 0; j < cells.length; ++j) {\n        var cell = cells[j].trim();\n        if (!cell.match(/<t[dh]/i)) continue;\n        var m = cell,\n          cc = 0;\n        /* TODO: parse styles etc */\n        while (m.charAt(0) == \"<\" && (cc = m.indexOf(\">\")) > -1) m = m.slice(cc + 1);\n        for (var midx = 0; midx < merges.length; ++midx) {\n          var _merge = merges[midx];\n          if (_merge.s.c == C && _merge.s.r < R && R <= _merge.e.r) {\n            C = _merge.e.c + 1;\n            midx = -1;\n          }\n        }\n        var tag = parsexmltag(cell.slice(0, cell.indexOf(\">\")));\n        CS = tag.colspan ? +tag.colspan : 1;\n        if ((RS = +tag.rowspan) > 1 || CS > 1) merges.push({\n          s: {\n            r: R,\n            c: C\n          },\n          e: {\n            r: R + (RS || 1) - 1,\n            c: C + CS - 1\n          }\n        });\n        var _t = tag.t || tag[\"data-t\"] || \"\";\n        /* TODO: generate stub cells */\n        if (!m.length) {\n          C += CS;\n          continue;\n        }\n        m = htmldecode(m);\n        if (range.s.r > R) range.s.r = R;\n        if (range.e.r < R) range.e.r = R;\n        if (range.s.c > C) range.s.c = C;\n        if (range.e.c < C) range.e.c = C;\n        if (!m.length) {\n          C += CS;\n          continue;\n        }\n        var o = {\n          t: 's',\n          v: m\n        };\n        if (opts.raw || !m.trim().length || _t == 's') {} else if (m === 'TRUE') o = {\n          t: 'b',\n          v: true\n        };else if (m === 'FALSE') o = {\n          t: 'b',\n          v: false\n        };else if (!isNaN(fuzzynum(m))) o = {\n          t: 'n',\n          v: fuzzynum(m)\n        };else if (!isNaN(fuzzydate(m).getDate())) {\n          o = {\n            t: 'd',\n            v: parseDate(m)\n          };\n          if (!opts.cellDates) o = {\n            t: 'n',\n            v: datenum(o.v)\n          };\n          o.z = opts.dateNF || table_fmt[14];\n        }\n        if (opts.dense) {\n          if (!ws[R]) ws[R] = [];\n          ws[R][C] = o;\n        } else ws[encode_cell({\n          r: R,\n          c: C\n        })] = o;\n        C += CS;\n      }\n    }\n    ws['!ref'] = encode_range(range);\n    if (merges.length) ws[\"!merges\"] = merges;\n    return ws;\n  }\n  function make_html_row(ws, r, R, o) {\n    var M = ws['!merges'] || [];\n    var oo = [];\n    for (var C = r.s.c; C <= r.e.c; ++C) {\n      var RS = 0,\n        CS = 0;\n      for (var j = 0; j < M.length; ++j) {\n        if (M[j].s.r > R || M[j].s.c > C) continue;\n        if (M[j].e.r < R || M[j].e.c < C) continue;\n        if (M[j].s.r < R || M[j].s.c < C) {\n          RS = -1;\n          break;\n        }\n        RS = M[j].e.r - M[j].s.r + 1;\n        CS = M[j].e.c - M[j].s.c + 1;\n        break;\n      }\n      if (RS < 0) continue;\n      var coord = encode_cell({\n        r: R,\n        c: C\n      });\n      var cell = o.dense ? (ws[R] || [])[C] : ws[coord];\n      /* TODO: html entities */\n      var w = cell && cell.v != null && (cell.h || escapehtml(cell.w || (format_cell(cell), cell.w) || \"\")) || \"\";\n      var sp = {};\n      if (RS > 1) sp.rowspan = RS;\n      if (CS > 1) sp.colspan = CS;\n      if (o.editable) w = '<span contenteditable=\"true\">' + w + '</span>';else if (cell) {\n        sp[\"data-t\"] = cell && cell.t || 'z';\n        if (cell.v != null) sp[\"data-v\"] = cell.v;\n        if (cell.z != null) sp[\"data-z\"] = cell.z;\n        if (cell.l && (cell.l.Target || \"#\").charAt(0) != \"#\") w = '<a href=\"' + cell.l.Target + '\">' + w + '</a>';\n      }\n      sp.id = (o.id || \"sjs\") + \"-\" + coord;\n      oo.push(writextag('td', w, sp));\n    }\n    var preamble = \"<tr>\";\n    return preamble + oo.join(\"\") + \"</tr>\";\n  }\n  var HTML_BEGIN = '<html><head><meta charset=\"utf-8\"/><title>SheetJS Table Export</title></head><body>';\n  var HTML_END = '</body></html>';\n  function html_to_workbook(str, opts) {\n    var mtch = str.match(/<table[\\s\\S]*?>[\\s\\S]*?<\\/table>/gi);\n    if (!mtch || mtch.length == 0) throw new Error(\"Invalid HTML: could not find <table>\");\n    if (mtch.length == 1) return sheet_to_workbook(html_to_sheet(mtch[0], opts), opts);\n    var wb = book_new();\n    mtch.forEach(function (s, idx) {\n      book_append_sheet(wb, html_to_sheet(s, opts), \"Sheet\" + (idx + 1));\n    });\n    return wb;\n  }\n  function make_html_preamble(ws, R, o) {\n    var out = [];\n    return out.join(\"\") + '<table' + (o && o.id ? ' id=\"' + o.id + '\"' : \"\") + '>';\n  }\n  function sheet_to_html(ws, opts /*, wb:?Workbook*/) {\n    var o = opts || {};\n    var header = o.header != null ? o.header : HTML_BEGIN;\n    var footer = o.footer != null ? o.footer : HTML_END;\n    var out = [header];\n    var r = decode_range(ws['!ref']);\n    o.dense = Array.isArray(ws);\n    out.push(make_html_preamble(ws, r, o));\n    for (var R = r.s.r; R <= r.e.r; ++R) out.push(make_html_row(ws, r, R, o));\n    out.push(\"</table>\" + footer);\n    return out.join(\"\");\n  }\n  function sheet_add_dom(ws, table, _opts) {\n    var opts = _opts || {};\n    if (DENSE != null) opts.dense = DENSE;\n    var or_R = 0,\n      or_C = 0;\n    if (opts.origin != null) {\n      if (typeof opts.origin == 'number') or_R = opts.origin;else {\n        var _origin = typeof opts.origin == \"string\" ? decode_cell(opts.origin) : opts.origin;\n        or_R = _origin.r;\n        or_C = _origin.c;\n      }\n    }\n    var rows = table.getElementsByTagName('tr');\n    var sheetRows = Math.min(opts.sheetRows || 10000000, rows.length);\n    var range = {\n      s: {\n        r: 0,\n        c: 0\n      },\n      e: {\n        r: or_R,\n        c: or_C\n      }\n    };\n    if (ws[\"!ref\"]) {\n      var _range = decode_range(ws[\"!ref\"]);\n      range.s.r = Math.min(range.s.r, _range.s.r);\n      range.s.c = Math.min(range.s.c, _range.s.c);\n      range.e.r = Math.max(range.e.r, _range.e.r);\n      range.e.c = Math.max(range.e.c, _range.e.c);\n      if (or_R == -1) range.e.r = or_R = _range.e.r + 1;\n    }\n    var merges = [],\n      midx = 0;\n    var rowinfo = ws[\"!rows\"] || (ws[\"!rows\"] = []);\n    var _R = 0,\n      R = 0,\n      _C = 0,\n      C = 0,\n      RS = 0,\n      CS = 0;\n    if (!ws[\"!cols\"]) ws['!cols'] = [];\n    for (; _R < rows.length && R < sheetRows; ++_R) {\n      var row = rows[_R];\n      if (is_dom_element_hidden(row)) {\n        if (opts.display) continue;\n        rowinfo[R] = {\n          hidden: true\n        };\n      }\n      var elts = row.children;\n      for (_C = C = 0; _C < elts.length; ++_C) {\n        var elt = elts[_C];\n        if (opts.display && is_dom_element_hidden(elt)) continue;\n        var v = elt.hasAttribute('data-v') ? elt.getAttribute('data-v') : elt.hasAttribute('v') ? elt.getAttribute('v') : htmldecode(elt.innerHTML);\n        var z = elt.getAttribute('data-z') || elt.getAttribute('z');\n        for (midx = 0; midx < merges.length; ++midx) {\n          var m = merges[midx];\n          if (m.s.c == C + or_C && m.s.r < R + or_R && R + or_R <= m.e.r) {\n            C = m.e.c + 1 - or_C;\n            midx = -1;\n          }\n        }\n        /* TODO: figure out how to extract nonstandard mso- style */\n        CS = +elt.getAttribute(\"colspan\") || 1;\n        if ((RS = +elt.getAttribute(\"rowspan\") || 1) > 1 || CS > 1) merges.push({\n          s: {\n            r: R + or_R,\n            c: C + or_C\n          },\n          e: {\n            r: R + or_R + (RS || 1) - 1,\n            c: C + or_C + (CS || 1) - 1\n          }\n        });\n        var o = {\n          t: 's',\n          v: v\n        };\n        var _t = elt.getAttribute(\"data-t\") || elt.getAttribute(\"t\") || \"\";\n        if (v != null) {\n          if (v.length == 0) o.t = _t || 'z';else if (opts.raw || v.trim().length == 0 || _t == \"s\") {} else if (v === 'TRUE') o = {\n            t: 'b',\n            v: true\n          };else if (v === 'FALSE') o = {\n            t: 'b',\n            v: false\n          };else if (!isNaN(fuzzynum(v))) o = {\n            t: 'n',\n            v: fuzzynum(v)\n          };else if (!isNaN(fuzzydate(v).getDate())) {\n            o = {\n              t: 'd',\n              v: parseDate(v)\n            };\n            if (!opts.cellDates) o = {\n              t: 'n',\n              v: datenum(o.v)\n            };\n            o.z = opts.dateNF || table_fmt[14];\n          }\n        }\n        if (o.z === undefined && z != null) o.z = z;\n        /* The first link is used.  Links are assumed to be fully specified.\n         * TODO: The right way to process relative links is to make a new <a> */\n        var l = \"\",\n          Aelts = elt.getElementsByTagName(\"A\");\n        if (Aelts && Aelts.length) for (var Aelti = 0; Aelti < Aelts.length; ++Aelti) if (Aelts[Aelti].hasAttribute(\"href\")) {\n          l = Aelts[Aelti].getAttribute(\"href\");\n          if (l.charAt(0) != \"#\") break;\n        }\n        if (l && l.charAt(0) != \"#\") o.l = {\n          Target: l\n        };\n        if (opts.dense) {\n          if (!ws[R + or_R]) ws[R + or_R] = [];\n          ws[R + or_R][C + or_C] = o;\n        } else ws[encode_cell({\n          c: C + or_C,\n          r: R + or_R\n        })] = o;\n        if (range.e.c < C + or_C) range.e.c = C + or_C;\n        C += CS;\n      }\n      ++R;\n    }\n    if (merges.length) ws['!merges'] = (ws[\"!merges\"] || []).concat(merges);\n    range.e.r = Math.max(range.e.r, R - 1 + or_R);\n    ws['!ref'] = encode_range(range);\n    if (R >= sheetRows) ws['!fullref'] = encode_range((range.e.r = rows.length - _R + R - 1 + or_R, range)); // We can count the real number of rows to parse but we don't to improve the performance\n    return ws;\n  }\n  function parse_dom_table(table, _opts) {\n    var opts = _opts || {};\n    var ws = opts.dense ? [] : {};\n    return sheet_add_dom(ws, table, _opts);\n  }\n  function table_to_book(table, opts) {\n    return sheet_to_workbook(parse_dom_table(table, opts), opts);\n  }\n  function is_dom_element_hidden(element) {\n    var display = '';\n    var get_computed_style = get_get_computed_style_function(element);\n    if (get_computed_style) display = get_computed_style(element).getPropertyValue('display');\n    if (!display) display = element.style && element.style.display;\n    return display === 'none';\n  }\n\n  /* global getComputedStyle */\n  function get_get_computed_style_function(element) {\n    // The proper getComputedStyle implementation is the one defined in the element window\n    if (element.ownerDocument.defaultView && typeof element.ownerDocument.defaultView.getComputedStyle === 'function') return element.ownerDocument.defaultView.getComputedStyle;\n    // If it is not available, try to get one from the global namespace\n    if (typeof getComputedStyle === 'function') return getComputedStyle;\n    return null;\n  }\n  /* OpenDocument */\n  function parse_text_p(text) {\n    /* 6.1.2 White Space Characters */\n    var fixed = text.replace(/[\\t\\r\\n]/g, \" \").trim().replace(/ +/g, \" \").replace(/<text:s\\/>/g, \" \").replace(/<text:s text:c=\"(\\d+)\"\\/>/g, function ($$, $1) {\n      return Array(parseInt($1, 10) + 1).join(\" \");\n    }).replace(/<text:tab[^>]*\\/>/g, \"\\t\").replace(/<text:line-break\\/>/g, \"\\n\");\n    var v = unescapexml(fixed.replace(/<[^>]*>/g, \"\"));\n    return [v];\n  }\n  var number_formats_ods = {\n    /* ods name: [short ssf fmt, long ssf fmt] */\n    day: [\"d\", \"dd\"],\n    month: [\"m\", \"mm\"],\n    year: [\"y\", \"yy\"],\n    hours: [\"h\", \"hh\"],\n    minutes: [\"m\", \"mm\"],\n    seconds: [\"s\", \"ss\"],\n    \"am-pm\": [\"A/P\", \"AM/PM\"],\n    \"day-of-week\": [\"ddd\", \"dddd\"],\n    era: [\"e\", \"ee\"],\n    /* there is no native representation of LO \"Q\" format */\n    quarter: [\"\\\\Qm\", \"m\\\\\\\"th quarter\\\"\"]\n  };\n  function parse_content_xml(d, _opts) {\n    var opts = _opts || {};\n    if (DENSE != null && opts.dense == null) opts.dense = DENSE;\n    var str = xlml_normalize(d);\n    var state = [],\n      tmp;\n    var tag;\n    var NFtag = {\n        name: \"\"\n      },\n      NF = \"\",\n      pidx = 0;\n    var sheetag;\n    var rowtag;\n    var Sheets = {},\n      SheetNames = [];\n    var ws = opts.dense ? [] : {};\n    var Rn, q;\n    var ctag = {\n      value: \"\"\n    };\n    var textp = \"\",\n      textpidx = 0,\n      textptag;\n    var textR = [];\n    var R = -1,\n      C = -1,\n      range = {\n        s: {\n          r: 1000000,\n          c: 10000000\n        },\n        e: {\n          r: 0,\n          c: 0\n        }\n      };\n    var row_ol = 0;\n    var number_format_map = {};\n    var merges = [],\n      mrange = {},\n      mR = 0,\n      mC = 0;\n    var rowinfo = [],\n      rowpeat = 1,\n      colpeat = 1;\n    var arrayf = [];\n    var WB = {\n      Names: []\n    };\n    var atag = {};\n    var _Ref = [\"\", \"\"];\n    var comments = [],\n      comment = {};\n    var creator = \"\",\n      creatoridx = 0;\n    var isstub = false,\n      intable = false;\n    var i = 0;\n    xlmlregex.lastIndex = 0;\n    str = str.replace(/<!--([\\s\\S]*?)-->/mg, \"\").replace(/<!DOCTYPE[^\\[]*\\[[^\\]]*\\]>/gm, \"\");\n    while (Rn = xlmlregex.exec(str)) switch (Rn[3] = Rn[3].replace(/_.*$/, \"\")) {\n      case 'table':\n      case '工作表':\n        // 9.1.2 <table:table>\n        if (Rn[1] === '/') {\n          if (range.e.c >= range.s.c && range.e.r >= range.s.r) ws['!ref'] = encode_range(range);else ws['!ref'] = \"A1:A1\";\n          if (opts.sheetRows > 0 && opts.sheetRows <= range.e.r) {\n            ws['!fullref'] = ws['!ref'];\n            range.e.r = opts.sheetRows - 1;\n            ws['!ref'] = encode_range(range);\n          }\n          if (merges.length) ws['!merges'] = merges;\n          if (rowinfo.length) ws[\"!rows\"] = rowinfo;\n          sheetag.name = sheetag['名称'] || sheetag.name;\n          if (typeof JSON !== 'undefined') JSON.stringify(sheetag);\n          SheetNames.push(sheetag.name);\n          Sheets[sheetag.name] = ws;\n          intable = false;\n        } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') {\n          sheetag = parsexmltag(Rn[0], false);\n          R = C = -1;\n          range.s.r = range.s.c = 10000000;\n          range.e.r = range.e.c = 0;\n          ws = opts.dense ? [] : {};\n          merges = [];\n          rowinfo = [];\n          intable = true;\n        }\n        break;\n      case 'table-row-group':\n        // 9.1.9 <table:table-row-group>\n        if (Rn[1] === \"/\") --row_ol;else ++row_ol;\n        break;\n      case 'table-row':\n      case '行':\n        // 9.1.3 <table:table-row>\n        if (Rn[1] === '/') {\n          R += rowpeat;\n          rowpeat = 1;\n          break;\n        }\n        rowtag = parsexmltag(Rn[0], false);\n        if (rowtag['行号']) R = rowtag['行号'] - 1;else if (R == -1) R = 0;\n        rowpeat = +rowtag['number-rows-repeated'] || 1;\n        /* TODO: remove magic */\n        if (rowpeat < 10) for (i = 0; i < rowpeat; ++i) if (row_ol > 0) rowinfo[R + i] = {\n          level: row_ol\n        };\n        C = -1;\n        break;\n      case 'covered-table-cell':\n        // 9.1.5 <table:covered-table-cell>\n        if (Rn[1] !== '/') ++C;\n        if (opts.sheetStubs) {\n          if (opts.dense) {\n            if (!ws[R]) ws[R] = [];\n            ws[R][C] = {\n              t: 'z'\n            };\n          } else ws[encode_cell({\n            r: R,\n            c: C\n          })] = {\n            t: 'z'\n          };\n        }\n        textp = \"\";\n        textR = [];\n        break;\n      /* stub */\n      case 'table-cell':\n      case '数据':\n        if (Rn[0].charAt(Rn[0].length - 2) === '/') {\n          ++C;\n          ctag = parsexmltag(Rn[0], false);\n          colpeat = parseInt(ctag['number-columns-repeated'] || \"1\", 10);\n          q = {\n            t: 'z',\n            v: null\n          };\n          if (ctag.formula && opts.cellFormula != false) q.f = ods_to_csf_formula(unescapexml(ctag.formula));\n          if ((ctag['数据类型'] || ctag['value-type']) == \"string\") {\n            q.t = \"s\";\n            q.v = unescapexml(ctag['string-value'] || \"\");\n            if (opts.dense) {\n              if (!ws[R]) ws[R] = [];\n              ws[R][C] = q;\n            } else {\n              ws[encode_cell({\n                r: R,\n                c: C\n              })] = q;\n            }\n          }\n          C += colpeat - 1;\n        } else if (Rn[1] !== '/') {\n          ++C;\n          textp = \"\";\n          textpidx = 0;\n          textR = [];\n          colpeat = 1;\n          var rptR = rowpeat ? R + rowpeat - 1 : R;\n          if (C > range.e.c) range.e.c = C;\n          if (C < range.s.c) range.s.c = C;\n          if (R < range.s.r) range.s.r = R;\n          if (rptR > range.e.r) range.e.r = rptR;\n          ctag = parsexmltag(Rn[0], false);\n          comments = [];\n          comment = {};\n          q = {\n            t: ctag['数据类型'] || ctag['value-type'],\n            v: null\n          };\n          if (opts.cellFormula) {\n            if (ctag.formula) ctag.formula = unescapexml(ctag.formula);\n            if (ctag['number-matrix-columns-spanned'] && ctag['number-matrix-rows-spanned']) {\n              mR = parseInt(ctag['number-matrix-rows-spanned'], 10) || 0;\n              mC = parseInt(ctag['number-matrix-columns-spanned'], 10) || 0;\n              mrange = {\n                s: {\n                  r: R,\n                  c: C\n                },\n                e: {\n                  r: R + mR - 1,\n                  c: C + mC - 1\n                }\n              };\n              q.F = encode_range(mrange);\n              arrayf.push([mrange, q.F]);\n            }\n            if (ctag.formula) q.f = ods_to_csf_formula(ctag.formula);else for (i = 0; i < arrayf.length; ++i) if (R >= arrayf[i][0].s.r && R <= arrayf[i][0].e.r) if (C >= arrayf[i][0].s.c && C <= arrayf[i][0].e.c) q.F = arrayf[i][1];\n          }\n          if (ctag['number-columns-spanned'] || ctag['number-rows-spanned']) {\n            mR = parseInt(ctag['number-rows-spanned'], 10) || 0;\n            mC = parseInt(ctag['number-columns-spanned'], 10) || 0;\n            mrange = {\n              s: {\n                r: R,\n                c: C\n              },\n              e: {\n                r: R + mR - 1,\n                c: C + mC - 1\n              }\n            };\n            merges.push(mrange);\n          }\n\n          /* 19.675.2 table:number-columns-repeated */\n          if (ctag['number-columns-repeated']) colpeat = parseInt(ctag['number-columns-repeated'], 10);\n\n          /* 19.385 office:value-type */\n          switch (q.t) {\n            case 'boolean':\n              q.t = 'b';\n              q.v = parsexmlbool(ctag['boolean-value']);\n              break;\n            case 'float':\n              q.t = 'n';\n              q.v = parseFloat(ctag.value);\n              break;\n            case 'percentage':\n              q.t = 'n';\n              q.v = parseFloat(ctag.value);\n              break;\n            case 'currency':\n              q.t = 'n';\n              q.v = parseFloat(ctag.value);\n              break;\n            case 'date':\n              q.t = 'd';\n              q.v = parseDate(ctag['date-value']);\n              if (!opts.cellDates) {\n                q.t = 'n';\n                q.v = datenum(q.v);\n              }\n              q.z = 'm/d/yy';\n              break;\n            case 'time':\n              q.t = 'n';\n              q.v = parse_isodur(ctag['time-value']) / 86400;\n              if (opts.cellDates) {\n                q.t = 'd';\n                q.v = numdate(q.v);\n              }\n              q.z = 'HH:MM:SS';\n              break;\n            case 'number':\n              q.t = 'n';\n              q.v = parseFloat(ctag['数据数值']);\n              break;\n            default:\n              if (q.t === 'string' || q.t === 'text' || !q.t) {\n                q.t = 's';\n                if (ctag['string-value'] != null) {\n                  textp = unescapexml(ctag['string-value']);\n                  textR = [];\n                }\n              } else throw new Error('Unsupported value type ' + q.t);\n          }\n        } else {\n          isstub = false;\n          if (q.t === 's') {\n            q.v = textp || '';\n            if (textR.length) q.R = textR;\n            isstub = textpidx == 0;\n          }\n          if (atag.Target) q.l = atag;\n          if (comments.length > 0) {\n            q.c = comments;\n            comments = [];\n          }\n          if (textp && opts.cellText !== false) q.w = textp;\n          if (isstub) {\n            q.t = \"z\";\n            delete q.v;\n          }\n          if (!isstub || opts.sheetStubs) {\n            if (!(opts.sheetRows && opts.sheetRows <= R)) {\n              for (var rpt = 0; rpt < rowpeat; ++rpt) {\n                colpeat = parseInt(ctag['number-columns-repeated'] || \"1\", 10);\n                if (opts.dense) {\n                  if (!ws[R + rpt]) ws[R + rpt] = [];\n                  ws[R + rpt][C] = rpt == 0 ? q : dup(q);\n                  while (--colpeat > 0) ws[R + rpt][C + colpeat] = dup(q);\n                } else {\n                  ws[encode_cell({\n                    r: R + rpt,\n                    c: C\n                  })] = q;\n                  while (--colpeat > 0) ws[encode_cell({\n                    r: R + rpt,\n                    c: C + colpeat\n                  })] = dup(q);\n                }\n                if (range.e.c <= C) range.e.c = C;\n              }\n            }\n          }\n          colpeat = parseInt(ctag['number-columns-repeated'] || \"1\", 10);\n          C += colpeat - 1;\n          colpeat = 0;\n          q = {};\n          textp = \"\";\n          textR = [];\n        }\n        atag = {};\n        break;\n      // 9.1.4 <table:table-cell>\n\n      /* pure state */\n      case 'document': // TODO: <office:document> is the root for FODS\n      case 'document-content':\n      case '电子表格文档': // 3.1.3.2 <office:document-content>\n      case 'spreadsheet':\n      case '主体': // 3.7 <office:spreadsheet>\n      case 'scripts': // 3.12 <office:scripts>\n      case 'styles': // TODO <office:styles>\n      case 'font-face-decls': // 3.14 <office:font-face-decls>\n      case 'master-styles':\n        // 3.15.4 <office:master-styles> -- relevant for FODS\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n        } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], true]);\n        break;\n      case 'annotation':\n        // 14.1 <office:annotation>\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n          comment.t = textp;\n          if (textR.length) comment.R = textR;\n          comment.a = creator;\n          comments.push(comment);\n        } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') {\n          state.push([Rn[3], false]);\n        }\n        creator = \"\";\n        creatoridx = 0;\n        textp = \"\";\n        textpidx = 0;\n        textR = [];\n        break;\n      case 'creator':\n        // 4.3.2.7 <dc:creator>\n        if (Rn[1] === '/') {\n          creator = str.slice(creatoridx, Rn.index);\n        } else creatoridx = Rn.index + Rn[0].length;\n        break;\n\n      /* ignore state */\n      case 'meta':\n      case '元数据': // TODO: <office:meta> <uof:元数据> FODS/UOF\n      case 'settings': // TODO: <office:settings>\n      case 'config-item-set': // TODO: <office:config-item-set>\n      case 'config-item-map-indexed': // TODO: <office:config-item-map-indexed>\n      case 'config-item-map-entry': // TODO: <office:config-item-map-entry>\n      case 'config-item-map-named': // TODO: <office:config-item-map-entry>\n      case 'shapes': // 9.2.8 <table:shapes>\n      case 'frame': // 10.4.2 <draw:frame>\n      case 'text-box': // 10.4.3 <draw:text-box>\n      case 'image': // 10.4.4 <draw:image>\n      case 'data-pilot-tables': // 9.6.2 <table:data-pilot-tables>\n      case 'list-style': // 16.30 <text:list-style>\n      case 'form': // 13.13 <form:form>\n      case 'dde-links': // 9.8 <table:dde-links>\n      case 'event-listeners': // TODO\n      case 'chart':\n        // TODO\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n        } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], false]);\n        textp = \"\";\n        textpidx = 0;\n        textR = [];\n        break;\n      case 'scientific-number':\n        // TODO: <number:scientific-number>\n        break;\n      case 'currency-symbol':\n        // TODO: <number:currency-symbol>\n        break;\n      case 'currency-style':\n        // TODO: <number:currency-style>\n        break;\n      case 'number-style': // 16.27.2 <number:number-style>\n      case 'percentage-style': // 16.27.9 <number:percentage-style>\n      case 'date-style': // 16.27.10 <number:date-style>\n      case 'time-style':\n        // 16.27.18 <number:time-style>\n        if (Rn[1] === '/') {\n          number_format_map[NFtag.name] = NF;\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n        } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') {\n          NF = \"\";\n          NFtag = parsexmltag(Rn[0], false);\n          state.push([Rn[3], true]);\n        }\n        break;\n      case 'script':\n        break;\n      // 3.13 <office:script>\n      case 'libraries':\n        break;\n      // TODO: <ooo:libraries>\n      case 'automatic-styles':\n        break;\n      // 3.15.3 <office:automatic-styles>\n\n      case 'default-style': // TODO: <style:default-style>\n      case 'page-layout':\n        break;\n      // TODO: <style:page-layout>\n      case 'style':\n        // 16.2 <style:style>\n        break;\n      case 'map':\n        break;\n      // 16.3 <style:map>\n      case 'font-face':\n        break;\n      // 16.21 <style:font-face>\n\n      case 'paragraph-properties':\n        break;\n      // 17.6 <style:paragraph-properties>\n      case 'table-properties':\n        break;\n      // 17.15 <style:table-properties>\n      case 'table-column-properties':\n        break;\n      // 17.16 <style:table-column-properties>\n      case 'table-row-properties':\n        break;\n      // 17.17 <style:table-row-properties>\n      case 'table-cell-properties':\n        break;\n      // 17.18 <style:table-cell-properties>\n\n      case 'number':\n        // 16.27.3 <number:number>\n        switch (state[state.length - 1][0]) {\n          case 'time-style':\n          case 'date-style':\n            tag = parsexmltag(Rn[0], false);\n            NF += number_formats_ods[Rn[3]][tag.style === 'long' ? 1 : 0];\n            break;\n        }\n        break;\n      case 'fraction':\n        break;\n      // TODO 16.27.6 <number:fraction>\n\n      case 'day': // 16.27.11 <number:day>\n      case 'month': // 16.27.12 <number:month>\n      case 'year': // 16.27.13 <number:year>\n      case 'era': // 16.27.14 <number:era>\n      case 'day-of-week': // 16.27.15 <number:day-of-week>\n      case 'week-of-year': // 16.27.16 <number:week-of-year>\n      case 'quarter': // 16.27.17 <number:quarter>\n      case 'hours': // 16.27.19 <number:hours>\n      case 'minutes': // 16.27.20 <number:minutes>\n      case 'seconds': // 16.27.21 <number:seconds>\n      case 'am-pm':\n        // 16.27.22 <number:am-pm>\n        switch (state[state.length - 1][0]) {\n          case 'time-style':\n          case 'date-style':\n            tag = parsexmltag(Rn[0], false);\n            NF += number_formats_ods[Rn[3]][tag.style === 'long' ? 1 : 0];\n            break;\n        }\n        break;\n      case 'boolean-style':\n        break;\n      // 16.27.23 <number:boolean-style>\n      case 'boolean':\n        break;\n      // 16.27.24 <number:boolean>\n      case 'text-style':\n        break;\n      // 16.27.25 <number:text-style>\n      case 'text':\n        // 16.27.26 <number:text>\n        if (Rn[0].slice(-2) === \"/>\") break;else if (Rn[1] === \"/\") switch (state[state.length - 1][0]) {\n          case 'number-style':\n          case 'date-style':\n          case 'time-style':\n            NF += str.slice(pidx, Rn.index);\n            break;\n        } else pidx = Rn.index + Rn[0].length;\n        break;\n      case 'named-range':\n        // 9.4.12 <table:named-range>\n        tag = parsexmltag(Rn[0], false);\n        _Ref = ods_to_csf_3D(tag['cell-range-address']);\n        var nrange = {\n          Name: tag.name,\n          Ref: _Ref[0] + '!' + _Ref[1]\n        };\n        if (intable) nrange.Sheet = SheetNames.length;\n        WB.Names.push(nrange);\n        break;\n      case 'text-content':\n        break;\n      // 16.27.27 <number:text-content>\n      case 'text-properties':\n        break;\n      // 16.27.27 <style:text-properties>\n      case 'embedded-text':\n        break;\n      // 16.27.4 <number:embedded-text>\n\n      case 'body':\n      case '电子表格':\n        break;\n      // 3.3 16.9.6 19.726.3\n\n      case 'forms':\n        break;\n      // 12.25.2 13.2\n      case 'table-column':\n        break;\n      // 9.1.6 <table:table-column>\n      case 'table-header-rows':\n        break;\n      // 9.1.7 <table:table-header-rows>\n      case 'table-rows':\n        break;\n      // 9.1.12 <table:table-rows>\n      /* TODO: outline levels */\n      case 'table-column-group':\n        break;\n      // 9.1.10 <table:table-column-group>\n      case 'table-header-columns':\n        break;\n      // 9.1.11 <table:table-header-columns>\n      case 'table-columns':\n        break;\n      // 9.1.12 <table:table-columns>\n\n      case 'null-date':\n        break;\n      // 9.4.2 <table:null-date> TODO: date1904\n\n      case 'graphic-properties':\n        break;\n      // 17.21 <style:graphic-properties>\n      case 'calculation-settings':\n        break;\n      // 9.4.1 <table:calculation-settings>\n      case 'named-expressions':\n        break;\n      // 9.4.11 <table:named-expressions>\n      case 'label-range':\n        break;\n      // 9.4.9 <table:label-range>\n      case 'label-ranges':\n        break;\n      // 9.4.10 <table:label-ranges>\n      case 'named-expression':\n        break;\n      // 9.4.13 <table:named-expression>\n      case 'sort':\n        break;\n      // 9.4.19 <table:sort>\n      case 'sort-by':\n        break;\n      // 9.4.20 <table:sort-by>\n      case 'sort-groups':\n        break;\n      // 9.4.22 <table:sort-groups>\n\n      case 'tab':\n        break;\n      // 6.1.4 <text:tab>\n      case 'line-break':\n        break;\n      // 6.1.5 <text:line-break>\n      case 'span':\n        break;\n      // 6.1.7 <text:span>\n      case 'p':\n      case '文本串':\n        // 5.1.3 <text:p>\n        if (['master-styles'].indexOf(state[state.length - 1][0]) > -1) break;\n        if (Rn[1] === '/' && (!ctag || !ctag['string-value'])) {\n          var ptp = parse_text_p(str.slice(textpidx, Rn.index), textptag);\n          textp = (textp.length > 0 ? textp + \"\\n\" : \"\") + ptp[0];\n        } else {\n          textptag = parsexmltag(Rn[0], false);\n          textpidx = Rn.index + Rn[0].length;\n        }\n        break;\n      // <text:p>\n      case 's':\n        break;\n      // <text:s>\n\n      case 'database-range':\n        // 9.4.15 <table:database-range>\n        if (Rn[1] === '/') break;\n        try {\n          _Ref = ods_to_csf_3D(parsexmltag(Rn[0])['target-range-address']);\n          Sheets[_Ref[0]]['!autofilter'] = {\n            ref: _Ref[1]\n          };\n        } catch (e) {/* empty */}\n        break;\n      case 'date':\n        break;\n      // <*:date>\n\n      case 'object':\n        break;\n      // 10.4.6.2 <draw:object>\n      case 'title':\n      case '标题':\n        break;\n      // <*:title> OR <uof:标题>\n      case 'desc':\n        break;\n      // <*:desc>\n      case 'binary-data':\n        break;\n      // 10.4.5 TODO: b64 blob\n\n      /* 9.2 Advanced Tables */\n      case 'table-source':\n        break;\n      // 9.2.6\n      case 'scenario':\n        break;\n      // 9.2.6\n\n      case 'iteration':\n        break;\n      // 9.4.3 <table:iteration>\n      case 'content-validations':\n        break;\n      // 9.4.4 <table:\n      case 'content-validation':\n        break;\n      // 9.4.5 <table:\n      case 'help-message':\n        break;\n      // 9.4.6 <table:\n      case 'error-message':\n        break;\n      // 9.4.7 <table:\n      case 'database-ranges':\n        break;\n      // 9.4.14 <table:database-ranges>\n      case 'filter':\n        break;\n      // 9.5.2 <table:filter>\n      case 'filter-and':\n        break;\n      // 9.5.3 <table:filter-and>\n      case 'filter-or':\n        break;\n      // 9.5.4 <table:filter-or>\n      case 'filter-condition':\n        break;\n      // 9.5.5 <table:filter-condition>\n\n      case 'list-level-style-bullet':\n        break;\n      // 16.31 <text:\n      case 'list-level-style-number':\n        break;\n      // 16.32 <text:\n      case 'list-level-properties':\n        break;\n      // 17.19 <style:\n\n      /* 7.3 Document Fields */\n      case 'sender-firstname': // 7.3.6.2\n      case 'sender-lastname': // 7.3.6.3\n      case 'sender-initials': // 7.3.6.4\n      case 'sender-title': // 7.3.6.5\n      case 'sender-position': // 7.3.6.6\n      case 'sender-email': // 7.3.6.7\n      case 'sender-phone-private': // 7.3.6.8\n      case 'sender-fax': // 7.3.6.9\n      case 'sender-company': // 7.3.6.10\n      case 'sender-phone-work': // 7.3.6.11\n      case 'sender-street': // 7.3.6.12\n      case 'sender-city': // 7.3.6.13\n      case 'sender-postal-code': // 7.3.6.14\n      case 'sender-country': // 7.3.6.15\n      case 'sender-state-or-province': // 7.3.6.16\n      case 'author-name': // 7.3.7.1\n      case 'author-initials': // 7.3.7.2\n      case 'chapter': // 7.3.8\n      case 'file-name': // 7.3.9\n      case 'template-name': // 7.3.9\n      case 'sheet-name':\n        // 7.3.9\n        break;\n      case 'event-listener':\n        break;\n      /* TODO: FODS Properties */\n      case 'initial-creator':\n      case 'creation-date':\n      case 'print-date':\n      case 'generator':\n      case 'document-statistic':\n      case 'user-defined':\n      case 'editing-duration':\n      case 'editing-cycles':\n        break;\n\n      /* TODO: FODS Config */\n      case 'config-item':\n        break;\n\n      /* TODO: style tokens */\n      case 'page-number':\n        break;\n      // TODO <text:page-number>\n      case 'page-count':\n        break;\n      // TODO <text:page-count>\n      case 'time':\n        break;\n      // TODO <text:time>\n\n      /* 9.3 Advanced Table Cells */\n      case 'cell-range-source':\n        break;\n      // 9.3.1 <table:\n      case 'detective':\n        break;\n      // 9.3.2 <table:\n      case 'operation':\n        break;\n      // 9.3.3 <table:\n      case 'highlighted-range':\n        break;\n      // 9.3.4 <table:\n\n      /* 9.6 Data Pilot Tables <table: */\n      case 'data-pilot-table': // 9.6.3\n      case 'source-cell-range': // 9.6.5\n      case 'source-service': // 9.6.6\n      case 'data-pilot-field': // 9.6.7\n      case 'data-pilot-level': // 9.6.8\n      case 'data-pilot-subtotals': // 9.6.9\n      case 'data-pilot-subtotal': // 9.6.10\n      case 'data-pilot-members': // 9.6.11\n      case 'data-pilot-member': // 9.6.12\n      case 'data-pilot-display-info': // 9.6.13\n      case 'data-pilot-sort-info': // 9.6.14\n      case 'data-pilot-layout-info': // 9.6.15\n      case 'data-pilot-field-reference': // 9.6.16\n      case 'data-pilot-groups': // 9.6.17\n      case 'data-pilot-group': // 9.6.18\n      case 'data-pilot-group-member':\n        // 9.6.19\n        break;\n\n      /* 10.3 Drawing Shapes */\n      case 'rect':\n        // 10.3.2\n        break;\n\n      /* 14.6 DDE Connections */\n      case 'dde-connection-decls': // 14.6.2 <text:\n      case 'dde-connection-decl': // 14.6.3 <text:\n      case 'dde-link': // 14.6.4 <table:\n      case 'dde-source':\n        // 14.6.5 <office:\n        break;\n      case 'properties':\n        break;\n      // 13.7 <form:properties>\n      case 'property':\n        break;\n      // 13.8 <form:property>\n\n      case 'a':\n        // 6.1.8 hyperlink\n        if (Rn[1] !== '/') {\n          atag = parsexmltag(Rn[0], false);\n          if (!atag.href) break;\n          atag.Target = unescapexml(atag.href);\n          delete atag.href;\n          if (atag.Target.charAt(0) == \"#\" && atag.Target.indexOf(\".\") > -1) {\n            _Ref = ods_to_csf_3D(atag.Target.slice(1));\n            atag.Target = \"#\" + _Ref[0] + \"!\" + _Ref[1];\n          } else if (atag.Target.match(/^\\.\\.[\\\\\\/]/)) atag.Target = atag.Target.slice(3);\n        }\n        break;\n\n      /* non-standard */\n      case 'table-protection':\n        break;\n      case 'data-pilot-grand-total':\n        break;\n      // <table:\n      case 'office-document-common-attrs':\n        break;\n      // bare\n      default:\n        switch (Rn[2]) {\n          case 'dc:': // TODO: properties\n          case 'calcext:': // ignore undocumented extensions\n          case 'loext:': // ignore undocumented extensions\n          case 'ooo:': // ignore undocumented extensions\n          case 'chartooo:': // ignore undocumented extensions\n          case 'draw:': // TODO: drawing\n          case 'style:': // TODO: styles\n          case 'chart:': // TODO: charts\n          case 'form:': // TODO: forms\n          case 'uof:': // TODO: uof\n          case '表:': // TODO: uof\n          case '字:':\n            // TODO: uof\n            break;\n          default:\n            if (opts.WTF) throw new Error(Rn);\n        }\n    }\n    var out = {\n      Sheets: Sheets,\n      SheetNames: SheetNames,\n      Workbook: WB\n    };\n    if (opts.bookSheets) delete out.Sheets;\n    return out;\n  }\n  function parse_ods(zip, opts) {\n    opts = opts || {};\n    if (safegetzipfile(zip, 'META-INF/manifest.xml')) parse_manifest(getzipdata(zip, 'META-INF/manifest.xml'), opts);\n    var content = getzipstr(zip, 'content.xml');\n    if (!content) throw new Error(\"Missing content.xml in ODS / UOF file\");\n    var wb = parse_content_xml(utf8read(content), opts);\n    if (safegetzipfile(zip, 'meta.xml')) wb.Props = parse_core_props(getzipdata(zip, 'meta.xml'));\n    return wb;\n  }\n  function parse_fods(data, opts) {\n    return parse_content_xml(data, opts);\n  }\n\n  /* OpenDocument */\n  var write_styles_ods = /* @__PURE__ */function () {\n    var master_styles = ['<office:master-styles>', '<style:master-page style:name=\"mp1\" style:page-layout-name=\"mp1\">', '<style:header/>', '<style:header-left style:display=\"false\"/>', '<style:footer/>', '<style:footer-left style:display=\"false\"/>', '</style:master-page>', '</office:master-styles>'].join(\"\");\n    var payload = '<office:document-styles ' + wxt_helper({\n      'xmlns:office': \"urn:oasis:names:tc:opendocument:xmlns:office:1.0\",\n      'xmlns:table': \"urn:oasis:names:tc:opendocument:xmlns:table:1.0\",\n      'xmlns:style': \"urn:oasis:names:tc:opendocument:xmlns:style:1.0\",\n      'xmlns:text': \"urn:oasis:names:tc:opendocument:xmlns:text:1.0\",\n      'xmlns:draw': \"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\",\n      'xmlns:fo': \"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\",\n      'xmlns:xlink': \"http://www.w3.org/1999/xlink\",\n      'xmlns:dc': \"http://purl.org/dc/elements/1.1/\",\n      'xmlns:number': \"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\",\n      'xmlns:svg': \"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\",\n      'xmlns:of': \"urn:oasis:names:tc:opendocument:xmlns:of:1.2\",\n      'office:version': \"1.2\"\n    }) + '>' + master_styles + '</office:document-styles>';\n    return function wso() {\n      return XML_HEADER + payload;\n    };\n  }();\n  var write_content_ods = /* @__PURE__ */function () {\n    /* 6.1.2 White Space Characters */\n    var write_text_p = function (text) {\n      return escapexml(text).replace(/  +/g, function ($$) {\n        return '<text:s text:c=\"' + $$.length + '\"/>';\n      }).replace(/\\t/g, \"<text:tab/>\").replace(/\\n/g, \"</text:p><text:p>\").replace(/^ /, \"<text:s/>\").replace(/ $/, \"<text:s/>\");\n    };\n    var null_cell_xml = '          <table:table-cell />\\n';\n    var covered_cell_xml = '          <table:covered-table-cell/>\\n';\n    var write_ws = function (ws, wb, i) {\n      /* Section 9 Tables */\n      var o = [];\n      o.push('      <table:table table:name=\"' + escapexml(wb.SheetNames[i]) + '\" table:style-name=\"ta1\">\\n');\n      var R = 0,\n        C = 0,\n        range = decode_range(ws['!ref'] || \"A1\");\n      var marr = ws['!merges'] || [],\n        mi = 0;\n      var dense = Array.isArray(ws);\n      if (ws[\"!cols\"]) {\n        for (C = 0; C <= range.e.c; ++C) o.push('        <table:table-column' + (ws[\"!cols\"][C] ? ' table:style-name=\"co' + ws[\"!cols\"][C].ods + '\"' : '') + '></table:table-column>\\n');\n      }\n      var H = \"\",\n        ROWS = ws[\"!rows\"] || [];\n      for (R = 0; R < range.s.r; ++R) {\n        H = ROWS[R] ? ' table:style-name=\"ro' + ROWS[R].ods + '\"' : \"\";\n        o.push('        <table:table-row' + H + '></table:table-row>\\n');\n      }\n      for (; R <= range.e.r; ++R) {\n        H = ROWS[R] ? ' table:style-name=\"ro' + ROWS[R].ods + '\"' : \"\";\n        o.push('        <table:table-row' + H + '>\\n');\n        for (C = 0; C < range.s.c; ++C) o.push(null_cell_xml);\n        for (; C <= range.e.c; ++C) {\n          var skip = false,\n            ct = {},\n            textp = \"\";\n          for (mi = 0; mi != marr.length; ++mi) {\n            if (marr[mi].s.c > C) continue;\n            if (marr[mi].s.r > R) continue;\n            if (marr[mi].e.c < C) continue;\n            if (marr[mi].e.r < R) continue;\n            if (marr[mi].s.c != C || marr[mi].s.r != R) skip = true;\n            ct['table:number-columns-spanned'] = marr[mi].e.c - marr[mi].s.c + 1;\n            ct['table:number-rows-spanned'] = marr[mi].e.r - marr[mi].s.r + 1;\n            break;\n          }\n          if (skip) {\n            o.push(covered_cell_xml);\n            continue;\n          }\n          var ref = encode_cell({\n              r: R,\n              c: C\n            }),\n            cell = dense ? (ws[R] || [])[C] : ws[ref];\n          if (cell && cell.f) {\n            ct['table:formula'] = escapexml(csf_to_ods_formula(cell.f));\n            if (cell.F) {\n              if (cell.F.slice(0, ref.length) == ref) {\n                var _Fref = decode_range(cell.F);\n                ct['table:number-matrix-columns-spanned'] = _Fref.e.c - _Fref.s.c + 1;\n                ct['table:number-matrix-rows-spanned'] = _Fref.e.r - _Fref.s.r + 1;\n              }\n            }\n          }\n          if (!cell) {\n            o.push(null_cell_xml);\n            continue;\n          }\n          switch (cell.t) {\n            case 'b':\n              textp = cell.v ? 'TRUE' : 'FALSE';\n              ct['office:value-type'] = \"boolean\";\n              ct['office:boolean-value'] = cell.v ? 'true' : 'false';\n              break;\n            case 'n':\n              textp = cell.w || String(cell.v || 0);\n              ct['office:value-type'] = \"float\";\n              ct['office:value'] = cell.v || 0;\n              break;\n            case 's':\n            case 'str':\n              textp = cell.v == null ? \"\" : cell.v;\n              ct['office:value-type'] = \"string\";\n              break;\n            case 'd':\n              textp = cell.w || parseDate(cell.v).toISOString();\n              ct['office:value-type'] = \"date\";\n              ct['office:date-value'] = parseDate(cell.v).toISOString();\n              ct['table:style-name'] = \"ce1\";\n              break;\n            //case 'e':\n            default:\n              o.push(null_cell_xml);\n              continue;\n          }\n          var text_p = write_text_p(textp);\n          if (cell.l && cell.l.Target) {\n            var _tgt = cell.l.Target;\n            _tgt = _tgt.charAt(0) == \"#\" ? \"#\" + csf_to_ods_3D(_tgt.slice(1)) : _tgt;\n            // TODO: choose correct parent path format based on link delimiters\n            if (_tgt.charAt(0) != \"#\" && !_tgt.match(/^\\w+:/)) _tgt = '../' + _tgt;\n            text_p = writextag('text:a', text_p, {\n              'xlink:href': _tgt.replace(/&/g, \"&amp;\")\n            });\n          }\n          o.push('          ' + writextag('table:table-cell', writextag('text:p', text_p, {}), ct) + '\\n');\n        }\n        o.push('        </table:table-row>\\n');\n      }\n      o.push('      </table:table>\\n');\n      return o.join(\"\");\n    };\n    var write_automatic_styles_ods = function (o, wb) {\n      o.push(' <office:automatic-styles>\\n');\n      o.push('  <number:date-style style:name=\"N37\" number:automatic-order=\"true\">\\n');\n      o.push('   <number:month number:style=\"long\"/>\\n');\n      o.push('   <number:text>/</number:text>\\n');\n      o.push('   <number:day number:style=\"long\"/>\\n');\n      o.push('   <number:text>/</number:text>\\n');\n      o.push('   <number:year/>\\n');\n      o.push('  </number:date-style>\\n');\n\n      /* column styles */\n      var cidx = 0;\n      wb.SheetNames.map(function (n) {\n        return wb.Sheets[n];\n      }).forEach(function (ws) {\n        if (!ws) return;\n        if (ws[\"!cols\"]) {\n          for (var C = 0; C < ws[\"!cols\"].length; ++C) if (ws[\"!cols\"][C]) {\n            var colobj = ws[\"!cols\"][C];\n            if (colobj.width == null && colobj.wpx == null && colobj.wch == null) continue;\n            process_col(colobj);\n            colobj.ods = cidx;\n            var w = ws[\"!cols\"][C].wpx + \"px\";\n            o.push('  <style:style style:name=\"co' + cidx + '\" style:family=\"table-column\">\\n');\n            o.push('   <style:table-column-properties fo:break-before=\"auto\" style:column-width=\"' + w + '\"/>\\n');\n            o.push('  </style:style>\\n');\n            ++cidx;\n          }\n        }\n      });\n\n      /* row styles */\n      var ridx = 0;\n      wb.SheetNames.map(function (n) {\n        return wb.Sheets[n];\n      }).forEach(function (ws) {\n        if (!ws) return;\n        if (ws[\"!rows\"]) {\n          for (var R = 0; R < ws[\"!rows\"].length; ++R) if (ws[\"!rows\"][R]) {\n            ws[\"!rows\"][R].ods = ridx;\n            var h = ws[\"!rows\"][R].hpx + \"px\";\n            o.push('  <style:style style:name=\"ro' + ridx + '\" style:family=\"table-row\">\\n');\n            o.push('   <style:table-row-properties fo:break-before=\"auto\" style:row-height=\"' + h + '\"/>\\n');\n            o.push('  </style:style>\\n');\n            ++ridx;\n          }\n        }\n      });\n\n      /* table */\n      o.push('  <style:style style:name=\"ta1\" style:family=\"table\" style:master-page-name=\"mp1\">\\n');\n      o.push('   <style:table-properties table:display=\"true\" style:writing-mode=\"lr-tb\"/>\\n');\n      o.push('  </style:style>\\n');\n\n      /* table cells, text */\n      o.push('  <style:style style:name=\"ce1\" style:family=\"table-cell\" style:parent-style-name=\"Default\" style:data-style-name=\"N37\"/>\\n');\n\n      /* page-layout */\n\n      o.push(' </office:automatic-styles>\\n');\n    };\n    return function wcx(wb, opts) {\n      var o = [XML_HEADER];\n      /* 3.1.3.2 */\n      var attr = wxt_helper({\n        'xmlns:office': \"urn:oasis:names:tc:opendocument:xmlns:office:1.0\",\n        'xmlns:table': \"urn:oasis:names:tc:opendocument:xmlns:table:1.0\",\n        'xmlns:style': \"urn:oasis:names:tc:opendocument:xmlns:style:1.0\",\n        'xmlns:text': \"urn:oasis:names:tc:opendocument:xmlns:text:1.0\",\n        'xmlns:draw': \"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\",\n        'xmlns:fo': \"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\",\n        'xmlns:xlink': \"http://www.w3.org/1999/xlink\",\n        'xmlns:dc': \"http://purl.org/dc/elements/1.1/\",\n        'xmlns:meta': \"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\",\n        'xmlns:number': \"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\",\n        'xmlns:presentation': \"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0\",\n        'xmlns:svg': \"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\",\n        'xmlns:chart': \"urn:oasis:names:tc:opendocument:xmlns:chart:1.0\",\n        'xmlns:dr3d': \"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0\",\n        'xmlns:math': \"http://www.w3.org/1998/Math/MathML\",\n        'xmlns:form': \"urn:oasis:names:tc:opendocument:xmlns:form:1.0\",\n        'xmlns:script': \"urn:oasis:names:tc:opendocument:xmlns:script:1.0\",\n        'xmlns:ooo': \"http://openoffice.org/2004/office\",\n        'xmlns:ooow': \"http://openoffice.org/2004/writer\",\n        'xmlns:oooc': \"http://openoffice.org/2004/calc\",\n        'xmlns:dom': \"http://www.w3.org/2001/xml-events\",\n        'xmlns:xforms': \"http://www.w3.org/2002/xforms\",\n        'xmlns:xsd': \"http://www.w3.org/2001/XMLSchema\",\n        'xmlns:xsi': \"http://www.w3.org/2001/XMLSchema-instance\",\n        'xmlns:sheet': \"urn:oasis:names:tc:opendocument:sh33tjs:1.0\",\n        'xmlns:rpt': \"http://openoffice.org/2005/report\",\n        'xmlns:of': \"urn:oasis:names:tc:opendocument:xmlns:of:1.2\",\n        'xmlns:xhtml': \"http://www.w3.org/1999/xhtml\",\n        'xmlns:grddl': \"http://www.w3.org/2003/g/data-view#\",\n        'xmlns:tableooo': \"http://openoffice.org/2009/table\",\n        'xmlns:drawooo': \"http://openoffice.org/2010/draw\",\n        'xmlns:calcext': \"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0\",\n        'xmlns:loext': \"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0\",\n        'xmlns:field': \"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0\",\n        'xmlns:formx': \"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0\",\n        'xmlns:css3t': \"http://www.w3.org/TR/css3-text/\",\n        'office:version': \"1.2\"\n      });\n      var fods = wxt_helper({\n        'xmlns:config': \"urn:oasis:names:tc:opendocument:xmlns:config:1.0\",\n        'office:mimetype': \"application/vnd.oasis.opendocument.spreadsheet\"\n      });\n      if (opts.bookType == \"fods\") {\n        o.push('<office:document' + attr + fods + '>\\n');\n        o.push(write_meta_ods().replace(/office:document-meta/g, \"office:meta\"));\n        // TODO: settings (equiv of settings.xml for ODS)\n      } else o.push('<office:document-content' + attr + '>\\n');\n      // o.push('  <office:scripts/>\\n');\n      write_automatic_styles_ods(o, wb);\n      o.push('  <office:body>\\n');\n      o.push('    <office:spreadsheet>\\n');\n      for (var i = 0; i != wb.SheetNames.length; ++i) o.push(write_ws(wb.Sheets[wb.SheetNames[i]], wb, i, opts));\n      o.push('    </office:spreadsheet>\\n');\n      o.push('  </office:body>\\n');\n      if (opts.bookType == \"fods\") o.push('</office:document>');else o.push('</office:document-content>');\n      return o.join(\"\");\n    };\n  }();\n  function write_ods(wb, opts) {\n    if (opts.bookType == \"fods\") return write_content_ods(wb, opts);\n    var zip = zip_new();\n    var f = \"\";\n    var manifest = [];\n    var rdf = [];\n\n    /* Part 3 Section 3.3 MIME Media Type */\n    f = \"mimetype\";\n    zip_add_file(zip, f, \"application/vnd.oasis.opendocument.spreadsheet\");\n\n    /* Part 1 Section 2.2 Documents */\n    f = \"content.xml\";\n    zip_add_file(zip, f, write_content_ods(wb, opts));\n    manifest.push([f, \"text/xml\"]);\n    rdf.push([f, \"ContentFile\"]);\n\n    /* TODO: these are hard-coded styles to satiate excel */\n    f = \"styles.xml\";\n    zip_add_file(zip, f, write_styles_ods(wb, opts));\n    manifest.push([f, \"text/xml\"]);\n    rdf.push([f, \"StylesFile\"]);\n\n    /* TODO: this is hard-coded to satiate excel */\n    f = \"meta.xml\";\n    zip_add_file(zip, f, XML_HEADER + write_meta_ods());\n    manifest.push([f, \"text/xml\"]);\n    rdf.push([f, \"MetadataFile\"]);\n\n    /* Part 3 Section 6 Metadata Manifest File */\n    f = \"manifest.rdf\";\n    zip_add_file(zip, f, write_rdf(rdf /*, opts*/));\n    manifest.push([f, \"application/rdf+xml\"]);\n\n    /* Part 3 Section 4 Manifest File */\n    f = \"META-INF/manifest.xml\";\n    zip_add_file(zip, f, write_manifest(manifest /*, opts*/));\n\n    return zip;\n  }\n\n  /*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */\n  function u8_to_dataview(array) {\n    return new DataView(array.buffer, array.byteOffset, array.byteLength);\n  }\n  function u8str(u8) {\n    return typeof TextDecoder != \"undefined\" ? new TextDecoder().decode(u8) : utf8read(a2s(u8));\n  }\n  function stru8(str) {\n    return typeof TextEncoder != \"undefined\" ? new TextEncoder().encode(str) : s2a(utf8write(str));\n  }\n  function u8contains(body, search) {\n    outer: for (var L = 0; L <= body.length - search.length; ++L) {\n      for (var j = 0; j < search.length; ++j) if (body[L + j] != search[j]) continue outer;\n      return true;\n    }\n    return false;\n  }\n  function u8concat(u8a) {\n    var len = u8a.reduce(function (acc, x) {\n      return acc + x.length;\n    }, 0);\n    var out = new Uint8Array(len);\n    var off = 0;\n    u8a.forEach(function (u8) {\n      out.set(u8, off);\n      off += u8.length;\n    });\n    return out;\n  }\n  function popcnt(x) {\n    x -= x >> 1 & 1431655765;\n    x = (x & 858993459) + (x >> 2 & 858993459);\n    return (x + (x >> 4) & 252645135) * 16843009 >>> 24;\n  }\n  function readDecimal128LE(buf, offset) {\n    var exp = (buf[offset + 15] & 127) << 7 | buf[offset + 14] >> 1;\n    var mantissa = buf[offset + 14] & 1;\n    for (var j = offset + 13; j >= offset; --j) mantissa = mantissa * 256 + buf[j];\n    return (buf[offset + 15] & 128 ? -mantissa : mantissa) * Math.pow(10, exp - 6176);\n  }\n  function writeDecimal128LE(buf, offset, value) {\n    var exp = Math.floor(value == 0 ? 0 : Math.LOG10E * Math.log(Math.abs(value))) + 6176 - 20;\n    var mantissa = value / Math.pow(10, exp - 6176);\n    buf[offset + 15] |= exp >> 7;\n    buf[offset + 14] |= (exp & 127) << 1;\n    for (var i = 0; mantissa >= 1; ++i, mantissa /= 256) buf[offset + i] = mantissa & 255;\n    buf[offset + 15] |= value >= 0 ? 0 : 128;\n  }\n  function parse_varint49(buf, ptr) {\n    var l = ptr ? ptr[0] : 0;\n    var usz = buf[l] & 127;\n    varint: if (buf[l++] >= 128) {\n      usz |= (buf[l] & 127) << 7;\n      if (buf[l++] < 128) break varint;\n      usz |= (buf[l] & 127) << 14;\n      if (buf[l++] < 128) break varint;\n      usz |= (buf[l] & 127) << 21;\n      if (buf[l++] < 128) break varint;\n      usz += (buf[l] & 127) * Math.pow(2, 28);\n      ++l;\n      if (buf[l++] < 128) break varint;\n      usz += (buf[l] & 127) * Math.pow(2, 35);\n      ++l;\n      if (buf[l++] < 128) break varint;\n      usz += (buf[l] & 127) * Math.pow(2, 42);\n      ++l;\n      if (buf[l++] < 128) break varint;\n    }\n    if (ptr) ptr[0] = l;\n    return usz;\n  }\n  function write_varint49(v) {\n    var usz = new Uint8Array(7);\n    usz[0] = v & 127;\n    var L = 1;\n    sz: if (v > 127) {\n      usz[L - 1] |= 128;\n      usz[L] = v >> 7 & 127;\n      ++L;\n      if (v <= 16383) break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v >> 14 & 127;\n      ++L;\n      if (v <= 2097151) break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v >> 21 & 127;\n      ++L;\n      if (v <= 268435455) break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v / 256 >>> 21 & 127;\n      ++L;\n      if (v <= 34359738367) break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v / 65536 >>> 21 & 127;\n      ++L;\n      if (v <= 4398046511103) break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v / 16777216 >>> 21 & 127;\n      ++L;\n    }\n    return usz.slice(0, L);\n  }\n  function varint_to_i32(buf) {\n    var l = 0,\n      i32 = buf[l] & 127;\n    varint: if (buf[l++] >= 128) {\n      i32 |= (buf[l] & 127) << 7;\n      if (buf[l++] < 128) break varint;\n      i32 |= (buf[l] & 127) << 14;\n      if (buf[l++] < 128) break varint;\n      i32 |= (buf[l] & 127) << 21;\n      if (buf[l++] < 128) break varint;\n      i32 |= (buf[l] & 127) << 28;\n    }\n    return i32;\n  }\n  function parse_shallow(buf) {\n    var out = [],\n      ptr = [0];\n    while (ptr[0] < buf.length) {\n      var off = ptr[0];\n      var num = parse_varint49(buf, ptr);\n      var type = num & 7;\n      num = Math.floor(num / 8);\n      var len = 0;\n      var res;\n      if (num == 0) break;\n      switch (type) {\n        case 0:\n          {\n            var l = ptr[0];\n            while (buf[ptr[0]++] >= 128);\n            res = buf.slice(l, ptr[0]);\n          }\n          break;\n        case 5:\n          len = 4;\n          res = buf.slice(ptr[0], ptr[0] + len);\n          ptr[0] += len;\n          break;\n        case 1:\n          len = 8;\n          res = buf.slice(ptr[0], ptr[0] + len);\n          ptr[0] += len;\n          break;\n        case 2:\n          len = parse_varint49(buf, ptr);\n          res = buf.slice(ptr[0], ptr[0] + len);\n          ptr[0] += len;\n          break;\n        case 3:\n        case 4:\n        default:\n          throw new Error(\"PB Type \".concat(type, \" for Field \").concat(num, \" at offset \").concat(off));\n      }\n      var v = {\n        data: res,\n        type: type\n      };\n      if (out[num] == null) out[num] = [v];else out[num].push(v);\n    }\n    return out;\n  }\n  function write_shallow(proto) {\n    var out = [];\n    proto.forEach(function (field, idx) {\n      field.forEach(function (item) {\n        if (!item.data) return;\n        out.push(write_varint49(idx * 8 + item.type));\n        if (item.type == 2) out.push(write_varint49(item.data.length));\n        out.push(item.data);\n      });\n    });\n    return u8concat(out);\n  }\n  function mappa(data, cb) {\n    return (data == null ? void 0 : data.map(function (d) {\n      return cb(d.data);\n    })) || [];\n  }\n  function parse_iwa_file(buf) {\n    var _a;\n    var out = [],\n      ptr = [0];\n    while (ptr[0] < buf.length) {\n      var len = parse_varint49(buf, ptr);\n      var ai = parse_shallow(buf.slice(ptr[0], ptr[0] + len));\n      ptr[0] += len;\n      var res = {\n        id: varint_to_i32(ai[1][0].data),\n        messages: []\n      };\n      ai[2].forEach(function (b) {\n        var mi = parse_shallow(b.data);\n        var fl = varint_to_i32(mi[3][0].data);\n        res.messages.push({\n          meta: mi,\n          data: buf.slice(ptr[0], ptr[0] + fl)\n        });\n        ptr[0] += fl;\n      });\n      if ((_a = ai[3]) == null ? void 0 : _a[0]) res.merge = varint_to_i32(ai[3][0].data) >>> 0 > 0;\n      out.push(res);\n    }\n    return out;\n  }\n  function write_iwa_file(ias) {\n    var bufs = [];\n    ias.forEach(function (ia) {\n      var ai = [];\n      ai[1] = [{\n        data: write_varint49(ia.id),\n        type: 0\n      }];\n      ai[2] = [];\n      if (ia.merge != null) ai[3] = [{\n        data: write_varint49(+!!ia.merge),\n        type: 0\n      }];\n      var midata = [];\n      ia.messages.forEach(function (mi) {\n        midata.push(mi.data);\n        mi.meta[3] = [{\n          type: 0,\n          data: write_varint49(mi.data.length)\n        }];\n        ai[2].push({\n          data: write_shallow(mi.meta),\n          type: 2\n        });\n      });\n      var aipayload = write_shallow(ai);\n      bufs.push(write_varint49(aipayload.length));\n      bufs.push(aipayload);\n      midata.forEach(function (mid) {\n        return bufs.push(mid);\n      });\n    });\n    return u8concat(bufs);\n  }\n  function parse_snappy_chunk(type, buf) {\n    if (type != 0) throw new Error(\"Unexpected Snappy chunk type \".concat(type));\n    var ptr = [0];\n    var usz = parse_varint49(buf, ptr);\n    var chunks = [];\n    while (ptr[0] < buf.length) {\n      var tag = buf[ptr[0]] & 3;\n      if (tag == 0) {\n        var len = buf[ptr[0]++] >> 2;\n        if (len < 60) ++len;else {\n          var c = len - 59;\n          len = buf[ptr[0]];\n          if (c > 1) len |= buf[ptr[0] + 1] << 8;\n          if (c > 2) len |= buf[ptr[0] + 2] << 16;\n          if (c > 3) len |= buf[ptr[0] + 3] << 24;\n          len >>>= 0;\n          len++;\n          ptr[0] += c;\n        }\n        chunks.push(buf.slice(ptr[0], ptr[0] + len));\n        ptr[0] += len;\n        continue;\n      } else {\n        var offset = 0,\n          length = 0;\n        if (tag == 1) {\n          length = (buf[ptr[0]] >> 2 & 7) + 4;\n          offset = (buf[ptr[0]++] & 224) << 3;\n          offset |= buf[ptr[0]++];\n        } else {\n          length = (buf[ptr[0]++] >> 2) + 1;\n          if (tag == 2) {\n            offset = buf[ptr[0]] | buf[ptr[0] + 1] << 8;\n            ptr[0] += 2;\n          } else {\n            offset = (buf[ptr[0]] | buf[ptr[0] + 1] << 8 | buf[ptr[0] + 2] << 16 | buf[ptr[0] + 3] << 24) >>> 0;\n            ptr[0] += 4;\n          }\n        }\n        chunks = [u8concat(chunks)];\n        if (offset == 0) throw new Error(\"Invalid offset 0\");\n        if (offset > chunks[0].length) throw new Error(\"Invalid offset beyond length\");\n        if (length >= offset) {\n          chunks.push(chunks[0].slice(-offset));\n          length -= offset;\n          while (length >= chunks[chunks.length - 1].length) {\n            chunks.push(chunks[chunks.length - 1]);\n            length -= chunks[chunks.length - 1].length;\n          }\n        }\n        chunks.push(chunks[0].slice(-offset, -offset + length));\n      }\n    }\n    var o = u8concat(chunks);\n    if (o.length != usz) throw new Error(\"Unexpected length: \".concat(o.length, \" != \").concat(usz));\n    return o;\n  }\n  function decompress_iwa_file(buf) {\n    var out = [];\n    var l = 0;\n    while (l < buf.length) {\n      var t = buf[l++];\n      var len = buf[l] | buf[l + 1] << 8 | buf[l + 2] << 16;\n      l += 3;\n      out.push(parse_snappy_chunk(t, buf.slice(l, l + len)));\n      l += len;\n    }\n    if (l !== buf.length) throw new Error(\"data is not a valid framed stream!\");\n    return u8concat(out);\n  }\n  function compress_iwa_file(buf) {\n    var out = [];\n    var l = 0;\n    while (l < buf.length) {\n      var c = Math.min(buf.length - l, 268435455);\n      var frame = new Uint8Array(4);\n      out.push(frame);\n      var usz = write_varint49(c);\n      var L = usz.length;\n      out.push(usz);\n      if (c <= 60) {\n        L++;\n        out.push(new Uint8Array([c - 1 << 2]));\n      } else if (c <= 256) {\n        L += 2;\n        out.push(new Uint8Array([240, c - 1 & 255]));\n      } else if (c <= 65536) {\n        L += 3;\n        out.push(new Uint8Array([244, c - 1 & 255, c - 1 >> 8 & 255]));\n      } else if (c <= 16777216) {\n        L += 4;\n        out.push(new Uint8Array([248, c - 1 & 255, c - 1 >> 8 & 255, c - 1 >> 16 & 255]));\n      } else if (c <= 4294967296) {\n        L += 5;\n        out.push(new Uint8Array([252, c - 1 & 255, c - 1 >> 8 & 255, c - 1 >> 16 & 255, c - 1 >>> 24 & 255]));\n      }\n      out.push(buf.slice(l, l + c));\n      L += c;\n      frame[0] = 0;\n      frame[1] = L & 255;\n      frame[2] = L >> 8 & 255;\n      frame[3] = L >> 16 & 255;\n      l += c;\n    }\n    return u8concat(out);\n  }\n  function parse_old_storage(buf, sst, rsst, v) {\n    var dv = u8_to_dataview(buf);\n    var flags = dv.getUint32(4, true);\n    var data_offset = (v > 1 ? 12 : 8) + popcnt(flags & (v > 1 ? 3470 : 398)) * 4;\n    var ridx = -1,\n      sidx = -1,\n      ieee = NaN,\n      dt = new Date(2001, 0, 1);\n    if (flags & 512) {\n      ridx = dv.getUint32(data_offset, true);\n      data_offset += 4;\n    }\n    data_offset += popcnt(flags & (v > 1 ? 12288 : 4096)) * 4;\n    if (flags & 16) {\n      sidx = dv.getUint32(data_offset, true);\n      data_offset += 4;\n    }\n    if (flags & 32) {\n      ieee = dv.getFloat64(data_offset, true);\n      data_offset += 8;\n    }\n    if (flags & 64) {\n      dt.setTime(dt.getTime() + dv.getFloat64(data_offset, true) * 1e3);\n      data_offset += 8;\n    }\n    var ret;\n    switch (buf[2]) {\n      case 0:\n        break;\n      case 2:\n        ret = {\n          t: \"n\",\n          v: ieee\n        };\n        break;\n      case 3:\n        ret = {\n          t: \"s\",\n          v: sst[sidx]\n        };\n        break;\n      case 5:\n        ret = {\n          t: \"d\",\n          v: dt\n        };\n        break;\n      case 6:\n        ret = {\n          t: \"b\",\n          v: ieee > 0\n        };\n        break;\n      case 7:\n        ret = {\n          t: \"n\",\n          v: ieee / 86400\n        };\n        break;\n      case 8:\n        ret = {\n          t: \"e\",\n          v: 0\n        };\n        break;\n      case 9:\n        {\n          if (ridx > -1) ret = {\n            t: \"s\",\n            v: rsst[ridx]\n          };else if (sidx > -1) ret = {\n            t: \"s\",\n            v: sst[sidx]\n          };else if (!isNaN(ieee)) ret = {\n            t: \"n\",\n            v: ieee\n          };else throw new Error(\"Unsupported cell type \".concat(buf.slice(0, 4)));\n        }\n        break;\n      default:\n        throw new Error(\"Unsupported cell type \".concat(buf.slice(0, 4)));\n    }\n    return ret;\n  }\n  function parse_new_storage(buf, sst, rsst) {\n    var dv = u8_to_dataview(buf);\n    var flags = dv.getUint32(8, true);\n    var data_offset = 12;\n    var ridx = -1,\n      sidx = -1,\n      d128 = NaN,\n      ieee = NaN,\n      dt = new Date(2001, 0, 1);\n    if (flags & 1) {\n      d128 = readDecimal128LE(buf, data_offset);\n      data_offset += 16;\n    }\n    if (flags & 2) {\n      ieee = dv.getFloat64(data_offset, true);\n      data_offset += 8;\n    }\n    if (flags & 4) {\n      dt.setTime(dt.getTime() + dv.getFloat64(data_offset, true) * 1e3);\n      data_offset += 8;\n    }\n    if (flags & 8) {\n      sidx = dv.getUint32(data_offset, true);\n      data_offset += 4;\n    }\n    if (flags & 16) {\n      ridx = dv.getUint32(data_offset, true);\n      data_offset += 4;\n    }\n    var ret;\n    switch (buf[1]) {\n      case 0:\n        break;\n      case 2:\n        ret = {\n          t: \"n\",\n          v: d128\n        };\n        break;\n      case 3:\n        ret = {\n          t: \"s\",\n          v: sst[sidx]\n        };\n        break;\n      case 5:\n        ret = {\n          t: \"d\",\n          v: dt\n        };\n        break;\n      case 6:\n        ret = {\n          t: \"b\",\n          v: ieee > 0\n        };\n        break;\n      case 7:\n        ret = {\n          t: \"n\",\n          v: ieee / 86400\n        };\n        break;\n      case 8:\n        ret = {\n          t: \"e\",\n          v: 0\n        };\n        break;\n      case 9:\n        {\n          if (ridx > -1) ret = {\n            t: \"s\",\n            v: rsst[ridx]\n          };else throw new Error(\"Unsupported cell type \".concat(buf[1], \" : \").concat(flags & 31, \" : \").concat(buf.slice(0, 4)));\n        }\n        break;\n      case 10:\n        ret = {\n          t: \"n\",\n          v: d128\n        };\n        break;\n      default:\n        throw new Error(\"Unsupported cell type \".concat(buf[1], \" : \").concat(flags & 31, \" : \").concat(buf.slice(0, 4)));\n    }\n    return ret;\n  }\n  function write_new_storage(cell, sst) {\n    var out = new Uint8Array(32),\n      dv = u8_to_dataview(out),\n      l = 12,\n      flags = 0;\n    out[0] = 5;\n    switch (cell.t) {\n      case \"n\":\n        out[1] = 2;\n        writeDecimal128LE(out, l, cell.v);\n        flags |= 1;\n        l += 16;\n        break;\n      case \"b\":\n        out[1] = 6;\n        dv.setFloat64(l, cell.v ? 1 : 0, true);\n        flags |= 2;\n        l += 8;\n        break;\n      case \"s\":\n        if (sst.indexOf(cell.v) == -1) throw new Error(\"Value \".concat(cell.v, \" missing from SST!\"));\n        out[1] = 3;\n        dv.setUint32(l, sst.indexOf(cell.v), true);\n        flags |= 8;\n        l += 4;\n        break;\n      default:\n        throw \"unsupported cell type \" + cell.t;\n    }\n    dv.setUint32(8, flags, true);\n    return out.slice(0, l);\n  }\n  function write_old_storage(cell, sst) {\n    var out = new Uint8Array(32),\n      dv = u8_to_dataview(out),\n      l = 12,\n      flags = 0;\n    out[0] = 3;\n    switch (cell.t) {\n      case \"n\":\n        out[2] = 2;\n        dv.setFloat64(l, cell.v, true);\n        flags |= 32;\n        l += 8;\n        break;\n      case \"b\":\n        out[2] = 6;\n        dv.setFloat64(l, cell.v ? 1 : 0, true);\n        flags |= 32;\n        l += 8;\n        break;\n      case \"s\":\n        if (sst.indexOf(cell.v) == -1) throw new Error(\"Value \".concat(cell.v, \" missing from SST!\"));\n        out[2] = 3;\n        dv.setUint32(l, sst.indexOf(cell.v), true);\n        flags |= 16;\n        l += 4;\n        break;\n      default:\n        throw \"unsupported cell type \" + cell.t;\n    }\n    dv.setUint32(4, flags, true);\n    return out.slice(0, l);\n  }\n  function parse_cell_storage(buf, sst, rsst) {\n    switch (buf[0]) {\n      case 0:\n      case 1:\n      case 2:\n      case 3:\n        return parse_old_storage(buf, sst, rsst, buf[0]);\n      case 5:\n        return parse_new_storage(buf, sst, rsst);\n      default:\n        throw new Error(\"Unsupported payload version \".concat(buf[0]));\n    }\n  }\n  function parse_TSP_Reference(buf) {\n    var pb = parse_shallow(buf);\n    return parse_varint49(pb[1][0].data);\n  }\n  function write_TSP_Reference(idx) {\n    var out = [];\n    out[1] = [{\n      type: 0,\n      data: write_varint49(idx)\n    }];\n    return write_shallow(out);\n  }\n  function parse_TST_TableDataList(M, root) {\n    var pb = parse_shallow(root.data);\n    var type = varint_to_i32(pb[1][0].data);\n    var entries = pb[3];\n    var data = [];\n    (entries || []).forEach(function (entry) {\n      var le = parse_shallow(entry.data);\n      var key = varint_to_i32(le[1][0].data) >>> 0;\n      switch (type) {\n        case 1:\n          data[key] = u8str(le[3][0].data);\n          break;\n        case 8:\n          {\n            var rt = M[parse_TSP_Reference(le[9][0].data)][0];\n            var rtp = parse_shallow(rt.data);\n            var rtpref = M[parse_TSP_Reference(rtp[1][0].data)][0];\n            var mtype = varint_to_i32(rtpref.meta[1][0].data);\n            if (mtype != 2001) throw new Error(\"2000 unexpected reference to \".concat(mtype));\n            var tswpsa = parse_shallow(rtpref.data);\n            data[key] = tswpsa[3].map(function (x) {\n              return u8str(x.data);\n            }).join(\"\");\n          }\n          break;\n      }\n    });\n    return data;\n  }\n  function parse_TST_TileRowInfo(u8, type) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _i, _j, _k, _l, _m, _n;\n    var pb = parse_shallow(u8);\n    var R = varint_to_i32(pb[1][0].data) >>> 0;\n    var cnt = varint_to_i32(pb[2][0].data) >>> 0;\n    var wide_offsets = ((_b = (_a = pb[8]) == null ? void 0 : _a[0]) == null ? void 0 : _b.data) && varint_to_i32(pb[8][0].data) > 0 || false;\n    var used_storage_u8, used_storage;\n    if (((_d = (_c = pb[7]) == null ? void 0 : _c[0]) == null ? void 0 : _d.data) && type != 0) {\n      used_storage_u8 = (_f = (_e = pb[7]) == null ? void 0 : _e[0]) == null ? void 0 : _f.data;\n      used_storage = (_h = (_g = pb[6]) == null ? void 0 : _g[0]) == null ? void 0 : _h.data;\n    } else if (((_j = (_i = pb[4]) == null ? void 0 : _i[0]) == null ? void 0 : _j.data) && type != 1) {\n      used_storage_u8 = (_l = (_k = pb[4]) == null ? void 0 : _k[0]) == null ? void 0 : _l.data;\n      used_storage = (_n = (_m = pb[3]) == null ? void 0 : _m[0]) == null ? void 0 : _n.data;\n    } else throw \"NUMBERS Tile missing \".concat(type, \" cell storage\");\n    var width = wide_offsets ? 4 : 1;\n    var used_storage_offsets = u8_to_dataview(used_storage_u8);\n    var offsets = [];\n    for (var C = 0; C < used_storage_u8.length / 2; ++C) {\n      var off = used_storage_offsets.getUint16(C * 2, true);\n      if (off < 65535) offsets.push([C, off]);\n    }\n    if (offsets.length != cnt) throw \"Expected \".concat(cnt, \" cells, found \").concat(offsets.length);\n    var cells = [];\n    for (C = 0; C < offsets.length - 1; ++C) cells[offsets[C][0]] = used_storage.subarray(offsets[C][1] * width, offsets[C + 1][1] * width);\n    if (offsets.length >= 1) cells[offsets[offsets.length - 1][0]] = used_storage.subarray(offsets[offsets.length - 1][1] * width);\n    return {\n      R: R,\n      cells: cells\n    };\n  }\n  function parse_TST_Tile(M, root) {\n    var _a;\n    var pb = parse_shallow(root.data);\n    var storage = ((_a = pb == null ? void 0 : pb[7]) == null ? void 0 : _a[0]) ? varint_to_i32(pb[7][0].data) >>> 0 > 0 ? 1 : 0 : -1;\n    var ri = mappa(pb[5], function (u8) {\n      return parse_TST_TileRowInfo(u8, storage);\n    });\n    return {\n      nrows: varint_to_i32(pb[4][0].data) >>> 0,\n      data: ri.reduce(function (acc, x) {\n        if (!acc[x.R]) acc[x.R] = [];\n        x.cells.forEach(function (cell, C) {\n          if (acc[x.R][C]) throw new Error(\"Duplicate cell r=\".concat(x.R, \" c=\").concat(C));\n          acc[x.R][C] = cell;\n        });\n        return acc;\n      }, [])\n    };\n  }\n  function parse_TST_TableModelArchive(M, root, ws) {\n    var _a;\n    var pb = parse_shallow(root.data);\n    var range = {\n      s: {\n        r: 0,\n        c: 0\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    range.e.r = (varint_to_i32(pb[6][0].data) >>> 0) - 1;\n    if (range.e.r < 0) throw new Error(\"Invalid row varint \".concat(pb[6][0].data));\n    range.e.c = (varint_to_i32(pb[7][0].data) >>> 0) - 1;\n    if (range.e.c < 0) throw new Error(\"Invalid col varint \".concat(pb[7][0].data));\n    ws[\"!ref\"] = encode_range(range);\n    var store = parse_shallow(pb[4][0].data);\n    var sst = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[4][0].data)][0]);\n    var rsst = ((_a = store[17]) == null ? void 0 : _a[0]) ? parse_TST_TableDataList(M, M[parse_TSP_Reference(store[17][0].data)][0]) : [];\n    var tile = parse_shallow(store[3][0].data);\n    var _R = 0;\n    tile[1].forEach(function (t) {\n      var tl = parse_shallow(t.data);\n      var ref = M[parse_TSP_Reference(tl[2][0].data)][0];\n      var mtype = varint_to_i32(ref.meta[1][0].data);\n      if (mtype != 6002) throw new Error(\"6001 unexpected reference to \".concat(mtype));\n      var _tile = parse_TST_Tile(M, ref);\n      _tile.data.forEach(function (row, R) {\n        row.forEach(function (buf, C) {\n          var addr = encode_cell({\n            r: _R + R,\n            c: C\n          });\n          var res = parse_cell_storage(buf, sst, rsst);\n          if (res) ws[addr] = res;\n        });\n      });\n      _R += _tile.nrows;\n    });\n  }\n  function parse_TST_TableInfoArchive(M, root) {\n    var pb = parse_shallow(root.data);\n    var out = {\n      \"!ref\": \"A1\"\n    };\n    var tableref = M[parse_TSP_Reference(pb[2][0].data)];\n    var mtype = varint_to_i32(tableref[0].meta[1][0].data);\n    if (mtype != 6001) throw new Error(\"6000 unexpected reference to \".concat(mtype));\n    parse_TST_TableModelArchive(M, tableref[0], out);\n    return out;\n  }\n  function parse_TN_SheetArchive(M, root) {\n    var _a;\n    var pb = parse_shallow(root.data);\n    var out = {\n      name: ((_a = pb[1]) == null ? void 0 : _a[0]) ? u8str(pb[1][0].data) : \"\",\n      sheets: []\n    };\n    var shapeoffs = mappa(pb[2], parse_TSP_Reference);\n    shapeoffs.forEach(function (off) {\n      M[off].forEach(function (m) {\n        var mtype = varint_to_i32(m.meta[1][0].data);\n        if (mtype == 6e3) out.sheets.push(parse_TST_TableInfoArchive(M, m));\n      });\n    });\n    return out;\n  }\n  function parse_TN_DocumentArchive(M, root) {\n    var out = book_new();\n    var pb = parse_shallow(root.data);\n    var sheetoffs = mappa(pb[1], parse_TSP_Reference);\n    sheetoffs.forEach(function (off) {\n      M[off].forEach(function (m) {\n        var mtype = varint_to_i32(m.meta[1][0].data);\n        if (mtype == 2) {\n          var root2 = parse_TN_SheetArchive(M, m);\n          root2.sheets.forEach(function (sheet, idx) {\n            book_append_sheet(out, sheet, idx == 0 ? root2.name : root2.name + \"_\" + idx, true);\n          });\n        }\n      });\n    });\n    if (out.SheetNames.length == 0) throw new Error(\"Empty NUMBERS file\");\n    return out;\n  }\n  function parse_numbers_iwa(cfb) {\n    var _a, _b, _c, _d;\n    var M = {},\n      indices = [];\n    cfb.FullPaths.forEach(function (p) {\n      if (p.match(/\\.iwpv2/)) throw new Error(\"Unsupported password protection\");\n    });\n    cfb.FileIndex.forEach(function (s) {\n      if (!s.name.match(/\\.iwa$/)) return;\n      var o;\n      try {\n        o = decompress_iwa_file(s.content);\n      } catch (e) {\n        return console.log(\"?? \" + s.content.length + \" \" + (e.message || e));\n      }\n      var packets;\n      try {\n        packets = parse_iwa_file(o);\n      } catch (e) {\n        return console.log(\"## \" + (e.message || e));\n      }\n      packets.forEach(function (packet) {\n        M[packet.id] = packet.messages;\n        indices.push(packet.id);\n      });\n    });\n    if (!indices.length) throw new Error(\"File has no messages\");\n    var docroot = ((_d = (_c = (_b = (_a = M == null ? void 0 : M[1]) == null ? void 0 : _a[0]) == null ? void 0 : _b.meta) == null ? void 0 : _c[1]) == null ? void 0 : _d[0].data) && varint_to_i32(M[1][0].meta[1][0].data) == 1 && M[1][0];\n    if (!docroot) indices.forEach(function (idx) {\n      M[idx].forEach(function (iwam) {\n        var mtype = varint_to_i32(iwam.meta[1][0].data) >>> 0;\n        if (mtype == 1) {\n          if (!docroot) docroot = iwam;else throw new Error(\"Document has multiple roots\");\n        }\n      });\n    });\n    if (!docroot) throw new Error(\"Cannot find Document root\");\n    return parse_TN_DocumentArchive(M, docroot);\n  }\n  function write_tile_row(tri, data, SST) {\n    var _a, _b, _c, _d;\n    if (!((_a = tri[6]) == null ? void 0 : _a[0]) || !((_b = tri[7]) == null ? void 0 : _b[0])) throw \"Mutation only works on post-BNC storages!\";\n    var wide_offsets = ((_d = (_c = tri[8]) == null ? void 0 : _c[0]) == null ? void 0 : _d.data) && varint_to_i32(tri[8][0].data) > 0 || false;\n    if (wide_offsets) throw \"Math only works with normal offsets\";\n    var cnt = 0;\n    var dv = u8_to_dataview(tri[7][0].data),\n      last_offset = 0,\n      cell_storage = [];\n    var _dv = u8_to_dataview(tri[4][0].data),\n      _last_offset = 0,\n      _cell_storage = [];\n    for (var C = 0; C < data.length; ++C) {\n      if (data[C] == null) {\n        dv.setUint16(C * 2, 65535, true);\n        _dv.setUint16(C * 2, 65535);\n        continue;\n      }\n      dv.setUint16(C * 2, last_offset, true);\n      _dv.setUint16(C * 2, _last_offset, true);\n      var celload, _celload;\n      switch (typeof data[C]) {\n        case \"string\":\n          celload = write_new_storage({\n            t: \"s\",\n            v: data[C]\n          }, SST);\n          _celload = write_old_storage({\n            t: \"s\",\n            v: data[C]\n          }, SST);\n          break;\n        case \"number\":\n          celload = write_new_storage({\n            t: \"n\",\n            v: data[C]\n          }, SST);\n          _celload = write_old_storage({\n            t: \"n\",\n            v: data[C]\n          }, SST);\n          break;\n        case \"boolean\":\n          celload = write_new_storage({\n            t: \"b\",\n            v: data[C]\n          }, SST);\n          _celload = write_old_storage({\n            t: \"b\",\n            v: data[C]\n          }, SST);\n          break;\n        default:\n          throw new Error(\"Unsupported value \" + data[C]);\n      }\n      cell_storage.push(celload);\n      last_offset += celload.length;\n      _cell_storage.push(_celload);\n      _last_offset += _celload.length;\n      ++cnt;\n    }\n    tri[2][0].data = write_varint49(cnt);\n    for (; C < tri[7][0].data.length / 2; ++C) {\n      dv.setUint16(C * 2, 65535, true);\n      _dv.setUint16(C * 2, 65535, true);\n    }\n    tri[6][0].data = u8concat(cell_storage);\n    tri[3][0].data = u8concat(_cell_storage);\n    return cnt;\n  }\n  function write_numbers_iwa(wb, opts) {\n    if (!opts || !opts.numbers) throw new Error(\"Must pass a `numbers` option -- check the README\");\n    var ws = wb.Sheets[wb.SheetNames[0]];\n    if (wb.SheetNames.length > 1) console.error(\"The Numbers writer currently writes only the first table\");\n    var range = decode_range(ws[\"!ref\"]);\n    range.s.r = range.s.c = 0;\n    var trunc = false;\n    if (range.e.c > 9) {\n      trunc = true;\n      range.e.c = 9;\n    }\n    if (range.e.r > 49) {\n      trunc = true;\n      range.e.r = 49;\n    }\n    if (trunc) console.error(\"The Numbers writer is currently limited to \".concat(encode_range(range)));\n    var data = sheet_to_json(ws, {\n      range: range,\n      header: 1\n    });\n    var SST = [\"~Sh33tJ5~\"];\n    data.forEach(function (row) {\n      return row.forEach(function (cell) {\n        if (typeof cell == \"string\") SST.push(cell);\n      });\n    });\n    var dependents = {};\n    var indices = [];\n    var cfb = CFB.read(opts.numbers, {\n      type: \"base64\"\n    });\n    cfb.FileIndex.map(function (fi, idx) {\n      return [fi, cfb.FullPaths[idx]];\n    }).forEach(function (row) {\n      var fi = row[0],\n        fp = row[1];\n      if (fi.type != 2) return;\n      if (!fi.name.match(/\\.iwa/)) return;\n      var old_content = fi.content;\n      var raw1 = decompress_iwa_file(old_content);\n      var x2 = parse_iwa_file(raw1);\n      x2.forEach(function (packet2) {\n        indices.push(packet2.id);\n        dependents[packet2.id] = {\n          deps: [],\n          location: fp,\n          type: varint_to_i32(packet2.messages[0].meta[1][0].data)\n        };\n      });\n    });\n    indices.sort(function (x2, y2) {\n      return x2 - y2;\n    });\n    var indices_varint = indices.filter(function (x2) {\n      return x2 > 1;\n    }).map(function (x2) {\n      return [x2, write_varint49(x2)];\n    });\n    cfb.FileIndex.map(function (fi, idx) {\n      return [fi, cfb.FullPaths[idx]];\n    }).forEach(function (row) {\n      var fi = row[0],\n        fp = row[1];\n      if (!fi.name.match(/\\.iwa/)) return;\n      var x2 = parse_iwa_file(decompress_iwa_file(fi.content));\n      x2.forEach(function (ia) {\n        ia.messages.forEach(function (m) {\n          indices_varint.forEach(function (ivi) {\n            if (ia.messages.some(function (mess) {\n              return varint_to_i32(mess.meta[1][0].data) != 11006 && u8contains(mess.data, ivi[1]);\n            })) {\n              dependents[ivi[0]].deps.push(ia.id);\n            }\n          });\n        });\n      });\n    });\n    function get_unique_msgid() {\n      for (var i = 927262; i < 2e6; ++i) if (!dependents[i]) return i;\n      throw new Error(\"Too many messages\");\n    }\n    var entry = CFB.find(cfb, dependents[1].location);\n    var x = parse_iwa_file(decompress_iwa_file(entry.content));\n    var docroot;\n    for (var xi = 0; xi < x.length; ++xi) {\n      var packet = x[xi];\n      if (packet.id == 1) docroot = packet;\n    }\n    var sheetrootref = parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[1][0].data);\n    entry = CFB.find(cfb, dependents[sheetrootref].location);\n    x = parse_iwa_file(decompress_iwa_file(entry.content));\n    for (xi = 0; xi < x.length; ++xi) {\n      packet = x[xi];\n      if (packet.id == sheetrootref) docroot = packet;\n    }\n    sheetrootref = parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[2][0].data);\n    entry = CFB.find(cfb, dependents[sheetrootref].location);\n    x = parse_iwa_file(decompress_iwa_file(entry.content));\n    for (xi = 0; xi < x.length; ++xi) {\n      packet = x[xi];\n      if (packet.id == sheetrootref) docroot = packet;\n    }\n    sheetrootref = parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[2][0].data);\n    entry = CFB.find(cfb, dependents[sheetrootref].location);\n    x = parse_iwa_file(decompress_iwa_file(entry.content));\n    for (xi = 0; xi < x.length; ++xi) {\n      packet = x[xi];\n      if (packet.id == sheetrootref) docroot = packet;\n    }\n    var pb = parse_shallow(docroot.messages[0].data);\n    {\n      pb[6][0].data = write_varint49(range.e.r + 1);\n      pb[7][0].data = write_varint49(range.e.c + 1);\n      var cruidsref = parse_TSP_Reference(pb[46][0].data);\n      var oldbucket = CFB.find(cfb, dependents[cruidsref].location);\n      var _x = parse_iwa_file(decompress_iwa_file(oldbucket.content));\n      {\n        for (var j = 0; j < _x.length; ++j) {\n          if (_x[j].id == cruidsref) break;\n        }\n        if (_x[j].id != cruidsref) throw \"Bad ColumnRowUIDMapArchive\";\n        var cruids = parse_shallow(_x[j].messages[0].data);\n        cruids[1] = [];\n        cruids[2] = [], cruids[3] = [];\n        for (var C = 0; C <= range.e.c; ++C) {\n          var uuid = [];\n          uuid[1] = uuid[2] = [{\n            type: 0,\n            data: write_varint49(C + 420690)\n          }];\n          cruids[1].push({\n            type: 2,\n            data: write_shallow(uuid)\n          });\n          cruids[2].push({\n            type: 0,\n            data: write_varint49(C)\n          });\n          cruids[3].push({\n            type: 0,\n            data: write_varint49(C)\n          });\n        }\n        cruids[4] = [];\n        cruids[5] = [], cruids[6] = [];\n        for (var R = 0; R <= range.e.r; ++R) {\n          uuid = [];\n          uuid[1] = uuid[2] = [{\n            type: 0,\n            data: write_varint49(R + 726270)\n          }];\n          cruids[4].push({\n            type: 2,\n            data: write_shallow(uuid)\n          });\n          cruids[5].push({\n            type: 0,\n            data: write_varint49(R)\n          });\n          cruids[6].push({\n            type: 0,\n            data: write_varint49(R)\n          });\n        }\n        _x[j].messages[0].data = write_shallow(cruids);\n      }\n      oldbucket.content = compress_iwa_file(write_iwa_file(_x));\n      oldbucket.size = oldbucket.content.length;\n      delete pb[46];\n      var store = parse_shallow(pb[4][0].data);\n      {\n        store[7][0].data = write_varint49(range.e.r + 1);\n        var row_headers = parse_shallow(store[1][0].data);\n        var row_header_ref = parse_TSP_Reference(row_headers[2][0].data);\n        oldbucket = CFB.find(cfb, dependents[row_header_ref].location);\n        _x = parse_iwa_file(decompress_iwa_file(oldbucket.content));\n        {\n          if (_x[0].id != row_header_ref) throw \"Bad HeaderStorageBucket\";\n          var base_bucket = parse_shallow(_x[0].messages[0].data);\n          for (R = 0; R < data.length; ++R) {\n            var _bucket = parse_shallow(base_bucket[2][0].data);\n            _bucket[1][0].data = write_varint49(R);\n            _bucket[4][0].data = write_varint49(data[R].length);\n            base_bucket[2][R] = {\n              type: base_bucket[2][0].type,\n              data: write_shallow(_bucket)\n            };\n          }\n          _x[0].messages[0].data = write_shallow(base_bucket);\n        }\n        oldbucket.content = compress_iwa_file(write_iwa_file(_x));\n        oldbucket.size = oldbucket.content.length;\n        var col_header_ref = parse_TSP_Reference(store[2][0].data);\n        oldbucket = CFB.find(cfb, dependents[col_header_ref].location);\n        _x = parse_iwa_file(decompress_iwa_file(oldbucket.content));\n        {\n          if (_x[0].id != col_header_ref) throw \"Bad HeaderStorageBucket\";\n          base_bucket = parse_shallow(_x[0].messages[0].data);\n          for (C = 0; C <= range.e.c; ++C) {\n            _bucket = parse_shallow(base_bucket[2][0].data);\n            _bucket[1][0].data = write_varint49(C);\n            _bucket[4][0].data = write_varint49(range.e.r + 1);\n            base_bucket[2][C] = {\n              type: base_bucket[2][0].type,\n              data: write_shallow(_bucket)\n            };\n          }\n          _x[0].messages[0].data = write_shallow(base_bucket);\n        }\n        oldbucket.content = compress_iwa_file(write_iwa_file(_x));\n        oldbucket.size = oldbucket.content.length;\n        var sstref = parse_TSP_Reference(store[4][0].data);\n        (function () {\n          var sentry = CFB.find(cfb, dependents[sstref].location);\n          var sx = parse_iwa_file(decompress_iwa_file(sentry.content));\n          var sstroot;\n          for (var sxi = 0; sxi < sx.length; ++sxi) {\n            var packet2 = sx[sxi];\n            if (packet2.id == sstref) sstroot = packet2;\n          }\n          var sstdata = parse_shallow(sstroot.messages[0].data);\n          {\n            sstdata[3] = [];\n            var newsst = [];\n            SST.forEach(function (str, i) {\n              newsst[1] = [{\n                type: 0,\n                data: write_varint49(i)\n              }];\n              newsst[2] = [{\n                type: 0,\n                data: write_varint49(1)\n              }];\n              newsst[3] = [{\n                type: 2,\n                data: stru8(str)\n              }];\n              sstdata[3].push({\n                type: 2,\n                data: write_shallow(newsst)\n              });\n            });\n          }\n          sstroot.messages[0].data = write_shallow(sstdata);\n          var sy = write_iwa_file(sx);\n          var raw32 = compress_iwa_file(sy);\n          sentry.content = raw32;\n          sentry.size = sentry.content.length;\n        })();\n        var tile = parse_shallow(store[3][0].data);\n        {\n          var t = tile[1][0];\n          delete tile[2];\n          var tl = parse_shallow(t.data);\n          {\n            var tileref = parse_TSP_Reference(tl[2][0].data);\n            (function () {\n              var tentry = CFB.find(cfb, dependents[tileref].location);\n              var tx = parse_iwa_file(decompress_iwa_file(tentry.content));\n              var tileroot;\n              for (var sxi = 0; sxi < tx.length; ++sxi) {\n                var packet2 = tx[sxi];\n                if (packet2.id == tileref) tileroot = packet2;\n              }\n              var tiledata = parse_shallow(tileroot.messages[0].data);\n              {\n                delete tiledata[6];\n                delete tile[7];\n                var rowload = new Uint8Array(tiledata[5][0].data);\n                tiledata[5] = [];\n                var cnt = 0;\n                for (var R2 = 0; R2 <= range.e.r; ++R2) {\n                  var tilerow = parse_shallow(rowload);\n                  cnt += write_tile_row(tilerow, data[R2], SST);\n                  tilerow[1][0].data = write_varint49(R2);\n                  tiledata[5].push({\n                    data: write_shallow(tilerow),\n                    type: 2\n                  });\n                }\n                tiledata[1] = [{\n                  type: 0,\n                  data: write_varint49(range.e.c + 1)\n                }];\n                tiledata[2] = [{\n                  type: 0,\n                  data: write_varint49(range.e.r + 1)\n                }];\n                tiledata[3] = [{\n                  type: 0,\n                  data: write_varint49(cnt)\n                }];\n                tiledata[4] = [{\n                  type: 0,\n                  data: write_varint49(range.e.r + 1)\n                }];\n              }\n              tileroot.messages[0].data = write_shallow(tiledata);\n              var ty = write_iwa_file(tx);\n              var raw32 = compress_iwa_file(ty);\n              tentry.content = raw32;\n              tentry.size = tentry.content.length;\n            })();\n          }\n          t.data = write_shallow(tl);\n        }\n        store[3][0].data = write_shallow(tile);\n      }\n      pb[4][0].data = write_shallow(store);\n    }\n    docroot.messages[0].data = write_shallow(pb);\n    var y = write_iwa_file(x);\n    var raw3 = compress_iwa_file(y);\n    entry.content = raw3;\n    entry.size = entry.content.length;\n    return cfb;\n  }\n  function fix_opts_func(defaults) {\n    return function fix_opts(opts) {\n      for (var i = 0; i != defaults.length; ++i) {\n        var d = defaults[i];\n        if (opts[d[0]] === undefined) opts[d[0]] = d[1];\n        if (d[2] === 'n') opts[d[0]] = Number(opts[d[0]]);\n      }\n    };\n  }\n  function fix_read_opts(opts) {\n    fix_opts_func([['cellNF', false], /* emit cell number format string as .z */\n    ['cellHTML', true], /* emit html string as .h */\n    ['cellFormula', true], /* emit formulae as .f */\n    ['cellStyles', false], /* emits style/theme as .s */\n    ['cellText', true], /* emit formatted text as .w */\n    ['cellDates', false], /* emit date cells with type `d` */\n\n    ['sheetStubs', false], /* emit empty cells */\n    ['sheetRows', 0, 'n'], /* read n rows (0 = read all rows) */\n\n    ['bookDeps', false], /* parse calculation chains */\n    ['bookSheets', false], /* only try to get sheet names (no Sheets) */\n    ['bookProps', false], /* only try to get properties (no Sheets) */\n    ['bookFiles', false], /* include raw file structure (keys, files, cfb) */\n    ['bookVBA', false], /* include vba raw data (vbaraw) */\n\n    ['password', ''], /* password */\n    ['WTF', false] /* WTF mode (throws errors) */])(opts);\n  }\n  function fix_write_opts(opts) {\n    fix_opts_func([['cellDates', false], /* write date cells with type `d` */\n\n    ['bookSST', false], /* Generate Shared String Table */\n\n    ['bookType', 'xlsx'], /* Type of workbook (xlsx/m/b) */\n\n    ['compression', false], /* Use file compression */\n\n    ['WTF', false] /* WTF mode (throws errors) */])(opts);\n  }\n  function get_sheet_type(n) {\n    if (RELS.WS.indexOf(n) > -1) return \"sheet\";\n    if (RELS.CS && n == RELS.CS) return \"chart\";\n    if (RELS.DS && n == RELS.DS) return \"dialog\";\n    if (RELS.MS && n == RELS.MS) return \"macro\";\n    return n && n.length ? n : \"sheet\";\n  }\n  function safe_parse_wbrels(wbrels, sheets) {\n    if (!wbrels) return 0;\n    try {\n      wbrels = sheets.map(function pwbr(w) {\n        if (!w.id) w.id = w.strRelID;\n        return [w.name, wbrels['!id'][w.id].Target, get_sheet_type(wbrels['!id'][w.id].Type)];\n      });\n    } catch (e) {\n      return null;\n    }\n    return !wbrels || wbrels.length === 0 ? null : wbrels;\n  }\n  function safe_parse_sheet(zip, path, relsPath, sheet, idx, sheetRels, sheets, stype, opts, wb, themes, styles) {\n    try {\n      sheetRels[sheet] = parse_rels(getzipstr(zip, relsPath, true), path);\n      var data = getzipdata(zip, path);\n      var _ws;\n      switch (stype) {\n        case 'sheet':\n          _ws = parse_ws(data, path, idx, opts, sheetRels[sheet], wb, themes, styles);\n          break;\n        case 'chart':\n          _ws = parse_cs(data, path, idx, opts, sheetRels[sheet], wb, themes, styles);\n          if (!_ws || !_ws['!drawel']) break;\n          var dfile = resolve_path(_ws['!drawel'].Target, path);\n          var drelsp = get_rels_path(dfile);\n          var draw = parse_drawing(getzipstr(zip, dfile, true), parse_rels(getzipstr(zip, drelsp, true), dfile));\n          var chartp = resolve_path(draw, dfile);\n          var crelsp = get_rels_path(chartp);\n          _ws = parse_chart(getzipstr(zip, chartp, true), chartp, opts, parse_rels(getzipstr(zip, crelsp, true), chartp), wb, _ws);\n          break;\n        case 'macro':\n          _ws = parse_ms(data, path, idx, opts, sheetRels[sheet], wb, themes, styles);\n          break;\n        case 'dialog':\n          _ws = parse_ds(data, path, idx, opts, sheetRels[sheet], wb, themes, styles);\n          break;\n        default:\n          throw new Error(\"Unrecognized sheet type \" + stype);\n      }\n      sheets[sheet] = _ws;\n\n      /* scan rels for comments and threaded comments */\n      var tcomments = [];\n      if (sheetRels && sheetRels[sheet]) keys(sheetRels[sheet]).forEach(function (n) {\n        var dfile = \"\";\n        if (sheetRels[sheet][n].Type == RELS.CMNT) {\n          dfile = resolve_path(sheetRels[sheet][n].Target, path);\n          var comments = parse_cmnt(getzipdata(zip, dfile, true), dfile, opts);\n          if (!comments || !comments.length) return;\n          sheet_insert_comments(_ws, comments, false);\n        }\n        if (sheetRels[sheet][n].Type == RELS.TCMNT) {\n          dfile = resolve_path(sheetRels[sheet][n].Target, path);\n          tcomments = tcomments.concat(parse_tcmnt_xml(getzipdata(zip, dfile, true), opts));\n        }\n      });\n      if (tcomments && tcomments.length) sheet_insert_comments(_ws, tcomments, true, opts.people || []);\n    } catch (e) {\n      if (opts.WTF) throw e;\n    }\n  }\n  function strip_front_slash(x) {\n    return x.charAt(0) == '/' ? x.slice(1) : x;\n  }\n  function parse_zip(zip, opts) {\n    make_ssf();\n    opts = opts || {};\n    fix_read_opts(opts);\n\n    /* OpenDocument Part 3 Section 2.2.1 OpenDocument Package */\n    if (safegetzipfile(zip, 'META-INF/manifest.xml')) return parse_ods(zip, opts);\n    /* UOC */\n    if (safegetzipfile(zip, 'objectdata.xml')) return parse_ods(zip, opts);\n    /* Numbers */\n    if (safegetzipfile(zip, 'Index/Document.iwa')) {\n      if (typeof Uint8Array == \"undefined\") throw new Error('NUMBERS file parsing requires Uint8Array support');\n      if (typeof parse_numbers_iwa != \"undefined\") {\n        if (zip.FileIndex) return parse_numbers_iwa(zip);\n        var _zip = CFB.utils.cfb_new();\n        zipentries(zip).forEach(function (e) {\n          zip_add_file(_zip, e, getzipbin(zip, e));\n        });\n        return parse_numbers_iwa(_zip);\n      }\n      throw new Error('Unsupported NUMBERS file');\n    }\n    if (!safegetzipfile(zip, '[Content_Types].xml')) {\n      if (safegetzipfile(zip, 'index.xml.gz')) throw new Error('Unsupported NUMBERS 08 file');\n      if (safegetzipfile(zip, 'index.xml')) throw new Error('Unsupported NUMBERS 09 file');\n      throw new Error('Unsupported ZIP file');\n    }\n    var entries = zipentries(zip);\n    var dir = parse_ct(getzipstr(zip, '[Content_Types].xml'));\n    var xlsb = false;\n    var sheets, binname;\n    if (dir.workbooks.length === 0) {\n      binname = \"xl/workbook.xml\";\n      if (getzipdata(zip, binname, true)) dir.workbooks.push(binname);\n    }\n    if (dir.workbooks.length === 0) {\n      binname = \"xl/workbook.bin\";\n      if (!getzipdata(zip, binname, true)) throw new Error(\"Could not find workbook\");\n      dir.workbooks.push(binname);\n      xlsb = true;\n    }\n    if (dir.workbooks[0].slice(-3) == \"bin\") xlsb = true;\n    var themes = {};\n    var styles = {};\n    if (!opts.bookSheets && !opts.bookProps) {\n      strs = [];\n      if (dir.sst) try {\n        strs = parse_sst(getzipdata(zip, strip_front_slash(dir.sst)), dir.sst, opts);\n      } catch (e) {\n        if (opts.WTF) throw e;\n      }\n      if (opts.cellStyles && dir.themes.length) themes = parse_theme(getzipstr(zip, dir.themes[0].replace(/^\\//, ''), true) || \"\", dir.themes[0], opts);\n      if (dir.style) styles = parse_sty(getzipdata(zip, strip_front_slash(dir.style)), dir.style, themes, opts);\n    }\n\n    /*var externbooks = */\n    dir.links.map(function (link) {\n      try {\n        var rels = parse_rels(getzipstr(zip, get_rels_path(strip_front_slash(link))), link);\n        return parse_xlink(getzipdata(zip, strip_front_slash(link)), rels, link, opts);\n      } catch (e) {}\n    });\n    var wb = parse_wb(getzipdata(zip, strip_front_slash(dir.workbooks[0])), dir.workbooks[0], opts);\n    var props = {},\n      propdata = \"\";\n    if (dir.coreprops.length) {\n      propdata = getzipdata(zip, strip_front_slash(dir.coreprops[0]), true);\n      if (propdata) props = parse_core_props(propdata);\n      if (dir.extprops.length !== 0) {\n        propdata = getzipdata(zip, strip_front_slash(dir.extprops[0]), true);\n        if (propdata) parse_ext_props(propdata, props, opts);\n      }\n    }\n    var custprops = {};\n    if (!opts.bookSheets || opts.bookProps) {\n      if (dir.custprops.length !== 0) {\n        propdata = getzipstr(zip, strip_front_slash(dir.custprops[0]), true);\n        if (propdata) custprops = parse_cust_props(propdata, opts);\n      }\n    }\n    var out = {};\n    if (opts.bookSheets || opts.bookProps) {\n      if (wb.Sheets) sheets = wb.Sheets.map(function pluck(x) {\n        return x.name;\n      });else if (props.Worksheets && props.SheetNames.length > 0) sheets = props.SheetNames;\n      if (opts.bookProps) {\n        out.Props = props;\n        out.Custprops = custprops;\n      }\n      if (opts.bookSheets && typeof sheets !== 'undefined') out.SheetNames = sheets;\n      if (opts.bookSheets ? out.SheetNames : opts.bookProps) return out;\n    }\n    sheets = {};\n    var deps = {};\n    if (opts.bookDeps && dir.calcchain) deps = parse_cc(getzipdata(zip, strip_front_slash(dir.calcchain)), dir.calcchain, opts);\n    var i = 0;\n    var sheetRels = {};\n    var path, relsPath;\n    {\n      var wbsheets = wb.Sheets;\n      props.Worksheets = wbsheets.length;\n      props.SheetNames = [];\n      for (var j = 0; j != wbsheets.length; ++j) {\n        props.SheetNames[j] = wbsheets[j].name;\n      }\n    }\n    var wbext = xlsb ? \"bin\" : \"xml\";\n    var wbrelsi = dir.workbooks[0].lastIndexOf(\"/\");\n    var wbrelsfile = (dir.workbooks[0].slice(0, wbrelsi + 1) + \"_rels/\" + dir.workbooks[0].slice(wbrelsi + 1) + \".rels\").replace(/^\\//, \"\");\n    if (!safegetzipfile(zip, wbrelsfile)) wbrelsfile = 'xl/_rels/workbook.' + wbext + '.rels';\n    var wbrels = parse_rels(getzipstr(zip, wbrelsfile, true), wbrelsfile.replace(/_rels.*/, \"s5s\"));\n    if ((dir.metadata || []).length >= 1) {\n      /* TODO: MDX and other types of metadata */\n      opts.xlmeta = parse_xlmeta(getzipdata(zip, strip_front_slash(dir.metadata[0])), dir.metadata[0], opts);\n    }\n    if ((dir.people || []).length >= 1) {\n      opts.people = parse_people_xml(getzipdata(zip, strip_front_slash(dir.people[0])), opts);\n    }\n    if (wbrels) wbrels = safe_parse_wbrels(wbrels, wb.Sheets);\n\n    /* Numbers iOS hack */\n    var nmode = getzipdata(zip, \"xl/worksheets/sheet.xml\", true) ? 1 : 0;\n    wsloop: for (i = 0; i != props.Worksheets; ++i) {\n      var stype = \"sheet\";\n      if (wbrels && wbrels[i]) {\n        path = 'xl/' + wbrels[i][1].replace(/[\\/]?xl\\//, \"\");\n        if (!safegetzipfile(zip, path)) path = wbrels[i][1];\n        if (!safegetzipfile(zip, path)) path = wbrelsfile.replace(/_rels\\/.*$/, \"\") + wbrels[i][1];\n        stype = wbrels[i][2];\n      } else {\n        path = 'xl/worksheets/sheet' + (i + 1 - nmode) + \".\" + wbext;\n        path = path.replace(/sheet0\\./, \"sheet.\");\n      }\n      relsPath = path.replace(/^(.*)(\\/)([^\\/]*)$/, \"$1/_rels/$3.rels\");\n      if (opts && opts.sheets != null) switch (typeof opts.sheets) {\n        case \"number\":\n          if (i != opts.sheets) continue wsloop;\n          break;\n        case \"string\":\n          if (props.SheetNames[i].toLowerCase() != opts.sheets.toLowerCase()) continue wsloop;\n          break;\n        default:\n          if (Array.isArray && Array.isArray(opts.sheets)) {\n            var snjseen = false;\n            for (var snj = 0; snj != opts.sheets.length; ++snj) {\n              if (typeof opts.sheets[snj] == \"number\" && opts.sheets[snj] == i) snjseen = 1;\n              if (typeof opts.sheets[snj] == \"string\" && opts.sheets[snj].toLowerCase() == props.SheetNames[i].toLowerCase()) snjseen = 1;\n            }\n            if (!snjseen) continue wsloop;\n          }\n      }\n      safe_parse_sheet(zip, path, relsPath, props.SheetNames[i], i, sheetRels, sheets, stype, opts, wb, themes, styles);\n    }\n    out = {\n      Directory: dir,\n      Workbook: wb,\n      Props: props,\n      Custprops: custprops,\n      Deps: deps,\n      Sheets: sheets,\n      SheetNames: props.SheetNames,\n      Strings: strs,\n      Styles: styles,\n      Themes: themes,\n      SSF: dup(table_fmt)\n    };\n    if (opts && opts.bookFiles) {\n      if (zip.files) {\n        out.keys = entries;\n        out.files = zip.files;\n      } else {\n        out.keys = [];\n        out.files = {};\n        zip.FullPaths.forEach(function (p, idx) {\n          p = p.replace(/^Root Entry[\\/]/, \"\");\n          out.keys.push(p);\n          out.files[p] = zip.FileIndex[idx];\n        });\n      }\n    }\n    if (opts && opts.bookVBA) {\n      if (dir.vba.length > 0) out.vbaraw = getzipdata(zip, strip_front_slash(dir.vba[0]), true);else if (dir.defaults && dir.defaults.bin === CT_VBA) out.vbaraw = getzipdata(zip, 'xl/vbaProject.bin', true);\n    }\n    return out;\n  }\n\n  /* [MS-OFFCRYPTO] 2.1.1 */\n  function parse_xlsxcfb(cfb, _opts) {\n    var opts = _opts || {};\n    var f = 'Workbook',\n      data = CFB.find(cfb, f);\n    try {\n      f = '/!DataSpaces/Version';\n      data = CFB.find(cfb, f);\n      if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n      /*var version = */\n      parse_DataSpaceVersionInfo(data.content);\n\n      /* 2.3.4.1 */\n      f = '/!DataSpaces/DataSpaceMap';\n      data = CFB.find(cfb, f);\n      if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n      var dsm = parse_DataSpaceMap(data.content);\n      if (dsm.length !== 1 || dsm[0].comps.length !== 1 || dsm[0].comps[0].t !== 0 || dsm[0].name !== \"StrongEncryptionDataSpace\" || dsm[0].comps[0].v !== \"EncryptedPackage\") throw new Error(\"ECMA-376 Encrypted file bad \" + f);\n\n      /* 2.3.4.2 */\n      f = '/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace';\n      data = CFB.find(cfb, f);\n      if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n      var seds = parse_DataSpaceDefinition(data.content);\n      if (seds.length != 1 || seds[0] != \"StrongEncryptionTransform\") throw new Error(\"ECMA-376 Encrypted file bad \" + f);\n\n      /* 2.3.4.3 */\n      f = '/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary';\n      data = CFB.find(cfb, f);\n      if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n      /*var hdr = */\n      parse_Primary(data.content);\n    } catch (e) {}\n    f = '/EncryptionInfo';\n    data = CFB.find(cfb, f);\n    if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n    var einfo = parse_EncryptionInfo(data.content);\n\n    /* 2.3.4.4 */\n    f = '/EncryptedPackage';\n    data = CFB.find(cfb, f);\n    if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\n    /*global decrypt_agile */\n    if (einfo[0] == 0x04 && typeof decrypt_agile !== 'undefined') return decrypt_agile(einfo[1], data.content, opts.password || \"\", opts);\n    /*global decrypt_std76 */\n    if (einfo[0] == 0x02 && typeof decrypt_std76 !== 'undefined') return decrypt_std76(einfo[1], data.content, opts.password || \"\", opts);\n    throw new Error(\"File is password-protected\");\n  }\n  function write_zip(wb, opts) {\n    if (opts.bookType == \"ods\") return write_ods(wb, opts);\n    if (opts.bookType == \"numbers\") return write_numbers_iwa(wb, opts);\n    if (opts.bookType == \"xlsb\") return write_zip_xlsxb(wb, opts);\n    return write_zip_xlsx(wb, opts);\n  }\n\n  /* XLSX and XLSB writing are very similar.  Originally they were unified in one\n     export function.  This is horrible for tree shaking in the common case (most\n     applications need to export files in one format) so this function supports\n     both formats while write_zip_xlsx only handles XLSX */\n  function write_zip_xlsxb(wb, opts) {\n    _shapeid = 1024;\n    if (wb && !wb.SSF) {\n      wb.SSF = dup(table_fmt);\n    }\n    if (wb && wb.SSF) {\n      make_ssf();\n      SSF_load_table(wb.SSF);\n      // $FlowIgnore\n      opts.revssf = evert_num(wb.SSF);\n      opts.revssf[wb.SSF[65535]] = 0;\n      opts.ssf = wb.SSF;\n    }\n    opts.rels = {};\n    opts.wbrels = {};\n    opts.Strings = [];\n    opts.Strings.Count = 0;\n    opts.Strings.Unique = 0;\n    if (browser_has_Map) opts.revStrings = new Map();else {\n      opts.revStrings = {};\n      opts.revStrings.foo = [];\n      delete opts.revStrings.foo;\n    }\n    var wbext = opts.bookType == \"xlsb\" ? \"bin\" : \"xml\";\n    var vbafmt = VBAFMTS.indexOf(opts.bookType) > -1;\n    var ct = new_ct();\n    fix_write_opts(opts = opts || {});\n    var zip = zip_new();\n    var f = \"\",\n      rId = 0;\n    opts.cellXfs = [];\n    get_cell_style(opts.cellXfs, {}, {\n      revssf: {\n        \"General\": 0\n      }\n    });\n    if (!wb.Props) wb.Props = {};\n    f = \"docProps/core.xml\";\n    zip_add_file(zip, f, write_core_props(wb.Props, opts));\n    ct.coreprops.push(f);\n    add_rels(opts.rels, 2, f, RELS.CORE_PROPS);\n    f = \"docProps/app.xml\";\n    if (wb.Props && wb.Props.SheetNames) {/* empty */} else if (!wb.Workbook || !wb.Workbook.Sheets) wb.Props.SheetNames = wb.SheetNames;else {\n      var _sn = [];\n      for (var _i = 0; _i < wb.SheetNames.length; ++_i) if ((wb.Workbook.Sheets[_i] || {}).Hidden != 2) _sn.push(wb.SheetNames[_i]);\n      wb.Props.SheetNames = _sn;\n    }\n    wb.Props.Worksheets = wb.Props.SheetNames.length;\n    zip_add_file(zip, f, write_ext_props(wb.Props, opts));\n    ct.extprops.push(f);\n    add_rels(opts.rels, 3, f, RELS.EXT_PROPS);\n    if (wb.Custprops !== wb.Props && keys(wb.Custprops || {}).length > 0) {\n      f = \"docProps/custom.xml\";\n      zip_add_file(zip, f, write_cust_props(wb.Custprops, opts));\n      ct.custprops.push(f);\n      add_rels(opts.rels, 4, f, RELS.CUST_PROPS);\n    }\n    for (rId = 1; rId <= wb.SheetNames.length; ++rId) {\n      var wsrels = {\n        '!id': {}\n      };\n      var ws = wb.Sheets[wb.SheetNames[rId - 1]];\n      var _type = (ws || {})[\"!type\"] || \"sheet\";\n      switch (_type) {\n        case \"chart\":\n        /* falls through */\n        default:\n          f = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\n          zip_add_file(zip, f, write_ws(rId - 1, f, opts, wb, wsrels));\n          ct.sheets.push(f);\n          add_rels(opts.wbrels, -1, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS[0]);\n      }\n      if (ws) {\n        var comments = ws['!comments'];\n        var need_vml = false;\n        var cf = \"\";\n        if (comments && comments.length > 0) {\n          cf = \"xl/comments\" + rId + \".\" + wbext;\n          zip_add_file(zip, cf, write_cmnt(comments, cf, opts));\n          ct.comments.push(cf);\n          add_rels(wsrels, -1, \"../comments\" + rId + \".\" + wbext, RELS.CMNT);\n          need_vml = true;\n        }\n        if (ws['!legacy']) {\n          if (need_vml) zip_add_file(zip, \"xl/drawings/vmlDrawing\" + rId + \".vml\", write_comments_vml(rId, ws['!comments']));\n        }\n        delete ws['!comments'];\n        delete ws['!legacy'];\n      }\n      if (wsrels['!id'].rId1) zip_add_file(zip, get_rels_path(f), write_rels(wsrels));\n    }\n    if (opts.Strings != null && opts.Strings.length > 0) {\n      f = \"xl/sharedStrings.\" + wbext;\n      zip_add_file(zip, f, write_sst(opts.Strings, f, opts));\n      ct.strs.push(f);\n      add_rels(opts.wbrels, -1, \"sharedStrings.\" + wbext, RELS.SST);\n    }\n    f = \"xl/workbook.\" + wbext;\n    zip_add_file(zip, f, write_wb(wb, f, opts));\n    ct.workbooks.push(f);\n    add_rels(opts.rels, 1, f, RELS.WB);\n\n    /* TODO: something more intelligent with themes */\n\n    f = \"xl/theme/theme1.xml\";\n    zip_add_file(zip, f, write_theme(wb.Themes, opts));\n    ct.themes.push(f);\n    add_rels(opts.wbrels, -1, \"theme/theme1.xml\", RELS.THEME);\n\n    /* TODO: something more intelligent with styles */\n\n    f = \"xl/styles.\" + wbext;\n    zip_add_file(zip, f, write_sty(wb, f, opts));\n    ct.styles.push(f);\n    add_rels(opts.wbrels, -1, \"styles.\" + wbext, RELS.STY);\n    if (wb.vbaraw && vbafmt) {\n      f = \"xl/vbaProject.bin\";\n      zip_add_file(zip, f, wb.vbaraw);\n      ct.vba.push(f);\n      add_rels(opts.wbrels, -1, \"vbaProject.bin\", RELS.VBA);\n    }\n    f = \"xl/metadata.\" + wbext;\n    zip_add_file(zip, f, write_xlmeta(f));\n    ct.metadata.push(f);\n    add_rels(opts.wbrels, -1, \"metadata.\" + wbext, RELS.XLMETA);\n    zip_add_file(zip, \"[Content_Types].xml\", write_ct(ct, opts));\n    zip_add_file(zip, '_rels/.rels', write_rels(opts.rels));\n    zip_add_file(zip, 'xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\n    delete opts.revssf;\n    delete opts.ssf;\n    return zip;\n  }\n  function write_zip_xlsx(wb, opts) {\n    _shapeid = 1024;\n    if (wb && !wb.SSF) {\n      wb.SSF = dup(table_fmt);\n    }\n    if (wb && wb.SSF) {\n      make_ssf();\n      SSF_load_table(wb.SSF);\n      // $FlowIgnore\n      opts.revssf = evert_num(wb.SSF);\n      opts.revssf[wb.SSF[65535]] = 0;\n      opts.ssf = wb.SSF;\n    }\n    opts.rels = {};\n    opts.wbrels = {};\n    opts.Strings = [];\n    opts.Strings.Count = 0;\n    opts.Strings.Unique = 0;\n    if (browser_has_Map) opts.revStrings = new Map();else {\n      opts.revStrings = {};\n      opts.revStrings.foo = [];\n      delete opts.revStrings.foo;\n    }\n    var wbext = \"xml\";\n    var vbafmt = VBAFMTS.indexOf(opts.bookType) > -1;\n    var ct = new_ct();\n    fix_write_opts(opts = opts || {});\n    var zip = zip_new();\n    var f = \"\",\n      rId = 0;\n    opts.cellXfs = [];\n    get_cell_style(opts.cellXfs, {}, {\n      revssf: {\n        \"General\": 0\n      }\n    });\n    if (!wb.Props) wb.Props = {};\n    f = \"docProps/core.xml\";\n    zip_add_file(zip, f, write_core_props(wb.Props, opts));\n    ct.coreprops.push(f);\n    add_rels(opts.rels, 2, f, RELS.CORE_PROPS);\n    f = \"docProps/app.xml\";\n    if (wb.Props && wb.Props.SheetNames) {/* empty */} else if (!wb.Workbook || !wb.Workbook.Sheets) wb.Props.SheetNames = wb.SheetNames;else {\n      var _sn = [];\n      for (var _i = 0; _i < wb.SheetNames.length; ++_i) if ((wb.Workbook.Sheets[_i] || {}).Hidden != 2) _sn.push(wb.SheetNames[_i]);\n      wb.Props.SheetNames = _sn;\n    }\n    wb.Props.Worksheets = wb.Props.SheetNames.length;\n    zip_add_file(zip, f, write_ext_props(wb.Props, opts));\n    ct.extprops.push(f);\n    add_rels(opts.rels, 3, f, RELS.EXT_PROPS);\n    if (wb.Custprops !== wb.Props && keys(wb.Custprops || {}).length > 0) {\n      f = \"docProps/custom.xml\";\n      zip_add_file(zip, f, write_cust_props(wb.Custprops, opts));\n      ct.custprops.push(f);\n      add_rels(opts.rels, 4, f, RELS.CUST_PROPS);\n    }\n    var people = [\"SheetJ5\"];\n    opts.tcid = 0;\n    for (rId = 1; rId <= wb.SheetNames.length; ++rId) {\n      var wsrels = {\n        '!id': {}\n      };\n      var ws = wb.Sheets[wb.SheetNames[rId - 1]];\n      var _type = (ws || {})[\"!type\"] || \"sheet\";\n      switch (_type) {\n        case \"chart\":\n        /* falls through */\n        default:\n          f = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\n          zip_add_file(zip, f, write_ws_xml(rId - 1, opts, wb, wsrels));\n          ct.sheets.push(f);\n          add_rels(opts.wbrels, -1, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS[0]);\n      }\n      if (ws) {\n        var comments = ws['!comments'];\n        var need_vml = false;\n        var cf = \"\";\n        if (comments && comments.length > 0) {\n          var needtc = false;\n          comments.forEach(function (carr) {\n            carr[1].forEach(function (c) {\n              if (c.T == true) needtc = true;\n            });\n          });\n          if (needtc) {\n            cf = \"xl/threadedComments/threadedComment\" + rId + \".\" + wbext;\n            zip_add_file(zip, cf, write_tcmnt_xml(comments, people, opts));\n            ct.threadedcomments.push(cf);\n            add_rels(wsrels, -1, \"../threadedComments/threadedComment\" + rId + \".\" + wbext, RELS.TCMNT);\n          }\n          cf = \"xl/comments\" + rId + \".\" + wbext;\n          zip_add_file(zip, cf, write_comments_xml(comments, opts));\n          ct.comments.push(cf);\n          add_rels(wsrels, -1, \"../comments\" + rId + \".\" + wbext, RELS.CMNT);\n          need_vml = true;\n        }\n        if (ws['!legacy']) {\n          if (need_vml) zip_add_file(zip, \"xl/drawings/vmlDrawing\" + rId + \".vml\", write_comments_vml(rId, ws['!comments']));\n        }\n        delete ws['!comments'];\n        delete ws['!legacy'];\n      }\n      if (wsrels['!id'].rId1) zip_add_file(zip, get_rels_path(f), write_rels(wsrels));\n    }\n    if (opts.Strings != null && opts.Strings.length > 0) {\n      f = \"xl/sharedStrings.\" + wbext;\n      zip_add_file(zip, f, write_sst_xml(opts.Strings, opts));\n      ct.strs.push(f);\n      add_rels(opts.wbrels, -1, \"sharedStrings.\" + wbext, RELS.SST);\n    }\n    f = \"xl/workbook.\" + wbext;\n    zip_add_file(zip, f, write_wb_xml(wb, opts));\n    ct.workbooks.push(f);\n    add_rels(opts.rels, 1, f, RELS.WB);\n\n    /* TODO: something more intelligent with themes */\n\n    f = \"xl/theme/theme1.xml\";\n    zip_add_file(zip, f, write_theme(wb.Themes, opts));\n    ct.themes.push(f);\n    add_rels(opts.wbrels, -1, \"theme/theme1.xml\", RELS.THEME);\n\n    /* TODO: something more intelligent with styles */\n\n    f = \"xl/styles.\" + wbext;\n    zip_add_file(zip, f, write_sty_xml(wb, opts));\n    ct.styles.push(f);\n    add_rels(opts.wbrels, -1, \"styles.\" + wbext, RELS.STY);\n    if (wb.vbaraw && vbafmt) {\n      f = \"xl/vbaProject.bin\";\n      zip_add_file(zip, f, wb.vbaraw);\n      ct.vba.push(f);\n      add_rels(opts.wbrels, -1, \"vbaProject.bin\", RELS.VBA);\n    }\n    f = \"xl/metadata.\" + wbext;\n    zip_add_file(zip, f, write_xlmeta_xml());\n    ct.metadata.push(f);\n    add_rels(opts.wbrels, -1, \"metadata.\" + wbext, RELS.XLMETA);\n    if (people.length > 1) {\n      f = \"xl/persons/person.xml\";\n      zip_add_file(zip, f, write_people_xml(people, opts));\n      ct.people.push(f);\n      add_rels(opts.wbrels, -1, \"persons/person.xml\", RELS.PEOPLE);\n    }\n    zip_add_file(zip, \"[Content_Types].xml\", write_ct(ct, opts));\n    zip_add_file(zip, '_rels/.rels', write_rels(opts.rels));\n    zip_add_file(zip, 'xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\n    delete opts.revssf;\n    delete opts.ssf;\n    return zip;\n  }\n  function firstbyte(f, o) {\n    var x = \"\";\n    switch ((o || {}).type || \"base64\") {\n      case 'buffer':\n        return [f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7]];\n      case 'base64':\n        x = Base64_decode(f.slice(0, 12));\n        break;\n      case 'binary':\n        x = f;\n        break;\n      case 'array':\n        return [f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7]];\n      default:\n        throw new Error(\"Unrecognized type \" + (o && o.type || \"undefined\"));\n    }\n    return [x.charCodeAt(0), x.charCodeAt(1), x.charCodeAt(2), x.charCodeAt(3), x.charCodeAt(4), x.charCodeAt(5), x.charCodeAt(6), x.charCodeAt(7)];\n  }\n  function read_cfb(cfb, opts) {\n    if (CFB.find(cfb, \"EncryptedPackage\")) return parse_xlsxcfb(cfb, opts);\n    return parse_xlscfb(cfb, opts);\n  }\n  function read_zip(data, opts) {\n    var zip,\n      d = data;\n    var o = opts || {};\n    if (!o.type) o.type = has_buf && Buffer.isBuffer(data) ? \"buffer\" : \"base64\";\n    zip = zip_read(d, o);\n    return parse_zip(zip, o);\n  }\n  function read_plaintext(data, o) {\n    var i = 0;\n    main: while (i < data.length) switch (data.charCodeAt(i)) {\n      case 0x0A:\n      case 0x0D:\n      case 0x20:\n        ++i;\n        break;\n      case 0x3C:\n        return parse_xlml(data.slice(i), o);\n      default:\n        break main;\n    }\n    return PRN.to_workbook(data, o);\n  }\n  function read_plaintext_raw(data, o) {\n    var str = \"\",\n      bytes = firstbyte(data, o);\n    switch (o.type) {\n      case 'base64':\n        str = Base64_decode(data);\n        break;\n      case 'binary':\n        str = data;\n        break;\n      case 'buffer':\n        str = data.toString('binary');\n        break;\n      case 'array':\n        str = cc2str(data);\n        break;\n      default:\n        throw new Error(\"Unrecognized type \" + o.type);\n    }\n    if (bytes[0] == 0xEF && bytes[1] == 0xBB && bytes[2] == 0xBF) str = utf8read(str);\n    o.type = \"binary\";\n    return read_plaintext(str, o);\n  }\n  function read_utf16(data, o) {\n    var d = data;\n    if (o.type == 'base64') d = Base64_decode(d);\n    d = $cptable.utils.decode(1200, d.slice(2), 'str');\n    o.type = \"binary\";\n    return read_plaintext(d, o);\n  }\n  function bstrify(data) {\n    return !data.match(/[^\\x00-\\x7F]/) ? data : utf8write(data);\n  }\n  function read_prn(data, d, o, str) {\n    if (str) {\n      o.type = \"string\";\n      return PRN.to_workbook(data, o);\n    }\n    return PRN.to_workbook(d, o);\n  }\n  function readSync(data, opts) {\n    reset_cp();\n    var o = opts || {};\n    if (typeof ArrayBuffer !== 'undefined' && data instanceof ArrayBuffer) return readSync(new Uint8Array(data), (o = dup(o), o.type = \"array\", o));\n    if (typeof Uint8Array !== 'undefined' && data instanceof Uint8Array && !o.type) o.type = typeof Deno !== \"undefined\" ? \"buffer\" : \"array\";\n    var d = data,\n      n = [0, 0, 0, 0],\n      str = false;\n    if (o.cellStyles) {\n      o.cellNF = true;\n      o.sheetStubs = true;\n    }\n    _ssfopts = {};\n    if (o.dateNF) _ssfopts.dateNF = o.dateNF;\n    if (!o.type) o.type = has_buf && Buffer.isBuffer(data) ? \"buffer\" : \"base64\";\n    if (o.type == \"file\") {\n      o.type = has_buf ? \"buffer\" : \"binary\";\n      d = read_binary(data);\n      if (typeof Uint8Array !== 'undefined' && !has_buf) o.type = \"array\";\n    }\n    if (o.type == \"string\") {\n      str = true;\n      o.type = \"binary\";\n      o.codepage = 65001;\n      d = bstrify(data);\n    }\n    if (o.type == 'array' && typeof Uint8Array !== 'undefined' && data instanceof Uint8Array && typeof ArrayBuffer !== 'undefined') {\n      // $FlowIgnore\n      var ab = new ArrayBuffer(3),\n        vu = new Uint8Array(ab);\n      vu.foo = \"bar\";\n      // $FlowIgnore\n      if (!vu.foo) {\n        o = dup(o);\n        o.type = 'array';\n        return readSync(ab2a(d), o);\n      }\n    }\n    switch ((n = firstbyte(d, o))[0]) {\n      case 0xD0:\n        if (n[1] === 0xCF && n[2] === 0x11 && n[3] === 0xE0 && n[4] === 0xA1 && n[5] === 0xB1 && n[6] === 0x1A && n[7] === 0xE1) return read_cfb(CFB.read(d, o), o);\n        break;\n      case 0x09:\n        if (n[1] <= 0x08) return parse_xlscfb(d, o);\n        break;\n      case 0x3C:\n        return parse_xlml(d, o);\n      case 0x49:\n        if (n[1] === 0x49 && n[2] === 0x2a && n[3] === 0x00) throw new Error(\"TIFF Image File is not a spreadsheet\");\n        if (n[1] === 0x44) return read_wb_ID(d, o);\n        break;\n      case 0x54:\n        if (n[1] === 0x41 && n[2] === 0x42 && n[3] === 0x4C) return DIF.to_workbook(d, o);\n        break;\n      case 0x50:\n        return n[1] === 0x4B && n[2] < 0x09 && n[3] < 0x09 ? read_zip(d, o) : read_prn(data, d, o, str);\n      case 0xEF:\n        return n[3] === 0x3C ? parse_xlml(d, o) : read_prn(data, d, o, str);\n      case 0xFF:\n        if (n[1] === 0xFE) {\n          return read_utf16(d, o);\n        } else if (n[1] === 0x00 && n[2] === 0x02 && n[3] === 0x00) return WK_.to_workbook(d, o);\n        break;\n      case 0x00:\n        if (n[1] === 0x00) {\n          if (n[2] >= 0x02 && n[3] === 0x00) return WK_.to_workbook(d, o);\n          if (n[2] === 0x00 && (n[3] === 0x08 || n[3] === 0x09)) return WK_.to_workbook(d, o);\n        }\n        break;\n      case 0x03:\n      case 0x83:\n      case 0x8B:\n      case 0x8C:\n        return DBF.to_workbook(d, o);\n      case 0x7B:\n        if (n[1] === 0x5C && n[2] === 0x72 && n[3] === 0x74) return RTF.to_workbook(d, o);\n        break;\n      case 0x0A:\n      case 0x0D:\n      case 0x20:\n        return read_plaintext_raw(d, o);\n      case 0x89:\n        if (n[1] === 0x50 && n[2] === 0x4E && n[3] === 0x47) throw new Error(\"PNG Image File is not a spreadsheet\");\n        break;\n    }\n    if (DBF_SUPPORTED_VERSIONS.indexOf(n[0]) > -1 && n[2] <= 12 && n[3] <= 31) return DBF.to_workbook(d, o);\n    return read_prn(data, d, o, str);\n  }\n  function readFileSync(filename, opts) {\n    var o = opts || {};\n    o.type = 'file';\n    return readSync(filename, o);\n  }\n  function write_cfb_ctr(cfb, o) {\n    switch (o.type) {\n      case \"base64\":\n      case \"binary\":\n        break;\n      case \"buffer\":\n      case \"array\":\n        o.type = \"\";\n        break;\n      case \"file\":\n        return write_dl(o.file, CFB.write(cfb, {\n          type: has_buf ? 'buffer' : \"\"\n        }));\n      case \"string\":\n        throw new Error(\"'string' output type invalid for '\" + o.bookType + \"' files\");\n      default:\n        throw new Error(\"Unrecognized type \" + o.type);\n    }\n    return CFB.write(cfb, o);\n  }\n  function write_zip_type(wb, opts) {\n    var o = dup(opts || {});\n    var z = write_zip(wb, o);\n    return write_zip_denouement(z, o);\n  }\n  function write_zip_typeXLSX(wb, opts) {\n    var o = dup(opts || {});\n    var z = write_zip_xlsx(wb, o);\n    return write_zip_denouement(z, o);\n  }\n  function write_zip_denouement(z, o) {\n    var oopts = {};\n    var ftype = has_buf ? \"nodebuffer\" : typeof Uint8Array !== \"undefined\" ? \"array\" : \"string\";\n    if (o.compression) oopts.compression = 'DEFLATE';\n    if (o.password) oopts.type = ftype;else switch (o.type) {\n      case \"base64\":\n        oopts.type = \"base64\";\n        break;\n      case \"binary\":\n        oopts.type = \"string\";\n        break;\n      case \"string\":\n        throw new Error(\"'string' output type invalid for '\" + o.bookType + \"' files\");\n      case \"buffer\":\n      case \"file\":\n        oopts.type = ftype;\n        break;\n      default:\n        throw new Error(\"Unrecognized type \" + o.type);\n    }\n    var out = z.FullPaths ? CFB.write(z, {\n      fileType: \"zip\",\n      type: {\n        \"nodebuffer\": \"buffer\",\n        \"string\": \"binary\"\n      }[oopts.type] || oopts.type,\n      compression: !!o.compression\n    }) : z.generate(oopts);\n    if (typeof Deno !== \"undefined\") {\n      if (typeof out == \"string\") {\n        if (o.type == \"binary\" || o.type == \"base64\") return out;\n        out = new Uint8Array(s2ab(out));\n      }\n    }\n    /*jshint -W083 */\n    if (o.password && typeof encrypt_agile !== 'undefined') return write_cfb_ctr(encrypt_agile(out, o.password), o); // eslint-disable-line no-undef\n    /*jshint +W083 */\n    if (o.type === \"file\") return write_dl(o.file, out);\n    return o.type == \"string\" ? utf8read(out) : out;\n  }\n  function write_cfb_type(wb, opts) {\n    var o = opts || {};\n    var cfb = write_xlscfb(wb, o);\n    return write_cfb_ctr(cfb, o);\n  }\n  function write_string_type(out, opts, bom) {\n    if (!bom) bom = \"\";\n    var o = bom + out;\n    switch (opts.type) {\n      case \"base64\":\n        return Base64_encode(utf8write(o));\n      case \"binary\":\n        return utf8write(o);\n      case \"string\":\n        return out;\n      case \"file\":\n        return write_dl(opts.file, o, 'utf8');\n      case \"buffer\":\n        {\n          if (has_buf) return Buffer_from(o, 'utf8');else if (typeof TextEncoder !== \"undefined\") return new TextEncoder().encode(o);else return write_string_type(o, {\n            type: 'binary'\n          }).split(\"\").map(function (c) {\n            return c.charCodeAt(0);\n          });\n        }\n    }\n    throw new Error(\"Unrecognized type \" + opts.type);\n  }\n  function write_stxt_type(out, opts) {\n    switch (opts.type) {\n      case \"base64\":\n        return Base64_encode(out);\n      case \"binary\":\n        return out;\n      case \"string\":\n        return out;\n      /* override in sheet_to_txt */\n      case \"file\":\n        return write_dl(opts.file, out, 'binary');\n      case \"buffer\":\n        {\n          if (has_buf) return Buffer_from(out, 'binary');else return out.split(\"\").map(function (c) {\n            return c.charCodeAt(0);\n          });\n        }\n    }\n    throw new Error(\"Unrecognized type \" + opts.type);\n  }\n\n  /* TODO: test consistency */\n  function write_binary_type(out, opts) {\n    switch (opts.type) {\n      case \"string\":\n      case \"base64\":\n      case \"binary\":\n        var bstr = \"\";\n        // $FlowIgnore\n        for (var i = 0; i < out.length; ++i) bstr += String.fromCharCode(out[i]);\n        return opts.type == 'base64' ? Base64_encode(bstr) : opts.type == 'string' ? utf8read(bstr) : bstr;\n      case \"file\":\n        return write_dl(opts.file, out);\n      case \"buffer\":\n        return out;\n      default:\n        throw new Error(\"Unrecognized type \" + opts.type);\n    }\n  }\n  function writeSyncXLSX(wb, opts) {\n    reset_cp();\n    check_wb(wb);\n    var o = dup(opts || {});\n    if (o.cellStyles) {\n      o.cellNF = true;\n      o.sheetStubs = true;\n    }\n    if (o.type == \"array\") {\n      o.type = \"binary\";\n      var out = writeSyncXLSX(wb, o);\n      o.type = \"array\";\n      return s2ab(out);\n    }\n    return write_zip_typeXLSX(wb, o);\n  }\n  function writeSync(wb, opts) {\n    reset_cp();\n    check_wb(wb);\n    var o = dup(opts || {});\n    if (o.cellStyles) {\n      o.cellNF = true;\n      o.sheetStubs = true;\n    }\n    if (o.type == \"array\") {\n      o.type = \"binary\";\n      var out = writeSync(wb, o);\n      o.type = \"array\";\n      return s2ab(out);\n    }\n    var idx = 0;\n    if (o.sheet) {\n      if (typeof o.sheet == \"number\") idx = o.sheet;else idx = wb.SheetNames.indexOf(o.sheet);\n      if (!wb.SheetNames[idx]) throw new Error(\"Sheet not found: \" + o.sheet + \" : \" + typeof o.sheet);\n    }\n    switch (o.bookType || 'xlsb') {\n      case 'xml':\n      case 'xlml':\n        return write_string_type(write_xlml(wb, o), o);\n      case 'slk':\n      case 'sylk':\n        return write_string_type(SYLK.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n      case 'htm':\n      case 'html':\n        return write_string_type(sheet_to_html(wb.Sheets[wb.SheetNames[idx]], o), o);\n      case 'txt':\n        return write_stxt_type(sheet_to_txt(wb.Sheets[wb.SheetNames[idx]], o), o);\n      case 'csv':\n        return write_string_type(sheet_to_csv(wb.Sheets[wb.SheetNames[idx]], o), o, \"\\ufeff\");\n      case 'dif':\n        return write_string_type(DIF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n      case 'dbf':\n        return write_binary_type(DBF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n      case 'prn':\n        return write_string_type(PRN.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n      case 'rtf':\n        return write_string_type(RTF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n      case 'eth':\n        return write_string_type(ETH.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n      case 'fods':\n        return write_string_type(write_ods(wb, o), o);\n      case 'wk1':\n        return write_binary_type(WK_.sheet_to_wk1(wb.Sheets[wb.SheetNames[idx]], o), o);\n      case 'wk3':\n        return write_binary_type(WK_.book_to_wk3(wb, o), o);\n      case 'biff2':\n        if (!o.biff) o.biff = 2;\n      /* falls through */\n      case 'biff3':\n        if (!o.biff) o.biff = 3;\n      /* falls through */\n      case 'biff4':\n        if (!o.biff) o.biff = 4;\n        return write_binary_type(write_biff_buf(wb, o), o);\n      case 'biff5':\n        if (!o.biff) o.biff = 5;\n      /* falls through */\n      case 'biff8':\n      case 'xla':\n      case 'xls':\n        if (!o.biff) o.biff = 8;\n        return write_cfb_type(wb, o);\n      case 'xlsx':\n      case 'xlsm':\n      case 'xlam':\n      case 'xlsb':\n      case 'numbers':\n      case 'ods':\n        return write_zip_type(wb, o);\n      default:\n        throw new Error(\"Unrecognized bookType |\" + o.bookType + \"|\");\n    }\n  }\n  function resolve_book_type(o) {\n    if (o.bookType) return;\n    var _BT = {\n      \"xls\": \"biff8\",\n      \"htm\": \"html\",\n      \"slk\": \"sylk\",\n      \"socialcalc\": \"eth\",\n      \"Sh33tJS\": \"WTF\"\n    };\n    var ext = o.file.slice(o.file.lastIndexOf(\".\")).toLowerCase();\n    if (ext.match(/^\\.[a-z]+$/)) o.bookType = ext.slice(1);\n    o.bookType = _BT[o.bookType] || o.bookType;\n  }\n  function writeFileSync(wb, filename, opts) {\n    var o = opts || {};\n    o.type = 'file';\n    o.file = filename;\n    resolve_book_type(o);\n    return writeSync(wb, o);\n  }\n  function writeFileSyncXLSX(wb, filename, opts) {\n    var o = opts || {};\n    o.type = 'file';\n    o.file = filename;\n    resolve_book_type(o);\n    return writeSyncXLSX(wb, o);\n  }\n  function writeFileAsync(filename, wb, opts, cb) {\n    var o = opts || {};\n    o.type = 'file';\n    o.file = filename;\n    resolve_book_type(o);\n    o.type = 'buffer';\n    var _cb = cb;\n    if (!(_cb instanceof Function)) _cb = opts;\n    return _fs.writeFile(filename, writeSync(wb, o), _cb);\n  }\n  function make_json_row(sheet, r, R, cols, header, hdr, dense, o) {\n    var rr = encode_row(R);\n    var defval = o.defval,\n      raw = o.raw || !Object.prototype.hasOwnProperty.call(o, \"raw\");\n    var isempty = true;\n    var row = header === 1 ? [] : {};\n    if (header !== 1) {\n      if (Object.defineProperty) try {\n        Object.defineProperty(row, '__rowNum__', {\n          value: R,\n          enumerable: false\n        });\n      } catch (e) {\n        row.__rowNum__ = R;\n      } else row.__rowNum__ = R;\n    }\n    if (!dense || sheet[R]) for (var C = r.s.c; C <= r.e.c; ++C) {\n      var val = dense ? sheet[R][C] : sheet[cols[C] + rr];\n      if (val === undefined || val.t === undefined) {\n        if (defval === undefined) continue;\n        if (hdr[C] != null) {\n          row[hdr[C]] = defval;\n        }\n        continue;\n      }\n      var v = val.v;\n      switch (val.t) {\n        case 'z':\n          if (v == null) break;\n          continue;\n        case 'e':\n          v = v == 0 ? null : void 0;\n          break;\n        case 's':\n        case 'd':\n        case 'b':\n        case 'n':\n          break;\n        default:\n          throw new Error('unrecognized type ' + val.t);\n      }\n      if (hdr[C] != null) {\n        if (v == null) {\n          if (val.t == \"e\" && v === null) row[hdr[C]] = null;else if (defval !== undefined) row[hdr[C]] = defval;else if (raw && v === null) row[hdr[C]] = null;else continue;\n        } else {\n          row[hdr[C]] = raw && (val.t !== \"n\" || val.t === \"n\" && o.rawNumbers !== false) ? v : format_cell(val, v, o);\n        }\n        if (v != null) isempty = false;\n      }\n    }\n    return {\n      row: row,\n      isempty: isempty\n    };\n  }\n  function sheet_to_json(sheet, opts) {\n    if (sheet == null || sheet[\"!ref\"] == null) return [];\n    var val = {\n        t: 'n',\n        v: 0\n      },\n      header = 0,\n      offset = 1,\n      hdr = [],\n      v = 0,\n      vv = \"\";\n    var r = {\n      s: {\n        r: 0,\n        c: 0\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    var o = opts || {};\n    var range = o.range != null ? o.range : sheet[\"!ref\"];\n    if (o.header === 1) header = 1;else if (o.header === \"A\") header = 2;else if (Array.isArray(o.header)) header = 3;else if (o.header == null) header = 0;\n    switch (typeof range) {\n      case 'string':\n        r = safe_decode_range(range);\n        break;\n      case 'number':\n        r = safe_decode_range(sheet[\"!ref\"]);\n        r.s.r = range;\n        break;\n      default:\n        r = range;\n    }\n    if (header > 0) offset = 0;\n    var rr = encode_row(r.s.r);\n    var cols = [];\n    var out = [];\n    var outi = 0,\n      counter = 0;\n    var dense = Array.isArray(sheet);\n    var R = r.s.r,\n      C = 0;\n    var header_cnt = {};\n    if (dense && !sheet[R]) sheet[R] = [];\n    var colinfo = o.skipHidden && sheet[\"!cols\"] || [];\n    var rowinfo = o.skipHidden && sheet[\"!rows\"] || [];\n    for (C = r.s.c; C <= r.e.c; ++C) {\n      if ((colinfo[C] || {}).hidden) continue;\n      cols[C] = encode_col(C);\n      val = dense ? sheet[R][C] : sheet[cols[C] + rr];\n      switch (header) {\n        case 1:\n          hdr[C] = C - r.s.c;\n          break;\n        case 2:\n          hdr[C] = cols[C];\n          break;\n        case 3:\n          hdr[C] = o.header[C - r.s.c];\n          break;\n        default:\n          if (val == null) val = {\n            w: \"__EMPTY\",\n            t: \"s\"\n          };\n          vv = v = format_cell(val, null, o);\n          counter = header_cnt[v] || 0;\n          if (!counter) header_cnt[v] = 1;else {\n            do {\n              vv = v + \"_\" + counter++;\n            } while (header_cnt[vv]);\n            header_cnt[v] = counter;\n            header_cnt[vv] = 1;\n          }\n          hdr[C] = vv;\n      }\n    }\n    for (R = r.s.r + offset; R <= r.e.r; ++R) {\n      if ((rowinfo[R] || {}).hidden) continue;\n      var row = make_json_row(sheet, r, R, cols, header, hdr, dense, o);\n      if (row.isempty === false || (header === 1 ? o.blankrows !== false : !!o.blankrows)) out[outi++] = row.row;\n    }\n    out.length = outi;\n    return out;\n  }\n  var qreg = /\"/g;\n  function make_csv_row(sheet, r, R, cols, fs, rs, FS, o) {\n    var isempty = true;\n    var row = [],\n      txt = \"\",\n      rr = encode_row(R);\n    for (var C = r.s.c; C <= r.e.c; ++C) {\n      if (!cols[C]) continue;\n      var val = o.dense ? (sheet[R] || [])[C] : sheet[cols[C] + rr];\n      if (val == null) txt = \"\";else if (val.v != null) {\n        isempty = false;\n        txt = '' + (o.rawNumbers && val.t == \"n\" ? val.v : format_cell(val, null, o));\n        for (var i = 0, cc = 0; i !== txt.length; ++i) if ((cc = txt.charCodeAt(i)) === fs || cc === rs || cc === 34 || o.forceQuotes) {\n          txt = \"\\\"\" + txt.replace(qreg, '\"\"') + \"\\\"\";\n          break;\n        }\n        if (txt == \"ID\") txt = '\"ID\"';\n      } else if (val.f != null && !val.F) {\n        isempty = false;\n        txt = '=' + val.f;\n        if (txt.indexOf(\",\") >= 0) txt = '\"' + txt.replace(qreg, '\"\"') + '\"';\n      } else txt = \"\";\n      /* NOTE: Excel CSV does not support array formulae */\n      row.push(txt);\n    }\n    if (o.blankrows === false && isempty) return null;\n    return row.join(FS);\n  }\n  function sheet_to_csv(sheet, opts) {\n    var out = [];\n    var o = opts == null ? {} : opts;\n    if (sheet == null || sheet[\"!ref\"] == null) return \"\";\n    var r = safe_decode_range(sheet[\"!ref\"]);\n    var FS = o.FS !== undefined ? o.FS : \",\",\n      fs = FS.charCodeAt(0);\n    var RS = o.RS !== undefined ? o.RS : \"\\n\",\n      rs = RS.charCodeAt(0);\n    var endregex = new RegExp((FS == \"|\" ? \"\\\\|\" : FS) + \"+$\");\n    var row = \"\",\n      cols = [];\n    o.dense = Array.isArray(sheet);\n    var colinfo = o.skipHidden && sheet[\"!cols\"] || [];\n    var rowinfo = o.skipHidden && sheet[\"!rows\"] || [];\n    for (var C = r.s.c; C <= r.e.c; ++C) if (!(colinfo[C] || {}).hidden) cols[C] = encode_col(C);\n    var w = 0;\n    for (var R = r.s.r; R <= r.e.r; ++R) {\n      if ((rowinfo[R] || {}).hidden) continue;\n      row = make_csv_row(sheet, r, R, cols, fs, rs, FS, o);\n      if (row == null) {\n        continue;\n      }\n      if (o.strip) row = row.replace(endregex, \"\");\n      if (row || o.blankrows !== false) out.push((w++ ? RS : \"\") + row);\n    }\n    delete o.dense;\n    return out.join(\"\");\n  }\n  function sheet_to_txt(sheet, opts) {\n    if (!opts) opts = {};\n    opts.FS = \"\\t\";\n    opts.RS = \"\\n\";\n    var s = sheet_to_csv(sheet, opts);\n    if (typeof $cptable == 'undefined' || opts.type == 'string') return s;\n    var o = $cptable.utils.encode(1200, s, 'str');\n    return String.fromCharCode(255) + String.fromCharCode(254) + o;\n  }\n  function sheet_to_formulae(sheet) {\n    var y = \"\",\n      x,\n      val = \"\";\n    if (sheet == null || sheet[\"!ref\"] == null) return [];\n    var r = safe_decode_range(sheet['!ref']),\n      rr = \"\",\n      cols = [],\n      C;\n    var cmds = [];\n    var dense = Array.isArray(sheet);\n    for (C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\n    for (var R = r.s.r; R <= r.e.r; ++R) {\n      rr = encode_row(R);\n      for (C = r.s.c; C <= r.e.c; ++C) {\n        y = cols[C] + rr;\n        x = dense ? (sheet[R] || [])[C] : sheet[y];\n        val = \"\";\n        if (x === undefined) continue;else if (x.F != null) {\n          y = x.F;\n          if (!x.f) continue;\n          val = x.f;\n          if (y.indexOf(\":\") == -1) y = y + \":\" + y;\n        }\n        if (x.f != null) val = x.f;else if (x.t == 'z') continue;else if (x.t == 'n' && x.v != null) val = \"\" + x.v;else if (x.t == 'b') val = x.v ? \"TRUE\" : \"FALSE\";else if (x.w !== undefined) val = \"'\" + x.w;else if (x.v === undefined) continue;else if (x.t == 's') val = \"'\" + x.v;else val = \"\" + x.v;\n        cmds[cmds.length] = y + \"=\" + val;\n      }\n    }\n    return cmds;\n  }\n  function sheet_add_json(_ws, js, opts) {\n    var o = opts || {};\n    var offset = +!o.skipHeader;\n    var ws = _ws || {};\n    var _R = 0,\n      _C = 0;\n    if (ws && o.origin != null) {\n      if (typeof o.origin == 'number') _R = o.origin;else {\n        var _origin = typeof o.origin == \"string\" ? decode_cell(o.origin) : o.origin;\n        _R = _origin.r;\n        _C = _origin.c;\n      }\n    }\n    var cell;\n    var range = {\n      s: {\n        c: 0,\n        r: 0\n      },\n      e: {\n        c: _C,\n        r: _R + js.length - 1 + offset\n      }\n    };\n    if (ws['!ref']) {\n      var _range = safe_decode_range(ws['!ref']);\n      range.e.c = Math.max(range.e.c, _range.e.c);\n      range.e.r = Math.max(range.e.r, _range.e.r);\n      if (_R == -1) {\n        _R = _range.e.r + 1;\n        range.e.r = _R + js.length - 1 + offset;\n      }\n    } else {\n      if (_R == -1) {\n        _R = 0;\n        range.e.r = js.length - 1 + offset;\n      }\n    }\n    var hdr = o.header || [],\n      C = 0;\n    js.forEach(function (JS, R) {\n      keys(JS).forEach(function (k) {\n        if ((C = hdr.indexOf(k)) == -1) hdr[C = hdr.length] = k;\n        var v = JS[k];\n        var t = 'z';\n        var z = \"\";\n        var ref = encode_cell({\n          c: _C + C,\n          r: _R + R + offset\n        });\n        cell = ws_get_cell_stub(ws, ref);\n        if (v && typeof v === 'object' && !(v instanceof Date)) {\n          ws[ref] = v;\n        } else {\n          if (typeof v == 'number') t = 'n';else if (typeof v == 'boolean') t = 'b';else if (typeof v == 'string') t = 's';else if (v instanceof Date) {\n            t = 'd';\n            if (!o.cellDates) {\n              t = 'n';\n              v = datenum(v);\n            }\n            z = o.dateNF || table_fmt[14];\n          } else if (v === null && o.nullError) {\n            t = 'e';\n            v = 0;\n          }\n          if (!cell) ws[ref] = cell = {\n            t: t,\n            v: v\n          };else {\n            cell.t = t;\n            cell.v = v;\n            delete cell.w;\n            delete cell.R;\n            if (z) cell.z = z;\n          }\n          if (z) cell.z = z;\n        }\n      });\n    });\n    range.e.c = Math.max(range.e.c, _C + hdr.length - 1);\n    var __R = encode_row(_R);\n    if (offset) for (C = 0; C < hdr.length; ++C) ws[encode_col(C + _C) + __R] = {\n      t: 's',\n      v: hdr[C]\n    };\n    ws['!ref'] = encode_range(range);\n    return ws;\n  }\n  function json_to_sheet(js, opts) {\n    return sheet_add_json(null, js, opts);\n  }\n\n  /* get cell, creating a stub if necessary */\n  function ws_get_cell_stub(ws, R, C) {\n    /* A1 cell address */\n    if (typeof R == \"string\") {\n      /* dense */\n      if (Array.isArray(ws)) {\n        var RC = decode_cell(R);\n        if (!ws[RC.r]) ws[RC.r] = [];\n        return ws[RC.r][RC.c] || (ws[RC.r][RC.c] = {\n          t: 'z'\n        });\n      }\n      return ws[R] || (ws[R] = {\n        t: 'z'\n      });\n    }\n    /* cell address object */\n    if (typeof R != \"number\") return ws_get_cell_stub(ws, encode_cell(R));\n    /* R and C are 0-based indices */\n    return ws_get_cell_stub(ws, encode_cell({\n      r: R,\n      c: C || 0\n    }));\n  }\n\n  /* find sheet index for given name / validate index */\n  function wb_sheet_idx(wb, sh) {\n    if (typeof sh == \"number\") {\n      if (sh >= 0 && wb.SheetNames.length > sh) return sh;\n      throw new Error(\"Cannot find sheet # \" + sh);\n    } else if (typeof sh == \"string\") {\n      var idx = wb.SheetNames.indexOf(sh);\n      if (idx > -1) return idx;\n      throw new Error(\"Cannot find sheet name |\" + sh + \"|\");\n    } else throw new Error(\"Cannot find sheet |\" + sh + \"|\");\n  }\n\n  /* simple blank workbook object */\n  function book_new() {\n    return {\n      SheetNames: [],\n      Sheets: {}\n    };\n  }\n\n  /* add a worksheet to the end of a given workbook */\n  function book_append_sheet(wb, ws, name, roll) {\n    var i = 1;\n    if (!name) for (; i <= 0xFFFF; ++i, name = undefined) if (wb.SheetNames.indexOf(name = \"Sheet\" + i) == -1) break;\n    if (!name || wb.SheetNames.length >= 0xFFFF) throw new Error(\"Too many worksheets\");\n    if (roll && wb.SheetNames.indexOf(name) >= 0) {\n      var m = name.match(/(^.*?)(\\d+)$/);\n      i = m && +m[2] || 0;\n      var root = m && m[1] || name;\n      for (++i; i <= 0xFFFF; ++i) if (wb.SheetNames.indexOf(name = root + i) == -1) break;\n    }\n    check_ws_name(name);\n    if (wb.SheetNames.indexOf(name) >= 0) throw new Error(\"Worksheet with name |\" + name + \"| already exists!\");\n    wb.SheetNames.push(name);\n    wb.Sheets[name] = ws;\n    return name;\n  }\n\n  /* set sheet visibility (visible/hidden/very hidden) */\n  function book_set_sheet_visibility(wb, sh, vis) {\n    if (!wb.Workbook) wb.Workbook = {};\n    if (!wb.Workbook.Sheets) wb.Workbook.Sheets = [];\n    var idx = wb_sheet_idx(wb, sh);\n    // $FlowIgnore\n    if (!wb.Workbook.Sheets[idx]) wb.Workbook.Sheets[idx] = {};\n    switch (vis) {\n      case 0:\n      case 1:\n      case 2:\n        break;\n      default:\n        throw new Error(\"Bad sheet visibility setting \" + vis);\n    }\n    // $FlowIgnore\n    wb.Workbook.Sheets[idx].Hidden = vis;\n  }\n\n  /* set number format */\n  function cell_set_number_format(cell, fmt) {\n    cell.z = fmt;\n    return cell;\n  }\n\n  /* set cell hyperlink */\n  function cell_set_hyperlink(cell, target, tooltip) {\n    if (!target) {\n      delete cell.l;\n    } else {\n      cell.l = {\n        Target: target\n      };\n      if (tooltip) cell.l.Tooltip = tooltip;\n    }\n    return cell;\n  }\n  function cell_set_internal_link(cell, range, tooltip) {\n    return cell_set_hyperlink(cell, \"#\" + range, tooltip);\n  }\n\n  /* add to cell comments */\n  function cell_add_comment(cell, text, author) {\n    if (!cell.c) cell.c = [];\n    cell.c.push({\n      t: text,\n      a: author || \"SheetJS\"\n    });\n  }\n\n  /* set array formula and flush related cells */\n  function sheet_set_array_formula(ws, range, formula, dynamic) {\n    var rng = typeof range != \"string\" ? range : safe_decode_range(range);\n    var rngstr = typeof range == \"string\" ? range : encode_range(range);\n    for (var R = rng.s.r; R <= rng.e.r; ++R) for (var C = rng.s.c; C <= rng.e.c; ++C) {\n      var cell = ws_get_cell_stub(ws, R, C);\n      cell.t = 'n';\n      cell.F = rngstr;\n      delete cell.v;\n      if (R == rng.s.r && C == rng.s.c) {\n        cell.f = formula;\n        if (dynamic) cell.D = true;\n      }\n    }\n    return ws;\n  }\n  var utils = {\n    encode_col: encode_col,\n    encode_row: encode_row,\n    encode_cell: encode_cell,\n    encode_range: encode_range,\n    decode_col: decode_col,\n    decode_row: decode_row,\n    split_cell: split_cell,\n    decode_cell: decode_cell,\n    decode_range: decode_range,\n    format_cell: format_cell,\n    sheet_add_aoa: sheet_add_aoa,\n    sheet_add_json: sheet_add_json,\n    sheet_add_dom: sheet_add_dom,\n    aoa_to_sheet: aoa_to_sheet,\n    json_to_sheet: json_to_sheet,\n    table_to_sheet: parse_dom_table,\n    table_to_book: table_to_book,\n    sheet_to_csv: sheet_to_csv,\n    sheet_to_txt: sheet_to_txt,\n    sheet_to_json: sheet_to_json,\n    sheet_to_html: sheet_to_html,\n    sheet_to_formulae: sheet_to_formulae,\n    sheet_to_row_object_array: sheet_to_json,\n    sheet_get_cell: ws_get_cell_stub,\n    book_new: book_new,\n    book_append_sheet: book_append_sheet,\n    book_set_sheet_visibility: book_set_sheet_visibility,\n    cell_set_number_format: cell_set_number_format,\n    cell_set_hyperlink: cell_set_hyperlink,\n    cell_set_internal_link: cell_set_internal_link,\n    cell_add_comment: cell_add_comment,\n    sheet_set_array_formula: sheet_set_array_formula,\n    consts: {\n      SHEET_VISIBLE: 0,\n      SHEET_HIDDEN: 1,\n      SHEET_VERY_HIDDEN: 2\n    }\n  };\n  var _Readable;\n  function set_readable(R) {\n    _Readable = R;\n  }\n  function write_csv_stream(sheet, opts) {\n    var stream = _Readable();\n    var o = opts == null ? {} : opts;\n    if (sheet == null || sheet[\"!ref\"] == null) {\n      stream.push(null);\n      return stream;\n    }\n    var r = safe_decode_range(sheet[\"!ref\"]);\n    var FS = o.FS !== undefined ? o.FS : \",\",\n      fs = FS.charCodeAt(0);\n    var RS = o.RS !== undefined ? o.RS : \"\\n\",\n      rs = RS.charCodeAt(0);\n    var endregex = new RegExp((FS == \"|\" ? \"\\\\|\" : FS) + \"+$\");\n    var row = \"\",\n      cols = [];\n    o.dense = Array.isArray(sheet);\n    var colinfo = o.skipHidden && sheet[\"!cols\"] || [];\n    var rowinfo = o.skipHidden && sheet[\"!rows\"] || [];\n    for (var C = r.s.c; C <= r.e.c; ++C) if (!(colinfo[C] || {}).hidden) cols[C] = encode_col(C);\n    var R = r.s.r;\n    var BOM = false,\n      w = 0;\n    stream._read = function () {\n      if (!BOM) {\n        BOM = true;\n        return stream.push(\"\\uFEFF\");\n      }\n      while (R <= r.e.r) {\n        ++R;\n        if ((rowinfo[R - 1] || {}).hidden) continue;\n        row = make_csv_row(sheet, r, R - 1, cols, fs, rs, FS, o);\n        if (row != null) {\n          if (o.strip) row = row.replace(endregex, \"\");\n          if (row || o.blankrows !== false) return stream.push((w++ ? RS : \"\") + row);\n        }\n      }\n      return stream.push(null);\n    };\n    return stream;\n  }\n  function write_html_stream(ws, opts) {\n    var stream = _Readable();\n    var o = opts || {};\n    var header = o.header != null ? o.header : HTML_BEGIN;\n    var footer = o.footer != null ? o.footer : HTML_END;\n    stream.push(header);\n    var r = decode_range(ws['!ref']);\n    o.dense = Array.isArray(ws);\n    stream.push(make_html_preamble(ws, r, o));\n    var R = r.s.r;\n    var end = false;\n    stream._read = function () {\n      if (R > r.e.r) {\n        if (!end) {\n          end = true;\n          stream.push(\"</table>\" + footer);\n        }\n        return stream.push(null);\n      }\n      while (R <= r.e.r) {\n        stream.push(make_html_row(ws, r, R, o));\n        ++R;\n        break;\n      }\n    };\n    return stream;\n  }\n  function write_json_stream(sheet, opts) {\n    var stream = _Readable({\n      objectMode: true\n    });\n    if (sheet == null || sheet[\"!ref\"] == null) {\n      stream.push(null);\n      return stream;\n    }\n    var val = {\n        t: 'n',\n        v: 0\n      },\n      header = 0,\n      offset = 1,\n      hdr = [],\n      v = 0,\n      vv = \"\";\n    var r = {\n      s: {\n        r: 0,\n        c: 0\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    var o = opts || {};\n    var range = o.range != null ? o.range : sheet[\"!ref\"];\n    if (o.header === 1) header = 1;else if (o.header === \"A\") header = 2;else if (Array.isArray(o.header)) header = 3;\n    switch (typeof range) {\n      case 'string':\n        r = safe_decode_range(range);\n        break;\n      case 'number':\n        r = safe_decode_range(sheet[\"!ref\"]);\n        r.s.r = range;\n        break;\n      default:\n        r = range;\n    }\n    if (header > 0) offset = 0;\n    var rr = encode_row(r.s.r);\n    var cols = [];\n    var counter = 0;\n    var dense = Array.isArray(sheet);\n    var R = r.s.r,\n      C = 0;\n    var header_cnt = {};\n    if (dense && !sheet[R]) sheet[R] = [];\n    var colinfo = o.skipHidden && sheet[\"!cols\"] || [];\n    var rowinfo = o.skipHidden && sheet[\"!rows\"] || [];\n    for (C = r.s.c; C <= r.e.c; ++C) {\n      if ((colinfo[C] || {}).hidden) continue;\n      cols[C] = encode_col(C);\n      val = dense ? sheet[R][C] : sheet[cols[C] + rr];\n      switch (header) {\n        case 1:\n          hdr[C] = C - r.s.c;\n          break;\n        case 2:\n          hdr[C] = cols[C];\n          break;\n        case 3:\n          hdr[C] = o.header[C - r.s.c];\n          break;\n        default:\n          if (val == null) val = {\n            w: \"__EMPTY\",\n            t: \"s\"\n          };\n          vv = v = format_cell(val, null, o);\n          counter = header_cnt[v] || 0;\n          if (!counter) header_cnt[v] = 1;else {\n            do {\n              vv = v + \"_\" + counter++;\n            } while (header_cnt[vv]);\n            header_cnt[v] = counter;\n            header_cnt[vv] = 1;\n          }\n          hdr[C] = vv;\n      }\n    }\n    R = r.s.r + offset;\n    stream._read = function () {\n      while (R <= r.e.r) {\n        if ((rowinfo[R - 1] || {}).hidden) continue;\n        var row = make_json_row(sheet, r, R, cols, header, hdr, dense, o);\n        ++R;\n        if (row.isempty === false || (header === 1 ? o.blankrows !== false : !!o.blankrows)) {\n          stream.push(row.row);\n          return;\n        }\n      }\n      return stream.push(null);\n    };\n    return stream;\n  }\n  var __stream = {\n    to_json: write_json_stream,\n    to_html: write_html_stream,\n    to_csv: write_csv_stream,\n    set_readable: set_readable\n  };\n  if (typeof parse_xlscfb !== \"undefined\") XLSX.parse_xlscfb = parse_xlscfb;\n  XLSX.parse_zip = parse_zip;\n  XLSX.read = readSync; //xlsread\n  XLSX.readFile = readFileSync; //readFile\n  XLSX.readFileSync = readFileSync;\n  XLSX.write = writeSync;\n  XLSX.writeFile = writeFileSync;\n  XLSX.writeFileSync = writeFileSync;\n  XLSX.writeFileAsync = writeFileAsync;\n  XLSX.utils = utils;\n  XLSX.writeXLSX = writeSyncXLSX;\n  XLSX.writeFileXLSX = writeFileSyncXLSX;\n  XLSX.SSF = SSF;\n  if (typeof __stream !== \"undefined\") XLSX.stream = __stream;\n  if (typeof CFB !== \"undefined\") XLSX.CFB = CFB;\n  if (typeof require !== \"undefined\") {\n    var strmod = require('stream');\n    if ((strmod || {}).Readable) set_readable(strmod.Readable);\n  }\n}\n/*global define */\nif (typeof exports !== 'undefined') make_xlsx_lib(exports);else if (typeof module !== 'undefined' && module.exports) make_xlsx_lib(module.exports);else if (typeof define === 'function' && define.amd) define('xlsx', function () {\n  if (!XLSX.version) make_xlsx_lib(XLSX);\n  return XLSX;\n});else make_xlsx_lib(XLSX);\n/* NOTE: the following extra line is needed for \"Lightning Locker Service\" */\nif (typeof window !== 'undefined' && !window.XLSX) try {\n  window.XLSX = XLSX;\n} catch (e) {}","map":{"version":3,"names":["XLSX","make_xlsx_lib","version","current_codepage","current_ansi","$cptable","cptable","module","require","VALID_ANSI","CS2CP","set_ansi","cp","indexOf","reset_ansi","set_cp","reset_cp","char_codes","data","o","i","len","length","charCodeAt","utf16leread","String","fromCharCode","join","utf16beread","debom","c1","c2","slice","_getchar","_gc1","x","_getansi","_ga1","utils","decode","_gc2","_ga2","DENSE","DIF_XL","Base64_map","Base64_encode","input","c3","e1","e2","e3","e4","isNaN","charAt","Base64_decode","replace","has_buf","Buffer","process","versions","node","Buffer_from","nbfs","from","e","buf","enc","bind","new_raw_buf","alloc","Uint8Array","Array","new_unsafe_buf","allocUnsafe","s2a","s","split","map","s2ab","ArrayBuffer","view","a2s","isArray","c","a2u","Error","ab2a","bconcat","bufs","concat","isBuffer","maxlen","set","apply","call","utf8decode","content","out","widx","L","ridx","d","push","chr0","chr1","_strrev","pad0","v","t","fill","pad_","rpad_","pad0r1","Math","round","pad0r2","p2_32","pow","pad0r","SSF_isgeneral","days","months","SSF_init_table","table_fmt","SSF_default_map","SSF_default_str","SSF_frac","D","mixed","sgn","B","P_2","P_1","P","Q_2","Q_1","Q","A","floor","q","SSF_parse_date_code","opts","b2","date","time","dow","dout","T","u","y","m","H","M","S","abs","date1904","Date","setDate","getDate","getFullYear","getMonth","getDay","SSF_fix_hijri","SSFbasedate","SSFdnthresh","getTime","SSFbase1904","datenum_local","epoch","getTimezoneOffset","SSF_strip_decimal","SSF_normalize_exp","SSF_small_exp","w","toFixed","toPrecision","toExponential","SSF_large_exp","SSF_general_num","V","log","LOG10E","substr","toUpperCase","SSF_general","toString","SSF_format","SSF_write_date","type","fmt","val","ss0","ss","tt","outl","outstr","commaify","j","pct1","write_num_pct","sfmt","mul","write_num","write_num_cm","idx","write_num_exp","match","period","ee","fakee","$$","$1","$2","$3","frac1","write_num_f1","r","aval","sign","den","parseInt","rr","base","myn","myd","write_num_f2","dec1","closeparen","phone","hashq","str","cc","rnd","dd","dec","_frac","carry","flr","write_num_flt","ffmt","ri","ff","oa","min","max","lres","rres","write_num_cm2","write_num_pct2","write_num_exp2","write_num_int","lastIndexOf","SSF_split_fmt","in_str","SSF_abstime","fmt_is_date","eval_fmt","flen","lst","dt","hr","toLowerCase","bt","ssm","nstr","jj","vv","myv","ostr","decpt","lasti","retval","cfregex2","chkcond","thresh","parseFloat","choose_fmt","f","l","lat","m1","m2","dateNF","table","SSF_load","undefined","SSF_load_table","tbl","make_ssf","SSF","format","load","_table","load_table","parse_date_code","is_date","get_table","SSFImplicit","dateNFregex","dateNF_regex","RegExp","dateNF_fix","Y","forEach","n","datestr","timestr","CRC32","signed_crc_table","Int32Array","T0","slice_by_16_tables","subarray","TT","T1","T2","T3","T4","T5","T6","T7","T8","T9","Ta","Tb","Tc","Td","Te","Tf","crc32_bstr","bstr","seed","C","crc32_buf","crc32_str","CFB","_CFB","exports","namecmp","R","Z","dirname","p","filename","write_dos_date","hms","getHours","getMinutes","getSeconds","write_shift","ymd","parse_dos_date","read_shift","setMilliseconds","setFullYear","setMonth","setHours","setMinutes","setSeconds","parse_extra_field","blob","prep_blob","flags","sz","tgt","mtime","atime","ctime","mt","fs","get_fs","parse","file","options","parse_zip","parse_mad","mver","ssz","nmfs","difat_sec_cnt","dir_start","minifat_start","difat_start","fat_addrs","mv","check_get_mver","header","check_shifts","dir_cnt","chk","sectors","sectorify","sleuth_fat","sector_list","make_sector_list","name","ENDOFCHAIN","files","Paths","FileIndex","FullPaths","read_directory","build_full_paths","shift","raw","HEADER_SIGNATURE","nsectors","ceil","FI","FP","pl","dad","get_mfat_entry","entry","payload","mini","start","size","MSSZ","__readInt32LE","new_buf","cnt","sector","get_sector_list","chkd","buf_chain","modulus","addr","nodes","__toBuffer","sl","k","seen","minifat_store","namelen","__utf16le","color","clsid","state","ct","read_date","storage","offset","__readUInt32LE","read_file","readFileSync","read","init_cfb","cfb","root","CLSID","seed_cfb","nm","find","rebuild_cfb","gc","_file","pop","now","fullPaths","Object","create","HEADER_CLSID","sort","elt","_write","_opts","fileType","write_mad","write_zip","mini_size","fat_size","mini_cnt","mfat_cnt","fat_base","fat_cnt","difat_cnt","HEADER_SIG","chainit","consts","DIFSECT","FATSECT","_nm","copy","path","UCFullPaths","UCPaths","UCPath","MAXREGSECT","FREESECT","HEADER_MINOR_VERSION","MAXREGSID","NOSTREAM","EntryTypes","write_file","writeFileSync","write","_zlib","use_zlib","zlib","InflateRaw","InflRaw","_processChunk","_finishFlushFlag","bytesRead","console","error","message","_inflateRawSync","usz","_inflate","_deflateRawSync","deflateRawSync","_deflate","CLEN_ORDER","LEN_LN","DST_LN","bit_swap_8","use_typed_arrays","bitswap8","bit_swap_n","b","rev","read_bits_2","bl","h","read_bits_3","read_bits_4","read_bits_5","read_bits_7","read_bits_n","write_bits_3","write_bits_1","write_bits_8","write_bits_16","realloc","a","zero_fill_array","build_tree","clens","cmap","MAX","ccode","bl_count","Uint16Array","ctree","cleni","fix_lmap","fix_dmap","dlens","_deflateRaw","_deflateRawIIFE","DST_LN_RE","LEN_LN_RE","write_stored","boff","write_huff_fixed","addrs","hash","mlen","len_eb","dst_eb","off","dyn_lmap","dyn_dmap","dyn_cmap","dyn_len_1","dyn_len_2","dyn","_HLIT","_HDIST","_HCLEN","next_code","hcodes","h1","h2","inflate","outbuf","woff","OL","max_len_1","max_len_2","bits","code","dst","warn_or_throw","wrn","msg","fcnt","start_cd","csz","efsz","fcsz","EF","parse_local_file","meth","crc32","_csz","_usz","ef","cfb_add","unsafe","cdirs","method","compression","desc","fp","fi","crcs","sz_cd","namebuf","ContentTypeMap","get_content_type","ctype","ext","write_base64_76","write_quoted_printable","text","encoded","si","end","tmp","parse_quoted_printable","di","line","oi","parse_mime","fname","cte","fdata","trim","row","test","mboundary","boundary","start_di","ca","cstr","dispcnt","csl","qp","cfb_new","fpath","cfb_gc","cfb_del","splice","cfb_mov","old_name","new_name","writeFile","ReadShift","CheckField","_inflateRaw","_fs","blobify","write_dl","Deno","TextEncoder","encode","utf8write","IE_SaveFile","Blob","navigator","msSaveBlob","saveAs","URL","document","createElement","createObjectURL","url","chrome","downloads","download","revokeObjectURL","setTimeout","href","body","appendChild","click","removeChild","$","File","Folder","open","encoding","close","read_binary","infile","keys","ks","o2","prototype","hasOwnProperty","evert_key","obj","key","K","evert","evert_num","evert_arr","basedate","datenum","dnthresh","refdate","refoffset","numdate","setTime","parse_isodur","sec","good_pd_date_1","good_pd_date","good_pd","parseDate","fixdate","cc2str","arr","debomit","TextDecoder","dup","JSON","stringify","fuzzynum","Number","isFinite","NaN","wt","lower_months","fuzzydate","getYear","lower","split_regex","safe_split_regex","re","def","getdatastr","asNodeBuffer","asBinary","_data","getContent","getdatabin","getdata","safegetzipfile","zip","g","getzipfile","getzipdata","safe","getzipstr","getzipbin","zipentries","zip_add_file","res","zip_new","zip_read","resolve_path","result","target","step","XML_HEADER","attregexg","tagregex1","tagregex2","tagregex","nsregex","nsregex2","parsexmltag","tag","skip_root","skip_LC","z","eq","quot","strip_ns","encodings","rencoding","unescapexml","encregex","coderegex","decregex","charegex","escapexml","escapexmltag","htmlcharegex","escapehtml","escapexlml","xlml_fixstr","entregex","entrepl","xlml_unfixstr","parsexmlbool","value","utf8reada","orig","utf8readb","ww","utf8readc","utf8corpus","utf8read","matchtag","mtcache","htmldecode","entities","vtregex","vt_cache","vt_regex","vtvregex","vtmregex","parseVector","matches","baseType","WTF","wtregex","writetag","wxt_helper","writextag","write_w3cdtf","toISOString","write_vt","xlsx","xlml_normalize","xlmlregex","XMLNS","CORE_PROPS","CUST_PROPS","EXT_PROPS","CT","RELS","TCMNT","XMLNS_main","XLMLNS","read_double_le","Infinity","write_double_le","bs","av","LN2","___toBuffer","___utf16le","__readUInt16LE","___hexlify","__hexlify","___utf8","__readUInt8","__utf8","utf8_b","___lpstr","__lpstr","___cpstr","__cpstr","___lpwstr","__lpwstr","___lpp4","lpp4_","__lpp4","___8lpp4","__8lpp4","___double","__double","is_buf","is_buf_a","lpstr_b","readUInt32LE","cpstr_b","lpwstr_b","lpp4_b","lpp4_8b","double_","readDoubleLE","is_buf_b","cpdoit","__readInt16LE","__readInt32BE","oI","oR","oo","loc","lens","__writeUInt32LE","__writeInt32LE","__writeUInt16LE","WriteShift","cppayload","hexstr","fld","pos","parsenoop","recordhopper","cb","tmpbyte","cntbyte","RT","XLSBRecordEnum","buf_array","blksz","newblk","ba_newblk","curbuf","endbuf","ba_endbuf","next","ba_next","ba_end","ba_push","_bufs","write_record","ba","shift_cell_xls","cell","cRel","rRel","biff","shift_range_xls","range","encode_cell_xls","encode_cell","fix_col","fix_row","encode_range_xls","encode_col","encode_row","decode_row","rowstr","unfix_row","decode_col","colstr","unfix_col","col","split_cell","decode_cell","decode_range","encode_range","cs","ce","safe_decode_range","safe_format_cell","XF","numFmtId","format_cell","BErr","sheet_to_workbook","sheet","sheets","SheetNames","Sheets","sheet_add_aoa","_ws","dense","ws","_R","_C","origin","_origin","_range","__R","__C","nullError","sheetStubs","cellDates","cell_ref","aoa_to_sheet","parse_Int32LE","write_UInt32LE","parse_XLWideString","cchCharacters","write_XLWideString","_null","parse_StrRun","ich","ifnt","write_StrRun","run","parse_RichStr","rgsStrRun","dwSizeStrRun","write_RichStr","parse_BrtCommentText","write_BrtCommentText","parse_XLSBCell","iStyleRef","write_XLSBCell","parse_XLSBShortCell","write_XLSBShortCell","parse_XLSBCodeName","write_XLSBCodeName","parse_XLNullableWideString","write_XLNullableWideString","parse_XLNameWideString","parse_RelID","write_RelID","parse_RkNumber","fX100","fInt","RK","write_RkNumber","d100","parse_RfX","write_RfX","parse_UncheckedRfX","write_UncheckedRfX","parse_Xnum","write_Xnum","parse_BrtColor","xColorType","index","nTS","bR","bG","bB","auto","icv","XLSIcv","rgb","rgb2Hex","theme","tint","write_BrtColor","parse_FontFlags","fBold","fItalic","fUnderline","fStrikeout","fOutline","fShadow","fCondense","fExtend","write_FontFlags","font","grbit","italic","strike","outline","shadow","condense","extend","parse_ClipboardFormatOrString","ClipFmt","parse_ClipboardFormatOrAnsiString","parse_ClipboardFormatOrUnicodeString","VT_I2","VT_I4","VT_BOOL","VT_VARIANT","VT_UI4","VT_LPSTR","VT_FILETIME","VT_BLOB","VT_CF","VT_VECTOR","VT_VECTOR_VARIANT","VT_VECTOR_LPSTR","VT_STRING","VT_USTR","VT_CUSTOM","DocSummaryPIDDSI","SummaryPIDSI","CountryEnum","XLSFillPattern","rgbify","_XLSIcv","RBErr","ct2type","CT_LIST","workbooks","xlsm","xlsb","xlam","xltx","strs","comments","charts","dialogs","macros","metadata","styles","new_ct","rels","threadedcomments","links","coreprops","extprops","custprops","themes","calcchains","vba","drawings","people","TODO","xmlns","parse_ct","ctext","Extension","ContentType","PartName","calcchain","sst","style","defaults","write_ct","type2ct","xsd","xsi","f1","bookType","f2","f3","WB","SHEET","HLINK","VML","XPATH","XMISS","XLINK","CXML","CXMLP","CMNT","SST","STY","THEME","CHART","CHARTEX","CS","WS","DS","MS","IMG","DRAW","XLMETA","PEOPLE","VBA","get_rels_path","parse_rels","currentFilePath","rel","Type","Target","Id","TargetMode","canonictarget","write_rels","rid","add_rels","rId","relobj","targetmode","CT_ODS","parse_manifest","Rn","FEtag","exec","write_manifest","manifest","write_rdf_type","write_rdf_has","write_rdf","rdf","write_meta_ods","CORE_PROPS_REGEX","parse_core_props","cur","cp_doit","write_core_props","dc","dcterms","dcmitype","Props","CreatedDate","ModifiedDate","PseudoPropsPairs","load_props_pairs","HP","TOP","props","hp","parts","Worksheets","NamedRanges","DefinedNames","Chartsheets","ChartNames","parse_ext_props","xml","HeadingPairs","TitlesOfParts","write_ext_props","W","Application","vt","custregex","parse_cust_props","toks","warn","write_cust_props","pid","custprop","XLMLDocPropsMap","Title","Subject","Author","Keywords","Comments","LastAuthor","RevNumber","LastPrinted","Category","Manager","Company","AppVersion","ContentStatus","Identifier","Language","evert_XLMLDPM","xlml_set_prop","xlml_write_docprops","xlml_write_custprops","Custprops","BLACKLIST","parse_FILETIME","dwLowDateTime","dwHighDateTime","write_FILETIME","parse_lpstr","pad","parse_lpwstr","parse_VtStringBase","stringType","parse_VtString","parse_VtUnalignedString","parse_VtVecLpwstrValue","ret","parse_VtVecUnalignedLpstrValue","parse_VtHeadingPair","headingString","parse_TypedPropertyValue","headerParts","parse_VtVecHeadingPairValue","cElements","parse_dictionary","CodePage","dict","parse_BLOB","bytes","parse_ClipboardData","Size","write_TypedPropertyValue","parse_PropertySet","PIDSI","start_addr","NumProps","Dictionary","DictObj","PropID","Offset","PropH","fail","piddsi","oldpos","parsebool","XLSPSSkip","guess_property_type","write_PropertySet","entries","RE","hdr","piao","prop","pr","pio","unshift","pinfo","parse_PropertySetStream","NumSets","FMTID0","FMTID1","Offset0","Offset1","SystemIdentifier","PSet0","rval","FMTID","PSet1","write_PropertySetStream","entries2","clsid2","ps0","ps1","parsenoop2","writezeroes","parslurp","writebool","parseuint16","writeuint16","parseuint16a","parse_Bes","write_Bes","parse_ShortXLUnicodeString","cch","fHighByte","parse_XLUnicodeRichExtendedString","fExtSt","fRichSt","width","cRun","cbExtRst","write_XLUnicodeRichExtendedString","xlstr","nfmts","otext","parse_XLUnicodeStringNoCch","parse_XLUnicodeString","parse_XLUnicodeString2","write_XLUnicodeString","parse_ControlInfo","accel","parse_URLMoniker","extra","parse_FileMoniker","cAnti","preamble","ansiPath","unicodePath","parse_HyperlinkMoniker","parse_HyperlinkString","write_HyperlinkString","parse_Hyperlink","sVer","displayName","targetFrameName","moniker","oleMoniker","Loc","guid","fileTime","Tooltip","write_Hyperlink","hl","hashidx","F","Pretarget","parse_LongRGBA","parse_LongRGB","parse_XLSCell","rw","ixfe","write_XLSCell","parse_frtHeader","rt","parse_OptXLUnicodeString","parse_XTI","iSupBook","itabFirst","itabLast","parse_RkRec","parse_AddinUdf","udfName","parse_Ref8U","rwFirst","rwLast","colFirst","colLast","write_Ref8U","parse_RefU","parse_Ref","parse_FtCmo","ot","id","parse_FtNts","fSharedNote","parse_FtCf","cf","parse_FtSkip","FtTab","parse_FtArray","fts","ft","parse_BOF","BIFFVer","write_BOF","wb","parse_InterfaceHdr","parse_WriteAccess","UserName","write_WriteAccess","b8","parse_WsBool","fDialog","fBelow","fRight","parse_BoundSheet8","hidden","hs","write_BoundSheet8","parse_SST","ucnt","Count","Unique","write_SST","parse_ExtSST","extsst","dsst","parse_Row","miyRw","level","hpt","parse_ForceFullCalculation","fullcalc","parse_RecalcId","parse_DefaultRowHeight","fl","Unsynced","DyZero","ExAsc","ExDsc","parse_Window1","xWn","yWn","dxWn","dyWn","iTabCur","iTabFirst","ctabSel","wTabRatio","Pos","Dim","Flags","CurTab","FirstTab","Selected","TabRatio","write_Window1","parse_Window2","RTL","write_Window2","parse_Pane","parse_Font","dyHeight","write_Font","b5","parse_LabelSst","isst","write_LabelSst","os","parse_Label","biffguess","write_Label","parse_Format","fmtstr","write_Format","parse_BIFF2Format","parse_Dimensions","write_Dimensions","parse_RK","rkrec","rknum","parse_MulRk","rkrecs","lastcol","parse_MulBlank","ixfes","parse_CellStyleXF","patternType","cellStyles","alc","fWrap","alcV","fJustLast","trot","cIndent","fShrinkToFit","iReadOrder","fAtrNum","fAtrFnt","fAtrAlc","fAtrBdr","fAtrPat","fAtrProt","dgLeft","dgRight","dgTop","dgBottom","icvLeft","icvRight","grbitDiag","icvTop","icvBottom","icvDiag","dgDiag","icvFore","icvBack","fsxButton","parse_XF","fStyle","write_XF","ixfeP","parse_Guts","write_Guts","guts","parse_BoolErr","write_BoolErr","parse_Number","xnum","write_Number","parse_XLHeaderFooter","parse_SupBook","ctab","sbcch","virtPath","rgst","parse_ExternName","fBuiltIn","fWantAdvise","fWantPict","fOle","fOleLink","fIcon","Name","XLSLblBuiltIn","parse_Lbl","chKey","cce","itab","npflen","rgce","parse_NameParsedFormula","parse_ExternSheet","parse_BIFF5ExternSheet","parse_NameCmt","cchName","cchComment","comment","parse_ShrFmla","ref","cUse","parse_SharedParsedFormula","parse_Array","parse_ArrayParsedFormula","parse_MTRSettings","fMTREnabled","fUserSetThreadCount","cUserThreadCount","parse_NoteSh","idObj","stAuthor","parse_Note","parse_MergeCells","merges","cmcs","write_MergeCells","parse_Obj","parse_BIFF5Obj","cmo","parse_BIFF5OT","parse_TxO","texts","lastobj","controlInfo","cchText","parse_HLink","hlink","write_HLink","O","parse_HLinkTooltip","wzTooltip","write_HLinkTooltip","parse_Country","write_Country","parse_ClrtClient","ccv","parse_Palette","parse_XFCRC","cxfs","crc","parse_ColInfo","coldx","write_ColInfo","parse_Setup","footer","parse_ShtProps","area","write_RRTabId","parse_Blank","parse_Scl","parse_String","parse_ImData","env","lcb","parse_BIFF2STR","parse_BIFF2NUM","num","write_BIFF2NUM","write_BIFF2Cell","parse_BIFF2INT","write_BIFF2INT","parse_BIFF2STRING","parse_BIFF2FONTXTRA","parse_RString","DBF_SUPPORTED_VERSIONS","DBF","dbf_codepage_map","dbf_reverse_map","dbf_to_aoa","memo","vfp","l7","nrow","fpos","rlen","current_cp","codepage","fields","field","hend","sheetRows","dbf_to_sheet","wch","dbf_to_workbook","_RLEN","sheet_to_dbf","aoa","sheet_to_json","headers","cols","hcnt","coltypes","colwidths","coldecimals","guess","_guess","hf","_f","hb","rout","_n","_s","to_workbook","to_sheet","from_sheet","SYLK","sylk_escapes","AA","BA","CA","DA","HA","JA","AE","BE","CE","HE","AI","BI","CI","HI","AO","BO","CO","DO","HO","AU","BU","CU","HU","Aa","Ba","Ca","Da","Ha","Ja","Ae","Be","Ce","He","Ai","Bi","Ci","Hi","Ao","Bo","Co","Do","Ho","Au","Bu","Cu","Hu","KC","Kc","DN","Dn","Hy","sylk_char_regex","sylk_char_fn","_","decode_sylk_char","newcc","sylk_to_aoa","sylk_to_aoa_str","records","rj","formats","next_cell_format","sht","rowinfo","colinfo","cw","Mval","rstr","record","C_seen_K","C_seen_X","C_seen_S","C_seen_E","formula","rc_to_a1","shrbase","shift_formula_str","F_seen","process_col","hpx","pt2px","sylk_to_sheet","aoasht","sylk_to_workbook","write_ws_cell_sylk","a1_to_rc","write_ws_cols_sylk","rec","wpx","width2px","px2char","write_ws_rows_sylk","rows","px2pt","sheet_to_sylk","RS","coord","DIF","dif_to_aoa","dif_to_aoa_str","dif_to_sheet","dif_to_workbook","sheet_to_dif","push_field","pf","topic","push_value","po","ETH","eth_to_aoa","eth_to_sheet","eth_to_workbook","sep","meta","sheet_to_eth_data","sheet_to_eth","PRN","set_text_arr","prn_to_aoa_str","lines","guess_seps","guess_sep_weights","guess_sep","instr","dsv_to_sheet_str","FS","sepcc","startcc","_re","finish_cell","fuzzyfmla","cellText","cellNF","outer","prn_to_sheet_str","prn_to_sheet","firstbyte","prn_to_workbook","sheet_to_prn","read_wb_ID","OLD_WTF","WK_","lotushopper","Enum","WK1Enum","lotus_to_workbook","lotus_to_workbook_buf","next_n","sidx","snames","realnames","refguess","vers","qpro","tmpcell","WK3Enum","osheets","rnames","sheet_to_wk1","write_biff_rec","write_BOF_WK1","write_RANGE","max_R","write_INTEGER","write_NUMBER","write_LABEL","book_to_wk3","write_BOF_WK3","write_XFORMAT_SHEETNAME","wsidx","write_NUMBER_17","write_LABEL_16","wscnt","parse_RANGE","parse_cell","parse_LABEL","parse_INTEGER","parse_NUMBER","parse_FORMULA","wk1_fmla_to_csf","wk1_parse_rc","FuncTab","BinOpTab","argc","argL","argR","args","parse_cell_3","parse_LABEL_16","parse_NUMBER_18","parse_NUMBER_17","v1","v2","log2","parse_FORMULA_19","parse_NUMBER_25","parse_NUMBER_27","parse_FORMULA_28","parse_SHEETNAMECS","parse_SHEETNAMELP","parse_SHEETINFOQP","parse_XFORMAT","parse_rpr","rpr","pass","uval","family","valign","parse_rs","tregex","rpregex","parse_r","rregex","rend","rs","filter","rs_to_html","parse_rs_factory","nlregex","parse_rpr2","intro","outro","align","r_to_html","terms","sitregex","sirregex","sirphregex","parse_si","html","cellHTML","sstr0","sstr1","sstr2","parse_sst_xml","count","uniqueCount","straywsregex","write_sst_xml","bookSST","sitag","parse_BrtBeginSst","parse_sst_bin","hopper_sst","write_BrtBeginSst","write_BrtSSTItem","write_sst_bin","_JS2ANSI","parse_CRYPTOVersion","Major","Minor","parse_DataSpaceVersionInfo","U","parse_DataSpaceMapEntry","comps","parse_DataSpaceMap","parse_DataSpaceDefinition","parse_TransformInfoHeader","parse_Primary","ename","cmode","parse_EncryptionHeader","AlgID","valid","AlgIDHash","KeySize","ProviderType","CSPName","parse_EncryptionVerifier","Salt","Verifier","VerifierHash","parse_EncryptionInfo","parse_EncInfoStd","parse_EncInfoExt","parse_EncInfoAgl","verifier","KeyData","xml_agile","encryptedHmacKey","encryptedHmacValue","encs","uri","parse_RC4CryptoHeader","EncryptionVersionInfo","EncryptionHeader","EncryptionVerifier","parse_RC4Header","EncryptedVerifier","EncryptedVerifierHash","crypto_CreatePasswordVerifier_Method1","Password","PasswordArray","PasswordDecoded","PasswordByte","Intermediate1","Intermediate2","Intermediate3","crypto_CreateXorArray_Method1","PadArray","InitialCode","XorMatrix","Ror","Byte","XorRor","byte1","byte2","CreateXorKey_Method1","XorKey","CurrentElement","Char","password","Index","ObfuscationArray","Temp","PasswordLastChar","PadIndex","crypto_DecryptData_Method1","Data","XorArrayIndex","XorArray","Value","crypto_MakeXorDecryptor","parse_XORObfuscation","verificationBytes","insitu","parse_FilePassHeader","Info","parse_FilePass","RTF","rtf_to_sheet","rtf_to_sheet_str","rowtf","rtfre","last_index","lastIndex","rtf_to_workbook","sheet_to_rtf","hex2RGB","rgb2HSL","G","H6","L2","hsl2RGB","hsl","h6","X","rgb_tint","hex","DEF_MDW","MAX_MDW","MIN_MDW","MDW","px","char2width","chr","cycle_width","collw","find_mdw_colw","delta","_MDW","coll","customWidth","DEF_PPI","PPI","pt","XLMLPatternTypeMap","parse_borders","Borders","border","diagonalUp","diagonalDown","parse_fills","Fills","bgColor","indexed","fgColor","parse_fonts","Fonts","bold","underline","vertAlign","scheme","themeElements","clrScheme","parse_numFmts","NumberFmt","formatCode","write_numFmts","NF","cellXF_uint","cellXF_bool","parse_cellXfs","CellXf","xf","alignment","vertical","horizontal","textRotation","indent","wrapText","write_cellXfs","cellXfs","parse_sty_xml","make_pstyx","numFmtRegex","cellXfRegex","fillsRegex","fontsRegex","bordersRegex","write_sty_xml","parse_BrtFmt","stFmtCode","write_BrtFmt","parse_BrtFont","bls","bCharSet","charset","write_BrtFont","sss","XLSBFillPTNames","rev_XLSBFillPTNames","parse_BrtFill","write_BrtFill","fls","parse_BrtXF","ixfeParent","ifmt","write_BrtXF","flow","write_Blxf","parse_BrtBorder","write_BrtBorder","write_BrtStyle","xfId","builtinId","write_BrtBeginTableStyles","defTableStyle","defPivotStyle","parse_sty_bin","hopper_sty","write_FMTS_bin","write_FONTS_bin","write_FILLS_bin","write_BORDERS_bin","write_CELLSTYLEXFS_bin","fontId","fillId","borderId","write_CELLXFS_bin","write_STYLES_bin","write_DXFS_bin","write_TABLESTYLES_bin","write_COLORPALETTE_bin","write_sty_bin","XLSXThemeClrScheme","parse_clrScheme","lastClr","parse_fontScheme","parse_fmtScheme","clrsregex","fntsregex","fmtsregex","parse_themeElements","themeltregex","parse_theme_xml","write_theme","Themes","themeXLSX","parse_Theme","dwThemeVersion","themeXML","parse_ColorTheme","parse_FullColorExt","xclrType","nTintShade","xclrValue","parse_IcvXF","parse_XFExtGradient","parse_ExtProp","extType","parse_XFExt","cexts","update_xfext","xfext","xfe","parse_BrtMdtinfo","write_BrtMdtinfo","parse_BrtMdb","write_BrtMdb","mdb","write_BrtBeginEsfmd","parse_BrtBeginEsmdb","write_BrtBeginEsmdb","cm","parse_xlmeta_bin","Types","Cell","metatype","write_xlmeta_bin","parse_xlmeta_xml","lastmeta","offsets","write_xlmeta_xml","parse_cc_xml","parse_BrtCalcChainItem$","parse_cc_bin","hopper_cc","parse_xlink_xml","parse_xlink_bin","xlink_parse","parse_drawing","_shapeid","write_comments_vml","csize","bbox","joinstyle","gradientshapeok","coordsize","fillopts","angle","fillparm","fillxml","shadata","on","fillcolor","strokecolor","sheet_insert_comments","threaded","author","parse_comments_xml","authors","commentList","authtag","cmnttag","authorId","textMatch","write_comments_xml","iauthor","ID","lastauthor","ts","parse_tcmnt_xml","tidx","xml_tcmnt","personId","write_tcmnt_xml","carr","rootid","tcopts","tcid","parentId","parse_people_xml","displayname","write_people_xml","person","userId","providerId","parse_BrtBeginComment","rfx","write_BrtBeginComment","parse_BrtCommentAuthor","write_BrtCommentAuthor","parse_comments_bin","hopper_cmnt","write_comments_bin","CT_VBA","make_vba_xls","newcfb","newpath","fill_vba_xls","VBAFMTS","parse_ds_bin","parse_ds_xml","parse_ms_bin","parse_ms_xml","rcregex","rcbase","rcfunc","fstr","crefregex","$0","$4","$5","shift_formula_xlsx","_xlfn","parseread1","parse_ColRelU","parse_RgceArea","parse_RgceArea_BIFF2","parse_RgceAreaRel","parse_RgceLoc","parse_RgceLoc_BIFF2","parse_RgceElfLoc","fQuoted","parse_RgceLocRel","parse_RgceLocRel_BIFF2","cl","rl","parse_PtgArea","parse_PtgArea3d","ixti","parse_PtgAreaErr","parse_PtgAreaErr3d","parse_PtgAreaN","parse_PtgArray","parse_PtgAttrBaxcel","bitSemi","bitBaxcel","parse_PtgAttrChoose","parse_PtgAttrGoto","bitGoto","parse_PtgAttrIf","bitIf","parse_PtgAttrIfError","parse_PtgAttrSemi","parse_PtgAttrSpaceType","parse_PtgAttrSpace","parse_PtgAttrSpaceSemi","parse_PtgRef","parse_PtgRefN","parse_PtgRef3d","parse_PtgFunc","iftab","FtabArgc","Ftab","parse_PtgFuncVar","cparams","tab","parsetab","Cetab","parse_PtgAttrSum","parse_PtgExp","parse_PtgErr","parse_PtgInt","parse_PtgBool","parse_PtgNum","parse_PtgStr","parse_SerAr","parse_PtgExtraMem","parse_PtgExtraArray","parse_PtgName","nameindex","parse_PtgNameX","parse_PtgNameX_BIFF5","parse_PtgMemArea","parse_PtgMemFunc","parse_PtgRefErr","parse_PtgRefErr3d","parse_PtgMemErr","parse_PtgMemNoMem","parse_PtgTbl","parse_PtgElfLoc","parse_PtgElfNoop","parse_PtgElfCol","parse_PtgElfColS","parse_PtgElfColSV","parse_PtgElfColV","parse_PtgElfLel","parse_PtgElfRadical","parse_PtgElfRadicalLel","parse_PtgElfRadicalS","parse_PtgElfRw","parse_PtgElfRwV","PtgListRT","parse_PtgList","coltype","parse_PtgSxName","parse_PtgSheet","parse_PtgEndSheet","parse_PtgMemAreaN","parse_PtgMemNoMemN","parse_PtgAttrNoop","PtgTypes","PtgDupes","Ptg18","Ptg19","parse_RgbExtra","parse_Rgce","ptgs","stringify_array","PtgBinOp","PtgAdd","PtgConcat","PtgDiv","PtgEq","PtgGe","PtgGt","PtgLe","PtgLt","PtgMul","PtgNe","PtgPower","PtgSub","formula_quote_sheet_name","sname","get_ixti_raw","supbooks","XTI","SID","get_ixti","ixtiraw","stringify_formula","stack","nameidx","last_sp","sp","fflen","func","lbl","names","xlfn","bookidx","externbook","ixtidata","lp","rp","sharedf","parsedf","fnd","arrayf","PtgNonDisp","_left","rgcb","parse_XLSCellParsedFormula","parse_FormulaValue","write_FormulaValue","parse_Formula","cbf","shared","write_Formula","o1","o3","bf","parse_XLSBParsedFormula","parse_XLSBArrayParsedFormula","parse_XLSBCellParsedFormula","parse_XLSBNameParsedFormula","parse_XLSBSharedParsedFormula","ods_to_csf_formula","csf_to_ods_formula","ods_to_csf_3D","csf_to_ods_3D","_ssfopts","browser_has_Map","Map","get_sst_id","has","revarr","get","col_obj_w","outlineLevel","default_margins","margins","mode","defs","left","right","top","bottom","get_cell_style","revssf","ssf","applyNumberFormat","safe_format","fmtid","fillid","raw_rgb","check_ws","parse_ws_xml_dim","mergecregex","sheetdataregex","hlinkregex","dimregex","colregex","afregex","marginregex","sheetprregex","sheetprregex2","svsregex","parse_ws_xml","data1","data2","mtch","sheetPr","parse_ws_xml_sheetpr","parse_ws_xml_sheetpr2","svs","parse_ws_xml_sheetviews","columns","parse_ws_xml_cols","parse_ws_xml_data","afilter","parse_ws_xml_autofilter","_merge","parse_ws_xml_hlinks","parse_ws_xml_margins","tmpref","write_ws_xml_merges","codeName","CodeName","write_ws_xml_sheetpr","needed","vbaraw","cname","Workbook","outlineprops","summaryBelow","summaryRight","above","sheetprot_deffalse","sheetprot_deftrue","write_ws_xml_protection","location","Rel","tooltip","rng","margin","write_ws_xml_margins","seencol","coli","colm","colM","write_ws_xml_cols","write_ws_xml_autofilter","Names","Sheet","Ref","sviewregex","Views","zoomScale","zoom","rightToLeft","write_ws_xml_sheetviews","sview","workbookViewId","write_ws_xml_cell","oldt","oldv","Strings","revStrings","cellregex","rowregex","isregex","refregex","match_v","match_f","sdata","cells","cref","tagr","tagc","sstr","ftag","do_format","rowobj","rowrite","marr","marrlen","xlen","rstarti","outa","ht","rslice","cellFormula","___f","_tag","xlmeta","_r","write_ws_xml_data","params","height","_cell","customHeight","write_ws_xml","rdata","_drawing","sheetFormat","defaultRowHeight","baseColWidth","outlineLevelRow","relc","ignoreEC","numberStoredAsText","sqref","parse_BrtRowHdr","write_BrtRowHdr","ncolspan","lcs","caddr","first","last","write_row_header","parse_BrtWsDim","write_BrtWsDim","parse_BrtWsFmtInfo","parse_BrtWsProp","write_BrtWsProp","parse_BrtCellBlank","write_BrtCellBlank","ncell","parse_BrtShortBlank","write_BrtShortBlank","parse_BrtCellBool","fBool","write_BrtCellBool","parse_BrtShortBool","write_BrtShortBool","parse_BrtCellError","bError","write_BrtCellError","parse_BrtShortError","write_BrtShortError","parse_BrtCellIsst","write_BrtCellIsst","parse_BrtShortIsst","write_BrtShortIsst","parse_BrtCellReal","write_BrtCellReal","parse_BrtShortReal","write_BrtShortReal","parse_BrtCellRk","write_BrtCellRk","parse_BrtShortRk","write_BrtShortRk","parse_BrtCellRString","parse_BrtCellSt","write_BrtCellSt","parse_BrtShortSt","write_BrtShortSt","parse_BrtFmlaBool","parse_BrtFmlaError","parse_BrtFmlaNum","parse_BrtFmlaString","parse_BrtMergeCell","write_BrtMergeCell","write_BrtBeginMergeCells","parse_BrtHLink","relId","display","write_BrtHLink","locidx","parse_BrtPane","parse_BrtArrFmla","fAlwaysCalc","parse_BrtShrFmla","write_BrtColInfo","BrtMarginKeys","parse_BrtMargins","write_BrtMargins","parse_BrtBeginWsView","write_BrtBeginWsView","write_BrtCellIgnoreEC","write_BrtSheetProtection","parse_BrtDVal","parse_BrtDVal14","parse_ws_bin","ai","af","vm","ws_parse","RR","aii","_d","write_ws_bin_cell","last_seen","write_CELLTABLE","cap","write_MERGECELLS","write_COLINFOS","write_IGNOREECS","write_HLINKS","write_LEGACYDRAWING","write_AUTOFILTER","write_WSVIEWS2","write_WSFMTINFO","write_SHEETPROTECT","write_ws_bin","parse_Cache","nf","parse_chart","csheet","nc","cache","parse_cs_xml","write_cs_xml","parse_BrtCsProp","parse_cs_bin","cs_parse","write_cs_bin","WBPropsDef","WBViewDef","SheetDef","CalcPrDef","push_defaults_array","push_defaults","parse_wb_defaults","WBProps","CalcPr","WBView","safe1904","badchars","check_ws_name","_good","check_wb_names","N","codes","cn","check_wb","wbnsregex","parse_wb_xml","dname","dnstart","xml_wb","Hidden","Comment","localSheetId","write_wb_xml","write_names","workbookPr","sheetId","parse_BrtBundleSh","iTabID","strRelID","write_BrtBundleSh","parse_BrtWbProp","defaultThemeVersion","strName","autoCompressPictures","backupFile","checkCompatibility","filterPrivacy","hidePivotFieldList","promptedSolutions","publishItems","refreshAllConnections","saveExternalLinkValues","showBorderUnselectedTables","showInkAnnotation","showObjects","showPivotChartFilter","updateLinks","write_BrtWbProp","parse_BrtFRTArchID$","ArchID","parse_BrtName","Ptg","parse_wb_bin","hopper_wb","write_BUNDLESHS","viz","write_BrtFileVersion","write_BrtBookView","write_BOOKVIEWS","vistab","write_wb_bin","parse_wb","parse_ws","parse_cs","parse_ms","parse_ds","parse_sty","parse_theme","parse_sst","parse_cmnt","parse_cc","parse_xlink","parse_xlmeta","write_wb","write_ws","write_cs","write_sty","write_sst","write_cmnt","write_xlmeta","attregexg2","attregex2","xlml_parsexmltag","words","xlml_parsexmltagobj","XLMLFormatMap","xlml_format","xlml_set_custprop","oval","safe_format_xlml","process_style_xlml","stag","Interior","I","Pattern","parse_xlml_data","csty","sid","StyleID","interiors","Parent","UTC","Formula","ArrayRange","xlml_clean_comment","parse_xlml_xml","opening","ishtml","_o","html_to_workbook","sheetnames","cursheet","sheetname","dtag","didx","fidx","pidx","cstys","wsprops","raw_Rn3","HRef","HRefScreenTip","MergeAcross","MergeDown","cma","cmd","AutoFitHeight","Height","Format","ssfidx","Width","_col","Span","_NamedRange","_DefinedName","RefersTo","AutoFilter","Range","parse_fods","Margin","pagemargins","Top","Left","Right","Bottom","bookSheets","bookProps","parse_xlml","fix_read_opts","write_props_xlml","write_wb_xlml","write_sty_xlml","write_name_xlml","write_names_xlml","write_ws_xlml_names","write_ws_xlml_wsopts","objects","scenarios","selectLockedCells","selectUnlockedCells","write_ws_xlml_comment","write_ws_xlml_cell","attr","mi","_v","write_ws_xlml_row","write_ws_xlml_table","skip","write_ws_xlml","write_xlml","parse_compobj","AnsiUserType","AnsiClipboardFormat","Reserved1","UnicodeClipboardFormat","Reserved2","CONTINUE_RT","slurp","RecordType","nextrt","XLSRecordEnum","ll","safe_format_xf","make_cell","parse_workbook","Directory","last_formula","cur_sheet","Preamble","lastcell","last_cell","cmnt","rngC","rngR","temp_val","country","XFs","palette","get_rgb","getrgb","process_cell_style","pcs","xfd","addcell","file_depth","afi","rrtabid","lastuser","winlocked","wtf","last_RT","BIFF2Fmt","BIFF2FmtTable","FilterDatabases","last_lbl","seen_codepage","Date1904","WriteProtect","cpval","CalcRefMode","FullCalc","ExternCount","tmpri","fakebs8","_fr","_fc","_fe","_arraystart","_j","_ixfe","b4idx","b2idx","TxO","ImData","noteobj","Encryption","Metadata","Country","PSCLSID","SI","DSI","UDI","parse_xls_props","DocSummary","Summary","write_xls_props","DSEntries","SEntries","CEntries","Keys","DocSummaryRE","SummaryRE","CEntries2","parse_xlscfb","CompObj","WorkbookP","bookVBA","bookFiles","write_xlscfb","wbpath","write_biff_buf","write_biff_continue","write_BIFF2BERR","write_BIFF2LABEL","write_ws_biff2_cell","write_ws_biff2","write_biff2_buf","write_FONTS_biff8","write_FMTS_biff8","write_FEAT","write_CELLXFS_biff8","write_ws_biff8_hlinks","HL","write_ws_cols_biff8","write_ws_biff8_cell","write_ws_biff8","_WB","_sheet","MAX_ROWS","write_biff8_global","_sheets","_wb","blen","write_biff8_buf","fix_write_opts","html_to_sheet","mtch2","hd","midx","colspan","rowspan","_t","make_html_row","editable","HTML_BEGIN","HTML_END","book_new","book_append_sheet","make_html_preamble","sheet_to_html","sheet_add_dom","or_R","or_C","getElementsByTagName","is_dom_element_hidden","elts","children","hasAttribute","getAttribute","innerHTML","Aelts","Aelti","parse_dom_table","table_to_book","element","get_computed_style","get_get_computed_style_function","getPropertyValue","ownerDocument","defaultView","getComputedStyle","parse_text_p","fixed","number_formats_ods","day","month","year","hours","minutes","seconds","era","quarter","parse_content_xml","NFtag","sheetag","rowtag","ctag","textp","textpidx","textptag","textR","row_ol","number_format_map","mrange","mR","mC","rowpeat","colpeat","atag","_Ref","creator","creatoridx","isstub","intable","rptR","rpt","nrange","ptp","parse_ods","write_styles_ods","master_styles","wso","write_content_ods","write_text_p","null_cell_xml","covered_cell_xml","ods","ROWS","_Fref","text_p","_tgt","write_automatic_styles_ods","cidx","colobj","wcx","fods","write_ods","u8_to_dataview","array","DataView","buffer","byteOffset","byteLength","u8str","u8","stru8","u8contains","search","u8concat","u8a","reduce","acc","popcnt","readDecimal128LE","exp","mantissa","writeDecimal128LE","parse_varint49","ptr","varint","write_varint49","varint_to_i32","i32","parse_shallow","write_shallow","proto","item","mappa","parse_iwa_file","_a","messages","merge","write_iwa_file","ias","ia","midata","aipayload","mid","parse_snappy_chunk","chunks","decompress_iwa_file","compress_iwa_file","frame","parse_old_storage","rsst","dv","getUint32","data_offset","ieee","getFloat64","parse_new_storage","d128","write_new_storage","setFloat64","setUint32","write_old_storage","parse_cell_storage","parse_TSP_Reference","pb","write_TSP_Reference","parse_TST_TableDataList","le","rtp","rtpref","mtype","tswpsa","parse_TST_TileRowInfo","_b","_c","_e","_g","_h","_i","_k","_l","_m","wide_offsets","used_storage_u8","used_storage","used_storage_offsets","getUint16","parse_TST_Tile","nrows","parse_TST_TableModelArchive","store","tile","tl","_tile","parse_TST_TableInfoArchive","tableref","parse_TN_SheetArchive","shapeoffs","parse_TN_DocumentArchive","sheetoffs","root2","parse_numbers_iwa","indices","packets","packet","docroot","iwam","write_tile_row","tri","last_offset","cell_storage","_dv","_last_offset","_cell_storage","setUint16","celload","_celload","write_numbers_iwa","numbers","trunc","dependents","old_content","raw1","x2","packet2","deps","y2","indices_varint","ivi","some","mess","get_unique_msgid","xi","sheetrootref","cruidsref","oldbucket","_x","cruids","uuid","row_headers","row_header_ref","base_bucket","_bucket","col_header_ref","sstref","sentry","sx","sstroot","sxi","sstdata","newsst","sy","raw32","tileref","tentry","tx","tileroot","tiledata","rowload","R2","tilerow","ty","raw3","fix_opts_func","fix_opts","get_sheet_type","safe_parse_wbrels","wbrels","pwbr","safe_parse_sheet","relsPath","sheetRels","stype","dfile","drelsp","draw","chartp","crelsp","tcomments","strip_front_slash","_zip","dir","binname","link","propdata","pluck","bookDeps","wbsheets","wbext","wbrelsi","wbrelsfile","nmode","wsloop","snjseen","snj","Deps","Styles","bin","parse_xlsxcfb","dsm","seds","einfo","decrypt_agile","decrypt_std76","write_zip_xlsxb","write_zip_xlsx","foo","vbafmt","_sn","wsrels","_type","need_vml","rId1","needtc","read_cfb","read_zip","read_plaintext","main","read_plaintext_raw","read_utf16","bstrify","read_prn","readSync","ab","vu","write_cfb_ctr","write_zip_type","write_zip_denouement","write_zip_typeXLSX","oopts","ftype","generate","encrypt_agile","write_cfb_type","write_string_type","bom","write_stxt_type","write_binary_type","writeSyncXLSX","writeSync","sheet_to_txt","sheet_to_csv","resolve_book_type","_BT","writeFileSyncXLSX","writeFileAsync","_cb","Function","make_json_row","defval","isempty","defineProperty","enumerable","__rowNum__","rawNumbers","outi","counter","header_cnt","skipHidden","blankrows","qreg","make_csv_row","txt","forceQuotes","endregex","strip","sheet_to_formulae","cmds","sheet_add_json","js","skipHeader","JS","ws_get_cell_stub","json_to_sheet","RC","wb_sheet_idx","sh","roll","book_set_sheet_visibility","vis","cell_set_number_format","cell_set_hyperlink","cell_set_internal_link","cell_add_comment","sheet_set_array_formula","dynamic","rngstr","table_to_sheet","sheet_to_row_object_array","sheet_get_cell","SHEET_VISIBLE","SHEET_HIDDEN","SHEET_VERY_HIDDEN","_Readable","set_readable","write_csv_stream","stream","BOM","_read","write_html_stream","write_json_stream","objectMode","__stream","to_json","to_html","to_csv","readFile","writeXLSX","writeFileXLSX","strmod","Readable","define","amd","window"],"sources":["E:/matship/node_modules/xlsx/xlsx.js"],"sourcesContent":["/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*exported XLSX */\n/*global exports, module, require:false, process:false, Buffer:false, ArrayBuffer:false, DataView:false, Deno:false */\nvar XLSX = {};\nfunction make_xlsx_lib(XLSX){\nXLSX.version = '0.18.5';\nvar current_codepage = 1200, current_ansi = 1252;\n/*global cptable:true, window */\nvar $cptable;\nif(typeof cptable !== 'undefined') $cptable = cptable;\nelse if(typeof module !== \"undefined\" && typeof require !== 'undefined') {\n\t$cptable = require('./dist/cpexcel.js');\n}\n\nvar VALID_ANSI = [ 874, 932, 936, 949, 950, 1250, 1251, 1252, 1253, 1254, 1255, 1256, 1257, 1258, 10000 ];\n/* ECMA-376 Part I 18.4.1 charset to codepage mapping */\nvar CS2CP = ({\n0:    1252, /* ANSI */\n1:   65001, /* DEFAULT */\n2:   65001, /* SYMBOL */\n77:  10000, /* MAC */\n128:   932, /* SHIFTJIS */\n129:   949, /* HANGUL */\n130:  1361, /* JOHAB */\n134:   936, /* GB2312 */\n136:   950, /* CHINESEBIG5 */\n161:  1253, /* GREEK */\n162:  1254, /* TURKISH */\n163:  1258, /* VIETNAMESE */\n177:  1255, /* HEBREW */\n178:  1256, /* ARABIC */\n186:  1257, /* BALTIC */\n204:  1251, /* RUSSIAN */\n222:   874, /* THAI */\n238:  1250, /* EASTEUROPE */\n255:  1252, /* OEM */\n69:   6969  /* MISC */\n});\n\nvar set_ansi = function(cp) { if(VALID_ANSI.indexOf(cp) == -1) return; current_ansi = CS2CP[0] = cp; };\nfunction reset_ansi() { set_ansi(1252); }\n\nvar set_cp = function(cp) { current_codepage = cp; set_ansi(cp); };\nfunction reset_cp() { set_cp(1200); reset_ansi(); }\n\nfunction char_codes(data) { var o = []; for(var i = 0, len = data.length; i < len; ++i) o[i] = data.charCodeAt(i); return o; }\n\nfunction utf16leread(data) {\n\tvar o = [];\n\tfor(var i = 0; i < (data.length>>1); ++i) o[i] = String.fromCharCode(data.charCodeAt(2*i) + (data.charCodeAt(2*i+1)<<8));\n\treturn o.join(\"\");\n}\nfunction utf16beread(data) {\n\tvar o = [];\n\tfor(var i = 0; i < (data.length>>1); ++i) o[i] = String.fromCharCode(data.charCodeAt(2*i+1) + (data.charCodeAt(2*i)<<8));\n\treturn o.join(\"\");\n}\n\nvar debom = function(data) {\n\tvar c1 = data.charCodeAt(0), c2 = data.charCodeAt(1);\n\tif(c1 == 0xFF && c2 == 0xFE) return utf16leread(data.slice(2));\n\tif(c1 == 0xFE && c2 == 0xFF) return utf16beread(data.slice(2));\n\tif(c1 == 0xFEFF) return data.slice(1);\n\treturn data;\n};\n\nvar _getchar = function _gc1(x) { return String.fromCharCode(x); };\nvar _getansi = function _ga1(x) { return String.fromCharCode(x); };\nif(typeof $cptable !== 'undefined') {\n\tset_cp = function(cp) { current_codepage = cp; set_ansi(cp); };\n\tdebom = function(data) {\n\t\tif(data.charCodeAt(0) === 0xFF && data.charCodeAt(1) === 0xFE) { return $cptable.utils.decode(1200, char_codes(data.slice(2))); }\n\t\treturn data;\n\t};\n\t_getchar = function _gc2(x) {\n\t\tif(current_codepage === 1200) return String.fromCharCode(x);\n\t\treturn $cptable.utils.decode(current_codepage, [x&255,x>>8])[0];\n\t};\n\t_getansi = function _ga2(x) {\n\t\treturn $cptable.utils.decode(current_ansi, [x])[0];\n\t};\n}\nvar DENSE = null;\nvar DIF_XL = true;\nvar Base64_map = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\nfunction Base64_encode(input) {\n  var o = \"\";\n  var c1 = 0, c2 = 0, c3 = 0, e1 = 0, e2 = 0, e3 = 0, e4 = 0;\n  for (var i = 0; i < input.length; ) {\n    c1 = input.charCodeAt(i++);\n    e1 = c1 >> 2;\n    c2 = input.charCodeAt(i++);\n    e2 = (c1 & 3) << 4 | c2 >> 4;\n    c3 = input.charCodeAt(i++);\n    e3 = (c2 & 15) << 2 | c3 >> 6;\n    e4 = c3 & 63;\n    if (isNaN(c2)) {\n      e3 = e4 = 64;\n    } else if (isNaN(c3)) {\n      e4 = 64;\n    }\n    o += Base64_map.charAt(e1) + Base64_map.charAt(e2) + Base64_map.charAt(e3) + Base64_map.charAt(e4);\n  }\n  return o;\n}\nfunction Base64_decode(input) {\n  var o = \"\";\n  var c1 = 0, c2 = 0, c3 = 0, e1 = 0, e2 = 0, e3 = 0, e4 = 0;\n  input = input.replace(/[^\\w\\+\\/\\=]/g, \"\");\n  for (var i = 0; i < input.length; ) {\n    e1 = Base64_map.indexOf(input.charAt(i++));\n    e2 = Base64_map.indexOf(input.charAt(i++));\n    c1 = e1 << 2 | e2 >> 4;\n    o += String.fromCharCode(c1);\n    e3 = Base64_map.indexOf(input.charAt(i++));\n    c2 = (e2 & 15) << 4 | e3 >> 2;\n    if (e3 !== 64) {\n      o += String.fromCharCode(c2);\n    }\n    e4 = Base64_map.indexOf(input.charAt(i++));\n    c3 = (e3 & 3) << 6 | e4;\n    if (e4 !== 64) {\n      o += String.fromCharCode(c3);\n    }\n  }\n  return o;\n}\nvar has_buf = (function() { return typeof Buffer !== 'undefined' && typeof process !== 'undefined' && typeof process.versions !== 'undefined' && !!process.versions.node; })();\n\nvar Buffer_from = (function() {\n\tif(typeof Buffer !== 'undefined') {\n\t\tvar nbfs = !Buffer.from;\n\t\tif(!nbfs) try { Buffer.from(\"foo\", \"utf8\"); } catch(e) { nbfs = true; }\n\t\treturn nbfs ? function(buf, enc) { return (enc) ? new Buffer(buf, enc) : new Buffer(buf); } : Buffer.from.bind(Buffer);\n\t}\n\treturn function() {};\n})();\n\n\nfunction new_raw_buf(len) {\n\t/* jshint -W056 */\n\tif(has_buf) return Buffer.alloc ? Buffer.alloc(len) : new Buffer(len);\n\treturn typeof Uint8Array != \"undefined\" ? new Uint8Array(len) : new Array(len);\n\t/* jshint +W056 */\n}\n\nfunction new_unsafe_buf(len) {\n\t/* jshint -W056 */\n\tif(has_buf) return Buffer.allocUnsafe ? Buffer.allocUnsafe(len) : new Buffer(len);\n\treturn typeof Uint8Array != \"undefined\" ? new Uint8Array(len) : new Array(len);\n\t/* jshint +W056 */\n}\n\nvar s2a = function s2a(s) {\n\tif(has_buf) return Buffer_from(s, \"binary\");\n\treturn s.split(\"\").map(function(x){ return x.charCodeAt(0) & 0xff; });\n};\n\nfunction s2ab(s) {\n\tif(typeof ArrayBuffer === 'undefined') return s2a(s);\n\tvar buf = new ArrayBuffer(s.length), view = new Uint8Array(buf);\n\tfor (var i=0; i!=s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;\n\treturn buf;\n}\n\nfunction a2s(data) {\n\tif(Array.isArray(data)) return data.map(function(c) { return String.fromCharCode(c); }).join(\"\");\n\tvar o = []; for(var i = 0; i < data.length; ++i) o[i] = String.fromCharCode(data[i]); return o.join(\"\");\n}\n\nfunction a2u(data) {\n\tif(typeof Uint8Array === 'undefined') throw new Error(\"Unsupported\");\n\treturn new Uint8Array(data);\n}\n\nfunction ab2a(data) {\n\tif(typeof ArrayBuffer == 'undefined') throw new Error(\"Unsupported\");\n\tif(data instanceof ArrayBuffer) return ab2a(new Uint8Array(data));\nvar o = new Array(data.length);\n\tfor(var i = 0; i < data.length; ++i) o[i] = data[i];\n\treturn o;\n}\n\nvar bconcat = has_buf ? function(bufs) { return Buffer.concat(bufs.map(function(buf) { return Buffer.isBuffer(buf) ? buf : Buffer_from(buf); })); } : function(bufs) {\n\tif(typeof Uint8Array !== \"undefined\") {\n\t\tvar i = 0, maxlen = 0;\n\t\tfor(i = 0; i < bufs.length; ++i) maxlen += bufs[i].length;\n\t\tvar o = new Uint8Array(maxlen);\n\t\tvar len = 0;\n\t\tfor(i = 0, maxlen = 0; i < bufs.length; maxlen += len, ++i) {\n\t\t\tlen = bufs[i].length;\n\t\t\tif(bufs[i] instanceof Uint8Array) o.set(bufs[i], maxlen);\n\t\t\telse if(typeof bufs[i] == \"string\") { throw \"wtf\"; }\n\t\t\telse o.set(new Uint8Array(bufs[i]), maxlen);\n\t\t}\n\t\treturn o;\n\t}\n\treturn [].concat.apply([], bufs.map(function(buf) { return Array.isArray(buf) ? buf : [].slice.call(buf); }));\n};\n\nfunction utf8decode(content) {\n\tvar out = [], widx = 0, L = content.length + 250;\n\tvar o = new_raw_buf(content.length + 255);\n\tfor(var ridx = 0; ridx < content.length; ++ridx) {\n\t\tvar c = content.charCodeAt(ridx);\n\t\tif(c < 0x80) o[widx++] = c;\n\t\telse if(c < 0x800) {\n\t\t\to[widx++] = (192|((c>>6)&31));\n\t\t\to[widx++] = (128|(c&63));\n\t\t} else if(c >= 0xD800 && c < 0xE000) {\n\t\t\tc = (c&1023)+64;\n\t\t\tvar d = content.charCodeAt(++ridx)&1023;\n\t\t\to[widx++] = (240|((c>>8)&7));\n\t\t\to[widx++] = (128|((c>>2)&63));\n\t\t\to[widx++] = (128|((d>>6)&15)|((c&3)<<4));\n\t\t\to[widx++] = (128|(d&63));\n\t\t} else {\n\t\t\to[widx++] = (224|((c>>12)&15));\n\t\t\to[widx++] = (128|((c>>6)&63));\n\t\t\to[widx++] = (128|(c&63));\n\t\t}\n\t\tif(widx > L) {\n\t\t\tout.push(o.slice(0, widx));\n\t\t\twidx = 0;\n\t\t\to = new_raw_buf(65535);\n\t\t\tL = 65530;\n\t\t}\n\t}\n\tout.push(o.slice(0, widx));\n\treturn bconcat(out);\n}\n\nvar chr0 = /\\u0000/g, chr1 = /[\\u0001-\\u0006]/g;\n/* ssf.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/*jshint -W041 */\nfunction _strrev(x) { var o = \"\", i = x.length-1; while(i>=0) o += x.charAt(i--); return o; }\nfunction pad0(v,d){var t=\"\"+v; return t.length>=d?t:fill('0',d-t.length)+t;}\nfunction pad_(v,d){var t=\"\"+v;return t.length>=d?t:fill(' ',d-t.length)+t;}\nfunction rpad_(v,d){var t=\"\"+v; return t.length>=d?t:t+fill(' ',d-t.length);}\nfunction pad0r1(v,d){var t=\"\"+Math.round(v); return t.length>=d?t:fill('0',d-t.length)+t;}\nfunction pad0r2(v,d){var t=\"\"+v; return t.length>=d?t:fill('0',d-t.length)+t;}\nvar p2_32 = Math.pow(2,32);\nfunction pad0r(v,d){if(v>p2_32||v<-p2_32) return pad0r1(v,d); var i = Math.round(v); return pad0r2(i,d); }\n/* yes, in 2022 this is still faster than string compare */\nfunction SSF_isgeneral(s, i) { i = i || 0; return s.length >= 7 + i && (s.charCodeAt(i)|32) === 103 && (s.charCodeAt(i+1)|32) === 101 && (s.charCodeAt(i+2)|32) === 110 && (s.charCodeAt(i+3)|32) === 101 && (s.charCodeAt(i+4)|32) === 114 && (s.charCodeAt(i+5)|32) === 97 && (s.charCodeAt(i+6)|32) === 108; }\nvar days = [\n\t['Sun', 'Sunday'],\n\t['Mon', 'Monday'],\n\t['Tue', 'Tuesday'],\n\t['Wed', 'Wednesday'],\n\t['Thu', 'Thursday'],\n\t['Fri', 'Friday'],\n\t['Sat', 'Saturday']\n];\nvar months = [\n\t['J', 'Jan', 'January'],\n\t['F', 'Feb', 'February'],\n\t['M', 'Mar', 'March'],\n\t['A', 'Apr', 'April'],\n\t['M', 'May', 'May'],\n\t['J', 'Jun', 'June'],\n\t['J', 'Jul', 'July'],\n\t['A', 'Aug', 'August'],\n\t['S', 'Sep', 'September'],\n\t['O', 'Oct', 'October'],\n\t['N', 'Nov', 'November'],\n\t['D', 'Dec', 'December']\n];\nfunction SSF_init_table(t) {\n\tif(!t) t = {};\n\tt[0]=  'General';\n\tt[1]=  '0';\n\tt[2]=  '0.00';\n\tt[3]=  '#,##0';\n\tt[4]=  '#,##0.00';\n\tt[9]=  '0%';\n\tt[10]= '0.00%';\n\tt[11]= '0.00E+00';\n\tt[12]= '# ?/?';\n\tt[13]= '# ??/??';\n\tt[14]= 'm/d/yy';\n\tt[15]= 'd-mmm-yy';\n\tt[16]= 'd-mmm';\n\tt[17]= 'mmm-yy';\n\tt[18]= 'h:mm AM/PM';\n\tt[19]= 'h:mm:ss AM/PM';\n\tt[20]= 'h:mm';\n\tt[21]= 'h:mm:ss';\n\tt[22]= 'm/d/yy h:mm';\n\tt[37]= '#,##0 ;(#,##0)';\n\tt[38]= '#,##0 ;[Red](#,##0)';\n\tt[39]= '#,##0.00;(#,##0.00)';\n\tt[40]= '#,##0.00;[Red](#,##0.00)';\n\tt[45]= 'mm:ss';\n\tt[46]= '[h]:mm:ss';\n\tt[47]= 'mmss.0';\n\tt[48]= '##0.0E+0';\n\tt[49]= '@';\n\tt[56]= '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"';\n\treturn t;\n}\n/* repeated to satiate webpack */\nvar table_fmt = {\n\t0:  'General',\n\t1:  '0',\n\t2:  '0.00',\n\t3:  '#,##0',\n\t4:  '#,##0.00',\n\t9:  '0%',\n\t10: '0.00%',\n\t11: '0.00E+00',\n\t12: '# ?/?',\n\t13: '# ??/??',\n\t14: 'm/d/yy',\n\t15: 'd-mmm-yy',\n\t16: 'd-mmm',\n\t17: 'mmm-yy',\n\t18: 'h:mm AM/PM',\n\t19: 'h:mm:ss AM/PM',\n\t20: 'h:mm',\n\t21: 'h:mm:ss',\n\t22: 'm/d/yy h:mm',\n\t37: '#,##0 ;(#,##0)',\n\t38: '#,##0 ;[Red](#,##0)',\n\t39: '#,##0.00;(#,##0.00)',\n\t40: '#,##0.00;[Red](#,##0.00)',\n\t45: 'mm:ss',\n\t46: '[h]:mm:ss',\n\t47: 'mmss.0',\n\t48: '##0.0E+0',\n\t49: '@',\n\t56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"'\n};\n\n/* Defaults determined by systematically testing in Excel 2019 */\n\n/* These formats appear to default to other formats in the table */\nvar SSF_default_map = {\n\t5:  37, 6:  38, 7:  39, 8:  40,         //  5 -> 37 ...  8 -> 40\n\n\t23:  0, 24:  0, 25:  0, 26:  0,         // 23 ->  0 ... 26 ->  0\n\n\t27: 14, 28: 14, 29: 14, 30: 14, 31: 14, // 27 -> 14 ... 31 -> 14\n\n\t50: 14, 51: 14, 52: 14, 53: 14, 54: 14, // 50 -> 14 ... 58 -> 14\n\t55: 14, 56: 14, 57: 14, 58: 14,\n\t59:  1, 60:  2, 61:  3, 62:  4,         // 59 ->  1 ... 62 ->  4\n\n\t67:  9, 68: 10,                         // 67 ->  9 ... 68 -> 10\n\t69: 12, 70: 13, 71: 14,                 // 69 -> 12 ... 71 -> 14\n\t72: 14, 73: 15, 74: 16, 75: 17,         // 72 -> 14 ... 75 -> 17\n\t76: 20, 77: 21, 78: 22,                 // 76 -> 20 ... 78 -> 22\n\t79: 45, 80: 46, 81: 47,                 // 79 -> 45 ... 81 -> 47\n\t82: 0                                   // 82 ->  0 ... 65536 -> 0 (omitted)\n};\n\n\n/* These formats technically refer to Accounting formats with no equivalent */\nvar SSF_default_str = {\n\t//  5 -- Currency,   0 decimal, black negative\n\t5:  '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\t63: '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\n\t//  6 -- Currency,   0 decimal, red   negative\n\t6:  '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\t64: '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\n\t//  7 -- Currency,   2 decimal, black negative\n\t7:  '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\t65: '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\n\t//  8 -- Currency,   2 decimal, red   negative\n\t8:  '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t66: '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\n\t// 41 -- Accounting, 0 decimal, No Symbol\n\t41: '_(* #,##0_);_(* \\\\(#,##0\\\\);_(* \"-\"_);_(@_)',\n\n\t// 42 -- Accounting, 0 decimal, $  Symbol\n\t42: '_(\"$\"* #,##0_);_(\"$\"* \\\\(#,##0\\\\);_(\"$\"* \"-\"_);_(@_)',\n\n\t// 43 -- Accounting, 2 decimal, No Symbol\n\t43: '_(* #,##0.00_);_(* \\\\(#,##0.00\\\\);_(* \"-\"??_);_(@_)',\n\n\t// 44 -- Accounting, 2 decimal, $  Symbol\n\t44: '_(\"$\"* #,##0.00_);_(\"$\"* \\\\(#,##0.00\\\\);_(\"$\"* \"-\"??_);_(@_)'\n};\n\nfunction SSF_frac(x, D, mixed) {\n\tvar sgn = x < 0 ? -1 : 1;\n\tvar B = x * sgn;\n\tvar P_2 = 0, P_1 = 1, P = 0;\n\tvar Q_2 = 1, Q_1 = 0, Q = 0;\n\tvar A = Math.floor(B);\n\twhile(Q_1 < D) {\n\t\tA = Math.floor(B);\n\t\tP = A * P_1 + P_2;\n\t\tQ = A * Q_1 + Q_2;\n\t\tif((B - A) < 0.00000005) break;\n\t\tB = 1 / (B - A);\n\t\tP_2 = P_1; P_1 = P;\n\t\tQ_2 = Q_1; Q_1 = Q;\n\t}\n\tif(Q > D) { if(Q_1 > D) { Q = Q_2; P = P_2; } else { Q = Q_1; P = P_1; } }\n\tif(!mixed) return [0, sgn * P, Q];\n\tvar q = Math.floor(sgn * P/Q);\n\treturn [q, sgn*P - q*Q, Q];\n}\nfunction SSF_parse_date_code(v,opts,b2) {\n\tif(v > 2958465 || v < 0) return null;\n\tvar date = (v|0), time = Math.floor(86400 * (v - date)), dow=0;\n\tvar dout=[];\n\tvar out={D:date, T:time, u:86400*(v-date)-time,y:0,m:0,d:0,H:0,M:0,S:0,q:0};\n\tif(Math.abs(out.u) < 1e-6) out.u = 0;\n\tif(opts && opts.date1904) date += 1462;\n\tif(out.u > 0.9999) {\n\t\tout.u = 0;\n\t\tif(++time == 86400) { out.T = time = 0; ++date; ++out.D; }\n\t}\n\tif(date === 60) {dout = b2 ? [1317,10,29] : [1900,2,29]; dow=3;}\n\telse if(date === 0) {dout = b2 ? [1317,8,29] : [1900,1,0]; dow=6;}\n\telse {\n\t\tif(date > 60) --date;\n\t\t/* 1 = Jan 1 1900 in Gregorian */\n\t\tvar d = new Date(1900, 0, 1);\n\t\td.setDate(d.getDate() + date - 1);\n\t\tdout = [d.getFullYear(), d.getMonth()+1,d.getDate()];\n\t\tdow = d.getDay();\n\t\tif(date < 60) dow = (dow + 6) % 7;\n\t\tif(b2) dow = SSF_fix_hijri(d, dout);\n\t}\n\tout.y = dout[0]; out.m = dout[1]; out.d = dout[2];\n\tout.S = time % 60; time = Math.floor(time / 60);\n\tout.M = time % 60; time = Math.floor(time / 60);\n\tout.H = time;\n\tout.q = dow;\n\treturn out;\n}\nvar SSFbasedate = new Date(1899, 11, 31, 0, 0, 0);\nvar SSFdnthresh = SSFbasedate.getTime();\nvar SSFbase1904 = new Date(1900, 2, 1, 0, 0, 0);\nfunction datenum_local(v, date1904) {\n\tvar epoch = v.getTime();\n\tif(date1904) epoch -= 1461*24*60*60*1000;\n\telse if(v >= SSFbase1904) epoch += 24*60*60*1000;\n\treturn (epoch - (SSFdnthresh + (v.getTimezoneOffset() - SSFbasedate.getTimezoneOffset()) * 60000)) / (24 * 60 * 60 * 1000);\n}\n/* ECMA-376 18.8.30 numFmt*/\n/* Note: `toPrecision` uses standard form when prec > E and E >= -6 */\n/* exponent >= -9 and <= 9 */\nfunction SSF_strip_decimal(o) {\n\treturn (o.indexOf(\".\") == -1) ? o : o.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)$/, \"$1\");\n}\n\n/* General Exponential always shows 2 digits exp and trims the mantissa */\nfunction SSF_normalize_exp(o) {\n\tif(o.indexOf(\"E\") == -1) return o;\n\treturn o.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)[Ee]/,\"$1E\").replace(/(E[+-])(\\d)$/,\"$10$2\");\n}\n\n/* exponent >= -9 and <= 9 */\nfunction SSF_small_exp(v) {\n\tvar w = (v<0?12:11);\n\tvar o = SSF_strip_decimal(v.toFixed(12)); if(o.length <= w) return o;\n\to = v.toPrecision(10); if(o.length <= w) return o;\n\treturn v.toExponential(5);\n}\n\n/* exponent >= 11 or <= -10 likely exponential */\nfunction SSF_large_exp(v) {\n\tvar o = SSF_strip_decimal(v.toFixed(11));\n\treturn (o.length > (v<0?12:11) || o === \"0\" || o === \"-0\") ? v.toPrecision(6) : o;\n}\n\nfunction SSF_general_num(v) {\n\tvar V = Math.floor(Math.log(Math.abs(v))*Math.LOG10E), o;\n\n\tif(V >= -4 && V <= -1) o = v.toPrecision(10+V);\n\telse if(Math.abs(V) <= 9) o = SSF_small_exp(v);\n\telse if(V === 10) o = v.toFixed(10).substr(0,12);\n\telse o = SSF_large_exp(v);\n\n\treturn SSF_strip_decimal(SSF_normalize_exp(o.toUpperCase()));\n}\n\n\n/*\n\t\"General\" rules:\n\t- text is passed through (\"@\")\n\t- booleans are rendered as TRUE/FALSE\n\t- \"up to 11 characters\" displayed for numbers\n\t- Default date format (code 14) used for Dates\n\n\tThe longest 32-bit integer text is \"-2147483648\", exactly 11 chars\n\tTODO: technically the display depends on the width of the cell\n*/\nfunction SSF_general(v, opts) {\n\tswitch(typeof v) {\n\t\tcase 'string': return v;\n\t\tcase 'boolean': return v ? \"TRUE\" : \"FALSE\";\n\t\tcase 'number': return (v|0) === v ? v.toString(10) : SSF_general_num(v);\n\t\tcase 'undefined': return \"\";\n\t\tcase 'object':\n\t\t\tif(v == null) return \"\";\n\t\t\tif(v instanceof Date) return SSF_format(14, datenum_local(v, opts && opts.date1904), opts);\n\t}\n\tthrow new Error(\"unsupported value in General format: \" + v);\n}\n\nfunction SSF_fix_hijri(date, o) {\n  /* TODO: properly adjust y/m/d and  */\n  o[0] -= 581;\n  var dow = date.getDay();\n  if(date < 60) dow = (dow + 6) % 7;\n  return dow;\n}\n//var THAI_DIGITS = \"\\u0E50\\u0E51\\u0E52\\u0E53\\u0E54\\u0E55\\u0E56\\u0E57\\u0E58\\u0E59\".split(\"\");\nfunction SSF_write_date(type, fmt, val, ss0) {\n\tvar o=\"\", ss=0, tt=0, y = val.y, out, outl = 0;\n\tswitch(type) {\n\t\tcase 98: /* 'b' buddhist year */\n\t\t\ty = val.y + 543;\n\t\t\t/* falls through */\n\t\tcase 121: /* 'y' year */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = y % 100; outl = 2; break;\n\t\t\tdefault: out = y % 10000; outl = 4; break;\n\t\t} break;\n\t\tcase 109: /* 'm' month */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.m; outl = fmt.length; break;\n\t\t\tcase 3: return months[val.m-1][1];\n\t\t\tcase 5: return months[val.m-1][0];\n\t\t\tdefault: return months[val.m-1][2];\n\t\t} break;\n\t\tcase 100: /* 'd' day */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.d; outl = fmt.length; break;\n\t\t\tcase 3: return days[val.q][0];\n\t\t\tdefault: return days[val.q][1];\n\t\t} break;\n\t\tcase 104: /* 'h' 12-hour */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = 1+(val.H+11)%12; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad hour format: ' + fmt;\n\t\t} break;\n\t\tcase 72: /* 'H' 24-hour */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.H; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad hour format: ' + fmt;\n\t\t} break;\n\t\tcase 77: /* 'M' minutes */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.M; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad minute format: ' + fmt;\n\t\t} break;\n\t\tcase 115: /* 's' seconds */\n\t\t\tif(fmt != 's' && fmt != 'ss' && fmt != '.0' && fmt != '.00' && fmt != '.000') throw 'bad second format: ' + fmt;\n\t\t\tif(val.u === 0 && (fmt == \"s\" || fmt == \"ss\")) return pad0(val.S, fmt.length);\nif(ss0 >= 2) tt = ss0 === 3 ? 1000 : 100;\n\t\t\telse tt = ss0 === 1 ? 10 : 1;\n\t\t\tss = Math.round((tt)*(val.S + val.u));\n\t\t\tif(ss >= 60*tt) ss = 0;\n\t\t\tif(fmt === 's') return ss === 0 ? \"0\" : \"\"+ss/tt;\n\t\t\to = pad0(ss,2 + ss0);\n\t\t\tif(fmt === 'ss') return o.substr(0,2);\n\t\t\treturn \".\" + o.substr(2,fmt.length-1);\n\t\tcase 90: /* 'Z' absolute time */\n\t\tswitch(fmt) {\n\t\t\tcase '[h]': case '[hh]': out = val.D*24+val.H; break;\n\t\t\tcase '[m]': case '[mm]': out = (val.D*24+val.H)*60+val.M; break;\n\t\t\tcase '[s]': case '[ss]': out = ((val.D*24+val.H)*60+val.M)*60+Math.round(val.S+val.u); break;\n\t\t\tdefault: throw 'bad abstime format: ' + fmt;\n\t\t} outl = fmt.length === 3 ? 1 : 2; break;\n\t\tcase 101: /* 'e' era */\n\t\t\tout = y; outl = 1; break;\n\t}\n\tvar outstr = outl > 0 ? pad0(out, outl) : \"\";\n\treturn outstr;\n}\n\n\n/*jshint -W086 */\n/*jshint +W086 */\nfunction commaify(s) {\n\tvar w = 3;\n\tif(s.length <= w) return s;\n\tvar j = (s.length % w), o = s.substr(0,j);\n\tfor(; j!=s.length; j+=w) o+=(o.length > 0 ? \",\" : \"\") + s.substr(j,w);\n\treturn o;\n}\nvar pct1 = /%/g;\nfunction write_num_pct(type, fmt, val){\n\tvar sfmt = fmt.replace(pct1,\"\"), mul = fmt.length - sfmt.length;\n\treturn write_num(type, sfmt, val * Math.pow(10,2*mul)) + fill(\"%\",mul);\n}\n\nfunction write_num_cm(type, fmt, val){\n\tvar idx = fmt.length - 1;\n\twhile(fmt.charCodeAt(idx-1) === 44) --idx;\n\treturn write_num(type, fmt.substr(0,idx), val / Math.pow(10,3*(fmt.length-idx)));\n}\n\nfunction write_num_exp(fmt, val){\n\tvar o;\n\tvar idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\tif(fmt.match(/^#+0.0E\\+0$/)) {\n\t\tif(val == 0) return \"0.0E+0\";\n\t\telse if(val < 0) return \"-\" + write_num_exp(fmt, -val);\n\t\tvar period = fmt.indexOf(\".\"); if(period === -1) period=fmt.indexOf('E');\n\t\tvar ee = Math.floor(Math.log(val)*Math.LOG10E)%period;\n\t\tif(ee < 0) ee += period;\n\t\to = (val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);\n\t\tif(o.indexOf(\"e\") === -1) {\n\t\t\tvar fakee = Math.floor(Math.log(val)*Math.LOG10E);\n\t\t\tif(o.indexOf(\".\") === -1) o = o.charAt(0) + \".\" + o.substr(1) + \"E+\" + (fakee - o.length+ee);\n\t\t\telse o += \"E+\" + (fakee - ee);\n\t\t\twhile(o.substr(0,2) === \"0.\") {\n\t\t\t\to = o.charAt(0) + o.substr(2,period) + \".\" + o.substr(2+period);\n\t\t\t\to = o.replace(/^0+([1-9])/,\"$1\").replace(/^0+\\./,\"0.\");\n\t\t\t}\n\t\t\to = o.replace(/\\+-/,\"-\");\n\t\t}\n\t\to = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function($$,$1,$2,$3) { return $1 + $2 + $3.substr(0,(period+ee)%period) + \".\" + $3.substr(ee) + \"E\"; });\n\t} else o = val.toExponential(idx);\n\tif(fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0,o.length-1) + \"0\" + o.charAt(o.length-1);\n\tif(fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/,\"e\");\n\treturn o.replace(\"e\",\"E\");\n}\nvar frac1 = /# (\\?+)( ?)\\/( ?)(\\d+)/;\nfunction write_num_f1(r, aval, sign) {\n\tvar den = parseInt(r[4],10), rr = Math.round(aval * den), base = Math.floor(rr/den);\n\tvar myn = (rr - base*den), myd = den;\n\treturn sign + (base === 0 ? \"\" : \"\"+base) + \" \" + (myn === 0 ? fill(\" \", r[1].length + 1 + r[4].length) : pad_(myn,r[1].length) + r[2] + \"/\" + r[3] + pad0(myd,r[4].length));\n}\nfunction write_num_f2(r, aval, sign) {\n\treturn sign + (aval === 0 ? \"\" : \"\"+aval) + fill(\" \", r[1].length + 2 + r[4].length);\n}\nvar dec1 = /^#*0*\\.([0#]+)/;\nvar closeparen = /\\).*[0#]/;\nvar phone = /\\(###\\) ###\\\\?-####/;\nfunction hashq(str) {\n\tvar o = \"\", cc;\n\tfor(var i = 0; i != str.length; ++i) switch((cc=str.charCodeAt(i))) {\n\t\tcase 35: break;\n\t\tcase 63: o+= \" \"; break;\n\t\tcase 48: o+= \"0\"; break;\n\t\tdefault: o+= String.fromCharCode(cc);\n\t}\n\treturn o;\n}\nfunction rnd(val, d) { var dd = Math.pow(10,d); return \"\"+(Math.round(val * dd)/dd); }\nfunction dec(val, d) {\n\tvar _frac = val - Math.floor(val), dd = Math.pow(10,d);\n\tif (d < ('' + Math.round(_frac * dd)).length) return 0;\n\treturn Math.round(_frac * dd);\n}\nfunction carry(val, d) {\n\tif (d < ('' + Math.round((val-Math.floor(val))*Math.pow(10,d))).length) {\n\t\treturn 1;\n\t}\n\treturn 0;\n}\nfunction flr(val) {\n\tif(val < 2147483647 && val > -2147483648) return \"\"+(val >= 0 ? (val|0) : (val-1|0));\n\treturn \"\"+Math.floor(val);\n}\nfunction write_num_flt(type, fmt, val) {\n\tif(type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n\t\tvar ffmt = fmt.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");\n\t\tif(val >= 0) return write_num_flt('n', ffmt, val);\n\t\treturn '(' + write_num_flt('n', ffmt, -val) + ')';\n\t}\n\tif(fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);\n\tif(fmt.indexOf('%') !== -1) return write_num_pct(type, fmt, val);\n\tif(fmt.indexOf('E') !== -1) return write_num_exp(fmt, val);\n\tif(fmt.charCodeAt(0) === 36) return \"$\"+write_num_flt(type,fmt.substr(fmt.charAt(1)==' '?2:1),val);\n\tvar o;\n\tvar r, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\n\tif(fmt.match(/^00+$/)) return sign + pad0r(aval,fmt.length);\n\tif(fmt.match(/^[#?]+$/)) {\n\t\to = pad0r(val,0); if(o === \"0\") o = \"\";\n\t\treturn o.length > fmt.length ? o : hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(frac1))) return write_num_f1(r, aval, sign);\n\tif(fmt.match(/^#+0+$/)) return sign + pad0r(aval,fmt.length - fmt.indexOf(\"0\"));\n\tif((r = fmt.match(dec1))) {\n\t\to = rnd(val, r[1].length).replace(/^([^\\.]+)$/,\"$1.\"+hashq(r[1])).replace(/\\.$/,\".\"+hashq(r[1])).replace(/\\.(\\d*)$/,function($$, $1) { return \".\" + $1 + fill(\"0\", hashq(r[1]).length-$1.length); });\n\t\treturn fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./,\".\");\n\t}\n\tfmt = fmt.replace(/^#+([0.])/, \"$1\");\n\tif((r = fmt.match(/^(0*)\\.(#*)$/))) {\n\t\treturn sign + rnd(aval, r[2].length).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,r[1].length?\"0.\":\".\");\n\t}\n\tif((r = fmt.match(/^#{1,3},##0(\\.?)$/))) return sign + commaify(pad0r(aval,0));\n\tif((r = fmt.match(/^#,##0\\.([#0]*0)$/))) {\n\t\treturn val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(\"\"+(Math.floor(val) + carry(val, r[1].length))) + \".\" + pad0(dec(val, r[1].length),r[1].length);\n\t}\n\tif((r = fmt.match(/^#,#*,#0/))) return write_num_flt(type,fmt.replace(/^#,#*,/,\"\"),val);\n\tif((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/))) {\n\t\to = _strrev(write_num_flt(type, fmt.replace(/[\\\\-]/g,\"\"), val));\n\t\tri = 0;\n\t\treturn _strrev(_strrev(fmt.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(x){return ri<o.length?o.charAt(ri++):x==='0'?'0':\"\";}));\n\t}\n\tif(fmt.match(phone)) {\n\t\to = write_num_flt(type, \"##########\", val);\n\t\treturn \"(\" + o.substr(0,3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n\t}\n\tvar oa = \"\";\n\tif((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(r[4].length,7);\n\t\tff = SSF_frac(aval, Math.pow(10,ri)-1, false);\n\t\to = \"\" + sign;\n\t\toa = write_num(\"n\", r[1], ff[1]);\n\t\tif(oa.charAt(oa.length-1) == \" \") oa = oa.substr(0,oa.length-1) + \"0\";\n\t\to += oa + r[2] + \"/\" + r[3];\n\t\toa = rpad_(ff[2],ri);\n\t\tif(oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length-oa.length)) + oa;\n\t\to += oa;\n\t\treturn o;\n\t}\n\tif((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(Math.max(r[1].length, r[4].length),7);\n\t\tff = SSF_frac(aval, Math.pow(10,ri)-1, true);\n\t\treturn sign + (ff[0]||(ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1],ri) + r[2] + \"/\" + r[3] + rpad_(ff[2],ri): fill(\" \", 2*ri+1 + r[2].length + r[3].length));\n\t}\n\tif((r = fmt.match(/^[#0?]+$/))) {\n\t\to = pad0r(val, 0);\n\t\tif(fmt.length <= o.length) return o;\n\t\treturn hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(/^([#0?]+)\\.([#0]+)$/))) {\n\t\to = \"\" + val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,\"$1\");\n\t\tri = o.indexOf(\".\");\n\t\tvar lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\n\t\treturn hashq(fmt.substr(0,lres) + o + fmt.substr(fmt.length-rres));\n\t}\n\tif((r = fmt.match(/^00,000\\.([#0]*0)$/))) {\n\t\tri = dec(val, r[1].length);\n\t\treturn val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(flr(val)).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function($$) { return \"00,\" + ($$.length < 3 ? pad0(0,3-$$.length) : \"\") + $$; }) + \".\" + pad0(ri,r[1].length);\n\t}\n\tswitch(fmt) {\n\t\tcase \"###,##0.00\": return write_num_flt(type, \"#,##0.00\", val);\n\t\tcase \"###,###\":\n\t\tcase \"##,###\":\n\t\tcase \"#,###\": var x = commaify(pad0r(aval,0)); return x !== \"0\" ? sign + x : \"\";\n\t\tcase \"###,###.00\": return write_num_flt(type, \"###,##0.00\",val).replace(/^0\\./,\".\");\n\t\tcase \"#,###.00\": return write_num_flt(type, \"#,##0.00\",val).replace(/^0\\./,\".\");\n\t\tdefault:\n\t}\n\tthrow new Error(\"unsupported format |\" + fmt + \"|\");\n}\nfunction write_num_cm2(type, fmt, val){\n\tvar idx = fmt.length - 1;\n\twhile(fmt.charCodeAt(idx-1) === 44) --idx;\n\treturn write_num(type, fmt.substr(0,idx), val / Math.pow(10,3*(fmt.length-idx)));\n}\nfunction write_num_pct2(type, fmt, val){\n\tvar sfmt = fmt.replace(pct1,\"\"), mul = fmt.length - sfmt.length;\n\treturn write_num(type, sfmt, val * Math.pow(10,2*mul)) + fill(\"%\",mul);\n}\nfunction write_num_exp2(fmt, val){\n\tvar o;\n\tvar idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\tif(fmt.match(/^#+0.0E\\+0$/)) {\n\t\tif(val == 0) return \"0.0E+0\";\n\t\telse if(val < 0) return \"-\" + write_num_exp2(fmt, -val);\n\t\tvar period = fmt.indexOf(\".\"); if(period === -1) period=fmt.indexOf('E');\n\t\tvar ee = Math.floor(Math.log(val)*Math.LOG10E)%period;\n\t\tif(ee < 0) ee += period;\n\t\to = (val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);\n\t\tif(!o.match(/[Ee]/)) {\n\t\t\tvar fakee = Math.floor(Math.log(val)*Math.LOG10E);\n\t\t\tif(o.indexOf(\".\") === -1) o = o.charAt(0) + \".\" + o.substr(1) + \"E+\" + (fakee - o.length+ee);\n\t\t\telse o += \"E+\" + (fakee - ee);\n\t\t\to = o.replace(/\\+-/,\"-\");\n\t\t}\n\t\to = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function($$,$1,$2,$3) { return $1 + $2 + $3.substr(0,(period+ee)%period) + \".\" + $3.substr(ee) + \"E\"; });\n\t} else o = val.toExponential(idx);\n\tif(fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0,o.length-1) + \"0\" + o.charAt(o.length-1);\n\tif(fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/,\"e\");\n\treturn o.replace(\"e\",\"E\");\n}\nfunction write_num_int(type, fmt, val) {\n\tif(type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n\t\tvar ffmt = fmt.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");\n\t\tif(val >= 0) return write_num_int('n', ffmt, val);\n\t\treturn '(' + write_num_int('n', ffmt, -val) + ')';\n\t}\n\tif(fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm2(type, fmt, val);\n\tif(fmt.indexOf('%') !== -1) return write_num_pct2(type, fmt, val);\n\tif(fmt.indexOf('E') !== -1) return write_num_exp2(fmt, val);\n\tif(fmt.charCodeAt(0) === 36) return \"$\"+write_num_int(type,fmt.substr(fmt.charAt(1)==' '?2:1),val);\n\tvar o;\n\tvar r, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\n\tif(fmt.match(/^00+$/)) return sign + pad0(aval,fmt.length);\n\tif(fmt.match(/^[#?]+$/)) {\n\t\to = (\"\"+val); if(val === 0) o = \"\";\n\t\treturn o.length > fmt.length ? o : hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(frac1))) return write_num_f2(r, aval, sign);\n\tif(fmt.match(/^#+0+$/)) return sign + pad0(aval,fmt.length - fmt.indexOf(\"0\"));\n\tif((r = fmt.match(dec1))) {\no = (\"\"+val).replace(/^([^\\.]+)$/,\"$1.\"+hashq(r[1])).replace(/\\.$/,\".\"+hashq(r[1]));\n\t\to = o.replace(/\\.(\\d*)$/,function($$, $1) {\nreturn \".\" + $1 + fill(\"0\", hashq(r[1]).length-$1.length); });\n\t\treturn fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./,\".\");\n\t}\n\tfmt = fmt.replace(/^#+([0.])/, \"$1\");\n\tif((r = fmt.match(/^(0*)\\.(#*)$/))) {\n\t\treturn sign + (\"\"+aval).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,r[1].length?\"0.\":\".\");\n\t}\n\tif((r = fmt.match(/^#{1,3},##0(\\.?)$/))) return sign + commaify((\"\"+aval));\n\tif((r = fmt.match(/^#,##0\\.([#0]*0)$/))) {\n\t\treturn val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify((\"\"+val)) + \".\" + fill('0',r[1].length);\n\t}\n\tif((r = fmt.match(/^#,#*,#0/))) return write_num_int(type,fmt.replace(/^#,#*,/,\"\"),val);\n\tif((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/))) {\n\t\to = _strrev(write_num_int(type, fmt.replace(/[\\\\-]/g,\"\"), val));\n\t\tri = 0;\n\t\treturn _strrev(_strrev(fmt.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(x){return ri<o.length?o.charAt(ri++):x==='0'?'0':\"\";}));\n\t}\n\tif(fmt.match(phone)) {\n\t\to = write_num_int(type, \"##########\", val);\n\t\treturn \"(\" + o.substr(0,3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n\t}\n\tvar oa = \"\";\n\tif((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(r[4].length,7);\n\t\tff = SSF_frac(aval, Math.pow(10,ri)-1, false);\n\t\to = \"\" + sign;\n\t\toa = write_num(\"n\", r[1], ff[1]);\n\t\tif(oa.charAt(oa.length-1) == \" \") oa = oa.substr(0,oa.length-1) + \"0\";\n\t\to += oa + r[2] + \"/\" + r[3];\n\t\toa = rpad_(ff[2],ri);\n\t\tif(oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length-oa.length)) + oa;\n\t\to += oa;\n\t\treturn o;\n\t}\n\tif((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(Math.max(r[1].length, r[4].length),7);\n\t\tff = SSF_frac(aval, Math.pow(10,ri)-1, true);\n\t\treturn sign + (ff[0]||(ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1],ri) + r[2] + \"/\" + r[3] + rpad_(ff[2],ri): fill(\" \", 2*ri+1 + r[2].length + r[3].length));\n\t}\n\tif((r = fmt.match(/^[#0?]+$/))) {\n\t\to = \"\" + val;\n\t\tif(fmt.length <= o.length) return o;\n\t\treturn hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(/^([#0]+)\\.([#0]+)$/))) {\n\t\to = \"\" + val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,\"$1\");\n\t\tri = o.indexOf(\".\");\n\t\tvar lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\n\t\treturn hashq(fmt.substr(0,lres) + o + fmt.substr(fmt.length-rres));\n\t}\n\tif((r = fmt.match(/^00,000\\.([#0]*0)$/))) {\n\t\treturn val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\"+val).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function($$) { return \"00,\" + ($$.length < 3 ? pad0(0,3-$$.length) : \"\") + $$; }) + \".\" + pad0(0,r[1].length);\n\t}\n\tswitch(fmt) {\n\t\tcase \"###,###\":\n\t\tcase \"##,###\":\n\t\tcase \"#,###\": var x = commaify(\"\"+aval); return x !== \"0\" ? sign + x : \"\";\n\t\tdefault:\n\t\t\tif(fmt.match(/\\.[0#?]*$/)) return write_num_int(type, fmt.slice(0,fmt.lastIndexOf(\".\")), val) + hashq(fmt.slice(fmt.lastIndexOf(\".\")));\n\t}\n\tthrow new Error(\"unsupported format |\" + fmt + \"|\");\n}\nfunction write_num(type, fmt, val) {\n\treturn (val|0) === val ? write_num_int(type, fmt, val) : write_num_flt(type, fmt, val);\n}\nfunction SSF_split_fmt(fmt) {\n\tvar out = [];\n\tvar in_str = false/*, cc*/;\n\tfor(var i = 0, j = 0; i < fmt.length; ++i) switch((/*cc=*/fmt.charCodeAt(i))) {\n\t\tcase 34: /* '\"' */\n\t\t\tin_str = !in_str; break;\n\t\tcase 95: case 42: case 92: /* '_' '*' '\\\\' */\n\t\t\t++i; break;\n\t\tcase 59: /* ';' */\n\t\t\tout[out.length] = fmt.substr(j,i-j);\n\t\t\tj = i+1;\n\t}\n\tout[out.length] = fmt.substr(j);\n\tif(in_str === true) throw new Error(\"Format |\" + fmt + \"| unterminated string \");\n\treturn out;\n}\n\nvar SSF_abstime = /\\[[HhMmSs\\u0E0A\\u0E19\\u0E17]*\\]/;\nfunction fmt_is_date(fmt) {\n\tvar i = 0, /*cc = 0,*/ c = \"\", o = \"\";\n\twhile(i < fmt.length) {\n\t\tswitch((c = fmt.charAt(i))) {\n\t\t\tcase 'G': if(SSF_isgeneral(fmt, i)) i+= 6; i++; break;\n\t\t\tcase '\"': for(;(/*cc=*/fmt.charCodeAt(++i)) !== 34 && i < fmt.length;){/*empty*/} ++i; break;\n\t\t\tcase '\\\\': i+=2; break;\n\t\t\tcase '_': i+=2; break;\n\t\t\tcase '@': ++i; break;\n\t\t\tcase 'B': case 'b':\n\t\t\t\tif(fmt.charAt(i+1) === \"1\" || fmt.charAt(i+1) === \"2\") return true;\n\t\t\t\t/* falls through */\n\t\t\tcase 'M': case 'D': case 'Y': case 'H': case 'S': case 'E':\n\t\t\t\t/* falls through */\n\t\t\tcase 'm': case 'd': case 'y': case 'h': case 's': case 'e': case 'g': return true;\n\t\t\tcase 'A': case 'a': case '上':\n\t\t\t\tif(fmt.substr(i, 3).toUpperCase() === \"A/P\") return true;\n\t\t\t\tif(fmt.substr(i, 5).toUpperCase() === \"AM/PM\") return true;\n\t\t\t\tif(fmt.substr(i, 5).toUpperCase() === \"上午/下午\") return true;\n\t\t\t\t++i; break;\n\t\t\tcase '[':\n\t\t\t\to = c;\n\t\t\t\twhile(fmt.charAt(i++) !== ']' && i < fmt.length) o += fmt.charAt(i);\n\t\t\t\tif(o.match(SSF_abstime)) return true;\n\t\t\t\tbreak;\n\t\t\tcase '.':\n\t\t\t\t/* falls through */\n\t\t\tcase '0': case '#':\n\t\t\t\twhile(i < fmt.length && (\"0#?.,E+-%\".indexOf(c=fmt.charAt(++i)) > -1 || (c=='\\\\' && fmt.charAt(i+1) == \"-\" && \"0#\".indexOf(fmt.charAt(i+2))>-1))){/* empty */}\n\t\t\t\tbreak;\n\t\t\tcase '?': while(fmt.charAt(++i) === c){/* empty */} break;\n\t\t\tcase '*': ++i; if(fmt.charAt(i) == ' ' || fmt.charAt(i) == '*') ++i; break;\n\t\t\tcase '(': case ')': ++i; break;\n\t\t\tcase '1': case '2': case '3': case '4': case '5': case '6': case '7': case '8': case '9':\n\t\t\t\twhile(i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1){/* empty */} break;\n\t\t\tcase ' ': ++i; break;\n\t\t\tdefault: ++i; break;\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction eval_fmt(fmt, v, opts, flen) {\n\tvar out = [], o = \"\", i = 0, c = \"\", lst='t', dt, j, cc;\n\tvar hr='H';\n\t/* Tokenize */\n\twhile(i < fmt.length) {\n\t\tswitch((c = fmt.charAt(i))) {\n\t\t\tcase 'G': /* General */\n\t\t\t\tif(!SSF_isgeneral(fmt, i)) throw new Error('unrecognized character ' + c + ' in ' +fmt);\n\t\t\t\tout[out.length] = {t:'G', v:'General'}; i+=7; break;\n\t\t\tcase '\"': /* Literal text */\n\t\t\t\tfor(o=\"\";(cc=fmt.charCodeAt(++i)) !== 34 && i < fmt.length;) o += String.fromCharCode(cc);\n\t\t\t\tout[out.length] = {t:'t', v:o}; ++i; break;\n\t\t\tcase '\\\\': var w = fmt.charAt(++i), t = (w === \"(\" || w === \")\") ? w : 't';\n\t\t\t\tout[out.length] = {t:t, v:w}; ++i; break;\n\t\t\tcase '_': out[out.length] = {t:'t', v:\" \"}; i+=2; break;\n\t\t\tcase '@': /* Text Placeholder */\n\t\t\t\tout[out.length] = {t:'T', v:v}; ++i; break;\n\t\t\tcase 'B': case 'b':\n\t\t\t\tif(fmt.charAt(i+1) === \"1\" || fmt.charAt(i+1) === \"2\") {\n\t\t\t\t\tif(dt==null) { dt=SSF_parse_date_code(v, opts, fmt.charAt(i+1) === \"2\"); if(dt==null) return \"\"; }\n\t\t\t\t\tout[out.length] = {t:'X', v:fmt.substr(i,2)}; lst = c; i+=2; break;\n\t\t\t\t}\n\t\t\t\t/* falls through */\n\t\t\tcase 'M': case 'D': case 'Y': case 'H': case 'S': case 'E':\n\t\t\t\tc = c.toLowerCase();\n\t\t\t\t/* falls through */\n\t\t\tcase 'm': case 'd': case 'y': case 'h': case 's': case 'e': case 'g':\n\t\t\t\tif(v < 0) return \"\";\n\t\t\t\tif(dt==null) { dt=SSF_parse_date_code(v, opts); if(dt==null) return \"\"; }\n\t\t\t\to = c; while(++i < fmt.length && fmt.charAt(i).toLowerCase() === c) o+=c;\n\t\t\t\tif(c === 'm' && lst.toLowerCase() === 'h') c = 'M';\n\t\t\t\tif(c === 'h') c = hr;\n\t\t\t\tout[out.length] = {t:c, v:o}; lst = c; break;\n\t\t\tcase 'A': case 'a': case '上':\n\t\t\t\tvar q={t:c, v:c};\n\t\t\t\tif(dt==null) dt=SSF_parse_date_code(v, opts);\n\t\t\t\tif(fmt.substr(i, 3).toUpperCase() === \"A/P\") { if(dt!=null) q.v = dt.H >= 12 ? \"P\" : \"A\"; q.t = 'T'; hr='h';i+=3;}\n\t\t\t\telse if(fmt.substr(i,5).toUpperCase() === \"AM/PM\") { if(dt!=null) q.v = dt.H >= 12 ? \"PM\" : \"AM\"; q.t = 'T'; i+=5; hr='h'; }\n\t\t\t\telse if(fmt.substr(i,5).toUpperCase() === \"上午/下午\") { if(dt!=null) q.v = dt.H >= 12 ? \"下午\" : \"上午\"; q.t = 'T'; i+=5; hr='h'; }\n\t\t\t\telse { q.t = \"t\"; ++i; }\n\t\t\t\tif(dt==null && q.t === 'T') return \"\";\n\t\t\t\tout[out.length] = q; lst = c; break;\n\t\t\tcase '[':\n\t\t\t\to = c;\n\t\t\t\twhile(fmt.charAt(i++) !== ']' && i < fmt.length) o += fmt.charAt(i);\n\t\t\t\tif(o.slice(-1) !== ']') throw 'unterminated \"[\" block: |' + o + '|';\n\t\t\t\tif(o.match(SSF_abstime)) {\n\t\t\t\t\tif(dt==null) { dt=SSF_parse_date_code(v, opts); if(dt==null) return \"\"; }\n\t\t\t\t\tout[out.length] = {t:'Z', v:o.toLowerCase()};\n\t\t\t\t\tlst = o.charAt(1);\n\t\t\t\t} else if(o.indexOf(\"$\") > -1) {\n\t\t\t\t\to = (o.match(/\\$([^-\\[\\]]*)/)||[])[1]||\"$\";\n\t\t\t\t\tif(!fmt_is_date(fmt)) out[out.length] = {t:'t',v:o};\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t/* Numbers */\n\t\t\tcase '.':\n\t\t\t\tif(dt != null) {\n\t\t\t\t\to = c; while(++i < fmt.length && (c=fmt.charAt(i)) === \"0\") o += c;\n\t\t\t\t\tout[out.length] = {t:'s', v:o}; break;\n\t\t\t\t}\n\t\t\t\t/* falls through */\n\t\t\tcase '0': case '#':\n\t\t\t\to = c; while(++i < fmt.length && \"0#?.,E+-%\".indexOf(c=fmt.charAt(i)) > -1) o += c;\n\t\t\t\tout[out.length] = {t:'n', v:o}; break;\n\t\t\tcase '?':\n\t\t\t\to = c; while(fmt.charAt(++i) === c) o+=c;\n\t\t\t\tout[out.length] = {t:c, v:o}; lst = c; break;\n\t\t\tcase '*': ++i; if(fmt.charAt(i) == ' ' || fmt.charAt(i) == '*') ++i; break; // **\n\t\t\tcase '(': case ')': out[out.length] = {t:(flen===1?'t':c), v:c}; ++i; break;\n\t\t\tcase '1': case '2': case '3': case '4': case '5': case '6': case '7': case '8': case '9':\n\t\t\t\to = c; while(i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1) o+=fmt.charAt(i);\n\t\t\t\tout[out.length] = {t:'D', v:o}; break;\n\t\t\tcase ' ': out[out.length] = {t:c, v:c}; ++i; break;\n\t\t\tcase '$': out[out.length] = {t:'t', v:'$'}; ++i; break;\n\t\t\tdefault:\n\t\t\t\tif(\",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP\".indexOf(c) === -1) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n\t\t\t\tout[out.length] = {t:'t', v:c}; ++i; break;\n\t\t}\n\t}\n\n\t/* Scan for date/time parts */\n\tvar bt = 0, ss0 = 0, ssm;\n\tfor(i=out.length-1, lst='t'; i >= 0; --i) {\n\t\tswitch(out[i].t) {\n\t\t\tcase 'h': case 'H': out[i].t = hr; lst='h'; if(bt < 1) bt = 1; break;\n\t\t\tcase 's':\n\t\t\t\tif((ssm=out[i].v.match(/\\.0+$/))) ss0=Math.max(ss0,ssm[0].length-1);\n\t\t\t\tif(bt < 3) bt = 3;\n\t\t\t/* falls through */\n\t\t\tcase 'd': case 'y': case 'M': case 'e': lst=out[i].t; break;\n\t\t\tcase 'm': if(lst === 's') { out[i].t = 'M'; if(bt < 2) bt = 2; } break;\n\t\t\tcase 'X': /*if(out[i].v === \"B2\");*/\n\t\t\t\tbreak;\n\t\t\tcase 'Z':\n\t\t\t\tif(bt < 1 && out[i].v.match(/[Hh]/)) bt = 1;\n\t\t\t\tif(bt < 2 && out[i].v.match(/[Mm]/)) bt = 2;\n\t\t\t\tif(bt < 3 && out[i].v.match(/[Ss]/)) bt = 3;\n\t\t}\n\t}\n\t/* time rounding depends on presence of minute / second / usec fields */\n\tswitch(bt) {\n\t\tcase 0: break;\n\t\tcase 1:\nif(dt.u >= 0.5) { dt.u = 0; ++dt.S; }\n\t\t\tif(dt.S >=  60) { dt.S = 0; ++dt.M; }\n\t\t\tif(dt.M >=  60) { dt.M = 0; ++dt.H; }\n\t\t\tbreak;\n\t\tcase 2:\nif(dt.u >= 0.5) { dt.u = 0; ++dt.S; }\n\t\t\tif(dt.S >=  60) { dt.S = 0; ++dt.M; }\n\t\t\tbreak;\n\t}\n\n\t/* replace fields */\n\tvar nstr = \"\", jj;\n\tfor(i=0; i < out.length; ++i) {\n\t\tswitch(out[i].t) {\n\t\t\tcase 't': case 'T': case ' ': case 'D': break;\n\t\t\tcase 'X': out[i].v = \"\"; out[i].t = \";\"; break;\n\t\t\tcase 'd': case 'm': case 'y': case 'h': case 'H': case 'M': case 's': case 'e': case 'b': case 'Z':\nout[i].v = SSF_write_date(out[i].t.charCodeAt(0), out[i].v, dt, ss0);\n\t\t\t\tout[i].t = 't'; break;\n\t\t\tcase 'n': case '?':\n\t\t\t\tjj = i+1;\n\t\t\t\twhile(out[jj] != null && (\n\t\t\t\t\t(c=out[jj].t) === \"?\" || c === \"D\" ||\n\t\t\t\t\t((c === \" \" || c === \"t\") && out[jj+1] != null && (out[jj+1].t === '?' || out[jj+1].t === \"t\" && out[jj+1].v === '/')) ||\n\t\t\t\t\t(out[i].t === '(' && (c === ' ' || c === 'n' || c === ')')) ||\n\t\t\t\t\t(c === 't' && (out[jj].v === '/' || out[jj].v === ' ' && out[jj+1] != null && out[jj+1].t == '?'))\n\t\t\t\t)) {\n\t\t\t\t\tout[i].v += out[jj].v;\n\t\t\t\t\tout[jj] = {v:\"\", t:\";\"}; ++jj;\n\t\t\t\t}\n\t\t\t\tnstr += out[i].v;\n\t\t\t\ti = jj-1; break;\n\t\t\tcase 'G': out[i].t = 't'; out[i].v = SSF_general(v,opts); break;\n\t\t}\n\t}\n\tvar vv = \"\", myv, ostr;\n\tif(nstr.length > 0) {\n\t\tif(nstr.charCodeAt(0) == 40) /* '(' */ {\n\t\t\tmyv = (v<0&&nstr.charCodeAt(0) === 45 ? -v : v);\n\t\t\tostr = write_num('n', nstr, myv);\n\t\t} else {\n\t\t\tmyv = (v<0 && flen > 1 ? -v : v);\n\t\t\tostr = write_num('n', nstr, myv);\n\t\t\tif(myv < 0 && out[0] && out[0].t == 't') {\n\t\t\t\tostr = ostr.substr(1);\n\t\t\t\tout[0].v = \"-\" + out[0].v;\n\t\t\t}\n\t\t}\n\t\tjj=ostr.length-1;\n\t\tvar decpt = out.length;\n\t\tfor(i=0; i < out.length; ++i) if(out[i] != null && out[i].t != 't' && out[i].v.indexOf(\".\") > -1) { decpt = i; break; }\n\t\tvar lasti=out.length;\n\t\tif(decpt === out.length && ostr.indexOf(\"E\") === -1) {\n\t\t\tfor(i=out.length-1; i>= 0;--i) {\n\t\t\t\tif(out[i] == null || 'n?'.indexOf(out[i].t) === -1) continue;\n\t\t\t\tif(jj>=out[i].v.length-1) { jj -= out[i].v.length; out[i].v = ostr.substr(jj+1, out[i].v.length); }\n\t\t\t\telse if(jj < 0) out[i].v = \"\";\n\t\t\t\telse { out[i].v = ostr.substr(0, jj+1); jj = -1; }\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t\tif(jj>=0 && lasti<out.length) out[lasti].v = ostr.substr(0,jj+1) + out[lasti].v;\n\t\t}\n\t\telse if(decpt !== out.length && ostr.indexOf(\"E\") === -1) {\n\t\t\tjj = ostr.indexOf(\".\")-1;\n\t\t\tfor(i=decpt; i>= 0; --i) {\n\t\t\t\tif(out[i] == null || 'n?'.indexOf(out[i].t) === -1) continue;\n\t\t\t\tj=out[i].v.indexOf(\".\")>-1&&i===decpt?out[i].v.indexOf(\".\")-1:out[i].v.length-1;\n\t\t\t\tvv = out[i].v.substr(j+1);\n\t\t\t\tfor(; j>=0; --j) {\n\t\t\t\t\tif(jj>=0 && (out[i].v.charAt(j) === \"0\" || out[i].v.charAt(j) === \"#\")) vv = ostr.charAt(jj--) + vv;\n\t\t\t\t}\n\t\t\t\tout[i].v = vv;\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t\tif(jj>=0 && lasti<out.length) out[lasti].v = ostr.substr(0,jj+1) + out[lasti].v;\n\t\t\tjj = ostr.indexOf(\".\")+1;\n\t\t\tfor(i=decpt; i<out.length; ++i) {\n\t\t\t\tif(out[i] == null || ('n?('.indexOf(out[i].t) === -1 && i !== decpt)) continue;\n\t\t\t\tj=out[i].v.indexOf(\".\")>-1&&i===decpt?out[i].v.indexOf(\".\")+1:0;\n\t\t\t\tvv = out[i].v.substr(0,j);\n\t\t\t\tfor(; j<out[i].v.length; ++j) {\n\t\t\t\t\tif(jj<ostr.length) vv += ostr.charAt(jj++);\n\t\t\t\t}\n\t\t\t\tout[i].v = vv;\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t}\n\t}\n\tfor(i=0; i<out.length; ++i) if(out[i] != null && 'n?'.indexOf(out[i].t)>-1) {\n\t\tmyv = (flen >1 && v < 0 && i>0 && out[i-1].v === \"-\" ? -v:v);\n\t\tout[i].v = write_num(out[i].t, out[i].v, myv);\n\t\tout[i].t = 't';\n\t}\n\tvar retval = \"\";\n\tfor(i=0; i !== out.length; ++i) if(out[i] != null) retval += out[i].v;\n\treturn retval;\n}\n\nvar cfregex2 = /\\[(=|>[=]?|<[>=]?)(-?\\d+(?:\\.\\d*)?)\\]/;\nfunction chkcond(v, rr) {\n\tif(rr == null) return false;\n\tvar thresh = parseFloat(rr[2]);\n\tswitch(rr[1]) {\n\t\tcase \"=\":  if(v == thresh) return true; break;\n\t\tcase \">\":  if(v >  thresh) return true; break;\n\t\tcase \"<\":  if(v <  thresh) return true; break;\n\t\tcase \"<>\": if(v != thresh) return true; break;\n\t\tcase \">=\": if(v >= thresh) return true; break;\n\t\tcase \"<=\": if(v <= thresh) return true; break;\n\t}\n\treturn false;\n}\nfunction choose_fmt(f, v) {\n\tvar fmt = SSF_split_fmt(f);\n\tvar l = fmt.length, lat = fmt[l-1].indexOf(\"@\");\n\tif(l<4 && lat>-1) --l;\n\tif(fmt.length > 4) throw new Error(\"cannot find right format for |\" + fmt.join(\"|\") + \"|\");\n\tif(typeof v !== \"number\") return [4, fmt.length === 4 || lat>-1?fmt[fmt.length-1]:\"@\"];\n\tswitch(fmt.length) {\n\t\tcase 1: fmt = lat>-1 ? [\"General\", \"General\", \"General\", fmt[0]] : [fmt[0], fmt[0], fmt[0], \"@\"]; break;\n\t\tcase 2: fmt = lat>-1 ? [fmt[0], fmt[0], fmt[0], fmt[1]] : [fmt[0], fmt[1], fmt[0], \"@\"]; break;\n\t\tcase 3: fmt = lat>-1 ? [fmt[0], fmt[1], fmt[0], fmt[2]] : [fmt[0], fmt[1], fmt[2], \"@\"]; break;\n\t\tcase 4: break;\n\t}\n\tvar ff = v > 0 ? fmt[0] : v < 0 ? fmt[1] : fmt[2];\n\tif(fmt[0].indexOf(\"[\") === -1 && fmt[1].indexOf(\"[\") === -1) return [l, ff];\n\tif(fmt[0].match(/\\[[=<>]/) != null || fmt[1].match(/\\[[=<>]/) != null) {\n\t\tvar m1 = fmt[0].match(cfregex2);\n\t\tvar m2 = fmt[1].match(cfregex2);\n\t\treturn chkcond(v, m1) ? [l, fmt[0]] : chkcond(v, m2) ? [l, fmt[1]] : [l, fmt[m1 != null && m2 != null ? 2 : 1]];\n\t}\n\treturn [l, ff];\n}\nfunction SSF_format(fmt,v,o) {\n\tif(o == null) o = {};\n\tvar sfmt = \"\";\n\tswitch(typeof fmt) {\n\t\tcase \"string\":\n\t\t\tif(fmt == \"m/d/yy\" && o.dateNF) sfmt = o.dateNF;\n\t\t\telse sfmt = fmt;\n\t\t\tbreak;\n\t\tcase \"number\":\n\t\t\tif(fmt == 14 && o.dateNF) sfmt = o.dateNF;\n\t\t\telse sfmt = (o.table != null ? (o.table) : table_fmt)[fmt];\n\t\t\tif(sfmt == null) sfmt = (o.table && o.table[SSF_default_map[fmt]]) || table_fmt[SSF_default_map[fmt]];\n\t\t\tif(sfmt == null) sfmt = SSF_default_str[fmt] || \"General\";\n\t\t\tbreak;\n\t}\n\tif(SSF_isgeneral(sfmt,0)) return SSF_general(v, o);\n\tif(v instanceof Date) v = datenum_local(v, o.date1904);\n\tvar f = choose_fmt(sfmt, v);\n\tif(SSF_isgeneral(f[1])) return SSF_general(v, o);\n\tif(v === true) v = \"TRUE\"; else if(v === false) v = \"FALSE\";\n\telse if(v === \"\" || v == null) return \"\";\n\treturn eval_fmt(f[1], v, o, f[0]);\n}\nfunction SSF_load(fmt, idx) {\n\tif(typeof idx != 'number') {\n\t\tidx = +idx || -1;\nfor(var i = 0; i < 0x0188; ++i) {\nif(table_fmt[i] == undefined) { if(idx < 0) idx = i; continue; }\n\t\t\tif(table_fmt[i] == fmt) { idx = i; break; }\n\t\t}\nif(idx < 0) idx = 0x187;\n\t}\ntable_fmt[idx] = fmt;\n\treturn idx;\n}\nfunction SSF_load_table(tbl) {\n\tfor(var i=0; i!=0x0188; ++i)\n\t\tif(tbl[i] !== undefined) SSF_load(tbl[i], i);\n}\n\nfunction make_ssf() {\n\ttable_fmt = SSF_init_table();\n}\n\nvar SSF = {\n\tformat: SSF_format,\n\tload: SSF_load,\n\t_table: table_fmt,\n\tload_table: SSF_load_table,\n\tparse_date_code: SSF_parse_date_code,\n\tis_date: fmt_is_date,\n\tget_table: function get_table() { return SSF._table = table_fmt; }\n};\n\nvar SSFImplicit/*{[number]:string}*/ = ({\n\t\"5\": '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\t\"6\": '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\t\"7\": '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\t\"8\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t\"23\": 'General', \"24\": 'General', \"25\": 'General', \"26\": 'General',\n\t\"27\": 'm/d/yy', \"28\": 'm/d/yy', \"29\": 'm/d/yy', \"30\": 'm/d/yy', \"31\": 'm/d/yy',\n\t\"32\": 'h:mm:ss', \"33\": 'h:mm:ss', \"34\": 'h:mm:ss', \"35\": 'h:mm:ss',\n\t\"36\": 'm/d/yy',\n\t\"41\": '_(* #,##0_);_(* \\(#,##0\\);_(* \"-\"_);_(@_)',\n\t\"42\": '_(\"$\"* #,##0_);_(\"$\"* \\(#,##0\\);_(\"$\"* \"-\"_);_(@_)',\n\t\"43\": '_(* #,##0.00_);_(* \\(#,##0.00\\);_(* \"-\"??_);_(@_)',\n\t\"44\": '_(\"$\"* #,##0.00_);_(\"$\"* \\(#,##0.00\\);_(\"$\"* \"-\"??_);_(@_)',\n\t\"50\": 'm/d/yy', \"51\": 'm/d/yy', \"52\": 'm/d/yy', \"53\": 'm/d/yy', \"54\": 'm/d/yy',\n\t\"55\": 'm/d/yy', \"56\": 'm/d/yy', \"57\": 'm/d/yy', \"58\": 'm/d/yy',\n\t\"59\": '0',\n\t\"60\": '0.00',\n\t\"61\": '#,##0',\n\t\"62\": '#,##0.00',\n\t\"63\": '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\t\"64\": '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\t\"65\": '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\t\"66\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t\"67\": '0%',\n\t\"68\": '0.00%',\n\t\"69\": '# ?/?',\n\t\"70\": '# ??/??',\n\t\"71\": 'm/d/yy',\n\t\"72\": 'm/d/yy',\n\t\"73\": 'd-mmm-yy',\n\t\"74\": 'd-mmm',\n\t\"75\": 'mmm-yy',\n\t\"76\": 'h:mm',\n\t\"77\": 'h:mm:ss',\n\t\"78\": 'm/d/yy h:mm',\n\t\"79\": 'mm:ss',\n\t\"80\": '[h]:mm:ss',\n\t\"81\": 'mmss.0'\n});\n\n/* dateNF parse TODO: move to SSF */\nvar dateNFregex = /[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;\nfunction dateNF_regex(dateNF) {\n\tvar fmt = typeof dateNF == \"number\" ? table_fmt[dateNF] : dateNF;\n\tfmt = fmt.replace(dateNFregex, \"(\\\\d+)\");\n\treturn new RegExp(\"^\" + fmt + \"$\");\n}\nfunction dateNF_fix(str, dateNF, match) {\n\tvar Y = -1, m = -1, d = -1, H = -1, M = -1, S = -1;\n\t(dateNF.match(dateNFregex)||[]).forEach(function(n, i) {\n\t\tvar v = parseInt(match[i+1], 10);\n\t\tswitch(n.toLowerCase().charAt(0)) {\n\t\t\tcase 'y': Y = v; break; case 'd': d = v; break;\n\t\t\tcase 'h': H = v; break; case 's': S = v; break;\n\t\t\tcase 'm': if(H >= 0) M = v; else m = v; break;\n\t\t}\n\t});\n\tif(S >= 0 && M == -1 && m >= 0) { M = m; m = -1; }\n\tvar datestr = ((\"\" + (Y>=0?Y: new Date().getFullYear())).slice(-4) + \"-\" + (\"00\" + (m>=1?m:1)).slice(-2) + \"-\" + (\"00\" + (d>=1?d:1)).slice(-2));\n\tif(datestr.length == 7) datestr = \"0\" + datestr;\n\tif(datestr.length == 8) datestr = \"20\" + datestr;\n\tvar timestr = ((\"00\" + (H>=0?H:0)).slice(-2) + \":\" + (\"00\" + (M>=0?M:0)).slice(-2) + \":\" + (\"00\" + (S>=0?S:0)).slice(-2));\n\tif(H == -1 && M == -1 && S == -1) return datestr;\n\tif(Y == -1 && m == -1 && d == -1) return timestr;\n\treturn datestr + \"T\" + timestr;\n}\n\n/* cfb.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*jshint eqnull:true */\n/*exported CFB */\n/*global Uint8Array:false, Uint16Array:false */\n\n/* crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*exported CRC32 */\nvar CRC32 = (function() {\nvar CRC32 = {};\nCRC32.version = '1.2.0';\n/* see perf/crc32table.js */\n/*global Int32Array */\nfunction signed_crc_table() {\n\tvar c = 0, table = new Array(256);\n\n\tfor(var n =0; n != 256; ++n){\n\t\tc = n;\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\ttable[n] = c;\n\t}\n\n\treturn typeof Int32Array !== 'undefined' ? new Int32Array(table) : table;\n}\n\nvar T0 = signed_crc_table();\nfunction slice_by_16_tables(T) {\n\tvar c = 0, v = 0, n = 0, table = typeof Int32Array !== 'undefined' ? new Int32Array(4096) : new Array(4096) ;\n\n\tfor(n = 0; n != 256; ++n) table[n] = T[n];\n\tfor(n = 0; n != 256; ++n) {\n\t\tv = T[n];\n\t\tfor(c = 256 + n; c < 4096; c += 256) v = table[c] = (v >>> 8) ^ T[v & 0xFF];\n\t}\n\tvar out = [];\n\tfor(n = 1; n != 16; ++n) out[n - 1] = typeof Int32Array !== 'undefined' ? table.subarray(n * 256, n * 256 + 256) : table.slice(n * 256, n * 256 + 256);\n\treturn out;\n}\nvar TT = slice_by_16_tables(T0);\nvar T1 = TT[0],  T2 = TT[1],  T3 = TT[2],  T4 = TT[3],  T5 = TT[4];\nvar T6 = TT[5],  T7 = TT[6],  T8 = TT[7],  T9 = TT[8],  Ta = TT[9];\nvar Tb = TT[10], Tc = TT[11], Td = TT[12], Te = TT[13], Tf = TT[14];\nfunction crc32_bstr(bstr, seed) {\n\tvar C = seed ^ -1;\n\tfor(var i = 0, L = bstr.length; i < L;) C = (C>>>8) ^ T0[(C^bstr.charCodeAt(i++))&0xFF];\n\treturn ~C;\n}\n\nfunction crc32_buf(B, seed) {\n\tvar C = seed ^ -1, L = B.length - 15, i = 0;\n\tfor(; i < L;) C =\n\t\tTf[B[i++] ^ (C & 255)] ^\n\t\tTe[B[i++] ^ ((C >> 8) & 255)] ^\n\t\tTd[B[i++] ^ ((C >> 16) & 255)] ^\n\t\tTc[B[i++] ^ (C >>> 24)] ^\n\t\tTb[B[i++]] ^ Ta[B[i++]] ^ T9[B[i++]] ^ T8[B[i++]] ^\n\t\tT7[B[i++]] ^ T6[B[i++]] ^ T5[B[i++]] ^ T4[B[i++]] ^\n\t\tT3[B[i++]] ^ T2[B[i++]] ^ T1[B[i++]] ^ T0[B[i++]];\n\tL += 15;\n\twhile(i < L) C = (C>>>8) ^ T0[(C^B[i++])&0xFF];\n\treturn ~C;\n}\n\nfunction crc32_str(str, seed) {\n\tvar C = seed ^ -1;\n\tfor(var i = 0, L = str.length, c = 0, d = 0; i < L;) {\n\t\tc = str.charCodeAt(i++);\n\t\tif(c < 0x80) {\n\t\t\tC = (C>>>8) ^ T0[(C^c)&0xFF];\n\t\t} else if(c < 0x800) {\n\t\t\tC = (C>>>8) ^ T0[(C ^ (192|((c>>6)&31)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|(c&63)))&0xFF];\n\t\t} else if(c >= 0xD800 && c < 0xE000) {\n\t\t\tc = (c&1023)+64; d = str.charCodeAt(i++)&1023;\n\t\t\tC = (C>>>8) ^ T0[(C ^ (240|((c>>8)&7)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|((c>>2)&63)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|((d>>6)&15)|((c&3)<<4)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|(d&63)))&0xFF];\n\t\t} else {\n\t\t\tC = (C>>>8) ^ T0[(C ^ (224|((c>>12)&15)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|((c>>6)&63)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|(c&63)))&0xFF];\n\t\t}\n\t}\n\treturn ~C;\n}\nCRC32.table = T0;\nCRC32.bstr = crc32_bstr;\nCRC32.buf = crc32_buf;\nCRC32.str = crc32_str;\nreturn CRC32;\n})();\n/* [MS-CFB] v20171201 */\nvar CFB = (function _CFB(){\nvar exports = {};\nexports.version = '1.2.1';\n/* [MS-CFB] 2.6.4 */\nfunction namecmp(l, r) {\n\tvar L = l.split(\"/\"), R = r.split(\"/\");\n\tfor(var i = 0, c = 0, Z = Math.min(L.length, R.length); i < Z; ++i) {\n\t\tif((c = L[i].length - R[i].length)) return c;\n\t\tif(L[i] != R[i]) return L[i] < R[i] ? -1 : 1;\n\t}\n\treturn L.length - R.length;\n}\nfunction dirname(p) {\n\tif(p.charAt(p.length - 1) == \"/\") return (p.slice(0,-1).indexOf(\"/\") === -1) ? p : dirname(p.slice(0, -1));\n\tvar c = p.lastIndexOf(\"/\");\n\treturn (c === -1) ? p : p.slice(0, c+1);\n}\n\nfunction filename(p) {\n\tif(p.charAt(p.length - 1) == \"/\") return filename(p.slice(0, -1));\n\tvar c = p.lastIndexOf(\"/\");\n\treturn (c === -1) ? p : p.slice(c+1);\n}\n/* -------------------------------------------------------------------------- */\n/* DOS Date format:\n   high|YYYYYYYm.mmmddddd.HHHHHMMM.MMMSSSSS|low\n   add 1980 to stored year\n   stored second should be doubled\n*/\n\n/* write JS date to buf as a DOS date */\nfunction write_dos_date(buf, date) {\n\tif(typeof date === \"string\") date = new Date(date);\n\tvar hms = date.getHours();\n\thms = hms << 6 | date.getMinutes();\n\thms = hms << 5 | (date.getSeconds()>>>1);\n\tbuf.write_shift(2, hms);\n\tvar ymd = (date.getFullYear() - 1980);\n\tymd = ymd << 4 | (date.getMonth()+1);\n\tymd = ymd << 5 | date.getDate();\n\tbuf.write_shift(2, ymd);\n}\n\n/* read four bytes from buf and interpret as a DOS date */\nfunction parse_dos_date(buf) {\n\tvar hms = buf.read_shift(2) & 0xFFFF;\n\tvar ymd = buf.read_shift(2) & 0xFFFF;\n\tvar val = new Date();\n\tvar d = ymd & 0x1F; ymd >>>= 5;\n\tvar m = ymd & 0x0F; ymd >>>= 4;\n\tval.setMilliseconds(0);\n\tval.setFullYear(ymd + 1980);\n\tval.setMonth(m-1);\n\tval.setDate(d);\n\tvar S = hms & 0x1F; hms >>>= 5;\n\tvar M = hms & 0x3F; hms >>>= 6;\n\tval.setHours(hms);\n\tval.setMinutes(M);\n\tval.setSeconds(S<<1);\n\treturn val;\n}\nfunction parse_extra_field(blob) {\n\tprep_blob(blob, 0);\n\tvar o = {};\n\tvar flags = 0;\n\twhile(blob.l <= blob.length - 4) {\n\t\tvar type = blob.read_shift(2);\n\t\tvar sz = blob.read_shift(2), tgt = blob.l + sz;\n\t\tvar p = {};\n\t\tswitch(type) {\n\t\t\t/* UNIX-style Timestamps */\n\t\t\tcase 0x5455: {\n\t\t\t\tflags = blob.read_shift(1);\n\t\t\t\tif(flags & 1) p.mtime = blob.read_shift(4);\n\t\t\t\t/* for some reason, CD flag corresponds to LFH */\n\t\t\t\tif(sz > 5) {\n\t\t\t\t\tif(flags & 2) p.atime = blob.read_shift(4);\n\t\t\t\t\tif(flags & 4) p.ctime = blob.read_shift(4);\n\t\t\t\t}\n\t\t\t\tif(p.mtime) p.mt = new Date(p.mtime*1000);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tblob.l = tgt;\n\t\to[type] = p;\n\t}\n\treturn o;\n}\nvar fs;\nfunction get_fs() { return fs || (fs = require('fs')); }\nfunction parse(file, options) {\nif(file[0] == 0x50 && file[1] == 0x4b) return parse_zip(file, options);\nif((file[0] | 0x20) == 0x6d && (file[1]|0x20) == 0x69) return parse_mad(file, options);\nif(file.length < 512) throw new Error(\"CFB file size \" + file.length + \" < 512\");\nvar mver = 3;\nvar ssz = 512;\nvar nmfs = 0; // number of mini FAT sectors\nvar difat_sec_cnt = 0;\nvar dir_start = 0;\nvar minifat_start = 0;\nvar difat_start = 0;\n\nvar fat_addrs = []; // locations of FAT sectors\n\n/* [MS-CFB] 2.2 Compound File Header */\nvar blob = file.slice(0,512);\nprep_blob(blob, 0);\n\n/* major version */\nvar mv = check_get_mver(blob);\nmver = mv[0];\nswitch(mver) {\n\tcase 3: ssz = 512; break; case 4: ssz = 4096; break;\n\tcase 0: if(mv[1] == 0) return parse_zip(file, options);\n\t/* falls through */\n\tdefault: throw new Error(\"Major Version: Expected 3 or 4 saw \" + mver);\n}\n\n/* reprocess header */\nif(ssz !== 512) { blob = file.slice(0,ssz); prep_blob(blob, 28 /* blob.l */); }\n/* Save header for final object */\nvar header = file.slice(0,ssz);\n\ncheck_shifts(blob, mver);\n\n// Number of Directory Sectors\nvar dir_cnt = blob.read_shift(4, 'i');\nif(mver === 3 && dir_cnt !== 0) throw new Error('# Directory Sectors: Expected 0 saw ' + dir_cnt);\n\n// Number of FAT Sectors\nblob.l += 4;\n\n// First Directory Sector Location\ndir_start = blob.read_shift(4, 'i');\n\n// Transaction Signature\nblob.l += 4;\n\n// Mini Stream Cutoff Size\nblob.chk('00100000', 'Mini Stream Cutoff Size: ');\n\n// First Mini FAT Sector Location\nminifat_start = blob.read_shift(4, 'i');\n\n// Number of Mini FAT Sectors\nnmfs = blob.read_shift(4, 'i');\n\n// First DIFAT sector location\ndifat_start = blob.read_shift(4, 'i');\n\n// Number of DIFAT Sectors\ndifat_sec_cnt = blob.read_shift(4, 'i');\n\n// Grab FAT Sector Locations\nfor(var q = -1, j = 0; j < 109; ++j) { /* 109 = (512 - blob.l)>>>2; */\n\tq = blob.read_shift(4, 'i');\n\tif(q<0) break;\n\tfat_addrs[j] = q;\n}\n\n/** Break the file up into sectors */\nvar sectors = sectorify(file, ssz);\n\nsleuth_fat(difat_start, difat_sec_cnt, sectors, ssz, fat_addrs);\n\n/** Chains */\nvar sector_list = make_sector_list(sectors, dir_start, fat_addrs, ssz);\n\nsector_list[dir_start].name = \"!Directory\";\nif(nmfs > 0 && minifat_start !== ENDOFCHAIN) sector_list[minifat_start].name = \"!MiniFAT\";\nsector_list[fat_addrs[0]].name = \"!FAT\";\nsector_list.fat_addrs = fat_addrs;\nsector_list.ssz = ssz;\n\n/* [MS-CFB] 2.6.1 Compound File Directory Entry */\nvar files = {}, Paths = [], FileIndex = [], FullPaths = [];\nread_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex, minifat_start);\n\nbuild_full_paths(FileIndex, FullPaths, Paths);\nPaths.shift();\n\nvar o = {\n\tFileIndex: FileIndex,\n\tFullPaths: FullPaths\n};\n\n// $FlowIgnore\nif(options && options.raw) o.raw = {header: header, sectors: sectors};\nreturn o;\n} // parse\n\n/* [MS-CFB] 2.2 Compound File Header -- read up to major version */\nfunction check_get_mver(blob) {\n\tif(blob[blob.l] == 0x50 && blob[blob.l + 1] == 0x4b) return [0, 0];\n\t// header signature 8\n\tblob.chk(HEADER_SIGNATURE, 'Header Signature: ');\n\n\t// clsid 16\n\t//blob.chk(HEADER_CLSID, 'CLSID: ');\n\tblob.l += 16;\n\n\t// minor version 2\n\tvar mver = blob.read_shift(2, 'u');\n\n\treturn [blob.read_shift(2,'u'), mver];\n}\nfunction check_shifts(blob, mver) {\n\tvar shift = 0x09;\n\n\t// Byte Order\n\t//blob.chk('feff', 'Byte Order: '); // note: some writers put 0xffff\n\tblob.l += 2;\n\n\t// Sector Shift\n\tswitch((shift = blob.read_shift(2))) {\n\t\tcase 0x09: if(mver != 3) throw new Error('Sector Shift: Expected 9 saw ' + shift); break;\n\t\tcase 0x0c: if(mver != 4) throw new Error('Sector Shift: Expected 12 saw ' + shift); break;\n\t\tdefault: throw new Error('Sector Shift: Expected 9 or 12 saw ' + shift);\n\t}\n\n\t// Mini Sector Shift\n\tblob.chk('0600', 'Mini Sector Shift: ');\n\n\t// Reserved\n\tblob.chk('000000000000', 'Reserved: ');\n}\n\n/** Break the file up into sectors */\nfunction sectorify(file, ssz) {\n\tvar nsectors = Math.ceil(file.length/ssz)-1;\n\tvar sectors = [];\n\tfor(var i=1; i < nsectors; ++i) sectors[i-1] = file.slice(i*ssz,(i+1)*ssz);\n\tsectors[nsectors-1] = file.slice(nsectors*ssz);\n\treturn sectors;\n}\n\n/* [MS-CFB] 2.6.4 Red-Black Tree */\nfunction build_full_paths(FI, FP, Paths) {\n\tvar i = 0, L = 0, R = 0, C = 0, j = 0, pl = Paths.length;\n\tvar dad = [], q = [];\n\n\tfor(; i < pl; ++i) { dad[i]=q[i]=i; FP[i]=Paths[i]; }\n\n\tfor(; j < q.length; ++j) {\n\t\ti = q[j];\n\t\tL = FI[i].L; R = FI[i].R; C = FI[i].C;\n\t\tif(dad[i] === i) {\n\t\t\tif(L !== -1 /*NOSTREAM*/ && dad[L] !== L) dad[i] = dad[L];\n\t\t\tif(R !== -1 && dad[R] !== R) dad[i] = dad[R];\n\t\t}\n\t\tif(C !== -1 /*NOSTREAM*/) dad[C] = i;\n\t\tif(L !== -1 && i != dad[i]) { dad[L] = dad[i]; if(q.lastIndexOf(L) < j) q.push(L); }\n\t\tif(R !== -1 && i != dad[i]) { dad[R] = dad[i]; if(q.lastIndexOf(R) < j) q.push(R); }\n\t}\n\tfor(i=1; i < pl; ++i) if(dad[i] === i) {\n\t\tif(R !== -1 /*NOSTREAM*/ && dad[R] !== R) dad[i] = dad[R];\n\t\telse if(L !== -1 && dad[L] !== L) dad[i] = dad[L];\n\t}\n\n\tfor(i=1; i < pl; ++i) {\n\t\tif(FI[i].type === 0 /* unknown */) continue;\n\t\tj = i;\n\t\tif(j != dad[j]) do {\n\t\t\tj = dad[j];\n\t\t\tFP[i] = FP[j] + \"/\" + FP[i];\n\t\t} while (j !== 0 && -1 !== dad[j] && j != dad[j]);\n\t\tdad[i] = -1;\n\t}\n\n\tFP[0] += \"/\";\n\tfor(i=1; i < pl; ++i) {\n\t\tif(FI[i].type !== 2 /* stream */) FP[i] += \"/\";\n\t}\n}\n\nfunction get_mfat_entry(entry, payload, mini) {\n\tvar start = entry.start, size = entry.size;\n\t//return (payload.slice(start*MSSZ, start*MSSZ + size));\n\tvar o = [];\n\tvar idx = start;\n\twhile(mini && size > 0 && idx >= 0) {\n\t\to.push(payload.slice(idx * MSSZ, idx * MSSZ + MSSZ));\n\t\tsize -= MSSZ;\n\t\tidx = __readInt32LE(mini, idx * 4);\n\t}\n\tif(o.length === 0) return (new_buf(0));\n\treturn (bconcat(o).slice(0, entry.size));\n}\n\n/** Chase down the rest of the DIFAT chain to build a comprehensive list\n    DIFAT chains by storing the next sector number as the last 32 bits */\nfunction sleuth_fat(idx, cnt, sectors, ssz, fat_addrs) {\n\tvar q = ENDOFCHAIN;\n\tif(idx === ENDOFCHAIN) {\n\t\tif(cnt !== 0) throw new Error(\"DIFAT chain shorter than expected\");\n\t} else if(idx !== -1 /*FREESECT*/) {\n\t\tvar sector = sectors[idx], m = (ssz>>>2)-1;\n\t\tif(!sector) return;\n\t\tfor(var i = 0; i < m; ++i) {\n\t\t\tif((q = __readInt32LE(sector,i*4)) === ENDOFCHAIN) break;\n\t\t\tfat_addrs.push(q);\n\t\t}\n\t\tsleuth_fat(__readInt32LE(sector,ssz-4),cnt - 1, sectors, ssz, fat_addrs);\n\t}\n}\n\n/** Follow the linked list of sectors for a given starting point */\nfunction get_sector_list(sectors, start, fat_addrs, ssz, chkd) {\n\tvar buf = [], buf_chain = [];\n\tif(!chkd) chkd = [];\n\tvar modulus = ssz - 1, j = 0, jj = 0;\n\tfor(j=start; j>=0;) {\n\t\tchkd[j] = true;\n\t\tbuf[buf.length] = j;\n\t\tbuf_chain.push(sectors[j]);\n\t\tvar addr = fat_addrs[Math.floor(j*4/ssz)];\n\t\tjj = ((j*4) & modulus);\n\t\tif(ssz < 4 + jj) throw new Error(\"FAT boundary crossed: \" + j + \" 4 \"+ssz);\n\t\tif(!sectors[addr]) break;\n\t\tj = __readInt32LE(sectors[addr], jj);\n\t}\n\treturn {nodes: buf, data:__toBuffer([buf_chain])};\n}\n\n/** Chase down the sector linked lists */\nfunction make_sector_list(sectors, dir_start, fat_addrs, ssz) {\n\tvar sl = sectors.length, sector_list = ([]);\n\tvar chkd = [], buf = [], buf_chain = [];\n\tvar modulus = ssz - 1, i=0, j=0, k=0, jj=0;\n\tfor(i=0; i < sl; ++i) {\n\t\tbuf = ([]);\n\t\tk = (i + dir_start); if(k >= sl) k-=sl;\n\t\tif(chkd[k]) continue;\n\t\tbuf_chain = [];\n\t\tvar seen = [];\n\t\tfor(j=k; j>=0;) {\n\t\t\tseen[j] = true;\n\t\t\tchkd[j] = true;\n\t\t\tbuf[buf.length] = j;\n\t\t\tbuf_chain.push(sectors[j]);\n\t\t\tvar addr = fat_addrs[Math.floor(j*4/ssz)];\n\t\t\tjj = ((j*4) & modulus);\n\t\t\tif(ssz < 4 + jj) throw new Error(\"FAT boundary crossed: \" + j + \" 4 \"+ssz);\n\t\t\tif(!sectors[addr]) break;\n\t\t\tj = __readInt32LE(sectors[addr], jj);\n\t\t\tif(seen[j]) break;\n\t\t}\n\t\tsector_list[k] = ({nodes: buf, data:__toBuffer([buf_chain])});\n\t}\n\treturn sector_list;\n}\n\n/* [MS-CFB] 2.6.1 Compound File Directory Entry */\nfunction read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex, mini) {\n\tvar minifat_store = 0, pl = (Paths.length?2:0);\n\tvar sector = sector_list[dir_start].data;\n\tvar i = 0, namelen = 0, name;\n\tfor(; i < sector.length; i+= 128) {\n\t\tvar blob = sector.slice(i, i+128);\n\t\tprep_blob(blob, 64);\n\t\tnamelen = blob.read_shift(2);\n\t\tname = __utf16le(blob,0,namelen-pl);\n\t\tPaths.push(name);\n\t\tvar o = ({\n\t\t\tname:  name,\n\t\t\ttype:  blob.read_shift(1),\n\t\t\tcolor: blob.read_shift(1),\n\t\t\tL:     blob.read_shift(4, 'i'),\n\t\t\tR:     blob.read_shift(4, 'i'),\n\t\t\tC:     blob.read_shift(4, 'i'),\n\t\t\tclsid: blob.read_shift(16),\n\t\t\tstate: blob.read_shift(4, 'i'),\n\t\t\tstart: 0,\n\t\t\tsize: 0\n\t\t});\n\t\tvar ctime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n\t\tif(ctime !== 0) o.ct = read_date(blob, blob.l-8);\n\t\tvar mtime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n\t\tif(mtime !== 0) o.mt = read_date(blob, blob.l-8);\n\t\to.start = blob.read_shift(4, 'i');\n\t\to.size = blob.read_shift(4, 'i');\n\t\tif(o.size < 0 && o.start < 0) { o.size = o.type = 0; o.start = ENDOFCHAIN; o.name = \"\"; }\n\t\tif(o.type === 5) { /* root */\n\t\t\tminifat_store = o.start;\n\t\t\tif(nmfs > 0 && minifat_store !== ENDOFCHAIN) sector_list[minifat_store].name = \"!StreamData\";\n\t\t\t/*minifat_size = o.size;*/\n\t\t} else if(o.size >= 4096 /* MSCSZ */) {\n\t\t\to.storage = 'fat';\n\t\t\tif(sector_list[o.start] === undefined) sector_list[o.start] = get_sector_list(sectors, o.start, sector_list.fat_addrs, sector_list.ssz);\n\t\t\tsector_list[o.start].name = o.name;\n\t\t\to.content = (sector_list[o.start].data.slice(0,o.size));\n\t\t} else {\n\t\t\to.storage = 'minifat';\n\t\t\tif(o.size < 0) o.size = 0;\n\t\t\telse if(minifat_store !== ENDOFCHAIN && o.start !== ENDOFCHAIN && sector_list[minifat_store]) {\n\t\t\t\to.content = get_mfat_entry(o, sector_list[minifat_store].data, (sector_list[mini]||{}).data);\n\t\t\t}\n\t\t}\n\t\tif(o.content) prep_blob(o.content, 0);\n\t\tfiles[name] = o;\n\t\tFileIndex.push(o);\n\t}\n}\n\nfunction read_date(blob, offset) {\n\treturn new Date(( ( (__readUInt32LE(blob,offset+4)/1e7)*Math.pow(2,32)+__readUInt32LE(blob,offset)/1e7 ) - 11644473600)*1000);\n}\n\nfunction read_file(filename, options) {\n\tget_fs();\n\treturn parse(fs.readFileSync(filename), options);\n}\n\nfunction read(blob, options) {\n\tvar type = options && options.type;\n\tif(!type) {\n\t\tif(has_buf && Buffer.isBuffer(blob)) type = \"buffer\";\n\t}\n\tswitch(type || \"base64\") {\n\t\tcase \"file\": return read_file(blob, options);\n\t\tcase \"base64\": return parse(s2a(Base64_decode(blob)), options);\n\t\tcase \"binary\": return parse(s2a(blob), options);\n\t}\n\treturn parse(blob, options);\n}\n\nfunction init_cfb(cfb, opts) {\n\tvar o = opts || {}, root = o.root || \"Root Entry\";\n\tif(!cfb.FullPaths) cfb.FullPaths = [];\n\tif(!cfb.FileIndex) cfb.FileIndex = [];\n\tif(cfb.FullPaths.length !== cfb.FileIndex.length) throw new Error(\"inconsistent CFB structure\");\n\tif(cfb.FullPaths.length === 0) {\n\t\tcfb.FullPaths[0] = root + \"/\";\n\t\tcfb.FileIndex[0] = ({ name: root, type: 5 });\n\t}\n\tif(o.CLSID) cfb.FileIndex[0].clsid = o.CLSID;\n\tseed_cfb(cfb);\n}\nfunction seed_cfb(cfb) {\n\tvar nm = \"\\u0001Sh33tJ5\";\n\tif(CFB.find(cfb, \"/\" + nm)) return;\n\tvar p = new_buf(4); p[0] = 55; p[1] = p[3] = 50; p[2] = 54;\n\tcfb.FileIndex.push(({ name: nm, type: 2, content:p, size:4, L:69, R:69, C:69 }));\n\tcfb.FullPaths.push(cfb.FullPaths[0] + nm);\n\trebuild_cfb(cfb);\n}\nfunction rebuild_cfb(cfb, f) {\n\tinit_cfb(cfb);\n\tvar gc = false, s = false;\n\tfor(var i = cfb.FullPaths.length - 1; i >= 0; --i) {\n\t\tvar _file = cfb.FileIndex[i];\n\t\tswitch(_file.type) {\n\t\t\tcase 0:\n\t\t\t\tif(s) gc = true;\n\t\t\t\telse { cfb.FileIndex.pop(); cfb.FullPaths.pop(); }\n\t\t\t\tbreak;\n\t\t\tcase 1: case 2: case 5:\n\t\t\t\ts = true;\n\t\t\t\tif(isNaN(_file.R * _file.L * _file.C)) gc = true;\n\t\t\t\tif(_file.R > -1 && _file.L > -1 && _file.R == _file.L) gc = true;\n\t\t\t\tbreak;\n\t\t\tdefault: gc = true; break;\n\t\t}\n\t}\n\tif(!gc && !f) return;\n\n\tvar now = new Date(1987, 1, 19), j = 0;\n\t// Track which names exist\n\tvar fullPaths = Object.create ? Object.create(null) : {};\n\tvar data = [];\n\tfor(i = 0; i < cfb.FullPaths.length; ++i) {\n\t\tfullPaths[cfb.FullPaths[i]] = true;\n\t\tif(cfb.FileIndex[i].type === 0) continue;\n\t\tdata.push([cfb.FullPaths[i], cfb.FileIndex[i]]);\n\t}\n\tfor(i = 0; i < data.length; ++i) {\n\t\tvar dad = dirname(data[i][0]);\n\t\ts = fullPaths[dad];\n\t\tif(!s) {\n\t\t\tdata.push([dad, ({\n\t\t\t\tname: filename(dad).replace(\"/\",\"\"),\n\t\t\t\ttype: 1,\n\t\t\t\tclsid: HEADER_CLSID,\n\t\t\t\tct: now, mt: now,\n\t\t\t\tcontent: null\n\t\t\t})]);\n\t\t\t// Add name to set\n\t\t\tfullPaths[dad] = true;\n\t\t}\n\t}\n\n\tdata.sort(function(x,y) { return namecmp(x[0], y[0]); });\n\tcfb.FullPaths = []; cfb.FileIndex = [];\n\tfor(i = 0; i < data.length; ++i) { cfb.FullPaths[i] = data[i][0]; cfb.FileIndex[i] = data[i][1]; }\n\tfor(i = 0; i < data.length; ++i) {\n\t\tvar elt = cfb.FileIndex[i];\n\t\tvar nm = cfb.FullPaths[i];\n\n\t\telt.name =  filename(nm).replace(\"/\",\"\");\n\t\telt.L = elt.R = elt.C = -(elt.color = 1);\n\t\telt.size = elt.content ? elt.content.length : 0;\n\t\telt.start = 0;\n\t\telt.clsid = (elt.clsid || HEADER_CLSID);\n\t\tif(i === 0) {\n\t\t\telt.C = data.length > 1 ? 1 : -1;\n\t\t\telt.size = 0;\n\t\t\telt.type = 5;\n\t\t} else if(nm.slice(-1) == \"/\") {\n\t\t\tfor(j=i+1;j < data.length; ++j) if(dirname(cfb.FullPaths[j])==nm) break;\n\t\t\telt.C = j >= data.length ? -1 : j;\n\t\t\tfor(j=i+1;j < data.length; ++j) if(dirname(cfb.FullPaths[j])==dirname(nm)) break;\n\t\t\telt.R = j >= data.length ? -1 : j;\n\t\t\telt.type = 1;\n\t\t} else {\n\t\t\tif(dirname(cfb.FullPaths[i+1]||\"\") == dirname(nm)) elt.R = i + 1;\n\t\t\telt.type = 2;\n\t\t}\n\t}\n\n}\n\nfunction _write(cfb, options) {\n\tvar _opts = options || {};\n\t/* MAD is order-sensitive, skip rebuild and sort */\n\tif(_opts.fileType == 'mad') return write_mad(cfb, _opts);\n\trebuild_cfb(cfb);\n\tswitch(_opts.fileType) {\n\t\tcase 'zip': return write_zip(cfb, _opts);\n\t\t//case 'mad': return write_mad(cfb, _opts);\n\t}\n\tvar L = (function(cfb){\n\t\tvar mini_size = 0, fat_size = 0;\n\t\tfor(var i = 0; i < cfb.FileIndex.length; ++i) {\n\t\t\tvar file = cfb.FileIndex[i];\n\t\t\tif(!file.content) continue;\nvar flen = file.content.length;\n\t\t\tif(flen > 0){\n\t\t\t\tif(flen < 0x1000) mini_size += (flen + 0x3F) >> 6;\n\t\t\t\telse fat_size += (flen + 0x01FF) >> 9;\n\t\t\t}\n\t\t}\n\t\tvar dir_cnt = (cfb.FullPaths.length +3) >> 2;\n\t\tvar mini_cnt = (mini_size + 7) >> 3;\n\t\tvar mfat_cnt = (mini_size + 0x7F) >> 7;\n\t\tvar fat_base = mini_cnt + fat_size + dir_cnt + mfat_cnt;\n\t\tvar fat_cnt = (fat_base + 0x7F) >> 7;\n\t\tvar difat_cnt = fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt-109)/0x7F);\n\t\twhile(((fat_base + fat_cnt + difat_cnt + 0x7F) >> 7) > fat_cnt) difat_cnt = ++fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt-109)/0x7F);\n\t\tvar L =  [1, difat_cnt, fat_cnt, mfat_cnt, dir_cnt, fat_size, mini_size, 0];\n\t\tcfb.FileIndex[0].size = mini_size << 6;\n\t\tL[7] = (cfb.FileIndex[0].start=L[0]+L[1]+L[2]+L[3]+L[4]+L[5])+((L[6]+7) >> 3);\n\t\treturn L;\n\t})(cfb);\n\tvar o = new_buf(L[7] << 9);\n\tvar i = 0, T = 0;\n\t{\n\t\tfor(i = 0; i < 8; ++i) o.write_shift(1, HEADER_SIG[i]);\n\t\tfor(i = 0; i < 8; ++i) o.write_shift(2, 0);\n\t\to.write_shift(2, 0x003E);\n\t\to.write_shift(2, 0x0003);\n\t\to.write_shift(2, 0xFFFE);\n\t\to.write_shift(2, 0x0009);\n\t\to.write_shift(2, 0x0006);\n\t\tfor(i = 0; i < 3; ++i) o.write_shift(2, 0);\n\t\to.write_shift(4, 0);\n\t\to.write_shift(4, L[2]);\n\t\to.write_shift(4, L[0] + L[1] + L[2] + L[3] - 1);\n\t\to.write_shift(4, 0);\n\t\to.write_shift(4, 1<<12);\n\t\to.write_shift(4, L[3] ? L[0] + L[1] + L[2] - 1: ENDOFCHAIN);\n\t\to.write_shift(4, L[3]);\n\t\to.write_shift(-4, L[1] ? L[0] - 1: ENDOFCHAIN);\n\t\to.write_shift(4, L[1]);\n\t\tfor(i = 0; i < 109; ++i) o.write_shift(-4, i < L[2] ? L[1] + i : -1);\n\t}\n\tif(L[1]) {\n\t\tfor(T = 0; T < L[1]; ++T) {\n\t\t\tfor(; i < 236 + T * 127; ++i) o.write_shift(-4, i < L[2] ? L[1] + i : -1);\n\t\t\to.write_shift(-4, T === L[1] - 1 ? ENDOFCHAIN : T + 1);\n\t\t}\n\t}\n\tvar chainit = function(w) {\n\t\tfor(T += w; i<T-1; ++i) o.write_shift(-4, i+1);\n\t\tif(w) { ++i; o.write_shift(-4, ENDOFCHAIN); }\n\t};\n\tT = i = 0;\n\tfor(T+=L[1]; i<T; ++i) o.write_shift(-4, consts.DIFSECT);\n\tfor(T+=L[2]; i<T; ++i) o.write_shift(-4, consts.FATSECT);\n\tchainit(L[3]);\n\tchainit(L[4]);\n\tvar j = 0, flen = 0;\n\tvar file = cfb.FileIndex[0];\n\tfor(; j < cfb.FileIndex.length; ++j) {\n\t\tfile = cfb.FileIndex[j];\n\t\tif(!file.content) continue;\nflen = file.content.length;\n\t\tif(flen < 0x1000) continue;\n\t\tfile.start = T;\n\t\tchainit((flen + 0x01FF) >> 9);\n\t}\n\tchainit((L[6] + 7) >> 3);\n\twhile(o.l & 0x1FF) o.write_shift(-4, consts.ENDOFCHAIN);\n\tT = i = 0;\n\tfor(j = 0; j < cfb.FileIndex.length; ++j) {\n\t\tfile = cfb.FileIndex[j];\n\t\tif(!file.content) continue;\nflen = file.content.length;\n\t\tif(!flen || flen >= 0x1000) continue;\n\t\tfile.start = T;\n\t\tchainit((flen + 0x3F) >> 6);\n\t}\n\twhile(o.l & 0x1FF) o.write_shift(-4, consts.ENDOFCHAIN);\n\tfor(i = 0; i < L[4]<<2; ++i) {\n\t\tvar nm = cfb.FullPaths[i];\n\t\tif(!nm || nm.length === 0) {\n\t\t\tfor(j = 0; j < 17; ++j) o.write_shift(4, 0);\n\t\t\tfor(j = 0; j < 3; ++j) o.write_shift(4, -1);\n\t\t\tfor(j = 0; j < 12; ++j) o.write_shift(4, 0);\n\t\t\tcontinue;\n\t\t}\n\t\tfile = cfb.FileIndex[i];\n\t\tif(i === 0) file.start = file.size ? file.start - 1 : ENDOFCHAIN;\n\t\tvar _nm = (i === 0 && _opts.root) || file.name;\n\t\tflen = 2*(_nm.length+1);\n\t\to.write_shift(64, _nm, \"utf16le\");\n\t\to.write_shift(2, flen);\n\t\to.write_shift(1, file.type);\n\t\to.write_shift(1, file.color);\n\t\to.write_shift(-4, file.L);\n\t\to.write_shift(-4, file.R);\n\t\to.write_shift(-4, file.C);\n\t\tif(!file.clsid) for(j = 0; j < 4; ++j) o.write_shift(4, 0);\n\t\telse o.write_shift(16, file.clsid, \"hex\");\n\t\to.write_shift(4, file.state || 0);\n\t\to.write_shift(4, 0); o.write_shift(4, 0);\n\t\to.write_shift(4, 0); o.write_shift(4, 0);\n\t\to.write_shift(4, file.start);\n\t\to.write_shift(4, file.size); o.write_shift(4, 0);\n\t}\n\tfor(i = 1; i < cfb.FileIndex.length; ++i) {\n\t\tfile = cfb.FileIndex[i];\nif(file.size >= 0x1000) {\n\t\t\to.l = (file.start+1) << 9;\n\t\t\tif (has_buf && Buffer.isBuffer(file.content)) {\n\t\t\t\tfile.content.copy(o, o.l, 0, file.size);\n\t\t\t\t// o is a 0-filled Buffer so just set next offset\n\t\t\t\to.l += (file.size + 511) & -512;\n\t\t\t} else {\n\t\t\t\tfor(j = 0; j < file.size; ++j) o.write_shift(1, file.content[j]);\n\t\t\t\tfor(; j & 0x1FF; ++j) o.write_shift(1, 0);\n\t\t\t}\n\t\t}\n\t}\n\tfor(i = 1; i < cfb.FileIndex.length; ++i) {\n\t\tfile = cfb.FileIndex[i];\nif(file.size > 0 && file.size < 0x1000) {\n\t\t\tif (has_buf && Buffer.isBuffer(file.content)) {\n\t\t\t\tfile.content.copy(o, o.l, 0, file.size);\n\t\t\t\t// o is a 0-filled Buffer so just set next offset\n\t\t\t\to.l += (file.size + 63) & -64;\n\t\t\t} else {\n\t\t\t\tfor(j = 0; j < file.size; ++j) o.write_shift(1, file.content[j]);\n\t\t\t\tfor(; j & 0x3F; ++j) o.write_shift(1, 0);\n\t\t\t}\n\t\t}\n\t}\n\tif (has_buf) {\n\t\to.l = o.length;\n\t} else {\n\t\t// When using Buffer, already 0-filled\n\t\twhile(o.l < o.length) o.write_shift(1, 0);\n\t}\n\treturn o;\n}\n/* [MS-CFB] 2.6.4 (Unicode 3.0.1 case conversion) */\nfunction find(cfb, path) {\n\tvar UCFullPaths = cfb.FullPaths.map(function(x) { return x.toUpperCase(); });\n\tvar UCPaths = UCFullPaths.map(function(x) { var y = x.split(\"/\"); return y[y.length - (x.slice(-1) == \"/\" ? 2 : 1)]; });\n\tvar k = false;\n\tif(path.charCodeAt(0) === 47 /* \"/\" */) { k = true; path = UCFullPaths[0].slice(0, -1) + path; }\n\telse k = path.indexOf(\"/\") !== -1;\n\tvar UCPath = path.toUpperCase();\n\tvar w = k === true ? UCFullPaths.indexOf(UCPath) : UCPaths.indexOf(UCPath);\n\tif(w !== -1) return cfb.FileIndex[w];\n\n\tvar m = !UCPath.match(chr1);\n\tUCPath = UCPath.replace(chr0,'');\n\tif(m) UCPath = UCPath.replace(chr1,'!');\n\tfor(w = 0; w < UCFullPaths.length; ++w) {\n\t\tif((m ? UCFullPaths[w].replace(chr1,'!') : UCFullPaths[w]).replace(chr0,'') == UCPath) return cfb.FileIndex[w];\n\t\tif((m ? UCPaths[w].replace(chr1,'!') : UCPaths[w]).replace(chr0,'') == UCPath) return cfb.FileIndex[w];\n\t}\n\treturn null;\n}\n/** CFB Constants */\nvar MSSZ = 64; /* Mini Sector Size = 1<<6 */\n//var MSCSZ = 4096; /* Mini Stream Cutoff Size */\n/* 2.1 Compound File Sector Numbers and Types */\nvar ENDOFCHAIN = -2;\n/* 2.2 Compound File Header */\nvar HEADER_SIGNATURE = 'd0cf11e0a1b11ae1';\nvar HEADER_SIG = [0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1];\nvar HEADER_CLSID = '00000000000000000000000000000000';\nvar consts = {\n\t/* 2.1 Compund File Sector Numbers and Types */\n\tMAXREGSECT: -6,\n\tDIFSECT: -4,\n\tFATSECT: -3,\n\tENDOFCHAIN: ENDOFCHAIN,\n\tFREESECT: -1,\n\t/* 2.2 Compound File Header */\n\tHEADER_SIGNATURE: HEADER_SIGNATURE,\n\tHEADER_MINOR_VERSION: '3e00',\n\tMAXREGSID: -6,\n\tNOSTREAM: -1,\n\tHEADER_CLSID: HEADER_CLSID,\n\t/* 2.6.1 Compound File Directory Entry */\n\tEntryTypes: ['unknown','storage','stream','lockbytes','property','root']\n};\n\nfunction write_file(cfb, filename, options) {\n\tget_fs();\n\tvar o = _write(cfb, options);\nfs.writeFileSync(filename, o);\n}\n\nfunction a2s(o) {\n\tvar out = new Array(o.length);\n\tfor(var i = 0; i < o.length; ++i) out[i] = String.fromCharCode(o[i]);\n\treturn out.join(\"\");\n}\n\nfunction write(cfb, options) {\n\tvar o = _write(cfb, options);\n\tswitch(options && options.type || \"buffer\") {\n\t\tcase \"file\": get_fs(); fs.writeFileSync(options.filename, (o)); return o;\n\t\tcase \"binary\": return typeof o == \"string\" ? o : a2s(o);\n\t\tcase \"base64\": return Base64_encode(typeof o == \"string\" ? o : a2s(o));\n\t\tcase \"buffer\": if(has_buf) return Buffer.isBuffer(o) ? o : Buffer_from(o);\n\t\t\t/* falls through */\n\t\tcase \"array\": return typeof o == \"string\" ? s2a(o) : o;\n\t}\n\treturn o;\n}\n/* node < 8.1 zlib does not expose bytesRead, so default to pure JS */\nvar _zlib;\nfunction use_zlib(zlib) { try {\n\tvar InflateRaw = zlib.InflateRaw;\n\tvar InflRaw = new InflateRaw();\n\tInflRaw._processChunk(new Uint8Array([3, 0]), InflRaw._finishFlushFlag);\n\tif(InflRaw.bytesRead) _zlib = zlib;\n\telse throw new Error(\"zlib does not expose bytesRead\");\n} catch(e) {console.error(\"cannot use native zlib: \" + (e.message || e)); } }\n\nfunction _inflateRawSync(payload, usz) {\n\tif(!_zlib) return _inflate(payload, usz);\n\tvar InflateRaw = _zlib.InflateRaw;\n\tvar InflRaw = new InflateRaw();\n\tvar out = InflRaw._processChunk(payload.slice(payload.l), InflRaw._finishFlushFlag);\n\tpayload.l += InflRaw.bytesRead;\n\treturn out;\n}\n\nfunction _deflateRawSync(payload) {\n\treturn _zlib ? _zlib.deflateRawSync(payload) : _deflate(payload);\n}\nvar CLEN_ORDER = [ 16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15 ];\n\n/*  LEN_ID = [ 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285 ]; */\nvar LEN_LN = [   3,   4,   5,   6,   7,   8,   9,  10,  11,  13 , 15,  17,  19,  23,  27,  31,  35,  43,  51,  59,  67,  83,  99, 115, 131, 163, 195, 227, 258 ];\n\n/*  DST_ID = [  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13,  14,  15,  16,  17,  18,  19,   20,   21,   22,   23,   24,   25,   26,    27,    28,    29 ]; */\nvar DST_LN = [  1,  2,  3,  4,  5,  7,  9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577 ];\n\nfunction bit_swap_8(n) { var t = (((((n<<1)|(n<<11)) & 0x22110) | (((n<<5)|(n<<15)) & 0x88440))); return ((t>>16) | (t>>8) |t)&0xFF; }\n\nvar use_typed_arrays = typeof Uint8Array !== 'undefined';\n\nvar bitswap8 = use_typed_arrays ? new Uint8Array(1<<8) : [];\nfor(var q = 0; q < (1<<8); ++q) bitswap8[q] = bit_swap_8(q);\n\nfunction bit_swap_n(n, b) {\n\tvar rev = bitswap8[n & 0xFF];\n\tif(b <= 8) return rev >>> (8-b);\n\trev = (rev << 8) | bitswap8[(n>>8)&0xFF];\n\tif(b <= 16) return rev >>> (16-b);\n\trev = (rev << 8) | bitswap8[(n>>16)&0xFF];\n\treturn rev >>> (24-b);\n}\n\n/* helpers for unaligned bit reads */\nfunction read_bits_2(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 6 ? 0 : buf[h+1]<<8))>>>w)& 0x03; }\nfunction read_bits_3(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 5 ? 0 : buf[h+1]<<8))>>>w)& 0x07; }\nfunction read_bits_4(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 4 ? 0 : buf[h+1]<<8))>>>w)& 0x0F; }\nfunction read_bits_5(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 3 ? 0 : buf[h+1]<<8))>>>w)& 0x1F; }\nfunction read_bits_7(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 1 ? 0 : buf[h+1]<<8))>>>w)& 0x7F; }\n\n/* works up to n = 3 * 8 + 1 = 25 */\nfunction read_bits_n(buf, bl, n) {\n\tvar w = (bl&7), h = (bl>>>3), f = ((1<<n)-1);\n\tvar v = buf[h] >>> w;\n\tif(n < 8 - w) return v & f;\n\tv |= buf[h+1]<<(8-w);\n\tif(n < 16 - w) return v & f;\n\tv |= buf[h+2]<<(16-w);\n\tif(n < 24 - w) return v & f;\n\tv |= buf[h+3]<<(24-w);\n\treturn v & f;\n}\n\n/* helpers for unaligned bit writes */\nfunction write_bits_3(buf, bl, v) { var w = bl & 7, h = bl >>> 3;\n\tif(w <= 5) buf[h] |= (v & 7) << w;\n\telse {\n\t\tbuf[h] |= (v << w) & 0xFF;\n\t\tbuf[h+1] = (v&7) >> (8-w);\n\t}\n\treturn bl + 3;\n}\n\nfunction write_bits_1(buf, bl, v) {\n\tvar w = bl & 7, h = bl >>> 3;\n\tv = (v&1) << w;\n\tbuf[h] |= v;\n\treturn bl + 1;\n}\nfunction write_bits_8(buf, bl, v) {\n\tvar w = bl & 7, h = bl >>> 3;\n\tv <<= w;\n\tbuf[h] |=  v & 0xFF; v >>>= 8;\n\tbuf[h+1] = v;\n\treturn bl + 8;\n}\nfunction write_bits_16(buf, bl, v) {\n\tvar w = bl & 7, h = bl >>> 3;\n\tv <<= w;\n\tbuf[h] |=  v & 0xFF; v >>>= 8;\n\tbuf[h+1] = v & 0xFF;\n\tbuf[h+2] = v >>> 8;\n\treturn bl + 16;\n}\n\n/* until ArrayBuffer#realloc is a thing, fake a realloc */\nfunction realloc(b, sz) {\n\tvar L = b.length, M = 2*L > sz ? 2*L : sz + 5, i = 0;\n\tif(L >= sz) return b;\n\tif(has_buf) {\n\t\tvar o = new_unsafe_buf(M);\n\t\t// $FlowIgnore\n\t\tif(b.copy) b.copy(o);\n\t\telse for(; i < b.length; ++i) o[i] = b[i];\n\t\treturn o;\n\t} else if(use_typed_arrays) {\n\t\tvar a = new Uint8Array(M);\n\t\tif(a.set) a.set(b);\n\t\telse for(; i < L; ++i) a[i] = b[i];\n\t\treturn a;\n\t}\n\tb.length = M;\n\treturn b;\n}\n\n/* zero-filled arrays for older browsers */\nfunction zero_fill_array(n) {\n\tvar o = new Array(n);\n\tfor(var i = 0; i < n; ++i) o[i] = 0;\n\treturn o;\n}\n\n/* build tree (used for literals and lengths) */\nfunction build_tree(clens, cmap, MAX) {\n\tvar maxlen = 1, w = 0, i = 0, j = 0, ccode = 0, L = clens.length;\n\n\tvar bl_count  = use_typed_arrays ? new Uint16Array(32) : zero_fill_array(32);\n\tfor(i = 0; i < 32; ++i) bl_count[i] = 0;\n\n\tfor(i = L; i < MAX; ++i) clens[i] = 0;\n\tL = clens.length;\n\n\tvar ctree = use_typed_arrays ? new Uint16Array(L) : zero_fill_array(L); // []\n\n\t/* build code tree */\n\tfor(i = 0; i < L; ++i) {\n\t\tbl_count[(w = clens[i])]++;\n\t\tif(maxlen < w) maxlen = w;\n\t\tctree[i] = 0;\n\t}\n\tbl_count[0] = 0;\n\tfor(i = 1; i <= maxlen; ++i) bl_count[i+16] = (ccode = (ccode + bl_count[i-1])<<1);\n\tfor(i = 0; i < L; ++i) {\n\t\tccode = clens[i];\n\t\tif(ccode != 0) ctree[i] = bl_count[ccode+16]++;\n\t}\n\n\t/* cmap[maxlen + 4 bits] = (off&15) + (lit<<4) reverse mapping */\n\tvar cleni = 0;\n\tfor(i = 0; i < L; ++i) {\n\t\tcleni = clens[i];\n\t\tif(cleni != 0) {\n\t\t\tccode = bit_swap_n(ctree[i], maxlen)>>(maxlen-cleni);\n\t\t\tfor(j = (1<<(maxlen + 4 - cleni)) - 1; j>=0; --j)\n\t\t\t\tcmap[ccode|(j<<cleni)] = (cleni&15) | (i<<4);\n\t\t}\n\t}\n\treturn maxlen;\n}\n\n/* Fixed Huffman */\nvar fix_lmap = use_typed_arrays ? new Uint16Array(512) : zero_fill_array(512);\nvar fix_dmap = use_typed_arrays ? new Uint16Array(32)  : zero_fill_array(32);\nif(!use_typed_arrays) {\n\tfor(var i = 0; i < 512; ++i) fix_lmap[i] = 0;\n\tfor(i = 0; i < 32; ++i) fix_dmap[i] = 0;\n}\n(function() {\n\tvar dlens = [];\n\tvar i = 0;\n\tfor(;i<32; i++) dlens.push(5);\n\tbuild_tree(dlens, fix_dmap, 32);\n\n\tvar clens = [];\n\ti = 0;\n\tfor(; i<=143; i++) clens.push(8);\n\tfor(; i<=255; i++) clens.push(9);\n\tfor(; i<=279; i++) clens.push(7);\n\tfor(; i<=287; i++) clens.push(8);\n\tbuild_tree(clens, fix_lmap, 288);\n})();var _deflateRaw = (function _deflateRawIIFE() {\n\tvar DST_LN_RE = use_typed_arrays ? new Uint8Array(0x8000) : [];\n\tvar j = 0, k = 0;\n\tfor(; j < DST_LN.length - 1; ++j) {\n\t\tfor(; k < DST_LN[j+1]; ++k) DST_LN_RE[k] = j;\n\t}\n\tfor(;k < 32768; ++k) DST_LN_RE[k] = 29;\n\n\tvar LEN_LN_RE = use_typed_arrays ? new Uint8Array(0x103) : [];\n\tfor(j = 0, k = 0; j < LEN_LN.length - 1; ++j) {\n\t\tfor(; k < LEN_LN[j+1]; ++k) LEN_LN_RE[k] = j;\n\t}\n\n\tfunction write_stored(data, out) {\n\t\tvar boff = 0;\n\t\twhile(boff < data.length) {\n\t\t\tvar L = Math.min(0xFFFF, data.length - boff);\n\t\t\tvar h = boff + L == data.length;\n\t\t\tout.write_shift(1, +h);\n\t\t\tout.write_shift(2, L);\n\t\t\tout.write_shift(2, (~L) & 0xFFFF);\n\t\t\twhile(L-- > 0) out[out.l++] = data[boff++];\n\t\t}\n\t\treturn out.l;\n\t}\n\n\t/* Fixed Huffman */\n\tfunction write_huff_fixed(data, out) {\n\t\tvar bl = 0;\n\t\tvar boff = 0;\n\t\tvar addrs = use_typed_arrays ? new Uint16Array(0x8000) : [];\n\t\twhile(boff < data.length) {\n\t\t\tvar L = /* data.length - boff; */ Math.min(0xFFFF, data.length - boff);\n\n\t\t\t/* write a stored block for short data */\n\t\t\tif(L < 10) {\n\t\t\t\tbl = write_bits_3(out, bl, +!!(boff + L == data.length)); // jshint ignore:line\n\t\t\t\tif(bl & 7) bl += 8 - (bl & 7);\n\t\t\t\tout.l = (bl / 8) | 0;\n\t\t\t\tout.write_shift(2, L);\n\t\t\t\tout.write_shift(2, (~L) & 0xFFFF);\n\t\t\t\twhile(L-- > 0) out[out.l++] = data[boff++];\n\t\t\t\tbl = out.l * 8;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tbl = write_bits_3(out, bl, +!!(boff + L == data.length) + 2); // jshint ignore:line\n\t\t\tvar hash = 0;\n\t\t\twhile(L-- > 0) {\n\t\t\t\tvar d = data[boff];\n\t\t\t\thash = ((hash << 5) ^ d) & 0x7FFF;\n\n\t\t\t\tvar match = -1, mlen = 0;\n\n\t\t\t\tif((match = addrs[hash])) {\n\t\t\t\t\tmatch |= boff & ~0x7FFF;\n\t\t\t\t\tif(match > boff) match -= 0x8000;\n\t\t\t\t\tif(match < boff) while(data[match + mlen] == data[boff + mlen] && mlen < 250) ++mlen;\n\t\t\t\t}\n\n\t\t\t\tif(mlen > 2) {\n\t\t\t\t\t/* Copy Token  */\n\t\t\t\t\td = LEN_LN_RE[mlen];\n\t\t\t\t\tif(d <= 22) bl = write_bits_8(out, bl, bitswap8[d+1]>>1) - 1;\n\t\t\t\t\telse {\n\t\t\t\t\t\twrite_bits_8(out, bl, 3);\n\t\t\t\t\t\tbl += 5;\n\t\t\t\t\t\twrite_bits_8(out, bl, bitswap8[d-23]>>5);\n\t\t\t\t\t\tbl += 3;\n\t\t\t\t\t}\n\t\t\t\t\tvar len_eb = (d < 8) ? 0 : ((d - 4)>>2);\n\t\t\t\t\tif(len_eb > 0) {\n\t\t\t\t\t\twrite_bits_16(out, bl, mlen - LEN_LN[d]);\n\t\t\t\t\t\tbl += len_eb;\n\t\t\t\t\t}\n\n\t\t\t\t\td = DST_LN_RE[boff - match];\n\t\t\t\t\tbl = write_bits_8(out, bl, bitswap8[d]>>3);\n\t\t\t\t\tbl -= 3;\n\n\t\t\t\t\tvar dst_eb = d < 4 ? 0 : (d-2)>>1;\n\t\t\t\t\tif(dst_eb > 0) {\n\t\t\t\t\t\twrite_bits_16(out, bl, boff - match - DST_LN[d]);\n\t\t\t\t\t\tbl += dst_eb;\n\t\t\t\t\t}\n\t\t\t\t\tfor(var q = 0; q < mlen; ++q) {\n\t\t\t\t\t\taddrs[hash] = boff & 0x7FFF;\n\t\t\t\t\t\thash = ((hash << 5) ^ data[boff]) & 0x7FFF;\n\t\t\t\t\t\t++boff;\n\t\t\t\t\t}\n\t\t\t\t\tL-= mlen - 1;\n\t\t\t\t} else {\n\t\t\t\t\t/* Literal Token */\n\t\t\t\t\tif(d <= 143) d = d + 48;\n\t\t\t\t\telse bl = write_bits_1(out, bl, 1);\n\t\t\t\t\tbl = write_bits_8(out, bl, bitswap8[d]);\n\t\t\t\t\taddrs[hash] = boff & 0x7FFF;\n\t\t\t\t\t++boff;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbl = write_bits_8(out, bl, 0) - 1;\n\t\t}\n\t\tout.l = ((bl + 7)/8)|0;\n\t\treturn out.l;\n\t}\n\treturn function _deflateRaw(data, out) {\n\t\tif(data.length < 8) return write_stored(data, out);\n\t\treturn write_huff_fixed(data, out);\n\t};\n})();\n\nfunction _deflate(data) {\n\tvar buf = new_buf(50+Math.floor(data.length*1.1));\n\tvar off = _deflateRaw(data, buf);\n\treturn buf.slice(0, off);\n}\n/* modified inflate function also moves original read head */\n\nvar dyn_lmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);\nvar dyn_dmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);\nvar dyn_cmap = use_typed_arrays ? new Uint16Array(128)   : zero_fill_array(128);\nvar dyn_len_1 = 1, dyn_len_2 = 1;\n\n/* 5.5.3 Expanding Huffman Codes */\nfunction dyn(data, boff) {\n\t/* nomenclature from RFC1951 refers to bit values; these are offset by the implicit constant */\n\tvar _HLIT = read_bits_5(data, boff) + 257; boff += 5;\n\tvar _HDIST = read_bits_5(data, boff) + 1; boff += 5;\n\tvar _HCLEN = read_bits_4(data, boff) + 4; boff += 4;\n\tvar w = 0;\n\n\t/* grab and store code lengths */\n\tvar clens = use_typed_arrays ? new Uint8Array(19) : zero_fill_array(19);\n\tvar ctree = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];\n\tvar maxlen = 1;\n\tvar bl_count =  use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);\n\tvar next_code = use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);\n\tvar L = clens.length; /* 19 */\n\tfor(var i = 0; i < _HCLEN; ++i) {\n\t\tclens[CLEN_ORDER[i]] = w = read_bits_3(data, boff);\n\t\tif(maxlen < w) maxlen = w;\n\t\tbl_count[w]++;\n\t\tboff += 3;\n\t}\n\n\t/* build code tree */\n\tvar ccode = 0;\n\tbl_count[0] = 0;\n\tfor(i = 1; i <= maxlen; ++i) next_code[i] = ccode = (ccode + bl_count[i-1])<<1;\n\tfor(i = 0; i < L; ++i) if((ccode = clens[i]) != 0) ctree[i] = next_code[ccode]++;\n\t/* cmap[7 bits from stream] = (off&7) + (lit<<3) */\n\tvar cleni = 0;\n\tfor(i = 0; i < L; ++i) {\n\t\tcleni = clens[i];\n\t\tif(cleni != 0) {\n\t\t\tccode = bitswap8[ctree[i]]>>(8-cleni);\n\t\t\tfor(var j = (1<<(7-cleni))-1; j>=0; --j) dyn_cmap[ccode|(j<<cleni)] = (cleni&7) | (i<<3);\n\t\t}\n\t}\n\n\t/* read literal and dist codes at once */\n\tvar hcodes = [];\n\tmaxlen = 1;\n\tfor(; hcodes.length < _HLIT + _HDIST;) {\n\t\tccode = dyn_cmap[read_bits_7(data, boff)];\n\t\tboff += ccode & 7;\n\t\tswitch((ccode >>>= 3)) {\n\t\t\tcase 16:\n\t\t\t\tw = 3 + read_bits_2(data, boff); boff += 2;\n\t\t\t\tccode = hcodes[hcodes.length - 1];\n\t\t\t\twhile(w-- > 0) hcodes.push(ccode);\n\t\t\t\tbreak;\n\t\t\tcase 17:\n\t\t\t\tw = 3 + read_bits_3(data, boff); boff += 3;\n\t\t\t\twhile(w-- > 0) hcodes.push(0);\n\t\t\t\tbreak;\n\t\t\tcase 18:\n\t\t\t\tw = 11 + read_bits_7(data, boff); boff += 7;\n\t\t\t\twhile(w -- > 0) hcodes.push(0);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\thcodes.push(ccode);\n\t\t\t\tif(maxlen < ccode) maxlen = ccode;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* build literal / length trees */\n\tvar h1 = hcodes.slice(0, _HLIT), h2 = hcodes.slice(_HLIT);\n\tfor(i = _HLIT; i < 286; ++i) h1[i] = 0;\n\tfor(i = _HDIST; i < 30; ++i) h2[i] = 0;\n\tdyn_len_1 = build_tree(h1, dyn_lmap, 286);\n\tdyn_len_2 = build_tree(h2, dyn_dmap, 30);\n\treturn boff;\n}\n\n/* return [ data, bytesRead ] */\nfunction inflate(data, usz) {\n\t/* shortcircuit for empty buffer [0x03, 0x00] */\n\tif(data[0] == 3 && !(data[1] & 0x3)) { return [new_raw_buf(usz), 2]; }\n\n\t/* bit offset */\n\tvar boff = 0;\n\n\t/* header includes final bit and type bits */\n\tvar header = 0;\n\n\tvar outbuf = new_unsafe_buf(usz ? usz : (1<<18));\n\tvar woff = 0;\n\tvar OL = outbuf.length>>>0;\n\tvar max_len_1 = 0, max_len_2 = 0;\n\n\twhile((header&1) == 0) {\n\t\theader = read_bits_3(data, boff); boff += 3;\n\t\tif((header >>> 1) == 0) {\n\t\t\t/* Stored block */\n\t\t\tif(boff & 7) boff += 8 - (boff&7);\n\t\t\t/* 2 bytes sz, 2 bytes bit inverse */\n\t\t\tvar sz = data[boff>>>3] | data[(boff>>>3)+1]<<8;\n\t\t\tboff += 32;\n\t\t\t/* push sz bytes */\n\t\t\tif(sz > 0) {\n\t\t\t\tif(!usz && OL < woff + sz) { outbuf = realloc(outbuf, woff + sz); OL = outbuf.length; }\n\t\t\t\twhile(sz-- > 0) { outbuf[woff++] = data[boff>>>3]; boff += 8; }\n\t\t\t}\n\t\t\tcontinue;\n\t\t} else if((header >> 1) == 1) {\n\t\t\t/* Fixed Huffman */\n\t\t\tmax_len_1 = 9; max_len_2 = 5;\n\t\t} else {\n\t\t\t/* Dynamic Huffman */\n\t\t\tboff = dyn(data, boff);\n\t\t\tmax_len_1 = dyn_len_1; max_len_2 = dyn_len_2;\n\t\t}\n\t\tfor(;;) { // while(true) is apparently out of vogue in modern JS circles\n\t\t\tif(!usz && (OL < woff + 32767)) { outbuf = realloc(outbuf, woff + 32767); OL = outbuf.length; }\n\t\t\t/* ingest code and move read head */\n\t\t\tvar bits = read_bits_n(data, boff, max_len_1);\n\t\t\tvar code = (header>>>1) == 1 ? fix_lmap[bits] : dyn_lmap[bits];\n\t\t\tboff += code & 15; code >>>= 4;\n\t\t\t/* 0-255 are literals, 256 is end of block token, 257+ are copy tokens */\n\t\t\tif(((code>>>8)&0xFF) === 0) outbuf[woff++] = code;\n\t\t\telse if(code == 256) break;\n\t\t\telse {\n\t\t\t\tcode -= 257;\n\t\t\t\tvar len_eb = (code < 8) ? 0 : ((code-4)>>2); if(len_eb > 5) len_eb = 0;\n\t\t\t\tvar tgt = woff + LEN_LN[code];\n\t\t\t\t/* length extra bits */\n\t\t\t\tif(len_eb > 0) {\n\t\t\t\t\ttgt += read_bits_n(data, boff, len_eb);\n\t\t\t\t\tboff += len_eb;\n\t\t\t\t}\n\n\t\t\t\t/* dist code */\n\t\t\t\tbits = read_bits_n(data, boff, max_len_2);\n\t\t\t\tcode = (header>>>1) == 1 ? fix_dmap[bits] : dyn_dmap[bits];\n\t\t\t\tboff += code & 15; code >>>= 4;\n\t\t\t\tvar dst_eb = (code < 4 ? 0 : (code-2)>>1);\n\t\t\t\tvar dst = DST_LN[code];\n\t\t\t\t/* dist extra bits */\n\t\t\t\tif(dst_eb > 0) {\n\t\t\t\t\tdst += read_bits_n(data, boff, dst_eb);\n\t\t\t\t\tboff += dst_eb;\n\t\t\t\t}\n\n\t\t\t\t/* in the common case, manual byte copy is faster than TA set / Buffer copy */\n\t\t\t\tif(!usz && OL < tgt) { outbuf = realloc(outbuf, tgt + 100); OL = outbuf.length; }\n\t\t\t\twhile(woff < tgt) { outbuf[woff] = outbuf[woff - dst]; ++woff; }\n\t\t\t}\n\t\t}\n\t}\n\tif(usz) return [outbuf, (boff+7)>>>3];\n\treturn [outbuf.slice(0, woff), (boff+7)>>>3];\n}\n\nfunction _inflate(payload, usz) {\n\tvar data = payload.slice(payload.l||0);\n\tvar out = inflate(data, usz);\n\tpayload.l += out[1];\n\treturn out[0];\n}\n\nfunction warn_or_throw(wrn, msg) {\n\tif(wrn) { if(typeof console !== 'undefined') console.error(msg); }\n\telse throw new Error(msg);\n}\n\nfunction parse_zip(file, options) {\n\tvar blob = file;\n\tprep_blob(blob, 0);\n\n\tvar FileIndex = [], FullPaths = [];\n\tvar o = {\n\t\tFileIndex: FileIndex,\n\t\tFullPaths: FullPaths\n\t};\n\tinit_cfb(o, { root: options.root });\n\n\t/* find end of central directory, start just after signature */\n\tvar i = blob.length - 4;\n\twhile((blob[i] != 0x50 || blob[i+1] != 0x4b || blob[i+2] != 0x05 || blob[i+3] != 0x06) && i >= 0) --i;\n\tblob.l = i + 4;\n\n\t/* parse end of central directory */\n\tblob.l += 4;\n\tvar fcnt = blob.read_shift(2);\n\tblob.l += 6;\n\tvar start_cd = blob.read_shift(4);\n\n\t/* parse central directory */\n\tblob.l = start_cd;\n\n\tfor(i = 0; i < fcnt; ++i) {\n\t\t/* trust local file header instead of CD entry */\n\t\tblob.l += 20;\n\t\tvar csz = blob.read_shift(4);\n\t\tvar usz = blob.read_shift(4);\n\t\tvar namelen = blob.read_shift(2);\n\t\tvar efsz = blob.read_shift(2);\n\t\tvar fcsz = blob.read_shift(2);\n\t\tblob.l += 8;\n\t\tvar offset = blob.read_shift(4);\n\t\tvar EF = parse_extra_field(blob.slice(blob.l+namelen, blob.l+namelen+efsz));\n\t\tblob.l += namelen + efsz + fcsz;\n\n\t\tvar L = blob.l;\n\t\tblob.l = offset + 4;\n\t\tparse_local_file(blob, csz, usz, o, EF);\n\t\tblob.l = L;\n\t}\n\treturn o;\n}\n\n\n/* head starts just after local file header signature */\nfunction parse_local_file(blob, csz, usz, o, EF) {\n\t/* [local file header] */\n\tblob.l += 2;\n\tvar flags = blob.read_shift(2);\n\tvar meth = blob.read_shift(2);\n\tvar date = parse_dos_date(blob);\n\n\tif(flags & 0x2041) throw new Error(\"Unsupported ZIP encryption\");\n\tvar crc32 = blob.read_shift(4);\n\tvar _csz = blob.read_shift(4);\n\tvar _usz = blob.read_shift(4);\n\n\tvar namelen = blob.read_shift(2);\n\tvar efsz = blob.read_shift(2);\n\n\t// TODO: flags & (1<<11) // UTF8\n\tvar name = \"\"; for(var i = 0; i < namelen; ++i) name += String.fromCharCode(blob[blob.l++]);\n\tif(efsz) {\n\t\tvar ef = parse_extra_field(blob.slice(blob.l, blob.l + efsz));\n\t\tif((ef[0x5455]||{}).mt) date = ef[0x5455].mt;\n\t\tif(((EF||{})[0x5455]||{}).mt) date = EF[0x5455].mt;\n\t}\n\tblob.l += efsz;\n\n\t/* [encryption header] */\n\n\t/* [file data] */\n\tvar data = blob.slice(blob.l, blob.l + _csz);\n\tswitch(meth) {\n\t\tcase 8: data = _inflateRawSync(blob, _usz); break;\n\t\tcase 0: break; // TODO: scan for magic number\n\t\tdefault: throw new Error(\"Unsupported ZIP Compression method \" + meth);\n\t}\n\n\t/* [data descriptor] */\n\tvar wrn = false;\n\tif(flags & 8) {\n\t\tcrc32 = blob.read_shift(4);\n\t\tif(crc32 == 0x08074b50) { crc32 = blob.read_shift(4); wrn = true; }\n\t\t_csz = blob.read_shift(4);\n\t\t_usz = blob.read_shift(4);\n\t}\n\n\tif(_csz != csz) warn_or_throw(wrn, \"Bad compressed size: \" + csz + \" != \" + _csz);\n\tif(_usz != usz) warn_or_throw(wrn, \"Bad uncompressed size: \" + usz + \" != \" + _usz);\n\t//var _crc32 = CRC32.buf(data, 0);\n\t//if((crc32>>0) != (_crc32>>0)) warn_or_throw(wrn, \"Bad CRC32 checksum: \" + crc32 + \" != \" + _crc32);\n\tcfb_add(o, name, data, {unsafe: true, mt: date});\n}\nfunction write_zip(cfb, options) {\n\tvar _opts = options || {};\n\tvar out = [], cdirs = [];\n\tvar o = new_buf(1);\n\tvar method = (_opts.compression ? 8 : 0), flags = 0;\n\tvar desc = false;\n\tif(desc) flags |= 8;\n\tvar i = 0, j = 0;\n\n\tvar start_cd = 0, fcnt = 0;\n\tvar root = cfb.FullPaths[0], fp = root, fi = cfb.FileIndex[0];\n\tvar crcs = [];\n\tvar sz_cd = 0;\n\n\tfor(i = 1; i < cfb.FullPaths.length; ++i) {\n\t\tfp = cfb.FullPaths[i].slice(root.length); fi = cfb.FileIndex[i];\n\t\tif(!fi.size || !fi.content || fp == \"\\u0001Sh33tJ5\") continue;\n\t\tvar start = start_cd;\n\n\t\t/* TODO: CP437 filename */\n\t\tvar namebuf = new_buf(fp.length);\n\t\tfor(j = 0; j < fp.length; ++j) namebuf.write_shift(1, fp.charCodeAt(j) & 0x7F);\n\t\tnamebuf = namebuf.slice(0, namebuf.l);\n\t\tcrcs[fcnt] = CRC32.buf(fi.content, 0);\n\n\t\tvar outbuf = fi.content;\n\t\tif(method == 8) outbuf = _deflateRawSync(outbuf);\n\n\t\t/* local file header */\n\t\to = new_buf(30);\n\t\to.write_shift(4, 0x04034b50);\n\t\to.write_shift(2, 20);\n\t\to.write_shift(2, flags);\n\t\to.write_shift(2, method);\n\t\t/* TODO: last mod file time/date */\n\t\tif(fi.mt) write_dos_date(o, fi.mt);\n\t\telse o.write_shift(4, 0);\n\t\to.write_shift(-4, (flags & 8) ? 0 : crcs[fcnt]);\n\t\to.write_shift(4,  (flags & 8) ? 0 : outbuf.length);\n\t\to.write_shift(4,  (flags & 8) ? 0 : fi.content.length);\n\t\to.write_shift(2, namebuf.length);\n\t\to.write_shift(2, 0);\n\n\t\tstart_cd += o.length;\n\t\tout.push(o);\n\t\tstart_cd += namebuf.length;\n\t\tout.push(namebuf);\n\n\t\t/* TODO: extra fields? */\n\n\t\t/* TODO: encryption header ? */\n\n\t\tstart_cd += outbuf.length;\n\t\tout.push(outbuf);\n\n\t\t/* data descriptor */\n\t\tif(flags & 8) {\n\t\t\to = new_buf(12);\n\t\t\to.write_shift(-4, crcs[fcnt]);\n\t\t\to.write_shift(4, outbuf.length);\n\t\t\to.write_shift(4, fi.content.length);\n\t\t\tstart_cd += o.l;\n\t\t\tout.push(o);\n\t\t}\n\n\t\t/* central directory */\n\t\to = new_buf(46);\n\t\to.write_shift(4, 0x02014b50);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 20);\n\t\to.write_shift(2, flags);\n\t\to.write_shift(2, method);\n\t\to.write_shift(4, 0); /* TODO: last mod file time/date */\n\t\to.write_shift(-4, crcs[fcnt]);\n\n\t\to.write_shift(4, outbuf.length);\n\t\to.write_shift(4, fi.content.length);\n\t\to.write_shift(2, namebuf.length);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(4, 0);\n\t\to.write_shift(4, start);\n\n\t\tsz_cd += o.l;\n\t\tcdirs.push(o);\n\t\tsz_cd += namebuf.length;\n\t\tcdirs.push(namebuf);\n\t\t++fcnt;\n\t}\n\n\t/* end of central directory */\n\to = new_buf(22);\n\to.write_shift(4, 0x06054b50);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, fcnt);\n\to.write_shift(2, fcnt);\n\to.write_shift(4, sz_cd);\n\to.write_shift(4, start_cd);\n\to.write_shift(2, 0);\n\n\treturn bconcat(([bconcat((out)), bconcat(cdirs), o]));\n}\nvar ContentTypeMap = ({\n\t\"htm\": \"text/html\",\n\t\"xml\": \"text/xml\",\n\n\t\"gif\": \"image/gif\",\n\t\"jpg\": \"image/jpeg\",\n\t\"png\": \"image/png\",\n\n\t\"mso\": \"application/x-mso\",\n\t\"thmx\": \"application/vnd.ms-officetheme\",\n\t\"sh33tj5\": \"application/octet-stream\"\n});\n\nfunction get_content_type(fi, fp) {\n\tif(fi.ctype) return fi.ctype;\n\n\tvar ext = fi.name || \"\", m = ext.match(/\\.([^\\.]+)$/);\n\tif(m && ContentTypeMap[m[1]]) return ContentTypeMap[m[1]];\n\n\tif(fp) {\n\t\tm = (ext = fp).match(/[\\.\\\\]([^\\.\\\\])+$/);\n\t\tif(m && ContentTypeMap[m[1]]) return ContentTypeMap[m[1]];\n\t}\n\n\treturn \"application/octet-stream\";\n}\n\n/* 76 character chunks TODO: intertwine encoding */\nfunction write_base64_76(bstr) {\n\tvar data = Base64_encode(bstr);\n\tvar o = [];\n\tfor(var i = 0; i < data.length; i+= 76) o.push(data.slice(i, i+76));\n\treturn o.join(\"\\r\\n\") + \"\\r\\n\";\n}\n\n/*\nRules for QP:\n\t- escape =## applies for all non-display characters and literal \"=\"\n\t- space or tab at end of line must be encoded\n\t- \\r\\n newlines can be preserved, but bare \\r and \\n must be escaped\n\t- lines must not exceed 76 characters, use soft breaks =\\r\\n\n\nTODO: Some files from word appear to write line extensions with bare equals:\n\n```\n<table class=3DMsoTableGrid border=3D1 cellspacing=3D0 cellpadding=3D0 width=\n=\"70%\"\n```\n*/\nfunction write_quoted_printable(text) {\n\tvar encoded = text.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7E-\\xFF=]/g, function(c) {\n\t\tvar w = c.charCodeAt(0).toString(16).toUpperCase();\n\t\treturn \"=\" + (w.length == 1 ? \"0\" + w : w);\n\t});\n\n\tencoded = encoded.replace(/ $/mg, \"=20\").replace(/\\t$/mg, \"=09\");\n\n\tif(encoded.charAt(0) == \"\\n\") encoded = \"=0D\" + encoded.slice(1);\n\tencoded = encoded.replace(/\\r(?!\\n)/mg, \"=0D\").replace(/\\n\\n/mg, \"\\n=0A\").replace(/([^\\r\\n])\\n/mg, \"$1=0A\");\n\n\tvar o = [], split = encoded.split(\"\\r\\n\");\n\tfor(var si = 0; si < split.length; ++si) {\n\t\tvar str = split[si];\n\t\tif(str.length == 0) { o.push(\"\"); continue; }\n\t\tfor(var i = 0; i < str.length;) {\n\t\t\tvar end = 76;\n\t\t\tvar tmp = str.slice(i, i + end);\n\t\t\tif(tmp.charAt(end - 1) == \"=\") end --;\n\t\t\telse if(tmp.charAt(end - 2) == \"=\") end -= 2;\n\t\t\telse if(tmp.charAt(end - 3) == \"=\") end -= 3;\n\t\t\ttmp = str.slice(i, i + end);\n\t\t\ti += end;\n\t\t\tif(i < str.length) tmp += \"=\";\n\t\t\to.push(tmp);\n\t\t}\n\t}\n\n\treturn o.join(\"\\r\\n\");\n}\nfunction parse_quoted_printable(data) {\n\tvar o = [];\n\n\t/* unify long lines */\n\tfor(var di = 0; di < data.length; ++di) {\n\t\tvar line = data[di];\n\t\twhile(di <= data.length && line.charAt(line.length - 1) == \"=\") line = line.slice(0, line.length - 1) + data[++di];\n\t\to.push(line);\n\t}\n\n\t/* decode */\n\tfor(var oi = 0; oi < o.length; ++oi) o[oi] = o[oi].replace(/[=][0-9A-Fa-f]{2}/g, function($$) { return String.fromCharCode(parseInt($$.slice(1), 16)); });\n\treturn s2a(o.join(\"\\r\\n\"));\n}\n\n\nfunction parse_mime(cfb, data, root) {\n\tvar fname = \"\", cte = \"\", ctype = \"\", fdata;\n\tvar di = 0;\n\tfor(;di < 10; ++di) {\n\t\tvar line = data[di];\n\t\tif(!line || line.match(/^\\s*$/)) break;\n\t\tvar m = line.match(/^(.*?):\\s*([^\\s].*)$/);\n\t\tif(m) switch(m[1].toLowerCase()) {\n\t\t\tcase \"content-location\": fname = m[2].trim(); break;\n\t\t\tcase \"content-type\": ctype = m[2].trim(); break;\n\t\t\tcase \"content-transfer-encoding\": cte = m[2].trim(); break;\n\t\t}\n\t}\n\t++di;\n\tswitch(cte.toLowerCase()) {\n\t\tcase 'base64': fdata = s2a(Base64_decode(data.slice(di).join(\"\"))); break;\n\t\tcase 'quoted-printable': fdata = parse_quoted_printable(data.slice(di)); break;\n\t\tdefault: throw new Error(\"Unsupported Content-Transfer-Encoding \" + cte);\n\t}\n\tvar file = cfb_add(cfb, fname.slice(root.length), fdata, {unsafe: true});\n\tif(ctype) file.ctype = ctype;\n}\n\nfunction parse_mad(file, options) {\n\tif(a2s(file.slice(0,13)).toLowerCase() != \"mime-version:\") throw new Error(\"Unsupported MAD header\");\n\tvar root = (options && options.root || \"\");\n\t// $FlowIgnore\n\tvar data = (has_buf && Buffer.isBuffer(file) ? file.toString(\"binary\") : a2s(file)).split(\"\\r\\n\");\n\tvar di = 0, row = \"\";\n\n\t/* if root is not specified, scan for the common prefix */\n\tfor(di = 0; di < data.length; ++di) {\n\t\trow = data[di];\n\t\tif(!/^Content-Location:/i.test(row)) continue;\n\t\trow = row.slice(row.indexOf(\"file\"));\n\t\tif(!root) root = row.slice(0, row.lastIndexOf(\"/\") + 1);\n\t\tif(row.slice(0, root.length) == root) continue;\n\t\twhile(root.length > 0) {\n\t\t\troot = root.slice(0, root.length - 1);\n\t\t\troot = root.slice(0, root.lastIndexOf(\"/\") + 1);\n\t\t\tif(row.slice(0,root.length) == root) break;\n\t\t}\n\t}\n\n\tvar mboundary = (data[1] || \"\").match(/boundary=\"(.*?)\"/);\n\tif(!mboundary) throw new Error(\"MAD cannot find boundary\");\n\tvar boundary = \"--\" + (mboundary[1] || \"\");\n\n\tvar FileIndex = [], FullPaths = [];\n\tvar o = {\n\t\tFileIndex: FileIndex,\n\t\tFullPaths: FullPaths\n\t};\n\tinit_cfb(o);\n\tvar start_di, fcnt = 0;\n\tfor(di = 0; di < data.length; ++di) {\n\t\tvar line = data[di];\n\t\tif(line !== boundary && line !== boundary + \"--\") continue;\n\t\tif(fcnt++) parse_mime(o, data.slice(start_di, di), root);\n\t\tstart_di = di;\n\t}\n\treturn o;\n}\n\nfunction write_mad(cfb, options) {\n\tvar opts = options || {};\n\tvar boundary = opts.boundary || \"SheetJS\";\n\tboundary = '------=' + boundary;\n\n\tvar out = [\n\t\t'MIME-Version: 1.0',\n\t\t'Content-Type: multipart/related; boundary=\"' + boundary.slice(2) + '\"',\n\t\t'',\n\t\t'',\n\t\t''\n\t];\n\n\tvar root = cfb.FullPaths[0], fp = root, fi = cfb.FileIndex[0];\n\tfor(var i = 1; i < cfb.FullPaths.length; ++i) {\n\t\tfp = cfb.FullPaths[i].slice(root.length);\n\t\tfi = cfb.FileIndex[i];\n\t\tif(!fi.size || !fi.content || fp == \"\\u0001Sh33tJ5\") continue;\n\n\t\t/* Normalize filename */\n\t\tfp = fp.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7E-\\xFF]/g, function(c) {\n\t\t\treturn \"_x\" + c.charCodeAt(0).toString(16) + \"_\";\n\t\t}).replace(/[\\u0080-\\uFFFF]/g, function(u) {\n\t\t\treturn \"_u\" + u.charCodeAt(0).toString(16) + \"_\";\n\t\t});\n\n\t\t/* Extract content as binary string */\n\t\tvar ca = fi.content;\n\t\t// $FlowIgnore\n\t\tvar cstr = has_buf && Buffer.isBuffer(ca) ? ca.toString(\"binary\") : a2s(ca);\n\n\t\t/* 4/5 of first 1024 chars ascii -> quoted printable, else base64 */\n\t\tvar dispcnt = 0, L = Math.min(1024, cstr.length), cc = 0;\n\t\tfor(var csl = 0; csl <= L; ++csl) if((cc=cstr.charCodeAt(csl)) >= 0x20 && cc < 0x80) ++dispcnt;\n\t\tvar qp = dispcnt >= L * 4 / 5;\n\n\t\tout.push(boundary);\n\t\tout.push('Content-Location: ' + (opts.root || 'file:///C:/SheetJS/') + fp);\n\t\tout.push('Content-Transfer-Encoding: ' + (qp ? 'quoted-printable' : 'base64'));\n\t\tout.push('Content-Type: ' + get_content_type(fi, fp));\n\t\tout.push('');\n\n\t\tout.push(qp ? write_quoted_printable(cstr) : write_base64_76(cstr));\n\t}\n\tout.push(boundary + '--\\r\\n');\n\treturn out.join(\"\\r\\n\");\n}\nfunction cfb_new(opts) {\n\tvar o = ({});\n\tinit_cfb(o, opts);\n\treturn o;\n}\n\nfunction cfb_add(cfb, name, content, opts) {\n\tvar unsafe = opts && opts.unsafe;\n\tif(!unsafe) init_cfb(cfb);\n\tvar file = !unsafe && CFB.find(cfb, name);\n\tif(!file) {\n\t\tvar fpath = cfb.FullPaths[0];\n\t\tif(name.slice(0, fpath.length) == fpath) fpath = name;\n\t\telse {\n\t\t\tif(fpath.slice(-1) != \"/\") fpath += \"/\";\n\t\t\tfpath = (fpath + name).replace(\"//\",\"/\");\n\t\t}\n\t\tfile = ({name: filename(name), type: 2});\n\t\tcfb.FileIndex.push(file);\n\t\tcfb.FullPaths.push(fpath);\n\t\tif(!unsafe) CFB.utils.cfb_gc(cfb);\n\t}\nfile.content = (content);\n\tfile.size = content ? content.length : 0;\n\tif(opts) {\n\t\tif(opts.CLSID) file.clsid = opts.CLSID;\n\t\tif(opts.mt) file.mt = opts.mt;\n\t\tif(opts.ct) file.ct = opts.ct;\n\t}\n\treturn file;\n}\n\nfunction cfb_del(cfb, name) {\n\tinit_cfb(cfb);\n\tvar file = CFB.find(cfb, name);\n\tif(file) for(var j = 0; j < cfb.FileIndex.length; ++j) if(cfb.FileIndex[j] == file) {\n\t\tcfb.FileIndex.splice(j, 1);\n\t\tcfb.FullPaths.splice(j, 1);\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction cfb_mov(cfb, old_name, new_name) {\n\tinit_cfb(cfb);\n\tvar file = CFB.find(cfb, old_name);\n\tif(file) for(var j = 0; j < cfb.FileIndex.length; ++j) if(cfb.FileIndex[j] == file) {\n\t\tcfb.FileIndex[j].name = filename(new_name);\n\t\tcfb.FullPaths[j] = new_name;\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction cfb_gc(cfb) { rebuild_cfb(cfb, true); }\n\nexports.find = find;\nexports.read = read;\nexports.parse = parse;\nexports.write = write;\nexports.writeFile = write_file;\nexports.utils = {\n\tcfb_new: cfb_new,\n\tcfb_add: cfb_add,\n\tcfb_del: cfb_del,\n\tcfb_mov: cfb_mov,\n\tcfb_gc: cfb_gc,\n\tReadShift: ReadShift,\n\tCheckField: CheckField,\n\tprep_blob: prep_blob,\n\tbconcat: bconcat,\n\tuse_zlib: use_zlib,\n\t_deflateRaw: _deflate,\n\t_inflateRaw: _inflate,\n\tconsts: consts\n};\n\nreturn exports;\n})();\n\nvar _fs;\nif(typeof require !== 'undefined') try { _fs = require('fs'); } catch(e) {}\n\n/* normalize data for blob ctor */\nfunction blobify(data) {\n\tif(typeof data === \"string\") return s2ab(data);\n\tif(Array.isArray(data)) return a2u(data);\n\treturn data;\n}\n/* write or download file */\nfunction write_dl(fname, payload, enc) {\n\t/*global IE_SaveFile, Blob, navigator, saveAs, document, File, chrome */\n\tif(typeof _fs !== 'undefined' && _fs.writeFileSync) return enc ? _fs.writeFileSync(fname, payload, enc) : _fs.writeFileSync(fname, payload);\n\tif(typeof Deno !== 'undefined') {\n\t\t/* in this spot, it's safe to assume typed arrays and TextEncoder/TextDecoder exist */\n\t\tif(enc && typeof payload == \"string\") switch(enc) {\n\t\t\tcase \"utf8\": payload = new TextEncoder(enc).encode(payload); break;\n\t\t\tcase \"binary\": payload = s2ab(payload); break;\n\t\t\t/* TODO: binary equivalent */\n\t\t\tdefault: throw new Error(\"Unsupported encoding \" + enc);\n\t\t}\n\t\treturn Deno.writeFileSync(fname, payload);\n\t}\n\tvar data = (enc == \"utf8\") ? utf8write(payload) : payload;\nif(typeof IE_SaveFile !== 'undefined') return IE_SaveFile(data, fname);\n\tif(typeof Blob !== 'undefined') {\n\t\tvar blob = new Blob([blobify(data)], {type:\"application/octet-stream\"});\nif(typeof navigator !== 'undefined' && navigator.msSaveBlob) return navigator.msSaveBlob(blob, fname);\nif(typeof saveAs !== 'undefined') return saveAs(blob, fname);\n\t\tif(typeof URL !== 'undefined' && typeof document !== 'undefined' && document.createElement && URL.createObjectURL) {\n\t\t\tvar url = URL.createObjectURL(blob);\nif(typeof chrome === 'object' && typeof (chrome.downloads||{}).download == \"function\") {\n\t\t\t\tif(URL.revokeObjectURL && typeof setTimeout !== 'undefined') setTimeout(function() { URL.revokeObjectURL(url); }, 60000);\n\t\t\t\treturn chrome.downloads.download({ url: url, filename: fname, saveAs: true});\n\t\t\t}\n\t\t\tvar a = document.createElement(\"a\");\n\t\t\tif(a.download != null) {\na.download = fname; a.href = url; document.body.appendChild(a); a.click();\ndocument.body.removeChild(a);\n\t\t\t\tif(URL.revokeObjectURL && typeof setTimeout !== 'undefined') setTimeout(function() { URL.revokeObjectURL(url); }, 60000);\n\t\t\t\treturn url;\n\t\t\t}\n\t\t}\n\t}\n\t// $FlowIgnore\n\tif(typeof $ !== 'undefined' && typeof File !== 'undefined' && typeof Folder !== 'undefined') try { // extendscript\n\t\t// $FlowIgnore\n\t\tvar out = File(fname); out.open(\"w\"); out.encoding = \"binary\";\n\t\tif(Array.isArray(payload)) payload = a2s(payload);\n\t\tout.write(payload); out.close(); return payload;\n\t} catch(e) { if(!e.message || !e.message.match(/onstruct/)) throw e; }\n\tthrow new Error(\"cannot save file \" + fname);\n}\n\n/* read binary data from file */\nfunction read_binary(path) {\n\tif(typeof _fs !== 'undefined') return _fs.readFileSync(path);\n\tif(typeof Deno !== 'undefined') return Deno.readFileSync(path);\n\t// $FlowIgnore\n\tif(typeof $ !== 'undefined' && typeof File !== 'undefined' && typeof Folder !== 'undefined') try { // extendscript\n\t\t// $FlowIgnore\n\t\tvar infile = File(path); infile.open(\"r\"); infile.encoding = \"binary\";\n\t\tvar data = infile.read(); infile.close();\n\t\treturn data;\n\t} catch(e) { if(!e.message || !e.message.match(/onstruct/)) throw e; }\n\tthrow new Error(\"Cannot access file \" + path);\n}\nfunction keys(o) {\n\tvar ks = Object.keys(o), o2 = [];\n\tfor(var i = 0; i < ks.length; ++i) if(Object.prototype.hasOwnProperty.call(o, ks[i])) o2.push(ks[i]);\n\treturn o2;\n}\n\nfunction evert_key(obj, key) {\n\tvar o = ([]), K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) if(o[obj[K[i]][key]] == null) o[obj[K[i]][key]] = K[i];\n\treturn o;\n}\n\nfunction evert(obj) {\n\tvar o = ([]), K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) o[obj[K[i]]] = K[i];\n\treturn o;\n}\n\nfunction evert_num(obj) {\n\tvar o = ([]), K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) o[obj[K[i]]] = parseInt(K[i],10);\n\treturn o;\n}\n\nfunction evert_arr(obj) {\n\tvar o = ([]), K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) {\n\t\tif(o[obj[K[i]]] == null) o[obj[K[i]]] = [];\n\t\to[obj[K[i]]].push(K[i]);\n\t}\n\treturn o;\n}\n\nvar basedate = new Date(1899, 11, 30, 0, 0, 0); // 2209161600000\nfunction datenum(v, date1904) {\n\tvar epoch = v.getTime();\n\tif(date1904) epoch -= 1462*24*60*60*1000;\n\tvar dnthresh = basedate.getTime() + (v.getTimezoneOffset() - basedate.getTimezoneOffset()) * 60000;\n\treturn (epoch - dnthresh) / (24 * 60 * 60 * 1000);\n}\nvar refdate = new Date();\nvar dnthresh = basedate.getTime() + (refdate.getTimezoneOffset() - basedate.getTimezoneOffset()) * 60000;\nvar refoffset = refdate.getTimezoneOffset();\nfunction numdate(v) {\n\tvar out = new Date();\n\tout.setTime(v * 24 * 60 * 60 * 1000 + dnthresh);\n\tif (out.getTimezoneOffset() !== refoffset) {\n\t\tout.setTime(out.getTime() + (out.getTimezoneOffset() - refoffset) * 60000);\n\t}\n\treturn out;\n}\n\n/* ISO 8601 Duration */\nfunction parse_isodur(s) {\n\tvar sec = 0, mt = 0, time = false;\n\tvar m = s.match(/P([0-9\\.]+Y)?([0-9\\.]+M)?([0-9\\.]+D)?T([0-9\\.]+H)?([0-9\\.]+M)?([0-9\\.]+S)?/);\n\tif(!m) throw new Error(\"|\" + s + \"| is not an ISO8601 Duration\");\n\tfor(var i = 1; i != m.length; ++i) {\n\t\tif(!m[i]) continue;\n\t\tmt = 1;\n\t\tif(i > 3) time = true;\n\t\tswitch(m[i].slice(m[i].length-1)) {\n\t\t\tcase 'Y':\n\t\t\t\tthrow new Error(\"Unsupported ISO Duration Field: \" + m[i].slice(m[i].length-1));\n\t\t\tcase 'D': mt *= 24;\n\t\t\t\t/* falls through */\n\t\t\tcase 'H': mt *= 60;\n\t\t\t\t/* falls through */\n\t\t\tcase 'M':\n\t\t\t\tif(!time) throw new Error(\"Unsupported ISO Duration Field: M\");\n\t\t\t\telse mt *= 60;\n\t\t\t\t/* falls through */\n\t\t\tcase 'S': break;\n\t\t}\n\t\tsec += mt * parseInt(m[i], 10);\n\t}\n\treturn sec;\n}\n\nvar good_pd_date_1 = new Date('2017-02-19T19:06:09.000Z');\nvar good_pd_date = isNaN(good_pd_date_1.getFullYear()) ? new Date('2/19/17') : good_pd_date_1;\nvar good_pd = good_pd_date.getFullYear() == 2017;\n/* parses a date as a local date */\nfunction parseDate(str, fixdate) {\n\tvar d = new Date(str);\n\tif(good_pd) {\nif(fixdate > 0) d.setTime(d.getTime() + d.getTimezoneOffset() * 60 * 1000);\n\t\telse if(fixdate < 0) d.setTime(d.getTime() - d.getTimezoneOffset() * 60 * 1000);\n\t\treturn d;\n\t}\n\tif(str instanceof Date) return str;\n\tif(good_pd_date.getFullYear() == 1917 && !isNaN(d.getFullYear())) {\n\t\tvar s = d.getFullYear();\n\t\tif(str.indexOf(\"\" + s) > -1) return d;\n\t\td.setFullYear(d.getFullYear() + 100); return d;\n\t}\n\tvar n = str.match(/\\d+/g)||[\"2017\",\"2\",\"19\",\"0\",\"0\",\"0\"];\n\tvar out = new Date(+n[0], +n[1] - 1, +n[2], (+n[3]||0), (+n[4]||0), (+n[5]||0));\n\tif(str.indexOf(\"Z\") > -1) out = new Date(out.getTime() - out.getTimezoneOffset() * 60 * 1000);\n\treturn out;\n}\n\nfunction cc2str(arr, debomit) {\n\tif(has_buf && Buffer.isBuffer(arr)) {\n\t\tif(debomit) {\n\t\t\tif(arr[0] == 0xFF && arr[1] == 0xFE) return utf8write(arr.slice(2).toString(\"utf16le\"));\n\t\t\tif(arr[1] == 0xFE && arr[2] == 0xFF) return utf8write(utf16beread(arr.slice(2).toString(\"binary\")));\n\t\t}\n\t\treturn arr.toString(\"binary\");\n\t}\n\n\tif(typeof TextDecoder !== \"undefined\") try {\n\t\tif(debomit) {\n\t\t\tif(arr[0] == 0xFF && arr[1] == 0xFE) return utf8write(new TextDecoder(\"utf-16le\").decode(arr.slice(2)));\n\t\t\tif(arr[0] == 0xFE && arr[1] == 0xFF) return utf8write(new TextDecoder(\"utf-16be\").decode(arr.slice(2)));\n\t\t}\n\t\tvar rev = {\n\t\t\t\"\\u20ac\": \"\\x80\", \"\\u201a\": \"\\x82\", \"\\u0192\": \"\\x83\", \"\\u201e\": \"\\x84\",\n\t\t\t\"\\u2026\": \"\\x85\", \"\\u2020\": \"\\x86\", \"\\u2021\": \"\\x87\", \"\\u02c6\": \"\\x88\",\n\t\t\t\"\\u2030\": \"\\x89\", \"\\u0160\": \"\\x8a\", \"\\u2039\": \"\\x8b\", \"\\u0152\": \"\\x8c\",\n\t\t\t\"\\u017d\": \"\\x8e\", \"\\u2018\": \"\\x91\", \"\\u2019\": \"\\x92\", \"\\u201c\": \"\\x93\",\n\t\t\t\"\\u201d\": \"\\x94\", \"\\u2022\": \"\\x95\", \"\\u2013\": \"\\x96\", \"\\u2014\": \"\\x97\",\n\t\t\t\"\\u02dc\": \"\\x98\", \"\\u2122\": \"\\x99\", \"\\u0161\": \"\\x9a\", \"\\u203a\": \"\\x9b\",\n\t\t\t\"\\u0153\": \"\\x9c\", \"\\u017e\": \"\\x9e\", \"\\u0178\": \"\\x9f\"\n\t\t};\n\t\tif(Array.isArray(arr)) arr = new Uint8Array(arr);\n\t\treturn new TextDecoder(\"latin1\").decode(arr).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g, function(c) { return rev[c] || c; });\n\t} catch(e) {}\n\n\tvar o = [];\n\tfor(var i = 0; i != arr.length; ++i) o.push(String.fromCharCode(arr[i]));\n\treturn o.join(\"\");\n}\n\nfunction dup(o) {\n\tif(typeof JSON != 'undefined' && !Array.isArray(o)) return JSON.parse(JSON.stringify(o));\n\tif(typeof o != 'object' || o == null) return o;\n\tif(o instanceof Date) return new Date(o.getTime());\n\tvar out = {};\n\tfor(var k in o) if(Object.prototype.hasOwnProperty.call(o, k)) out[k] = dup(o[k]);\n\treturn out;\n}\n\nfunction fill(c,l) { var o = \"\"; while(o.length < l) o+=c; return o; }\n\n/* TODO: stress test */\nfunction fuzzynum(s) {\n\tvar v = Number(s);\n\tif(!isNaN(v)) return isFinite(v) ? v : NaN;\n\tif(!/\\d/.test(s)) return v;\n\tvar wt = 1;\n\tvar ss = s.replace(/([\\d]),([\\d])/g,\"$1$2\").replace(/[$]/g,\"\").replace(/[%]/g, function() { wt *= 100; return \"\";});\n\tif(!isNaN(v = Number(ss))) return v / wt;\n\tss = ss.replace(/[(](.*)[)]/,function($$, $1) { wt = -wt; return $1;});\n\tif(!isNaN(v = Number(ss))) return v / wt;\n\treturn v;\n}\nvar lower_months = ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'];\nfunction fuzzydate(s) {\n\tvar o = new Date(s), n = new Date(NaN);\n\tvar y = o.getYear(), m = o.getMonth(), d = o.getDate();\n\tif(isNaN(d)) return n;\n\tvar lower = s.toLowerCase();\n\tif(lower.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)) {\n\t\tlower = lower.replace(/[^a-z]/g,\"\").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,\"\");\n\t\tif(lower.length > 3 && lower_months.indexOf(lower) == -1) return n;\n\t} else if(lower.match(/[a-z]/)) return n;\n\tif(y < 0 || y > 8099) return n;\n\tif((m > 0 || d > 1) && y != 101) return o;\n\tif(s.match(/[^-0-9:,\\/\\\\]/)) return n;\n\treturn o;\n}\n\nvar split_regex = (function() {\n\tvar safe_split_regex = \"abacaba\".split(/(:?b)/i).length == 5;\n\treturn function split_regex(str, re, def) {\n\t\tif(safe_split_regex || typeof re == \"string\") return str.split(re);\n\t\tvar p = str.split(re), o = [p[0]];\n\t\tfor(var i = 1; i < p.length; ++i) { o.push(def); o.push(p[i]); }\n\t\treturn o;\n\t};\n})();\nfunction getdatastr(data) {\n\tif(!data) return null;\n\tif(data.content && data.type) return cc2str(data.content, true);\n\tif(data.data) return debom(data.data);\n\tif(data.asNodeBuffer && has_buf) return debom(data.asNodeBuffer().toString('binary'));\n\tif(data.asBinary) return debom(data.asBinary());\n\tif(data._data && data._data.getContent) return debom(cc2str(Array.prototype.slice.call(data._data.getContent(),0)));\n\treturn null;\n}\n\nfunction getdatabin(data) {\n\tif(!data) return null;\n\tif(data.data) return char_codes(data.data);\n\tif(data.asNodeBuffer && has_buf) return data.asNodeBuffer();\n\tif(data._data && data._data.getContent) {\n\t\tvar o = data._data.getContent();\n\t\tif(typeof o == \"string\") return char_codes(o);\n\t\treturn Array.prototype.slice.call(o);\n\t}\n\tif(data.content && data.type) return data.content;\n\treturn null;\n}\n\nfunction getdata(data) { return (data && data.name.slice(-4) === \".bin\") ? getdatabin(data) : getdatastr(data); }\n\n/* Part 2 Section 10.1.2 \"Mapping Content Types\" Names are case-insensitive */\n/* OASIS does not comment on filename case sensitivity */\nfunction safegetzipfile(zip, file) {\n\tvar k = zip.FullPaths || keys(zip.files);\n\tvar f = file.toLowerCase().replace(/[\\/]/g, '\\\\'), g = f.replace(/\\\\/g,'\\/');\n\tfor(var i=0; i<k.length; ++i) {\n\t\tvar n = k[i].replace(/^Root Entry[\\/]/,\"\").toLowerCase();\n\t\tif(f == n || g == n) return zip.files ? zip.files[k[i]] : zip.FileIndex[i];\n\t}\n\treturn null;\n}\n\nfunction getzipfile(zip, file) {\n\tvar o = safegetzipfile(zip, file);\n\tif(o == null) throw new Error(\"Cannot find file \" + file + \" in zip\");\n\treturn o;\n}\n\nfunction getzipdata(zip, file, safe) {\n\tif(!safe) return getdata(getzipfile(zip, file));\n\tif(!file) return null;\n\ttry { return getzipdata(zip, file); } catch(e) { return null; }\n}\n\nfunction getzipstr(zip, file, safe) {\n\tif(!safe) return getdatastr(getzipfile(zip, file));\n\tif(!file) return null;\n\ttry { return getzipstr(zip, file); } catch(e) { return null; }\n}\n\nfunction getzipbin(zip, file, safe) {\n\tif(!safe) return getdatabin(getzipfile(zip, file));\n\tif(!file) return null;\n\ttry { return getzipbin(zip, file); } catch(e) { return null; }\n}\n\nfunction zipentries(zip) {\n\tvar k = zip.FullPaths || keys(zip.files), o = [];\n\tfor(var i = 0; i < k.length; ++i) if(k[i].slice(-1) != '/') o.push(k[i].replace(/^Root Entry[\\/]/, \"\"));\n\treturn o.sort();\n}\n\nfunction zip_add_file(zip, path, content) {\n\tif(zip.FullPaths) {\n\t\tif(typeof content == \"string\") {\n\t\t\tvar res;\n\t\t\tif(has_buf) res = Buffer_from(content);\n\t\t\t/* TODO: investigate performance in Edge 13 */\n\t\t\t//else if(typeof TextEncoder !== \"undefined\") res = new TextEncoder().encode(content);\n\t\t\telse res = utf8decode(content);\n\t\t\treturn CFB.utils.cfb_add(zip, path, res);\n\t\t}\n\t\tCFB.utils.cfb_add(zip, path, content);\n\t}\n\telse zip.file(path, content);\n}\n\nfunction zip_new() { return CFB.utils.cfb_new(); }\n\nfunction zip_read(d, o) {\n\tswitch(o.type) {\n\t\tcase \"base64\": return CFB.read(d, { type: \"base64\" });\n\t\tcase \"binary\": return CFB.read(d, { type: \"binary\" });\n\t\tcase \"buffer\": case \"array\": return CFB.read(d, { type: \"buffer\" });\n\t}\n\tthrow new Error(\"Unrecognized type \" + o.type);\n}\n\nfunction resolve_path(path, base) {\n\tif(path.charAt(0) == \"/\") return path.slice(1);\n\tvar result = base.split('/');\n\tif(base.slice(-1) != \"/\") result.pop(); // folder path\n\tvar target = path.split('/');\n\twhile (target.length !== 0) {\n\t\tvar step = target.shift();\n\t\tif (step === '..') result.pop();\n\t\telse if (step !== '.') result.push(step);\n\t}\n\treturn result.join('/');\n}\nvar XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\nvar attregexg=/([^\"\\s?>\\/]+)\\s*=\\s*((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:')|([^'\">\\s]+))/g;\nvar tagregex1=/<[\\/\\?]?[a-zA-Z0-9:_-]+(?:\\s+[^\"\\s?>\\/]+\\s*=\\s*(?:\"[^\"]*\"|'[^']*'|[^'\">\\s=]+))*\\s*[\\/\\?]?>/mg, tagregex2 = /<[^>]*>/g;\nvar tagregex = XML_HEADER.match(tagregex1) ? tagregex1 : tagregex2;\nvar nsregex=/<\\w*:/, nsregex2 = /<(\\/?)\\w+:/;\nfunction parsexmltag(tag, skip_root, skip_LC) {\n\tvar z = ({});\n\tvar eq = 0, c = 0;\n\tfor(; eq !== tag.length; ++eq) if((c = tag.charCodeAt(eq)) === 32 || c === 10 || c === 13) break;\n\tif(!skip_root) z[0] = tag.slice(0, eq);\n\tif(eq === tag.length) return z;\n\tvar m = tag.match(attregexg), j=0, v=\"\", i=0, q=\"\", cc=\"\", quot = 1;\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\tcc = m[i];\n\t\tfor(c=0; c != cc.length; ++c) if(cc.charCodeAt(c) === 61) break;\n\t\tq = cc.slice(0,c).trim();\n\t\twhile(cc.charCodeAt(c+1) == 32) ++c;\n\t\tquot = ((eq=cc.charCodeAt(c+1)) == 34 || eq == 39) ? 1 : 0;\n\t\tv = cc.slice(c+1+quot, cc.length-quot);\n\t\tfor(j=0;j!=q.length;++j) if(q.charCodeAt(j) === 58) break;\n\t\tif(j===q.length) {\n\t\t\tif(q.indexOf(\"_\") > 0) q = q.slice(0, q.indexOf(\"_\")); // from ods\n\t\t\tz[q] = v;\n\t\t\tif(!skip_LC) z[q.toLowerCase()] = v;\n\t\t}\n\t\telse {\n\t\t\tvar k = (j===5 && q.slice(0,5)===\"xmlns\"?\"xmlns\":\"\")+q.slice(j+1);\n\t\t\tif(z[k] && q.slice(j-3,j) == \"ext\") continue; // from ods\n\t\t\tz[k] = v;\n\t\t\tif(!skip_LC) z[k.toLowerCase()] = v;\n\t\t}\n\t}\n\treturn z;\n}\nfunction strip_ns(x) { return x.replace(nsregex2, \"<$1\"); }\n\nvar encodings = {\n\t'&quot;': '\"',\n\t'&apos;': \"'\",\n\t'&gt;': '>',\n\t'&lt;': '<',\n\t'&amp;': '&'\n};\nvar rencoding = evert(encodings);\n//var rencstr = \"&<>'\\\"\".split(\"\");\n\n// TODO: CP remap (need to read file version to determine OS)\nvar unescapexml = (function() {\n\t/* 22.4.2.4 bstr (Basic String) */\n\tvar encregex = /&(?:quot|apos|gt|lt|amp|#x?([\\da-fA-F]+));/ig, coderegex = /_x([\\da-fA-F]{4})_/ig;\n\treturn function unescapexml(text) {\n\t\tvar s = text + '', i = s.indexOf(\"<![CDATA[\");\n\t\tif(i == -1) return s.replace(encregex, function($$, $1) { return encodings[$$]||String.fromCharCode(parseInt($1,$$.indexOf(\"x\")>-1?16:10))||$$; }).replace(coderegex,function(m,c) {return String.fromCharCode(parseInt(c,16));});\n\t\tvar j = s.indexOf(\"]]>\");\n\t\treturn unescapexml(s.slice(0, i)) + s.slice(i+9,j) + unescapexml(s.slice(j+3));\n\t};\n})();\n\nvar decregex=/[&<>'\"]/g, charegex = /[\\u0000-\\u0008\\u000b-\\u001f]/g;\nfunction escapexml(text){\n\tvar s = text + '';\n\treturn s.replace(decregex, function(y) { return rencoding[y]; }).replace(charegex,function(s) { return \"_x\" + (\"000\"+s.charCodeAt(0).toString(16)).slice(-4) + \"_\";});\n}\nfunction escapexmltag(text){ return escapexml(text).replace(/ /g,\"_x0020_\"); }\n\nvar htmlcharegex = /[\\u0000-\\u001f]/g;\nfunction escapehtml(text){\n\tvar s = text + '';\n\treturn s.replace(decregex, function(y) { return rencoding[y]; }).replace(/\\n/g, \"<br/>\").replace(htmlcharegex,function(s) { return \"&#x\" + (\"000\"+s.charCodeAt(0).toString(16)).slice(-4) + \";\"; });\n}\n\nfunction escapexlml(text){\n\tvar s = text + '';\n\treturn s.replace(decregex, function(y) { return rencoding[y]; }).replace(htmlcharegex,function(s) { return \"&#x\" + (s.charCodeAt(0).toString(16)).toUpperCase() + \";\"; });\n}\n\n/* TODO: handle codepages */\nvar xlml_fixstr = (function() {\n\tvar entregex = /&#(\\d+);/g;\n\tfunction entrepl($$,$1) { return String.fromCharCode(parseInt($1,10)); }\n\treturn function xlml_fixstr(str) { return str.replace(entregex,entrepl); };\n})();\nfunction xlml_unfixstr(str) { return str.replace(/(\\r\\n|[\\r\\n])/g,\"\\&#10;\"); }\n\nfunction parsexmlbool(value) {\n\tswitch(value) {\n\t\tcase 1: case true: case '1': case 'true': case 'TRUE': return true;\n\t\t/* case '0': case 'false': case 'FALSE':*/\n\t\tdefault: return false;\n\t}\n}\n\nfunction utf8reada(orig) {\n\tvar out = \"\", i = 0, c = 0, d = 0, e = 0, f = 0, w = 0;\n\twhile (i < orig.length) {\n\t\tc = orig.charCodeAt(i++);\n\t\tif (c < 128) { out += String.fromCharCode(c); continue; }\n\t\td = orig.charCodeAt(i++);\n\t\tif (c>191 && c<224) { f = ((c & 31) << 6); f |= (d & 63); out += String.fromCharCode(f); continue; }\n\t\te = orig.charCodeAt(i++);\n\t\tif (c < 240) { out += String.fromCharCode(((c & 15) << 12) | ((d & 63) << 6) | (e & 63)); continue; }\n\t\tf = orig.charCodeAt(i++);\n\t\tw = (((c & 7) << 18) | ((d & 63) << 12) | ((e & 63) << 6) | (f & 63))-65536;\n\t\tout += String.fromCharCode(0xD800 + ((w>>>10)&1023));\n\t\tout += String.fromCharCode(0xDC00 + (w&1023));\n\t}\n\treturn out;\n}\n\nfunction utf8readb(data) {\n\tvar out = new_raw_buf(2*data.length), w, i, j = 1, k = 0, ww=0, c;\n\tfor(i = 0; i < data.length; i+=j) {\n\t\tj = 1;\n\t\tif((c=data.charCodeAt(i)) < 128) w = c;\n\t\telse if(c < 224) { w = (c&31)*64+(data.charCodeAt(i+1)&63); j=2; }\n\t\telse if(c < 240) { w=(c&15)*4096+(data.charCodeAt(i+1)&63)*64+(data.charCodeAt(i+2)&63); j=3; }\n\t\telse { j = 4;\n\t\t\tw = (c & 7)*262144+(data.charCodeAt(i+1)&63)*4096+(data.charCodeAt(i+2)&63)*64+(data.charCodeAt(i+3)&63);\n\t\t\tw -= 65536; ww = 0xD800 + ((w>>>10)&1023); w = 0xDC00 + (w&1023);\n\t\t}\n\t\tif(ww !== 0) { out[k++] = ww&255; out[k++] = ww>>>8; ww = 0; }\n\t\tout[k++] = w%256; out[k++] = w>>>8;\n\t}\n\treturn out.slice(0,k).toString('ucs2');\n}\n\nfunction utf8readc(data) { return Buffer_from(data, 'binary').toString('utf8'); }\n\nvar utf8corpus = \"foo bar baz\\u00e2\\u0098\\u0083\\u00f0\\u009f\\u008d\\u00a3\";\nvar utf8read = has_buf && (utf8readc(utf8corpus) == utf8reada(utf8corpus) && utf8readc || utf8readb(utf8corpus) == utf8reada(utf8corpus) && utf8readb) || utf8reada;\n\nvar utf8write = has_buf ? function(data) { return Buffer_from(data, 'utf8').toString(\"binary\"); } : function(orig) {\n\tvar out = [], i = 0, c = 0, d = 0;\n\twhile(i < orig.length) {\n\t\tc = orig.charCodeAt(i++);\n\t\tswitch(true) {\n\t\t\tcase c < 128: out.push(String.fromCharCode(c)); break;\n\t\t\tcase c < 2048:\n\t\t\t\tout.push(String.fromCharCode(192 + (c >> 6)));\n\t\t\t\tout.push(String.fromCharCode(128 + (c & 63)));\n\t\t\t\tbreak;\n\t\t\tcase c >= 55296 && c < 57344:\n\t\t\t\tc -= 55296; d = orig.charCodeAt(i++) - 56320 + (c<<10);\n\t\t\t\tout.push(String.fromCharCode(240 + ((d >>18) & 7)));\n\t\t\t\tout.push(String.fromCharCode(144 + ((d >>12) & 63)));\n\t\t\t\tout.push(String.fromCharCode(128 + ((d >> 6) & 63)));\n\t\t\t\tout.push(String.fromCharCode(128 + (d & 63)));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tout.push(String.fromCharCode(224 + (c >> 12)));\n\t\t\t\tout.push(String.fromCharCode(128 + ((c >> 6) & 63)));\n\t\t\t\tout.push(String.fromCharCode(128 + (c & 63)));\n\t\t}\n\t}\n\treturn out.join(\"\");\n};\n\n// matches <foo>...</foo> extracts content\nvar matchtag = (function() {\n\tvar mtcache = ({});\n\treturn function matchtag(f,g) {\n\t\tvar t = f+\"|\"+(g||\"\");\n\t\tif(mtcache[t]) return mtcache[t];\n\t\treturn (mtcache[t] = new RegExp('<(?:\\\\w+:)?'+f+'(?: xml:space=\"preserve\")?(?:[^>]*)>([\\\\s\\\\S]*?)</(?:\\\\w+:)?'+f+'>',((g||\"\"))));\n\t};\n})();\n\nvar htmldecode = (function() {\n\tvar entities = [\n\t\t['nbsp', ' '], ['middot', '·'],\n\t\t['quot', '\"'], ['apos', \"'\"], ['gt',   '>'], ['lt',   '<'], ['amp',  '&']\n\t].map(function(x) { return [new RegExp('&' + x[0] + ';', \"ig\"), x[1]]; });\n\treturn function htmldecode(str) {\n\t\tvar o = str\n\t\t\t\t// Remove new lines and spaces from start of content\n\t\t\t\t.replace(/^[\\t\\n\\r ]+/, \"\")\n\t\t\t\t// Remove new lines and spaces from end of content\n\t\t\t\t.replace(/[\\t\\n\\r ]+$/,\"\")\n\t\t\t\t// Added line which removes any white space characters after and before html tags\n\t\t\t\t.replace(/>\\s+/g,\">\").replace(/\\s+</g,\"<\")\n\t\t\t\t// Replace remaining new lines and spaces with space\n\t\t\t\t.replace(/[\\t\\n\\r ]+/g, \" \")\n\t\t\t\t// Replace <br> tags with new lines\n\t\t\t\t.replace(/<\\s*[bB][rR]\\s*\\/?>/g,\"\\n\")\n\t\t\t\t// Strip HTML elements\n\t\t\t\t.replace(/<[^>]*>/g,\"\");\n\t\tfor(var i = 0; i < entities.length; ++i) o = o.replace(entities[i][0], entities[i][1]);\n\t\treturn o;\n\t};\n})();\n\nvar vtregex = (function(){ var vt_cache = {};\n\treturn function vt_regex(bt) {\n\t\tif(vt_cache[bt] !== undefined) return vt_cache[bt];\n\t\treturn (vt_cache[bt] = new RegExp(\"<(?:vt:)?\" + bt + \">([\\\\s\\\\S]*?)</(?:vt:)?\" + bt + \">\", 'g') );\n};})();\nvar vtvregex = /<\\/?(?:vt:)?variant>/g, vtmregex = /<(?:vt:)([^>]*)>([\\s\\S]*)</;\nfunction parseVector(data, opts) {\n\tvar h = parsexmltag(data);\n\n\tvar matches = data.match(vtregex(h.baseType))||[];\n\tvar res = [];\n\tif(matches.length != h.size) {\n\t\tif(opts.WTF) throw new Error(\"unexpected vector length \" + matches.length + \" != \" + h.size);\n\t\treturn res;\n\t}\n\tmatches.forEach(function(x) {\n\t\tvar v = x.replace(vtvregex,\"\").match(vtmregex);\n\t\tif(v) res.push({v:utf8read(v[2]), t:v[1]});\n\t});\n\treturn res;\n}\n\nvar wtregex = /(^\\s|\\s$|\\n)/;\nfunction writetag(f,g) { return '<' + f + (g.match(wtregex)?' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f + '>'; }\n\nfunction wxt_helper(h) { return keys(h).map(function(k) { return \" \" + k + '=\"' + h[k] + '\"';}).join(\"\"); }\nfunction writextag(f,g,h) { return '<' + f + ((h != null) ? wxt_helper(h) : \"\") + ((g != null) ? (g.match(wtregex)?' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f : \"/\") + '>';}\n\nfunction write_w3cdtf(d, t) { try { return d.toISOString().replace(/\\.\\d*/,\"\"); } catch(e) { if(t) throw e; } return \"\"; }\n\nfunction write_vt(s, xlsx) {\n\tswitch(typeof s) {\n\t\tcase 'string':\n\t\t\tvar o = writextag('vt:lpwstr', escapexml(s));\n\t\t\tif(xlsx) o = o.replace(/&quot;/g, \"_x0022_\");\n\t\t\treturn o;\n\t\tcase 'number': return writextag((s|0)==s?'vt:i4':'vt:r8', escapexml(String(s)));\n\t\tcase 'boolean': return writextag('vt:bool',s?'true':'false');\n\t}\n\tif(s instanceof Date) return writextag('vt:filetime', write_w3cdtf(s));\n\tthrow new Error(\"Unable to serialize \" + s);\n}\n\nfunction xlml_normalize(d) {\n\tif(has_buf && Buffer.isBuffer(d)) return d.toString('utf8');\n\tif(typeof d === 'string') return d;\n\t/* duktape */\n\tif(typeof Uint8Array !== 'undefined' && d instanceof Uint8Array) return utf8read(a2s(ab2a(d)));\n\tthrow new Error(\"Bad input format: expected Buffer or string\");\n}\n/* UOS uses CJK in tags */\nvar xlmlregex = /<(\\/?)([^\\s?><!\\/:]*:|)([^\\s?<>:\\/]+)(?:[\\s?:\\/][^>]*)?>/mg;\n//var xlmlregex = /<(\\/?)([a-z0-9]*:|)(\\w+)[^>]*>/mg;\n\nvar XMLNS = ({\n\tCORE_PROPS: 'http://schemas.openxmlformats.org/package/2006/metadata/core-properties',\n\tCUST_PROPS: \"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\",\n\tEXT_PROPS: \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\",\n\tCT: 'http://schemas.openxmlformats.org/package/2006/content-types',\n\tRELS: 'http://schemas.openxmlformats.org/package/2006/relationships',\n\tTCMNT: 'http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments',\n\t'dc': 'http://purl.org/dc/elements/1.1/',\n\t'dcterms': 'http://purl.org/dc/terms/',\n\t'dcmitype': 'http://purl.org/dc/dcmitype/',\n\t'mx': 'http://schemas.microsoft.com/office/mac/excel/2008/main',\n\t'r': 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',\n\t'sjs': 'http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties',\n\t'vt': 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\n\t'xsi': 'http://www.w3.org/2001/XMLSchema-instance',\n\t'xsd': 'http://www.w3.org/2001/XMLSchema'\n});\n\nvar XMLNS_main = [\n\t'http://schemas.openxmlformats.org/spreadsheetml/2006/main',\n\t'http://purl.oclc.org/ooxml/spreadsheetml/main',\n\t'http://schemas.microsoft.com/office/excel/2006/main',\n\t'http://schemas.microsoft.com/office/excel/2006/2'\n];\n\nvar XLMLNS = ({\n\t'o':    'urn:schemas-microsoft-com:office:office',\n\t'x':    'urn:schemas-microsoft-com:office:excel',\n\t'ss':   'urn:schemas-microsoft-com:office:spreadsheet',\n\t'dt':   'uuid:C2F41010-65B3-11d1-A29F-00AA00C14882',\n\t'mv':   'http://macVmlSchemaUri',\n\t'v':    'urn:schemas-microsoft-com:vml',\n\t'html': 'http://www.w3.org/TR/REC-html40'\n});\nfunction read_double_le(b, idx) {\n\tvar s = 1 - 2 * (b[idx + 7] >>> 7);\n\tvar e = ((b[idx + 7] & 0x7f) << 4) + ((b[idx + 6] >>> 4) & 0x0f);\n\tvar m = (b[idx+6]&0x0f);\n\tfor(var i = 5; i >= 0; --i) m = m * 256 + b[idx + i];\n\tif(e == 0x7ff) return m == 0 ? (s * Infinity) : NaN;\n\tif(e == 0) e = -1022;\n\telse { e -= 1023; m += Math.pow(2,52); }\n\treturn s * Math.pow(2, e - 52) * m;\n}\n\nfunction write_double_le(b, v, idx) {\n\tvar bs = ((((v < 0) || (1/v == -Infinity)) ? 1 : 0) << 7), e = 0, m = 0;\n\tvar av = bs ? (-v) : v;\n\tif(!isFinite(av)) { e = 0x7ff; m = isNaN(v) ? 0x6969 : 0; }\n\telse if(av == 0) e = m = 0;\n\telse {\n\t\te = Math.floor(Math.log(av) / Math.LN2);\n\t\tm = av * Math.pow(2, 52 - e);\n\t\tif((e <= -1023) && (!isFinite(m) || (m < Math.pow(2,52)))) { e = -1022; }\n\t\telse { m -= Math.pow(2,52); e+=1023; }\n\t}\n\tfor(var i = 0; i <= 5; ++i, m/=256) b[idx + i] = m & 0xff;\n\tb[idx + 6] = ((e & 0x0f) << 4) | (m & 0xf);\n\tb[idx + 7] = (e >> 4) | bs;\n}\n\nvar ___toBuffer = function(bufs) { var x=[],w=10240; for(var i=0;i<bufs[0].length;++i) if(bufs[0][i]) for(var j=0,L=bufs[0][i].length;j<L;j+=w) x.push.apply(x, bufs[0][i].slice(j,j+w)); return x; };\nvar __toBuffer = has_buf ? function(bufs) { return (bufs[0].length > 0 && Buffer.isBuffer(bufs[0][0])) ? Buffer.concat(bufs[0].map(function(x) { return Buffer.isBuffer(x) ? x : Buffer_from(x); })) : ___toBuffer(bufs);} : ___toBuffer;\n\nvar ___utf16le = function(b,s,e) { var ss=[]; for(var i=s; i<e; i+=2) ss.push(String.fromCharCode(__readUInt16LE(b,i))); return ss.join(\"\").replace(chr0,''); };\nvar __utf16le = has_buf ? function(b,s,e) { if(!Buffer.isBuffer(b)) return ___utf16le(b,s,e); return b.toString('utf16le',s,e).replace(chr0,'')/*.replace(chr1,'!')*/; } : ___utf16le;\n\nvar ___hexlify = function(b,s,l) { var ss=[]; for(var i=s; i<s+l; ++i) ss.push((\"0\" + b[i].toString(16)).slice(-2)); return ss.join(\"\"); };\nvar __hexlify = has_buf ? function(b,s,l) { return Buffer.isBuffer(b) ? b.toString('hex',s,s+l) : ___hexlify(b,s,l); } : ___hexlify;\n\nvar ___utf8 = function(b,s,e) { var ss=[]; for(var i=s; i<e; i++) ss.push(String.fromCharCode(__readUInt8(b,i))); return ss.join(\"\"); };\nvar __utf8 = has_buf ? function utf8_b(b, s, e) { return (Buffer.isBuffer(b)) ? b.toString('utf8',s,e) : ___utf8(b,s,e); } : ___utf8;\n\nvar ___lpstr = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\nvar __lpstr = ___lpstr;\n\nvar ___cpstr = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\nvar __cpstr = ___cpstr;\n\nvar ___lpwstr = function(b,i) { var len = 2*__readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\nvar __lpwstr = ___lpwstr;\n\nvar ___lpp4 = function lpp4_(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? __utf16le(b, i+4,i+4+len) : \"\";};\nvar __lpp4 = ___lpp4;\n\nvar ___8lpp4 = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len) : \"\";};\nvar __8lpp4 = ___8lpp4;\n\nvar ___double = function(b, idx) { return read_double_le(b, idx);};\nvar __double = ___double;\n\nvar is_buf = function is_buf_a(a) { return Array.isArray(a) || (typeof Uint8Array !== \"undefined\" && a instanceof Uint8Array); };\n\nif(has_buf) {\n\t__lpstr = function lpstr_b(b, i) { if(!Buffer.isBuffer(b)) return ___lpstr(b, i); var len = b.readUInt32LE(i); return len > 0 ? b.toString('utf8',i+4,i+4+len-1) : \"\";};\n\t__cpstr = function cpstr_b(b, i) { if(!Buffer.isBuffer(b)) return ___cpstr(b, i); var len = b.readUInt32LE(i); return len > 0 ? b.toString('utf8',i+4,i+4+len-1) : \"\";};\n\t__lpwstr = function lpwstr_b(b, i) { if(!Buffer.isBuffer(b)) return ___lpwstr(b, i); var len = 2*b.readUInt32LE(i); return b.toString('utf16le',i+4,i+4+len-1);};\n\t__lpp4 = function lpp4_b(b, i) { if(!Buffer.isBuffer(b)) return ___lpp4(b, i); var len = b.readUInt32LE(i); return b.toString('utf16le',i+4,i+4+len);};\n\t__8lpp4 = function lpp4_8b(b, i) { if(!Buffer.isBuffer(b)) return ___8lpp4(b, i); var len = b.readUInt32LE(i); return b.toString('utf8',i+4,i+4+len);};\n\t__double = function double_(b, i) { if(Buffer.isBuffer(b)) return b.readDoubleLE(i); return ___double(b,i); };\n\tis_buf = function is_buf_b(a) { return Buffer.isBuffer(a) || Array.isArray(a) || (typeof Uint8Array !== \"undefined\" && a instanceof Uint8Array); };\n}\n\n/* from js-xls */\nfunction cpdoit() {\n\t__utf16le = function(b,s,e) { return $cptable.utils.decode(1200, b.slice(s,e)).replace(chr0, ''); };\n\t__utf8 = function(b,s,e) { return $cptable.utils.decode(65001, b.slice(s,e)); };\n\t__lpstr = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(current_ansi, b.slice(i+4, i+4+len-1)) : \"\";};\n\t__cpstr = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(current_codepage, b.slice(i+4, i+4+len-1)) : \"\";};\n\t__lpwstr = function(b,i) { var len = 2*__readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(1200, b.slice(i+4,i+4+len-1)) : \"\";};\n\t__lpp4 = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(1200, b.slice(i+4,i+4+len)) : \"\";};\n\t__8lpp4 = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(65001, b.slice(i+4,i+4+len)) : \"\";};\n}\nif(typeof $cptable !== 'undefined') cpdoit();\n\nvar __readUInt8 = function(b, idx) { return b[idx]; };\nvar __readUInt16LE = function(b, idx) { return (b[idx+1]*(1<<8))+b[idx]; };\nvar __readInt16LE = function(b, idx) { var u = (b[idx+1]*(1<<8))+b[idx]; return (u < 0x8000) ? u : ((0xffff - u + 1) * -1); };\nvar __readUInt32LE = function(b, idx) { return b[idx+3]*(1<<24)+(b[idx+2]<<16)+(b[idx+1]<<8)+b[idx]; };\nvar __readInt32LE = function(b, idx) { return (b[idx+3]<<24)|(b[idx+2]<<16)|(b[idx+1]<<8)|b[idx]; };\nvar __readInt32BE = function(b, idx) { return (b[idx]<<24)|(b[idx+1]<<16)|(b[idx+2]<<8)|b[idx+3]; };\n\nfunction ReadShift(size, t) {\n\tvar o=\"\", oI, oR, oo=[], w, vv, i, loc;\n\tswitch(t) {\n\t\tcase 'dbcs':\n\t\t\tloc = this.l;\n\t\t\tif(has_buf && Buffer.isBuffer(this)) o = this.slice(this.l, this.l+2*size).toString(\"utf16le\");\n\t\t\telse for(i = 0; i < size; ++i) { o+=String.fromCharCode(__readUInt16LE(this, loc)); loc+=2; }\n\t\t\tsize *= 2;\n\t\t\tbreak;\n\n\t\tcase 'utf8': o = __utf8(this, this.l, this.l + size); break;\n\t\tcase 'utf16le': size *= 2; o = __utf16le(this, this.l, this.l + size); break;\n\n\t\tcase 'wstr':\n\t\t\tif(typeof $cptable !== 'undefined') o = $cptable.utils.decode(current_codepage, this.slice(this.l, this.l+2*size));\n\t\t\telse return ReadShift.call(this, size, 'dbcs');\n\t\t\tsize = 2 * size; break;\n\n\t\t/* [MS-OLEDS] 2.1.4 LengthPrefixedAnsiString */\n\t\tcase 'lpstr-ansi': o = __lpstr(this, this.l); size = 4 + __readUInt32LE(this, this.l); break;\n\t\tcase 'lpstr-cp': o = __cpstr(this, this.l); size = 4 + __readUInt32LE(this, this.l); break;\n\t\t/* [MS-OLEDS] 2.1.5 LengthPrefixedUnicodeString */\n\t\tcase 'lpwstr': o = __lpwstr(this, this.l); size = 4 + 2 * __readUInt32LE(this, this.l); break;\n\t\t/* [MS-OFFCRYPTO] 2.1.2 Length-Prefixed Padded Unicode String (UNICODE-LP-P4) */\n\t\tcase 'lpp4': size = 4 +  __readUInt32LE(this, this.l); o = __lpp4(this, this.l); if(size & 0x02) size += 2; break;\n\t\t/* [MS-OFFCRYPTO] 2.1.3 Length-Prefixed UTF-8 String (UTF-8-LP-P4) */\n\t\tcase '8lpp4': size = 4 +  __readUInt32LE(this, this.l); o = __8lpp4(this, this.l); if(size & 0x03) size += 4 - (size & 0x03); break;\n\n\t\tcase 'cstr': size = 0; o = \"\";\n\t\t\twhile((w=__readUInt8(this, this.l + size++))!==0) oo.push(_getchar(w));\n\t\t\to = oo.join(\"\"); break;\n\t\tcase '_wstr': size = 0; o = \"\";\n\t\t\twhile((w=__readUInt16LE(this,this.l +size))!==0){oo.push(_getchar(w));size+=2;}\n\t\t\tsize+=2; o = oo.join(\"\"); break;\n\n\t\t/* sbcs and dbcs support continue records in the SST way TODO codepages */\n\t\tcase 'dbcs-cont': o = \"\"; loc = this.l;\n\t\t\tfor(i = 0; i < size; ++i) {\n\t\t\t\tif(this.lens && this.lens.indexOf(loc) !== -1) {\n\t\t\t\t\tw = __readUInt8(this, loc);\n\t\t\t\t\tthis.l = loc + 1;\n\t\t\t\t\tvv = ReadShift.call(this, size-i, w ? 'dbcs-cont' : 'sbcs-cont');\n\t\t\t\t\treturn oo.join(\"\") + vv;\n\t\t\t\t}\n\t\t\t\too.push(_getchar(__readUInt16LE(this, loc)));\n\t\t\t\tloc+=2;\n\t\t\t} o = oo.join(\"\"); size *= 2; break;\n\n\t\tcase 'cpstr':\n\t\t\tif(typeof $cptable !== 'undefined') {\n\t\t\t\to = $cptable.utils.decode(current_codepage, this.slice(this.l, this.l + size));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t/* falls through */\n\t\tcase 'sbcs-cont': o = \"\"; loc = this.l;\n\t\t\tfor(i = 0; i != size; ++i) {\n\t\t\t\tif(this.lens && this.lens.indexOf(loc) !== -1) {\n\t\t\t\t\tw = __readUInt8(this, loc);\n\t\t\t\t\tthis.l = loc + 1;\n\t\t\t\t\tvv = ReadShift.call(this, size-i, w ? 'dbcs-cont' : 'sbcs-cont');\n\t\t\t\t\treturn oo.join(\"\") + vv;\n\t\t\t\t}\n\t\t\t\too.push(_getchar(__readUInt8(this, loc)));\n\t\t\t\tloc+=1;\n\t\t\t} o = oo.join(\"\"); break;\n\n\t\tdefault:\n\tswitch(size) {\n\t\tcase 1: oI = __readUInt8(this, this.l); this.l++; return oI;\n\t\tcase 2: oI = (t === 'i' ? __readInt16LE : __readUInt16LE)(this, this.l); this.l += 2; return oI;\n\t\tcase 4: case -4:\n\t\t\tif(t === 'i' || ((this[this.l+3] & 0x80)===0)) { oI = ((size > 0) ? __readInt32LE : __readInt32BE)(this, this.l); this.l += 4; return oI; }\n\t\t\telse { oR = __readUInt32LE(this, this.l); this.l += 4; } return oR;\n\t\tcase 8: case -8:\n\t\t\tif(t === 'f') {\n\t\t\t\tif(size == 8) oR = __double(this, this.l);\n\t\t\t\telse oR = __double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]], 0);\n\t\t\t\tthis.l += 8; return oR;\n\t\t\t} else size = 8;\n\t\t/* falls through */\n\t\tcase 16: o = __hexlify(this, this.l, size); break;\n\t}}\n\tthis.l+=size; return o;\n}\n\nvar __writeUInt32LE = function(b, val, idx) { b[idx] = (val & 0xFF); b[idx+1] = ((val >>> 8) & 0xFF); b[idx+2] = ((val >>> 16) & 0xFF); b[idx+3] = ((val >>> 24) & 0xFF); };\nvar __writeInt32LE  = function(b, val, idx) { b[idx] = (val & 0xFF); b[idx+1] = ((val >> 8) & 0xFF); b[idx+2] = ((val >> 16) & 0xFF); b[idx+3] = ((val >> 24) & 0xFF); };\nvar __writeUInt16LE = function(b, val, idx) { b[idx] = (val & 0xFF); b[idx+1] = ((val >>> 8) & 0xFF); };\n\nfunction WriteShift(t, val, f) {\n\tvar size = 0, i = 0;\n\tif(f === 'dbcs') {\nfor(i = 0; i != val.length; ++i) __writeUInt16LE(this, val.charCodeAt(i), this.l + 2 * i);\n\t\tsize = 2 * val.length;\n\t} else if(f === 'sbcs') {\n\t\tif(typeof $cptable !== 'undefined' && current_ansi == 874) {\n\t\t\t/* TODO: use tables directly, don't encode */\nfor(i = 0; i != val.length; ++i) {\n\t\t\t\tvar cppayload = $cptable.utils.encode(current_ansi, val.charAt(i));\n\t\t\t\tthis[this.l + i] = cppayload[0];\n\t\t\t}\n\t\t} else {\nval = val.replace(/[^\\x00-\\x7F]/g, \"_\");\nfor(i = 0; i != val.length; ++i) this[this.l + i] = (val.charCodeAt(i) & 0xFF);\n\t\t}\n\t\tsize = val.length;\n\t} else if(f === 'hex') {\n\t\tfor(; i < t; ++i) {\nthis[this.l++] = (parseInt(val.slice(2*i, 2*i+2), 16)||0);\n\t\t} return this;\n\t} else if(f === 'utf16le') {\nvar end = Math.min(this.l + t, this.length);\n\t\t\tfor(i = 0; i < Math.min(val.length, t); ++i) {\n\t\t\t\tvar cc = val.charCodeAt(i);\n\t\t\t\tthis[this.l++] = (cc & 0xff);\n\t\t\t\tthis[this.l++] = (cc >> 8);\n\t\t\t}\n\t\t\twhile(this.l < end) this[this.l++] = 0;\n\t\t\treturn this;\n\t} else  switch(t) {\n\t\tcase  1: size = 1; this[this.l] = val&0xFF; break;\n\t\tcase  2: size = 2; this[this.l] = val&0xFF; val >>>= 8; this[this.l+1] = val&0xFF; break;\n\t\tcase  3: size = 3; this[this.l] = val&0xFF; val >>>= 8; this[this.l+1] = val&0xFF; val >>>= 8; this[this.l+2] = val&0xFF; break;\n\t\tcase  4: size = 4; __writeUInt32LE(this, val, this.l); break;\n\t\tcase  8: size = 8; if(f === 'f') { write_double_le(this, val, this.l); break; }\n\t\t/* falls through */\n\t\tcase 16: break;\n\t\tcase -4: size = 4; __writeInt32LE(this, val, this.l); break;\n\t}\n\tthis.l += size; return this;\n}\n\nfunction CheckField(hexstr, fld) {\n\tvar m = __hexlify(this,this.l,hexstr.length>>1);\n\tif(m !== hexstr) throw new Error(fld + 'Expected ' + hexstr + ' saw ' + m);\n\tthis.l += hexstr.length>>1;\n}\n\nfunction prep_blob(blob, pos) {\n\tblob.l = pos;\n\tblob.read_shift = ReadShift;\n\tblob.chk = CheckField;\n\tblob.write_shift = WriteShift;\n}\n\nfunction parsenoop(blob, length) { blob.l += length; }\n\nfunction new_buf(sz) {\n\tvar o = new_raw_buf(sz);\n\tprep_blob(o, 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.1.4 Record */\nfunction recordhopper(data, cb, opts) {\n\tif(!data) return;\n\tvar tmpbyte, cntbyte, length;\n\tprep_blob(data, data.l || 0);\n\tvar L = data.length, RT = 0, tgt = 0;\n\twhile(data.l < L) {\n\t\tRT = data.read_shift(1);\n\t\tif(RT & 0x80) RT = (RT & 0x7F) + ((data.read_shift(1) & 0x7F)<<7);\n\t\tvar R = XLSBRecordEnum[RT] || XLSBRecordEnum[0xFFFF];\n\t\ttmpbyte = data.read_shift(1);\n\t\tlength = tmpbyte & 0x7F;\n\t\tfor(cntbyte = 1; cntbyte <4 && (tmpbyte & 0x80); ++cntbyte) length += ((tmpbyte = data.read_shift(1)) & 0x7F)<<(7*cntbyte);\n\t\ttgt = data.l + length;\n\t\tvar d = R.f && R.f(data, length, opts);\n\t\tdata.l = tgt;\n\t\tif(cb(d, R, RT)) return;\n\t}\n}\n\n/* control buffer usage for fixed-length buffers */\nfunction buf_array() {\n\tvar bufs = [], blksz = has_buf ? 256 : 2048;\n\tvar newblk = function ba_newblk(sz) {\n\t\tvar o = (new_buf(sz));\n\t\tprep_blob(o, 0);\n\t\treturn o;\n\t};\n\n\tvar curbuf = newblk(blksz);\n\n\tvar endbuf = function ba_endbuf() {\n\t\tif(!curbuf) return;\n\t\tif(curbuf.length > curbuf.l) { curbuf = curbuf.slice(0, curbuf.l); curbuf.l = curbuf.length; }\n\t\tif(curbuf.length > 0) bufs.push(curbuf);\n\t\tcurbuf = null;\n\t};\n\n\tvar next = function ba_next(sz) {\n\t\tif(curbuf && (sz < (curbuf.length - curbuf.l))) return curbuf;\n\t\tendbuf();\n\t\treturn (curbuf = newblk(Math.max(sz+1, blksz)));\n\t};\n\n\tvar end = function ba_end() {\n\t\tendbuf();\n\t\treturn bconcat(bufs);\n\t};\n\n\tvar push = function ba_push(buf) { endbuf(); curbuf = buf; if(curbuf.l == null) curbuf.l = curbuf.length; next(blksz); };\n\n\treturn ({ next:next, push:push, end:end, _bufs:bufs });\n}\n\nfunction write_record(ba, type, payload, length) {\n\tvar t = +type, l;\n\tif(isNaN(t)) return; // TODO: throw something here?\n\tif(!length) length = XLSBRecordEnum[t].p || (payload||[]).length || 0;\n\tl = 1 + (t >= 0x80 ? 1 : 0) + 1/* + length*/;\n\tif(length >= 0x80) ++l; if(length >= 0x4000) ++l; if(length >= 0x200000) ++l;\n\tvar o = ba.next(l);\n\tif(t <= 0x7F) o.write_shift(1, t);\n\telse {\n\t\to.write_shift(1, (t & 0x7F) + 0x80);\n\t\to.write_shift(1, (t >> 7));\n\t}\n\tfor(var i = 0; i != 4; ++i) {\n\t\tif(length >= 0x80) { o.write_shift(1, (length & 0x7F)+0x80); length >>= 7; }\n\t\telse { o.write_shift(1, length); break; }\n\t}\n\tif(length > 0 && is_buf(payload)) ba.push(payload);\n}\n/* XLS ranges enforced */\nfunction shift_cell_xls(cell, tgt, opts) {\n\tvar out = dup(cell);\n\tif(tgt.s) {\n\t\tif(out.cRel) out.c += tgt.s.c;\n\t\tif(out.rRel) out.r += tgt.s.r;\n\t} else {\n\t\tif(out.cRel) out.c += tgt.c;\n\t\tif(out.rRel) out.r += tgt.r;\n\t}\n\tif(!opts || opts.biff < 12) {\n\t\twhile(out.c >= 0x100) out.c -= 0x100;\n\t\twhile(out.r >= 0x10000) out.r -= 0x10000;\n\t}\n\treturn out;\n}\n\nfunction shift_range_xls(cell, range, opts) {\n\tvar out = dup(cell);\n\tout.s = shift_cell_xls(out.s, range.s, opts);\n\tout.e = shift_cell_xls(out.e, range.s, opts);\n\treturn out;\n}\n\nfunction encode_cell_xls(c, biff) {\n\tif(c.cRel && c.c < 0) { c = dup(c); while(c.c < 0) c.c += (biff > 8) ? 0x4000 : 0x100; }\n\tif(c.rRel && c.r < 0) { c = dup(c); while(c.r < 0) c.r += (biff > 8) ? 0x100000 : ((biff > 5) ? 0x10000 : 0x4000); }\n\tvar s = encode_cell(c);\n\tif(!c.cRel && c.cRel != null) s = fix_col(s);\n\tif(!c.rRel && c.rRel != null) s = fix_row(s);\n\treturn s;\n}\n\nfunction encode_range_xls(r, opts) {\n\tif(r.s.r == 0 && !r.s.rRel) {\n\t\tif(r.e.r == (opts.biff >= 12 ? 0xFFFFF : (opts.biff >= 8 ? 0x10000 : 0x4000)) && !r.e.rRel) {\n\t\t\treturn (r.s.cRel ? \"\" : \"$\") + encode_col(r.s.c) + \":\" + (r.e.cRel ? \"\" : \"$\") + encode_col(r.e.c);\n\t\t}\n\t}\n\tif(r.s.c == 0 && !r.s.cRel) {\n\t\tif(r.e.c == (opts.biff >= 12 ? 0x3FFF : 0xFF) && !r.e.cRel) {\n\t\t\treturn (r.s.rRel ? \"\" : \"$\") + encode_row(r.s.r) + \":\" + (r.e.rRel ? \"\" : \"$\") + encode_row(r.e.r);\n\t\t}\n\t}\n\treturn encode_cell_xls(r.s, opts.biff) + \":\" + encode_cell_xls(r.e, opts.biff);\n}\nfunction decode_row(rowstr) { return parseInt(unfix_row(rowstr),10) - 1; }\nfunction encode_row(row) { return \"\" + (row + 1); }\nfunction fix_row(cstr) { return cstr.replace(/([A-Z]|^)(\\d+)$/,\"$1$$$2\"); }\nfunction unfix_row(cstr) { return cstr.replace(/\\$(\\d+)$/,\"$1\"); }\n\nfunction decode_col(colstr) { var c = unfix_col(colstr), d = 0, i = 0; for(; i !== c.length; ++i) d = 26*d + c.charCodeAt(i) - 64; return d - 1; }\nfunction encode_col(col) { if(col < 0) throw new Error(\"invalid column \" + col); var s=\"\"; for(++col; col; col=Math.floor((col-1)/26)) s = String.fromCharCode(((col-1)%26) + 65) + s; return s; }\nfunction fix_col(cstr) { return cstr.replace(/^([A-Z])/,\"$$$1\"); }\nfunction unfix_col(cstr) { return cstr.replace(/^\\$([A-Z])/,\"$1\"); }\n\nfunction split_cell(cstr) { return cstr.replace(/(\\$?[A-Z]*)(\\$?\\d*)/,\"$1,$2\").split(\",\"); }\n//function decode_cell(cstr) { var splt = split_cell(cstr); return { c:decode_col(splt[0]), r:decode_row(splt[1]) }; }\nfunction decode_cell(cstr) {\n\tvar R = 0, C = 0;\n\tfor(var i = 0; i < cstr.length; ++i) {\n\t\tvar cc = cstr.charCodeAt(i);\n\t\tif(cc >= 48 && cc <= 57) R = 10 * R + (cc - 48);\n\t\telse if(cc >= 65 && cc <= 90) C = 26 * C + (cc - 64);\n\t}\n\treturn { c: C - 1, r:R - 1 };\n}\n//function encode_cell(cell) { return encode_col(cell.c) + encode_row(cell.r); }\nfunction encode_cell(cell) {\n\tvar col = cell.c + 1;\n\tvar s=\"\";\n\tfor(; col; col=((col-1)/26)|0) s = String.fromCharCode(((col-1)%26) + 65) + s;\n\treturn s + (cell.r + 1);\n}\nfunction decode_range(range) {\n\tvar idx = range.indexOf(\":\");\n\tif(idx == -1) return { s: decode_cell(range), e: decode_cell(range) };\n\treturn { s: decode_cell(range.slice(0, idx)), e: decode_cell(range.slice(idx + 1)) };\n}\nfunction encode_range(cs,ce) {\n\tif(typeof ce === 'undefined' || typeof ce === 'number') {\nreturn encode_range(cs.s, cs.e);\n\t}\nif(typeof cs !== 'string') cs = encode_cell((cs));\n\tif(typeof ce !== 'string') ce = encode_cell((ce));\nreturn cs == ce ? cs : cs + \":\" + ce;\n}\n\nfunction safe_decode_range(range) {\n\tvar o = {s:{c:0,r:0},e:{c:0,r:0}};\n\tvar idx = 0, i = 0, cc = 0;\n\tvar len = range.length;\n\tfor(idx = 0; i < len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-64) < 1 || cc > 26) break;\n\t\tidx = 26*idx + cc;\n\t}\n\to.s.c = --idx;\n\n\tfor(idx = 0; i < len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-48) < 0 || cc > 9) break;\n\t\tidx = 10*idx + cc;\n\t}\n\to.s.r = --idx;\n\n\tif(i === len || cc != 10) { o.e.c=o.s.c; o.e.r=o.s.r; return o; }\n\t++i;\n\n\tfor(idx = 0; i != len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-64) < 1 || cc > 26) break;\n\t\tidx = 26*idx + cc;\n\t}\n\to.e.c = --idx;\n\n\tfor(idx = 0; i != len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-48) < 0 || cc > 9) break;\n\t\tidx = 10*idx + cc;\n\t}\n\to.e.r = --idx;\n\treturn o;\n}\n\nfunction safe_format_cell(cell, v) {\n\tvar q = (cell.t == 'd' && v instanceof Date);\n\tif(cell.z != null) try { return (cell.w = SSF_format(cell.z, q ? datenum(v) : v)); } catch(e) { }\n\ttry { return (cell.w = SSF_format((cell.XF||{}).numFmtId||(q ? 14 : 0),  q ? datenum(v) : v)); } catch(e) { return ''+v; }\n}\n\nfunction format_cell(cell, v, o) {\n\tif(cell == null || cell.t == null || cell.t == 'z') return \"\";\n\tif(cell.w !== undefined) return cell.w;\n\tif(cell.t == 'd' && !cell.z && o && o.dateNF) cell.z = o.dateNF;\n\tif(cell.t == \"e\") return BErr[cell.v] || cell.v;\n\tif(v == undefined) return safe_format_cell(cell, cell.v);\n\treturn safe_format_cell(cell, v);\n}\n\nfunction sheet_to_workbook(sheet, opts) {\n\tvar n = opts && opts.sheet ? opts.sheet : \"Sheet1\";\n\tvar sheets = {}; sheets[n] = sheet;\n\treturn { SheetNames: [n], Sheets: sheets };\n}\n\nfunction sheet_add_aoa(_ws, data, opts) {\n\tvar o = opts || {};\n\tvar dense = _ws ? Array.isArray(_ws) : o.dense;\n\tif(DENSE != null && dense == null) dense = DENSE;\n\tvar ws = _ws || (dense ? ([]) : ({}));\n\tvar _R = 0, _C = 0;\n\tif(ws && o.origin != null) {\n\t\tif(typeof o.origin == 'number') _R = o.origin;\n\t\telse {\n\t\t\tvar _origin = typeof o.origin == \"string\" ? decode_cell(o.origin) : o.origin;\n\t\t\t_R = _origin.r; _C = _origin.c;\n\t\t}\n\t\tif(!ws[\"!ref\"]) ws[\"!ref\"] = \"A1:A1\";\n\t}\n\tvar range = ({s: {c:10000000, r:10000000}, e: {c:0, r:0}});\n\tif(ws['!ref']) {\n\t\tvar _range = safe_decode_range(ws['!ref']);\n\t\trange.s.c = _range.s.c;\n\t\trange.s.r = _range.s.r;\n\t\trange.e.c = Math.max(range.e.c, _range.e.c);\n\t\trange.e.r = Math.max(range.e.r, _range.e.r);\n\t\tif(_R == -1) range.e.r = _R = _range.e.r + 1;\n\t}\n\tfor(var R = 0; R != data.length; ++R) {\n\t\tif(!data[R]) continue;\n\t\tif(!Array.isArray(data[R])) throw new Error(\"aoa_to_sheet expects an array of arrays\");\n\t\tfor(var C = 0; C != data[R].length; ++C) {\n\t\t\tif(typeof data[R][C] === 'undefined') continue;\n\t\t\tvar cell = ({v: data[R][C] });\n\t\t\tvar __R = _R + R, __C = _C + C;\n\t\t\tif(range.s.r > __R) range.s.r = __R;\n\t\t\tif(range.s.c > __C) range.s.c = __C;\n\t\t\tif(range.e.r < __R) range.e.r = __R;\n\t\t\tif(range.e.c < __C) range.e.c = __C;\n\t\t\tif(data[R][C] && typeof data[R][C] === 'object' && !Array.isArray(data[R][C]) && !(data[R][C] instanceof Date)) cell = data[R][C];\n\t\t\telse {\n\t\t\t\tif(Array.isArray(cell.v)) { cell.f = data[R][C][1]; cell.v = cell.v[0]; }\n\t\t\t\tif(cell.v === null) {\n\t\t\t\t\tif(cell.f) cell.t = 'n';\n\t\t\t\t\telse if(o.nullError) { cell.t = 'e'; cell.v = 0; }\n\t\t\t\t\telse if(!o.sheetStubs) continue;\n\t\t\t\t\telse cell.t = 'z';\n\t\t\t\t}\n\t\t\t\telse if(typeof cell.v === 'number') cell.t = 'n';\n\t\t\t\telse if(typeof cell.v === 'boolean') cell.t = 'b';\n\t\t\t\telse if(cell.v instanceof Date) {\n\t\t\t\t\tcell.z = o.dateNF || table_fmt[14];\n\t\t\t\t\tif(o.cellDates) { cell.t = 'd'; cell.w = SSF_format(cell.z, datenum(cell.v)); }\n\t\t\t\t\telse { cell.t = 'n'; cell.v = datenum(cell.v); cell.w = SSF_format(cell.z, cell.v); }\n\t\t\t\t}\n\t\t\t\telse cell.t = 's';\n\t\t\t}\n\t\t\tif(dense) {\n\t\t\t\tif(!ws[__R]) ws[__R] = [];\n\t\t\t\tif(ws[__R][__C] && ws[__R][__C].z) cell.z = ws[__R][__C].z;\n\t\t\t\tws[__R][__C] = cell;\n\t\t\t} else {\n\t\t\t\tvar cell_ref = encode_cell(({c:__C,r:__R}));\n\t\t\t\tif(ws[cell_ref] && ws[cell_ref].z) cell.z = ws[cell_ref].z;\n\t\t\t\tws[cell_ref] = cell;\n\t\t\t}\n\t\t}\n\t}\n\tif(range.s.c < 10000000) ws['!ref'] = encode_range(range);\n\treturn ws;\n}\nfunction aoa_to_sheet(data, opts) { return sheet_add_aoa(null, data, opts); }\n\nfunction parse_Int32LE(data) {\n\treturn data.read_shift(4, 'i');\n}\nfunction write_UInt32LE(x, o) {\n\tif (!o) o = new_buf(4);\n\to.write_shift(4, x);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.168 */\nfunction parse_XLWideString(data) {\n\tvar cchCharacters = data.read_shift(4);\n\treturn cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n}\nfunction write_XLWideString(data, o) {\n\tvar _null = false; if (o == null) { _null = true; o = new_buf(4 + 2 * data.length); }\n\to.write_shift(4, data.length);\n\tif (data.length > 0) o.write_shift(0, data, 'dbcs');\n\treturn _null ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.5.91 */\n//function parse_LPWideString(data) {\n//\tvar cchCharacters = data.read_shift(2);\n//\treturn cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, \"utf16le\");\n//}\n\n/* [MS-XLSB] 2.5.143 */\nfunction parse_StrRun(data) {\n\treturn { ich: data.read_shift(2), ifnt: data.read_shift(2) };\n}\nfunction write_StrRun(run, o) {\n\tif (!o) o = new_buf(4);\n\to.write_shift(2, run.ich || 0);\n\to.write_shift(2, run.ifnt || 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.121 */\nfunction parse_RichStr(data, length) {\n\tvar start = data.l;\n\tvar flags = data.read_shift(1);\n\tvar str = parse_XLWideString(data);\n\tvar rgsStrRun = [];\n\tvar z = ({ t: str, h: str });\n\tif ((flags & 1) !== 0) { /* fRichStr */\n\t\t/* TODO: formatted string */\n\t\tvar dwSizeStrRun = data.read_shift(4);\n\t\tfor (var i = 0; i != dwSizeStrRun; ++i) rgsStrRun.push(parse_StrRun(data));\n\t\tz.r = rgsStrRun;\n\t}\n\telse z.r = [{ ich: 0, ifnt: 0 }];\n\t//if((flags & 2) !== 0) { /* fExtStr */\n\t//\t/* TODO: phonetic string */\n\t//}\n\tdata.l = start + length;\n\treturn z;\n}\nfunction write_RichStr(str, o) {\n\t/* TODO: formatted string */\n\tvar _null = false; if (o == null) { _null = true; o = new_buf(15 + 4 * str.t.length); }\n\to.write_shift(1, 0);\n\twrite_XLWideString(str.t, o);\n\treturn _null ? o.slice(0, o.l) : o;\n}\n/* [MS-XLSB] 2.4.328 BrtCommentText (RichStr w/1 run) */\nvar parse_BrtCommentText = parse_RichStr;\nfunction write_BrtCommentText(str, o) {\n\t/* TODO: formatted string */\n\tvar _null = false; if (o == null) { _null = true; o = new_buf(23 + 4 * str.t.length); }\n\to.write_shift(1, 1);\n\twrite_XLWideString(str.t, o);\n\to.write_shift(4, 1);\n\twrite_StrRun({ ich: 0, ifnt: 0 }, o);\n\treturn _null ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.5.9 */\nfunction parse_XLSBCell(data) {\n\tvar col = data.read_shift(4);\n\tvar iStyleRef = data.read_shift(2);\n\tiStyleRef += data.read_shift(1) << 16;\n\tdata.l++; //var fPhShow = data.read_shift(1);\n\treturn { c: col, iStyleRef: iStyleRef };\n}\nfunction write_XLSBCell(cell, o) {\n\tif (o == null) o = new_buf(8);\n\to.write_shift(-4, cell.c);\n\to.write_shift(3, cell.iStyleRef || cell.s);\n\to.write_shift(1, 0); /* fPhShow */\n\treturn o;\n}\n\n/* Short XLSB Cell does not include column */\nfunction parse_XLSBShortCell(data) {\n\tvar iStyleRef = data.read_shift(2);\n\tiStyleRef += data.read_shift(1) <<16;\n\tdata.l++; //var fPhShow = data.read_shift(1);\n\treturn { c:-1, iStyleRef: iStyleRef };\n}\nfunction write_XLSBShortCell(cell, o) {\n\tif(o == null) o = new_buf(4);\n\to.write_shift(3, cell.iStyleRef || cell.s);\n\to.write_shift(1, 0); /* fPhShow */\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.21 */\nvar parse_XLSBCodeName = parse_XLWideString;\nvar write_XLSBCodeName = write_XLWideString;\n\n/* [MS-XLSB] 2.5.166 */\nfunction parse_XLNullableWideString(data) {\n\tvar cchCharacters = data.read_shift(4);\n\treturn cchCharacters === 0 || cchCharacters === 0xFFFFFFFF ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n}\nfunction write_XLNullableWideString(data, o) {\n\tvar _null = false; if (o == null) { _null = true; o = new_buf(127); }\n\to.write_shift(4, data.length > 0 ? data.length : 0xFFFFFFFF);\n\tif (data.length > 0) o.write_shift(0, data, 'dbcs');\n\treturn _null ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.5.165 */\nvar parse_XLNameWideString = parse_XLWideString;\n//var write_XLNameWideString = write_XLWideString;\n\n/* [MS-XLSB] 2.5.114 */\nvar parse_RelID = parse_XLNullableWideString;\nvar write_RelID = write_XLNullableWideString;\n\n\n/* [MS-XLS] 2.5.217 ; [MS-XLSB] 2.5.122 */\nfunction parse_RkNumber(data) {\n\tvar b = data.slice(data.l, data.l + 4);\n\tvar fX100 = (b[0] & 1), fInt = (b[0] & 2);\n\tdata.l += 4;\n\tvar RK = fInt === 0 ? __double([0, 0, 0, 0, (b[0] & 0xFC), b[1], b[2], b[3]], 0) : __readInt32LE(b, 0) >> 2;\n\treturn fX100 ? (RK / 100) : RK;\n}\nfunction write_RkNumber(data, o) {\n\tif (o == null) o = new_buf(4);\n\tvar fX100 = 0, fInt = 0, d100 = data * 100;\n\tif ((data == (data | 0)) && (data >= -(1 << 29)) && (data < (1 << 29))) { fInt = 1; }\n\telse if ((d100 == (d100 | 0)) && (d100 >= -(1 << 29)) && (d100 < (1 << 29))) { fInt = 1; fX100 = 1; }\n\tif (fInt) o.write_shift(-4, ((fX100 ? d100 : data) << 2) + (fX100 + 2));\n\telse throw new Error(\"unsupported RkNumber \" + data); // TODO\n}\n\n\n/* [MS-XLSB] 2.5.117 RfX */\nfunction parse_RfX(data ) {\n\tvar cell = ({ s: {}, e: {} });\n\tcell.s.r = data.read_shift(4);\n\tcell.e.r = data.read_shift(4);\n\tcell.s.c = data.read_shift(4);\n\tcell.e.c = data.read_shift(4);\n\treturn cell;\n}\nfunction write_RfX(r, o) {\n\tif (!o) o = new_buf(16);\n\to.write_shift(4, r.s.r);\n\to.write_shift(4, r.e.r);\n\to.write_shift(4, r.s.c);\n\to.write_shift(4, r.e.c);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.153 UncheckedRfX */\nvar parse_UncheckedRfX = parse_RfX;\nvar write_UncheckedRfX = write_RfX;\n\n/* [MS-XLSB] 2.5.155 UncheckedSqRfX */\n//function parse_UncheckedSqRfX(data) {\n//\tvar cnt = data.read_shift(4);\n//\tvar out = [];\n//\tfor(var i = 0; i < cnt; ++i) {\n//\t\tvar rng = parse_UncheckedRfX(data);\n//\t\tout.push(encode_range(rng));\n//\t}\n//\treturn out.join(\",\");\n//}\n//function write_UncheckedSqRfX(sqrfx) {\n//\tvar parts = sqrfx.split(/\\s*,\\s*/);\n//\tvar o = new_buf(4); o.write_shift(4, parts.length);\n//\tvar out = [o];\n//\tparts.forEach(function(rng) {\n//\t\tout.push(write_UncheckedRfX(safe_decode_range(rng)));\n//\t});\n//\treturn bconcat(out);\n//}\n\n/* [MS-XLS] 2.5.342 ; [MS-XLSB] 2.5.171 */\n/* TODO: error checking, NaN and Infinity values are not valid Xnum */\nfunction parse_Xnum(data) {\n\tif(data.length - data.l < 8) throw \"XLS Xnum Buffer underflow\";\n\treturn data.read_shift(8, 'f');\n}\nfunction write_Xnum(data, o) { return (o || new_buf(8)).write_shift(8, data, 'f'); }\n\n/* [MS-XLSB] 2.4.324 BrtColor */\nfunction parse_BrtColor(data) {\n\tvar out = {};\n\tvar d = data.read_shift(1);\n\n\t//var fValidRGB = d & 1;\n\tvar xColorType = d >>> 1;\n\n\tvar index = data.read_shift(1);\n\tvar nTS = data.read_shift(2, 'i');\n\tvar bR = data.read_shift(1);\n\tvar bG = data.read_shift(1);\n\tvar bB = data.read_shift(1);\n\tdata.l++; //var bAlpha = data.read_shift(1);\n\n\tswitch (xColorType) {\n\t\tcase 0: out.auto = 1; break;\n\t\tcase 1:\n\t\t\tout.index = index;\n\t\t\tvar icv = XLSIcv[index];\n\t\t\t/* automatic pseudo index 81 */\n\t\t\tif (icv) out.rgb = rgb2Hex(icv);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\t/* if(!fValidRGB) throw new Error(\"invalid\"); */\n\t\t\tout.rgb = rgb2Hex([bR, bG, bB]);\n\t\t\tbreak;\n\t\tcase 3: out.theme = index; break;\n\t}\n\tif (nTS != 0) out.tint = nTS > 0 ? nTS / 32767 : nTS / 32768;\n\n\treturn out;\n}\nfunction write_BrtColor(color, o) {\n\tif (!o) o = new_buf(8);\n\tif (!color || color.auto) { o.write_shift(4, 0); o.write_shift(4, 0); return o; }\n\tif (color.index != null) {\n\t\to.write_shift(1, 0x02);\n\t\to.write_shift(1, color.index);\n\t} else if (color.theme != null) {\n\t\to.write_shift(1, 0x06);\n\t\to.write_shift(1, color.theme);\n\t} else {\n\t\to.write_shift(1, 0x05);\n\t\to.write_shift(1, 0);\n\t}\n\tvar nTS = color.tint || 0;\n\tif (nTS > 0) nTS *= 32767;\n\telse if (nTS < 0) nTS *= 32768;\n\to.write_shift(2, nTS);\n\tif (!color.rgb || color.theme != null) {\n\t\to.write_shift(2, 0);\n\t\to.write_shift(1, 0);\n\t\to.write_shift(1, 0);\n\t} else {\n\t\tvar rgb = (color.rgb || 'FFFFFF');\n\t\tif (typeof rgb == 'number') rgb = (\"000000\" + rgb.toString(16)).slice(-6);\n\t\to.write_shift(1, parseInt(rgb.slice(0, 2), 16));\n\t\to.write_shift(1, parseInt(rgb.slice(2, 4), 16));\n\t\to.write_shift(1, parseInt(rgb.slice(4, 6), 16));\n\t\to.write_shift(1, 0xFF);\n\t}\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.52 */\nfunction parse_FontFlags(data) {\n\tvar d = data.read_shift(1);\n\tdata.l++;\n\tvar out = {\n\t\tfBold: d & 0x01,\n\t\tfItalic: d & 0x02,\n\t\tfUnderline: d & 0x04,\n\t\tfStrikeout: d & 0x08,\n\t\tfOutline: d & 0x10,\n\t\tfShadow: d & 0x20,\n\t\tfCondense: d & 0x40,\n\t\tfExtend: d & 0x80\n\t};\n\treturn out;\n}\nfunction write_FontFlags(font, o) {\n\tif (!o) o = new_buf(2);\n\tvar grbit =\n\t\t(font.italic ? 0x02 : 0) |\n\t\t(font.strike ? 0x08 : 0) |\n\t\t(font.outline ? 0x10 : 0) |\n\t\t(font.shadow ? 0x20 : 0) |\n\t\t(font.condense ? 0x40 : 0) |\n\t\t(font.extend ? 0x80 : 0);\n\to.write_shift(1, grbit);\n\to.write_shift(1, 0);\n\treturn o;\n}\n\n/* [MS-OLEDS] 2.3.1 and 2.3.2 */\nfunction parse_ClipboardFormatOrString(o, w) {\n\t// $FlowIgnore\n\tvar ClipFmt = { 2: \"BITMAP\", 3: \"METAFILEPICT\", 8: \"DIB\", 14: \"ENHMETAFILE\" };\n\tvar m = o.read_shift(4);\n\tswitch (m) {\n\t\tcase 0x00000000: return \"\";\n\t\tcase 0xffffffff: case 0xfffffffe: return ClipFmt[o.read_shift(4)] || \"\";\n\t}\n\tif (m > 0x190) throw new Error(\"Unsupported Clipboard: \" + m.toString(16));\n\to.l -= 4;\n\treturn o.read_shift(0, w == 1 ? \"lpstr\" : \"lpwstr\");\n}\nfunction parse_ClipboardFormatOrAnsiString(o) { return parse_ClipboardFormatOrString(o, 1); }\nfunction parse_ClipboardFormatOrUnicodeString(o) { return parse_ClipboardFormatOrString(o, 2); }\n\n/* [MS-OLEPS] 2.2 PropertyType */\n// Note: some tree shakers cannot handle VT_VECTOR | $CONST, hence extra vars\n//var VT_EMPTY    = 0x0000;\n//var VT_NULL     = 0x0001;\nvar VT_I2       = 0x0002;\nvar VT_I4       = 0x0003;\n//var VT_R4       = 0x0004;\n//var VT_R8       = 0x0005;\n//var VT_CY       = 0x0006;\n//var VT_DATE     = 0x0007;\n//var VT_BSTR     = 0x0008;\n//var VT_ERROR    = 0x000A;\nvar VT_BOOL     = 0x000B;\nvar VT_VARIANT  = 0x000C;\n//var VT_DECIMAL  = 0x000E;\n//var VT_I1       = 0x0010;\n//var VT_UI1      = 0x0011;\n//var VT_UI2      = 0x0012;\nvar VT_UI4      = 0x0013;\n//var VT_I8       = 0x0014;\n//var VT_UI8      = 0x0015;\n//var VT_INT      = 0x0016;\n//var VT_UINT     = 0x0017;\nvar VT_LPSTR    = 0x001E;\n//var VT_LPWSTR   = 0x001F;\nvar VT_FILETIME = 0x0040;\nvar VT_BLOB     = 0x0041;\n//var VT_STREAM   = 0x0042;\n//var VT_STORAGE  = 0x0043;\n//var VT_STREAMED_Object  = 0x0044;\n//var VT_STORED_Object    = 0x0045;\n//var VT_BLOB_Object      = 0x0046;\nvar VT_CF       = 0x0047;\n//var VT_CLSID    = 0x0048;\n//var VT_VERSIONED_STREAM = 0x0049;\nvar VT_VECTOR   = 0x1000;\nvar VT_VECTOR_VARIANT = 0x100C;\nvar VT_VECTOR_LPSTR   = 0x101E;\n//var VT_ARRAY    = 0x2000;\n\nvar VT_STRING   = 0x0050; // 2.3.3.1.11 VtString\nvar VT_USTR     = 0x0051; // 2.3.3.1.12 VtUnalignedString\nvar VT_CUSTOM   = [VT_STRING, VT_USTR];\n\n/* [MS-OSHARED] 2.3.3.2.2.1 Document Summary Information PIDDSI */\nvar DocSummaryPIDDSI = {\n0x01: { n: 'CodePage', t: VT_I2 },\n0x02: { n: 'Category', t: VT_STRING },\n0x03: { n: 'PresentationFormat', t: VT_STRING },\n0x04: { n: 'ByteCount', t: VT_I4 },\n0x05: { n: 'LineCount', t: VT_I4 },\n0x06: { n: 'ParagraphCount', t: VT_I4 },\n0x07: { n: 'SlideCount', t: VT_I4 },\n0x08: { n: 'NoteCount', t: VT_I4 },\n0x09: { n: 'HiddenCount', t: VT_I4 },\n0x0a: { n: 'MultimediaClipCount', t: VT_I4 },\n0x0b: { n: 'ScaleCrop', t: VT_BOOL },\n0x0c: { n: 'HeadingPairs', t: VT_VECTOR_VARIANT /* VT_VECTOR | VT_VARIANT */ },\n0x0d: { n: 'TitlesOfParts', t: VT_VECTOR_LPSTR /* VT_VECTOR | VT_LPSTR */ },\n0x0e: { n: 'Manager', t: VT_STRING },\n0x0f: { n: 'Company', t: VT_STRING },\n0x10: { n: 'LinksUpToDate', t: VT_BOOL },\n0x11: { n: 'CharacterCount', t: VT_I4 },\n0x13: { n: 'SharedDoc', t: VT_BOOL },\n0x16: { n: 'HyperlinksChanged', t: VT_BOOL },\n0x17: { n: 'AppVersion', t: VT_I4, p: 'version' },\n0x18: { n: 'DigSig', t: VT_BLOB },\n0x1A: { n: 'ContentType', t: VT_STRING },\n0x1B: { n: 'ContentStatus', t: VT_STRING },\n0x1C: { n: 'Language', t: VT_STRING },\n0x1D: { n: 'Version', t: VT_STRING },\n0xFF: {},\n\t/* [MS-OLEPS] 2.18 */\n0x80000000: { n: 'Locale', t: VT_UI4 },\n0x80000003: { n: 'Behavior', t: VT_UI4 },\n0x72627262: {}\n};\n\n/* [MS-OSHARED] 2.3.3.2.1.1 Summary Information Property Set PIDSI */\nvar SummaryPIDSI = {\n0x01: { n: 'CodePage', t: VT_I2 },\n0x02: { n: 'Title', t: VT_STRING },\n0x03: { n: 'Subject', t: VT_STRING },\n0x04: { n: 'Author', t: VT_STRING },\n0x05: { n: 'Keywords', t: VT_STRING },\n0x06: { n: 'Comments', t: VT_STRING },\n0x07: { n: 'Template', t: VT_STRING },\n0x08: { n: 'LastAuthor', t: VT_STRING },\n0x09: { n: 'RevNumber', t: VT_STRING },\n0x0A: { n: 'EditTime', t: VT_FILETIME },\n0x0B: { n: 'LastPrinted', t: VT_FILETIME },\n0x0C: { n: 'CreatedDate', t: VT_FILETIME },\n0x0D: { n: 'ModifiedDate', t: VT_FILETIME },\n0x0E: { n: 'PageCount', t: VT_I4 },\n0x0F: { n: 'WordCount', t: VT_I4 },\n0x10: { n: 'CharCount', t: VT_I4 },\n0x11: { n: 'Thumbnail', t: VT_CF },\n0x12: { n: 'Application', t: VT_STRING },\n0x13: { n: 'DocSecurity', t: VT_I4 },\n0xFF: {},\n\t/* [MS-OLEPS] 2.18 */\n0x80000000: { n: 'Locale', t: VT_UI4 },\n0x80000003: { n: 'Behavior', t: VT_UI4 },\n0x72627262: {}\n};\n\n/* [MS-XLS] 2.4.63 Country/Region codes */\nvar CountryEnum = {\n0x0001: \"US\", // United States\n0x0002: \"CA\", // Canada\n0x0003: \"\", // Latin America (except Brazil)\n0x0007: \"RU\", // Russia\n0x0014: \"EG\", // Egypt\n0x001E: \"GR\", // Greece\n0x001F: \"NL\", // Netherlands\n0x0020: \"BE\", // Belgium\n0x0021: \"FR\", // France\n0x0022: \"ES\", // Spain\n0x0024: \"HU\", // Hungary\n0x0027: \"IT\", // Italy\n0x0029: \"CH\", // Switzerland\n0x002B: \"AT\", // Austria\n0x002C: \"GB\", // United Kingdom\n0x002D: \"DK\", // Denmark\n0x002E: \"SE\", // Sweden\n0x002F: \"NO\", // Norway\n0x0030: \"PL\", // Poland\n0x0031: \"DE\", // Germany\n0x0034: \"MX\", // Mexico\n0x0037: \"BR\", // Brazil\n0x003d: \"AU\", // Australia\n0x0040: \"NZ\", // New Zealand\n0x0042: \"TH\", // Thailand\n0x0051: \"JP\", // Japan\n0x0052: \"KR\", // Korea\n0x0054: \"VN\", // Viet Nam\n0x0056: \"CN\", // China\n0x005A: \"TR\", // Turkey\n0x0069: \"JS\", // Ramastan\n0x00D5: \"DZ\", // Algeria\n0x00D8: \"MA\", // Morocco\n0x00DA: \"LY\", // Libya\n0x015F: \"PT\", // Portugal\n0x0162: \"IS\", // Iceland\n0x0166: \"FI\", // Finland\n0x01A4: \"CZ\", // Czech Republic\n0x0376: \"TW\", // Taiwan\n0x03C1: \"LB\", // Lebanon\n0x03C2: \"JO\", // Jordan\n0x03C3: \"SY\", // Syria\n0x03C4: \"IQ\", // Iraq\n0x03C5: \"KW\", // Kuwait\n0x03C6: \"SA\", // Saudi Arabia\n0x03CB: \"AE\", // United Arab Emirates\n0x03CC: \"IL\", // Israel\n0x03CE: \"QA\", // Qatar\n0x03D5: \"IR\", // Iran\n0xFFFF: \"US\"  // United States\n};\n\n/* [MS-XLS] 2.5.127 */\nvar XLSFillPattern = [\n\tnull,\n\t'solid',\n\t'mediumGray',\n\t'darkGray',\n\t'lightGray',\n\t'darkHorizontal',\n\t'darkVertical',\n\t'darkDown',\n\t'darkUp',\n\t'darkGrid',\n\t'darkTrellis',\n\t'lightHorizontal',\n\t'lightVertical',\n\t'lightDown',\n\t'lightUp',\n\t'lightGrid',\n\t'lightTrellis',\n\t'gray125',\n\t'gray0625'\n];\n\nfunction rgbify(arr) { return arr.map(function(x) { return [(x>>16)&255,(x>>8)&255,x&255]; }); }\n\n/* [MS-XLS] 2.5.161 */\n/* [MS-XLSB] 2.5.75 Icv */\nvar _XLSIcv =  rgbify([\n\t/* Color Constants */\n\t0x000000,\n\t0xFFFFFF,\n\t0xFF0000,\n\t0x00FF00,\n\t0x0000FF,\n\t0xFFFF00,\n\t0xFF00FF,\n\t0x00FFFF,\n\n\t/* Overridable Defaults */\n\t0x000000,\n\t0xFFFFFF,\n\t0xFF0000,\n\t0x00FF00,\n\t0x0000FF,\n\t0xFFFF00,\n\t0xFF00FF,\n\t0x00FFFF,\n\n\t0x800000,\n\t0x008000,\n\t0x000080,\n\t0x808000,\n\t0x800080,\n\t0x008080,\n\t0xC0C0C0,\n\t0x808080,\n\t0x9999FF,\n\t0x993366,\n\t0xFFFFCC,\n\t0xCCFFFF,\n\t0x660066,\n\t0xFF8080,\n\t0x0066CC,\n\t0xCCCCFF,\n\n\t0x000080,\n\t0xFF00FF,\n\t0xFFFF00,\n\t0x00FFFF,\n\t0x800080,\n\t0x800000,\n\t0x008080,\n\t0x0000FF,\n\t0x00CCFF,\n\t0xCCFFFF,\n\t0xCCFFCC,\n\t0xFFFF99,\n\t0x99CCFF,\n\t0xFF99CC,\n\t0xCC99FF,\n\t0xFFCC99,\n\n\t0x3366FF,\n\t0x33CCCC,\n\t0x99CC00,\n\t0xFFCC00,\n\t0xFF9900,\n\t0xFF6600,\n\t0x666699,\n\t0x969696,\n\t0x003366,\n\t0x339966,\n\t0x003300,\n\t0x333300,\n\t0x993300,\n\t0x993366,\n\t0x333399,\n\t0x333333,\n\n\t/* Other entries to appease BIFF8/12 */\n\t0xFFFFFF, /* 0x40 icvForeground ?? */\n\t0x000000, /* 0x41 icvBackground ?? */\n\t0x000000, /* 0x42 icvFrame ?? */\n\t0x000000, /* 0x43 icv3D ?? */\n\t0x000000, /* 0x44 icv3DText ?? */\n\t0x000000, /* 0x45 icv3DHilite ?? */\n\t0x000000, /* 0x46 icv3DShadow ?? */\n\t0x000000, /* 0x47 icvHilite ?? */\n\t0x000000, /* 0x48 icvCtlText ?? */\n\t0x000000, /* 0x49 icvCtlScrl ?? */\n\t0x000000, /* 0x4A icvCtlInv ?? */\n\t0x000000, /* 0x4B icvCtlBody ?? */\n\t0x000000, /* 0x4C icvCtlFrame ?? */\n\t0x000000, /* 0x4D icvCtlFore ?? */\n\t0x000000, /* 0x4E icvCtlBack ?? */\n\t0x000000, /* 0x4F icvCtlNeutral */\n\t0x000000, /* 0x50 icvInfoBk ?? */\n\t0x000000 /* 0x51 icvInfoText ?? */\n]);\nvar XLSIcv = dup(_XLSIcv);\n\n/* [MS-XLSB] 2.5.97.2 */\nvar BErr = {\n0x00: \"#NULL!\",\n0x07: \"#DIV/0!\",\n0x0F: \"#VALUE!\",\n0x17: \"#REF!\",\n0x1D: \"#NAME?\",\n0x24: \"#NUM!\",\n0x2A: \"#N/A\",\n0x2B: \"#GETTING_DATA\",\n0xFF: \"#WTF?\"\n};\n//var RBErr = evert_num(BErr);\nvar RBErr = {\n\t\"#NULL!\":        0x00,\n\t\"#DIV/0!\":       0x07,\n\t\"#VALUE!\":       0x0F,\n\t\"#REF!\":         0x17,\n\t\"#NAME?\":        0x1D,\n\t\"#NUM!\":         0x24,\n\t\"#N/A\":          0x2A,\n\t\"#GETTING_DATA\": 0x2B,\n\t\"#WTF?\":         0xFF\n};\n\n/* Parts enumerated in OPC spec, MS-XLSB and MS-XLSX */\n/* 12.3 Part Summary <SpreadsheetML> */\n/* 14.2 Part Summary <DrawingML> */\n/* [MS-XLSX] 2.1 Part Enumerations ; [MS-XLSB] 2.1.7 Part Enumeration */\nvar ct2type/*{[string]:string}*/ = ({\n\t/* Workbook */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\": \"workbooks\",\n\t\"application/vnd.ms-excel.sheet.macroEnabled.main+xml\": \"workbooks\",\n\t\"application/vnd.ms-excel.sheet.binary.macroEnabled.main\": \"workbooks\",\n\t\"application/vnd.ms-excel.addin.macroEnabled.main+xml\": \"workbooks\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\": \"workbooks\",\n\n\t/* Worksheet */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\": \"sheets\",\n\t\"application/vnd.ms-excel.worksheet\": \"sheets\",\n\t\"application/vnd.ms-excel.binIndexWs\": \"TODO\", /* Binary Index */\n\n\t/* Chartsheet */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\": \"charts\",\n\t\"application/vnd.ms-excel.chartsheet\": \"charts\",\n\n\t/* Macrosheet */\n\t\"application/vnd.ms-excel.macrosheet+xml\": \"macros\",\n\t\"application/vnd.ms-excel.macrosheet\": \"macros\",\n\t\"application/vnd.ms-excel.intlmacrosheet\": \"TODO\",\n\t\"application/vnd.ms-excel.binIndexMs\": \"TODO\", /* Binary Index */\n\n\t/* Dialogsheet */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\": \"dialogs\",\n\t\"application/vnd.ms-excel.dialogsheet\": \"dialogs\",\n\n\t/* Shared Strings */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\": \"strs\",\n\t\"application/vnd.ms-excel.sharedStrings\": \"strs\",\n\n\t/* Styles */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\": \"styles\",\n\t\"application/vnd.ms-excel.styles\": \"styles\",\n\n\t/* File Properties */\n\t\"application/vnd.openxmlformats-package.core-properties+xml\": \"coreprops\",\n\t\"application/vnd.openxmlformats-officedocument.custom-properties+xml\": \"custprops\",\n\t\"application/vnd.openxmlformats-officedocument.extended-properties+xml\": \"extprops\",\n\n\t/* Custom Data Properties */\n\t\"application/vnd.openxmlformats-officedocument.customXmlProperties+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty\": \"TODO\",\n\n\t/* Comments */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\": \"comments\",\n\t\"application/vnd.ms-excel.comments\": \"comments\",\n\t\"application/vnd.ms-excel.threadedcomments+xml\": \"threadedcomments\",\n\t\"application/vnd.ms-excel.person+xml\": \"people\",\n\n\t/* Metadata (Stock/Geography and Dynamic Array) */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\": \"metadata\",\n\t\"application/vnd.ms-excel.sheetMetadata\": \"metadata\",\n\n\t/* PivotTable */\n\t\"application/vnd.ms-excel.pivotTable\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml\": \"TODO\",\n\n\t/* Chart Objects */\n\t\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\": \"TODO\",\n\n\t/* Chart Colors */\n\t\"application/vnd.ms-office.chartcolorstyle+xml\": \"TODO\",\n\n\t/* Chart Style */\n\t\"application/vnd.ms-office.chartstyle+xml\": \"TODO\",\n\n\t/* Chart Advanced */\n\t\"application/vnd.ms-office.chartex+xml\": \"TODO\",\n\n\t/* Calculation Chain */\n\t\"application/vnd.ms-excel.calcChain\": \"calcchains\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml\": \"calcchains\",\n\n\t/* Printer Settings */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings\": \"TODO\",\n\n\t/* ActiveX */\n\t\"application/vnd.ms-office.activeX\": \"TODO\",\n\t\"application/vnd.ms-office.activeX+xml\": \"TODO\",\n\n\t/* Custom Toolbars */\n\t\"application/vnd.ms-excel.attachedToolbars\": \"TODO\",\n\n\t/* External Data Connections */\n\t\"application/vnd.ms-excel.connections\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml\": \"TODO\",\n\n\t/* External Links */\n\t\"application/vnd.ms-excel.externalLink\": \"links\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml\": \"links\",\n\n\t/* PivotCache */\n\t\"application/vnd.ms-excel.pivotCacheDefinition\": \"TODO\",\n\t\"application/vnd.ms-excel.pivotCacheRecords\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml\": \"TODO\",\n\n\t/* Query Table */\n\t\"application/vnd.ms-excel.queryTable\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml\": \"TODO\",\n\n\t/* Shared Workbook */\n\t\"application/vnd.ms-excel.userNames\": \"TODO\",\n\t\"application/vnd.ms-excel.revisionHeaders\": \"TODO\",\n\t\"application/vnd.ms-excel.revisionLog\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml\": \"TODO\",\n\n\t/* Single Cell Table */\n\t\"application/vnd.ms-excel.tableSingleCells\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml\": \"TODO\",\n\n\t/* Slicer */\n\t\"application/vnd.ms-excel.slicer\": \"TODO\",\n\t\"application/vnd.ms-excel.slicerCache\": \"TODO\",\n\t\"application/vnd.ms-excel.slicer+xml\": \"TODO\",\n\t\"application/vnd.ms-excel.slicerCache+xml\": \"TODO\",\n\n\t/* Sort Map */\n\t\"application/vnd.ms-excel.wsSortMap\": \"TODO\",\n\n\t/* Table */\n\t\"application/vnd.ms-excel.table\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\": \"TODO\",\n\n\t/* Themes */\n\t\"application/vnd.openxmlformats-officedocument.theme+xml\": \"themes\",\n\n\t/* Theme Override */\n\t\"application/vnd.openxmlformats-officedocument.themeOverride+xml\": \"TODO\",\n\n\t/* Timeline */\n\t\"application/vnd.ms-excel.Timeline+xml\": \"TODO\", /* verify */\n\t\"application/vnd.ms-excel.TimelineCache+xml\": \"TODO\", /* verify */\n\n\t/* VBA */\n\t\"application/vnd.ms-office.vbaProject\": \"vba\",\n\t\"application/vnd.ms-office.vbaProjectSignature\": \"TODO\",\n\n\t/* Volatile Dependencies */\n\t\"application/vnd.ms-office.volatileDependencies\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml\": \"TODO\",\n\n\t/* Control Properties */\n\t\"application/vnd.ms-excel.controlproperties+xml\": \"TODO\",\n\n\t/* Data Model */\n\t\"application/vnd.openxmlformats-officedocument.model+data\": \"TODO\",\n\n\t/* Survey */\n\t\"application/vnd.ms-excel.Survey+xml\": \"TODO\",\n\n\t/* Drawing */\n\t\"application/vnd.openxmlformats-officedocument.drawing+xml\": \"drawings\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml\": \"TODO\",\n\n\t/* VML */\n\t\"application/vnd.openxmlformats-officedocument.vmlDrawing\": \"TODO\",\n\n\t\"application/vnd.openxmlformats-package.relationships+xml\": \"rels\",\n\t\"application/vnd.openxmlformats-officedocument.oleObject\": \"TODO\",\n\n\t/* Image */\n\t\"image/png\": \"TODO\",\n\n\t\"sheet\": \"js\"\n});\n\nvar CT_LIST = {\n\t\tworkbooks: {\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\",\n\t\t\txlsm: \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\",\n\t\t\txlam: \"application/vnd.ms-excel.addin.macroEnabled.main+xml\",\n\t\t\txltx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\"\n\t\t},\n\t\tstrs: { /* Shared Strings */\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.sharedStrings\"\n\t\t},\n\t\tcomments: { /* Comments */\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.comments\"\n\t\t},\n\t\tsheets: { /* Worksheet */\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.worksheet\"\n\t\t},\n\t\tcharts: { /* Chartsheet */\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.chartsheet\"\n\t\t},\n\t\tdialogs: { /* Dialogsheet */\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.dialogsheet\"\n\t\t},\n\t\tmacros: { /* Macrosheet (Excel 4.0 Macros) */\n\t\t\txlsx: \"application/vnd.ms-excel.macrosheet+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.macrosheet\"\n\t\t},\n\t\tmetadata: { /* Metadata (Stock/Geography and Dynamic Array) */\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.sheetMetadata\"\n\t\t},\n\t\tstyles: { /* Styles */\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.styles\"\n\t\t}\n};\n\nfunction new_ct() {\n\treturn ({\n\t\tworkbooks:[], sheets:[], charts:[], dialogs:[], macros:[],\n\t\trels:[], strs:[], comments:[], threadedcomments:[], links:[],\n\t\tcoreprops:[], extprops:[], custprops:[], themes:[], styles:[],\n\t\tcalcchains:[], vba: [], drawings: [], metadata: [], people:[],\n\t\tTODO:[], xmlns: \"\" });\n}\n\nfunction parse_ct(data) {\n\tvar ct = new_ct();\n\tif(!data || !data.match) return ct;\n\tvar ctext = {};\n\t(data.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(y[0].replace(nsregex,\"<\")) {\n\t\t\tcase '<?xml': break;\n\t\t\tcase '<Types': ct.xmlns = y['xmlns' + (y[0].match(/<(\\w+):/)||[\"\",\"\"])[1] ]; break;\n\t\t\tcase '<Default': ctext[y.Extension] = y.ContentType; break;\n\t\t\tcase '<Override':\n\t\t\t\tif(ct[ct2type[y.ContentType]] !== undefined) ct[ct2type[y.ContentType]].push(y.PartName);\n\t\t\t\tbreak;\n\t\t}\n\t});\n\tif(ct.xmlns !== XMLNS.CT) throw new Error(\"Unknown Namespace: \" + ct.xmlns);\n\tct.calcchain = ct.calcchains.length > 0 ? ct.calcchains[0] : \"\";\n\tct.sst = ct.strs.length > 0 ? ct.strs[0] : \"\";\n\tct.style = ct.styles.length > 0 ? ct.styles[0] : \"\";\n\tct.defaults = ctext;\n\tdelete ct.calcchains;\n\treturn ct;\n}\n\nfunction write_ct(ct, opts) {\n\tvar type2ct/*{[string]:Array<string>}*/ = evert_arr(ct2type);\n\n\tvar o = [], v;\n\to[o.length] = (XML_HEADER);\n\to[o.length] = writextag('Types', null, {\n\t\t'xmlns': XMLNS.CT,\n\t\t'xmlns:xsd': XMLNS.xsd,\n\t\t'xmlns:xsi': XMLNS.xsi\n\t});\n\n\to = o.concat([\n\t\t['xml', 'application/xml'],\n\t\t['bin', 'application/vnd.ms-excel.sheet.binary.macroEnabled.main'],\n\t\t['vml', 'application/vnd.openxmlformats-officedocument.vmlDrawing'],\n\t\t['data', 'application/vnd.openxmlformats-officedocument.model+data'],\n\t\t/* from test files */\n\t\t['bmp', 'image/bmp'],\n\t\t['png', 'image/png'],\n\t\t['gif', 'image/gif'],\n\t\t['emf', 'image/x-emf'],\n\t\t['wmf', 'image/x-wmf'],\n\t\t['jpg', 'image/jpeg'], ['jpeg', 'image/jpeg'],\n\t\t['tif', 'image/tiff'], ['tiff', 'image/tiff'],\n\t\t['pdf', 'application/pdf'],\n\t\t['rels', 'application/vnd.openxmlformats-package.relationships+xml']\n\t].map(function(x) {\n\t\treturn writextag('Default', null, {'Extension':x[0], 'ContentType': x[1]});\n\t}));\n\n\t/* only write first instance */\n\tvar f1 = function(w) {\n\t\tif(ct[w] && ct[w].length > 0) {\n\t\t\tv = ct[w][0];\n\t\t\to[o.length] = (writextag('Override', null, {\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\n\t\t\t\t'ContentType': CT_LIST[w][opts.bookType] || CT_LIST[w]['xlsx']\n\t\t\t}));\n\t\t}\n\t};\n\n\t/* book type-specific */\n\tvar f2 = function(w) {\n\t\t(ct[w]||[]).forEach(function(v) {\n\t\t\to[o.length] = (writextag('Override', null, {\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\n\t\t\t\t'ContentType': CT_LIST[w][opts.bookType] || CT_LIST[w]['xlsx']\n\t\t\t}));\n\t\t});\n\t};\n\n\t/* standard type */\n\tvar f3 = function(t) {\n\t\t(ct[t]||[]).forEach(function(v) {\n\t\t\to[o.length] = (writextag('Override', null, {\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\n\t\t\t\t'ContentType': type2ct[t][0]\n\t\t\t}));\n\t\t});\n\t};\n\n\tf1('workbooks');\n\tf2('sheets');\n\tf2('charts');\n\tf3('themes');\n\t['strs', 'styles'].forEach(f1);\n\t['coreprops', 'extprops', 'custprops'].forEach(f3);\n\tf3('vba');\n\tf3('comments');\n\tf3('threadedcomments');\n\tf3('drawings');\n\tf2('metadata');\n\tf3('people');\n\tif(o.length>2){ o[o.length] = ('</Types>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* 9.3 Relationships */\nvar RELS = ({\n\tWB: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n\tSHEET: \"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n\tHLINK: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\",\n\tVML: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing\",\n\tXPATH: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath\",\n\tXMISS: \"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing\",\n\tXLINK: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink\",\n\tCXML: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml\",\n\tCXMLP: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps\",\n\tCMNT: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments\",\n\tCORE_PROPS: \"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\",\n\tEXT_PROPS: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties',\n\tCUST_PROPS: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties',\n\tSST: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\",\n\tSTY: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\",\n\tTHEME: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\",\n\tCHART: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart\",\n\tCHARTEX: \"http://schemas.microsoft.com/office/2014/relationships/chartEx\",\n\tCS: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet\",\n\tWS: [\n\t\t\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\",\n\t\t\"http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet\"\n\t],\n\tDS: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet\",\n\tMS: \"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet\",\n\tIMG: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\",\n\tDRAW: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing\",\n\tXLMETA: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata\",\n\tTCMNT: \"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment\",\n\tPEOPLE: \"http://schemas.microsoft.com/office/2017/10/relationships/person\",\n\tVBA: \"http://schemas.microsoft.com/office/2006/relationships/vbaProject\"\n});\n\n\n/* 9.3.3 Representing Relationships */\nfunction get_rels_path(file) {\n\tvar n = file.lastIndexOf(\"/\");\n\treturn file.slice(0,n+1) + '_rels/' + file.slice(n+1) + \".rels\";\n}\n\nfunction parse_rels(data, currentFilePath) {\n\tvar rels = {\"!id\":{}};\n\tif (!data) return rels;\n\tif (currentFilePath.charAt(0) !== '/') {\n\t\tcurrentFilePath = '/'+currentFilePath;\n\t}\n\tvar hash = {};\n\n\t(data.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\t/* 9.3.2.2 OPC_Relationships */\n\t\tif (y[0] === '<Relationship') {\n\t\t\tvar rel = {}; rel.Type = y.Type; rel.Target = y.Target; rel.Id = y.Id; if(y.TargetMode) rel.TargetMode = y.TargetMode;\n\t\t\tvar canonictarget = y.TargetMode === 'External' ? y.Target : resolve_path(y.Target, currentFilePath);\n\t\t\trels[canonictarget] = rel;\n\t\t\thash[y.Id] = rel;\n\t\t}\n\t});\n\trels[\"!id\"] = hash;\n\treturn rels;\n}\n\n\n/* TODO */\nfunction write_rels(rels) {\n\tvar o = [XML_HEADER, writextag('Relationships', null, {\n\t\t//'xmlns:ns0': XMLNS.RELS,\n\t\t'xmlns': XMLNS.RELS\n\t})];\n\tkeys(rels['!id']).forEach(function(rid) {\n\t\to[o.length] = (writextag('Relationship', null, rels['!id'][rid]));\n\t});\n\tif(o.length>2){ o[o.length] = ('</Relationships>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n\nfunction add_rels(rels, rId, f, type, relobj, targetmode) {\n\tif(!relobj) relobj = {};\n\tif(!rels['!id']) rels['!id'] = {};\n\tif(!rels['!idx']) rels['!idx'] = 1;\n\tif(rId < 0) for(rId = rels['!idx']; rels['!id']['rId' + rId]; ++rId){/* empty */}\n\trels['!idx'] = rId + 1;\n\trelobj.Id = 'rId' + rId;\n\trelobj.Type = type;\n\trelobj.Target = f;\n\tif(targetmode) relobj.TargetMode = targetmode;\n\telse if([RELS.HLINK, RELS.XPATH, RELS.XMISS].indexOf(relobj.Type) > -1) relobj.TargetMode = \"External\";\n\tif(rels['!id'][relobj.Id]) throw new Error(\"Cannot rewrite rId \" + rId);\n\trels['!id'][relobj.Id] = relobj;\n\trels[('/' + relobj.Target).replace(\"//\",\"/\")] = relobj;\n\treturn rId;\n}\n/* Open Document Format for Office Applications (OpenDocument) Version 1.2 */\n/* Part 3 Section 4 Manifest File */\nvar CT_ODS = \"application/vnd.oasis.opendocument.spreadsheet\";\nfunction parse_manifest(d, opts) {\n\tvar str = xlml_normalize(d);\n\tvar Rn;\n\tvar FEtag;\n\twhile((Rn = xlmlregex.exec(str))) switch(Rn[3]) {\n\t\tcase 'manifest': break; // 4.2 <manifest:manifest>\n\t\tcase 'file-entry': // 4.3 <manifest:file-entry>\n\t\t\tFEtag = parsexmltag(Rn[0], false);\n\t\t\tif(FEtag.path == '/' && FEtag.type !== CT_ODS) throw new Error(\"This OpenDocument is not a spreadsheet\");\n\t\t\tbreak;\n\t\tcase 'encryption-data': // 4.4 <manifest:encryption-data>\n\t\tcase 'algorithm': // 4.5 <manifest:algorithm>\n\t\tcase 'start-key-generation': // 4.6 <manifest:start-key-generation>\n\t\tcase 'key-derivation': // 4.7 <manifest:key-derivation>\n\t\t\tthrow new Error(\"Unsupported ODS Encryption\");\n\t\tdefault: if(opts && opts.WTF) throw Rn;\n\t}\n}\n\nfunction write_manifest(manifest) {\n\tvar o = [XML_HEADER];\n\to.push('<manifest:manifest xmlns:manifest=\"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0\" manifest:version=\"1.2\">\\n');\n\to.push('  <manifest:file-entry manifest:full-path=\"/\" manifest:version=\"1.2\" manifest:media-type=\"application/vnd.oasis.opendocument.spreadsheet\"/>\\n');\n\tfor(var i = 0; i < manifest.length; ++i) o.push('  <manifest:file-entry manifest:full-path=\"' + manifest[i][0] + '\" manifest:media-type=\"' + manifest[i][1] + '\"/>\\n');\n\to.push('</manifest:manifest>');\n\treturn o.join(\"\");\n}\n\n/* Part 3 Section 6 Metadata Manifest File */\nfunction write_rdf_type(file, res, tag) {\n\treturn [\n\t\t'  <rdf:Description rdf:about=\"' + file + '\">\\n',\n\t\t'    <rdf:type rdf:resource=\"http://docs.oasis-open.org/ns/office/1.2/meta/' + (tag || \"odf\") + '#' + res + '\"/>\\n',\n\t\t'  </rdf:Description>\\n'\n\t].join(\"\");\n}\nfunction write_rdf_has(base, file) {\n\treturn [\n\t\t'  <rdf:Description rdf:about=\"' + base + '\">\\n',\n\t\t'    <ns0:hasPart xmlns:ns0=\"http://docs.oasis-open.org/ns/office/1.2/meta/pkg#\" rdf:resource=\"' + file + '\"/>\\n',\n\t\t'  </rdf:Description>\\n'\n\t].join(\"\");\n}\nfunction write_rdf(rdf) {\n\tvar o = [XML_HEADER];\n\to.push('<rdf:RDF xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\\n');\n\tfor(var i = 0; i != rdf.length; ++i) {\n\t\to.push(write_rdf_type(rdf[i][0], rdf[i][1]));\n\t\to.push(write_rdf_has(\"\",rdf[i][0]));\n\t}\n\to.push(write_rdf_type(\"\",\"Document\", \"pkg\"));\n\to.push('</rdf:RDF>');\n\treturn o.join(\"\");\n}\n/* TODO: pull properties */\nfunction write_meta_ods() {\n\treturn '<office:document-meta xmlns:office=\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\" xmlns:meta=\"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" office:version=\"1.2\"><office:meta><meta:generator>Sheet' + 'JS ' + XLSX.version + '</meta:generator></office:meta></office:document-meta>';\n}\n\n/* ECMA-376 Part II 11.1 Core Properties Part */\n/* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\nvar CORE_PROPS = [\n\t[\"cp:category\", \"Category\"],\n\t[\"cp:contentStatus\", \"ContentStatus\"],\n\t[\"cp:keywords\", \"Keywords\"],\n\t[\"cp:lastModifiedBy\", \"LastAuthor\"],\n\t[\"cp:lastPrinted\", \"LastPrinted\"],\n\t[\"cp:revision\", \"RevNumber\"],\n\t[\"cp:version\", \"Version\"],\n\t[\"dc:creator\", \"Author\"],\n\t[\"dc:description\", \"Comments\"],\n\t[\"dc:identifier\", \"Identifier\"],\n\t[\"dc:language\", \"Language\"],\n\t[\"dc:subject\", \"Subject\"],\n\t[\"dc:title\", \"Title\"],\n\t[\"dcterms:created\", \"CreatedDate\", 'date'],\n\t[\"dcterms:modified\", \"ModifiedDate\", 'date']\n];\n\nvar CORE_PROPS_REGEX = (function() {\n\tvar r = new Array(CORE_PROPS.length);\n\tfor(var i = 0; i < CORE_PROPS.length; ++i) {\n\t\tvar f = CORE_PROPS[i];\n\t\tvar g = \"(?:\"+ f[0].slice(0,f[0].indexOf(\":\")) +\":)\"+ f[0].slice(f[0].indexOf(\":\")+1);\n\t\tr[i] = new RegExp(\"<\" + g + \"[^>]*>([\\\\s\\\\S]*?)<\\/\" + g + \">\");\n\t}\n\treturn r;\n})();\n\nfunction parse_core_props(data) {\n\tvar p = {};\n\tdata = utf8read(data);\n\n\tfor(var i = 0; i < CORE_PROPS.length; ++i) {\n\t\tvar f = CORE_PROPS[i], cur = data.match(CORE_PROPS_REGEX[i]);\n\t\tif(cur != null && cur.length > 0) p[f[1]] = unescapexml(cur[1]);\n\t\tif(f[2] === 'date' && p[f[1]]) p[f[1]] = parseDate(p[f[1]]);\n\t}\n\n\treturn p;\n}\n\nfunction cp_doit(f, g, h, o, p) {\n\tif(p[f] != null || g == null || g === \"\") return;\n\tp[f] = g;\n\tg = escapexml(g);\n\to[o.length] = (h ? writextag(f,g,h) : writetag(f,g));\n}\n\nfunction write_core_props(cp, _opts) {\n\tvar opts = _opts || {};\n\tvar o = [XML_HEADER, writextag('cp:coreProperties', null, {\n\t\t//'xmlns': XMLNS.CORE_PROPS,\n\t\t'xmlns:cp': XMLNS.CORE_PROPS,\n\t\t'xmlns:dc': XMLNS.dc,\n\t\t'xmlns:dcterms': XMLNS.dcterms,\n\t\t'xmlns:dcmitype': XMLNS.dcmitype,\n\t\t'xmlns:xsi': XMLNS.xsi\n\t})], p = {};\n\tif(!cp && !opts.Props) return o.join(\"\");\n\n\tif(cp) {\n\t\tif(cp.CreatedDate != null) cp_doit(\"dcterms:created\", typeof cp.CreatedDate === \"string\" ? cp.CreatedDate : write_w3cdtf(cp.CreatedDate, opts.WTF), {\"xsi:type\":\"dcterms:W3CDTF\"}, o, p);\n\t\tif(cp.ModifiedDate != null) cp_doit(\"dcterms:modified\", typeof cp.ModifiedDate === \"string\" ? cp.ModifiedDate : write_w3cdtf(cp.ModifiedDate, opts.WTF), {\"xsi:type\":\"dcterms:W3CDTF\"}, o, p);\n\t}\n\n\tfor(var i = 0; i != CORE_PROPS.length; ++i) {\n\t\tvar f = CORE_PROPS[i];\n\t\tvar v = opts.Props && opts.Props[f[1]] != null ? opts.Props[f[1]] : cp ? cp[f[1]] : null;\n\t\tif(v === true) v = \"1\";\n\t\telse if(v === false) v = \"0\";\n\t\telse if(typeof v == \"number\") v = String(v);\n\t\tif(v != null) cp_doit(f[0], v, null, o, p);\n\t}\n\tif(o.length>2){ o[o.length] = ('</cp:coreProperties>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* 15.2.12.3 Extended File Properties Part */\n/* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\nvar EXT_PROPS = [\n\t[\"Application\", \"Application\", \"string\"],\n\t[\"AppVersion\", \"AppVersion\", \"string\"],\n\t[\"Company\", \"Company\", \"string\"],\n\t[\"DocSecurity\", \"DocSecurity\", \"string\"],\n\t[\"Manager\", \"Manager\", \"string\"],\n\t[\"HyperlinksChanged\", \"HyperlinksChanged\", \"bool\"],\n\t[\"SharedDoc\", \"SharedDoc\", \"bool\"],\n\t[\"LinksUpToDate\", \"LinksUpToDate\", \"bool\"],\n\t[\"ScaleCrop\", \"ScaleCrop\", \"bool\"],\n\t[\"HeadingPairs\", \"HeadingPairs\", \"raw\"],\n\t[\"TitlesOfParts\", \"TitlesOfParts\", \"raw\"]\n];\n\nvar PseudoPropsPairs = [\n\t\"Worksheets\",  \"SheetNames\",\n\t\"NamedRanges\", \"DefinedNames\",\n\t\"Chartsheets\", \"ChartNames\"\n];\nfunction load_props_pairs(HP, TOP, props, opts) {\n\tvar v = [];\n\tif(typeof HP == \"string\") v = parseVector(HP, opts);\n\telse for(var j = 0; j < HP.length; ++j) v = v.concat(HP[j].map(function(hp) { return {v:hp}; }));\n\tvar parts = (typeof TOP == \"string\") ? parseVector(TOP, opts).map(function (x) { return x.v; }) : TOP;\n\tvar idx = 0, len = 0;\n\tif(parts.length > 0) for(var i = 0; i !== v.length; i += 2) {\n\t\tlen = +(v[i+1].v);\n\t\tswitch(v[i].v) {\n\t\t\tcase \"Worksheets\":\n\t\t\tcase \"工作表\":\n\t\t\tcase \"Листы\":\n\t\t\tcase \"أوراق العمل\":\n\t\t\tcase \"ワークシート\":\n\t\t\tcase \"גליונות עבודה\":\n\t\t\tcase \"Arbeitsblätter\":\n\t\t\tcase \"Çalışma Sayfaları\":\n\t\t\tcase \"Feuilles de calcul\":\n\t\t\tcase \"Fogli di lavoro\":\n\t\t\tcase \"Folhas de cálculo\":\n\t\t\tcase \"Planilhas\":\n\t\t\tcase \"Regneark\":\n\t\t\tcase \"Hojas de cálculo\":\n\t\t\tcase \"Werkbladen\":\n\t\t\t\tprops.Worksheets = len;\n\t\t\t\tprops.SheetNames = parts.slice(idx, idx + len);\n\t\t\t\tbreak;\n\n\t\t\tcase \"Named Ranges\":\n\t\t\tcase \"Rangos con nombre\":\n\t\t\tcase \"名前付き一覧\":\n\t\t\tcase \"Benannte Bereiche\":\n\t\t\tcase \"Navngivne områder\":\n\t\t\t\tprops.NamedRanges = len;\n\t\t\t\tprops.DefinedNames = parts.slice(idx, idx + len);\n\t\t\t\tbreak;\n\n\t\t\tcase \"Charts\":\n\t\t\tcase \"Diagramme\":\n\t\t\t\tprops.Chartsheets = len;\n\t\t\t\tprops.ChartNames = parts.slice(idx, idx + len);\n\t\t\t\tbreak;\n\t\t}\n\t\tidx += len;\n\t}\n}\n\nfunction parse_ext_props(data, p, opts) {\n\tvar q = {}; if(!p) p = {};\n\tdata = utf8read(data);\n\n\tEXT_PROPS.forEach(function(f) {\n\t\tvar xml = (data.match(matchtag(f[0]))||[])[1];\n\t\tswitch(f[2]) {\n\t\t\tcase \"string\": if(xml) p[f[1]] = unescapexml(xml); break;\n\t\t\tcase \"bool\": p[f[1]] = xml === \"true\"; break;\n\t\t\tcase \"raw\":\n\t\t\t\tvar cur = data.match(new RegExp(\"<\" + f[0] + \"[^>]*>([\\\\s\\\\S]*?)<\\/\" + f[0] + \">\"));\n\t\t\t\tif(cur && cur.length > 0) q[f[1]] = cur[1];\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tif(q.HeadingPairs && q.TitlesOfParts) load_props_pairs(q.HeadingPairs, q.TitlesOfParts, p, opts);\n\n\treturn p;\n}\n\nfunction write_ext_props(cp) {\n\tvar o = [], W = writextag;\n\tif(!cp) cp = {};\n\tcp.Application = \"SheetJS\";\n\to[o.length] = (XML_HEADER);\n\to[o.length] = (writextag('Properties', null, {\n\t\t'xmlns': XMLNS.EXT_PROPS,\n\t\t'xmlns:vt': XMLNS.vt\n\t}));\n\n\tEXT_PROPS.forEach(function(f) {\n\t\tif(cp[f[1]] === undefined) return;\n\t\tvar v;\n\t\tswitch(f[2]) {\n\t\t\tcase 'string': v = escapexml(String(cp[f[1]])); break;\n\t\t\tcase 'bool': v = cp[f[1]] ? 'true' : 'false'; break;\n\t\t}\n\t\tif(v !== undefined) o[o.length] = (W(f[0], v));\n\t});\n\n\t/* TODO: HeadingPairs, TitlesOfParts */\n\to[o.length] = (W('HeadingPairs', W('vt:vector', W('vt:variant', '<vt:lpstr>Worksheets</vt:lpstr>')+W('vt:variant', W('vt:i4', String(cp.Worksheets))), {size:2, baseType:\"variant\"})));\n\to[o.length] = (W('TitlesOfParts', W('vt:vector', cp.SheetNames.map(function(s) { return \"<vt:lpstr>\" + escapexml(s) + \"</vt:lpstr>\"; }).join(\"\"), {size: cp.Worksheets, baseType:\"lpstr\"})));\n\tif(o.length>2){ o[o.length] = ('</Properties>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* 15.2.12.2 Custom File Properties Part */\nvar custregex = /<[^>]+>[^<]*/g;\nfunction parse_cust_props(data, opts) {\n\tvar p = {}, name = \"\";\n\tvar m = data.match(custregex);\n\tif(m) for(var i = 0; i != m.length; ++i) {\n\t\tvar x = m[i], y = parsexmltag(x);\n\t\tswitch(y[0]) {\n\t\t\tcase '<?xml': break;\n\t\t\tcase '<Properties': break;\n\t\t\tcase '<property': name = unescapexml(y.name); break;\n\t\t\tcase '</property>': name = null; break;\n\t\t\tdefault: if (x.indexOf('<vt:') === 0) {\n\t\t\t\tvar toks = x.split('>');\n\t\t\t\tvar type = toks[0].slice(4), text = toks[1];\n\t\t\t\t/* 22.4.2.32 (CT_Variant). Omit the binary types from 22.4 (Variant Types) */\n\t\t\t\tswitch(type) {\n\t\t\t\t\tcase 'lpstr': case 'bstr': case 'lpwstr':\n\t\t\t\t\t\tp[name] = unescapexml(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'bool':\n\t\t\t\t\t\tp[name] = parsexmlbool(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'i1': case 'i2': case 'i4': case 'i8': case 'int': case 'uint':\n\t\t\t\t\t\tp[name] = parseInt(text, 10);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'r4': case 'r8': case 'decimal':\n\t\t\t\t\t\tp[name] = parseFloat(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'filetime': case 'date':\n\t\t\t\t\t\tp[name] = parseDate(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'cy': case 'error':\n\t\t\t\t\t\tp[name] = unescapexml(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(type.slice(-1) == '/') break;\n\t\t\t\t\t\tif(opts.WTF && typeof console !== 'undefined') console.warn('Unexpected', x, type, toks);\n\t\t\t\t}\n\t\t\t} else if(x.slice(0,2) === \"</\") {/* empty */\n\t\t\t} else if(opts.WTF) throw new Error(x);\n\t\t}\n\t}\n\treturn p;\n}\n\nfunction write_cust_props(cp) {\n\tvar o = [XML_HEADER, writextag('Properties', null, {\n\t\t'xmlns': XMLNS.CUST_PROPS,\n\t\t'xmlns:vt': XMLNS.vt\n\t})];\n\tif(!cp) return o.join(\"\");\n\tvar pid = 1;\n\tkeys(cp).forEach(function custprop(k) { ++pid;\n\t\to[o.length] = (writextag('property', write_vt(cp[k], true), {\n\t\t\t'fmtid': '{D5CDD505-2E9C-101B-9397-08002B2CF9AE}',\n\t\t\t'pid': pid,\n\t\t\t'name': escapexml(k)\n\t\t}));\n\t});\n\tif(o.length>2){ o[o.length] = '</Properties>'; o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* Common Name -> XLML Name */\nvar XLMLDocPropsMap = {\n\tTitle: 'Title',\n\tSubject: 'Subject',\n\tAuthor: 'Author',\n\tKeywords: 'Keywords',\n\tComments: 'Description',\n\tLastAuthor: 'LastAuthor',\n\tRevNumber: 'Revision',\n\tApplication: 'AppName',\n\t/* TotalTime: 'TotalTime', */\n\tLastPrinted: 'LastPrinted',\n\tCreatedDate: 'Created',\n\tModifiedDate: 'LastSaved',\n\t/* Pages */\n\t/* Words */\n\t/* Characters */\n\tCategory: 'Category',\n\t/* PresentationFormat */\n\tManager: 'Manager',\n\tCompany: 'Company',\n\t/* Guid */\n\t/* HyperlinkBase */\n\t/* Bytes */\n\t/* Lines */\n\t/* Paragraphs */\n\t/* CharactersWithSpaces */\n\tAppVersion: 'Version',\n\n\tContentStatus: 'ContentStatus', /* NOTE: missing from schema */\n\tIdentifier: 'Identifier', /* NOTE: missing from schema */\n\tLanguage: 'Language' /* NOTE: missing from schema */\n};\nvar evert_XLMLDPM;\n\nfunction xlml_set_prop(Props, tag, val) {\n\tif(!evert_XLMLDPM) evert_XLMLDPM = evert(XLMLDocPropsMap);\n\ttag = evert_XLMLDPM[tag] || tag;\n\tProps[tag] = val;\n}\n\nfunction xlml_write_docprops(Props, opts) {\n\tvar o = [];\n\tkeys(XLMLDocPropsMap).map(function(m) {\n\t\tfor(var i = 0; i < CORE_PROPS.length; ++i) if(CORE_PROPS[i][1] == m) return CORE_PROPS[i];\n\t\tfor(i = 0; i < EXT_PROPS.length; ++i) if(EXT_PROPS[i][1] == m) return EXT_PROPS[i];\n\t\tthrow m;\n\t}).forEach(function(p) {\n\t\tif(Props[p[1]] == null) return;\n\t\tvar m = opts && opts.Props && opts.Props[p[1]] != null ? opts.Props[p[1]] : Props[p[1]];\n\t\tswitch(p[2]) {\n\t\t\tcase 'date': m = new Date(m).toISOString().replace(/\\.\\d*Z/,\"Z\"); break;\n\t\t}\n\t\tif(typeof m == 'number') m = String(m);\n\t\telse if(m === true || m === false) { m = m ? \"1\" : \"0\"; }\n\t\telse if(m instanceof Date) m = new Date(m).toISOString().replace(/\\.\\d*Z/,\"\");\n\t\to.push(writetag(XLMLDocPropsMap[p[1]] || p[1], m));\n\t});\n\treturn writextag('DocumentProperties', o.join(\"\"), {xmlns:XLMLNS.o });\n}\nfunction xlml_write_custprops(Props, Custprops) {\n\tvar BLACKLIST = [\"Worksheets\",\"SheetNames\"];\n\tvar T = 'CustomDocumentProperties';\n\tvar o = [];\n\tif(Props) keys(Props).forEach(function(k) {\nif(!Object.prototype.hasOwnProperty.call(Props, k)) return;\n\t\tfor(var i = 0; i < CORE_PROPS.length; ++i) if(k == CORE_PROPS[i][1]) return;\n\t\tfor(i = 0; i < EXT_PROPS.length; ++i) if(k == EXT_PROPS[i][1]) return;\n\t\tfor(i = 0; i < BLACKLIST.length; ++i) if(k == BLACKLIST[i]) return;\n\n\t\tvar m = Props[k];\n\t\tvar t = \"string\";\n\t\tif(typeof m == 'number') { t = \"float\"; m = String(m); }\n\t\telse if(m === true || m === false) { t = \"boolean\"; m = m ? \"1\" : \"0\"; }\n\t\telse m = String(m);\n\t\to.push(writextag(escapexmltag(k), m, {\"dt:dt\":t}));\n\t});\n\tif(Custprops) keys(Custprops).forEach(function(k) {\nif(!Object.prototype.hasOwnProperty.call(Custprops, k)) return;\n\t\tif(Props && Object.prototype.hasOwnProperty.call(Props, k)) return;\n\t\tvar m = Custprops[k];\n\t\tvar t = \"string\";\n\t\tif(typeof m == 'number') { t = \"float\"; m = String(m); }\n\t\telse if(m === true || m === false) { t = \"boolean\"; m = m ? \"1\" : \"0\"; }\n\t\telse if(m instanceof Date) { t = \"dateTime.tz\"; m = m.toISOString(); }\n\t\telse m = String(m);\n\t\to.push(writextag(escapexmltag(k), m, {\"dt:dt\":t}));\n\t});\n\treturn '<' + T + ' xmlns=\"' + XLMLNS.o + '\">' + o.join(\"\") + '</' + T + '>';\n}\n/* [MS-DTYP] 2.3.3 FILETIME */\n/* [MS-OLEDS] 2.1.3 FILETIME (Packet Version) */\n/* [MS-OLEPS] 2.8 FILETIME (Packet Version) */\nfunction parse_FILETIME(blob) {\n\tvar dwLowDateTime = blob.read_shift(4), dwHighDateTime = blob.read_shift(4);\n\treturn new Date(((dwHighDateTime/1e7*Math.pow(2,32) + dwLowDateTime/1e7) - 11644473600)*1000).toISOString().replace(/\\.000/,\"\");\n}\nfunction write_FILETIME(time) {\n\tvar date = (typeof time == \"string\") ? new Date(Date.parse(time)) : time;\n\tvar t = date.getTime() / 1000 + 11644473600;\n\tvar l = t % Math.pow(2,32), h = (t - l) / Math.pow(2,32);\n\tl *= 1e7; h *= 1e7;\n\tvar w = (l / Math.pow(2,32)) | 0;\n\tif(w > 0) { l = l % Math.pow(2,32); h += w; }\n\tvar o = new_buf(8); o.write_shift(4, l); o.write_shift(4, h); return o;\n}\n\n/* [MS-OSHARED] 2.3.3.1.4 Lpstr */\nfunction parse_lpstr(blob, type, pad) {\n\tvar start = blob.l;\n\tvar str = blob.read_shift(0, 'lpstr-cp');\n\tif(pad) while((blob.l - start) & 3) ++blob.l;\n\treturn str;\n}\n\n/* [MS-OSHARED] 2.3.3.1.6 Lpwstr */\nfunction parse_lpwstr(blob, type, pad) {\n\tvar str = blob.read_shift(0, 'lpwstr');\n\tif(pad) blob.l += (4 - ((str.length+1) & 3)) & 3;\n\treturn str;\n}\n\n\n/* [MS-OSHARED] 2.3.3.1.11 VtString */\n/* [MS-OSHARED] 2.3.3.1.12 VtUnalignedString */\nfunction parse_VtStringBase(blob, stringType, pad) {\n\tif(stringType === 0x1F /*VT_LPWSTR*/) return parse_lpwstr(blob);\n\treturn parse_lpstr(blob, stringType, pad);\n}\n\nfunction parse_VtString(blob, t, pad) { return parse_VtStringBase(blob, t, pad === false ? 0: 4); }\nfunction parse_VtUnalignedString(blob, t) { if(!t) throw new Error(\"VtUnalignedString must have positive length\"); return parse_VtStringBase(blob, t, 0); }\n\n/* [MS-OSHARED] 2.3.3.1.7 VtVecLpwstrValue */\nfunction parse_VtVecLpwstrValue(blob) {\n\tvar length = blob.read_shift(4);\n\tvar ret = [];\n\tfor(var i = 0; i != length; ++i) {\n\t\tvar start = blob.l;\n\t\tret[i] = blob.read_shift(0, 'lpwstr').replace(chr0,'');\n\t\tif((blob.l - start) & 0x02) blob.l += 2;\n\t}\n\treturn ret;\n}\n\n/* [MS-OSHARED] 2.3.3.1.9 VtVecUnalignedLpstrValue */\nfunction parse_VtVecUnalignedLpstrValue(blob) {\n\tvar length = blob.read_shift(4);\n\tvar ret = [];\n\tfor(var i = 0; i != length; ++i) ret[i] = blob.read_shift(0, 'lpstr-cp').replace(chr0,'');\n\treturn ret;\n}\n\n\n/* [MS-OSHARED] 2.3.3.1.13 VtHeadingPair */\nfunction parse_VtHeadingPair(blob) {\n\tvar start = blob.l;\n\tvar headingString = parse_TypedPropertyValue(blob, VT_USTR);\n\tif(blob[blob.l] == 0x00 && blob[blob.l+1] == 0x00 && ((blob.l - start) & 0x02)) blob.l += 2;\n\tvar headerParts = parse_TypedPropertyValue(blob, VT_I4);\n\treturn [headingString, headerParts];\n}\n\n/* [MS-OSHARED] 2.3.3.1.14 VtVecHeadingPairValue */\nfunction parse_VtVecHeadingPairValue(blob) {\n\tvar cElements = blob.read_shift(4);\n\tvar out = [];\n\tfor(var i = 0; i < cElements / 2; ++i) out.push(parse_VtHeadingPair(blob));\n\treturn out;\n}\n\n/* [MS-OLEPS] 2.18.1 Dictionary (uses 2.17, 2.16) */\nfunction parse_dictionary(blob,CodePage) {\n\tvar cnt = blob.read_shift(4);\n\tvar dict = ({});\n\tfor(var j = 0; j != cnt; ++j) {\n\t\tvar pid = blob.read_shift(4);\n\t\tvar len = blob.read_shift(4);\n\t\tdict[pid] = blob.read_shift(len, (CodePage === 0x4B0 ?'utf16le':'utf8')).replace(chr0,'').replace(chr1,'!');\n\t\tif(CodePage === 0x4B0 && (len % 2)) blob.l += 2;\n\t}\n\tif(blob.l & 3) blob.l = (blob.l>>2+1)<<2;\n\treturn dict;\n}\n\n/* [MS-OLEPS] 2.9 BLOB */\nfunction parse_BLOB(blob) {\n\tvar size = blob.read_shift(4);\n\tvar bytes = blob.slice(blob.l,blob.l+size);\n\tblob.l += size;\n\tif((size & 3) > 0) blob.l += (4 - (size & 3)) & 3;\n\treturn bytes;\n}\n\n/* [MS-OLEPS] 2.11 ClipboardData */\nfunction parse_ClipboardData(blob) {\n\t// TODO\n\tvar o = {};\n\to.Size = blob.read_shift(4);\n\t//o.Format = blob.read_shift(4);\n\tblob.l += o.Size + 3 - (o.Size - 1) % 4;\n\treturn o;\n}\n\n/* [MS-OLEPS] 2.15 TypedPropertyValue */\nfunction parse_TypedPropertyValue(blob, type, _opts) {\n\tvar t = blob.read_shift(2), ret, opts = _opts||{};\n\tblob.l += 2;\n\tif(type !== VT_VARIANT)\n\tif(t !== type && VT_CUSTOM.indexOf(type)===-1 && !((type & 0xFFFE) == 0x101E && (t & 0xFFFE) == 0x101E)) throw new Error('Expected type ' + type + ' saw ' + t);\n\tswitch(type === VT_VARIANT ? t : type) {\n\t\tcase 0x02 /*VT_I2*/: ret = blob.read_shift(2, 'i'); if(!opts.raw) blob.l += 2; return ret;\n\t\tcase 0x03 /*VT_I4*/: ret = blob.read_shift(4, 'i'); return ret;\n\t\tcase 0x0B /*VT_BOOL*/: return blob.read_shift(4) !== 0x0;\n\t\tcase 0x13 /*VT_UI4*/: ret = blob.read_shift(4); return ret;\n\t\tcase 0x1E /*VT_LPSTR*/: return parse_lpstr(blob, t, 4).replace(chr0,'');\n\t\tcase 0x1F /*VT_LPWSTR*/: return parse_lpwstr(blob);\n\t\tcase 0x40 /*VT_FILETIME*/: return parse_FILETIME(blob);\n\t\tcase 0x41 /*VT_BLOB*/: return parse_BLOB(blob);\n\t\tcase 0x47 /*VT_CF*/: return parse_ClipboardData(blob);\n\t\tcase 0x50 /*VT_STRING*/: return parse_VtString(blob, t, !opts.raw).replace(chr0,'');\n\t\tcase 0x51 /*VT_USTR*/: return parse_VtUnalignedString(blob, t/*, 4*/).replace(chr0,'');\n\t\tcase 0x100C /*VT_VECTOR|VT_VARIANT*/: return parse_VtVecHeadingPairValue(blob);\n\t\tcase 0x101E /*VT_VECTOR|VT_LPSTR*/:\n\t\tcase 0x101F /*VT_VECTOR|VT_LPWSTR*/:\n\t\t\treturn t == 0x101F ? parse_VtVecLpwstrValue(blob) : parse_VtVecUnalignedLpstrValue(blob);\n\t\tdefault: throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + t);\n\t}\n}\nfunction write_TypedPropertyValue(type, value) {\n\tvar o = new_buf(4), p = new_buf(4);\n\to.write_shift(4, type == 0x50 ? 0x1F : type);\n\tswitch(type) {\n\t\tcase 0x03 /*VT_I4*/: p.write_shift(-4, value); break;\n\t\tcase 0x05 /*VT_I4*/: p = new_buf(8); p.write_shift(8, value, 'f'); break;\n\t\tcase 0x0B /*VT_BOOL*/: p.write_shift(4, value ? 0x01 : 0x00); break;\n\t\tcase 0x40 /*VT_FILETIME*/:  p = write_FILETIME(value); break;\n\t\tcase 0x1F /*VT_LPWSTR*/:\n\t\tcase 0x50 /*VT_STRING*/:\np = new_buf(4 + 2 * (value.length + 1) + (value.length % 2 ? 0 : 2));\n\t\t\tp.write_shift(4, value.length + 1);\n\t\t\tp.write_shift(0, value, \"dbcs\");\n\t\t\twhile(p.l != p.length) p.write_shift(1, 0);\n\t\t\tbreak;\n\t\tdefault: throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + value);\n\t}\n\treturn bconcat([o, p]);\n}\n\n/* [MS-OLEPS] 2.20 PropertySet */\nfunction parse_PropertySet(blob, PIDSI) {\n\tvar start_addr = blob.l;\n\tvar size = blob.read_shift(4);\n\tvar NumProps = blob.read_shift(4);\n\tvar Props = [], i = 0;\n\tvar CodePage = 0;\n\tvar Dictionary = -1, DictObj = ({});\n\tfor(i = 0; i != NumProps; ++i) {\n\t\tvar PropID = blob.read_shift(4);\n\t\tvar Offset = blob.read_shift(4);\n\t\tProps[i] = [PropID, Offset + start_addr];\n\t}\n\tProps.sort(function(x,y) { return x[1] - y[1]; });\n\tvar PropH = {};\n\tfor(i = 0; i != NumProps; ++i) {\n\t\tif(blob.l !== Props[i][1]) {\n\t\t\tvar fail = true;\n\t\t\tif(i>0 && PIDSI) switch(PIDSI[Props[i-1][0]].t) {\n\t\t\t\tcase 0x02 /*VT_I2*/: if(blob.l+2 === Props[i][1]) { blob.l+=2; fail = false; } break;\n\t\t\t\tcase 0x50 /*VT_STRING*/: if(blob.l <= Props[i][1]) { blob.l=Props[i][1]; fail = false; } break;\n\t\t\t\tcase 0x100C /*VT_VECTOR|VT_VARIANT*/: if(blob.l <= Props[i][1]) { blob.l=Props[i][1]; fail = false; } break;\n\t\t\t}\n\t\t\tif((!PIDSI||i==0) && blob.l <= Props[i][1]) { fail=false; blob.l = Props[i][1]; }\n\t\t\tif(fail) throw new Error(\"Read Error: Expected address \" + Props[i][1] + ' at ' + blob.l + ' :' + i);\n\t\t}\n\t\tif(PIDSI) {\n\t\t\tvar piddsi = PIDSI[Props[i][0]];\n\t\t\tPropH[piddsi.n] = parse_TypedPropertyValue(blob, piddsi.t, {raw:true});\n\t\t\tif(piddsi.p === 'version') PropH[piddsi.n] = String(PropH[piddsi.n] >> 16) + \".\" + (\"0000\" + String(PropH[piddsi.n] & 0xFFFF)).slice(-4);\n\t\t\tif(piddsi.n == \"CodePage\") switch(PropH[piddsi.n]) {\n\t\t\t\tcase 0: PropH[piddsi.n] = 1252;\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 874:\n\t\t\t\tcase 932:\n\t\t\t\tcase 936:\n\t\t\t\tcase 949:\n\t\t\t\tcase 950:\n\t\t\t\tcase 1250:\n\t\t\t\tcase 1251:\n\t\t\t\tcase 1253:\n\t\t\t\tcase 1254:\n\t\t\t\tcase 1255:\n\t\t\t\tcase 1256:\n\t\t\t\tcase 1257:\n\t\t\t\tcase 1258:\n\t\t\t\tcase 10000:\n\t\t\t\tcase 1200:\n\t\t\t\tcase 1201:\n\t\t\t\tcase 1252:\n\t\t\t\tcase 65000: case -536:\n\t\t\t\tcase 65001: case -535:\n\t\t\t\t\tset_cp(CodePage = (PropH[piddsi.n]>>>0) & 0xFFFF); break;\n\t\t\t\tdefault: throw new Error(\"Unsupported CodePage: \" + PropH[piddsi.n]);\n\t\t\t}\n\t\t} else {\n\t\t\tif(Props[i][0] === 0x1) {\n\t\t\t\tCodePage = PropH.CodePage = (parse_TypedPropertyValue(blob, VT_I2));\n\t\t\t\tset_cp(CodePage);\n\t\t\t\tif(Dictionary !== -1) {\n\t\t\t\t\tvar oldpos = blob.l;\n\t\t\t\t\tblob.l = Props[Dictionary][1];\n\t\t\t\t\tDictObj = parse_dictionary(blob,CodePage);\n\t\t\t\t\tblob.l = oldpos;\n\t\t\t\t}\n\t\t\t} else if(Props[i][0] === 0) {\n\t\t\t\tif(CodePage === 0) { Dictionary = i; blob.l = Props[i+1][1]; continue; }\n\t\t\t\tDictObj = parse_dictionary(blob,CodePage);\n\t\t\t} else {\n\t\t\t\tvar name = DictObj[Props[i][0]];\n\t\t\t\tvar val;\n\t\t\t\t/* [MS-OSHARED] 2.3.3.2.3.1.2 + PROPVARIANT */\n\t\t\t\tswitch(blob[blob.l]) {\n\t\t\t\t\tcase 0x41 /*VT_BLOB*/: blob.l += 4; val = parse_BLOB(blob); break;\n\t\t\t\t\tcase 0x1E /*VT_LPSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]).replace(/\\u0000+$/,\"\"); break;\n\t\t\t\t\tcase 0x1F /*VT_LPWSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]).replace(/\\u0000+$/,\"\"); break;\n\t\t\t\t\tcase 0x03 /*VT_I4*/: blob.l += 4; val = blob.read_shift(4, 'i'); break;\n\t\t\t\t\tcase 0x13 /*VT_UI4*/: blob.l += 4; val = blob.read_shift(4); break;\n\t\t\t\t\tcase 0x05 /*VT_R8*/: blob.l += 4; val = blob.read_shift(8, 'f'); break;\n\t\t\t\t\tcase 0x0B /*VT_BOOL*/: blob.l += 4; val = parsebool(blob, 4); break;\n\t\t\t\t\tcase 0x40 /*VT_FILETIME*/: blob.l += 4; val = parseDate(parse_FILETIME(blob)); break;\n\t\t\t\t\tdefault: throw new Error(\"unparsed value: \" + blob[blob.l]);\n\t\t\t\t}\n\t\t\t\tPropH[name] = val;\n\t\t\t}\n\t\t}\n\t}\n\tblob.l = start_addr + size; /* step ahead to skip padding */\n\treturn PropH;\n}\nvar XLSPSSkip = [ \"CodePage\", \"Thumbnail\", \"_PID_LINKBASE\", \"_PID_HLINKS\", \"SystemIdentifier\", \"FMTID\" ]; //.concat(PseudoPropsPairs);\nfunction guess_property_type(val) {\n\tswitch(typeof val) {\n\t\tcase \"boolean\": return 0x0B;\n\t\tcase \"number\": return ((val|0)==val) ? 0x03 : 0x05;\n\t\tcase \"string\": return 0x1F;\n\t\tcase \"object\": if(val instanceof Date) return 0x40; break;\n\t}\n\treturn -1;\n}\nfunction write_PropertySet(entries, RE, PIDSI) {\n\tvar hdr = new_buf(8), piao = [], prop = [];\n\tvar sz = 8, i = 0;\n\n\tvar pr = new_buf(8), pio = new_buf(8);\n\tpr.write_shift(4, 0x0002);\n\tpr.write_shift(4, 0x04B0);\n\tpio.write_shift(4, 0x0001);\n\tprop.push(pr); piao.push(pio);\n\tsz += 8 + pr.length;\n\n\tif(!RE) {\n\t\tpio = new_buf(8);\n\t\tpio.write_shift(4, 0);\n\t\tpiao.unshift(pio);\n\n\t\tvar bufs = [new_buf(4)];\n\t\tbufs[0].write_shift(4, entries.length);\n\t\tfor(i = 0; i < entries.length; ++i) {\n\t\t\tvar value = entries[i][0];\n\t\t\tpr = new_buf(4 + 4 + 2 * (value.length + 1) + (value.length % 2 ? 0 : 2));\n\t\t\tpr.write_shift(4, i+2);\n\t\t\tpr.write_shift(4, value.length + 1);\n\t\t\tpr.write_shift(0, value, \"dbcs\");\n\t\t\twhile(pr.l != pr.length) pr.write_shift(1, 0);\n\t\t\tbufs.push(pr);\n\t\t}\n\t\tpr = bconcat(bufs);\n\t\tprop.unshift(pr);\n\t\tsz += 8 + pr.length;\n\t}\n\n\tfor(i = 0; i < entries.length; ++i) {\n\t\tif(RE && !RE[entries[i][0]]) continue;\n\t\tif(XLSPSSkip.indexOf(entries[i][0]) > -1 || PseudoPropsPairs.indexOf(entries[i][0]) > -1) continue;\n\t\tif(entries[i][1] == null) continue;\n\n\t\tvar val = entries[i][1], idx = 0;\n\t\tif(RE) {\n\t\t\tidx = +RE[entries[i][0]];\n\t\t\tvar pinfo = (PIDSI)[idx];\n\t\t\tif(pinfo.p == \"version\" && typeof val == \"string\") {\nvar arr = val.split(\".\");\n\t\t\t\tval = ((+arr[0])<<16) + ((+arr[1])||0);\n\t\t\t}\n\t\t\tpr = write_TypedPropertyValue(pinfo.t, val);\n\t\t} else {\n\t\t\tvar T = guess_property_type(val);\n\t\t\tif(T == -1) { T = 0x1F; val = String(val); }\n\t\t\tpr = write_TypedPropertyValue(T, val);\n\t\t}\n\t\tprop.push(pr);\n\n\t\tpio = new_buf(8);\n\t\tpio.write_shift(4, !RE ? 2+i : idx);\n\t\tpiao.push(pio);\n\n\t\tsz += 8 + pr.length;\n\t}\n\n\tvar w = 8 * (prop.length + 1);\n\tfor(i = 0; i < prop.length; ++i) { piao[i].write_shift(4, w); w += prop[i].length; }\n\thdr.write_shift(4, sz);\n\thdr.write_shift(4, prop.length);\n\treturn bconcat([hdr].concat(piao).concat(prop));\n}\n\n/* [MS-OLEPS] 2.21 PropertySetStream */\nfunction parse_PropertySetStream(file, PIDSI, clsid) {\n\tvar blob = file.content;\n\tif(!blob) return ({});\n\tprep_blob(blob, 0);\n\n\tvar NumSets, FMTID0, FMTID1, Offset0, Offset1 = 0;\n\tblob.chk('feff', 'Byte Order: ');\n\n\t/*var vers = */blob.read_shift(2); // TODO: check version\n\tvar SystemIdentifier = blob.read_shift(4);\n\tvar CLSID = blob.read_shift(16);\n\tif(CLSID !== CFB.utils.consts.HEADER_CLSID && CLSID !== clsid) throw new Error(\"Bad PropertySet CLSID \" + CLSID);\n\tNumSets = blob.read_shift(4);\n\tif(NumSets !== 1 && NumSets !== 2) throw new Error(\"Unrecognized #Sets: \" + NumSets);\n\tFMTID0 = blob.read_shift(16); Offset0 = blob.read_shift(4);\n\n\tif(NumSets === 1 && Offset0 !== blob.l) throw new Error(\"Length mismatch: \" + Offset0 + \" !== \" + blob.l);\n\telse if(NumSets === 2) { FMTID1 = blob.read_shift(16); Offset1 = blob.read_shift(4); }\n\tvar PSet0 = parse_PropertySet(blob, PIDSI);\n\n\tvar rval = ({ SystemIdentifier: SystemIdentifier });\n\tfor(var y in PSet0) rval[y] = PSet0[y];\n\t//rval.blob = blob;\n\trval.FMTID = FMTID0;\n\t//rval.PSet0 = PSet0;\n\tif(NumSets === 1) return rval;\n\tif(Offset1 - blob.l == 2) blob.l += 2;\n\tif(blob.l !== Offset1) throw new Error(\"Length mismatch 2: \" + blob.l + \" !== \" + Offset1);\n\tvar PSet1;\n\ttry { PSet1 = parse_PropertySet(blob, null); } catch(e) {/* empty */}\n\tfor(y in PSet1) rval[y] = PSet1[y];\n\trval.FMTID = [FMTID0, FMTID1]; // TODO: verify FMTID0/1\n\treturn rval;\n}\nfunction write_PropertySetStream(entries, clsid, RE, PIDSI, entries2, clsid2) {\n\tvar hdr = new_buf(entries2 ? 68 : 48);\n\tvar bufs = [hdr];\n\thdr.write_shift(2, 0xFFFE);\n\thdr.write_shift(2, 0x0000); /* TODO: type 1 props */\n\thdr.write_shift(4, 0x32363237);\n\thdr.write_shift(16, CFB.utils.consts.HEADER_CLSID, \"hex\");\n\thdr.write_shift(4, (entries2 ? 2 : 1));\n\thdr.write_shift(16, clsid, \"hex\");\n\thdr.write_shift(4, (entries2 ? 68 : 48));\n\tvar ps0 = write_PropertySet(entries, RE, PIDSI);\n\tbufs.push(ps0);\n\n\tif(entries2) {\n\t\tvar ps1 = write_PropertySet(entries2, null, null);\n\t\thdr.write_shift(16, clsid2, \"hex\");\n\t\thdr.write_shift(4, 68 + ps0.length);\n\t\tbufs.push(ps1);\n\t}\n\treturn bconcat(bufs);\n}\n\nfunction parsenoop2(blob, length) { blob.read_shift(length); return null; }\nfunction writezeroes(n, o) { if(!o) o=new_buf(n); for(var j=0; j<n; ++j) o.write_shift(1, 0); return o; }\n\nfunction parslurp(blob, length, cb) {\n\tvar arr = [], target = blob.l + length;\n\twhile(blob.l < target) arr.push(cb(blob, target - blob.l));\n\tif(target !== blob.l) throw new Error(\"Slurp error\");\n\treturn arr;\n}\n\nfunction parsebool(blob, length) { return blob.read_shift(length) === 0x1; }\nfunction writebool(v, o) { if(!o) o=new_buf(2); o.write_shift(2, +!!v); return o; }\n\nfunction parseuint16(blob) { return blob.read_shift(2, 'u'); }\nfunction writeuint16(v, o) { if(!o) o=new_buf(2); o.write_shift(2, v); return o; }\nfunction parseuint16a(blob, length) { return parslurp(blob,length,parseuint16);}\n\n/* --- 2.5 Structures --- */\n\n/* [MS-XLS] 2.5.10 Bes (boolean or error) */\nfunction parse_Bes(blob) {\n\tvar v = blob.read_shift(1), t = blob.read_shift(1);\n\treturn t === 0x01 ? v : v === 0x01;\n}\nfunction write_Bes(v, t, o) {\n\tif(!o) o = new_buf(2);\n\to.write_shift(1, ((t == 'e') ? +v : +!!v));\n\to.write_shift(1, ((t == 'e') ? 1 : 0));\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.240 ShortXLUnicodeString */\nfunction parse_ShortXLUnicodeString(blob, length, opts) {\n\tvar cch = blob.read_shift(opts && opts.biff >= 12 ? 2 : 1);\n\tvar encoding = 'sbcs-cont';\n\tvar cp = current_codepage;\n\tif(opts && opts.biff >= 8) current_codepage = 1200;\n\tif(!opts || opts.biff == 8 ) {\n\t\tvar fHighByte = blob.read_shift(1);\n\t\tif(fHighByte) { encoding = 'dbcs-cont'; }\n\t} else if(opts.biff == 12) {\n\t\tencoding = 'wstr';\n\t}\n\tif(opts.biff >= 2 && opts.biff <= 5) encoding = 'cpstr';\n\tvar o = cch ? blob.read_shift(cch, encoding) : \"\";\n\tcurrent_codepage = cp;\n\treturn o;\n}\n\n/* 2.5.293 XLUnicodeRichExtendedString */\nfunction parse_XLUnicodeRichExtendedString(blob) {\n\tvar cp = current_codepage;\n\tcurrent_codepage = 1200;\n\tvar cch = blob.read_shift(2), flags = blob.read_shift(1);\n\tvar /*fHighByte = flags & 0x1,*/ fExtSt = flags & 0x4, fRichSt = flags & 0x8;\n\tvar width = 1 + (flags & 0x1); // 0x0 -> utf8, 0x1 -> dbcs\n\tvar cRun = 0, cbExtRst;\n\tvar z = {};\n\tif(fRichSt) cRun = blob.read_shift(2);\n\tif(fExtSt) cbExtRst = blob.read_shift(4);\n\tvar encoding = width == 2 ? 'dbcs-cont' : 'sbcs-cont';\n\tvar msg = cch === 0 ? \"\" : blob.read_shift(cch, encoding);\n\tif(fRichSt) blob.l += 4 * cRun; //TODO: parse this\n\tif(fExtSt) blob.l += cbExtRst; //TODO: parse this\n\tz.t = msg;\n\tif(!fRichSt) { z.raw = \"<t>\" + z.t + \"</t>\"; z.r = z.t; }\n\tcurrent_codepage = cp;\n\treturn z;\n}\nfunction write_XLUnicodeRichExtendedString(xlstr) {\n\tvar str = (xlstr.t||\"\"), nfmts = 1;\n\n\tvar hdr = new_buf(3 + (nfmts > 1 ? 2 : 0));\n\thdr.write_shift(2, str.length);\n\thdr.write_shift(1, (nfmts > 1 ? 0x08 : 0x00) | 0x01);\n\tif(nfmts > 1) hdr.write_shift(2, nfmts);\n\n\tvar otext = new_buf(2 * str.length);\n\totext.write_shift(2 * str.length, str, 'utf16le');\n\n\tvar out = [hdr, otext];\n\n\treturn bconcat(out);\n}\n\n/* 2.5.296 XLUnicodeStringNoCch */\nfunction parse_XLUnicodeStringNoCch(blob, cch, opts) {\n\tvar retval;\n\tif(opts) {\n\t\tif(opts.biff >= 2 && opts.biff <= 5) return blob.read_shift(cch, 'cpstr');\n\t\tif(opts.biff >= 12) return blob.read_shift(cch, 'dbcs-cont');\n\t}\n\tvar fHighByte = blob.read_shift(1);\n\tif(fHighByte===0) { retval = blob.read_shift(cch, 'sbcs-cont'); }\n\telse { retval = blob.read_shift(cch, 'dbcs-cont'); }\n\treturn retval;\n}\n\n/* 2.5.294 XLUnicodeString */\nfunction parse_XLUnicodeString(blob, length, opts) {\n\tvar cch = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\tif(cch === 0) { blob.l++; return \"\"; }\n\treturn parse_XLUnicodeStringNoCch(blob, cch, opts);\n}\n/* BIFF5 override */\nfunction parse_XLUnicodeString2(blob, length, opts) {\n\tif(opts.biff > 5) return parse_XLUnicodeString(blob, length, opts);\n\tvar cch = blob.read_shift(1);\n\tif(cch === 0) { blob.l++; return \"\"; }\n\treturn blob.read_shift(cch, (opts.biff <= 4 || !blob.lens ) ? 'cpstr' : 'sbcs-cont');\n}\n/* TODO: BIFF5 and lower, codepage awareness */\nfunction write_XLUnicodeString(str, opts, o) {\n\tif(!o) o = new_buf(3 + 2 * str.length);\n\to.write_shift(2, str.length);\n\to.write_shift(1, 1);\n\to.write_shift(31, str, 'utf16le');\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.61 ControlInfo */\nfunction parse_ControlInfo(blob) {\n\tvar flags = blob.read_shift(1);\n\tblob.l++;\n\tvar accel = blob.read_shift(2);\n\tblob.l += 2;\n\treturn [flags, accel];\n}\n\n/* [MS-OSHARED] 2.3.7.6 URLMoniker TODO: flags */\nfunction parse_URLMoniker(blob) {\n\tvar len = blob.read_shift(4), start = blob.l;\n\tvar extra = false;\n\tif(len > 24) {\n\t\t/* look ahead */\n\t\tblob.l += len - 24;\n\t\tif(blob.read_shift(16) === \"795881f43b1d7f48af2c825dc4852763\") extra = true;\n\t\tblob.l = start;\n\t}\n\tvar url = blob.read_shift((extra?len-24:len)>>1, 'utf16le').replace(chr0,\"\");\n\tif(extra) blob.l += 24;\n\treturn url;\n}\n\n/* [MS-OSHARED] 2.3.7.8 FileMoniker TODO: all fields */\nfunction parse_FileMoniker(blob) {\n\tvar cAnti = blob.read_shift(2);\n\tvar preamble = \"\"; while(cAnti-- > 0) preamble += \"../\";\n\tvar ansiPath = blob.read_shift(0, 'lpstr-ansi');\n\tblob.l += 2; //var endServer = blob.read_shift(2);\n\tif(blob.read_shift(2) != 0xDEAD) throw new Error(\"Bad FileMoniker\");\n\tvar sz = blob.read_shift(4);\n\tif(sz === 0) return preamble + ansiPath.replace(/\\\\/g,\"/\");\n\tvar bytes = blob.read_shift(4);\n\tif(blob.read_shift(2) != 3) throw new Error(\"Bad FileMoniker\");\n\tvar unicodePath = blob.read_shift(bytes>>1, 'utf16le').replace(chr0,\"\");\n\treturn preamble + unicodePath;\n}\n\n/* [MS-OSHARED] 2.3.7.2 HyperlinkMoniker TODO: all the monikers */\nfunction parse_HyperlinkMoniker(blob, length) {\n\tvar clsid = blob.read_shift(16); length -= 16;\n\tswitch(clsid) {\n\t\tcase \"e0c9ea79f9bace118c8200aa004ba90b\": return parse_URLMoniker(blob, length);\n\t\tcase \"0303000000000000c000000000000046\": return parse_FileMoniker(blob, length);\n\t\tdefault: throw new Error(\"Unsupported Moniker \" + clsid);\n\t}\n}\n\n/* [MS-OSHARED] 2.3.7.9 HyperlinkString */\nfunction parse_HyperlinkString(blob) {\n\tvar len = blob.read_shift(4);\n\tvar o = len > 0 ? blob.read_shift(len, 'utf16le').replace(chr0, \"\") : \"\";\n\treturn o;\n}\nfunction write_HyperlinkString(str, o) {\n\tif(!o) o = new_buf(6 + str.length * 2);\n\to.write_shift(4, 1 + str.length);\n\tfor(var i = 0; i < str.length; ++i) o.write_shift(2, str.charCodeAt(i));\n\to.write_shift(2, 0);\n\treturn o;\n}\n\n/* [MS-OSHARED] 2.3.7.1 Hyperlink Object */\nfunction parse_Hyperlink(blob, length) {\n\tvar end = blob.l + length;\n\tvar sVer = blob.read_shift(4);\n\tif(sVer !== 2) throw new Error(\"Unrecognized streamVersion: \" + sVer);\n\tvar flags = blob.read_shift(2);\n\tblob.l += 2;\n\tvar displayName, targetFrameName, moniker, oleMoniker, Loc=\"\", guid, fileTime;\n\tif(flags & 0x0010) displayName = parse_HyperlinkString(blob, end - blob.l);\n\tif(flags & 0x0080) targetFrameName = parse_HyperlinkString(blob, end - blob.l);\n\tif((flags & 0x0101) === 0x0101) moniker = parse_HyperlinkString(blob, end - blob.l);\n\tif((flags & 0x0101) === 0x0001) oleMoniker = parse_HyperlinkMoniker(blob, end - blob.l);\n\tif(flags & 0x0008) Loc = parse_HyperlinkString(blob, end - blob.l);\n\tif(flags & 0x0020) guid = blob.read_shift(16);\n\tif(flags & 0x0040) fileTime = parse_FILETIME(blob/*, 8*/);\n\tblob.l = end;\n\tvar target = targetFrameName||moniker||oleMoniker||\"\";\n\tif(target && Loc) target+=\"#\"+Loc;\n\tif(!target) target = \"#\" + Loc;\n\tif((flags & 0x0002) && target.charAt(0) == \"/\" && target.charAt(1) != \"/\") target = \"file://\" + target;\n\tvar out = ({Target:target});\n\tif(guid) out.guid = guid;\n\tif(fileTime) out.time = fileTime;\n\tif(displayName) out.Tooltip = displayName;\n\treturn out;\n}\nfunction write_Hyperlink(hl) {\n\tvar out = new_buf(512), i = 0;\n\tvar Target = hl.Target;\n\tif(Target.slice(0,7) == \"file://\") Target = Target.slice(7);\n\tvar hashidx = Target.indexOf(\"#\");\n\tvar F = hashidx > -1 ? 0x1f : 0x17;\n\tswitch(Target.charAt(0)) { case \"#\": F=0x1c; break; case \".\": F&=~2; break; }\n\tout.write_shift(4,2); out.write_shift(4, F);\n\tvar data = [8,6815827,6619237,4849780,83]; for(i = 0; i < data.length; ++i) out.write_shift(4, data[i]);\n\tif(F == 0x1C) {\n\t\tTarget = Target.slice(1);\n\t\twrite_HyperlinkString(Target, out);\n\t} else if(F & 0x02) {\n\t\tdata = \"e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b\".split(\" \");\n\t\tfor(i = 0; i < data.length; ++i) out.write_shift(1, parseInt(data[i], 16));\n\t\tvar Pretarget = hashidx > -1 ? Target.slice(0, hashidx) : Target;\n\t\tout.write_shift(4, 2*(Pretarget.length + 1));\n\t\tfor(i = 0; i < Pretarget.length; ++i) out.write_shift(2, Pretarget.charCodeAt(i));\n\t\tout.write_shift(2, 0);\n\t\tif(F & 0x08) write_HyperlinkString(hashidx > -1 ? Target.slice(hashidx+1): \"\", out);\n\t} else {\n\t\tdata = \"03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46\".split(\" \");\n\t\tfor(i = 0; i < data.length; ++i) out.write_shift(1, parseInt(data[i], 16));\n\t\tvar P = 0;\n\t\twhile(Target.slice(P*3,P*3+3)==\"../\"||Target.slice(P*3,P*3+3)==\"..\\\\\") ++P;\n\t\tout.write_shift(2, P);\n\t\tout.write_shift(4, Target.length - 3 * P + 1);\n\t\tfor(i = 0; i < Target.length - 3 * P; ++i) out.write_shift(1, Target.charCodeAt(i + 3 * P) & 0xFF);\n\t\tout.write_shift(1, 0);\n\t\tout.write_shift(2, 0xFFFF);\n\t\tout.write_shift(2, 0xDEAD);\n\t\tfor(i = 0; i < 6; ++i) out.write_shift(4, 0);\n\t}\n\treturn out.slice(0, out.l);\n}\n\n/* 2.5.178 LongRGBA */\nfunction parse_LongRGBA(blob) { var r = blob.read_shift(1), g = blob.read_shift(1), b = blob.read_shift(1), a = blob.read_shift(1); return [r,g,b,a]; }\n\n/* 2.5.177 LongRGB */\nfunction parse_LongRGB(blob, length) { var x = parse_LongRGBA(blob, length); x[3] = 0; return x; }\n\n\n/* [MS-XLS] 2.5.19 */\nfunction parse_XLSCell(blob) {\n\tvar rw = blob.read_shift(2); // 0-indexed\n\tvar col = blob.read_shift(2);\n\tvar ixfe = blob.read_shift(2);\n\treturn ({r:rw, c:col, ixfe:ixfe});\n}\nfunction write_XLSCell(R, C, ixfe, o) {\n\tif(!o) o = new_buf(6);\n\to.write_shift(2, R);\n\to.write_shift(2, C);\n\to.write_shift(2, ixfe||0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.134 */\nfunction parse_frtHeader(blob) {\n\tvar rt = blob.read_shift(2);\n\tvar flags = blob.read_shift(2); // TODO: parse these flags\n\tblob.l += 8;\n\treturn {type: rt, flags: flags};\n}\n\n\n\nfunction parse_OptXLUnicodeString(blob, length, opts) { return length === 0 ? \"\" : parse_XLUnicodeString2(blob, length, opts); }\n\n/* [MS-XLS] 2.5.344 */\nfunction parse_XTI(blob, length, opts) {\n\tvar w = opts.biff > 8 ? 4 : 2;\n\tvar iSupBook = blob.read_shift(w), itabFirst = blob.read_shift(w,'i'), itabLast = blob.read_shift(w,'i');\n\treturn [iSupBook, itabFirst, itabLast];\n}\n\n/* [MS-XLS] 2.5.218 */\nfunction parse_RkRec(blob) {\n\tvar ixfe = blob.read_shift(2);\n\tvar RK = parse_RkNumber(blob);\n\treturn [ixfe, RK];\n}\n\n/* [MS-XLS] 2.5.1 */\nfunction parse_AddinUdf(blob, length, opts) {\n\tblob.l += 4; length -= 4;\n\tvar l = blob.l + length;\n\tvar udfName = parse_ShortXLUnicodeString(blob, length, opts);\n\tvar cb = blob.read_shift(2);\n\tl -= blob.l;\n\tif(cb !== l) throw new Error(\"Malformed AddinUdf: padding = \" + l + \" != \" + cb);\n\tblob.l += cb;\n\treturn udfName;\n}\n\n/* [MS-XLS] 2.5.209 TODO: Check sizes */\nfunction parse_Ref8U(blob) {\n\tvar rwFirst = blob.read_shift(2);\n\tvar rwLast = blob.read_shift(2);\n\tvar colFirst = blob.read_shift(2);\n\tvar colLast = blob.read_shift(2);\n\treturn {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};\n}\nfunction write_Ref8U(r, o) {\n\tif(!o) o = new_buf(8);\n\to.write_shift(2, r.s.r);\n\to.write_shift(2, r.e.r);\n\to.write_shift(2, r.s.c);\n\to.write_shift(2, r.e.c);\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.211 */\nfunction parse_RefU(blob) {\n\tvar rwFirst = blob.read_shift(2);\n\tvar rwLast = blob.read_shift(2);\n\tvar colFirst = blob.read_shift(1);\n\tvar colLast = blob.read_shift(1);\n\treturn {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};\n}\n\n/* [MS-XLS] 2.5.207 */\nvar parse_Ref = parse_RefU;\n\n/* [MS-XLS] 2.5.143 */\nfunction parse_FtCmo(blob) {\n\tblob.l += 4;\n\tvar ot = blob.read_shift(2);\n\tvar id = blob.read_shift(2);\n\tvar flags = blob.read_shift(2);\n\tblob.l+=12;\n\treturn [id, ot, flags];\n}\n\n/* [MS-XLS] 2.5.149 */\nfunction parse_FtNts(blob) {\n\tvar out = {};\n\tblob.l += 4;\n\tblob.l += 16; // GUID TODO\n\tout.fSharedNote = blob.read_shift(2);\n\tblob.l += 4;\n\treturn out;\n}\n\n/* [MS-XLS] 2.5.142 */\nfunction parse_FtCf(blob) {\n\tvar out = {};\n\tblob.l += 4;\n\tblob.cf = blob.read_shift(2);\n\treturn out;\n}\n\n/* [MS-XLS] 2.5.140 - 2.5.154 and friends */\nfunction parse_FtSkip(blob) { blob.l += 2; blob.l += blob.read_shift(2); }\nvar FtTab = {\n0x00: parse_FtSkip,      /* FtEnd */\n0x04: parse_FtSkip,      /* FtMacro */\n0x05: parse_FtSkip,      /* FtButton */\n0x06: parse_FtSkip,      /* FtGmo */\n0x07: parse_FtCf,        /* FtCf */\n0x08: parse_FtSkip,      /* FtPioGrbit */\n0x09: parse_FtSkip,      /* FtPictFmla */\n0x0A: parse_FtSkip,      /* FtCbls */\n0x0B: parse_FtSkip,      /* FtRbo */\n0x0C: parse_FtSkip,      /* FtSbs */\n0x0D: parse_FtNts,       /* FtNts */\n0x0E: parse_FtSkip,      /* FtSbsFmla */\n0x0F: parse_FtSkip,      /* FtGboData */\n0x10: parse_FtSkip,      /* FtEdoData */\n0x11: parse_FtSkip,      /* FtRboData */\n0x12: parse_FtSkip,      /* FtCblsData */\n0x13: parse_FtSkip,      /* FtLbsData */\n0x14: parse_FtSkip,      /* FtCblsFmla */\n0x15: parse_FtCmo\n};\nfunction parse_FtArray(blob, length) {\n\tvar tgt = blob.l + length;\n\tvar fts = [];\n\twhile(blob.l < tgt) {\n\t\tvar ft = blob.read_shift(2);\n\t\tblob.l-=2;\n\t\ttry {\n\t\t\tfts.push(FtTab[ft](blob, tgt - blob.l));\n\t\t} catch(e) { blob.l = tgt; return fts; }\n\t}\n\tif(blob.l != tgt) blob.l = tgt; //throw new Error(\"bad Object Ft-sequence\");\n\treturn fts;\n}\n\n/* --- 2.4 Records --- */\n\n/* [MS-XLS] 2.4.21 */\nfunction parse_BOF(blob, length) {\n\tvar o = {BIFFVer:0, dt:0};\n\to.BIFFVer = blob.read_shift(2); length -= 2;\n\tif(length >= 2) { o.dt = blob.read_shift(2); blob.l -= 2; }\n\tswitch(o.BIFFVer) {\n\t\tcase 0x0600: /* BIFF8 */\n\t\tcase 0x0500: /* BIFF5 */\n\t\tcase 0x0400: /* BIFF4 */\n\t\tcase 0x0300: /* BIFF3 */\n\t\tcase 0x0200: /* BIFF2 */\n\t\tcase 0x0002: case 0x0007: /* BIFF2 */\n\t\t\tbreak;\n\t\tdefault: if(length > 6) throw new Error(\"Unexpected BIFF Ver \" + o.BIFFVer);\n\t}\n\n\tblob.read_shift(length);\n\treturn o;\n}\nfunction write_BOF(wb, t, o) {\n\tvar h = 0x0600, w = 16;\n\tswitch(o.bookType) {\n\t\tcase 'biff8': break;\n\t\tcase 'biff5': h = 0x0500; w = 8; break;\n\t\tcase 'biff4': h = 0x0004; w = 6; break;\n\t\tcase 'biff3': h = 0x0003; w = 6; break;\n\t\tcase 'biff2': h = 0x0002; w = 4; break;\n\t\tcase 'xla': break;\n\t\tdefault: throw new Error(\"unsupported BIFF version\");\n\t}\n\tvar out = new_buf(w);\n\tout.write_shift(2, h);\n\tout.write_shift(2, t);\n\tif(w > 4) out.write_shift(2, 0x7262);\n\tif(w > 6) out.write_shift(2, 0x07CD);\n\tif(w > 8) {\n\t\tout.write_shift(2, 0xC009);\n\t\tout.write_shift(2, 0x0001);\n\t\tout.write_shift(2, 0x0706);\n\t\tout.write_shift(2, 0x0000);\n\t}\n\treturn out;\n}\n\n\n/* [MS-XLS] 2.4.146 */\nfunction parse_InterfaceHdr(blob, length) {\n\tif(length === 0) return 0x04b0;\n\tif((blob.read_shift(2))!==0x04b0){/* empty */}\n\treturn 0x04b0;\n}\n\n\n/* [MS-XLS] 2.4.349 */\nfunction parse_WriteAccess(blob, length, opts) {\n\tif(opts.enc) { blob.l += length; return \"\"; }\n\tvar l = blob.l;\n\t// TODO: make sure XLUnicodeString doesnt overrun\n\tvar UserName = parse_XLUnicodeString2(blob, 0, opts);\n\tblob.read_shift(length + l - blob.l);\n\treturn UserName;\n}\nfunction write_WriteAccess(s, opts) {\n\tvar b8 = !opts || opts.biff == 8;\n\tvar o = new_buf(b8 ? 112 : 54);\n\to.write_shift(opts.biff == 8 ? 2 : 1, 7);\n\tif(b8) o.write_shift(1, 0);\n\to.write_shift(4, 0x33336853);\n\to.write_shift(4, (0x00534A74 | (b8 ? 0 : 0x20000000)));\n\twhile(o.l < o.length) o.write_shift(1, (b8 ? 0 : 32));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.351 */\nfunction parse_WsBool(blob, length, opts) {\n\tvar flags = opts && opts.biff == 8 || length == 2 ? blob.read_shift(2) : (blob.l += length, 0);\n\treturn { fDialog: flags & 0x10, fBelow: flags & 0x40, fRight: flags & 0x80 };\n}\n\n/* [MS-XLS] 2.4.28 */\nfunction parse_BoundSheet8(blob, length, opts) {\n\tvar pos = blob.read_shift(4);\n\tvar hidden = blob.read_shift(1) & 0x03;\n\tvar dt = blob.read_shift(1);\n\tswitch(dt) {\n\t\tcase 0: dt = 'Worksheet'; break;\n\t\tcase 1: dt = 'Macrosheet'; break;\n\t\tcase 2: dt = 'Chartsheet'; break;\n\t\tcase 6: dt = 'VBAModule'; break;\n\t}\n\tvar name = parse_ShortXLUnicodeString(blob, 0, opts);\n\tif(name.length === 0) name = \"Sheet1\";\n\treturn { pos:pos, hs:hidden, dt:dt, name:name };\n}\nfunction write_BoundSheet8(data, opts) {\n\tvar w = (!opts || opts.biff >= 8 ? 2 : 1);\n\tvar o = new_buf(8 + w * data.name.length);\n\to.write_shift(4, data.pos);\n\to.write_shift(1, data.hs || 0);\n\to.write_shift(1, data.dt);\n\to.write_shift(1, data.name.length);\n\tif(opts.biff >= 8) o.write_shift(1, 1);\n\to.write_shift(w * data.name.length, data.name, opts.biff < 8 ? 'sbcs' : 'utf16le');\n\tvar out = o.slice(0, o.l);\n\tout.l = o.l; return out;\n}\n\n/* [MS-XLS] 2.4.265 TODO */\nfunction parse_SST(blob, length) {\n\tvar end = blob.l + length;\n\tvar cnt = blob.read_shift(4);\n\tvar ucnt = blob.read_shift(4);\n\tvar strs = ([]);\n\tfor(var i = 0; i != ucnt && blob.l < end; ++i) {\n\t\tstrs.push(parse_XLUnicodeRichExtendedString(blob));\n\t}\n\tstrs.Count = cnt; strs.Unique = ucnt;\n\treturn strs;\n}\nfunction write_SST(sst, opts) {\n\tvar header = new_buf(8);\n\theader.write_shift(4, sst.Count);\n\theader.write_shift(4, sst.Unique);\n\tvar strs = [];\n\tfor(var j = 0; j < sst.length; ++j) strs[j] = write_XLUnicodeRichExtendedString(sst[j], opts);\n\tvar o = bconcat([header].concat(strs));\no.parts = [header.length].concat(strs.map(function(str) { return str.length; }));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.107 */\nfunction parse_ExtSST(blob, length) {\n\tvar extsst = {};\n\textsst.dsst = blob.read_shift(2);\n\tblob.l += length-2;\n\treturn extsst;\n}\n\n\n/* [MS-XLS] 2.4.221 TODO: check BIFF2-4 */\nfunction parse_Row(blob) {\n\tvar z = ({});\n\tz.r = blob.read_shift(2);\n\tz.c = blob.read_shift(2);\n\tz.cnt = blob.read_shift(2) - z.c;\n\tvar miyRw = blob.read_shift(2);\n\tblob.l += 4; // reserved(2), unused(2)\n\tvar flags = blob.read_shift(1); // various flags\n\tblob.l += 3; // reserved(8), ixfe(12), flags(4)\n\tif(flags & 0x07) z.level = flags & 0x07;\n\t// collapsed: flags & 0x10\n\tif(flags & 0x20) z.hidden = true;\n\tif(flags & 0x40) z.hpt = miyRw / 20;\n\treturn z;\n}\n\n\n/* [MS-XLS] 2.4.125 */\nfunction parse_ForceFullCalculation(blob) {\n\tvar header = parse_frtHeader(blob);\n\tif(header.type != 0x08A3) throw new Error(\"Invalid Future Record \" + header.type);\n\tvar fullcalc = blob.read_shift(4);\n\treturn fullcalc !== 0x0;\n}\n\n\n\n\n\n/* [MS-XLS] 2.4.215 rt */\nfunction parse_RecalcId(blob) {\n\tblob.read_shift(2);\n\treturn blob.read_shift(4);\n}\n\n/* [MS-XLS] 2.4.87 */\nfunction parse_DefaultRowHeight(blob, length, opts) {\n\tvar f = 0;\n\tif(!(opts && opts.biff == 2)) {\n\t\tf = blob.read_shift(2);\n\t}\n\tvar miyRw = blob.read_shift(2);\n\tif((opts && opts.biff == 2)) {\n\t\tf = 1 - (miyRw >> 15); miyRw &= 0x7fff;\n\t}\n\tvar fl = {Unsynced:f&1,DyZero:(f&2)>>1,ExAsc:(f&4)>>2,ExDsc:(f&8)>>3};\n\treturn [fl, miyRw];\n}\n\n/* [MS-XLS] 2.4.345 TODO */\nfunction parse_Window1(blob) {\n\tvar xWn = blob.read_shift(2), yWn = blob.read_shift(2), dxWn = blob.read_shift(2), dyWn = blob.read_shift(2);\n\tvar flags = blob.read_shift(2), iTabCur = blob.read_shift(2), iTabFirst = blob.read_shift(2);\n\tvar ctabSel = blob.read_shift(2), wTabRatio = blob.read_shift(2);\n\treturn { Pos: [xWn, yWn], Dim: [dxWn, dyWn], Flags: flags, CurTab: iTabCur,\n\t\tFirstTab: iTabFirst, Selected: ctabSel, TabRatio: wTabRatio };\n}\nfunction write_Window1() {\n\tvar o = new_buf(18);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0x7260);\n\to.write_shift(2, 0x44c0);\n\to.write_shift(2, 0x38);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, 1);\n\to.write_shift(2, 0x01f4);\n\treturn o;\n}\n/* [MS-XLS] 2.4.346 TODO */\nfunction parse_Window2(blob, length, opts) {\n\tif(opts && opts.biff >= 2 && opts.biff < 5) return {};\n\tvar f = blob.read_shift(2);\n\treturn { RTL: f & 0x40 };\n}\nfunction write_Window2(view) {\n\tvar o = new_buf(18), f = 0x6b6;\n\tif(view && view.RTL) f |= 0x40;\n\to.write_shift(2, f);\n\to.write_shift(4, 0);\n\to.write_shift(4, 64);\n\to.write_shift(4, 0);\n\to.write_shift(4, 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.189 TODO */\nfunction parse_Pane(/*blob, length, opts*/) {\n}\n\n/* [MS-XLS] 2.4.122 TODO */\nfunction parse_Font(blob, length, opts) {\n\tvar o = {\n\t\tdyHeight: blob.read_shift(2),\n\t\tfl: blob.read_shift(2)\n\t};\n\tswitch((opts && opts.biff) || 8) {\n\t\tcase 2: break;\n\t\tcase 3: case 4: blob.l += 2; break;\n\t\tdefault: blob.l += 10; break;\n\t}\n\to.name = parse_ShortXLUnicodeString(blob, 0, opts);\n\treturn o;\n}\nfunction write_Font(data, opts) {\n\tvar name = data.name || \"Arial\";\n\tvar b5 = (opts && (opts.biff == 5)), w = (b5 ? (15 + name.length) : (16 + 2 * name.length));\n\tvar o = new_buf(w);\n\to.write_shift(2, (data.sz || 12) * 20);\n\to.write_shift(4, 0);\n\to.write_shift(2, 400);\n\to.write_shift(4, 0);\n\to.write_shift(2, 0);\n\to.write_shift(1, name.length);\n\tif(!b5) o.write_shift(1, 1);\n\to.write_shift((b5 ? 1 : 2) * name.length, name, (b5 ? \"sbcs\" : \"utf16le\"));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.149 */\nfunction parse_LabelSst(blob) {\n\tvar cell = parse_XLSCell(blob);\n\tcell.isst = blob.read_shift(4);\n\treturn cell;\n}\nfunction write_LabelSst(R, C, v, os ) {\n\tvar o = new_buf(10);\n\twrite_XLSCell(R, C, os, o);\n\to.write_shift(4, v);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.148 */\nfunction parse_Label(blob, length, opts) {\n\tif(opts.biffguess && opts.biff == 2) opts.biff = 5;\n\tvar target = blob.l + length;\n\tvar cell = parse_XLSCell(blob, 6);\n\tif(opts.biff == 2) blob.l++;\n\tvar str = parse_XLUnicodeString(blob, target - blob.l, opts);\n\tcell.val = str;\n\treturn cell;\n}\nfunction write_Label(R, C, v, os, opts) {\n\tvar b8 = !opts || opts.biff == 8;\n\tvar o = new_buf(6 + 2 + (+b8) + (1 + b8) * v.length);\n\twrite_XLSCell(R, C, os, o);\n\to.write_shift(2, v.length);\n\tif(b8) o.write_shift(1, 1);\n\to.write_shift((1 + b8) * v.length, v, b8 ? 'utf16le' : 'sbcs');\n\treturn o;\n}\n\n\n/* [MS-XLS] 2.4.126 Number Formats */\nfunction parse_Format(blob, length, opts) {\n\tvar numFmtId = blob.read_shift(2);\n\tvar fmtstr = parse_XLUnicodeString2(blob, 0, opts);\n\treturn [numFmtId, fmtstr];\n}\nfunction write_Format(i, f, opts, o) {\n\tvar b5 = (opts && (opts.biff == 5));\n\tif(!o) o = new_buf(b5 ? (3 + f.length) : (5 + 2 * f.length));\n\to.write_shift(2, i);\n\to.write_shift((b5 ? 1 : 2), f.length);\n\tif(!b5) o.write_shift(1, 1);\n\to.write_shift((b5 ? 1 : 2) * f.length, f, (b5 ? 'sbcs' : 'utf16le'));\n\tvar out = (o.length > o.l) ? o.slice(0, o.l) : o;\n\tif(out.l == null) out.l = out.length;\n\treturn out;\n}\nvar parse_BIFF2Format = parse_XLUnicodeString2;\n\n/* [MS-XLS] 2.4.90 */\nfunction parse_Dimensions(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar w = opts.biff == 8 || !opts.biff ? 4 : 2;\n\tvar r = blob.read_shift(w), R = blob.read_shift(w);\n\tvar c = blob.read_shift(2), C = blob.read_shift(2);\n\tblob.l = end;\n\treturn {s: {r:r, c:c}, e: {r:R, c:C}};\n}\nfunction write_Dimensions(range, opts) {\n\tvar w = opts.biff == 8 || !opts.biff ? 4 : 2;\n\tvar o = new_buf(2*w + 6);\n\to.write_shift(w, range.s.r);\n\to.write_shift(w, range.e.r + 1);\n\to.write_shift(2, range.s.c);\n\to.write_shift(2, range.e.c + 1);\n\to.write_shift(2, 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.220 */\nfunction parse_RK(blob) {\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\n\tvar rkrec = parse_RkRec(blob);\n\treturn {r:rw, c:col, ixfe:rkrec[0], rknum:rkrec[1]};\n}\n\n/* [MS-XLS] 2.4.175 */\nfunction parse_MulRk(blob, length) {\n\tvar target = blob.l + length - 2;\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\n\tvar rkrecs = [];\n\twhile(blob.l < target) rkrecs.push(parse_RkRec(blob));\n\tif(blob.l !== target) throw new Error(\"MulRK read error\");\n\tvar lastcol = blob.read_shift(2);\n\tif(rkrecs.length != lastcol - col + 1) throw new Error(\"MulRK length mismatch\");\n\treturn {r:rw, c:col, C:lastcol, rkrec:rkrecs};\n}\n/* [MS-XLS] 2.4.174 */\nfunction parse_MulBlank(blob, length) {\n\tvar target = blob.l + length - 2;\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\n\tvar ixfes = [];\n\twhile(blob.l < target) ixfes.push(blob.read_shift(2));\n\tif(blob.l !== target) throw new Error(\"MulBlank read error\");\n\tvar lastcol = blob.read_shift(2);\n\tif(ixfes.length != lastcol - col + 1) throw new Error(\"MulBlank length mismatch\");\n\treturn {r:rw, c:col, C:lastcol, ixfe:ixfes};\n}\n\n/* [MS-XLS] 2.5.20 2.5.249 TODO: interpret values here */\nfunction parse_CellStyleXF(blob, length, style, opts) {\n\tvar o = {};\n\tvar a = blob.read_shift(4), b = blob.read_shift(4);\n\tvar c = blob.read_shift(4), d = blob.read_shift(2);\n\to.patternType = XLSFillPattern[c >> 26];\n\n\tif(!opts.cellStyles) return o;\n\to.alc = a & 0x07;\n\to.fWrap = (a >> 3) & 0x01;\n\to.alcV = (a >> 4) & 0x07;\n\to.fJustLast = (a >> 7) & 0x01;\n\to.trot = (a >> 8) & 0xFF;\n\to.cIndent = (a >> 16) & 0x0F;\n\to.fShrinkToFit = (a >> 20) & 0x01;\n\to.iReadOrder = (a >> 22) & 0x02;\n\to.fAtrNum = (a >> 26) & 0x01;\n\to.fAtrFnt = (a >> 27) & 0x01;\n\to.fAtrAlc = (a >> 28) & 0x01;\n\to.fAtrBdr = (a >> 29) & 0x01;\n\to.fAtrPat = (a >> 30) & 0x01;\n\to.fAtrProt = (a >> 31) & 0x01;\n\n\to.dgLeft = b & 0x0F;\n\to.dgRight = (b >> 4) & 0x0F;\n\to.dgTop = (b >> 8) & 0x0F;\n\to.dgBottom = (b >> 12) & 0x0F;\n\to.icvLeft = (b >> 16) & 0x7F;\n\to.icvRight = (b >> 23) & 0x7F;\n\to.grbitDiag = (b >> 30) & 0x03;\n\n\to.icvTop = c & 0x7F;\n\to.icvBottom = (c >> 7) & 0x7F;\n\to.icvDiag = (c >> 14) & 0x7F;\n\to.dgDiag = (c >> 21) & 0x0F;\n\n\to.icvFore = d & 0x7F;\n\to.icvBack = (d >> 7) & 0x7F;\n\to.fsxButton = (d >> 14) & 0x01;\n\treturn o;\n}\n//function parse_CellXF(blob, length, opts) {return parse_CellStyleXF(blob,length,0, opts);}\n//function parse_StyleXF(blob, length, opts) {return parse_CellStyleXF(blob,length,1, opts);}\n\n/* [MS-XLS] 2.4.353 TODO: actually do this right */\nfunction parse_XF(blob, length, opts) {\n\tvar o = {};\n\to.ifnt = blob.read_shift(2); o.numFmtId = blob.read_shift(2); o.flags = blob.read_shift(2);\n\to.fStyle = (o.flags >> 2) & 0x01;\n\tlength -= 6;\n\to.data = parse_CellStyleXF(blob, length, o.fStyle, opts);\n\treturn o;\n}\nfunction write_XF(data, ixfeP, opts, o) {\n\tvar b5 = (opts && (opts.biff == 5));\n\tif(!o) o = new_buf(b5 ? 16 : 20);\n\to.write_shift(2, 0);\n\tif(data.style) {\n\t\to.write_shift(2, (data.numFmtId||0));\n\t\to.write_shift(2, 0xFFF4);\n\t} else {\n\t\to.write_shift(2, (data.numFmtId||0));\n\t\to.write_shift(2, (ixfeP<<4));\n\t}\n\tvar f = 0;\n\tif(data.numFmtId > 0 && b5) f |= 0x0400;\n\to.write_shift(4, f);\n\to.write_shift(4, 0);\n\tif(!b5) o.write_shift(4, 0);\n\to.write_shift(2, 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.134 */\nfunction parse_Guts(blob) {\n\tblob.l += 4;\n\tvar out = [blob.read_shift(2), blob.read_shift(2)];\n\tif(out[0] !== 0) out[0]--;\n\tif(out[1] !== 0) out[1]--;\n\tif(out[0] > 7 || out[1] > 7) throw new Error(\"Bad Gutters: \" + out.join(\"|\"));\n\treturn out;\n}\nfunction write_Guts(guts) {\n\tvar o = new_buf(8);\n\to.write_shift(4, 0);\n\to.write_shift(2, guts[0] ? guts[0] + 1 : 0);\n\to.write_shift(2, guts[1] ? guts[1] + 1 : 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.24 */\nfunction parse_BoolErr(blob, length, opts) {\n\tvar cell = parse_XLSCell(blob, 6);\n\tif(opts.biff == 2 || length == 9) ++blob.l;\n\tvar val = parse_Bes(blob, 2);\n\tcell.val = val;\n\tcell.t = (val === true || val === false) ? 'b' : 'e';\n\treturn cell;\n}\nfunction write_BoolErr(R, C, v, os, opts, t) {\n\tvar o = new_buf(8);\n\twrite_XLSCell(R, C, os, o);\n\twrite_Bes(v, t, o);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.180 Number */\nfunction parse_Number(blob, length, opts) {\n\tif(opts.biffguess && opts.biff == 2) opts.biff = 5;\n\tvar cell = parse_XLSCell(blob, 6);\n\tvar xnum = parse_Xnum(blob, 8);\n\tcell.val = xnum;\n\treturn cell;\n}\nfunction write_Number(R, C, v, os) {\n\tvar o = new_buf(14);\n\twrite_XLSCell(R, C, os, o);\n\twrite_Xnum(v, o);\n\treturn o;\n}\n\nvar parse_XLHeaderFooter = parse_OptXLUnicodeString; // TODO: parse 2.4.136\n\n/* [MS-XLS] 2.4.271 */\nfunction parse_SupBook(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar ctab = blob.read_shift(2);\n\tvar cch = blob.read_shift(2);\n\topts.sbcch = cch;\n\tif(cch == 0x0401 || cch == 0x3A01) return [cch, ctab];\n\tif(cch < 0x01 || cch >0xff) throw new Error(\"Unexpected SupBook type: \"+cch);\n\tvar virtPath = parse_XLUnicodeStringNoCch(blob, cch);\n\t/* TODO: 2.5.277 Virtual Path */\n\tvar rgst = [];\n\twhile(end > blob.l) rgst.push(parse_XLUnicodeString(blob));\n\treturn [cch, ctab, virtPath, rgst];\n}\n\n/* [MS-XLS] 2.4.105 TODO */\nfunction parse_ExternName(blob, length, opts) {\n\tvar flags = blob.read_shift(2);\n\tvar body;\n\tvar o = ({\n\t\tfBuiltIn: flags & 0x01,\n\t\tfWantAdvise: (flags >>> 1) & 0x01,\n\t\tfWantPict: (flags >>> 2) & 0x01,\n\t\tfOle: (flags >>> 3) & 0x01,\n\t\tfOleLink: (flags >>> 4) & 0x01,\n\t\tcf: (flags >>> 5) & 0x3FF,\n\t\tfIcon: flags >>> 15 & 0x01\n\t});\n\tif(opts.sbcch === 0x3A01) body = parse_AddinUdf(blob, length-2, opts);\n\t//else throw new Error(\"unsupported SupBook cch: \" + opts.sbcch);\n\to.body = body || blob.read_shift(length-2);\n\tif(typeof body === \"string\") o.Name = body;\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.150 TODO */\nvar XLSLblBuiltIn = [\n\t\"_xlnm.Consolidate_Area\",\n\t\"_xlnm.Auto_Open\",\n\t\"_xlnm.Auto_Close\",\n\t\"_xlnm.Extract\",\n\t\"_xlnm.Database\",\n\t\"_xlnm.Criteria\",\n\t\"_xlnm.Print_Area\",\n\t\"_xlnm.Print_Titles\",\n\t\"_xlnm.Recorder\",\n\t\"_xlnm.Data_Form\",\n\t\"_xlnm.Auto_Activate\",\n\t\"_xlnm.Auto_Deactivate\",\n\t\"_xlnm.Sheet_Title\",\n\t\"_xlnm._FilterDatabase\"\n];\nfunction parse_Lbl(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar flags = blob.read_shift(2);\n\tvar chKey = blob.read_shift(1);\n\tvar cch = blob.read_shift(1);\n\tvar cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\tvar itab = 0;\n\tif(!opts || opts.biff >= 5) {\n\t\tif(opts.biff != 5) blob.l += 2;\n\t\titab = blob.read_shift(2);\n\t\tif(opts.biff == 5) blob.l += 2;\n\t\tblob.l += 4;\n\t}\n\tvar name = parse_XLUnicodeStringNoCch(blob, cch, opts);\n\tif(flags & 0x20) name = XLSLblBuiltIn[name.charCodeAt(0)];\n\tvar npflen = target - blob.l; if(opts && opts.biff == 2) --npflen;\n\t/*jshint -W018 */\n\tvar rgce = (target == blob.l || cce === 0 || !(npflen > 0)) ? [] : parse_NameParsedFormula(blob, npflen, opts, cce);\n\t/*jshint +W018 */\n\treturn {\n\t\tchKey: chKey,\n\t\tName: name,\n\t\titab: itab,\n\t\trgce: rgce\n\t};\n}\n\n/* [MS-XLS] 2.4.106 TODO: verify filename encoding */\nfunction parse_ExternSheet(blob, length, opts) {\n\tif(opts.biff < 8) return parse_BIFF5ExternSheet(blob, length, opts);\n\tvar o = [], target = blob.l + length, len = blob.read_shift(opts.biff > 8 ? 4 : 2);\n\twhile(len-- !== 0) o.push(parse_XTI(blob, opts.biff > 8 ? 12 : 6, opts));\n\t\t// [iSupBook, itabFirst, itabLast];\n\tif(blob.l != target) throw new Error(\"Bad ExternSheet: \" + blob.l + \" != \" + target);\n\treturn o;\n}\nfunction parse_BIFF5ExternSheet(blob, length, opts) {\n\tif(blob[blob.l + 1] == 0x03) blob[blob.l]++;\n\tvar o = parse_ShortXLUnicodeString(blob, length, opts);\n\treturn o.charCodeAt(0) == 0x03 ? o.slice(1) : o;\n}\n\n/* [MS-XLS] 2.4.176 TODO: check older biff */\nfunction parse_NameCmt(blob, length, opts) {\n\tif(opts.biff < 8) { blob.l += length; return; }\n\tvar cchName = blob.read_shift(2);\n\tvar cchComment = blob.read_shift(2);\n\tvar name = parse_XLUnicodeStringNoCch(blob, cchName, opts);\n\tvar comment = parse_XLUnicodeStringNoCch(blob, cchComment, opts);\n\treturn [name, comment];\n}\n\n/* [MS-XLS] 2.4.260 */\nfunction parse_ShrFmla(blob, length, opts) {\n\tvar ref = parse_RefU(blob, 6);\n\tblob.l++;\n\tvar cUse = blob.read_shift(1);\n\tlength -= 8;\n\treturn [parse_SharedParsedFormula(blob, length, opts), cUse, ref];\n}\n\n/* [MS-XLS] 2.4.4 TODO */\nfunction parse_Array(blob, length, opts) {\n\tvar ref = parse_Ref(blob, 6);\n\t/* TODO: fAlwaysCalc */\n\tswitch(opts.biff) {\n\t\tcase 2: blob.l ++; length -= 7; break;\n\t\tcase 3: case 4: blob.l += 2; length -= 8; break;\n\t\tdefault: blob.l += 6; length -= 12;\n\t}\n\treturn [ref, parse_ArrayParsedFormula(blob, length, opts, ref)];\n}\n\n/* [MS-XLS] 2.4.173 */\nfunction parse_MTRSettings(blob) {\n\tvar fMTREnabled = blob.read_shift(4) !== 0x00;\n\tvar fUserSetThreadCount = blob.read_shift(4) !== 0x00;\n\tvar cUserThreadCount = blob.read_shift(4);\n\treturn [fMTREnabled, fUserSetThreadCount, cUserThreadCount];\n}\n\n/* [MS-XLS] 2.5.186 TODO: BIFF5 */\nfunction parse_NoteSh(blob, length, opts) {\n\tif(opts.biff < 8) return;\n\tvar row = blob.read_shift(2), col = blob.read_shift(2);\n\tvar flags = blob.read_shift(2), idObj = blob.read_shift(2);\n\tvar stAuthor = parse_XLUnicodeString2(blob, 0, opts);\n\tif(opts.biff < 8) blob.read_shift(1);\n\treturn [{r:row,c:col}, stAuthor, idObj, flags];\n}\n\n/* [MS-XLS] 2.4.179 */\nfunction parse_Note(blob, length, opts) {\n\t/* TODO: Support revisions */\n\treturn parse_NoteSh(blob, length, opts);\n}\n\n/* [MS-XLS] 2.4.168 */\nfunction parse_MergeCells(blob, length) {\n\tvar merges = [];\n\tvar cmcs = blob.read_shift(2);\n\twhile (cmcs--) merges.push(parse_Ref8U(blob,length));\n\treturn merges;\n}\nfunction write_MergeCells(merges) {\n\tvar o = new_buf(2 + merges.length * 8);\n\to.write_shift(2, merges.length);\n\tfor(var i = 0; i < merges.length; ++i) write_Ref8U(merges[i], o);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.181 TODO: parse all the things! */\nfunction parse_Obj(blob, length, opts) {\n\tif(opts && opts.biff < 8) return parse_BIFF5Obj(blob, length, opts);\n\tvar cmo = parse_FtCmo(blob, 22); // id, ot, flags\n\tvar fts = parse_FtArray(blob, length-22, cmo[1]);\n\treturn { cmo: cmo, ft:fts };\n}\n/* from older spec */\nvar parse_BIFF5OT = {\n0x08: function(blob, length) {\n\tvar tgt = blob.l + length;\n\tblob.l += 10; // todo\n\tvar cf = blob.read_shift(2);\n\tblob.l += 4;\n\tblob.l += 2; //var cbPictFmla = blob.read_shift(2);\n\tblob.l += 2;\n\tblob.l += 2; //var grbit = blob.read_shift(2);\n\tblob.l += 4;\n\tvar cchName = blob.read_shift(1);\n\tblob.l += cchName; // TODO: stName\n\tblob.l = tgt; // TODO: fmla\n\treturn { fmt:cf };\n}\n};\n\nfunction parse_BIFF5Obj(blob, length, opts) {\n\tblob.l += 4; //var cnt = blob.read_shift(4);\n\tvar ot = blob.read_shift(2);\n\tvar id = blob.read_shift(2);\n\tvar grbit = blob.read_shift(2);\n\tblob.l += 2; //var colL = blob.read_shift(2);\n\tblob.l += 2; //var dxL = blob.read_shift(2);\n\tblob.l += 2; //var rwT = blob.read_shift(2);\n\tblob.l += 2; //var dyT = blob.read_shift(2);\n\tblob.l += 2; //var colR = blob.read_shift(2);\n\tblob.l += 2; //var dxR = blob.read_shift(2);\n\tblob.l += 2; //var rwB = blob.read_shift(2);\n\tblob.l += 2; //var dyB = blob.read_shift(2);\n\tblob.l += 2; //var cbMacro = blob.read_shift(2);\n\tblob.l += 6;\n\tlength -= 36;\n\tvar fts = [];\n\tfts.push((parse_BIFF5OT[ot]||parsenoop)(blob, length, opts));\n\treturn { cmo: [id, ot, grbit], ft:fts };\n}\n\n/* [MS-XLS] 2.4.329 TODO: parse properly */\nfunction parse_TxO(blob, length, opts) {\n\tvar s = blob.l;\n\tvar texts = \"\";\ntry {\n\tblob.l += 4;\n\tvar ot = (opts.lastobj||{cmo:[0,0]}).cmo[1];\n\tvar controlInfo; // eslint-disable-line no-unused-vars\n\tif([0,5,7,11,12,14].indexOf(ot) == -1) blob.l += 6;\n\telse controlInfo = parse_ControlInfo(blob, 6, opts); // eslint-disable-line no-unused-vars\n\tvar cchText = blob.read_shift(2);\n\t/*var cbRuns = */blob.read_shift(2);\n\t/*var ifntEmpty = */parseuint16(blob, 2);\n\tvar len = blob.read_shift(2);\n\tblob.l += len;\n\t//var fmla = parse_ObjFmla(blob, s + length - blob.l);\n\n\tfor(var i = 1; i < blob.lens.length-1; ++i) {\n\t\tif(blob.l-s != blob.lens[i]) throw new Error(\"TxO: bad continue record\");\n\t\tvar hdr = blob[blob.l];\n\t\tvar t = parse_XLUnicodeStringNoCch(blob, blob.lens[i+1]-blob.lens[i]-1);\n\t\ttexts += t;\n\t\tif(texts.length >= (hdr ? cchText : 2*cchText)) break;\n\t}\n\tif(texts.length !== cchText && texts.length !== cchText*2) {\n\t\tthrow new Error(\"cchText: \" + cchText + \" != \" + texts.length);\n\t}\n\n\tblob.l = s + length;\n\t/* [MS-XLS] 2.5.272 TxORuns */\n//\tvar rgTxoRuns = [];\n//\tfor(var j = 0; j != cbRuns/8-1; ++j) blob.l += 8;\n//\tvar cchText2 = blob.read_shift(2);\n//\tif(cchText2 !== cchText) throw new Error(\"TxOLastRun mismatch: \" + cchText2 + \" \" + cchText);\n//\tblob.l += 6;\n//\tif(s + length != blob.l) throw new Error(\"TxO \" + (s + length) + \", at \" + blob.l);\n\treturn { t: texts };\n} catch(e) { blob.l = s + length; return { t: texts }; }\n}\n\n/* [MS-XLS] 2.4.140 */\nfunction parse_HLink(blob, length) {\n\tvar ref = parse_Ref8U(blob, 8);\n\tblob.l += 16; /* CLSID */\n\tvar hlink = parse_Hyperlink(blob, length-24);\n\treturn [ref, hlink];\n}\nfunction write_HLink(hl) {\n\tvar O = new_buf(24);\n\tvar ref = decode_cell(hl[0]);\n\tO.write_shift(2, ref.r); O.write_shift(2, ref.r);\n\tO.write_shift(2, ref.c); O.write_shift(2, ref.c);\n\tvar clsid = \"d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b\".split(\" \");\n\tfor(var i = 0; i < 16; ++i) O.write_shift(1, parseInt(clsid[i], 16));\n\treturn bconcat([O, write_Hyperlink(hl[1])]);\n}\n\n\n/* [MS-XLS] 2.4.141 */\nfunction parse_HLinkTooltip(blob, length) {\n\tblob.read_shift(2);\n\tvar ref = parse_Ref8U(blob, 8);\n\tvar wzTooltip = blob.read_shift((length-10)/2, 'dbcs-cont');\n\twzTooltip = wzTooltip.replace(chr0,\"\");\n\treturn [ref, wzTooltip];\n}\nfunction write_HLinkTooltip(hl) {\n\tvar TT = hl[1].Tooltip;\n\tvar O = new_buf(10 + 2 * (TT.length + 1));\n\tO.write_shift(2, 0x0800);\n\tvar ref = decode_cell(hl[0]);\n\tO.write_shift(2, ref.r); O.write_shift(2, ref.r);\n\tO.write_shift(2, ref.c); O.write_shift(2, ref.c);\n\tfor(var i = 0; i < TT.length; ++i) O.write_shift(2, TT.charCodeAt(i));\n\tO.write_shift(2, 0);\n\treturn O;\n}\n\n/* [MS-XLS] 2.4.63 */\nfunction parse_Country(blob) {\n\tvar o = [0,0], d;\n\td = blob.read_shift(2); o[0] = CountryEnum[d] || d;\n\td = blob.read_shift(2); o[1] = CountryEnum[d] || d;\n\treturn o;\n}\nfunction write_Country(o) {\n\tif(!o) o = new_buf(4);\n\to.write_shift(2, 0x01);\n\to.write_shift(2, 0x01);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.50 ClrtClient */\nfunction parse_ClrtClient(blob) {\n\tvar ccv = blob.read_shift(2);\n\tvar o = [];\n\twhile(ccv-->0) o.push(parse_LongRGB(blob, 8));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.188 */\nfunction parse_Palette(blob) {\n\tvar ccv = blob.read_shift(2);\n\tvar o = [];\n\twhile(ccv-->0) o.push(parse_LongRGB(blob, 8));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.354 */\nfunction parse_XFCRC(blob) {\n\tblob.l += 2;\n\tvar o = {cxfs:0, crc:0};\n\to.cxfs = blob.read_shift(2);\n\to.crc = blob.read_shift(4);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.53 TODO: parse flags */\n/* [MS-XLSB] 2.4.323 TODO: parse flags */\nfunction parse_ColInfo(blob, length, opts) {\n\tif(!opts.cellStyles) return parsenoop(blob, length);\n\tvar w = opts && opts.biff >= 12 ? 4 : 2;\n\tvar colFirst = blob.read_shift(w);\n\tvar colLast = blob.read_shift(w);\n\tvar coldx = blob.read_shift(w);\n\tvar ixfe = blob.read_shift(w);\n\tvar flags = blob.read_shift(2);\n\tif(w == 2) blob.l += 2;\n\tvar o = ({s:colFirst, e:colLast, w:coldx, ixfe:ixfe, flags:flags});\n\tif(opts.biff >= 5 || !opts.biff) o.level = (flags >> 8) & 0x7;\n\treturn o;\n}\nfunction write_ColInfo(col, idx) {\n\tvar o = new_buf(12);\n\to.write_shift(2, idx);\n\to.write_shift(2, idx);\n\to.write_shift(2, col.width * 256);\n\to.write_shift(2, 0);\n\tvar f = 0;\n\tif(col.hidden) f |= 1;\n\to.write_shift(1, f);\n\tf = col.level || 0;\n\to.write_shift(1, f);\n\to.write_shift(2, 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.257 */\nfunction parse_Setup(blob, length) {\n\tvar o = {};\n\tif(length < 32) return o;\n\tblob.l += 16;\n\to.header = parse_Xnum(blob, 8);\n\to.footer = parse_Xnum(blob, 8);\n\tblob.l += 2;\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.261 */\nfunction parse_ShtProps(blob, length, opts) {\n\tvar def = {area:false};\n\tif(opts.biff != 5) { blob.l += length; return def; }\n\tvar d = blob.read_shift(1); blob.l += 3;\n\tif((d & 0x10)) def.area = true;\n\treturn def;\n}\n\n/* [MS-XLS] 2.4.241 */\nfunction write_RRTabId(n) {\n\tvar out = new_buf(2 * n);\n\tfor(var i = 0; i < n; ++i) out.write_shift(2, i+1);\n\treturn out;\n}\n\nvar parse_Blank = parse_XLSCell; /* [MS-XLS] 2.4.20 Just the cell */\nvar parse_Scl = parseuint16a; /* [MS-XLS] 2.4.247 num, den */\nvar parse_String = parse_XLUnicodeString; /* [MS-XLS] 2.4.268 */\n\n/* --- Specific to versions before BIFF8 --- */\nfunction parse_ImData(blob) {\n\tvar cf = blob.read_shift(2);\n\tvar env = blob.read_shift(2);\n\tvar lcb = blob.read_shift(4);\n\tvar o = {fmt:cf, env:env, len:lcb, data:blob.slice(blob.l,blob.l+lcb)};\n\tblob.l += lcb;\n\treturn o;\n}\n\n/* BIFF2_??? where ??? is the name from [XLS] */\nfunction parse_BIFF2STR(blob, length, opts) {\n\tif(opts.biffguess && opts.biff == 5) opts.biff = 2;\n\tvar cell = parse_XLSCell(blob, 6);\n\t++blob.l;\n\tvar str = parse_XLUnicodeString2(blob, length-7, opts);\n\tcell.t = 'str';\n\tcell.val = str;\n\treturn cell;\n}\n\nfunction parse_BIFF2NUM(blob) {\n\tvar cell = parse_XLSCell(blob, 6);\n\t++blob.l;\n\tvar num = parse_Xnum(blob, 8);\n\tcell.t = 'n';\n\tcell.val = num;\n\treturn cell;\n}\nfunction write_BIFF2NUM(r, c, val) {\n\tvar out = new_buf(15);\n\twrite_BIFF2Cell(out, r, c);\n\tout.write_shift(8, val, 'f');\n\treturn out;\n}\n\nfunction parse_BIFF2INT(blob) {\n\tvar cell = parse_XLSCell(blob, 6);\n\t++blob.l;\n\tvar num = blob.read_shift(2);\n\tcell.t = 'n';\n\tcell.val = num;\n\treturn cell;\n}\nfunction write_BIFF2INT(r, c, val) {\n\tvar out = new_buf(9);\n\twrite_BIFF2Cell(out, r, c);\n\tout.write_shift(2, val);\n\treturn out;\n}\n\nfunction parse_BIFF2STRING(blob) {\n\tvar cch = blob.read_shift(1);\n\tif(cch === 0) { blob.l++; return \"\"; }\n\treturn blob.read_shift(cch, 'sbcs-cont');\n}\n\n/* TODO: convert to BIFF8 font struct */\nfunction parse_BIFF2FONTXTRA(blob, length) {\n\tblob.l += 6; // unknown\n\tblob.l += 2; // font weight \"bls\"\n\tblob.l += 1; // charset\n\tblob.l += 3; // unknown\n\tblob.l += 1; // font family\n\tblob.l += length - 13;\n}\n\n/* TODO: parse rich text runs */\nfunction parse_RString(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar cell = parse_XLSCell(blob, 6);\n\tvar cch = blob.read_shift(2);\n\tvar str = parse_XLUnicodeStringNoCch(blob, cch, opts);\n\tblob.l = end;\n\tcell.t = 'str';\n\tcell.val = str;\n\treturn cell;\n}\n/* from js-harb (C) 2014-present  SheetJS */\nvar DBF_SUPPORTED_VERSIONS = [0x02, 0x03, 0x30, 0x31, 0x83, 0x8B, 0x8C, 0xF5];\nvar DBF = (function() {\nvar dbf_codepage_map = {\n\t/* Code Pages Supported by Visual FoxPro */\n0x01:   437,           0x02:   850,\n0x03:  1252,           0x04: 10000,\n0x64:   852,           0x65:   866,\n0x66:   865,           0x67:   861,\n0x68:   895,           0x69:   620,\n0x6A:   737,           0x6B:   857,\n0x78:   950,           0x79:   949,\n0x7A:   936,           0x7B:   932,\n0x7C:   874,           0x7D:  1255,\n0x7E:  1256,           0x96: 10007,\n0x97: 10029,           0x98: 10006,\n0xC8:  1250,           0xC9:  1251,\n0xCA:  1254,           0xCB:  1253,\n\n\t/* shapefile DBF extension */\n0x00: 20127,           0x08:   865,\n0x09:   437,           0x0A:   850,\n0x0B:   437,           0x0D:   437,\n0x0E:   850,           0x0F:   437,\n0x10:   850,           0x11:   437,\n0x12:   850,           0x13:   932,\n0x14:   850,           0x15:   437,\n0x16:   850,           0x17:   865,\n0x18:   437,           0x19:   437,\n0x1A:   850,           0x1B:   437,\n0x1C:   863,           0x1D:   850,\n0x1F:   852,           0x22:   852,\n0x23:   852,           0x24:   860,\n0x25:   850,           0x26:   866,\n0x37:   850,           0x40:   852,\n0x4D:   936,           0x4E:   949,\n0x4F:   950,           0x50:   874,\n0x57:  1252,           0x58:  1252,\n0x59:  1252,           0x6C:   863,\n0x86:   737,           0x87:   852,\n0x88:   857,           0xCC:  1257,\n\n0xFF: 16969\n};\nvar dbf_reverse_map = evert({\n0x01:   437,           0x02:   850,\n0x03:  1252,           0x04: 10000,\n0x64:   852,           0x65:   866,\n0x66:   865,           0x67:   861,\n0x68:   895,           0x69:   620,\n0x6A:   737,           0x6B:   857,\n0x78:   950,           0x79:   949,\n0x7A:   936,           0x7B:   932,\n0x7C:   874,           0x7D:  1255,\n0x7E:  1256,           0x96: 10007,\n0x97: 10029,           0x98: 10006,\n0xC8:  1250,           0xC9:  1251,\n0xCA:  1254,           0xCB:  1253,\n0x00: 20127\n});\n/* TODO: find an actual specification */\nfunction dbf_to_aoa(buf, opts) {\n\tvar out = [];\n\tvar d = (new_raw_buf(1));\n\tswitch(opts.type) {\n\t\tcase 'base64': d = s2a(Base64_decode(buf)); break;\n\t\tcase 'binary': d = s2a(buf); break;\n\t\tcase 'buffer':\n\t\tcase 'array': d = buf; break;\n\t}\n\tprep_blob(d, 0);\n\n\t/* header */\n\tvar ft = d.read_shift(1);\n\tvar memo = !!(ft & 0x88);\n\tvar vfp = false, l7 = false;\n\tswitch(ft) {\n\t\tcase 0x02: break; // dBASE II\n\t\tcase 0x03: break; // dBASE III\n\t\tcase 0x30: vfp = true; memo = true; break; // VFP\n\t\tcase 0x31: vfp = true; memo = true; break; // VFP with autoincrement\n\t\t// 0x43 dBASE IV SQL table files\n\t\t// 0x63 dBASE IV SQL system files\n\t\tcase 0x83: break; // dBASE III with memo\n\t\tcase 0x8B: break; // dBASE IV with memo\n\t\tcase 0x8C: l7 = true; break; // dBASE Level 7 with memo\n\t\t// case 0xCB dBASE IV SQL table files with memo\n\t\tcase 0xF5: break; // FoxPro 2.x with memo\n\t\t// case 0xFB FoxBASE\n\t\tdefault: throw new Error(\"DBF Unsupported Version: \" + ft.toString(16));\n\t}\n\n\tvar nrow = 0, fpos = 0x0209;\n\tif(ft == 0x02) nrow = d.read_shift(2);\n\td.l += 3; // dBASE II stores DDMMYY date, others use YYMMDD\n\tif(ft != 0x02) nrow = d.read_shift(4);\n\tif(nrow > 1048576) nrow = 1e6;\n\n\tif(ft != 0x02) fpos = d.read_shift(2); // header length\n\tvar rlen = d.read_shift(2); // record length\n\n\tvar /*flags = 0,*/ current_cp = opts.codepage || 1252;\n\tif(ft != 0x02) { // 20 reserved bytes\n\t\td.l+=16;\n\t\t/*flags = */d.read_shift(1);\n\t\t//if(memo && ((flags & 0x02) === 0)) throw new Error(\"DBF Flags \" + flags.toString(16) + \" ft \" + ft.toString(16));\n\n\t\t/* codepage present in FoxPro and dBASE Level 7 */\n\t\tif(d[d.l] !== 0) current_cp = dbf_codepage_map[d[d.l]];\n\t\td.l+=1;\n\n\t\td.l+=2;\n\t}\n\tif(l7) d.l += 36; // Level 7: 32 byte \"Language driver name\", 4 byte reserved\n\nvar fields = [], field = ({});\n\tvar hend = Math.min(d.length, (ft == 0x02 ? 0x209 : (fpos - 10 - (vfp ? 264 : 0))));\n\tvar ww = l7 ? 32 : 11;\n\twhile(d.l < hend && d[d.l] != 0x0d) {\n\t\tfield = ({});\n\t\tfield.name = $cptable.utils.decode(current_cp, d.slice(d.l, d.l+ww)).replace(/[\\u0000\\r\\n].*$/g,\"\");\n\t\td.l += ww;\n\t\tfield.type = String.fromCharCode(d.read_shift(1));\n\t\tif(ft != 0x02 && !l7) field.offset = d.read_shift(4);\n\t\tfield.len = d.read_shift(1);\n\t\tif(ft == 0x02) field.offset = d.read_shift(2);\n\t\tfield.dec = d.read_shift(1);\n\t\tif(field.name.length) fields.push(field);\n\t\tif(ft != 0x02) d.l += l7 ? 13 : 14;\n\t\tswitch(field.type) {\n\t\t\tcase 'B': // Double (VFP) / Binary (dBASE L7)\n\t\t\t\tif((!vfp || field.len != 8) && opts.WTF) console.log('Skipping ' + field.name + ':' + field.type);\n\t\t\t\tbreak;\n\t\t\tcase 'G': // General (FoxPro and dBASE L7)\n\t\t\tcase 'P': // Picture (FoxPro and dBASE L7)\n\t\t\t\tif(opts.WTF) console.log('Skipping ' + field.name + ':' + field.type);\n\t\t\t\tbreak;\n\t\t\tcase '+': // Autoincrement (dBASE L7 only)\n\t\t\tcase '0': // _NullFlags (VFP only)\n\t\t\tcase '@': // Timestamp (dBASE L7 only)\n\t\t\tcase 'C': // Character (dBASE II)\n\t\t\tcase 'D': // Date (dBASE III)\n\t\t\tcase 'F': // Float (dBASE IV)\n\t\t\tcase 'I': // Long (VFP and dBASE L7)\n\t\t\tcase 'L': // Logical (dBASE II)\n\t\t\tcase 'M': // Memo (dBASE III)\n\t\t\tcase 'N': // Number (dBASE II)\n\t\t\tcase 'O': // Double (dBASE L7 only)\n\t\t\tcase 'T': // Datetime (VFP only)\n\t\t\tcase 'Y': // Currency (VFP only)\n\t\t\t\tbreak;\n\t\t\tdefault: throw new Error('Unknown Field Type: ' + field.type);\n\t\t}\n\t}\n\n\tif(d[d.l] !== 0x0D) d.l = fpos-1;\n\tif(d.read_shift(1) !== 0x0D) throw new Error(\"DBF Terminator not found \" + d.l + \" \" + d[d.l]);\n\td.l = fpos;\n\n\t/* data */\n\tvar R = 0, C = 0;\n\tout[0] = [];\n\tfor(C = 0; C != fields.length; ++C) out[0][C] = fields[C].name;\n\twhile(nrow-- > 0) {\n\t\tif(d[d.l] === 0x2A) {\n\t\t\t// TODO: record marked as deleted -- create a hidden row?\n\t\t\td.l+=rlen;\n\t\t\tcontinue;\n\t\t}\n\t\t++d.l;\n\t\tout[++R] = []; C = 0;\n\t\tfor(C = 0; C != fields.length; ++C) {\n\t\t\tvar dd = d.slice(d.l, d.l+fields[C].len); d.l+=fields[C].len;\n\t\t\tprep_blob(dd, 0);\n\t\t\tvar s = $cptable.utils.decode(current_cp, dd);\n\t\t\tswitch(fields[C].type) {\n\t\t\t\tcase 'C':\n\t\t\t\t\t// NOTE: it is conventional to write '  /  /  ' for empty dates\n\t\t\t\t\tif(s.trim().length) out[R][C] = s.replace(/\\s+$/,\"\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'D':\n\t\t\t\t\tif(s.length === 8) out[R][C] = new Date(+s.slice(0,4), +s.slice(4,6)-1, +s.slice(6,8));\n\t\t\t\t\telse out[R][C] = s;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'F': out[R][C] = parseFloat(s.trim()); break;\n\t\t\t\tcase '+': case 'I': out[R][C] = l7 ? dd.read_shift(-4, 'i') ^ 0x80000000 : dd.read_shift(4, 'i'); break;\n\t\t\t\tcase 'L': switch(s.trim().toUpperCase()) {\n\t\t\t\t\tcase 'Y': case 'T': out[R][C] = true; break;\n\t\t\t\t\tcase 'N': case 'F': out[R][C] = false; break;\n\t\t\t\t\tcase '': case '?': break;\n\t\t\t\t\tdefault: throw new Error(\"DBF Unrecognized L:|\" + s + \"|\");\n\t\t\t\t\t} break;\n\t\t\t\tcase 'M': /* TODO: handle memo files */\n\t\t\t\t\tif(!memo) throw new Error(\"DBF Unexpected MEMO for type \" + ft.toString(16));\n\t\t\t\t\tout[R][C] = \"##MEMO##\" + (l7 ? parseInt(s.trim(), 10): dd.read_shift(4));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'N':\n\t\t\t\t\ts = s.replace(/\\u0000/g,\"\").trim();\n\t\t\t\t\t// NOTE: dBASE II interprets \"  .  \" as 0\n\t\t\t\t\tif(s && s != \".\") out[R][C] = +s || 0; break;\n\t\t\t\tcase '@':\n\t\t\t\t\t// NOTE: dBASE specs appear to be incorrect\n\t\t\t\t\tout[R][C] = new Date(dd.read_shift(-8, 'f') - 0x388317533400);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'T': out[R][C] = new Date((dd.read_shift(4) - 0x253D8C) * 0x5265C00 + dd.read_shift(4)); break;\n\t\t\t\tcase 'Y': out[R][C] = dd.read_shift(4,'i')/1e4 + (dd.read_shift(4, 'i')/1e4)*Math.pow(2,32); break;\n\t\t\t\tcase 'O': out[R][C] = -dd.read_shift(-8, 'f'); break;\n\t\t\t\tcase 'B': if(vfp && fields[C].len == 8) { out[R][C] = dd.read_shift(8,'f'); break; }\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 'G': case 'P': dd.l += fields[C].len; break;\n\t\t\t\tcase '0':\n\t\t\t\t\tif(fields[C].name === '_NullFlags') break;\n\t\t\t\t\t/* falls through */\n\t\t\t\tdefault: throw new Error(\"DBF Unsupported data type \" + fields[C].type);\n\t\t\t}\n\t\t}\n\t}\n\tif(ft != 0x02) if(d.l < d.length && d[d.l++] != 0x1A) throw new Error(\"DBF EOF Marker missing \" + (d.l-1) + \" of \" + d.length + \" \" + d[d.l-1].toString(16));\n\tif(opts && opts.sheetRows) out = out.slice(0, opts.sheetRows);\n\topts.DBF = fields;\n\treturn out;\n}\n\nfunction dbf_to_sheet(buf, opts) {\n\tvar o = opts || {};\n\tif(!o.dateNF) o.dateNF = \"yyyymmdd\";\n\tvar ws = aoa_to_sheet(dbf_to_aoa(buf, o), o);\n\tws[\"!cols\"] = o.DBF.map(function(field) { return {\n\t\twch: field.len,\n\t\tDBF: field\n\t};});\n\tdelete o.DBF;\n\treturn ws;\n}\n\nfunction dbf_to_workbook(buf, opts) {\n\ttry { return sheet_to_workbook(dbf_to_sheet(buf, opts), opts); }\n\tcatch(e) { if(opts && opts.WTF) throw e; }\n\treturn ({SheetNames:[],Sheets:{}});\n}\n\nvar _RLEN = { 'B': 8, 'C': 250, 'L': 1, 'D': 8, '?': 0, '': 0 };\nfunction sheet_to_dbf(ws, opts) {\n\tvar o = opts || {};\n\tif(+o.codepage >= 0) set_cp(+o.codepage);\n\tif(o.type == \"string\") throw new Error(\"Cannot write DBF to JS string\");\n\tvar ba = buf_array();\n\tvar aoa = sheet_to_json(ws, {header:1, raw:true, cellDates:true});\n\tvar headers = aoa[0], data = aoa.slice(1), cols = ws[\"!cols\"] || [];\n\tvar i = 0, j = 0, hcnt = 0, rlen = 1;\n\tfor(i = 0; i < headers.length; ++i) {\n\t\tif(((cols[i]||{}).DBF||{}).name) { headers[i] = cols[i].DBF.name; ++hcnt; continue; }\n\t\tif(headers[i] == null) continue;\n\t\t++hcnt;\n\t\tif(typeof headers[i] === 'number') headers[i] = headers[i].toString(10);\n\t\tif(typeof headers[i] !== 'string') throw new Error(\"DBF Invalid column name \" + headers[i] + \" |\" + (typeof headers[i]) + \"|\");\n\t\tif(headers.indexOf(headers[i]) !== i) for(j=0; j<1024;++j)\n\t\t\tif(headers.indexOf(headers[i] + \"_\" + j) == -1) { headers[i] += \"_\" + j; break; }\n\t}\n\tvar range = safe_decode_range(ws['!ref']);\n\tvar coltypes = [];\n\tvar colwidths = [];\n\tvar coldecimals = [];\n\tfor(i = 0; i <= range.e.c - range.s.c; ++i) {\n\t\tvar guess = '', _guess = '', maxlen = 0;\n\t\tvar col = [];\n\t\tfor(j=0; j < data.length; ++j) {\n\t\t\tif(data[j][i] != null) col.push(data[j][i]);\n\t\t}\n\t\tif(col.length == 0 || headers[i] == null) { coltypes[i] = '?'; continue; }\n\t\tfor(j = 0; j < col.length; ++j) {\n\t\t\tswitch(typeof col[j]) {\n\t\t\t\t/* TODO: check if L2 compat is desired */\n\t\t\t\tcase 'number': _guess = 'B'; break;\n\t\t\t\tcase 'string': _guess = 'C'; break;\n\t\t\t\tcase 'boolean': _guess = 'L'; break;\n\t\t\t\tcase 'object': _guess = col[j] instanceof Date ? 'D' : 'C'; break;\n\t\t\t\tdefault: _guess = 'C';\n\t\t\t}\n\t\t\tmaxlen = Math.max(maxlen, String(col[j]).length);\n\t\t\tguess = guess && guess != _guess ? 'C' : _guess;\n\t\t\t//if(guess == 'C') break;\n\t\t}\n\t\tif(maxlen > 250) maxlen = 250;\n\t\t_guess = ((cols[i]||{}).DBF||{}).type;\n\t\t/* TODO: more fine grained control over DBF type resolution */\n\t\tif(_guess == 'C') {\n\t\t\tif(cols[i].DBF.len > maxlen) maxlen = cols[i].DBF.len;\n\t\t}\n\t\tif(guess == 'B' && _guess == 'N') {\n\t\t\tguess = 'N';\n\t\t\tcoldecimals[i] = cols[i].DBF.dec;\n\t\t\tmaxlen = cols[i].DBF.len;\n\t\t}\n\t\tcolwidths[i] = guess == 'C' || _guess == 'N' ? maxlen : (_RLEN[guess] || 0);\n\t\trlen += colwidths[i];\n\t\tcoltypes[i] = guess;\n\t}\n\n\tvar h = ba.next(32);\n\th.write_shift(4, 0x13021130);\n\th.write_shift(4, data.length);\n\th.write_shift(2, 296 + 32 * hcnt);\n\th.write_shift(2, rlen);\n\tfor(i=0; i < 4; ++i) h.write_shift(4, 0);\n\th.write_shift(4, 0x00000000 | ((+dbf_reverse_map[current_ansi] || 0x03)<<8));\n\n\tfor(i = 0, j = 0; i < headers.length; ++i) {\n\t\tif(headers[i] == null) continue;\n\t\tvar hf = ba.next(32);\n\t\tvar _f = (headers[i].slice(-10) + \"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\").slice(0, 11);\n\t\thf.write_shift(1, _f, \"sbcs\");\n\t\thf.write_shift(1, coltypes[i] == '?' ? 'C' : coltypes[i], \"sbcs\");\n\t\thf.write_shift(4, j);\n\t\thf.write_shift(1, colwidths[i] || _RLEN[coltypes[i]] || 0);\n\t\thf.write_shift(1, coldecimals[i] || 0);\n\t\thf.write_shift(1, 0x02);\n\t\thf.write_shift(4, 0);\n\t\thf.write_shift(1, 0);\n\t\thf.write_shift(4, 0);\n\t\thf.write_shift(4, 0);\n\t\tj += (colwidths[i] || _RLEN[coltypes[i]] || 0);\n\t}\n\n\tvar hb = ba.next(264);\n\thb.write_shift(4, 0x0000000D);\n\tfor(i=0; i < 65;++i) hb.write_shift(4, 0x00000000);\n\tfor(i=0; i < data.length; ++i) {\n\t\tvar rout = ba.next(rlen);\n\t\trout.write_shift(1, 0);\n\t\tfor(j=0; j<headers.length; ++j) {\n\t\t\tif(headers[j] == null) continue;\n\t\t\tswitch(coltypes[j]) {\n\t\t\t\tcase 'L': rout.write_shift(1, data[i][j] == null ? 0x3F : data[i][j] ? 0x54 : 0x46); break;\n\t\t\t\tcase 'B': rout.write_shift(8, data[i][j]||0, 'f'); break;\n\t\t\t\tcase 'N':\n\t\t\t\t\tvar _n = \"0\";\n\t\t\t\t\tif(typeof data[i][j] == \"number\") _n = data[i][j].toFixed(coldecimals[j]||0);\n\t\t\t\t\tfor(hcnt=0; hcnt < colwidths[j]-_n.length; ++hcnt) rout.write_shift(1, 0x20);\n\t\t\t\t\trout.write_shift(1, _n, \"sbcs\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'D':\n\t\t\t\t\tif(!data[i][j]) rout.write_shift(8, \"00000000\", \"sbcs\");\n\t\t\t\t\telse {\n\t\t\t\t\t\trout.write_shift(4, (\"0000\"+data[i][j].getFullYear()).slice(-4), \"sbcs\");\n\t\t\t\t\t\trout.write_shift(2, (\"00\"+(data[i][j].getMonth()+1)).slice(-2), \"sbcs\");\n\t\t\t\t\t\trout.write_shift(2, (\"00\"+data[i][j].getDate()).slice(-2), \"sbcs\");\n\t\t\t\t\t} break;\n\t\t\t\tcase 'C':\n\t\t\t\t\tvar _s = String(data[i][j] != null ? data[i][j] : \"\").slice(0, colwidths[j]);\n\t\t\t\t\trout.write_shift(1, _s, \"sbcs\");\n\t\t\t\t\tfor(hcnt=0; hcnt < colwidths[j]-_s.length; ++hcnt) rout.write_shift(1, 0x20); break;\n\t\t\t}\n\t\t}\n\t\t// data\n\t}\n\tba.next(1).write_shift(1, 0x1A);\n\treturn ba.end();\n}\n\treturn {\n\t\tto_workbook: dbf_to_workbook,\n\t\tto_sheet: dbf_to_sheet,\n\t\tfrom_sheet: sheet_to_dbf\n\t};\n})();\n\nvar SYLK = (function() {\n\t/* TODO: stress test sequences */\n\tvar sylk_escapes = ({\n\t\tAA:'À', BA:'Á', CA:'Â', DA:195, HA:'Ä', JA:197,\n\t\tAE:'È', BE:'É', CE:'Ê',         HE:'Ë',\n\t\tAI:'Ì', BI:'Í', CI:'Î',         HI:'Ï',\n\t\tAO:'Ò', BO:'Ó', CO:'Ô', DO:213, HO:'Ö',\n\t\tAU:'Ù', BU:'Ú', CU:'Û',         HU:'Ü',\n\t\tAa:'à', Ba:'á', Ca:'â', Da:227, Ha:'ä', Ja:229,\n\t\tAe:'è', Be:'é', Ce:'ê',         He:'ë',\n\t\tAi:'ì', Bi:'í', Ci:'î',         Hi:'ï',\n\t\tAo:'ò', Bo:'ó', Co:'ô', Do:245, Ho:'ö',\n\t\tAu:'ù', Bu:'ú', Cu:'û',         Hu:'ü',\n\t\tKC:'Ç', Kc:'ç', q:'æ',  z:'œ',  a:'Æ',  j:'Œ',\n\t\tDN:209, Dn:241, Hy:255,\n\t\tS:169,  c:170,  R:174,  \"B \":180,\n0:176,    1:177,  2:178,\n3:179,    5:181,  6:182,\n7:183,    Q:185,  k:186,  b:208,  i:216,  l:222,  s:240,  y:248,\n\t\t\"!\":161, '\"':162, \"#\":163, \"(\":164, \"%\":165, \"'\":167, \"H \":168,\n\t\t\"+\":171, \";\":187, \"<\":188, \"=\":189, \">\":190, \"?\":191, \"{\":223\n\t});\n\tvar sylk_char_regex = new RegExp(\"\\u001BN(\" + keys(sylk_escapes).join(\"|\").replace(/\\|\\|\\|/, \"|\\\\||\").replace(/([?()+])/g,\"\\\\$1\") + \"|\\\\|)\", \"gm\");\n\tvar sylk_char_fn = function(_, $1){ var o = sylk_escapes[$1]; return typeof o == \"number\" ? _getansi(o) : o; };\n\tvar decode_sylk_char = function($$, $1, $2) { var newcc = (($1.charCodeAt(0) - 0x20)<<4) | ($2.charCodeAt(0) - 0x30); return newcc == 59 ? $$ : _getansi(newcc); };\n\tsylk_escapes[\"|\"] = 254;\n\t/* TODO: find an actual specification */\n\tfunction sylk_to_aoa(d, opts) {\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': return sylk_to_aoa_str(Base64_decode(d), opts);\n\t\t\tcase 'binary': return sylk_to_aoa_str(d, opts);\n\t\t\tcase 'buffer': return sylk_to_aoa_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n\t\t\tcase 'array': return sylk_to_aoa_str(cc2str(d), opts);\n\t\t}\n\t\tthrow new Error(\"Unrecognized type \" + opts.type);\n\t}\n\tfunction sylk_to_aoa_str(str, opts) {\n\t\tvar records = str.split(/[\\n\\r]+/), R = -1, C = -1, ri = 0, rj = 0, arr = [];\n\t\tvar formats = [];\n\t\tvar next_cell_format = null;\n\t\tvar sht = {}, rowinfo = [], colinfo = [], cw = [];\n\t\tvar Mval = 0, j;\n\t\tif(+opts.codepage >= 0) set_cp(+opts.codepage);\n\t\tfor (; ri !== records.length; ++ri) {\n\t\t\tMval = 0;\n\t\t\tvar rstr=records[ri].trim().replace(/\\x1B([\\x20-\\x2F])([\\x30-\\x3F])/g, decode_sylk_char).replace(sylk_char_regex, sylk_char_fn);\n\t\t\tvar record=rstr.replace(/;;/g, \"\\u0000\").split(\";\").map(function(x) { return x.replace(/\\u0000/g, \";\"); });\n\t\t\tvar RT=record[0], val;\n\t\t\tif(rstr.length > 0) switch(RT) {\n\t\t\tcase 'ID': break; /* header */\n\t\t\tcase 'E': break; /* EOF */\n\t\t\tcase 'B': break; /* dimensions */\n\t\t\tcase 'O': break; /* options? */\n\t\t\tcase 'W': break; /* window? */\n\t\t\tcase 'P':\n\t\t\t\tif(record[1].charAt(0) == 'P')\n\t\t\t\t\tformats.push(rstr.slice(3).replace(/;;/g, \";\"));\n\t\t\t\tbreak;\n\t\t\tcase 'C':\n\t\t\tvar C_seen_K = false, C_seen_X = false, C_seen_S = false, C_seen_E = false, _R = -1, _C = -1;\n\t\t\tfor(rj=1; rj<record.length; ++rj) switch(record[rj].charAt(0)) {\n\t\t\t\tcase 'A': break; // TODO: comment\n\t\t\t\tcase 'X': C = parseInt(record[rj].slice(1))-1; C_seen_X = true; break;\n\t\t\t\tcase 'Y':\n\t\t\t\t\tR = parseInt(record[rj].slice(1))-1; if(!C_seen_X) C = 0;\n\t\t\t\t\tfor(j = arr.length; j <= R; ++j) arr[j] = [];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'K':\n\t\t\t\t\tval = record[rj].slice(1);\n\t\t\t\t\tif(val.charAt(0) === '\"') val = val.slice(1,val.length - 1);\n\t\t\t\t\telse if(val === 'TRUE') val = true;\n\t\t\t\t\telse if(val === 'FALSE') val = false;\n\t\t\t\t\telse if(!isNaN(fuzzynum(val))) {\n\t\t\t\t\t\tval = fuzzynum(val);\n\t\t\t\t\t\tif(next_cell_format !== null && fmt_is_date(next_cell_format)) val = numdate(val);\n\t\t\t\t\t} else if(!isNaN(fuzzydate(val).getDate())) {\n\t\t\t\t\t\tval = parseDate(val);\n\t\t\t\t\t}\n\t\t\t\t\tif(typeof $cptable !== 'undefined' && typeof val == \"string\" && ((opts||{}).type != \"string\") && (opts||{}).codepage) val = $cptable.utils.decode(opts.codepage, val);\n\t\t\t\t\tC_seen_K = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'E':\n\t\t\t\t\tC_seen_E = true;\n\t\t\t\t\tvar formula = rc_to_a1(record[rj].slice(1), {r:R,c:C});\n\t\t\t\t\tarr[R][C] = [arr[R][C], formula];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'S':\n\t\t\t\t\tC_seen_S = true;\n\t\t\t\t\tarr[R][C] = [arr[R][C], \"S5S\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'G': break; // unknown\n\t\t\t\tcase 'R': _R = parseInt(record[rj].slice(1))-1; break;\n\t\t\t\tcase 'C': _C = parseInt(record[rj].slice(1))-1; break;\n\t\t\t\tdefault: if(opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n\t\t\t}\n\t\t\tif(C_seen_K) {\n\t\t\t\tif(arr[R][C] && arr[R][C].length == 2) arr[R][C][0] = val;\n\t\t\t\telse arr[R][C] = val;\n\t\t\t\tnext_cell_format = null;\n\t\t\t}\n\t\t\tif(C_seen_S) {\n\t\t\t\tif(C_seen_E) throw new Error(\"SYLK shared formula cannot have own formula\");\n\t\t\t\tvar shrbase = _R > -1 && arr[_R][_C];\n\t\t\t\tif(!shrbase || !shrbase[1]) throw new Error(\"SYLK shared formula cannot find base\");\n\t\t\t\tarr[R][C][1] = shift_formula_str(shrbase[1], {r: R - _R, c: C - _C});\n\t\t\t}\n\t\t\tbreak;\n\t\t\tcase 'F':\n\t\t\tvar F_seen = 0;\n\t\t\tfor(rj=1; rj<record.length; ++rj) switch(record[rj].charAt(0)) {\n\t\t\t\tcase 'X': C = parseInt(record[rj].slice(1))-1; ++F_seen; break;\n\t\t\t\tcase 'Y':\n\t\t\t\t\tR = parseInt(record[rj].slice(1))-1; /*C = 0;*/\n\t\t\t\t\tfor(j = arr.length; j <= R; ++j) arr[j] = [];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'M': Mval = parseInt(record[rj].slice(1)) / 20; break;\n\t\t\t\tcase 'F': break; /* ??? */\n\t\t\t\tcase 'G': break; /* hide grid */\n\t\t\t\tcase 'P':\n\t\t\t\t\tnext_cell_format = formats[parseInt(record[rj].slice(1))];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'S': break; /* cell style */\n\t\t\t\tcase 'D': break; /* column */\n\t\t\t\tcase 'N': break; /* font */\n\t\t\t\tcase 'W':\n\t\t\t\t\tcw = record[rj].slice(1).split(\" \");\n\t\t\t\t\tfor(j = parseInt(cw[0], 10); j <= parseInt(cw[1], 10); ++j) {\n\t\t\t\t\t\tMval = parseInt(cw[2], 10);\n\t\t\t\t\t\tcolinfo[j-1] = Mval === 0 ? {hidden:true}: {wch:Mval}; process_col(colinfo[j-1]);\n\t\t\t\t\t} break;\n\t\t\t\tcase 'C': /* default column format */\n\t\t\t\t\tC = parseInt(record[rj].slice(1))-1;\n\t\t\t\t\tif(!colinfo[C]) colinfo[C] = {};\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'R': /* row properties */\n\t\t\t\t\tR = parseInt(record[rj].slice(1))-1;\n\t\t\t\t\tif(!rowinfo[R]) rowinfo[R] = {};\n\t\t\t\t\tif(Mval > 0) { rowinfo[R].hpt = Mval; rowinfo[R].hpx = pt2px(Mval); }\n\t\t\t\t\telse if(Mval === 0) rowinfo[R].hidden = true;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault: if(opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n\t\t\t}\n\t\t\tif(F_seen < 1) next_cell_format = null; break;\n\t\t\tdefault: if(opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n\t\t\t}\n\t\t}\n\t\tif(rowinfo.length > 0) sht['!rows'] = rowinfo;\n\t\tif(colinfo.length > 0) sht['!cols'] = colinfo;\n\t\tif(opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n\t\treturn [arr, sht];\n\t}\n\n\tfunction sylk_to_sheet(d, opts) {\n\t\tvar aoasht = sylk_to_aoa(d, opts);\n\t\tvar aoa = aoasht[0], ws = aoasht[1];\n\t\tvar o = aoa_to_sheet(aoa, opts);\n\t\tkeys(ws).forEach(function(k) { o[k] = ws[k]; });\n\t\treturn o;\n\t}\n\n\tfunction sylk_to_workbook(d, opts) { return sheet_to_workbook(sylk_to_sheet(d, opts), opts); }\n\n\tfunction write_ws_cell_sylk(cell, ws, R, C) {\n\t\tvar o = \"C;Y\" + (R+1) + \";X\" + (C+1) + \";K\";\n\t\tswitch(cell.t) {\n\t\t\tcase 'n':\n\t\t\t\to += (cell.v||0);\n\t\t\t\tif(cell.f && !cell.F) o += \";E\" + a1_to_rc(cell.f, {r:R, c:C}); break;\n\t\t\tcase 'b': o += cell.v ? \"TRUE\" : \"FALSE\"; break;\n\t\t\tcase 'e': o += cell.w || cell.v; break;\n\t\t\tcase 'd': o += '\"' + (cell.w || cell.v) + '\"'; break;\n\t\t\tcase 's': o += '\"' + cell.v.replace(/\"/g,\"\").replace(/;/g, \";;\") + '\"'; break;\n\t\t}\n\t\treturn o;\n\t}\n\n\tfunction write_ws_cols_sylk(out, cols) {\n\t\tcols.forEach(function(col, i) {\n\t\t\tvar rec = \"F;W\" + (i+1) + \" \" + (i+1) + \" \";\n\t\t\tif(col.hidden) rec += \"0\";\n\t\t\telse {\n\t\t\t\tif(typeof col.width == 'number' && !col.wpx) col.wpx = width2px(col.width);\n\t\t\t\tif(typeof col.wpx == 'number' && !col.wch) col.wch = px2char(col.wpx);\n\t\t\t\tif(typeof col.wch == 'number') rec += Math.round(col.wch);\n\t\t\t}\n\t\t\tif(rec.charAt(rec.length - 1) != \" \") out.push(rec);\n\t\t});\n\t}\n\n\tfunction write_ws_rows_sylk(out, rows) {\n\t\trows.forEach(function(row, i) {\n\t\t\tvar rec = \"F;\";\n\t\t\tif(row.hidden) rec += \"M0;\";\n\t\t\telse if(row.hpt) rec += \"M\" + 20 * row.hpt + \";\";\n\t\t\telse if(row.hpx) rec += \"M\" + 20 * px2pt(row.hpx) + \";\";\n\t\t\tif(rec.length > 2) out.push(rec + \"R\" + (i+1));\n\t\t});\n\t}\n\n\tfunction sheet_to_sylk(ws, opts) {\n\t\tvar preamble = [\"ID;PWXL;N;E\"], o = [];\n\t\tvar r = safe_decode_range(ws['!ref']), cell;\n\t\tvar dense = Array.isArray(ws);\n\t\tvar RS = \"\\r\\n\";\n\n\t\tpreamble.push(\"P;PGeneral\");\n\t\tpreamble.push(\"F;P0;DG0G8;M255\");\n\t\tif(ws['!cols']) write_ws_cols_sylk(preamble, ws['!cols']);\n\t\tif(ws['!rows']) write_ws_rows_sylk(preamble, ws['!rows']);\n\n\t\tpreamble.push(\"B;Y\" + (r.e.r - r.s.r + 1) + \";X\" + (r.e.c - r.s.c + 1) + \";D\" + [r.s.c,r.s.r,r.e.c,r.e.r].join(\" \"));\n\t\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\t\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tvar coord = encode_cell({r:R,c:C});\n\t\t\t\tcell = dense ? (ws[R]||[])[C]: ws[coord];\n\t\t\t\tif(!cell || (cell.v == null && (!cell.f || cell.F))) continue;\n\t\t\t\to.push(write_ws_cell_sylk(cell, ws, R, C, opts));\n\t\t\t}\n\t\t}\n\t\treturn preamble.join(RS) + RS + o.join(RS) + RS + \"E\" + RS;\n\t}\n\n\treturn {\n\t\tto_workbook: sylk_to_workbook,\n\t\tto_sheet: sylk_to_sheet,\n\t\tfrom_sheet: sheet_to_sylk\n\t};\n})();\n\nvar DIF = (function() {\n\tfunction dif_to_aoa(d, opts) {\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': return dif_to_aoa_str(Base64_decode(d), opts);\n\t\t\tcase 'binary': return dif_to_aoa_str(d, opts);\n\t\t\tcase 'buffer': return dif_to_aoa_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n\t\t\tcase 'array': return dif_to_aoa_str(cc2str(d), opts);\n\t\t}\n\t\tthrow new Error(\"Unrecognized type \" + opts.type);\n\t}\n\tfunction dif_to_aoa_str(str, opts) {\n\t\tvar records = str.split('\\n'), R = -1, C = -1, ri = 0, arr = [];\n\t\tfor (; ri !== records.length; ++ri) {\n\t\t\tif (records[ri].trim() === 'BOT') { arr[++R] = []; C = 0; continue; }\n\t\t\tif (R < 0) continue;\n\t\t\tvar metadata = records[ri].trim().split(\",\");\n\t\t\tvar type = metadata[0], value = metadata[1];\n\t\t\t++ri;\n\t\t\tvar data = records[ri] || \"\";\n\t\t\twhile(((data.match(/[\"]/g)||[]).length & 1) && ri < records.length - 1) data += \"\\n\" + records[++ri];\n\t\t\tdata = data.trim();\n\t\t\tswitch (+type) {\n\t\t\t\tcase -1:\n\t\t\t\t\tif (data === 'BOT') { arr[++R] = []; C = 0; continue; }\n\t\t\t\t\telse if (data !== 'EOD') throw new Error(\"Unrecognized DIF special command \" + data);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0:\n\t\t\t\t\tif(data === 'TRUE') arr[R][C] = true;\n\t\t\t\t\telse if(data === 'FALSE') arr[R][C] = false;\n\t\t\t\t\telse if(!isNaN(fuzzynum(value))) arr[R][C] = fuzzynum(value);\n\t\t\t\t\telse if(!isNaN(fuzzydate(value).getDate())) arr[R][C] = parseDate(value);\n\t\t\t\t\telse arr[R][C] = value;\n\t\t\t\t\t++C; break;\n\t\t\t\tcase 1:\n\t\t\t\t\tdata = data.slice(1,data.length-1);\n\t\t\t\t\tdata = data.replace(/\"\"/g, '\"');\n\t\t\t\t\tif(DIF_XL && data && data.match(/^=\".*\"$/)) data = data.slice(2, -1);\n\t\t\t\t\tarr[R][C++] = data !== '' ? data : null;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (data === 'EOD') break;\n\t\t}\n\t\tif(opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n\t\treturn arr;\n\t}\n\n\tfunction dif_to_sheet(str, opts) { return aoa_to_sheet(dif_to_aoa(str, opts), opts); }\n\tfunction dif_to_workbook(str, opts) { return sheet_to_workbook(dif_to_sheet(str, opts), opts); }\n\n\tvar sheet_to_dif = (function() {\n\t\tvar push_field = function pf(o, topic, v, n, s) {\n\t\t\to.push(topic);\n\t\t\to.push(v + \",\" + n);\n\t\t\to.push('\"' + s.replace(/\"/g,'\"\"') + '\"');\n\t\t};\n\t\tvar push_value = function po(o, type, v, s) {\n\t\t\to.push(type + \",\" + v);\n\t\t\to.push(type == 1 ? '\"' + s.replace(/\"/g,'\"\"') + '\"' : s);\n\t\t};\n\t\treturn function sheet_to_dif(ws) {\n\t\t\tvar o = [];\n\t\t\tvar r = safe_decode_range(ws['!ref']), cell;\n\t\t\tvar dense = Array.isArray(ws);\n\t\t\tpush_field(o, \"TABLE\", 0, 1, \"sheetjs\");\n\t\t\tpush_field(o, \"VECTORS\", 0, r.e.r - r.s.r + 1,\"\");\n\t\t\tpush_field(o, \"TUPLES\", 0, r.e.c - r.s.c + 1,\"\");\n\t\t\tpush_field(o, \"DATA\", 0, 0,\"\");\n\t\t\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\t\t\tpush_value(o, -1, 0, \"BOT\");\n\t\t\t\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\t\tvar coord = encode_cell({r:R,c:C});\n\t\t\t\t\tcell = dense ? (ws[R]||[])[C] : ws[coord];\n\t\t\t\t\tif(!cell) { push_value(o, 1, 0, \"\"); continue;}\n\t\t\t\t\tswitch(cell.t) {\n\t\t\t\t\t\tcase 'n':\n\t\t\t\t\t\t\tvar val = DIF_XL ? cell.w : cell.v;\n\t\t\t\t\t\t\tif(!val && cell.v != null) val = cell.v;\n\t\t\t\t\t\t\tif(val == null) {\n\t\t\t\t\t\t\t\tif(DIF_XL && cell.f && !cell.F) push_value(o, 1, 0, \"=\" + cell.f);\n\t\t\t\t\t\t\t\telse push_value(o, 1, 0, \"\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse push_value(o, 0, val, \"V\");\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'b':\n\t\t\t\t\t\t\tpush_value(o, 0, cell.v ? 1 : 0, cell.v ? \"TRUE\" : \"FALSE\");\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 's':\n\t\t\t\t\t\t\tpush_value(o, 1, 0, (!DIF_XL || isNaN(cell.v)) ? cell.v : '=\"' + cell.v + '\"');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'd':\n\t\t\t\t\t\t\tif(!cell.w) cell.w = SSF_format(cell.z || table_fmt[14], datenum(parseDate(cell.v)));\n\t\t\t\t\t\t\tif(DIF_XL) push_value(o, 0, cell.w, \"V\");\n\t\t\t\t\t\t\telse push_value(o, 1, 0, cell.w);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault: push_value(o, 1, 0, \"\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tpush_value(o, -1, 0, \"EOD\");\n\t\t\tvar RS = \"\\r\\n\";\n\t\t\tvar oo = o.join(RS);\n\t\t\t//while((oo.length & 0x7F) != 0) oo += \"\\0\";\n\t\t\treturn oo;\n\t\t};\n\t})();\n\treturn {\n\t\tto_workbook: dif_to_workbook,\n\t\tto_sheet: dif_to_sheet,\n\t\tfrom_sheet: sheet_to_dif\n\t};\n})();\n\nvar ETH = (function() {\n\tfunction decode(s) { return s.replace(/\\\\b/g,\"\\\\\").replace(/\\\\c/g,\":\").replace(/\\\\n/g,\"\\n\"); }\n\tfunction encode(s) { return s.replace(/\\\\/g, \"\\\\b\").replace(/:/g, \"\\\\c\").replace(/\\n/g,\"\\\\n\"); }\n\n\tfunction eth_to_aoa(str, opts) {\n\t\tvar records = str.split('\\n'), R = -1, C = -1, ri = 0, arr = [];\n\t\tfor (; ri !== records.length; ++ri) {\n\t\t\tvar record = records[ri].trim().split(\":\");\n\t\t\tif(record[0] !== 'cell') continue;\n\t\t\tvar addr = decode_cell(record[1]);\n\t\t\tif(arr.length <= addr.r) for(R = arr.length; R <= addr.r; ++R) if(!arr[R]) arr[R] = [];\n\t\t\tR = addr.r; C = addr.c;\n\t\t\tswitch(record[2]) {\n\t\t\t\tcase 't': arr[R][C] = decode(record[3]); break;\n\t\t\t\tcase 'v': arr[R][C] = +record[3]; break;\n\t\t\t\tcase 'vtf': var _f = record[record.length - 1];\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 'vtc':\n\t\t\t\t\tswitch(record[3]) {\n\t\t\t\t\t\tcase 'nl': arr[R][C] = +record[4] ? true : false; break;\n\t\t\t\t\t\tdefault: arr[R][C] = +record[4]; break;\n\t\t\t\t\t}\n\t\t\t\t\tif(record[2] == 'vtf') arr[R][C] = [arr[R][C], _f];\n\t\t\t}\n\t\t}\n\t\tif(opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n\t\treturn arr;\n\t}\n\n\tfunction eth_to_sheet(d, opts) { return aoa_to_sheet(eth_to_aoa(d, opts), opts); }\n\tfunction eth_to_workbook(d, opts) { return sheet_to_workbook(eth_to_sheet(d, opts), opts); }\n\n\tvar header = [\n\t\t\"socialcalc:version:1.5\",\n\t\t\"MIME-Version: 1.0\",\n\t\t\"Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave\"\n\t].join(\"\\n\");\n\n\tvar sep = [\n\t\t\"--SocialCalcSpreadsheetControlSave\",\n\t\t\"Content-type: text/plain; charset=UTF-8\"\n\t].join(\"\\n\") + \"\\n\";\n\n\t/* TODO: the other parts */\n\tvar meta = [\n\t\t\"# SocialCalc Spreadsheet Control Save\",\n\t\t\"part:sheet\"\n\t].join(\"\\n\");\n\n\tvar end = \"--SocialCalcSpreadsheetControlSave--\";\n\n\tfunction sheet_to_eth_data(ws) {\n\t\tif(!ws || !ws['!ref']) return \"\";\n\t\tvar o = [], oo = [], cell, coord = \"\";\n\t\tvar r = decode_range(ws['!ref']);\n\t\tvar dense = Array.isArray(ws);\n\t\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\t\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tcoord = encode_cell({r:R,c:C});\n\t\t\t\tcell = dense ? (ws[R]||[])[C] : ws[coord];\n\t\t\t\tif(!cell || cell.v == null || cell.t === 'z') continue;\n\t\t\t\too = [\"cell\", coord, 't'];\n\t\t\t\tswitch(cell.t) {\n\t\t\t\t\tcase 's': case 'str': oo.push(encode(cell.v)); break;\n\t\t\t\t\tcase 'n':\n\t\t\t\t\t\tif(!cell.f) { oo[2]='v'; oo[3]=cell.v; }\n\t\t\t\t\t\telse { oo[2]='vtf'; oo[3]='n'; oo[4]=cell.v; oo[5]=encode(cell.f); }\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'b':\n\t\t\t\t\t\too[2] = 'vt'+(cell.f?'f':'c'); oo[3]='nl'; oo[4]=cell.v?\"1\":\"0\";\n\t\t\t\t\t\too[5] = encode(cell.f||(cell.v?'TRUE':'FALSE'));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'd':\n\t\t\t\t\t\tvar t = datenum(parseDate(cell.v));\n\t\t\t\t\t\too[2] = 'vtc'; oo[3] = 'nd'; oo[4] = \"\"+t;\n\t\t\t\t\t\too[5] = cell.w || SSF_format(cell.z || table_fmt[14], t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'e': continue;\n\t\t\t\t}\n\t\t\t\to.push(oo.join(\":\"));\n\t\t\t}\n\t\t}\n\t\to.push(\"sheet:c:\" + (r.e.c-r.s.c+1) + \":r:\" + (r.e.r-r.s.r+1) + \":tvf:1\");\n\t\to.push(\"valueformat:1:text-wiki\");\n\t\t//o.push(\"copiedfrom:\" + ws['!ref']); // clipboard only\n\t\treturn o.join(\"\\n\");\n\t}\n\n\tfunction sheet_to_eth(ws) {\n\t\treturn [header, sep, meta, sep, sheet_to_eth_data(ws), end].join(\"\\n\");\n\t\t// return [\"version:1.5\", sheet_to_eth_data(ws)].join(\"\\n\"); // clipboard form\n\t}\n\n\treturn {\n\t\tto_workbook: eth_to_workbook,\n\t\tto_sheet: eth_to_sheet,\n\t\tfrom_sheet: sheet_to_eth\n\t};\n})();\n\nvar PRN = (function() {\n\tfunction set_text_arr(data, arr, R, C, o) {\n\t\tif(o.raw) arr[R][C] = data;\n\t\telse if(data === \"\"){/* empty */}\n\t\telse if(data === 'TRUE') arr[R][C] = true;\n\t\telse if(data === 'FALSE') arr[R][C] = false;\n\t\telse if(!isNaN(fuzzynum(data))) arr[R][C] = fuzzynum(data);\n\t\telse if(!isNaN(fuzzydate(data).getDate())) arr[R][C] = parseDate(data);\n\t\telse arr[R][C] = data;\n\t}\n\n\tfunction prn_to_aoa_str(f, opts) {\n\t\tvar o = opts || {};\n\t\tvar arr = ([]);\n\t\tif(!f || f.length === 0) return arr;\n\t\tvar lines = f.split(/[\\r\\n]/);\n\t\tvar L = lines.length - 1;\n\t\twhile(L >= 0 && lines[L].length === 0) --L;\n\t\tvar start = 10, idx = 0;\n\t\tvar R = 0;\n\t\tfor(; R <= L; ++R) {\n\t\t\tidx = lines[R].indexOf(\" \");\n\t\t\tif(idx == -1) idx = lines[R].length; else idx++;\n\t\t\tstart = Math.max(start, idx);\n\t\t}\n\t\tfor(R = 0; R <= L; ++R) {\n\t\t\tarr[R] = [];\n\t\t\t/* TODO: confirm that widths are always 10 */\n\t\t\tvar C = 0;\n\t\t\tset_text_arr(lines[R].slice(0, start).trim(), arr, R, C, o);\n\t\t\tfor(C = 1; C <= (lines[R].length - start)/10 + 1; ++C)\n\t\t\t\tset_text_arr(lines[R].slice(start+(C-1)*10,start+C*10).trim(),arr,R,C,o);\n\t\t}\n\t\tif(o.sheetRows) arr = arr.slice(0, o.sheetRows);\n\t\treturn arr;\n\t}\n\n\t// List of accepted CSV separators\n\tvar guess_seps = {\n0x2C: ',',\n0x09: \"\\t\",\n0x3B: ';',\n0x7C: '|'\n\t};\n\n\t// CSV separator weights to be used in case of equal numbers\n\tvar guess_sep_weights = {\n0x2C: 3,\n0x09: 2,\n0x3B: 1,\n0x7C: 0\n\t};\n\n\tfunction guess_sep(str) {\n\t\tvar cnt = {}, instr = false, end = 0, cc = 0;\n\t\tfor(;end < str.length;++end) {\n\t\t\tif((cc=str.charCodeAt(end)) == 0x22) instr = !instr;\n\t\t\telse if(!instr && cc in guess_seps) cnt[cc] = (cnt[cc]||0)+1;\n\t\t}\n\n\t\tcc = [];\n\t\tfor(end in cnt) if ( Object.prototype.hasOwnProperty.call(cnt, end) ) {\n\t\t\tcc.push([ cnt[end], end ]);\n\t\t}\n\n\t\tif ( !cc.length ) {\n\t\t\tcnt = guess_sep_weights;\n\t\t\tfor(end in cnt) if ( Object.prototype.hasOwnProperty.call(cnt, end) ) {\n\t\t\t\tcc.push([ cnt[end], end ]);\n\t\t\t}\n\t\t}\n\n\t\tcc.sort(function(a, b) { return a[0] - b[0] || guess_sep_weights[a[1]] - guess_sep_weights[b[1]]; });\n\n\t\treturn guess_seps[cc.pop()[1]] || 0x2C;\n\t}\n\n\tfunction dsv_to_sheet_str(str, opts) {\n\t\tvar o = opts || {};\n\t\tvar sep = \"\";\n\t\tif(DENSE != null && o.dense == null) o.dense = DENSE;\n\t\tvar ws = o.dense ? ([]) : ({});\n\t\tvar range = ({s: {c:0, r:0}, e: {c:0, r:0}});\n\n\t\tif(str.slice(0,4) == \"sep=\") {\n\t\t\t// If the line ends in \\r\\n\n\t\t\tif(str.charCodeAt(5) == 13 && str.charCodeAt(6) == 10 ) {\n\t\t\t\tsep = str.charAt(4); str = str.slice(7);\n\t\t\t}\n\t\t\t// If line ends in \\r OR \\n\n\t\t\telse if(str.charCodeAt(5) == 13 || str.charCodeAt(5) == 10 ) {\n\t\t\t\tsep = str.charAt(4); str = str.slice(6);\n\t\t\t}\n\t\t\telse sep = guess_sep(str.slice(0,1024));\n\t\t}\n\t\telse if(o && o.FS) sep = o.FS;\n\t\telse sep = guess_sep(str.slice(0,1024));\n\t\tvar R = 0, C = 0, v = 0;\n\t\tvar start = 0, end = 0, sepcc = sep.charCodeAt(0), instr = false, cc=0, startcc=str.charCodeAt(0);\n\t\tstr = str.replace(/\\r\\n/mg, \"\\n\");\n\t\tvar _re = o.dateNF != null ? dateNF_regex(o.dateNF) : null;\n\t\tfunction finish_cell() {\n\t\t\tvar s = str.slice(start, end);\n\t\t\tvar cell = ({});\n\t\t\tif(s.charAt(0) == '\"' && s.charAt(s.length - 1) == '\"') s = s.slice(1,-1).replace(/\"\"/g,'\"');\n\t\t\tif(s.length === 0) cell.t = 'z';\n\t\t\telse if(o.raw) { cell.t = 's'; cell.v = s; }\n\t\t\telse if(s.trim().length === 0) { cell.t = 's'; cell.v = s; }\n\t\t\telse if(s.charCodeAt(0) == 0x3D) {\n\t\t\t\tif(s.charCodeAt(1) == 0x22 && s.charCodeAt(s.length - 1) == 0x22) { cell.t = 's'; cell.v = s.slice(2,-1).replace(/\"\"/g,'\"'); }\n\t\t\t\telse if(fuzzyfmla(s)) { cell.t = 'n'; cell.f = s.slice(1); }\n\t\t\t\telse { cell.t = 's'; cell.v = s; } }\n\t\t\telse if(s == \"TRUE\") { cell.t = 'b'; cell.v = true; }\n\t\t\telse if(s == \"FALSE\") { cell.t = 'b'; cell.v = false; }\n\t\t\telse if(!isNaN(v = fuzzynum(s))) { cell.t = 'n'; if(o.cellText !== false) cell.w = s; cell.v = v; }\n\t\t\telse if(!isNaN(fuzzydate(s).getDate()) || _re && s.match(_re)) {\n\t\t\t\tcell.z = o.dateNF || table_fmt[14];\n\t\t\t\tvar k = 0;\n\t\t\t\tif(_re && s.match(_re)){ s=dateNF_fix(s, o.dateNF, (s.match(_re)||[])); k=1; }\n\t\t\t\tif(o.cellDates) { cell.t = 'd'; cell.v = parseDate(s, k); }\n\t\t\t\telse { cell.t = 'n'; cell.v = datenum(parseDate(s, k)); }\n\t\t\t\tif(o.cellText !== false) cell.w = SSF_format(cell.z, cell.v instanceof Date ? datenum(cell.v):cell.v);\n\t\t\t\tif(!o.cellNF) delete cell.z;\n\t\t\t} else {\n\t\t\t\tcell.t = 's';\n\t\t\t\tcell.v = s;\n\t\t\t}\n\t\t\tif(cell.t == 'z'){}\n\t\t\telse if(o.dense) { if(!ws[R]) ws[R] = []; ws[R][C] = cell; }\n\t\t\telse ws[encode_cell({c:C,r:R})] = cell;\n\t\t\tstart = end+1; startcc = str.charCodeAt(start);\n\t\t\tif(range.e.c < C) range.e.c = C;\n\t\t\tif(range.e.r < R) range.e.r = R;\n\t\t\tif(cc == sepcc) ++C; else { C = 0; ++R; if(o.sheetRows && o.sheetRows <= R) return true; }\n\t\t}\n\t\touter: for(;end < str.length;++end) switch((cc=str.charCodeAt(end))) {\n\t\t\tcase 0x22: if(startcc === 0x22) instr = !instr; break;\n\t\t\tcase sepcc: case 0x0a: case 0x0d: if(!instr && finish_cell()) break outer; break;\n\t\t\tdefault: break;\n\t\t}\n\t\tif(end - start > 0) finish_cell();\n\n\t\tws['!ref'] = encode_range(range);\n\t\treturn ws;\n\t}\n\n\tfunction prn_to_sheet_str(str, opts) {\n\t\tif(!(opts && opts.PRN)) return dsv_to_sheet_str(str, opts);\n\t\tif(opts.FS) return dsv_to_sheet_str(str, opts);\n\t\tif(str.slice(0,4) == \"sep=\") return dsv_to_sheet_str(str, opts);\n\t\tif(str.indexOf(\"\\t\") >= 0 || str.indexOf(\",\") >= 0 || str.indexOf(\";\") >= 0) return dsv_to_sheet_str(str, opts);\n\t\treturn aoa_to_sheet(prn_to_aoa_str(str, opts), opts);\n\t}\n\n\tfunction prn_to_sheet(d, opts) {\n\t\tvar str = \"\", bytes = opts.type == 'string' ? [0,0,0,0] : firstbyte(d, opts);\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': str = Base64_decode(d); break;\n\t\t\tcase 'binary': str = d; break;\n\t\t\tcase 'buffer':\n\t\t\t\tif(opts.codepage == 65001) str = d.toString('utf8'); // TODO: test if buf\n\t\t\t\telse if(opts.codepage && typeof $cptable !== 'undefined') str = $cptable.utils.decode(opts.codepage, d);\n\t\t\t\telse str = has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d);\n\t\t\t\tbreak;\n\t\t\tcase 'array': str = cc2str(d); break;\n\t\t\tcase 'string': str = d; break;\n\t\t\tdefault: throw new Error(\"Unrecognized type \" + opts.type);\n\t\t}\n\t\tif(bytes[0] == 0xEF && bytes[1] == 0xBB && bytes[2] == 0xBF) str = utf8read(str.slice(3));\n\t\telse if(opts.type != 'string' && opts.type != 'buffer' && opts.codepage == 65001) str = utf8read(str);\n\t\telse if((opts.type == 'binary') && typeof $cptable !== 'undefined' && opts.codepage)  str = $cptable.utils.decode(opts.codepage, $cptable.utils.encode(28591,str));\n\t\tif(str.slice(0,19) == \"socialcalc:version:\") return ETH.to_sheet(opts.type == 'string' ? str : utf8read(str), opts);\n\t\treturn prn_to_sheet_str(str, opts);\n\t}\n\n\tfunction prn_to_workbook(d, opts) { return sheet_to_workbook(prn_to_sheet(d, opts), opts); }\n\n\tfunction sheet_to_prn(ws) {\n\t\tvar o = [];\n\t\tvar r = safe_decode_range(ws['!ref']), cell;\n\t\tvar dense = Array.isArray(ws);\n\t\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\t\tvar oo = [];\n\t\t\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tvar coord = encode_cell({r:R,c:C});\n\t\t\t\tcell = dense ? (ws[R]||[])[C] : ws[coord];\n\t\t\t\tif(!cell || cell.v == null) { oo.push(\"          \"); continue; }\n\t\t\t\tvar w = (cell.w || (format_cell(cell), cell.w) || \"\").slice(0,10);\n\t\t\t\twhile(w.length < 10) w += \" \";\n\t\t\t\too.push(w + (C === 0 ? \" \" : \"\"));\n\t\t\t}\n\t\t\to.push(oo.join(\"\"));\n\t\t}\n\t\treturn o.join(\"\\n\");\n\t}\n\n\treturn {\n\t\tto_workbook: prn_to_workbook,\n\t\tto_sheet: prn_to_sheet,\n\t\tfrom_sheet: sheet_to_prn\n\t};\n})();\n\n/* Excel defaults to SYLK but warns if data is not valid */\nfunction read_wb_ID(d, opts) {\n\tvar o = opts || {}, OLD_WTF = !!o.WTF; o.WTF = true;\n\ttry {\n\t\tvar out = SYLK.to_workbook(d, o);\n\t\to.WTF = OLD_WTF;\n\t\treturn out;\n\t} catch(e) {\n\t\to.WTF = OLD_WTF;\n\t\tif(!e.message.match(/SYLK bad record ID/) && OLD_WTF) throw e;\n\t\treturn PRN.to_workbook(d, opts);\n\t}\n}\n\nvar WK_ = (function() {\n\tfunction lotushopper(data, cb, opts) {\n\t\tif(!data) return;\n\t\tprep_blob(data, data.l || 0);\n\t\tvar Enum = opts.Enum || WK1Enum;\n\t\twhile(data.l < data.length) {\n\t\t\tvar RT = data.read_shift(2);\n\t\t\tvar R = Enum[RT] || Enum[0xFFFF];\n\t\t\tvar length = data.read_shift(2);\n\t\t\tvar tgt = data.l + length;\n\t\t\tvar d = R.f && R.f(data, length, opts);\n\t\t\tdata.l = tgt;\n\t\t\tif(cb(d, R, RT)) return;\n\t\t}\n\t}\n\n\tfunction lotus_to_workbook(d, opts) {\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': return lotus_to_workbook_buf(s2a(Base64_decode(d)), opts);\n\t\t\tcase 'binary': return lotus_to_workbook_buf(s2a(d), opts);\n\t\t\tcase 'buffer':\n\t\t\tcase 'array': return lotus_to_workbook_buf(d, opts);\n\t\t}\n\t\tthrow \"Unsupported type \" + opts.type;\n\t}\n\n\tfunction lotus_to_workbook_buf(d, opts) {\n\t\tif(!d) return d;\n\t\tvar o = opts || {};\n\t\tif(DENSE != null && o.dense == null) o.dense = DENSE;\n\t\tvar s = ((o.dense ? [] : {})), n = \"Sheet1\", next_n = \"\", sidx = 0;\n\t\tvar sheets = {}, snames = [], realnames = [];\n\n\t\tvar refguess = {s: {r:0, c:0}, e: {r:0, c:0} };\n\t\tvar sheetRows = o.sheetRows || 0;\n\n\t\tif(d[2] == 0x00) {\n\t\t\tif(d[3] == 0x08 || d[3] == 0x09) {\n\t\t\t\tif(d.length >= 16 && d[14] == 0x05 && d[15] === 0x6c) throw new Error(\"Unsupported Works 3 for Mac file\");\n\t\t\t}\n\t\t}\n\n\t\tif(d[2] == 0x02) {\n\t\t\to.Enum = WK1Enum;\n\t\t\tlotushopper(d, function(val, R, RT) { switch(RT) {\n\t\t\t\tcase 0x00: /* BOF */\n\t\t\t\t\to.vers = val;\n\t\t\t\t\tif(val >= 0x1000) o.qpro = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x06: refguess = val; break; /* RANGE */\n\t\t\t\tcase 0xCC: if(val) next_n = val; break; /* SHEETNAMECS */\n\t\t\t\tcase 0xDE: next_n = val; break; /* SHEETNAMELP */\n\t\t\t\tcase 0x0F: /* LABEL */\n\t\t\t\tcase 0x33: /* STRING */\n\t\t\t\t\tif(!o.qpro) val[1].v = val[1].v.slice(1);\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 0x0D: /* INTEGER */\n\t\t\t\tcase 0x0E: /* NUMBER */\n\t\t\t\tcase 0x10: /* FORMULA */\n\t\t\t\t\t/* TODO: actual translation of the format code */\n\t\t\t\t\tif(RT == 0x0E && (val[2] & 0x70) == 0x70 && (val[2] & 0x0F) > 1 && (val[2] & 0x0F) < 15) {\n\t\t\t\t\t\tval[1].z = o.dateNF || table_fmt[14];\n\t\t\t\t\t\tif(o.cellDates) { val[1].t = 'd'; val[1].v = numdate(val[1].v); }\n\t\t\t\t\t}\n\n\t\t\t\t\tif(o.qpro) {\n\t\t\t\t\t\tif(val[3] > sidx) {\n\t\t\t\t\t\t\ts[\"!ref\"] = encode_range(refguess);\n\t\t\t\t\t\t\tsheets[n] = s;\n\t\t\t\t\t\t\tsnames.push(n);\n\t\t\t\t\t\t\ts = (o.dense ? [] : {});\n\t\t\t\t\t\t\trefguess = {s: {r:0, c:0}, e: {r:0, c:0} };\n\t\t\t\t\t\t\tsidx = val[3]; n = next_n || \"Sheet\" + (sidx + 1); next_n = \"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar tmpcell = o.dense ? (s[val[0].r]||[])[val[0].c] : s[encode_cell(val[0])];\n\t\t\t\t\tif(tmpcell) {\n\t\t\t\t\t\ttmpcell.t = val[1].t; tmpcell.v = val[1].v;\n\t\t\t\t\t\tif(val[1].z != null) tmpcell.z = val[1].z;\n\t\t\t\t\t\tif(val[1].f != null) tmpcell.f = val[1].f;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(o.dense) {\n\t\t\t\t\t\tif(!s[val[0].r]) s[val[0].r] = [];\n\t\t\t\t\t\ts[val[0].r][val[0].c] = val[1];\n\t\t\t\t\t} else s[encode_cell(val[0])] = val[1];\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t}}, o);\n\t\t} else if(d[2] == 0x1A || d[2] == 0x0E) {\n\t\t\to.Enum = WK3Enum;\n\t\t\tif(d[2] == 0x0E) { o.qpro = true; d.l = 0; }\n\t\t\tlotushopper(d, function(val, R, RT) { switch(RT) {\n\t\t\t\tcase 0xCC: n = val; break; /* SHEETNAMECS */\n\t\t\t\tcase 0x16: /* LABEL16 */\n\t\t\t\t\tval[1].v = val[1].v.slice(1);\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 0x17: /* NUMBER17 */\n\t\t\t\tcase 0x18: /* NUMBER18 */\n\t\t\t\tcase 0x19: /* FORMULA19 */\n\t\t\t\tcase 0x25: /* NUMBER25 */\n\t\t\t\tcase 0x27: /* NUMBER27 */\n\t\t\t\tcase 0x28: /* FORMULA28 */\n\t\t\t\t\tif(val[3] > sidx) {\n\t\t\t\t\t\ts[\"!ref\"] = encode_range(refguess);\n\t\t\t\t\t\tsheets[n] = s;\n\t\t\t\t\t\tsnames.push(n);\n\t\t\t\t\t\ts = (o.dense ? [] : {});\n\t\t\t\t\t\trefguess = {s: {r:0, c:0}, e: {r:0, c:0} };\n\t\t\t\t\t\tsidx = val[3]; n = \"Sheet\" + (sidx + 1);\n\t\t\t\t\t}\n\t\t\t\t\tif(sheetRows > 0 && val[0].r >= sheetRows) break;\n\t\t\t\t\tif(o.dense) {\n\t\t\t\t\t\tif(!s[val[0].r]) s[val[0].r] = [];\n\t\t\t\t\t\ts[val[0].r][val[0].c] = val[1];\n\t\t\t\t\t} else s[encode_cell(val[0])] = val[1];\n\t\t\t\t\tif(refguess.e.c < val[0].c) refguess.e.c = val[0].c;\n\t\t\t\t\tif(refguess.e.r < val[0].r) refguess.e.r = val[0].r;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x1B: /* XFORMAT */\n\t\t\t\t\tif(val[0x36b0]) realnames[val[0x36b0][0]] = val[0x36b0][1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0601: /* SHEETINFOQP */\n\t\t\t\t\trealnames[val[0]] = val[1]; if(val[0] == sidx) n = val[1]; break;\n\t\t\t\tdefault: break;\n\t\t\t}}, o);\n\t\t} else throw new Error(\"Unrecognized LOTUS BOF \" + d[2]);\n\t\ts[\"!ref\"] = encode_range(refguess);\n\t\tsheets[next_n || n] = s;\n\t\tsnames.push(next_n || n);\n\t\tif(!realnames.length) return { SheetNames: snames, Sheets: sheets };\n\t\tvar osheets = {}, rnames = [];\n\t\t/* TODO: verify no collisions */\n\t\tfor(var i = 0; i < realnames.length; ++i) if(sheets[snames[i]]) {\n\t\t\trnames.push(realnames[i] || snames[i]);\n\t\t\tosheets[realnames[i]] = sheets[realnames[i]] || sheets[snames[i]];\n\t\t} else {\n\t\t\trnames.push(realnames[i]);\n\t\t\tosheets[realnames[i]] = ({ \"!ref\": \"A1\" });\n\t\t}\n\t\treturn { SheetNames: rnames, Sheets: osheets };\n\t}\n\n\tfunction sheet_to_wk1(ws, opts) {\n\t\tvar o = opts || {};\n\t\tif(+o.codepage >= 0) set_cp(+o.codepage);\n\t\tif(o.type == \"string\") throw new Error(\"Cannot write WK1 to JS string\");\n\t\tvar ba = buf_array();\n\t\tvar range = safe_decode_range(ws[\"!ref\"]);\n\t\tvar dense = Array.isArray(ws);\n\t\tvar cols = [];\n\n\t\twrite_biff_rec(ba, 0x00, write_BOF_WK1(0x0406));\n\t\twrite_biff_rec(ba, 0x06, write_RANGE(range));\n\t\tvar max_R = Math.min(range.e.r, 8191);\n\t\tfor(var R = range.s.r; R <= max_R; ++R) {\n\t\t\tvar rr = encode_row(R);\n\t\t\tfor(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\t\tif(R === range.s.r) cols[C] = encode_col(C);\n\t\t\t\tvar ref = cols[C] + rr;\n\t\t\t\tvar cell = dense ? (ws[R]||[])[C] : ws[ref];\n\t\t\t\tif(!cell || cell.t == \"z\") continue;\n\t\t\t\t/* TODO: formula records */\n\t\t\t\tif(cell.t == \"n\") {\n\t\t\t\t\tif((cell.v|0)==cell.v && cell.v >= -32768 && cell.v <= 32767) write_biff_rec(ba, 0x0d, write_INTEGER(R, C, cell.v));\n\t\t\t\t\telse write_biff_rec(ba, 0x0e, write_NUMBER(R, C, cell.v));\n\t\t\t\t} else {\n\t\t\t\t\tvar str = format_cell(cell);\n\t\t\t\t\twrite_biff_rec(ba, 0x0F, write_LABEL(R, C, str.slice(0, 239)));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\twrite_biff_rec(ba, 0x01);\n\t\treturn ba.end();\n\t}\n\n\tfunction book_to_wk3(wb, opts) {\n\t\tvar o = opts || {};\n\t\tif(+o.codepage >= 0) set_cp(+o.codepage);\n\t\tif(o.type == \"string\") throw new Error(\"Cannot write WK3 to JS string\");\n\t\tvar ba = buf_array();\n\n\t\twrite_biff_rec(ba, 0x00, write_BOF_WK3(wb));\n\n\t\tfor(var i = 0, cnt = 0; i < wb.SheetNames.length; ++i) if((wb.Sheets[wb.SheetNames[i]] || {})[\"!ref\"]) write_biff_rec(ba, 0x1b, write_XFORMAT_SHEETNAME(wb.SheetNames[i], cnt++));\n\n\t\tvar wsidx = 0;\n\t\tfor(i = 0; i < wb.SheetNames.length; ++i) {\n\t\t\tvar ws = wb.Sheets[wb.SheetNames[i]];\n\t\t\tif(!ws || !ws[\"!ref\"]) continue;\n\t\t\tvar range = safe_decode_range(ws[\"!ref\"]);\n\t\t\tvar dense = Array.isArray(ws);\n\t\t\tvar cols = [];\n\t\t\tvar max_R = Math.min(range.e.r, 8191);\n\t\t\tfor(var R = range.s.r; R <= max_R; ++R) {\n\t\t\t\tvar rr = encode_row(R);\n\t\t\t\tfor(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\t\t\tif(R === range.s.r) cols[C] = encode_col(C);\n\t\t\t\t\tvar ref = cols[C] + rr;\n\t\t\t\t\tvar cell = dense ? (ws[R]||[])[C] : ws[ref];\n\t\t\t\t\tif(!cell || cell.t == \"z\") continue;\n\t\t\t\t\t/* TODO: FORMULA19 NUMBER18 records */\n\t\t\t\t\tif(cell.t == \"n\") {\n\t\t\t\t\t\twrite_biff_rec(ba, 0x17, write_NUMBER_17(R, C, wsidx, cell.v));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar str = format_cell(cell);\n\t\t\t\t\t\t/* TODO: max len? */\n\t\t\t\t\t\twrite_biff_rec(ba, 0x16, write_LABEL_16(R, C, wsidx, str.slice(0, 239)));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t++wsidx;\n\t\t}\n\n\t\twrite_biff_rec(ba, 0x01);\n\t\treturn ba.end();\n\t}\n\n\n\tfunction write_BOF_WK1(v) {\n\t\tvar out = new_buf(2);\n\t\tout.write_shift(2, v);\n\t\treturn out;\n\t}\n\n\tfunction write_BOF_WK3(wb) {\n\t\tvar out = new_buf(26);\n\t\tout.write_shift(2, 0x1000);\n\t\tout.write_shift(2, 0x0004);\n\t\tout.write_shift(4, 0x0000);\n\t\tvar rows = 0, cols = 0, wscnt = 0;\n\t\tfor(var i = 0; i < wb.SheetNames.length; ++i) {\n\t\t\tvar name = wb.SheetNames[i];\n\t\t\tvar ws = wb.Sheets[name];\n\t\t\tif(!ws || !ws[\"!ref\"]) continue;\n\t\t\t++wscnt;\n\t\t\tvar range = decode_range(ws[\"!ref\"]);\n\t\t\tif(rows < range.e.r) rows = range.e.r;\n\t\t\tif(cols < range.e.c) cols = range.e.c;\n\t\t}\n\t\tif(rows > 8191) rows = 8191;\n\t\tout.write_shift(2, rows);\n\t\tout.write_shift(1, wscnt);\n\t\tout.write_shift(1, cols);\n\t\tout.write_shift(2, 0x00);\n\t\tout.write_shift(2, 0x00);\n\t\tout.write_shift(1, 0x01);\n\t\tout.write_shift(1, 0x02);\n\t\tout.write_shift(4, 0);\n\t\tout.write_shift(4, 0);\n\t\treturn out;\n\t}\n\n\tfunction parse_RANGE(blob, length, opts) {\n\t\tvar o = {s:{c:0,r:0},e:{c:0,r:0}};\n\t\tif(length == 8 && opts.qpro) {\n\t\t\to.s.c = blob.read_shift(1);\n\t\t\tblob.l++;\n\t\t\to.s.r = blob.read_shift(2);\n\t\t\to.e.c = blob.read_shift(1);\n\t\t\tblob.l++;\n\t\t\to.e.r = blob.read_shift(2);\n\t\t\treturn o;\n\t\t}\n\t\to.s.c = blob.read_shift(2);\n\t\to.s.r = blob.read_shift(2);\n\t\tif(length == 12 && opts.qpro) blob.l += 2;\n\t\to.e.c = blob.read_shift(2);\n\t\to.e.r = blob.read_shift(2);\n\t\tif(length == 12 && opts.qpro) blob.l += 2;\n\t\tif(o.s.c == 0xFFFF) o.s.c = o.e.c = o.s.r = o.e.r = 0;\n\t\treturn o;\n\t}\n\tfunction write_RANGE(range) {\n\t\tvar out = new_buf(8);\n\t\tout.write_shift(2, range.s.c);\n\t\tout.write_shift(2, range.s.r);\n\t\tout.write_shift(2, range.e.c);\n\t\tout.write_shift(2, range.e.r);\n\t\treturn out;\n\t}\n\n\tfunction parse_cell(blob, length, opts) {\n\t\tvar o = [{c:0,r:0}, {t:'n',v:0}, 0, 0];\n\t\tif(opts.qpro && opts.vers != 0x5120) {\n\t\t\to[0].c = blob.read_shift(1);\n\t\t\to[3] = blob.read_shift(1);\n\t\t\to[0].r = blob.read_shift(2);\n\t\t\tblob.l+=2;\n\t\t} else {\n\t\t\to[2] = blob.read_shift(1);\n\t\t\to[0].c = blob.read_shift(2); o[0].r = blob.read_shift(2);\n\t\t}\n\t\treturn o;\n\t}\n\n\tfunction parse_LABEL(blob, length, opts) {\n\t\tvar tgt = blob.l + length;\n\t\tvar o = parse_cell(blob, length, opts);\n\t\to[1].t = 's';\n\t\tif(opts.vers == 0x5120) {\n\t\t\tblob.l++;\n\t\t\tvar len = blob.read_shift(1);\n\t\t\to[1].v = blob.read_shift(len, 'utf8');\n\t\t\treturn o;\n\t\t}\n\t\tif(opts.qpro) blob.l++;\n\t\to[1].v = blob.read_shift(tgt - blob.l, 'cstr');\n\t\treturn o;\n\t}\n\tfunction write_LABEL(R, C, s) {\n\t\t/* TODO: encoding */\n\t\tvar o = new_buf(7 + s.length);\n\t\to.write_shift(1, 0xFF);\n\t\to.write_shift(2, C);\n\t\to.write_shift(2, R);\n\t\to.write_shift(1, 0x27); // ??\n\t\tfor(var i = 0; i < o.length; ++i) {\n\t\t\tvar cc = s.charCodeAt(i);\n\t\t\to.write_shift(1, cc >= 0x80 ? 0x5F : cc);\n\t\t}\n\t\to.write_shift(1, 0);\n\t\treturn o;\n\t}\n\n\tfunction parse_INTEGER(blob, length, opts) {\n\t\tvar o = parse_cell(blob, length, opts);\n\t\to[1].v = blob.read_shift(2, 'i');\n\t\treturn o;\n\t}\n\tfunction write_INTEGER(R, C, v) {\n\t\tvar o = new_buf(7);\n\t\to.write_shift(1, 0xFF);\n\t\to.write_shift(2, C);\n\t\to.write_shift(2, R);\n\t\to.write_shift(2, v, 'i');\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER(blob, length, opts) {\n\t\tvar o = parse_cell(blob, length, opts);\n\t\to[1].v = blob.read_shift(8, 'f');\n\t\treturn o;\n\t}\n\tfunction write_NUMBER(R, C, v) {\n\t\tvar o = new_buf(13);\n\t\to.write_shift(1, 0xFF);\n\t\to.write_shift(2, C);\n\t\to.write_shift(2, R);\n\t\to.write_shift(8, v, 'f');\n\t\treturn o;\n\t}\n\n\tfunction parse_FORMULA(blob, length, opts) {\n\t\tvar tgt = blob.l + length;\n\t\tvar o = parse_cell(blob, length, opts);\n\t\t/* TODO: formula */\n\t\to[1].v = blob.read_shift(8, 'f');\n\t\tif(opts.qpro) blob.l = tgt;\n\t\telse {\n\t\t\tvar flen = blob.read_shift(2);\n\t\t\twk1_fmla_to_csf(blob.slice(blob.l, blob.l + flen), o);\n\t\t\tblob.l += flen;\n\t\t}\n\t\treturn o;\n\t}\n\n\tfunction wk1_parse_rc(B, V, col) {\n\t\tvar rel = V & 0x8000;\n\t\tV &= ~0x8000;\n\t\tV = (rel ? B : 0) + ((V >= 0x2000) ? V - 0x4000 : V);\n\t\treturn (rel ? \"\" : \"$\") + (col ? encode_col(V) : encode_row(V));\n\t}\n\t/* var oprec = [\n\t\t8, 8, 8, 8, 8, 8, 8, 8, 6, 4, 4, 5, 5, 7, 3, 3,\n\t\t3, 3, 3, 3, 1, 1, 2, 6, 8, 8, 8, 8, 8, 8, 8, 8\n\t]; */\n\t/* TODO: flesh out */\n\tvar FuncTab = {\n\t\t0x33: [\"FALSE\", 0],\n\t\t0x34: [\"TRUE\", 0],\n\t\t0x46: [\"LEN\", 1],\n\t\t0x50: [\"SUM\", 69],\n\t\t0x51: [\"AVERAGEA\", 69],\n\t\t0x52: [\"COUNTA\", 69],\n\t\t0x53: [\"MINA\", 69],\n\t\t0x54: [\"MAXA\", 69],\n\t\t0x6F: [\"T\", 1]\n\t};\n\tvar BinOpTab = [\n\t\t  \"\",   \"\",   \"\",   \"\",   \"\",   \"\",   \"\",   \"\", // eslint-disable-line no-mixed-spaces-and-tabs\n\t\t  \"\",  \"+\",  \"-\",  \"*\",  \"/\",  \"^\",  \"=\", \"<>\", // eslint-disable-line no-mixed-spaces-and-tabs\n\t\t\"<=\", \">=\",  \"<\",  \">\",   \"\",   \"\",   \"\",   \"\", // eslint-disable-line no-mixed-spaces-and-tabs\n\t\t \"&\",   \"\",   \"\",   \"\",   \"\",   \"\",   \"\",   \"\"  // eslint-disable-line no-mixed-spaces-and-tabs\n\t];\n\n\tfunction wk1_fmla_to_csf(blob, o) {\n\t\tprep_blob(blob, 0);\n\t\tvar out = [], argc = 0, R = \"\", C = \"\", argL = \"\", argR = \"\";\n\t\twhile(blob.l < blob.length) {\n\t\t\tvar cc = blob[blob.l++];\n\t\t\tswitch(cc) {\n\t\t\t\tcase 0x00: out.push(blob.read_shift(8, 'f')); break;\n\t\t\t\tcase 0x01: {\n\t\t\t\t\tC = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n\t\t\t\t\tR = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n\t\t\t\t\tout.push(C + R);\n\t\t\t\t} break;\n\t\t\t\tcase 0x02: {\n\t\t\t\t\tvar c = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n\t\t\t\t\tvar r = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n\t\t\t\t\tC = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n\t\t\t\t\tR = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n\t\t\t\t\tout.push(c + r + \":\" + C + R);\n\t\t\t\t} break;\n\t\t\t\tcase 0x03:\n\t\t\t\t\tif(blob.l < blob.length) { console.error(\"WK1 premature formula end\"); return; }\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x04: out.push(\"(\" + out.pop() + \")\"); break;\n\t\t\t\tcase 0x05: out.push(blob.read_shift(2)); break;\n\t\t\t\tcase 0x06: {\n\t\t\t\t\t/* TODO: text encoding */\n\t\t\t\t\tvar Z = \"\"; while((cc = blob[blob.l++])) Z += String.fromCharCode(cc);\n\t\t\t\t\tout.push('\"' + Z.replace(/\"/g, '\"\"') + '\"');\n\t\t\t\t} break;\n\n\t\t\t\tcase 0x08: out.push(\"-\" + out.pop()); break;\n\t\t\t\tcase 0x17: out.push(\"+\" + out.pop()); break;\n\t\t\t\tcase 0x16: out.push(\"NOT(\" + out.pop() + \")\"); break;\n\n\t\t\t\tcase 0x14: case 0x15: {\n\t\t\t\t\targR = out.pop(); argL = out.pop();\n\t\t\t\t\tout.push([\"AND\", \"OR\"][cc - 0x14] + \"(\" + argL + \",\" + argR + \")\");\n\t\t\t\t} break;\n\n\t\t\t\tdefault:\n\t\t\t\t\tif(cc < 0x20 && BinOpTab[cc]) {\n\t\t\t\t\t\targR = out.pop(); argL = out.pop();\n\t\t\t\t\t\tout.push(argL + BinOpTab[cc] + argR);\n\t\t\t\t\t} else if(FuncTab[cc]) {\n\t\t\t\t\t\targc = FuncTab[cc][1];\n\t\t\t\t\t\tif(argc == 69) argc = blob[blob.l++];\n\t\t\t\t\t\tif(argc > out.length) { console.error(\"WK1 bad formula parse 0x\" + cc.toString(16) + \":|\" + out.join(\"|\") + \"|\"); return; }\n\t\t\t\t\t\tvar args = out.slice(-argc);\n\t\t\t\t\t\tout.length -= argc;\n\t\t\t\t\t\tout.push(FuncTab[cc][0] + \"(\" + args.join(\",\") + \")\");\n\t\t\t\t\t}\n\t\t\t\t\telse if(cc <= 0x07) return console.error(\"WK1 invalid opcode \" + cc.toString(16));\n\t\t\t\t\telse if(cc <= 0x18) return console.error(\"WK1 unsupported op \" + cc.toString(16));\n\t\t\t\t\telse if(cc <= 0x1E) return console.error(\"WK1 invalid opcode \" + cc.toString(16));\n\t\t\t\t\telse if(cc <= 0x73) return console.error(\"WK1 unsupported function opcode \" + cc.toString(16));\n\t\t\t\t\t// possible future functions ??\n\t\t\t\t\telse return console.error(\"WK1 unrecognized opcode \" + cc.toString(16));\n\t\t\t}\n\t\t}\n\t\tif(out.length == 1) o[1].f = \"\" + out[0];\n\t\telse console.error(\"WK1 bad formula parse |\" + out.join(\"|\") + \"|\");\n\t}\n\n\n\tfunction parse_cell_3(blob) {\n\t\tvar o = [{c:0,r:0}, {t:'n',v:0}, 0];\n\t\to[0].r = blob.read_shift(2); o[3] = blob[blob.l++]; o[0].c = blob[blob.l++];\n\t\treturn o;\n\t}\n\n\tfunction parse_LABEL_16(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\to[1].t = 's';\n\t\to[1].v = blob.read_shift(length - 4, 'cstr');\n\t\treturn o;\n\t}\n\tfunction write_LABEL_16(R, C, wsidx, s) {\n\t\t/* TODO: encoding */\n\t\tvar o = new_buf(6 + s.length);\n\t\to.write_shift(2, R);\n\t\to.write_shift(1, wsidx);\n\t\to.write_shift(1, C);\n\t\to.write_shift(1, 0x27);\n\t\tfor(var i = 0; i < s.length; ++i) {\n\t\t\tvar cc = s.charCodeAt(i);\n\t\t\to.write_shift(1, cc >= 0x80 ? 0x5F : cc);\n\t\t}\n\t\to.write_shift(1, 0);\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER_18(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\to[1].v = blob.read_shift(2);\n\t\tvar v = o[1].v >> 1;\n\t\tif(o[1].v & 0x1) {\n\t\t\tswitch(v & 0x07) {\n\t\t\t\tcase 0: v = (v >> 3) * 5000; break;\n\t\t\t\tcase 1: v = (v >> 3) * 500; break;\n\t\t\t\tcase 2: v = (v >> 3) / 20; break;\n\t\t\t\tcase 3: v = (v >> 3) / 200; break;\n\t\t\t\tcase 4: v = (v >> 3) / 2000; break;\n\t\t\t\tcase 5: v = (v >> 3) / 20000; break;\n\t\t\t\tcase 6: v = (v >> 3) / 16; break;\n\t\t\t\tcase 7: v = (v >> 3) / 64; break;\n\t\t\t}\n\t\t}\n\t\to[1].v = v;\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER_17(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\tvar v1 = blob.read_shift(4);\n\t\tvar v2 = blob.read_shift(4);\n\t\tvar e = blob.read_shift(2);\n\t\tif(e == 0xFFFF) {\n\t\t\tif(v1 === 0 && v2 === 0xC0000000) { o[1].t = \"e\"; o[1].v = 0x0F; } // ERR -> #VALUE!\n\t\t\telse if(v1 === 0 && v2 === 0xD0000000) { o[1].t = \"e\"; o[1].v = 0x2A; } // NA -> #N/A\n\t\t\telse o[1].v = 0;\n\t\t\treturn o;\n\t\t}\n\t\tvar s = e & 0x8000; e = (e&0x7FFF) - 16446;\n\t\to[1].v = (1 - s*2) * (v2 * Math.pow(2, e+32) + v1 * Math.pow(2, e));\n\t\treturn o;\n\t}\n\tfunction write_NUMBER_17(R, C, wsidx, v) {\n\t\tvar o = new_buf(14);\n\t\to.write_shift(2, R);\n\t\to.write_shift(1, wsidx);\n\t\to.write_shift(1, C);\n\t\tif(v == 0) {\n\t\t\to.write_shift(4, 0);\n\t\t\to.write_shift(4, 0);\n\t\t\to.write_shift(2, 0xFFFF);\n\t\t\treturn o;\n\t\t}\n\t\tvar s = 0, e = 0, v1 = 0, v2 = 0;\n\t\tif(v < 0) { s = 1; v = -v; }\n\t\te = Math.log2(v) | 0;\n\t\tv /= Math.pow(2, e-31);\n\t\tv2 = (v)>>>0;\n\t\tif((v2&0x80000000) == 0) { v/=2; ++e; v2 = v >>> 0; }\n\t\tv -= v2;\n\t\tv2 |= 0x80000000;\n\t\tv2 >>>= 0;\n\t\tv *= Math.pow(2, 32);\n\t\tv1 = v>>>0;\n\t\to.write_shift(4, v1);\n\t\to.write_shift(4, v2);\n\t\te += 0x3FFF + (s ? 0x8000 : 0);\n\t\to.write_shift(2, e);\n\t\treturn o;\n\t}\n\n\tfunction parse_FORMULA_19(blob, length) {\n\t\tvar o = parse_NUMBER_17(blob, 14);\n\t\tblob.l += length - 14; /* TODO: WK3 formula */\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER_25(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\tvar v1 = blob.read_shift(4);\n\t\to[1].v = v1 >> 6;\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER_27(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\tvar v1 = blob.read_shift(8,'f');\n\t\to[1].v = v1;\n\t\treturn o;\n\t}\n\n\tfunction parse_FORMULA_28(blob, length) {\n\t\tvar o = parse_NUMBER_27(blob, 14);\n\t\tblob.l += length - 10; /* TODO: formula */\n\t\treturn o;\n\t}\n\n\tfunction parse_SHEETNAMECS(blob, length) {\n\t\treturn blob[blob.l + length - 1] == 0 ? blob.read_shift(length, 'cstr') : \"\";\n\t}\n\n\tfunction parse_SHEETNAMELP(blob, length) {\n\t\tvar len = blob[blob.l++];\n\t\tif(len > length - 1) len = length - 1;\n\t\tvar o = \"\"; while(o.length < len) o += String.fromCharCode(blob[blob.l++]);\n\t\treturn o;\n\t}\n\n\tfunction parse_SHEETINFOQP(blob, length, opts) {\n\t\tif(!opts.qpro || length < 21) return;\n\t\tvar id = blob.read_shift(1);\n\t\tblob.l += 17;\n\t\tblob.l += 1; //var len = blob.read_shift(1);\n\t\tblob.l += 2;\n\t\tvar nm = blob.read_shift(length - 21, 'cstr');\n\t\treturn [id, nm];\n\t}\n\n\tfunction parse_XFORMAT(blob, length) {\n\t\tvar o = {}, tgt = blob.l + length;\n\t\twhile(blob.l < tgt) {\n\t\t\tvar dt = blob.read_shift(2);\n\t\t\tif(dt == 0x36b0) {\n\t\t\t\to[dt] = [0, \"\"];\n\t\t\t\to[dt][0] = blob.read_shift(2);\n\t\t\t\twhile(blob[blob.l]) { o[dt][1] += String.fromCharCode(blob[blob.l]); blob.l++; } blob.l++;\n\t\t\t}\n\t\t\t// TODO: 0x3a99 ??\n\t\t}\n\t\treturn o;\n\t}\n\tfunction write_XFORMAT_SHEETNAME(name, wsidx) {\n\t\tvar out = new_buf(5 + name.length);\n\t\tout.write_shift(2, 0x36b0);\n\t\tout.write_shift(2, wsidx);\n\t\tfor(var i = 0; i < name.length; ++i) {\n\t\t\tvar cc = name.charCodeAt(i);\n\t\t\tout[out.l++] = cc > 0x7F ? 0x5F : cc;\n\t\t}\n\t\tout[out.l++] = 0;\n\t\treturn out;\n\t}\n\n\tvar WK1Enum = {\n0x0000: { n:\"BOF\", f:parseuint16 },\n0x0001: { n:\"EOF\" },\n0x0002: { n:\"CALCMODE\" },\n0x0003: { n:\"CALCORDER\" },\n0x0004: { n:\"SPLIT\" },\n0x0005: { n:\"SYNC\" },\n0x0006: { n:\"RANGE\", f:parse_RANGE },\n0x0007: { n:\"WINDOW1\" },\n0x0008: { n:\"COLW1\" },\n0x0009: { n:\"WINTWO\" },\n0x000A: { n:\"COLW2\" },\n0x000B: { n:\"NAME\" },\n0x000C: { n:\"BLANK\" },\n0x000D: { n:\"INTEGER\", f:parse_INTEGER },\n0x000E: { n:\"NUMBER\", f:parse_NUMBER },\n0x000F: { n:\"LABEL\", f:parse_LABEL },\n0x0010: { n:\"FORMULA\", f:parse_FORMULA },\n0x0018: { n:\"TABLE\" },\n0x0019: { n:\"ORANGE\" },\n0x001A: { n:\"PRANGE\" },\n0x001B: { n:\"SRANGE\" },\n0x001C: { n:\"FRANGE\" },\n0x001D: { n:\"KRANGE1\" },\n0x0020: { n:\"HRANGE\" },\n0x0023: { n:\"KRANGE2\" },\n0x0024: { n:\"PROTEC\" },\n0x0025: { n:\"FOOTER\" },\n0x0026: { n:\"HEADER\" },\n0x0027: { n:\"SETUP\" },\n0x0028: { n:\"MARGINS\" },\n0x0029: { n:\"LABELFMT\" },\n0x002A: { n:\"TITLES\" },\n0x002B: { n:\"SHEETJS\" },\n0x002D: { n:\"GRAPH\" },\n0x002E: { n:\"NGRAPH\" },\n0x002F: { n:\"CALCCOUNT\" },\n0x0030: { n:\"UNFORMATTED\" },\n0x0031: { n:\"CURSORW12\" },\n0x0032: { n:\"WINDOW\" },\n0x0033: { n:\"STRING\", f:parse_LABEL },\n0x0037: { n:\"PASSWORD\" },\n0x0038: { n:\"LOCKED\" },\n0x003C: { n:\"QUERY\" },\n0x003D: { n:\"QUERYNAME\" },\n0x003E: { n:\"PRINT\" },\n0x003F: { n:\"PRINTNAME\" },\n0x0040: { n:\"GRAPH2\" },\n0x0041: { n:\"GRAPHNAME\" },\n0x0042: { n:\"ZOOM\" },\n0x0043: { n:\"SYMSPLIT\" },\n0x0044: { n:\"NSROWS\" },\n0x0045: { n:\"NSCOLS\" },\n0x0046: { n:\"RULER\" },\n0x0047: { n:\"NNAME\" },\n0x0048: { n:\"ACOMM\" },\n0x0049: { n:\"AMACRO\" },\n0x004A: { n:\"PARSE\" },\n0x0066: { n:\"PRANGES??\" },\n0x0067: { n:\"RRANGES??\" },\n0x0068: { n:\"FNAME??\" },\n0x0069: { n:\"MRANGES??\" },\n0x00CC: { n:\"SHEETNAMECS\", f:parse_SHEETNAMECS },\n0x00DE: { n:\"SHEETNAMELP\", f:parse_SHEETNAMELP },\n0xFFFF: { n:\"\" }\n\t};\n\n\tvar WK3Enum = {\n0x0000: { n:\"BOF\" },\n0x0001: { n:\"EOF\" },\n0x0002: { n:\"PASSWORD\" },\n0x0003: { n:\"CALCSET\" },\n0x0004: { n:\"WINDOWSET\" },\n0x0005: { n:\"SHEETCELLPTR\" },\n0x0006: { n:\"SHEETLAYOUT\" },\n0x0007: { n:\"COLUMNWIDTH\" },\n0x0008: { n:\"HIDDENCOLUMN\" },\n0x0009: { n:\"USERRANGE\" },\n0x000A: { n:\"SYSTEMRANGE\" },\n0x000B: { n:\"ZEROFORCE\" },\n0x000C: { n:\"SORTKEYDIR\" },\n0x000D: { n:\"FILESEAL\" },\n0x000E: { n:\"DATAFILLNUMS\" },\n0x000F: { n:\"PRINTMAIN\" },\n0x0010: { n:\"PRINTSTRING\" },\n0x0011: { n:\"GRAPHMAIN\" },\n0x0012: { n:\"GRAPHSTRING\" },\n0x0013: { n:\"??\" },\n0x0014: { n:\"ERRCELL\" },\n0x0015: { n:\"NACELL\" },\n0x0016: { n:\"LABEL16\", f:parse_LABEL_16},\n0x0017: { n:\"NUMBER17\", f:parse_NUMBER_17 },\n0x0018: { n:\"NUMBER18\", f:parse_NUMBER_18 },\n0x0019: { n:\"FORMULA19\", f:parse_FORMULA_19},\n0x001A: { n:\"FORMULA1A\" },\n0x001B: { n:\"XFORMAT\", f:parse_XFORMAT },\n0x001C: { n:\"DTLABELMISC\" },\n0x001D: { n:\"DTLABELCELL\" },\n0x001E: { n:\"GRAPHWINDOW\" },\n0x001F: { n:\"CPA\" },\n0x0020: { n:\"LPLAUTO\" },\n0x0021: { n:\"QUERY\" },\n0x0022: { n:\"HIDDENSHEET\" },\n0x0023: { n:\"??\" },\n0x0025: { n:\"NUMBER25\", f:parse_NUMBER_25 },\n0x0026: { n:\"??\" },\n0x0027: { n:\"NUMBER27\", f:parse_NUMBER_27 },\n0x0028: { n:\"FORMULA28\", f:parse_FORMULA_28 },\n0x008E: { n:\"??\" },\n0x0093: { n:\"??\" },\n0x0096: { n:\"??\" },\n0x0097: { n:\"??\" },\n0x0098: { n:\"??\" },\n0x0099: { n:\"??\" },\n0x009A: { n:\"??\" },\n0x009B: { n:\"??\" },\n0x009C: { n:\"??\" },\n0x00A3: { n:\"??\" },\n0x00AE: { n:\"??\" },\n0x00AF: { n:\"??\" },\n0x00B0: { n:\"??\" },\n0x00B1: { n:\"??\" },\n0x00B8: { n:\"??\" },\n0x00B9: { n:\"??\" },\n0x00BA: { n:\"??\" },\n0x00BB: { n:\"??\" },\n0x00BC: { n:\"??\" },\n0x00C3: { n:\"??\" },\n0x00C9: { n:\"??\" },\n0x00CC: { n:\"SHEETNAMECS\", f:parse_SHEETNAMECS },\n0x00CD: { n:\"??\" },\n0x00CE: { n:\"??\" },\n0x00CF: { n:\"??\" },\n0x00D0: { n:\"??\" },\n0x0100: { n:\"??\" },\n0x0103: { n:\"??\" },\n0x0104: { n:\"??\" },\n0x0105: { n:\"??\" },\n0x0106: { n:\"??\" },\n0x0107: { n:\"??\" },\n0x0109: { n:\"??\" },\n0x010A: { n:\"??\" },\n0x010B: { n:\"??\" },\n0x010C: { n:\"??\" },\n0x010E: { n:\"??\" },\n0x010F: { n:\"??\" },\n0x0180: { n:\"??\" },\n0x0185: { n:\"??\" },\n0x0186: { n:\"??\" },\n0x0189: { n:\"??\" },\n0x018C: { n:\"??\" },\n0x0200: { n:\"??\" },\n0x0202: { n:\"??\" },\n0x0201: { n:\"??\" },\n0x0204: { n:\"??\" },\n0x0205: { n:\"??\" },\n0x0280: { n:\"??\" },\n0x0281: { n:\"??\" },\n0x0282: { n:\"??\" },\n0x0283: { n:\"??\" },\n0x0284: { n:\"??\" },\n0x0285: { n:\"??\" },\n0x0286: { n:\"??\" },\n0x0287: { n:\"??\" },\n0x0288: { n:\"??\" },\n0x0292: { n:\"??\" },\n0x0293: { n:\"??\" },\n0x0294: { n:\"??\" },\n0x0295: { n:\"??\" },\n0x0296: { n:\"??\" },\n0x0299: { n:\"??\" },\n0x029A: { n:\"??\" },\n0x0300: { n:\"??\" },\n0x0304: { n:\"??\" },\n0x0601: { n:\"SHEETINFOQP\", f:parse_SHEETINFOQP },\n0x0640: { n:\"??\" },\n0x0642: { n:\"??\" },\n0x0701: { n:\"??\" },\n0x0702: { n:\"??\" },\n0x0703: { n:\"??\" },\n0x0704: { n:\"??\" },\n0x0780: { n:\"??\" },\n0x0800: { n:\"??\" },\n0x0801: { n:\"??\" },\n0x0804: { n:\"??\" },\n0x0A80: { n:\"??\" },\n0x2AF6: { n:\"??\" },\n0x3231: { n:\"??\" },\n0x6E49: { n:\"??\" },\n0x6F44: { n:\"??\" },\n0xFFFF: { n:\"\" }\n\t};\n\treturn {\n\t\tsheet_to_wk1: sheet_to_wk1,\n\t\tbook_to_wk3: book_to_wk3,\n\t\tto_workbook: lotus_to_workbook\n\t};\n})();\n/* 18.4.7 rPr CT_RPrElt */\nfunction parse_rpr(rpr) {\n\tvar font = {}, m = rpr.match(tagregex), i = 0;\n\tvar pass = false;\n\tif(m) for(;i!=m.length; ++i) {\n\t\tvar y = parsexmltag(m[i]);\n\t\tswitch(y[0].replace(/\\w*:/g,\"\")) {\n\t\t\t/* 18.8.12 condense CT_BooleanProperty */\n\t\t\t/* ** not required . */\n\t\t\tcase '<condense': break;\n\t\t\t/* 18.8.17 extend CT_BooleanProperty */\n\t\t\t/* ** not required . */\n\t\t\tcase '<extend': break;\n\t\t\t/* 18.8.36 shadow CT_BooleanProperty */\n\t\t\t/* ** not required . */\n\t\t\tcase '<shadow':\n\t\t\t\tif(!y.val) break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<shadow>':\n\t\t\tcase '<shadow/>': font.shadow = 1; break;\n\t\t\tcase '</shadow>': break;\n\n\t\t\t/* 18.4.1 charset CT_IntProperty TODO */\n\t\t\tcase '<charset':\n\t\t\t\tif(y.val == '1') break;\n\t\t\t\tfont.cp = CS2CP[parseInt(y.val, 10)];\n\t\t\t\tbreak;\n\n\t\t\t/* 18.4.2 outline CT_BooleanProperty TODO */\n\t\t\tcase '<outline':\n\t\t\t\tif(!y.val) break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<outline>':\n\t\t\tcase '<outline/>': font.outline = 1; break;\n\t\t\tcase '</outline>': break;\n\n\t\t\t/* 18.4.5 rFont CT_FontName */\n\t\t\tcase '<rFont': font.name = y.val; break;\n\n\t\t\t/* 18.4.11 sz CT_FontSize */\n\t\t\tcase '<sz': font.sz = y.val; break;\n\n\t\t\t/* 18.4.10 strike CT_BooleanProperty */\n\t\t\tcase '<strike':\n\t\t\t\tif(!y.val) break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<strike>':\n\t\t\tcase '<strike/>': font.strike = 1; break;\n\t\t\tcase '</strike>': break;\n\n\t\t\t/* 18.4.13 u CT_UnderlineProperty */\n\t\t\tcase '<u':\n\t\t\t\tif(!y.val) break;\n\t\t\t\tswitch(y.val) {\n\t\t\t\t\tcase 'double': font.uval = \"double\"; break;\n\t\t\t\t\tcase 'singleAccounting': font.uval = \"single-accounting\"; break;\n\t\t\t\t\tcase 'doubleAccounting': font.uval = \"double-accounting\"; break;\n\t\t\t\t}\n\t\t\t\t/* falls through */\n\t\t\tcase '<u>':\n\t\t\tcase '<u/>': font.u = 1; break;\n\t\t\tcase '</u>': break;\n\n\t\t\t/* 18.8.2 b */\n\t\t\tcase '<b':\n\t\t\t\tif(y.val == '0') break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<b>':\n\t\t\tcase '<b/>': font.b = 1; break;\n\t\t\tcase '</b>': break;\n\n\t\t\t/* 18.8.26 i */\n\t\t\tcase '<i':\n\t\t\t\tif(y.val == '0') break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<i>':\n\t\t\tcase '<i/>': font.i = 1; break;\n\t\t\tcase '</i>': break;\n\n\t\t\t/* 18.3.1.15 color CT_Color TODO: tint, theme, auto, indexed */\n\t\t\tcase '<color':\n\t\t\t\tif(y.rgb) font.color = y.rgb.slice(2,8);\n\t\t\t\tbreak;\n\t\t\tcase '<color>': case '<color/>': case '</color>': break;\n\n\t\t\t/* 18.8.18 family ST_FontFamily */\n\t\t\tcase '<family': font.family = y.val; break;\n\t\t\tcase '<family>': case '<family/>': case '</family>': break;\n\n\t\t\t/* 18.4.14 vertAlign CT_VerticalAlignFontProperty TODO */\n\t\t\tcase '<vertAlign': font.valign = y.val; break;\n\t\t\tcase '<vertAlign>': case '<vertAlign/>': case '</vertAlign>': break;\n\n\t\t\t/* 18.8.35 scheme CT_FontScheme TODO */\n\t\t\tcase '<scheme': break;\n\t\t\tcase '<scheme>': case '<scheme/>': case '</scheme>': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault:\n\t\t\t\tif(y[0].charCodeAt(1) !== 47 && !pass) throw new Error('Unrecognized rich format ' + y[0]);\n\t\t}\n\t}\n\treturn font;\n}\n\nvar parse_rs = (function() {\n\tvar tregex = matchtag(\"t\"), rpregex = matchtag(\"rPr\");\n\t/* 18.4.4 r CT_RElt */\n\tfunction parse_r(r) {\n\t\t/* 18.4.12 t ST_Xstring */\n\t\tvar t = r.match(tregex)/*, cp = 65001*/;\n\t\tif(!t) return {t:\"s\", v:\"\"};\n\n\t\tvar o = ({t:'s', v:unescapexml(t[1])});\n\t\tvar rpr = r.match(rpregex);\n\t\tif(rpr) o.s = parse_rpr(rpr[1]);\n\t\treturn o;\n\t}\n\tvar rregex = /<(?:\\w+:)?r>/g, rend = /<\\/(?:\\w+:)?r>/;\n\treturn function parse_rs(rs) {\n\t\treturn rs.replace(rregex,\"\").split(rend).map(parse_r).filter(function(r) { return r.v; });\n\t};\n})();\n\n\n/* Parse a list of <r> tags */\nvar rs_to_html = (function parse_rs_factory() {\n\tvar nlregex = /(\\r\\n|\\n)/g;\n\tfunction parse_rpr2(font, intro, outro) {\n\t\tvar style = [];\n\n\t\tif(font.u) style.push(\"text-decoration: underline;\");\n\t\tif(font.uval) style.push(\"text-underline-style:\" + font.uval + \";\");\n\t\tif(font.sz) style.push(\"font-size:\" + font.sz + \"pt;\");\n\t\tif(font.outline) style.push(\"text-effect: outline;\");\n\t\tif(font.shadow) style.push(\"text-shadow: auto;\");\n\t\tintro.push('<span style=\"' + style.join(\"\") + '\">');\n\n\t\tif(font.b) { intro.push(\"<b>\"); outro.push(\"</b>\"); }\n\t\tif(font.i) { intro.push(\"<i>\"); outro.push(\"</i>\"); }\n\t\tif(font.strike) { intro.push(\"<s>\"); outro.push(\"</s>\"); }\n\n\t\tvar align = font.valign || \"\";\n\t\tif(align == \"superscript\" || align == \"super\") align = \"sup\";\n\t\telse if(align == \"subscript\") align = \"sub\";\n\t\tif(align != \"\") { intro.push(\"<\" + align + \">\"); outro.push(\"</\" + align + \">\"); }\n\n\t\toutro.push(\"</span>\");\n\t\treturn font;\n\t}\n\n\t/* 18.4.4 r CT_RElt */\n\tfunction r_to_html(r) {\n\t\tvar terms = [[],r.v,[]];\n\t\tif(!r.v) return \"\";\n\n\t\tif(r.s) parse_rpr2(r.s, terms[0], terms[2]);\n\n\t\treturn terms[0].join(\"\") + terms[1].replace(nlregex,'<br/>') + terms[2].join(\"\");\n\t}\n\n\treturn function parse_rs(rs) {\n\t\treturn rs.map(r_to_html).join(\"\");\n\t};\n})();\n\n/* 18.4.8 si CT_Rst */\nvar sitregex = /<(?:\\w+:)?t[^>]*>([^<]*)<\\/(?:\\w+:)?t>/g, sirregex = /<(?:\\w+:)?r>/;\nvar sirphregex = /<(?:\\w+:)?rPh.*?>([\\s\\S]*?)<\\/(?:\\w+:)?rPh>/g;\nfunction parse_si(x, opts) {\n\tvar html = opts ? opts.cellHTML : true;\n\tvar z = {};\n\tif(!x) return { t: \"\" };\n\t//var y;\n\t/* 18.4.12 t ST_Xstring (Plaintext String) */\n\t// TODO: is whitespace actually valid here?\n\tif(x.match(/^\\s*<(?:\\w+:)?t[^>]*>/)) {\n\t\tz.t = unescapexml(utf8read(x.slice(x.indexOf(\">\")+1).split(/<\\/(?:\\w+:)?t>/)[0]||\"\"));\n\t\tz.r = utf8read(x);\n\t\tif(html) z.h = escapehtml(z.t);\n\t}\n\t/* 18.4.4 r CT_RElt (Rich Text Run) */\n\telse if((/*y = */x.match(sirregex))) {\n\t\tz.r = utf8read(x);\n\t\tz.t = unescapexml(utf8read((x.replace(sirphregex, '').match(sitregex)||[]).join(\"\").replace(tagregex,\"\")));\n\t\tif(html) z.h = rs_to_html(parse_rs(z.r));\n\t}\n\t/* 18.4.3 phoneticPr CT_PhoneticPr (TODO: needed for Asian support) */\n\t/* 18.4.6 rPh CT_PhoneticRun (TODO: needed for Asian support) */\n\treturn z;\n}\n\n/* 18.4 Shared String Table */\nvar sstr0 = /<(?:\\w+:)?sst([^>]*)>([\\s\\S]*)<\\/(?:\\w+:)?sst>/;\nvar sstr1 = /<(?:\\w+:)?(?:si|sstItem)>/g;\nvar sstr2 = /<\\/(?:\\w+:)?(?:si|sstItem)>/;\nfunction parse_sst_xml(data, opts) {\n\tvar s = ([]), ss = \"\";\n\tif(!data) return s;\n\t/* 18.4.9 sst CT_Sst */\n\tvar sst = data.match(sstr0);\n\tif(sst) {\n\t\tss = sst[2].replace(sstr1,\"\").split(sstr2);\n\t\tfor(var i = 0; i != ss.length; ++i) {\n\t\t\tvar o = parse_si(ss[i].trim(), opts);\n\t\t\tif(o != null) s[s.length] = o;\n\t\t}\n\t\tsst = parsexmltag(sst[1]); s.Count = sst.count; s.Unique = sst.uniqueCount;\n\t}\n\treturn s;\n}\n\nvar straywsregex = /^\\s|\\s$|[\\t\\n\\r]/;\nfunction write_sst_xml(sst, opts) {\n\tif(!opts.bookSST) return \"\";\n\tvar o = [XML_HEADER];\n\to[o.length] = (writextag('sst', null, {\n\t\txmlns: XMLNS_main[0],\n\t\tcount: sst.Count,\n\t\tuniqueCount: sst.Unique\n\t}));\n\tfor(var i = 0; i != sst.length; ++i) { if(sst[i] == null) continue;\n\t\tvar s = sst[i];\n\t\tvar sitag = \"<si>\";\n\t\tif(s.r) sitag += s.r;\n\t\telse {\n\t\t\tsitag += \"<t\";\n\t\t\tif(!s.t) s.t = \"\";\n\t\t\tif(s.t.match(straywsregex)) sitag += ' xml:space=\"preserve\"';\n\t\t\tsitag += \">\" + escapexml(s.t) + \"</t>\";\n\t\t}\n\t\tsitag += \"</si>\";\n\t\to[o.length] = (sitag);\n\t}\n\tif(o.length>2){ o[o.length] = ('</sst>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.221 BrtBeginSst */\nfunction parse_BrtBeginSst(data) {\n\treturn [data.read_shift(4), data.read_shift(4)];\n}\n\n/* [MS-XLSB] 2.1.7.45 Shared Strings */\nfunction parse_sst_bin(data, opts) {\n\tvar s = ([]);\n\tvar pass = false;\n\trecordhopper(data, function hopper_sst(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x009F: /* BrtBeginSst */\n\t\t\t\ts.Count = val[0]; s.Unique = val[1]; break;\n\t\t\tcase 0x0013: /* BrtSSTItem */\n\t\t\t\ts.push(val); break;\n\t\t\tcase 0x00A0: /* BrtEndSst */\n\t\t\t\treturn true;\n\n\t\t\tcase 0x0023: /* BrtFRTBegin */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* BrtFRTEnd */\n\t\t\t\tpass = false; break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){}\n\t\t\t\tif(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t});\n\treturn s;\n}\n\nfunction write_BrtBeginSst(sst, o) {\n\tif(!o) o = new_buf(8);\n\to.write_shift(4, sst.Count);\n\to.write_shift(4, sst.Unique);\n\treturn o;\n}\n\nvar write_BrtSSTItem = write_RichStr;\n\nfunction write_sst_bin(sst) {\n\tvar ba = buf_array();\n\twrite_record(ba, 0x009F /* BrtBeginSst */, write_BrtBeginSst(sst));\n\tfor(var i = 0; i < sst.length; ++i) write_record(ba, 0x0013 /* BrtSSTItem */, write_BrtSSTItem(sst[i]));\n\t/* FRTSST */\n\twrite_record(ba, 0x00A0 /* BrtEndSst */);\n\treturn ba.end();\n}\nfunction _JS2ANSI(str) {\n\tif(typeof $cptable !== 'undefined') return $cptable.utils.encode(current_ansi, str);\n\tvar o = [], oo = str.split(\"\");\n\tfor(var i = 0; i < oo.length; ++i) o[i] = oo[i].charCodeAt(0);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.4 Version */\nfunction parse_CRYPTOVersion(blob, length) {\n\tvar o = {};\n\to.Major = blob.read_shift(2);\n\to.Minor = blob.read_shift(2);\nif(length >= 4) blob.l += length - 4;\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.5 DataSpaceVersionInfo */\nfunction parse_DataSpaceVersionInfo(blob) {\n\tvar o = {};\n\to.id = blob.read_shift(0, 'lpp4');\n\to.R = parse_CRYPTOVersion(blob, 4);\n\to.U = parse_CRYPTOVersion(blob, 4);\n\to.W = parse_CRYPTOVersion(blob, 4);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.6.1 DataSpaceMapEntry Structure */\nfunction parse_DataSpaceMapEntry(blob) {\n\tvar len = blob.read_shift(4);\n\tvar end = blob.l + len - 4;\n\tvar o = {};\n\tvar cnt = blob.read_shift(4);\n\tvar comps = [];\n\t/* [MS-OFFCRYPTO] 2.1.6.2 DataSpaceReferenceComponent Structure */\n\twhile(cnt-- > 0) comps.push({ t: blob.read_shift(4), v: blob.read_shift(0, 'lpp4') });\n\to.name = blob.read_shift(0, 'lpp4');\n\to.comps = comps;\n\tif(blob.l != end) throw new Error(\"Bad DataSpaceMapEntry: \" + blob.l + \" != \" + end);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.6 DataSpaceMap */\nfunction parse_DataSpaceMap(blob) {\n\tvar o = [];\n\tblob.l += 4; // must be 0x8\n\tvar cnt = blob.read_shift(4);\n\twhile(cnt-- > 0) o.push(parse_DataSpaceMapEntry(blob));\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.7 DataSpaceDefinition */\nfunction parse_DataSpaceDefinition(blob) {\n\tvar o = [];\n\tblob.l += 4; // must be 0x8\n\tvar cnt = blob.read_shift(4);\n\twhile(cnt-- > 0) o.push(blob.read_shift(0, 'lpp4'));\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.8 DataSpaceDefinition */\nfunction parse_TransformInfoHeader(blob) {\n\tvar o = {};\n\t/*var len = */blob.read_shift(4);\n\tblob.l += 4; // must be 0x1\n\to.id = blob.read_shift(0, 'lpp4');\n\to.name = blob.read_shift(0, 'lpp4');\n\to.R = parse_CRYPTOVersion(blob, 4);\n\to.U = parse_CRYPTOVersion(blob, 4);\n\to.W = parse_CRYPTOVersion(blob, 4);\n\treturn o;\n}\n\nfunction parse_Primary(blob) {\n\t/* [MS-OFFCRYPTO] 2.2.6 IRMDSTransformInfo */\n\tvar hdr = parse_TransformInfoHeader(blob);\n\t/* [MS-OFFCRYPTO] 2.1.9 EncryptionTransformInfo */\n\thdr.ename = blob.read_shift(0, '8lpp4');\n\thdr.blksz = blob.read_shift(4);\n\thdr.cmode = blob.read_shift(4);\n\tif(blob.read_shift(4) != 0x04) throw new Error(\"Bad !Primary record\");\n\treturn hdr;\n}\n\n/* [MS-OFFCRYPTO] 2.3.2 Encryption Header */\nfunction parse_EncryptionHeader(blob, length) {\n\tvar tgt = blob.l + length;\n\tvar o = {};\n\to.Flags = (blob.read_shift(4) & 0x3F);\n\tblob.l += 4;\n\to.AlgID = blob.read_shift(4);\n\tvar valid = false;\n\tswitch(o.AlgID) {\n\t\tcase 0x660E: case 0x660F: case 0x6610: valid = (o.Flags == 0x24); break;\n\t\tcase 0x6801: valid = (o.Flags == 0x04); break;\n\t\tcase 0: valid = (o.Flags == 0x10 || o.Flags == 0x04 || o.Flags == 0x24); break;\n\t\tdefault: throw 'Unrecognized encryption algorithm: ' + o.AlgID;\n\t}\n\tif(!valid) throw new Error(\"Encryption Flags/AlgID mismatch\");\n\to.AlgIDHash = blob.read_shift(4);\n\to.KeySize = blob.read_shift(4);\n\to.ProviderType = blob.read_shift(4);\n\tblob.l += 8;\n\to.CSPName = blob.read_shift((tgt-blob.l)>>1, 'utf16le');\n\tblob.l = tgt;\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.3 Encryption Verifier */\nfunction parse_EncryptionVerifier(blob, length) {\n\tvar o = {}, tgt = blob.l + length;\n\tblob.l += 4; // SaltSize must be 0x10\n\to.Salt = blob.slice(blob.l, blob.l+16); blob.l += 16;\n\to.Verifier = blob.slice(blob.l, blob.l+16); blob.l += 16;\n\t/*var sz = */blob.read_shift(4);\n\to.VerifierHash = blob.slice(blob.l, tgt); blob.l = tgt;\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.4.* EncryptionInfo Stream */\nfunction parse_EncryptionInfo(blob) {\n\tvar vers = parse_CRYPTOVersion(blob);\n\tswitch(vers.Minor) {\n\t\tcase 0x02: return [vers.Minor, parse_EncInfoStd(blob, vers)];\n\t\tcase 0x03: return [vers.Minor, parse_EncInfoExt(blob, vers)];\n\t\tcase 0x04: return [vers.Minor, parse_EncInfoAgl(blob, vers)];\n\t}\n\tthrow new Error(\"ECMA-376 Encrypted file unrecognized Version: \" + vers.Minor);\n}\n\n/* [MS-OFFCRYPTO] 2.3.4.5  EncryptionInfo Stream (Standard Encryption) */\nfunction parse_EncInfoStd(blob) {\n\tvar flags = blob.read_shift(4);\n\tif((flags & 0x3F) != 0x24) throw new Error(\"EncryptionInfo mismatch\");\n\tvar sz = blob.read_shift(4);\n\t//var tgt = blob.l + sz;\n\tvar hdr = parse_EncryptionHeader(blob, sz);\n\tvar verifier = parse_EncryptionVerifier(blob, blob.length - blob.l);\n\treturn { t:\"Std\", h:hdr, v:verifier };\n}\n/* [MS-OFFCRYPTO] 2.3.4.6  EncryptionInfo Stream (Extensible Encryption) */\nfunction parse_EncInfoExt() { throw new Error(\"File is password-protected: ECMA-376 Extensible\"); }\n/* [MS-OFFCRYPTO] 2.3.4.10 EncryptionInfo Stream (Agile Encryption) */\nfunction parse_EncInfoAgl(blob) {\n\tvar KeyData = [\"saltSize\",\"blockSize\",\"keyBits\",\"hashSize\",\"cipherAlgorithm\",\"cipherChaining\",\"hashAlgorithm\",\"saltValue\"];\n\tblob.l+=4;\n\tvar xml = blob.read_shift(blob.length - blob.l, 'utf8');\n\tvar o = {};\n\txml.replace(tagregex, function xml_agile(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\t\t\tcase '<encryption': case '</encryption>': break;\n\t\t\tcase '<keyData': KeyData.forEach(function(k) { o[k] = y[k]; }); break;\n\t\t\tcase '<dataIntegrity': o.encryptedHmacKey = y.encryptedHmacKey; o.encryptedHmacValue = y.encryptedHmacValue; break;\n\t\t\tcase '<keyEncryptors>': case '<keyEncryptors': o.encs = []; break;\n\t\t\tcase '</keyEncryptors>': break;\n\n\t\t\tcase '<keyEncryptor': o.uri = y.uri; break;\n\t\t\tcase '</keyEncryptor>': break;\n\t\t\tcase '<encryptedKey': o.encs.push(y); break;\n\t\t\tdefault: throw y[0];\n\t\t}\n\t});\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.5.1 RC4 CryptoAPI Encryption Header */\nfunction parse_RC4CryptoHeader(blob, length) {\n\tvar o = {};\n\tvar vers = o.EncryptionVersionInfo = parse_CRYPTOVersion(blob, 4); length -= 4;\n\tif(vers.Minor != 2) throw new Error('unrecognized minor version code: ' + vers.Minor);\n\tif(vers.Major > 4 || vers.Major < 2) throw new Error('unrecognized major version code: ' + vers.Major);\n\to.Flags = blob.read_shift(4); length -= 4;\n\tvar sz = blob.read_shift(4); length -= 4;\n\to.EncryptionHeader = parse_EncryptionHeader(blob, sz); length -= sz;\n\to.EncryptionVerifier = parse_EncryptionVerifier(blob, length);\n\treturn o;\n}\n/* [MS-OFFCRYPTO] 2.3.6.1 RC4 Encryption Header */\nfunction parse_RC4Header(blob) {\n\tvar o = {};\n\tvar vers = o.EncryptionVersionInfo = parse_CRYPTOVersion(blob, 4);\n\tif(vers.Major != 1 || vers.Minor != 1) throw 'unrecognized version code ' + vers.Major + ' : ' + vers.Minor;\n\to.Salt = blob.read_shift(16);\n\to.EncryptedVerifier = blob.read_shift(16);\n\to.EncryptedVerifierHash = blob.read_shift(16);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.7.1 Binary Document Password Verifier Derivation */\nfunction crypto_CreatePasswordVerifier_Method1(Password) {\n\tvar Verifier = 0x0000, PasswordArray;\n\tvar PasswordDecoded = _JS2ANSI(Password);\n\tvar len = PasswordDecoded.length + 1, i, PasswordByte;\n\tvar Intermediate1, Intermediate2, Intermediate3;\n\tPasswordArray = new_raw_buf(len);\n\tPasswordArray[0] = PasswordDecoded.length;\n\tfor(i = 1; i != len; ++i) PasswordArray[i] = PasswordDecoded[i-1];\n\tfor(i = len-1; i >= 0; --i) {\n\t\tPasswordByte = PasswordArray[i];\n\t\tIntermediate1 = ((Verifier & 0x4000) === 0x0000) ? 0 : 1;\n\t\tIntermediate2 = (Verifier << 1) & 0x7FFF;\n\t\tIntermediate3 = Intermediate1 | Intermediate2;\n\t\tVerifier = Intermediate3 ^ PasswordByte;\n\t}\n\treturn Verifier ^ 0xCE4B;\n}\n\n/* [MS-OFFCRYPTO] 2.3.7.2 Binary Document XOR Array Initialization */\nvar crypto_CreateXorArray_Method1 = (function() {\n\tvar PadArray = [0xBB, 0xFF, 0xFF, 0xBA, 0xFF, 0xFF, 0xB9, 0x80, 0x00, 0xBE, 0x0F, 0x00, 0xBF, 0x0F, 0x00];\n\tvar InitialCode = [0xE1F0, 0x1D0F, 0xCC9C, 0x84C0, 0x110C, 0x0E10, 0xF1CE, 0x313E, 0x1872, 0xE139, 0xD40F, 0x84F9, 0x280C, 0xA96A, 0x4EC3];\n\tvar XorMatrix = [0xAEFC, 0x4DD9, 0x9BB2, 0x2745, 0x4E8A, 0x9D14, 0x2A09, 0x7B61, 0xF6C2, 0xFDA5, 0xEB6B, 0xC6F7, 0x9DCF, 0x2BBF, 0x4563, 0x8AC6, 0x05AD, 0x0B5A, 0x16B4, 0x2D68, 0x5AD0, 0x0375, 0x06EA, 0x0DD4, 0x1BA8, 0x3750, 0x6EA0, 0xDD40, 0xD849, 0xA0B3, 0x5147, 0xA28E, 0x553D, 0xAA7A, 0x44D5, 0x6F45, 0xDE8A, 0xAD35, 0x4A4B, 0x9496, 0x390D, 0x721A, 0xEB23, 0xC667, 0x9CEF, 0x29FF, 0x53FE, 0xA7FC, 0x5FD9, 0x47D3, 0x8FA6, 0x0F6D, 0x1EDA, 0x3DB4, 0x7B68, 0xF6D0, 0xB861, 0x60E3, 0xC1C6, 0x93AD, 0x377B, 0x6EF6, 0xDDEC, 0x45A0, 0x8B40, 0x06A1, 0x0D42, 0x1A84, 0x3508, 0x6A10, 0xAA51, 0x4483, 0x8906, 0x022D, 0x045A, 0x08B4, 0x1168, 0x76B4, 0xED68, 0xCAF1, 0x85C3, 0x1BA7, 0x374E, 0x6E9C, 0x3730, 0x6E60, 0xDCC0, 0xA9A1, 0x4363, 0x86C6, 0x1DAD, 0x3331, 0x6662, 0xCCC4, 0x89A9, 0x0373, 0x06E6, 0x0DCC, 0x1021, 0x2042, 0x4084, 0x8108, 0x1231, 0x2462, 0x48C4];\n\tvar Ror = function(Byte) { return ((Byte/2) | (Byte*128)) & 0xFF; };\n\tvar XorRor = function(byte1, byte2) { return Ror(byte1 ^ byte2); };\n\tvar CreateXorKey_Method1 = function(Password) {\n\t\tvar XorKey = InitialCode[Password.length - 1];\n\t\tvar CurrentElement = 0x68;\n\t\tfor(var i = Password.length-1; i >= 0; --i) {\n\t\t\tvar Char = Password[i];\n\t\t\tfor(var j = 0; j != 7; ++j) {\n\t\t\t\tif(Char & 0x40) XorKey ^= XorMatrix[CurrentElement];\n\t\t\t\tChar *= 2; --CurrentElement;\n\t\t\t}\n\t\t}\n\t\treturn XorKey;\n\t};\n\treturn function(password) {\n\t\tvar Password = _JS2ANSI(password);\n\t\tvar XorKey = CreateXorKey_Method1(Password);\n\t\tvar Index = Password.length;\n\t\tvar ObfuscationArray = new_raw_buf(16);\n\t\tfor(var i = 0; i != 16; ++i) ObfuscationArray[i] = 0x00;\n\t\tvar Temp, PasswordLastChar, PadIndex;\n\t\tif((Index & 1) === 1) {\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(PadArray[0], Temp);\n\t\t\t--Index;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tPasswordLastChar = Password[Password.length - 1];\n\t\t\tObfuscationArray[Index] = XorRor(PasswordLastChar, Temp);\n\t\t}\n\t\twhile(Index > 0) {\n\t\t\t--Index;\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t\t--Index;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t}\n\t\tIndex = 15;\n\t\tPadIndex = 15 - Password.length;\n\t\twhile(PadIndex > 0) {\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(PadArray[PadIndex], Temp);\n\t\t\t--Index;\n\t\t\t--PadIndex;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t\t--Index;\n\t\t\t--PadIndex;\n\t\t}\n\t\treturn ObfuscationArray;\n\t};\n})();\n\n/* [MS-OFFCRYPTO] 2.3.7.3 Binary Document XOR Data Transformation Method 1 */\nvar crypto_DecryptData_Method1 = function(password, Data, XorArrayIndex, XorArray, O) {\n\t/* If XorArray is set, use it; if O is not set, make changes in-place */\n\tif(!O) O = Data;\n\tif(!XorArray) XorArray = crypto_CreateXorArray_Method1(password);\n\tvar Index, Value;\n\tfor(Index = 0; Index != Data.length; ++Index) {\n\t\tValue = Data[Index];\n\t\tValue ^= XorArray[XorArrayIndex];\n\t\tValue = ((Value>>5) | (Value<<3)) & 0xFF;\n\t\tO[Index] = Value;\n\t\t++XorArrayIndex;\n\t}\n\treturn [O, XorArrayIndex, XorArray];\n};\n\nvar crypto_MakeXorDecryptor = function(password) {\n\tvar XorArrayIndex = 0, XorArray = crypto_CreateXorArray_Method1(password);\n\treturn function(Data) {\n\t\tvar O = crypto_DecryptData_Method1(\"\", Data, XorArrayIndex, XorArray);\n\t\tXorArrayIndex = O[1];\n\t\treturn O[0];\n\t};\n};\n\n/* 2.5.343 */\nfunction parse_XORObfuscation(blob, length, opts, out) {\n\tvar o = ({ key: parseuint16(blob), verificationBytes: parseuint16(blob) });\n\tif(opts.password) o.verifier = crypto_CreatePasswordVerifier_Method1(opts.password);\n\tout.valid = o.verificationBytes === o.verifier;\n\tif(out.valid) out.insitu = crypto_MakeXorDecryptor(opts.password);\n\treturn o;\n}\n\n/* 2.4.117 */\nfunction parse_FilePassHeader(blob, length, oo) {\n\tvar o = oo || {}; o.Info = blob.read_shift(2); blob.l -= 2;\n\tif(o.Info === 1) o.Data = parse_RC4Header(blob, length);\n\telse o.Data = parse_RC4CryptoHeader(blob, length);\n\treturn o;\n}\nfunction parse_FilePass(blob, length, opts) {\n\tvar o = ({ Type: opts.biff >= 8 ? blob.read_shift(2) : 0 }); /* wEncryptionType */\n\tif(o.Type) parse_FilePassHeader(blob, length-2, o);\n\telse parse_XORObfuscation(blob, opts.biff >= 8 ? length : length - 2, opts, o);\n\treturn o;\n}\n\n\nvar RTF = (function() {\n\tfunction rtf_to_sheet(d, opts) {\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': return rtf_to_sheet_str(Base64_decode(d), opts);\n\t\t\tcase 'binary': return rtf_to_sheet_str(d, opts);\n\t\t\tcase 'buffer': return rtf_to_sheet_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n\t\t\tcase 'array':  return rtf_to_sheet_str(cc2str(d), opts);\n\t\t}\n\t\tthrow new Error(\"Unrecognized type \" + opts.type);\n\t}\n\n\t/* TODO: this is a stub */\n\tfunction rtf_to_sheet_str(str, opts) {\n\t\tvar o = opts || {};\n\t\tvar ws = o.dense ? ([]) : ({});\n\n\t\tvar rows = str.match(/\\\\trowd.*?\\\\row\\b/g);\n\t\tif(!rows.length) throw new Error(\"RTF missing table\");\n\t\tvar range = ({s: {c:0, r:0}, e: {c:0, r:rows.length - 1}});\n\t\trows.forEach(function(rowtf, R) {\n\t\t\tif(Array.isArray(ws)) ws[R] = [];\n\t\t\tvar rtfre = /\\\\\\w+\\b/g;\n\t\t\tvar last_index = 0;\n\t\t\tvar res;\n\t\t\tvar C = -1;\n\t\t\twhile((res = rtfre.exec(rowtf))) {\n\t\t\t\tswitch(res[0]) {\n\t\t\t\t\tcase \"\\\\cell\":\n\t\t\t\t\t\tvar data = rowtf.slice(last_index, rtfre.lastIndex - res[0].length);\n\t\t\t\t\t\tif(data[0] == \" \") data = data.slice(1);\n\t\t\t\t\t\t++C;\n\t\t\t\t\t\tif(data.length) {\n\t\t\t\t\t\t\t// TODO: value parsing, including codepage adjustments\n\t\t\t\t\t\t\tvar cell = {v: data, t:\"s\"};\n\t\t\t\t\t\t\tif(Array.isArray(ws)) ws[R][C] = cell;\n\t\t\t\t\t\t\telse ws[encode_cell({r:R, c:C})] = cell;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tlast_index = rtfre.lastIndex;\n\t\t\t}\n\t\t\tif(C > range.e.c) range.e.c = C;\n\t\t});\n\t\tws['!ref'] = encode_range(range);\n\t\treturn ws;\n\t}\n\n\tfunction rtf_to_workbook(d, opts) { return sheet_to_workbook(rtf_to_sheet(d, opts), opts); }\n\n\t/* TODO: this is a stub */\n\tfunction sheet_to_rtf(ws) {\n\t\tvar o = [\"{\\\\rtf1\\\\ansi\"];\n\t\tvar r = safe_decode_range(ws['!ref']), cell;\n\t\tvar dense = Array.isArray(ws);\n\t\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\t\to.push(\"\\\\trowd\\\\trautofit1\");\n\t\t\tfor(var C = r.s.c; C <= r.e.c; ++C) o.push(\"\\\\cellx\" + (C+1));\n\t\t\to.push(\"\\\\pard\\\\intbl\");\n\t\t\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tvar coord = encode_cell({r:R,c:C});\n\t\t\t\tcell = dense ? (ws[R]||[])[C]: ws[coord];\n\t\t\t\tif(!cell || cell.v == null && (!cell.f || cell.F)) continue;\n\t\t\t\to.push(\" \" + (cell.w || (format_cell(cell), cell.w)));\n\t\t\t\to.push(\"\\\\cell\");\n\t\t\t}\n\t\t\to.push(\"\\\\pard\\\\intbl\\\\row\");\n\t\t}\n\t\treturn o.join(\"\") + \"}\";\n\t}\n\n\treturn {\n\t\tto_workbook: rtf_to_workbook,\n\t\tto_sheet: rtf_to_sheet,\n\t\tfrom_sheet: sheet_to_rtf\n\t};\n})();\nfunction hex2RGB(h) {\n\tvar o = h.slice(h[0]===\"#\"?1:0).slice(0,6);\n\treturn [parseInt(o.slice(0,2),16),parseInt(o.slice(2,4),16),parseInt(o.slice(4,6),16)];\n}\nfunction rgb2Hex(rgb) {\n\tfor(var i=0,o=1; i!=3; ++i) o = o*256 + (rgb[i]>255?255:rgb[i]<0?0:rgb[i]);\n\treturn o.toString(16).toUpperCase().slice(1);\n}\n\nfunction rgb2HSL(rgb) {\n\tvar R = rgb[0]/255, G = rgb[1]/255, B=rgb[2]/255;\n\tvar M = Math.max(R, G, B), m = Math.min(R, G, B), C = M - m;\n\tif(C === 0) return [0, 0, R];\n\n\tvar H6 = 0, S = 0, L2 = (M + m);\n\tS = C / (L2 > 1 ? 2 - L2 : L2);\n\tswitch(M){\n\t\tcase R: H6 = ((G - B) / C + 6)%6; break;\n\t\tcase G: H6 = ((B - R) / C + 2); break;\n\t\tcase B: H6 = ((R - G) / C + 4); break;\n\t}\n\treturn [H6 / 6, S, L2 / 2];\n}\n\nfunction hsl2RGB(hsl){\n\tvar H = hsl[0], S = hsl[1], L = hsl[2];\n\tvar C = S * 2 * (L < 0.5 ? L : 1 - L), m = L - C/2;\n\tvar rgb = [m,m,m], h6 = 6*H;\n\n\tvar X;\n\tif(S !== 0) switch(h6|0) {\n\t\tcase 0: case 6: X = C * h6; rgb[0] += C; rgb[1] += X; break;\n\t\tcase 1: X = C * (2 - h6);   rgb[0] += X; rgb[1] += C; break;\n\t\tcase 2: X = C * (h6 - 2);   rgb[1] += C; rgb[2] += X; break;\n\t\tcase 3: X = C * (4 - h6);   rgb[1] += X; rgb[2] += C; break;\n\t\tcase 4: X = C * (h6 - 4);   rgb[2] += C; rgb[0] += X; break;\n\t\tcase 5: X = C * (6 - h6);   rgb[2] += X; rgb[0] += C; break;\n\t}\n\tfor(var i = 0; i != 3; ++i) rgb[i] = Math.round(rgb[i]*255);\n\treturn rgb;\n}\n\n/* 18.8.3 bgColor tint algorithm */\nfunction rgb_tint(hex, tint) {\n\tif(tint === 0) return hex;\n\tvar hsl = rgb2HSL(hex2RGB(hex));\n\tif (tint < 0) hsl[2] = hsl[2] * (1 + tint);\n\telse hsl[2] = 1 - (1 - hsl[2]) * (1 - tint);\n\treturn rgb2Hex(hsl2RGB(hsl));\n}\n\n/* 18.3.1.13 width calculations */\n/* [MS-OI29500] 2.1.595 Column Width & Formatting */\nvar DEF_MDW = 6, MAX_MDW = 15, MIN_MDW = 1, MDW = DEF_MDW;\nfunction width2px(width) { return Math.floor(( width + (Math.round(128/MDW))/256 )* MDW ); }\nfunction px2char(px) { return (Math.floor((px - 5)/MDW * 100 + 0.5))/100; }\nfunction char2width(chr) { return (Math.round((chr * MDW + 5)/MDW*256))/256; }\n//function px2char_(px) { return (((px - 5)/MDW * 100 + 0.5))/100; }\n//function char2width_(chr) { return (((chr * MDW + 5)/MDW*256))/256; }\nfunction cycle_width(collw) { return char2width(px2char(width2px(collw))); }\n/* XLSX/XLSB/XLS specify width in units of MDW */\nfunction find_mdw_colw(collw) {\n\tvar delta = Math.abs(collw - cycle_width(collw)), _MDW = MDW;\n\tif(delta > 0.005) for(MDW=MIN_MDW; MDW<MAX_MDW; ++MDW) if(Math.abs(collw - cycle_width(collw)) <= delta) { delta = Math.abs(collw - cycle_width(collw)); _MDW = MDW; }\n\tMDW = _MDW;\n}\n/* XLML specifies width in terms of pixels */\n/*function find_mdw_wpx(wpx) {\n\tvar delta = Infinity, guess = 0, _MDW = MIN_MDW;\n\tfor(MDW=MIN_MDW; MDW<MAX_MDW; ++MDW) {\n\t\tguess = char2width_(px2char_(wpx))*256;\n\t\tguess = (guess) % 1;\n\t\tif(guess > 0.5) guess--;\n\t\tif(Math.abs(guess) < delta) { delta = Math.abs(guess); _MDW = MDW; }\n\t}\n\tMDW = _MDW;\n}*/\n\nfunction process_col(coll) {\n\tif(coll.width) {\n\t\tcoll.wpx = width2px(coll.width);\n\t\tcoll.wch = px2char(coll.wpx);\n\t\tcoll.MDW = MDW;\n\t} else if(coll.wpx) {\n\t\tcoll.wch = px2char(coll.wpx);\n\t\tcoll.width = char2width(coll.wch);\n\t\tcoll.MDW = MDW;\n\t} else if(typeof coll.wch == 'number') {\n\t\tcoll.width = char2width(coll.wch);\n\t\tcoll.wpx = width2px(coll.width);\n\t\tcoll.MDW = MDW;\n\t}\n\tif(coll.customWidth) delete coll.customWidth;\n}\n\nvar DEF_PPI = 96, PPI = DEF_PPI;\nfunction px2pt(px) { return px * 96 / PPI; }\nfunction pt2px(pt) { return pt * PPI / 96; }\n\n/* [MS-EXSPXML3] 2.4.54 ST_enmPattern */\nvar XLMLPatternTypeMap = {\n\t\"None\": \"none\",\n\t\"Solid\": \"solid\",\n\t\"Gray50\": \"mediumGray\",\n\t\"Gray75\": \"darkGray\",\n\t\"Gray25\": \"lightGray\",\n\t\"HorzStripe\": \"darkHorizontal\",\n\t\"VertStripe\": \"darkVertical\",\n\t\"ReverseDiagStripe\": \"darkDown\",\n\t\"DiagStripe\": \"darkUp\",\n\t\"DiagCross\": \"darkGrid\",\n\t\"ThickDiagCross\": \"darkTrellis\",\n\t\"ThinHorzStripe\": \"lightHorizontal\",\n\t\"ThinVertStripe\": \"lightVertical\",\n\t\"ThinReverseDiagStripe\": \"lightDown\",\n\t\"ThinHorzCross\": \"lightGrid\"\n};\n\n/* 18.8.5 borders CT_Borders */\nfunction parse_borders(t, styles, themes, opts) {\n\tstyles.Borders = [];\n\tvar border = {};\n\tvar pass = false;\n\t(t[0].match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<borders': case '<borders>': case '</borders>': break;\n\n\t\t\t/* 18.8.4 border CT_Border */\n\t\t\tcase '<border': case '<border>': case '<border/>':\n\t\t\t\tborder = {};\n\t\t\t\tif(y.diagonalUp) border.diagonalUp = parsexmlbool(y.diagonalUp);\n\t\t\t\tif(y.diagonalDown) border.diagonalDown = parsexmlbool(y.diagonalDown);\n\t\t\t\tstyles.Borders.push(border);\n\t\t\t\tbreak;\n\t\t\tcase '</border>': break;\n\n\t\t\t/* note: not in spec, appears to be CT_BorderPr */\n\t\t\tcase '<left/>': break;\n\t\t\tcase '<left': case '<left>': break;\n\t\t\tcase '</left>': break;\n\n\t\t\t/* note: not in spec, appears to be CT_BorderPr */\n\t\t\tcase '<right/>': break;\n\t\t\tcase '<right': case '<right>': break;\n\t\t\tcase '</right>': break;\n\n\t\t\t/* 18.8.43 top CT_BorderPr */\n\t\t\tcase '<top/>': break;\n\t\t\tcase '<top': case '<top>': break;\n\t\t\tcase '</top>': break;\n\n\t\t\t/* 18.8.6 bottom CT_BorderPr */\n\t\t\tcase '<bottom/>': break;\n\t\t\tcase '<bottom': case '<bottom>': break;\n\t\t\tcase '</bottom>': break;\n\n\t\t\t/* 18.8.13 diagonal CT_BorderPr */\n\t\t\tcase '<diagonal': case '<diagonal>': case '<diagonal/>': break;\n\t\t\tcase '</diagonal>': break;\n\n\t\t\t/* 18.8.25 horizontal CT_BorderPr */\n\t\t\tcase '<horizontal': case '<horizontal>': case '<horizontal/>': break;\n\t\t\tcase '</horizontal>': break;\n\n\t\t\t/* 18.8.44 vertical CT_BorderPr */\n\t\t\tcase '<vertical': case '<vertical>': case '<vertical/>': break;\n\t\t\tcase '</vertical>': break;\n\n\t\t\t/* 18.8.37 start CT_BorderPr */\n\t\t\tcase '<start': case '<start>': case '<start/>': break;\n\t\t\tcase '</start>': break;\n\n\t\t\t/* 18.8.16 end CT_BorderPr */\n\t\t\tcase '<end': case '<end>': case '<end/>': break;\n\t\t\tcase '</end>': break;\n\n\t\t\t/* 18.8.? color CT_Color */\n\t\t\tcase '<color': case '<color>':\n\t\t\t\tbreak;\n\t\t\tcase '<color/>': case '</color>': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault: if(opts && opts.WTF) {\n\t\t\t\tif(!pass) throw new Error('unrecognized ' + y[0] + ' in borders');\n\t\t\t}\n\t\t}\n\t});\n}\n\n/* 18.8.21 fills CT_Fills */\nfunction parse_fills(t, styles, themes, opts) {\n\tstyles.Fills = [];\n\tvar fill = {};\n\tvar pass = false;\n\t(t[0].match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<fills': case '<fills>': case '</fills>': break;\n\n\t\t\t/* 18.8.20 fill CT_Fill */\n\t\t\tcase '<fill>': case '<fill': case '<fill/>':\n\t\t\t\tfill = {}; styles.Fills.push(fill); break;\n\t\t\tcase '</fill>': break;\n\n\t\t\t/* 18.8.24 gradientFill CT_GradientFill */\n\t\t\tcase '<gradientFill>': break;\n\t\t\tcase '<gradientFill':\n\t\t\tcase '</gradientFill>': styles.Fills.push(fill); fill = {}; break;\n\n\t\t\t/* 18.8.32 patternFill CT_PatternFill */\n\t\t\tcase '<patternFill': case '<patternFill>':\n\t\t\t\tif(y.patternType) fill.patternType = y.patternType;\n\t\t\t\tbreak;\n\t\t\tcase '<patternFill/>': case '</patternFill>': break;\n\n\t\t\t/* 18.8.3 bgColor CT_Color */\n\t\t\tcase '<bgColor':\n\t\t\t\tif(!fill.bgColor) fill.bgColor = {};\n\t\t\t\tif(y.indexed) fill.bgColor.indexed = parseInt(y.indexed, 10);\n\t\t\t\tif(y.theme) fill.bgColor.theme = parseInt(y.theme, 10);\n\t\t\t\tif(y.tint) fill.bgColor.tint = parseFloat(y.tint);\n\t\t\t\t/* Excel uses ARGB strings */\n\t\t\t\tif(y.rgb) fill.bgColor.rgb = y.rgb.slice(-6);\n\t\t\t\tbreak;\n\t\t\tcase '<bgColor/>': case '</bgColor>': break;\n\n\t\t\t/* 18.8.19 fgColor CT_Color */\n\t\t\tcase '<fgColor':\n\t\t\t\tif(!fill.fgColor) fill.fgColor = {};\n\t\t\t\tif(y.theme) fill.fgColor.theme = parseInt(y.theme, 10);\n\t\t\t\tif(y.tint) fill.fgColor.tint = parseFloat(y.tint);\n\t\t\t\t/* Excel uses ARGB strings */\n\t\t\t\tif(y.rgb != null) fill.fgColor.rgb = y.rgb.slice(-6);\n\t\t\t\tbreak;\n\t\t\tcase '<fgColor/>': case '</fgColor>': break;\n\n\t\t\t/* 18.8.38 stop CT_GradientStop */\n\t\t\tcase '<stop': case '<stop/>': break;\n\t\t\tcase '</stop>': break;\n\n\t\t\t/* 18.8.? color CT_Color */\n\t\t\tcase '<color': case '<color/>': break;\n\t\t\tcase '</color>': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault: if(opts && opts.WTF) {\n\t\t\t\tif(!pass) throw new Error('unrecognized ' + y[0] + ' in fills');\n\t\t\t}\n\t\t}\n\t});\n}\n\n/* 18.8.23 fonts CT_Fonts */\nfunction parse_fonts(t, styles, themes, opts) {\n\tstyles.Fonts = [];\n\tvar font = {};\n\tvar pass = false;\n\t(t[0].match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<fonts': case '<fonts>': case '</fonts>': break;\n\n\t\t\t/* 18.8.22 font CT_Font */\n\t\t\tcase '<font': case '<font>': break;\n\t\t\tcase '</font>': case '<font/>':\n\t\t\t\tstyles.Fonts.push(font);\n\t\t\t\tfont = {};\n\t\t\t\tbreak;\n\n\t\t\t/* 18.8.29 name CT_FontName */\n\t\t\tcase '<name': if(y.val) font.name = utf8read(y.val); break;\n\t\t\tcase '<name/>': case '</name>': break;\n\n\t\t\t/* 18.8.2  b CT_BooleanProperty */\n\t\t\tcase '<b': font.bold = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<b/>': font.bold = 1; break;\n\n\t\t\t/* 18.8.26 i CT_BooleanProperty */\n\t\t\tcase '<i': font.italic = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<i/>': font.italic = 1; break;\n\n\t\t\t/* 18.4.13 u CT_UnderlineProperty */\n\t\t\tcase '<u':\n\t\t\t\tswitch(y.val) {\n\t\t\t\t\tcase \"none\": font.underline = 0x00; break;\n\t\t\t\t\tcase \"single\": font.underline = 0x01; break;\n\t\t\t\t\tcase \"double\": font.underline = 0x02; break;\n\t\t\t\t\tcase \"singleAccounting\": font.underline = 0x21; break;\n\t\t\t\t\tcase \"doubleAccounting\": font.underline = 0x22; break;\n\t\t\t\t} break;\n\t\t\tcase '<u/>': font.underline = 1; break;\n\n\t\t\t/* 18.4.10 strike CT_BooleanProperty */\n\t\t\tcase '<strike': font.strike = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<strike/>': font.strike = 1; break;\n\n\t\t\t/* 18.4.2  outline CT_BooleanProperty */\n\t\t\tcase '<outline': font.outline = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<outline/>': font.outline = 1; break;\n\n\t\t\t/* 18.8.36 shadow CT_BooleanProperty */\n\t\t\tcase '<shadow': font.shadow = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<shadow/>': font.shadow = 1; break;\n\n\t\t\t/* 18.8.12 condense CT_BooleanProperty */\n\t\t\tcase '<condense': font.condense = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<condense/>': font.condense = 1; break;\n\n\t\t\t/* 18.8.17 extend CT_BooleanProperty */\n\t\t\tcase '<extend': font.extend = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<extend/>': font.extend = 1; break;\n\n\t\t\t/* 18.4.11 sz CT_FontSize */\n\t\t\tcase '<sz': if(y.val) font.sz = +y.val; break;\n\t\t\tcase '<sz/>': case '</sz>': break;\n\n\t\t\t/* 18.4.14 vertAlign CT_VerticalAlignFontProperty */\n\t\t\tcase '<vertAlign': if(y.val) font.vertAlign = y.val; break;\n\t\t\tcase '<vertAlign/>': case '</vertAlign>': break;\n\n\t\t\t/* 18.8.18 family CT_FontFamily */\n\t\t\tcase '<family': if(y.val) font.family = parseInt(y.val,10); break;\n\t\t\tcase '<family/>': case '</family>': break;\n\n\t\t\t/* 18.8.35 scheme CT_FontScheme */\n\t\t\tcase '<scheme': if(y.val) font.scheme = y.val; break;\n\t\t\tcase '<scheme/>': case '</scheme>': break;\n\n\t\t\t/* 18.4.1 charset CT_IntProperty */\n\t\t\tcase '<charset':\n\t\t\t\tif(y.val == '1') break;\n\t\t\t\ty.codepage = CS2CP[parseInt(y.val, 10)];\n\t\t\t\tbreak;\n\n\t\t\t/* 18.?.? color CT_Color */\n\t\t\tcase '<color':\n\t\t\t\tif(!font.color) font.color = {};\n\t\t\t\tif(y.auto) font.color.auto = parsexmlbool(y.auto);\n\n\t\t\t\tif(y.rgb) font.color.rgb = y.rgb.slice(-6);\n\t\t\t\telse if(y.indexed) {\n\t\t\t\t\tfont.color.index = parseInt(y.indexed, 10);\n\t\t\t\t\tvar icv = XLSIcv[font.color.index];\n\t\t\t\t\tif(font.color.index == 81) icv = XLSIcv[1];\n\t\t\t\t\tif(!icv) icv = XLSIcv[1]; //throw new Error(x); // note: 206 is valid\n\t\t\t\t\tfont.color.rgb = icv[0].toString(16) + icv[1].toString(16) + icv[2].toString(16);\n\t\t\t\t} else if(y.theme) {\n\t\t\t\t\tfont.color.theme = parseInt(y.theme, 10);\n\t\t\t\t\tif(y.tint) font.color.tint = parseFloat(y.tint);\n\t\t\t\t\tif(y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n\t\t\t\t\t\tfont.color.rgb = rgb_tint(themes.themeElements.clrScheme[font.color.theme].rgb, font.color.tint || 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase '<color/>': case '</color>': break;\n\n\t\t\t/* note: sometimes mc:AlternateContent appears bare */\n\t\t\tcase '<AlternateContent': pass = true; break;\n\t\t\tcase '</AlternateContent>': pass = false; break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault: if(opts && opts.WTF) {\n\t\t\t\tif(!pass) throw new Error('unrecognized ' + y[0] + ' in fonts');\n\t\t\t}\n\t\t}\n\t});\n}\n\n/* 18.8.31 numFmts CT_NumFmts */\nfunction parse_numFmts(t, styles, opts) {\n\tstyles.NumberFmt = [];\n\tvar k/*Array<number>*/ = (keys(table_fmt));\n\tfor(var i=0; i < k.length; ++i) styles.NumberFmt[k[i]] = table_fmt[k[i]];\n\tvar m = t[0].match(tagregex);\n\tif(!m) return;\n\tfor(i=0; i < m.length; ++i) {\n\t\tvar y = parsexmltag(m[i]);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<numFmts': case '</numFmts>': case '<numFmts/>': case '<numFmts>': break;\n\t\t\tcase '<numFmt': {\n\t\t\t\tvar f=unescapexml(utf8read(y.formatCode)), j=parseInt(y.numFmtId,10);\n\t\t\t\tstyles.NumberFmt[j] = f;\n\t\t\t\tif(j>0) {\n\t\t\t\t\tif(j > 0x188) {\n\t\t\t\t\t\tfor(j = 0x188; j > 0x3c; --j) if(styles.NumberFmt[j] == null) break;\n\t\t\t\t\t\tstyles.NumberFmt[j] = f;\n\t\t\t\t\t}\n\t\t\t\t\tSSF_load(f,j);\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase '</numFmt>': break;\n\t\t\tdefault: if(opts.WTF) throw new Error('unrecognized ' + y[0] + ' in numFmts');\n\t\t}\n\t}\n}\n\nfunction write_numFmts(NF) {\n\tvar o = [\"<numFmts>\"];\n\t[[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\n\t\tfor(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) o[o.length] = (writextag('numFmt',null,{numFmtId:i,formatCode:escapexml(NF[i])}));\n\t});\n\tif(o.length === 1) return \"\";\n\to[o.length] = (\"</numFmts>\");\n\to[0] = writextag('numFmts', null, { count:o.length-2 }).replace(\"/>\", \">\");\n\treturn o.join(\"\");\n}\n\n/* 18.8.10 cellXfs CT_CellXfs */\nvar cellXF_uint = [ \"numFmtId\", \"fillId\", \"fontId\", \"borderId\", \"xfId\" ];\nvar cellXF_bool = [ \"applyAlignment\", \"applyBorder\", \"applyFill\", \"applyFont\", \"applyNumberFormat\", \"applyProtection\", \"pivotButton\", \"quotePrefix\" ];\nfunction parse_cellXfs(t, styles, opts) {\n\tstyles.CellXf = [];\n\tvar xf;\n\tvar pass = false;\n\t(t[0].match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x), i = 0;\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<cellXfs': case '<cellXfs>': case '<cellXfs/>': case '</cellXfs>': break;\n\n\t\t\t/* 18.8.45 xf CT_Xf */\n\t\t\tcase '<xf': case '<xf/>':\n\t\t\t\txf = y;\n\t\t\t\tdelete xf[0];\n\t\t\t\tfor(i = 0; i < cellXF_uint.length; ++i) if(xf[cellXF_uint[i]])\n\t\t\t\t\txf[cellXF_uint[i]] = parseInt(xf[cellXF_uint[i]], 10);\n\t\t\t\tfor(i = 0; i < cellXF_bool.length; ++i) if(xf[cellXF_bool[i]])\n\t\t\t\t\txf[cellXF_bool[i]] = parsexmlbool(xf[cellXF_bool[i]]);\n\t\t\t\tif(styles.NumberFmt && xf.numFmtId > 0x188) {\n\t\t\t\t\tfor(i = 0x188; i > 0x3c; --i) if(styles.NumberFmt[xf.numFmtId] == styles.NumberFmt[i]) { xf.numFmtId = i; break; }\n\t\t\t\t}\n\t\t\t\tstyles.CellXf.push(xf); break;\n\t\t\tcase '</xf>': break;\n\n\t\t\t/* 18.8.1 alignment CT_CellAlignment */\n\t\t\tcase '<alignment': case '<alignment/>':\n\t\t\t\tvar alignment = {};\n\t\t\t\tif(y.vertical) alignment.vertical = y.vertical;\n\t\t\t\tif(y.horizontal) alignment.horizontal = y.horizontal;\n\t\t\t\tif(y.textRotation != null) alignment.textRotation = y.textRotation;\n\t\t\t\tif(y.indent) alignment.indent = y.indent;\n\t\t\t\tif(y.wrapText) alignment.wrapText = parsexmlbool(y.wrapText);\n\t\t\t\txf.alignment = alignment;\n\t\t\t\tbreak;\n\t\t\tcase '</alignment>': break;\n\n\t\t\t/* 18.8.33 protection CT_CellProtection */\n\t\t\tcase '<protection':\n\t\t\t\tbreak;\n\t\t\tcase '</protection>': case '<protection/>': break;\n\n\t\t\t/* note: sometimes mc:AlternateContent appears bare */\n\t\t\tcase '<AlternateContent': pass = true; break;\n\t\t\tcase '</AlternateContent>': pass = false; break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault: if(opts && opts.WTF) {\n\t\t\t\tif(!pass) throw new Error('unrecognized ' + y[0] + ' in cellXfs');\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction write_cellXfs(cellXfs) {\n\tvar o = [];\n\to[o.length] = (writextag('cellXfs',null));\n\tcellXfs.forEach(function(c) {\n\t\to[o.length] = (writextag('xf', null, c));\n\t});\n\to[o.length] = (\"</cellXfs>\");\n\tif(o.length === 2) return \"\";\n\to[0] = writextag('cellXfs',null, {count:o.length-2}).replace(\"/>\",\">\");\n\treturn o.join(\"\");\n}\n\n/* 18.8 Styles CT_Stylesheet*/\nvar parse_sty_xml= (function make_pstyx() {\nvar numFmtRegex = /<(?:\\w+:)?numFmts([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?numFmts>/;\nvar cellXfRegex = /<(?:\\w+:)?cellXfs([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?cellXfs>/;\nvar fillsRegex = /<(?:\\w+:)?fills([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?fills>/;\nvar fontsRegex = /<(?:\\w+:)?fonts([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?fonts>/;\nvar bordersRegex = /<(?:\\w+:)?borders([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?borders>/;\n\nreturn function parse_sty_xml(data, themes, opts) {\n\tvar styles = {};\n\tif(!data) return styles;\n\tdata = data.replace(/<!--([\\s\\S]*?)-->/mg,\"\").replace(/<!DOCTYPE[^\\[]*\\[[^\\]]*\\]>/gm,\"\");\n\t/* 18.8.39 styleSheet CT_Stylesheet */\n\tvar t;\n\n\t/* 18.8.31 numFmts CT_NumFmts ? */\n\tif((t=data.match(numFmtRegex))) parse_numFmts(t, styles, opts);\n\n\t/* 18.8.23 fonts CT_Fonts ? */\n\tif((t=data.match(fontsRegex))) parse_fonts(t, styles, themes, opts);\n\n\t/* 18.8.21 fills CT_Fills ? */\n\tif((t=data.match(fillsRegex))) parse_fills(t, styles, themes, opts);\n\n\t/* 18.8.5  borders CT_Borders ? */\n\tif((t=data.match(bordersRegex))) parse_borders(t, styles, themes, opts);\n\n\t/* 18.8.9  cellStyleXfs CT_CellStyleXfs ? */\n\t/* 18.8.8  cellStyles CT_CellStyles ? */\n\n\t/* 18.8.10 cellXfs CT_CellXfs ? */\n\tif((t=data.match(cellXfRegex))) parse_cellXfs(t, styles, opts);\n\n\t/* 18.8.15 dxfs CT_Dxfs ? */\n\t/* 18.8.42 tableStyles CT_TableStyles ? */\n\t/* 18.8.11 colors CT_Colors ? */\n\t/* 18.2.10 extLst CT_ExtensionList ? */\n\n\treturn styles;\n};\n})();\n\nfunction write_sty_xml(wb, opts) {\n\tvar o = [XML_HEADER, writextag('styleSheet', null, {\n\t\t'xmlns': XMLNS_main[0],\n\t\t'xmlns:vt': XMLNS.vt\n\t})], w;\n\tif(wb.SSF && (w = write_numFmts(wb.SSF)) != null) o[o.length] = w;\n\to[o.length] = ('<fonts count=\"1\"><font><sz val=\"12\"/><color theme=\"1\"/><name val=\"Calibri\"/><family val=\"2\"/><scheme val=\"minor\"/></font></fonts>');\n\to[o.length] = ('<fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills>');\n\to[o.length] = ('<borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders>');\n\to[o.length] = ('<cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs>');\n\tif((w = write_cellXfs(opts.cellXfs))) o[o.length] = (w);\n\to[o.length] = ('<cellStyles count=\"1\"><cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\"/></cellStyles>');\n\to[o.length] = ('<dxfs count=\"0\"/>');\n\to[o.length] = ('<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\"/>');\n\n\tif(o.length>2){ o[o.length] = ('</styleSheet>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.657 BrtFmt */\nfunction parse_BrtFmt(data, length) {\n\tvar numFmtId = data.read_shift(2);\n\tvar stFmtCode = parse_XLWideString(data,length-2);\n\treturn [numFmtId, stFmtCode];\n}\nfunction write_BrtFmt(i, f, o) {\n\tif(!o) o = new_buf(6 + 4 * f.length);\n\to.write_shift(2, i);\n\twrite_XLWideString(f, o);\n\tvar out = (o.length > o.l) ? o.slice(0, o.l) : o;\n\tif(o.l == null) o.l = o.length;\n\treturn out;\n}\n\n/* [MS-XLSB] 2.4.659 BrtFont TODO */\nfunction parse_BrtFont(data, length, opts) {\n\tvar out = ({});\n\n\tout.sz = data.read_shift(2) / 20;\n\n\tvar grbit = parse_FontFlags(data, 2, opts);\n\tif(grbit.fItalic) out.italic = 1;\n\tif(grbit.fCondense) out.condense = 1;\n\tif(grbit.fExtend) out.extend = 1;\n\tif(grbit.fShadow) out.shadow = 1;\n\tif(grbit.fOutline) out.outline = 1;\n\tif(grbit.fStrikeout) out.strike = 1;\n\n\tvar bls = data.read_shift(2);\n\tif(bls === 0x02BC) out.bold = 1;\n\n\tswitch(data.read_shift(2)) {\n\t\t/* case 0: out.vertAlign = \"baseline\"; break; */\n\t\tcase 1: out.vertAlign = \"superscript\"; break;\n\t\tcase 2: out.vertAlign = \"subscript\"; break;\n\t}\n\n\tvar underline = data.read_shift(1);\n\tif(underline != 0) out.underline = underline;\n\n\tvar family = data.read_shift(1);\n\tif(family > 0) out.family = family;\n\n\tvar bCharSet = data.read_shift(1);\n\tif(bCharSet > 0) out.charset = bCharSet;\n\n\tdata.l++;\n\tout.color = parse_BrtColor(data, 8);\n\n\tswitch(data.read_shift(1)) {\n\t\t/* case 0: out.scheme = \"none\": break; */\n\t\tcase 1: out.scheme = \"major\"; break;\n\t\tcase 2: out.scheme = \"minor\"; break;\n\t}\n\n\tout.name = parse_XLWideString(data, length - 21);\n\n\treturn out;\n}\nfunction write_BrtFont(font, o) {\n\tif(!o) o = new_buf(25+4*32);\n\to.write_shift(2, font.sz * 20);\n\twrite_FontFlags(font, o);\n\to.write_shift(2, font.bold ? 0x02BC : 0x0190);\n\tvar sss = 0;\n\tif(font.vertAlign == \"superscript\") sss = 1;\n\telse if(font.vertAlign == \"subscript\") sss = 2;\n\to.write_shift(2, sss);\n\to.write_shift(1, font.underline || 0);\n\to.write_shift(1, font.family || 0);\n\to.write_shift(1, font.charset || 0);\n\to.write_shift(1, 0);\n\twrite_BrtColor(font.color, o);\n\tvar scheme = 0;\n\tif(font.scheme == \"major\") scheme = 1;\n\tif(font.scheme == \"minor\") scheme = 2;\n\to.write_shift(1, scheme);\n\twrite_XLWideString(font.name, o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.650 BrtFill */\nvar XLSBFillPTNames = [\n\t\"none\",\n\t\"solid\",\n\t\"mediumGray\",\n\t\"darkGray\",\n\t\"lightGray\",\n\t\"darkHorizontal\",\n\t\"darkVertical\",\n\t\"darkDown\",\n\t\"darkUp\",\n\t\"darkGrid\",\n\t\"darkTrellis\",\n\t\"lightHorizontal\",\n\t\"lightVertical\",\n\t\"lightDown\",\n\t\"lightUp\",\n\t\"lightGrid\",\n\t\"lightTrellis\",\n\t\"gray125\",\n\t\"gray0625\"\n];\nvar rev_XLSBFillPTNames;\n/* TODO: gradient fill representation */\nvar parse_BrtFill = parsenoop;\nfunction write_BrtFill(fill, o) {\n\tif(!o) o = new_buf(4*3 + 8*7 + 16*1);\n\tif(!rev_XLSBFillPTNames) rev_XLSBFillPTNames = (evert(XLSBFillPTNames));\n\tvar fls = rev_XLSBFillPTNames[fill.patternType];\n\tif(fls == null) fls = 0x28;\n\to.write_shift(4, fls);\n\tvar j = 0;\n\tif(fls != 0x28) {\n\t\t/* TODO: custom FG Color */\n\t\twrite_BrtColor({auto:1}, o);\n\t\t/* TODO: custom BG Color */\n\t\twrite_BrtColor({auto:1}, o);\n\n\t\tfor(; j < 12; ++j) o.write_shift(4, 0);\n\t} else {\n\t\tfor(; j < 4; ++j) o.write_shift(4, 0);\n\n\t\tfor(; j < 12; ++j) o.write_shift(4, 0); /* TODO */\n\t\t/* iGradientType */\n\t\t/* xnumDegree */\n\t\t/* xnumFillToLeft */\n\t\t/* xnumFillToRight */\n\t\t/* xnumFillToTop */\n\t\t/* xnumFillToBottom */\n\t\t/* cNumStop */\n\t\t/* xfillGradientStop */\n\t}\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.824 BrtXF */\nfunction parse_BrtXF(data, length) {\n\tvar tgt = data.l + length;\n\tvar ixfeParent = data.read_shift(2);\n\tvar ifmt = data.read_shift(2);\n\tdata.l = tgt;\n\treturn {ixfe:ixfeParent, numFmtId:ifmt };\n}\nfunction write_BrtXF(data, ixfeP, o) {\n\tif(!o) o = new_buf(16);\n\to.write_shift(2, ixfeP||0);\n\to.write_shift(2, data.numFmtId||0);\n\to.write_shift(2, 0); /* iFont */\n\to.write_shift(2, 0); /* iFill */\n\to.write_shift(2, 0); /* ixBorder */\n\to.write_shift(1, 0); /* trot */\n\to.write_shift(1, 0); /* indent */\n\tvar flow = 0;\n\to.write_shift(1, flow); /* flags */\n\to.write_shift(1, 0); /* flags */\n\to.write_shift(1, 0); /* xfGrbitAtr */\n\to.write_shift(1, 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.4 Blxf TODO */\nfunction write_Blxf(data, o) {\n\tif(!o) o = new_buf(10);\n\to.write_shift(1, 0); /* dg */\n\to.write_shift(1, 0);\n\to.write_shift(4, 0); /* color */\n\to.write_shift(4, 0); /* color */\n\treturn o;\n}\n/* [MS-XLSB] 2.4.302 BrtBorder TODO */\nvar parse_BrtBorder = parsenoop;\nfunction write_BrtBorder(border, o) {\n\tif(!o) o = new_buf(51);\n\to.write_shift(1, 0); /* diagonal */\n\twrite_Blxf(null, o); /* top */\n\twrite_Blxf(null, o); /* bottom */\n\twrite_Blxf(null, o); /* left */\n\twrite_Blxf(null, o); /* right */\n\twrite_Blxf(null, o); /* diag */\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.763 BrtStyle TODO */\nfunction write_BrtStyle(style, o) {\n\tif(!o) o = new_buf(12+4*10);\n\to.write_shift(4, style.xfId);\n\to.write_shift(2, 1);\n\to.write_shift(1, +style.builtinId);\n\to.write_shift(1, 0); /* iLevel */\n\twrite_XLNullableWideString(style.name || \"\", o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.272 BrtBeginTableStyles */\nfunction write_BrtBeginTableStyles(cnt, defTableStyle, defPivotStyle) {\n\tvar o = new_buf(4+256*2*4);\n\to.write_shift(4, cnt);\n\twrite_XLNullableWideString(defTableStyle, o);\n\twrite_XLNullableWideString(defPivotStyle, o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.1.7.50 Styles */\nfunction parse_sty_bin(data, themes, opts) {\n\tvar styles = {};\n\tstyles.NumberFmt = ([]);\n\tfor(var y in table_fmt) styles.NumberFmt[y] = table_fmt[y];\n\n\tstyles.CellXf = [];\n\tstyles.Fonts = [];\n\tvar state = [];\n\tvar pass = false;\n\trecordhopper(data, function hopper_sty(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x002C: /* BrtFmt */\n\t\t\t\tstyles.NumberFmt[val[0]] = val[1]; SSF_load(val[1], val[0]);\n\t\t\t\tbreak;\n\t\t\tcase 0x002B: /* BrtFont */\n\t\t\t\tstyles.Fonts.push(val);\n\t\t\t\tif(val.color.theme != null && themes && themes.themeElements && themes.themeElements.clrScheme) {\n\t\t\t\t\tval.color.rgb = rgb_tint(themes.themeElements.clrScheme[val.color.theme].rgb, val.color.tint || 0);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 0x0401: /* BrtKnownFonts */ break;\n\t\t\tcase 0x002D: /* BrtFill */\n\t\t\t\tbreak;\n\t\t\tcase 0x002E: /* BrtBorder */\n\t\t\t\tbreak;\n\t\t\tcase 0x002F: /* BrtXF */\n\t\t\t\tif(state[state.length - 1] == 0x0269 /* BrtBeginCellXFs */) {\n\t\t\t\t\tstyles.CellXf.push(val);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 0x0030: /* BrtStyle */\n\t\t\tcase 0x01FB: /* BrtDXF */\n\t\t\tcase 0x023C: /* BrtMRUColor */\n\t\t\tcase 0x01DB: /* BrtIndexedColor */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0493: /* BrtDXF14 */\n\t\t\tcase 0x0836: /* BrtDXF15 */\n\t\t\tcase 0x046A: /* BrtSlicerStyleElement */\n\t\t\tcase 0x0200: /* BrtTableStyleElement */\n\t\t\tcase 0x082F: /* BrtTimelineStyleElement */\n\t\t\tcase 0x0C00: /* BrtUid */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* BrtFRTBegin */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* BrtFRTEnd */\n\t\t\t\tpass = false; break;\n\t\t\tcase 0x0025: /* BrtACBegin */\n\t\t\t\tstate.push(RT); pass = true; break;\n\t\t\tcase 0x0026: /* BrtACEnd */\n\t\t\t\tstate.pop(); pass = false; break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T > 0) state.push(RT);\n\t\t\t\telse if(R.T < 0) state.pop();\n\t\t\t\telse if(!pass || (opts.WTF && state[state.length-1] != 0x0025 /* BrtACBegin */)) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t});\n\treturn styles;\n}\n\nfunction write_FMTS_bin(ba, NF) {\n\tif(!NF) return;\n\tvar cnt = 0;\n\t[[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\nfor(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) ++cnt;\n\t});\n\n\tif(cnt == 0) return;\n\twrite_record(ba, 0x0267 /* BrtBeginFmts */, write_UInt32LE(cnt));\n\t[[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\nfor(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) write_record(ba, 0x002C /* BrtFmt */, write_BrtFmt(i, NF[i]));\n\t});\n\twrite_record(ba, 0x0268 /* BrtEndFmts */);\n}\n\nfunction write_FONTS_bin(ba) {\n\tvar cnt = 1;\n\n\tif(cnt == 0) return;\n\twrite_record(ba, 0x0263 /* BrtBeginFonts */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x002B /* BrtFont */, write_BrtFont({\n\t\tsz:12,\n\t\tcolor: {theme:1},\n\t\tname: \"Calibri\",\n\t\tfamily: 2,\n\t\tscheme: \"minor\"\n\t}));\n\t/* 1*65491BrtFont [ACFONTS] */\n\twrite_record(ba, 0x0264 /* BrtEndFonts */);\n}\n\nfunction write_FILLS_bin(ba) {\n\tvar cnt = 2;\n\n\tif(cnt == 0) return;\n\twrite_record(ba, 0x025B /* BrtBeginFills */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x002D /* BrtFill */, write_BrtFill({patternType:\"none\"}));\n\twrite_record(ba, 0x002D /* BrtFill */, write_BrtFill({patternType:\"gray125\"}));\n\t/* 1*65431BrtFill */\n\twrite_record(ba, 0x025C /* BrtEndFills */);\n}\n\nfunction write_BORDERS_bin(ba) {\n\tvar cnt = 1;\n\n\tif(cnt == 0) return;\n\twrite_record(ba, 0x0265 /* BrtBeginBorders */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x002E /* BrtBorder */, write_BrtBorder({}));\n\t/* 1*65430BrtBorder */\n\twrite_record(ba, 0x0266 /* BrtEndBorders */);\n}\n\nfunction write_CELLSTYLEXFS_bin(ba) {\n\tvar cnt = 1;\n\twrite_record(ba, 0x0272 /* BrtBeginCellStyleXFs */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x002F /* BrtXF */, write_BrtXF({\n\t\tnumFmtId: 0,\n\t\tfontId:   0,\n\t\tfillId:   0,\n\t\tborderId: 0\n\t}, 0xFFFF));\n\t/* 1*65430(BrtXF *FRT) */\n\twrite_record(ba, 0x0273 /* BrtEndCellStyleXFs */);\n}\n\nfunction write_CELLXFS_bin(ba, data) {\n\twrite_record(ba, 0x0269 /* BrtBeginCellXFs */, write_UInt32LE(data.length));\n\tdata.forEach(function(c) { write_record(ba, 0x002F /* BrtXF */, write_BrtXF(c,0)); });\n\t/* 1*65430(BrtXF *FRT) */\n\twrite_record(ba, 0x026A /* BrtEndCellXFs */);\n}\n\nfunction write_STYLES_bin(ba) {\n\tvar cnt = 1;\n\n\twrite_record(ba, 0x026B /* BrtBeginStyles */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x0030 /* BrtStyle */, write_BrtStyle({\n\t\txfId:0,\n\t\tbuiltinId:0,\n\t\tname:\"Normal\"\n\t}));\n\t/* 1*65430(BrtStyle *FRT) */\n\twrite_record(ba, 0x026C /* BrtEndStyles */);\n}\n\nfunction write_DXFS_bin(ba) {\n\tvar cnt = 0;\n\n\twrite_record(ba, 0x01F9 /* BrtBeginDXFs */, write_UInt32LE(cnt));\n\t/* *2147483647(BrtDXF *FRT) */\n\twrite_record(ba, 0x01FA /* BrtEndDXFs */);\n}\n\nfunction write_TABLESTYLES_bin(ba) {\n\tvar cnt = 0;\n\n\twrite_record(ba, 0x01FC /* BrtBeginTableStyles */, write_BrtBeginTableStyles(cnt, \"TableStyleMedium9\", \"PivotStyleMedium4\"));\n\t/* *TABLESTYLE */\n\twrite_record(ba, 0x01FD /* BrtEndTableStyles */);\n}\n\nfunction write_COLORPALETTE_bin() {\n\treturn;\n\t/* BrtBeginColorPalette [INDEXEDCOLORS] [MRUCOLORS] BrtEndColorPalette */\n}\n\n/* [MS-XLSB] 2.1.7.50 Styles */\nfunction write_sty_bin(wb, opts) {\n\tvar ba = buf_array();\n\twrite_record(ba, 0x0116 /* BrtBeginStyleSheet */);\n\twrite_FMTS_bin(ba, wb.SSF);\n\twrite_FONTS_bin(ba, wb);\n\twrite_FILLS_bin(ba, wb);\n\twrite_BORDERS_bin(ba, wb);\n\twrite_CELLSTYLEXFS_bin(ba, wb);\n\twrite_CELLXFS_bin(ba, opts.cellXfs);\n\twrite_STYLES_bin(ba, wb);\n\twrite_DXFS_bin(ba, wb);\n\twrite_TABLESTYLES_bin(ba, wb);\n\twrite_COLORPALETTE_bin(ba, wb);\n\t/* FRTSTYLESHEET*/\n\twrite_record(ba, 0x0117 /* BrtEndStyleSheet */);\n\treturn ba.end();\n}\n/* Even though theme layout is dk1 lt1 dk2 lt2, true order is lt1 dk1 lt2 dk2 */\nvar XLSXThemeClrScheme = [\n\t'</a:lt1>', '</a:dk1>', '</a:lt2>', '</a:dk2>',\n\t'</a:accent1>', '</a:accent2>', '</a:accent3>',\n\t'</a:accent4>', '</a:accent5>', '</a:accent6>',\n\t'</a:hlink>', '</a:folHlink>'\n];\n/* 20.1.6.2 clrScheme CT_ColorScheme */\nfunction parse_clrScheme(t, themes, opts) {\n\tthemes.themeElements.clrScheme = [];\n\tvar color = {};\n\t(t[0].match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(y[0]) {\n\t\t\t/* 20.1.6.2 clrScheme (Color Scheme) CT_ColorScheme */\n\t\t\tcase '<a:clrScheme': case '</a:clrScheme>': break;\n\n\t\t\t/* 20.1.2.3.32 srgbClr CT_SRgbColor */\n\t\t\tcase '<a:srgbClr':\n\t\t\t\tcolor.rgb = y.val; break;\n\n\t\t\t/* 20.1.2.3.33 sysClr CT_SystemColor */\n\t\t\tcase '<a:sysClr':\n\t\t\t\tcolor.rgb = y.lastClr; break;\n\n\t\t\t/* 20.1.4.1.1 accent1 (Accent 1) */\n\t\t\t/* 20.1.4.1.2 accent2 (Accent 2) */\n\t\t\t/* 20.1.4.1.3 accent3 (Accent 3) */\n\t\t\t/* 20.1.4.1.4 accent4 (Accent 4) */\n\t\t\t/* 20.1.4.1.5 accent5 (Accent 5) */\n\t\t\t/* 20.1.4.1.6 accent6 (Accent 6) */\n\t\t\t/* 20.1.4.1.9 dk1 (Dark 1) */\n\t\t\t/* 20.1.4.1.10 dk2 (Dark 2) */\n\t\t\t/* 20.1.4.1.15 folHlink (Followed Hyperlink) */\n\t\t\t/* 20.1.4.1.19 hlink (Hyperlink) */\n\t\t\t/* 20.1.4.1.22 lt1 (Light 1) */\n\t\t\t/* 20.1.4.1.23 lt2 (Light 2) */\n\t\t\tcase '<a:dk1>': case '</a:dk1>':\n\t\t\tcase '<a:lt1>': case '</a:lt1>':\n\t\t\tcase '<a:dk2>': case '</a:dk2>':\n\t\t\tcase '<a:lt2>': case '</a:lt2>':\n\t\t\tcase '<a:accent1>': case '</a:accent1>':\n\t\t\tcase '<a:accent2>': case '</a:accent2>':\n\t\t\tcase '<a:accent3>': case '</a:accent3>':\n\t\t\tcase '<a:accent4>': case '</a:accent4>':\n\t\t\tcase '<a:accent5>': case '</a:accent5>':\n\t\t\tcase '<a:accent6>': case '</a:accent6>':\n\t\t\tcase '<a:hlink>': case '</a:hlink>':\n\t\t\tcase '<a:folHlink>': case '</a:folHlink>':\n\t\t\t\tif (y[0].charAt(1) === '/') {\n\t\t\t\t\tthemes.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(y[0])] = color;\n\t\t\t\t\tcolor = {};\n\t\t\t\t} else {\n\t\t\t\t\tcolor.name = y[0].slice(3, y[0].length - 1);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault: if(opts && opts.WTF) throw new Error('Unrecognized ' + y[0] + ' in clrScheme');\n\t\t}\n\t});\n}\n\n/* 20.1.4.1.18 fontScheme CT_FontScheme */\nfunction parse_fontScheme() { }\n\n/* 20.1.4.1.15 fmtScheme CT_StyleMatrix */\nfunction parse_fmtScheme() { }\n\nvar clrsregex = /<a:clrScheme([^>]*)>[\\s\\S]*<\\/a:clrScheme>/;\nvar fntsregex = /<a:fontScheme([^>]*)>[\\s\\S]*<\\/a:fontScheme>/;\nvar fmtsregex = /<a:fmtScheme([^>]*)>[\\s\\S]*<\\/a:fmtScheme>/;\n\n/* 20.1.6.10 themeElements CT_BaseStyles */\nfunction parse_themeElements(data, themes, opts) {\n\tthemes.themeElements = {};\n\n\tvar t;\n\n\t[\n\t\t/* clrScheme CT_ColorScheme */\n\t\t['clrScheme', clrsregex, parse_clrScheme],\n\t\t/* fontScheme CT_FontScheme */\n\t\t['fontScheme', fntsregex, parse_fontScheme],\n\t\t/* fmtScheme CT_StyleMatrix */\n\t\t['fmtScheme', fmtsregex, parse_fmtScheme]\n\t].forEach(function(m) {\n\t\tif(!(t=data.match(m[1]))) throw new Error(m[0] + ' not found in themeElements');\n\t\tm[2](t, themes, opts);\n\t});\n}\n\nvar themeltregex = /<a:themeElements([^>]*)>[\\s\\S]*<\\/a:themeElements>/;\n\n/* 14.2.7 Theme Part */\nfunction parse_theme_xml(data, opts) {\n\t/* 20.1.6.9 theme CT_OfficeStyleSheet */\n\tif(!data || data.length === 0) data = write_theme();\n\n\tvar t;\n\tvar themes = {};\n\n\t/* themeElements CT_BaseStyles */\n\tif(!(t=data.match(themeltregex))) throw new Error('themeElements not found in theme');\n\tparse_themeElements(t[0], themes, opts);\n\tthemes.raw = data;\n\treturn themes;\n}\n\nfunction write_theme(Themes, opts) {\n\tif(opts && opts.themeXLSX) return opts.themeXLSX;\n\tif(Themes && typeof Themes.raw == \"string\") return Themes.raw;\n\tvar o = [XML_HEADER];\n\to[o.length] = '<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\">';\n\to[o.length] =  '<a:themeElements>';\n\n\to[o.length] =   '<a:clrScheme name=\"Office\">';\n\to[o.length] =    '<a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1>';\n\to[o.length] =    '<a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1>';\n\to[o.length] =    '<a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2>';\n\to[o.length] =    '<a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2>';\n\to[o.length] =    '<a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1>';\n\to[o.length] =    '<a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2>';\n\to[o.length] =    '<a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3>';\n\to[o.length] =    '<a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4>';\n\to[o.length] =    '<a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5>';\n\to[o.length] =    '<a:accent6><a:srgbClr val=\"F79646\"/></a:accent6>';\n\to[o.length] =    '<a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink>';\n\to[o.length] =    '<a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink>';\n\to[o.length] =   '</a:clrScheme>';\n\n\to[o.length] =   '<a:fontScheme name=\"Office\">';\n\to[o.length] =    '<a:majorFont>';\n\to[o.length] =     '<a:latin typeface=\"Cambria\"/>';\n\to[o.length] =     '<a:ea typeface=\"\"/>';\n\to[o.length] =     '<a:cs typeface=\"\"/>';\n\to[o.length] =     '<a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/>';\n\to[o.length] =     '<a:font script=\"Hang\" typeface=\"맑은 고딕\"/>';\n\to[o.length] =     '<a:font script=\"Hans\" typeface=\"宋体\"/>';\n\to[o.length] =     '<a:font script=\"Hant\" typeface=\"新細明體\"/>';\n\to[o.length] =     '<a:font script=\"Arab\" typeface=\"Times New Roman\"/>';\n\to[o.length] =     '<a:font script=\"Hebr\" typeface=\"Times New Roman\"/>';\n\to[o.length] =     '<a:font script=\"Thai\" typeface=\"Tahoma\"/>';\n\to[o.length] =     '<a:font script=\"Ethi\" typeface=\"Nyala\"/>';\n\to[o.length] =     '<a:font script=\"Beng\" typeface=\"Vrinda\"/>';\n\to[o.length] =     '<a:font script=\"Gujr\" typeface=\"Shruti\"/>';\n\to[o.length] =     '<a:font script=\"Khmr\" typeface=\"MoolBoran\"/>';\n\to[o.length] =     '<a:font script=\"Knda\" typeface=\"Tunga\"/>';\n\to[o.length] =     '<a:font script=\"Guru\" typeface=\"Raavi\"/>';\n\to[o.length] =     '<a:font script=\"Cans\" typeface=\"Euphemia\"/>';\n\to[o.length] =     '<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';\n\to[o.length] =     '<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';\n\to[o.length] =     '<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';\n\to[o.length] =     '<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';\n\to[o.length] =     '<a:font script=\"Deva\" typeface=\"Mangal\"/>';\n\to[o.length] =     '<a:font script=\"Telu\" typeface=\"Gautami\"/>';\n\to[o.length] =     '<a:font script=\"Taml\" typeface=\"Latha\"/>';\n\to[o.length] =     '<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';\n\to[o.length] =     '<a:font script=\"Orya\" typeface=\"Kalinga\"/>';\n\to[o.length] =     '<a:font script=\"Mlym\" typeface=\"Kartika\"/>';\n\to[o.length] =     '<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';\n\to[o.length] =     '<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';\n\to[o.length] =     '<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';\n\to[o.length] =     '<a:font script=\"Viet\" typeface=\"Times New Roman\"/>';\n\to[o.length] =     '<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';\n\to[o.length] =     '<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';\n\to[o.length] =    '</a:majorFont>';\n\to[o.length] =    '<a:minorFont>';\n\to[o.length] =     '<a:latin typeface=\"Calibri\"/>';\n\to[o.length] =     '<a:ea typeface=\"\"/>';\n\to[o.length] =     '<a:cs typeface=\"\"/>';\n\to[o.length] =     '<a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/>';\n\to[o.length] =     '<a:font script=\"Hang\" typeface=\"맑은 고딕\"/>';\n\to[o.length] =     '<a:font script=\"Hans\" typeface=\"宋体\"/>';\n\to[o.length] =     '<a:font script=\"Hant\" typeface=\"新細明體\"/>';\n\to[o.length] =     '<a:font script=\"Arab\" typeface=\"Arial\"/>';\n\to[o.length] =     '<a:font script=\"Hebr\" typeface=\"Arial\"/>';\n\to[o.length] =     '<a:font script=\"Thai\" typeface=\"Tahoma\"/>';\n\to[o.length] =     '<a:font script=\"Ethi\" typeface=\"Nyala\"/>';\n\to[o.length] =     '<a:font script=\"Beng\" typeface=\"Vrinda\"/>';\n\to[o.length] =     '<a:font script=\"Gujr\" typeface=\"Shruti\"/>';\n\to[o.length] =     '<a:font script=\"Khmr\" typeface=\"DaunPenh\"/>';\n\to[o.length] =     '<a:font script=\"Knda\" typeface=\"Tunga\"/>';\n\to[o.length] =     '<a:font script=\"Guru\" typeface=\"Raavi\"/>';\n\to[o.length] =     '<a:font script=\"Cans\" typeface=\"Euphemia\"/>';\n\to[o.length] =     '<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';\n\to[o.length] =     '<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';\n\to[o.length] =     '<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';\n\to[o.length] =     '<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';\n\to[o.length] =     '<a:font script=\"Deva\" typeface=\"Mangal\"/>';\n\to[o.length] =     '<a:font script=\"Telu\" typeface=\"Gautami\"/>';\n\to[o.length] =     '<a:font script=\"Taml\" typeface=\"Latha\"/>';\n\to[o.length] =     '<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';\n\to[o.length] =     '<a:font script=\"Orya\" typeface=\"Kalinga\"/>';\n\to[o.length] =     '<a:font script=\"Mlym\" typeface=\"Kartika\"/>';\n\to[o.length] =     '<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';\n\to[o.length] =     '<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';\n\to[o.length] =     '<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';\n\to[o.length] =     '<a:font script=\"Viet\" typeface=\"Arial\"/>';\n\to[o.length] =     '<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';\n\to[o.length] =     '<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';\n\to[o.length] =    '</a:minorFont>';\n\to[o.length] =   '</a:fontScheme>';\n\n\to[o.length] =   '<a:fmtScheme name=\"Office\">';\n\to[o.length] =    '<a:fillStyleLst>';\n\to[o.length] =     '<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';\n\to[o.length] =     '<a:gradFill rotWithShape=\"1\">';\n\to[o.length] =      '<a:gsLst>';\n\to[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n\to[o.length] =      '</a:gsLst>';\n\to[o.length] =      '<a:lin ang=\"16200000\" scaled=\"1\"/>';\n\to[o.length] =     '</a:gradFill>';\n\to[o.length] =     '<a:gradFill rotWithShape=\"1\">';\n\to[o.length] =      '<a:gsLst>';\n\to[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n\to[o.length] =      '</a:gsLst>';\n\to[o.length] =      '<a:lin ang=\"16200000\" scaled=\"0\"/>';\n\to[o.length] =     '</a:gradFill>';\n\to[o.length] =    '</a:fillStyleLst>';\n\to[o.length] =    '<a:lnStyleLst>';\n\to[o.length] =     '<a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n\to[o.length] =     '<a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n\to[o.length] =     '<a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n\to[o.length] =    '</a:lnStyleLst>';\n\to[o.length] =    '<a:effectStyleLst>';\n\to[o.length] =     '<a:effectStyle>';\n\to[o.length] =      '<a:effectLst>';\n\to[o.length] =       '<a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw>';\n\to[o.length] =      '</a:effectLst>';\n\to[o.length] =     '</a:effectStyle>';\n\to[o.length] =     '<a:effectStyle>';\n\to[o.length] =      '<a:effectLst>';\n\to[o.length] =       '<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';\n\to[o.length] =      '</a:effectLst>';\n\to[o.length] =     '</a:effectStyle>';\n\to[o.length] =     '<a:effectStyle>';\n\to[o.length] =      '<a:effectLst>';\n\to[o.length] =       '<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';\n\to[o.length] =      '</a:effectLst>';\n\to[o.length] =      '<a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d>';\n\to[o.length] =      '<a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d>';\n\to[o.length] =     '</a:effectStyle>';\n\to[o.length] =    '</a:effectStyleLst>';\n\to[o.length] =    '<a:bgFillStyleLst>';\n\to[o.length] =     '<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';\n\to[o.length] =     '<a:gradFill rotWithShape=\"1\">';\n\to[o.length] =      '<a:gsLst>';\n\to[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs>';\n\to[o.length] =      '</a:gsLst>';\n\to[o.length] =      '<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path>';\n\to[o.length] =     '</a:gradFill>';\n\to[o.length] =     '<a:gradFill rotWithShape=\"1\">';\n\to[o.length] =      '<a:gsLst>';\n\to[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs>';\n\to[o.length] =      '</a:gsLst>';\n\to[o.length] =      '<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path>';\n\to[o.length] =     '</a:gradFill>';\n\to[o.length] =    '</a:bgFillStyleLst>';\n\to[o.length] =   '</a:fmtScheme>';\n\to[o.length] =  '</a:themeElements>';\n\n\to[o.length] =  '<a:objectDefaults>';\n\to[o.length] =   '<a:spDef>';\n\to[o.length] =    '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style>';\n\to[o.length] =   '</a:spDef>';\n\to[o.length] =   '<a:lnDef>';\n\to[o.length] =    '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style>';\n\to[o.length] =   '</a:lnDef>';\n\to[o.length] =  '</a:objectDefaults>';\n\to[o.length] =  '<a:extraClrSchemeLst/>';\n\to[o.length] = '</a:theme>';\n\treturn o.join(\"\");\n}\n/* [MS-XLS] 2.4.326 TODO: payload is a zip file */\nfunction parse_Theme(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar dwThemeVersion = blob.read_shift(4);\n\tif(dwThemeVersion === 124226) return;\n\tif(!opts.cellStyles) { blob.l = end; return; }\n\tvar data = blob.slice(blob.l);\n\tblob.l = end;\n\tvar zip; try { zip = zip_read(data, {type: \"array\"}); } catch(e) { return; }\n\tvar themeXML = getzipstr(zip, \"theme/theme/theme1.xml\", true);\n\tif(!themeXML) return;\n\treturn parse_theme_xml(themeXML, opts);\n}\n\n/* 2.5.49 */\nfunction parse_ColorTheme(blob) { return blob.read_shift(4); }\n\n/* 2.5.155 */\nfunction parse_FullColorExt(blob) {\n\tvar o = {};\n\to.xclrType = blob.read_shift(2);\n\to.nTintShade = blob.read_shift(2);\n\tswitch(o.xclrType) {\n\t\tcase 0: blob.l += 4; break;\n\t\tcase 1: o.xclrValue = parse_IcvXF(blob, 4); break;\n\t\tcase 2: o.xclrValue = parse_LongRGBA(blob, 4); break;\n\t\tcase 3: o.xclrValue = parse_ColorTheme(blob, 4); break;\n\t\tcase 4: blob.l += 4; break;\n\t}\n\tblob.l += 8;\n\treturn o;\n}\n\n/* 2.5.164 TODO: read 7 bits*/\nfunction parse_IcvXF(blob, length) {\n\treturn parsenoop(blob, length);\n}\n\n/* 2.5.280 */\nfunction parse_XFExtGradient(blob, length) {\n\treturn parsenoop(blob, length);\n}\n\n/* [MS-XLS] 2.5.108 */\nfunction parse_ExtProp(blob) {\n\tvar extType = blob.read_shift(2);\n\tvar cb = blob.read_shift(2) - 4;\n\tvar o = [extType];\n\tswitch(extType) {\n\t\tcase 0x04: case 0x05: case 0x07: case 0x08:\n\t\tcase 0x09: case 0x0A: case 0x0B: case 0x0D:\n\t\t\to[1] = parse_FullColorExt(blob, cb); break;\n\t\tcase 0x06: o[1] = parse_XFExtGradient(blob, cb); break;\n\t\tcase 0x0E: case 0x0F: o[1] = blob.read_shift(cb === 1 ? 1 : 2); break;\n\t\tdefault: throw new Error(\"Unrecognized ExtProp type: \" + extType + \" \" + cb);\n\t}\n\treturn o;\n}\n\n/* 2.4.355 */\nfunction parse_XFExt(blob, length) {\n\tvar end = blob.l + length;\n\tblob.l += 2;\n\tvar ixfe = blob.read_shift(2);\n\tblob.l += 2;\n\tvar cexts = blob.read_shift(2);\n\tvar ext = [];\n\twhile(cexts-- > 0) ext.push(parse_ExtProp(blob, end-blob.l));\n\treturn {ixfe:ixfe, ext:ext};\n}\n\n/* xf is an XF, see parse_XFExt for xfext */\nfunction update_xfext(xf, xfext) {\n\txfext.forEach(function(xfe) {\n\t\tswitch(xfe[0]) { /* 2.5.108 extPropData */\n\t\t\tcase 0x04: break; /* foreground color */\n\t\t\tcase 0x05: break; /* background color */\n\t\t\tcase 0x06: break; /* gradient fill */\n\t\t\tcase 0x07: break; /* top cell border color */\n\t\t\tcase 0x08: break; /* bottom cell border color */\n\t\t\tcase 0x09: break; /* left cell border color */\n\t\t\tcase 0x0a: break; /* right cell border color */\n\t\t\tcase 0x0b: break; /* diagonal cell border color */\n\t\t\tcase 0x0d: /* text color */\n\t\t\t\tbreak;\n\t\t\tcase 0x0e: break; /* font scheme */\n\t\t\tcase 0x0f: break; /* indentation level */\n\t\t}\n\t});\n}\n\nfunction parse_BrtMdtinfo(data, length) {\n  return {\n    flags: data.read_shift(4),\n    version: data.read_shift(4),\n    name: parse_XLWideString(data, length - 8)\n  };\n}\nfunction write_BrtMdtinfo(data) {\n  var o = new_buf(12 + 2 * data.name.length);\n  o.write_shift(4, data.flags);\n  o.write_shift(4, data.version);\n  write_XLWideString(data.name, o);\n  return o.slice(0, o.l);\n}\nfunction parse_BrtMdb(data) {\n  var out = [];\n  var cnt = data.read_shift(4);\n  while (cnt-- > 0)\n    out.push([data.read_shift(4), data.read_shift(4)]);\n  return out;\n}\nfunction write_BrtMdb(mdb) {\n  var o = new_buf(4 + 8 * mdb.length);\n  o.write_shift(4, mdb.length);\n  for (var i = 0; i < mdb.length; ++i) {\n    o.write_shift(4, mdb[i][0]);\n    o.write_shift(4, mdb[i][1]);\n  }\n  return o;\n}\nfunction write_BrtBeginEsfmd(cnt, name) {\n  var o = new_buf(8 + 2 * name.length);\n  o.write_shift(4, cnt);\n  write_XLWideString(name, o);\n  return o.slice(0, o.l);\n}\nfunction parse_BrtBeginEsmdb(data) {\n  data.l += 4;\n  return data.read_shift(4) != 0;\n}\nfunction write_BrtBeginEsmdb(cnt, cm) {\n  var o = new_buf(8);\n  o.write_shift(4, cnt);\n  o.write_shift(4, cm ? 1 : 0);\n  return o;\n}\nfunction parse_xlmeta_bin(data, name, _opts) {\n  var out = { Types: [], Cell: [], Value: [] };\n  var opts = _opts || {};\n  var state = [];\n  var pass = false;\n  var metatype = 2;\n  recordhopper(data, function(val, R, RT) {\n    switch (RT) {\n      case 335:\n        out.Types.push({ name: val.name });\n        break;\n      case 51:\n        val.forEach(function(r) {\n          if (metatype == 1)\n            out.Cell.push({ type: out.Types[r[0] - 1].name, index: r[1] });\n          else if (metatype == 0)\n            out.Value.push({ type: out.Types[r[0] - 1].name, index: r[1] });\n        });\n        break;\n      case 337:\n        metatype = val ? 1 : 0;\n        break;\n      case 338:\n        metatype = 2;\n        break;\n      case 35:\n        state.push(RT);\n        pass = true;\n        break;\n      case 36:\n        state.pop();\n        pass = false;\n        break;\n      default:\n        if (R.T) {\n        } else if (!pass || opts.WTF && state[state.length - 1] != 35)\n          throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n    }\n  });\n  return out;\n}\nfunction write_xlmeta_bin() {\n  var ba = buf_array();\n  write_record(ba, 332);\n  write_record(ba, 334, write_UInt32LE(1));\n  write_record(ba, 335, write_BrtMdtinfo({\n    name: \"XLDAPR\",\n    version: 12e4,\n    flags: 3496657072\n  }));\n  write_record(ba, 336);\n  write_record(ba, 339, write_BrtBeginEsfmd(1, \"XLDAPR\"));\n  write_record(ba, 52);\n  write_record(ba, 35, write_UInt32LE(514));\n  write_record(ba, 4096, write_UInt32LE(0));\n  write_record(ba, 4097, writeuint16(1));\n  write_record(ba, 36);\n  write_record(ba, 53);\n  write_record(ba, 340);\n  write_record(ba, 337, write_BrtBeginEsmdb(1, true));\n  write_record(ba, 51, write_BrtMdb([[1, 0]]));\n  write_record(ba, 338);\n  write_record(ba, 333);\n  return ba.end();\n}\nfunction parse_xlmeta_xml(data, name, opts) {\n  var out = { Types: [], Cell: [], Value: [] };\n  if (!data)\n    return out;\n  var pass = false;\n  var metatype = 2;\n  var lastmeta;\n  data.replace(tagregex, function(x) {\n    var y = parsexmltag(x);\n    switch (strip_ns(y[0])) {\n      case \"<?xml\":\n        break;\n      case \"<metadata\":\n      case \"</metadata>\":\n        break;\n      case \"<metadataTypes\":\n      case \"</metadataTypes>\":\n        break;\n      case \"<metadataType\":\n        out.Types.push({ name: y.name });\n        break;\n      case \"</metadataType>\":\n        break;\n      case \"<futureMetadata\":\n        for (var j = 0; j < out.Types.length; ++j)\n          if (out.Types[j].name == y.name)\n            lastmeta = out.Types[j];\n        break;\n      case \"</futureMetadata>\":\n        break;\n      case \"<bk>\":\n        break;\n      case \"</bk>\":\n        break;\n      case \"<rc\":\n        if (metatype == 1)\n          out.Cell.push({ type: out.Types[y.t - 1].name, index: +y.v });\n        else if (metatype == 0)\n          out.Value.push({ type: out.Types[y.t - 1].name, index: +y.v });\n        break;\n      case \"</rc>\":\n        break;\n      case \"<cellMetadata\":\n        metatype = 1;\n        break;\n      case \"</cellMetadata>\":\n        metatype = 2;\n        break;\n      case \"<valueMetadata\":\n        metatype = 0;\n        break;\n      case \"</valueMetadata>\":\n        metatype = 2;\n        break;\n      case \"<extLst\":\n      case \"<extLst>\":\n      case \"</extLst>\":\n      case \"<extLst/>\":\n        break;\n      case \"<ext\":\n        pass = true;\n        break;\n      case \"</ext>\":\n        pass = false;\n        break;\n      case \"<rvb\":\n        if (!lastmeta)\n          break;\n        if (!lastmeta.offsets)\n          lastmeta.offsets = [];\n        lastmeta.offsets.push(+y.i);\n        break;\n      default:\n        if (!pass && opts.WTF)\n          throw new Error(\"unrecognized \" + y[0] + \" in metadata\");\n    }\n    return x;\n  });\n  return out;\n}\nfunction write_xlmeta_xml() {\n  var o = [XML_HEADER];\n  o.push('<metadata xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:xlrd=\"http://schemas.microsoft.com/office/spreadsheetml/2017/richdata\" xmlns:xda=\"http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray\">\\n  <metadataTypes count=\"1\">\\n    <metadataType name=\"XLDAPR\" minSupportedVersion=\"120000\" copy=\"1\" pasteAll=\"1\" pasteValues=\"1\" merge=\"1\" splitFirst=\"1\" rowColShift=\"1\" clearFormats=\"1\" clearComments=\"1\" assign=\"1\" coerce=\"1\" cellMeta=\"1\"/>\\n  </metadataTypes>\\n  <futureMetadata name=\"XLDAPR\" count=\"1\">\\n    <bk>\\n      <extLst>\\n        <ext uri=\"{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}\">\\n          <xda:dynamicArrayProperties fDynamic=\"1\" fCollapsed=\"0\"/>\\n        </ext>\\n      </extLst>\\n    </bk>\\n  </futureMetadata>\\n  <cellMetadata count=\"1\">\\n    <bk>\\n      <rc t=\"1\" v=\"0\"/>\\n    </bk>\\n  </cellMetadata>\\n</metadata>');\n  return o.join(\"\");\n}\n/* 18.6 Calculation Chain */\nfunction parse_cc_xml(data) {\n\tvar d = [];\n\tif(!data) return d;\n\tvar i = 1;\n\t(data.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(y[0]) {\n\t\t\tcase '<?xml': break;\n\t\t\t/* 18.6.2  calcChain CT_CalcChain 1 */\n\t\t\tcase '<calcChain': case '<calcChain>': case '</calcChain>': break;\n\t\t\t/* 18.6.1  c CT_CalcCell 1 */\n\t\t\tcase '<c': delete y[0]; if(y.i) i = y.i; else y.i = i; d.push(y); break;\n\t\t}\n\t});\n\treturn d;\n}\n\n//function write_cc_xml(data, opts) { }\n\n/* [MS-XLSB] 2.6.4.1 */\nfunction parse_BrtCalcChainItem$(data) {\n\tvar out = {};\n\tout.i = data.read_shift(4);\n\tvar cell = {};\n\tcell.r = data.read_shift(4);\n\tcell.c = data.read_shift(4);\n\tout.r = encode_cell(cell);\n\tvar flags = data.read_shift(1);\n\tif(flags & 0x2) out.l = '1';\n\tif(flags & 0x8) out.a = '1';\n\treturn out;\n}\n\n/* 18.6 Calculation Chain */\nfunction parse_cc_bin(data, name, opts) {\n\tvar out = [];\n\tvar pass = false;\n\trecordhopper(data, function hopper_cc(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x003F: /* 'BrtCalcChainItem$' */\n\t\t\t\tout.push(val); break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){/* empty */}\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t});\n\treturn out;\n}\n\n//function write_cc_bin(data, opts) { }\n/* 18.14 Supplementary Workbook Data */\nfunction parse_xlink_xml() {\n\t//var opts = _opts || {};\n\t//if(opts.WTF) throw \"XLSX External Link\";\n}\n\n/* [MS-XLSB] 2.1.7.25 External Link */\nfunction parse_xlink_bin(data, rel, name, _opts) {\n\tif(!data) return data;\n\tvar opts = _opts || {};\n\n\tvar pass = false, end = false;\n\n\trecordhopper(data, function xlink_parse(val, R, RT) {\n\t\tif(end) return;\n\t\tswitch(RT) {\n\t\t\tcase 0x0167: /* 'BrtSupTabs' */\n\t\t\tcase 0x016B: /* 'BrtExternTableStart' */\n\t\t\tcase 0x016C: /* 'BrtExternTableEnd' */\n\t\t\tcase 0x016E: /* 'BrtExternRowHdr' */\n\t\t\tcase 0x016F: /* 'BrtExternCellBlank' */\n\t\t\tcase 0x0170: /* 'BrtExternCellReal' */\n\t\t\tcase 0x0171: /* 'BrtExternCellBool' */\n\t\t\tcase 0x0172: /* 'BrtExternCellError' */\n\t\t\tcase 0x0173: /* 'BrtExternCellString' */\n\t\t\tcase 0x01D8: /* 'BrtExternValueMeta' */\n\t\t\tcase 0x0241: /* 'BrtSupNameStart' */\n\t\t\tcase 0x0242: /* 'BrtSupNameValueStart' */\n\t\t\tcase 0x0243: /* 'BrtSupNameValueEnd' */\n\t\t\tcase 0x0244: /* 'BrtSupNameNum' */\n\t\t\tcase 0x0245: /* 'BrtSupNameErr' */\n\t\t\tcase 0x0246: /* 'BrtSupNameSt' */\n\t\t\tcase 0x0247: /* 'BrtSupNameNil' */\n\t\t\tcase 0x0248: /* 'BrtSupNameBool' */\n\t\t\tcase 0x0249: /* 'BrtSupNameFmla' */\n\t\t\tcase 0x024A: /* 'BrtSupNameBits' */\n\t\t\tcase 0x024B: /* 'BrtSupNameEnd' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tpass = false; break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){/* empty */}\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t}, opts);\n}\n/* 20.5 DrawingML - SpreadsheetML Drawing */\n/* 20.5.2.35 wsDr CT_Drawing */\nfunction parse_drawing(data, rels) {\n\tif(!data) return \"??\";\n\t/*\n\t  Chartsheet Drawing:\n\t   - 20.5.2.35 wsDr CT_Drawing\n\t    - 20.5.2.1  absoluteAnchor CT_AbsoluteAnchor\n\t     - 20.5.2.16 graphicFrame CT_GraphicalObjectFrame\n\t      - 20.1.2.2.16 graphic CT_GraphicalObject\n\t       - 20.1.2.2.17 graphicData CT_GraphicalObjectData\n          - chart reference\n\t   the actual type is based on the URI of the graphicData\n\t\tTODO: handle embedded charts and other types of graphics\n\t*/\n\tvar id = (data.match(/<c:chart [^>]*r:id=\"([^\"]*)\"/)||[\"\",\"\"])[1];\n\n\treturn rels['!id'][id].Target;\n}\n\n/* L.5.5.2 SpreadsheetML Comments + VML Schema */\nvar _shapeid = 1024;\nfunction write_comments_vml(rId, comments) {\n\tvar csize = [21600, 21600];\n\t/* L.5.2.1.2 Path Attribute */\n\tvar bbox = [\"m0,0l0\",csize[1],csize[0],csize[1],csize[0],\"0xe\"].join(\",\");\n\tvar o = [\n\t\twritextag(\"xml\", null, { 'xmlns:v': XLMLNS.v, 'xmlns:o': XLMLNS.o, 'xmlns:x': XLMLNS.x, 'xmlns:mv': XLMLNS.mv }).replace(/\\/>/,\">\"),\n\t\twritextag(\"o:shapelayout\", writextag(\"o:idmap\", null, {'v:ext':\"edit\", 'data':rId}), {'v:ext':\"edit\"}),\n\t\twritextag(\"v:shapetype\", [\n\t\t\twritextag(\"v:stroke\", null, {joinstyle:\"miter\"}),\n\t\t\twritextag(\"v:path\", null, {gradientshapeok:\"t\", 'o:connecttype':\"rect\"})\n\t\t].join(\"\"), {id:\"_x0000_t202\", 'o:spt':202, coordsize:csize.join(\",\"),path:bbox})\n\t];\n\twhile(_shapeid < rId * 1000) _shapeid += 1000;\n\n\tcomments.forEach(function(x) {\n\tvar c = decode_cell(x[0]);\n\tvar fillopts = {'color2':\"#BEFF82\", 'type':\"gradient\"};\n\tif(fillopts.type == \"gradient\") fillopts.angle = \"-180\";\n\tvar fillparm = fillopts.type == \"gradient\" ? writextag(\"o:fill\", null, {type:\"gradientUnscaled\", 'v:ext':\"view\"}) : null;\n\tvar fillxml = writextag('v:fill', fillparm, fillopts);\n\n\tvar shadata = ({on:\"t\", 'obscured':\"t\"});\n\t++_shapeid;\n\n\to = o.concat([\n\t'<v:shape' + wxt_helper({\n\t\tid:'_x0000_s' + _shapeid,\n\t\ttype:\"#_x0000_t202\",\n\t\tstyle:\"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10\" + (x[1].hidden ? \";visibility:hidden\" : \"\") ,\n\t\tfillcolor:\"#ECFAD4\",\n\t\tstrokecolor:\"#edeaa1\"\n\t}) + '>',\n\t\tfillxml,\n\t\twritextag(\"v:shadow\", null, shadata),\n\t\twritextag(\"v:path\", null, {'o:connecttype':\"none\"}),\n\t\t'<v:textbox><div style=\"text-align:left\"></div></v:textbox>',\n\t\t'<x:ClientData ObjectType=\"Note\">',\n\t\t\t'<x:MoveWithCells/>',\n\t\t\t'<x:SizeWithCells/>',\n\t\t\t/* Part 4 19.4.2.3 Anchor (Anchor) */\n\t\t\twritetag('x:Anchor', [c.c+1, 0, c.r+1, 0, c.c+3, 20, c.r+5, 20].join(\",\")),\n\t\t\twritetag('x:AutoFill', \"False\"),\n\t\t\twritetag('x:Row', String(c.r)),\n\t\t\twritetag('x:Column', String(c.c)),\n\t\t\tx[1].hidden ? '' : '<x:Visible/>',\n\t\t'</x:ClientData>',\n\t'</v:shape>'\n\t]); });\n\to.push('</xml>');\n\treturn o.join(\"\");\n}\nfunction sheet_insert_comments(sheet, comments, threaded, people) {\n\tvar dense = Array.isArray(sheet);\n\tvar cell;\n\tcomments.forEach(function(comment) {\n\t\tvar r = decode_cell(comment.ref);\n\t\tif(dense) {\n\t\t\tif(!sheet[r.r]) sheet[r.r] = [];\n\t\t\tcell = sheet[r.r][r.c];\n\t\t} else cell = sheet[comment.ref];\n\t\tif (!cell) {\n\t\t\tcell = ({t:\"z\"});\n\t\t\tif(dense) sheet[r.r][r.c] = cell;\n\t\t\telse sheet[comment.ref] = cell;\n\t\t\tvar range = safe_decode_range(sheet[\"!ref\"]||\"BDWGO1000001:A1\");\n\t\t\tif(range.s.r > r.r) range.s.r = r.r;\n\t\t\tif(range.e.r < r.r) range.e.r = r.r;\n\t\t\tif(range.s.c > r.c) range.s.c = r.c;\n\t\t\tif(range.e.c < r.c) range.e.c = r.c;\n\t\t\tvar encoded = encode_range(range);\n\t\t\tif (encoded !== sheet[\"!ref\"]) sheet[\"!ref\"] = encoded;\n\t\t}\n\n\t\tif (!cell.c) cell.c = [];\n\t\tvar o = ({a: comment.author, t: comment.t, r: comment.r, T: threaded});\n\t\tif(comment.h) o.h = comment.h;\n\n\t\t/* threaded comments always override */\n\t\tfor(var i = cell.c.length - 1; i >= 0; --i) {\n\t\t\tif(!threaded && cell.c[i].T) return;\n\t\t\tif(threaded && !cell.c[i].T) cell.c.splice(i, 1);\n\t\t}\n\t\tif(threaded && people) for(i = 0; i < people.length; ++i) {\n\t\t\tif(o.a == people[i].id) { o.a = people[i].name || o.a; break; }\n\t\t}\n\t\tcell.c.push(o);\n\t});\n}\n\n/* 18.7 Comments */\nfunction parse_comments_xml(data, opts) {\n\t/* 18.7.6 CT_Comments */\n\tif(data.match(/<(?:\\w+:)?comments *\\/>/)) return [];\n\tvar authors = [];\n\tvar commentList = [];\n\tvar authtag = data.match(/<(?:\\w+:)?authors>([\\s\\S]*)<\\/(?:\\w+:)?authors>/);\n\tif(authtag && authtag[1]) authtag[1].split(/<\\/\\w*:?author>/).forEach(function(x) {\n\t\tif(x === \"\" || x.trim() === \"\") return;\n\t\tvar a = x.match(/<(?:\\w+:)?author[^>]*>(.*)/);\n\t\tif(a) authors.push(a[1]);\n\t});\n\tvar cmnttag = data.match(/<(?:\\w+:)?commentList>([\\s\\S]*)<\\/(?:\\w+:)?commentList>/);\n\tif(cmnttag && cmnttag[1]) cmnttag[1].split(/<\\/\\w*:?comment>/).forEach(function(x) {\n\t\tif(x === \"\" || x.trim() === \"\") return;\n\t\tvar cm = x.match(/<(?:\\w+:)?comment[^>]*>/);\n\t\tif(!cm) return;\n\t\tvar y = parsexmltag(cm[0]);\n\t\tvar comment = ({ author: y.authorId && authors[y.authorId] || \"sheetjsghost\", ref: y.ref, guid: y.guid });\n\t\tvar cell = decode_cell(y.ref);\n\t\tif(opts.sheetRows && opts.sheetRows <= cell.r) return;\n\t\tvar textMatch = x.match(/<(?:\\w+:)?text>([\\s\\S]*)<\\/(?:\\w+:)?text>/);\n\t\tvar rt = !!textMatch && !!textMatch[1] && parse_si(textMatch[1]) || {r:\"\",t:\"\",h:\"\"};\n\t\tcomment.r = rt.r;\n\t\tif(rt.r == \"<t></t>\") rt.t = rt.h = \"\";\n\t\tcomment.t = (rt.t||\"\").replace(/\\r\\n/g,\"\\n\").replace(/\\r/g,\"\\n\");\n\t\tif(opts.cellHTML) comment.h = rt.h;\n\t\tcommentList.push(comment);\n\t});\n\treturn commentList;\n}\n\nfunction write_comments_xml(data) {\n\tvar o = [XML_HEADER, writextag('comments', null, { 'xmlns': XMLNS_main[0] })];\n\n\tvar iauthor = [];\n\to.push(\"<authors>\");\n\tdata.forEach(function(x) { x[1].forEach(function(w) { var a = escapexml(w.a);\n\t\tif(iauthor.indexOf(a) == -1) {\n\t\t\tiauthor.push(a);\n\t\t\to.push(\"<author>\" + a + \"</author>\");\n\t\t}\n\t\tif(w.T && w.ID && iauthor.indexOf(\"tc=\" + w.ID) == -1) {\n\t\t\tiauthor.push(\"tc=\" + w.ID);\n\t\t\to.push(\"<author>\" + \"tc=\" + w.ID + \"</author>\");\n\t\t}\n\t}); });\n\tif(iauthor.length == 0) { iauthor.push(\"SheetJ5\"); o.push(\"<author>SheetJ5</author>\"); }\n\to.push(\"</authors>\");\n\to.push(\"<commentList>\");\n\tdata.forEach(function(d) {\n\t\t/* 18.7.3 CT_Comment */\n\t\tvar lastauthor = 0, ts = [];\n\t\tif(d[1][0] && d[1][0].T && d[1][0].ID) lastauthor = iauthor.indexOf(\"tc=\" + d[1][0].ID);\n\t\telse d[1].forEach(function(c) {\n\t\t\tif(c.a) lastauthor = iauthor.indexOf(escapexml(c.a));\n\t\t\tts.push(c.t||\"\");\n\t\t});\n\t\to.push('<comment ref=\"' + d[0] + '\" authorId=\"' + lastauthor + '\"><text>');\n\t\tif(ts.length <= 1) o.push(writetag(\"t\", escapexml(ts[0]||\"\")));\n\t\telse {\n\t\t\t/* based on Threaded Comments -> Comments projection */\n\t\t\tvar t = \"Comment:\\n    \" + (ts[0]) + \"\\n\";\n\t\t\tfor(var i = 1; i < ts.length; ++i) t += \"Reply:\\n    \" + ts[i] + \"\\n\";\n\t\t\to.push(writetag(\"t\", escapexml(t)));\n\t\t}\n\t\to.push('</text></comment>');\n\t});\n\to.push(\"</commentList>\");\n\tif(o.length>2) { o[o.length] = ('</comments>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n\n/* [MS-XLSX] 2.1.17 */\nfunction parse_tcmnt_xml(data, opts) {\n\tvar out = [];\n\tvar pass = false, comment = {}, tidx = 0;\n\tdata.replace(tagregex, function xml_tcmnt(x, idx) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\n\t\t\t/* 2.6.207 ThreadedComments CT_ThreadedComments */\n\t\t\tcase '<ThreadedComments': break;\n\t\t\tcase '</ThreadedComments>': break;\n\n\t\t\t/* 2.6.205 threadedComment CT_ThreadedComment */\n\t\t\tcase '<threadedComment': comment = {author: y.personId, guid: y.id, ref: y.ref, T: 1}; break;\n\t\t\tcase '</threadedComment>': if(comment.t != null) out.push(comment); break;\n\n\t\t\tcase '<text>': case '<text': tidx = idx + x.length; break;\n\t\t\tcase '</text>': comment.t = data.slice(tidx, idx).replace(/\\r\\n/g, \"\\n\").replace(/\\r/g, \"\\n\"); break;\n\n\t\t\t/* 2.6.206 mentions CT_ThreadedCommentMentions TODO */\n\t\t\tcase '<mentions': case '<mentions>': pass = true; break;\n\t\t\tcase '</mentions>': pass = false; break;\n\n\t\t\t/* 2.6.202 mention CT_Mention TODO */\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': case '<extLst/>': break;\n\t\t\t/* 18.2.7  ext CT_Extension + */\n\t\t\tcase '<ext': pass=true; break;\n\t\t\tcase '</ext>': pass=false; break;\n\n\t\t\tdefault: if(!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in threaded comments');\n\t\t}\n\t\treturn x;\n\t});\n\treturn out;\n}\n\nfunction write_tcmnt_xml(comments, people, opts) {\n\tvar o = [XML_HEADER, writextag('ThreadedComments', null, { 'xmlns': XMLNS.TCMNT }).replace(/[\\/]>/, \">\")];\n\tcomments.forEach(function(carr) {\n\t\tvar rootid = \"\";\n\t\t(carr[1] || []).forEach(function(c, idx) {\n\t\t\tif(!c.T) { delete c.ID; return; }\n\t\t\tif(c.a && people.indexOf(c.a) == -1) people.push(c.a);\n\t\t\tvar tcopts = {\n\t\t\t\tref: carr[0],\n\t\t\t\tid: \"{54EE7951-7262-4200-6969-\" + (\"000000000000\" + opts.tcid++).slice(-12) + \"}\"\n\t\t\t};\n\t\t\tif(idx == 0) rootid = tcopts.id;\n\t\t\telse tcopts.parentId = rootid;\n\t\t\tc.ID = tcopts.id;\n\t\t\tif(c.a) tcopts.personId = \"{54EE7950-7262-4200-6969-\" + (\"000000000000\" + people.indexOf(c.a)).slice(-12) + \"}\";\n\t\t\to.push(writextag('threadedComment', writetag('text', c.t||\"\"), tcopts));\n\t\t});\n\t});\n\to.push('</ThreadedComments>');\n\treturn o.join(\"\");\n}\n\n/* [MS-XLSX] 2.1.18 */\nfunction parse_people_xml(data, opts) {\n\tvar out = [];\n\tvar pass = false;\n\tdata.replace(tagregex, function xml_tcmnt(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\n\t\t\t/* 2.4.85 personList CT_PersonList */\n\t\t\tcase '<personList': break;\n\t\t\tcase '</personList>': break;\n\n\t\t\t/* 2.6.203 person CT_Person TODO: providers */\n\t\t\tcase '<person': out.push({name: y.displayname, id: y.id }); break;\n\t\t\tcase '</person>': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': case '<extLst/>': break;\n\t\t\t/* 18.2.7  ext CT_Extension + */\n\t\t\tcase '<ext': pass=true; break;\n\t\t\tcase '</ext>': pass=false; break;\n\n\t\t\tdefault: if(!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in threaded comments');\n\t\t}\n\t\treturn x;\n\t});\n\treturn out;\n}\nfunction write_people_xml(people/*, opts*/) {\n\tvar o = [XML_HEADER, writextag('personList', null, {\n\t\t'xmlns': XMLNS.TCMNT,\n\t\t'xmlns:x': XMLNS_main[0]\n\t}).replace(/[\\/]>/, \">\")];\n\tpeople.forEach(function(person, idx) {\n\t\to.push(writextag('person', null, {\n\t\t\tdisplayName: person,\n\t\t\tid: \"{54EE7950-7262-4200-6969-\" + (\"000000000000\" + idx).slice(-12) + \"}\",\n\t\t\tuserId: person,\n\t\t\tproviderId: \"None\"\n\t\t}));\n\t});\n\to.push(\"</personList>\");\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.28 BrtBeginComment */\nfunction parse_BrtBeginComment(data) {\n\tvar out = {};\n\tout.iauthor = data.read_shift(4);\n\tvar rfx = parse_UncheckedRfX(data, 16);\n\tout.rfx = rfx.s;\n\tout.ref = encode_cell(rfx.s);\n\tdata.l += 16; /*var guid = parse_GUID(data); */\n\treturn out;\n}\nfunction write_BrtBeginComment(data, o) {\n\tif(o == null) o = new_buf(36);\n\to.write_shift(4, data[1].iauthor);\n\twrite_UncheckedRfX((data[0]), o);\n\to.write_shift(4, 0);\n\to.write_shift(4, 0);\n\to.write_shift(4, 0);\n\to.write_shift(4, 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.327 BrtCommentAuthor */\nvar parse_BrtCommentAuthor = parse_XLWideString;\nfunction write_BrtCommentAuthor(data) { return write_XLWideString(data.slice(0, 54)); }\n\n/* [MS-XLSB] 2.1.7.8 Comments */\nfunction parse_comments_bin(data, opts) {\n\tvar out = [];\n\tvar authors = [];\n\tvar c = {};\n\tvar pass = false;\n\trecordhopper(data, function hopper_cmnt(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x0278: /* 'BrtCommentAuthor' */\n\t\t\t\tauthors.push(val); break;\n\t\t\tcase 0x027B: /* 'BrtBeginComment' */\n\t\t\t\tc = val; break;\n\t\t\tcase 0x027D: /* 'BrtCommentText' */\n\t\t\t\tc.t = val.t; c.h = val.h; c.r = val.r; break;\n\t\t\tcase 0x027C: /* 'BrtEndComment' */\n\t\t\t\tc.author = authors[c.iauthor];\n\t\t\t\tdelete (c).iauthor;\n\t\t\t\tif(opts.sheetRows && c.rfx && opts.sheetRows <= c.rfx.r) break;\n\t\t\t\tif(!c.t) c.t = \"\";\n\t\t\t\tdelete c.rfx; out.push(c); break;\n\n\t\t\tcase 0x0C00: /* 'BrtUid' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tpass = false; break;\n\t\t\tcase 0x0025: /* 'BrtACBegin' */ break;\n\t\t\tcase 0x0026: /* 'BrtACEnd' */ break;\n\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){/* empty */}\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t});\n\treturn out;\n}\n\nfunction write_comments_bin(data) {\n\tvar ba = buf_array();\n\tvar iauthor = [];\n\twrite_record(ba, 0x0274 /* BrtBeginComments */);\n\n\twrite_record(ba, 0x0276 /* BrtBeginCommentAuthors */);\n\tdata.forEach(function(comment) {\n\t\tcomment[1].forEach(function(c) {\n\t\t\tif(iauthor.indexOf(c.a) > -1) return;\n\t\t\tiauthor.push(c.a.slice(0,54));\n\t\t\twrite_record(ba, 0x0278 /* BrtCommentAuthor */, write_BrtCommentAuthor(c.a));\n\t\t});\n\t});\n\twrite_record(ba, 0x0277 /* BrtEndCommentAuthors */);\n\n\twrite_record(ba, 0x0279 /* BrtBeginCommentList */);\n\tdata.forEach(function(comment) {\n\t\tcomment[1].forEach(function(c) {\n\t\t\tc.iauthor = iauthor.indexOf(c.a);\n\t\t\tvar range = {s:decode_cell(comment[0]),e:decode_cell(comment[0])};\n\t\t\twrite_record(ba, 0x027B /* BrtBeginComment */, write_BrtBeginComment([range, c]));\n\t\t\tif(c.t && c.t.length > 0) write_record(ba, 0x027D /* BrtCommentText */, write_BrtCommentText(c));\n\t\t\twrite_record(ba, 0x027C /* BrtEndComment */);\n\t\t\tdelete c.iauthor;\n\t\t});\n\t});\n\twrite_record(ba, 0x027A /* BrtEndCommentList */);\n\n\twrite_record(ba, 0x0275 /* BrtEndComments */);\n\treturn ba.end();\n}\nvar CT_VBA = \"application/vnd.ms-office.vbaProject\";\nfunction make_vba_xls(cfb) {\n  var newcfb = CFB.utils.cfb_new({ root: \"R\" });\n  cfb.FullPaths.forEach(function(p, i) {\n    if (p.slice(-1) === \"/\" || !p.match(/_VBA_PROJECT_CUR/))\n      return;\n    var newpath = p.replace(/^[^\\/]*/, \"R\").replace(/\\/_VBA_PROJECT_CUR\\u0000*/, \"\");\n    CFB.utils.cfb_add(newcfb, newpath, cfb.FileIndex[i].content);\n  });\n  return CFB.write(newcfb);\n}\nfunction fill_vba_xls(cfb, vba) {\n  vba.FullPaths.forEach(function(p, i) {\n    if (i == 0)\n      return;\n    var newpath = p.replace(/[^\\/]*[\\/]/, \"/_VBA_PROJECT_CUR/\");\n    if (newpath.slice(-1) !== \"/\")\n      CFB.utils.cfb_add(cfb, newpath, vba.FileIndex[i].content);\n  });\n}\nvar VBAFMTS = [\"xlsb\", \"xlsm\", \"xlam\", \"biff8\", \"xla\"];\n/* macro and dialog sheet stubs */\nfunction parse_ds_bin() { return {'!type':'dialog'}; }\nfunction parse_ds_xml() { return {'!type':'dialog'}; }\nfunction parse_ms_bin() { return {'!type':'macro'}; }\nfunction parse_ms_xml() { return {'!type':'macro'}; }\n/* TODO: it will be useful to parse the function str */\nvar rc_to_a1 = (function(){\n\tvar rcregex = /(^|[^A-Za-z_])R(\\[?-?\\d+\\]|[1-9]\\d*|)C(\\[?-?\\d+\\]|[1-9]\\d*|)(?![A-Za-z0-9_])/g;\n\tvar rcbase = ({r:0,c:0});\n\tfunction rcfunc($$,$1,$2,$3) {\n\t\tvar cRel = false, rRel = false;\n\n\t\tif($2.length == 0) rRel = true;\n\t\telse if($2.charAt(0) == \"[\") { rRel = true; $2 = $2.slice(1, -1); }\n\n\t\tif($3.length == 0) cRel = true;\n\t\telse if($3.charAt(0) == \"[\") { cRel = true; $3 = $3.slice(1, -1); }\n\n\t\tvar R = $2.length>0?parseInt($2,10)|0:0, C = $3.length>0?parseInt($3,10)|0:0;\n\n\t\tif(cRel) C += rcbase.c; else --C;\n\t\tif(rRel) R += rcbase.r; else --R;\n\t\treturn $1 + (cRel ? \"\" : \"$\") + encode_col(C) + (rRel ? \"\" : \"$\") + encode_row(R);\n\t}\n\treturn function rc_to_a1(fstr, base) {\n\t\trcbase = base;\n\t\treturn fstr.replace(rcregex, rcfunc);\n\t};\n})();\n\nvar crefregex = /(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})(?![_.\\(A-Za-z0-9])/g;\nvar a1_to_rc = (function(){\n\treturn function a1_to_rc(fstr, base) {\n\t\treturn fstr.replace(crefregex, function($0, $1, $2, $3, $4, $5) {\n\t\t\tvar c = decode_col($3) - ($2 ? 0 : base.c);\n\t\t\tvar r = decode_row($5) - ($4 ? 0 : base.r);\n\t\t\tvar R = (r == 0 ? \"\" : !$4 ? \"[\" + r + \"]\" : (r+1));\n\t\t\tvar C = (c == 0 ? \"\" : !$2 ? \"[\" + c + \"]\" : (c+1));\n\t\t\treturn $1 + \"R\" + R + \"C\" + C;\n\t\t});\n\t};\n})();\n\n/* no defined name can collide with a valid cell address A1:XFD1048576 ... except LOG10! */\nfunction shift_formula_str(f, delta) {\n\treturn f.replace(crefregex, function($0, $1, $2, $3, $4, $5) {\n\t\treturn $1+($2==\"$\" ? $2+$3 : encode_col(decode_col($3)+delta.c))+($4==\"$\" ? $4+$5 : encode_row(decode_row($5) + delta.r));\n\t});\n}\n\nfunction shift_formula_xlsx(f, range, cell) {\n\tvar r = decode_range(range), s = r.s, c = decode_cell(cell);\n\tvar delta = {r:c.r - s.r, c:c.c - s.c};\n\treturn shift_formula_str(f, delta);\n}\n\n/* TODO: parse formula */\nfunction fuzzyfmla(f) {\n\tif(f.length == 1) return false;\n\treturn true;\n}\n\nfunction _xlfn(f) {\n\treturn f.replace(/_xlfn\\./g,\"\");\n}\nfunction parseread1(blob) { blob.l+=1; return; }\n\n/* [MS-XLS] 2.5.51 */\nfunction parse_ColRelU(blob, length) {\n\tvar c = blob.read_shift(length == 1 ? 1 : 2);\n\treturn [c & 0x3FFF, (c >> 14) & 1, (c >> 15) & 1];\n}\n\n/* [MS-XLS] 2.5.198.105 ; [MS-XLSB] 2.5.97.89 */\nfunction parse_RgceArea(blob, length, opts) {\n\tvar w = 2;\n\tif(opts) {\n\t\tif(opts.biff >= 2 && opts.biff <= 5) return parse_RgceArea_BIFF2(blob, length, opts);\n\t\telse if(opts.biff == 12) w = 4;\n\t}\n\tvar r=blob.read_shift(w), R=blob.read_shift(w);\n\tvar c=parse_ColRelU(blob, 2);\n\tvar C=parse_ColRelU(blob, 2);\n\treturn { s:{r:r, c:c[0], cRel:c[1], rRel:c[2]}, e:{r:R, c:C[0], cRel:C[1], rRel:C[2]} };\n}\n/* BIFF 2-5 encodes flags in the row field */\nfunction parse_RgceArea_BIFF2(blob) {\n\tvar r=parse_ColRelU(blob, 2), R=parse_ColRelU(blob, 2);\n\tvar c=blob.read_shift(1);\n\tvar C=blob.read_shift(1);\n\treturn { s:{r:r[0], c:c, cRel:r[1], rRel:r[2]}, e:{r:R[0], c:C, cRel:R[1], rRel:R[2]} };\n}\n\n/* [MS-XLS] 2.5.198.105 ; [MS-XLSB] 2.5.97.90 */\nfunction parse_RgceAreaRel(blob, length, opts) {\n\tif(opts.biff < 8) return parse_RgceArea_BIFF2(blob, length, opts);\n\tvar r=blob.read_shift(opts.biff == 12 ? 4 : 2), R=blob.read_shift(opts.biff == 12 ? 4 : 2);\n\tvar c=parse_ColRelU(blob, 2);\n\tvar C=parse_ColRelU(blob, 2);\n\treturn { s:{r:r, c:c[0], cRel:c[1], rRel:c[2]}, e:{r:R, c:C[0], cRel:C[1], rRel:C[2]} };\n}\n\n/* [MS-XLS] 2.5.198.109 ; [MS-XLSB] 2.5.97.91 */\nfunction parse_RgceLoc(blob, length, opts) {\n\tif(opts && opts.biff >= 2 && opts.biff <= 5) return parse_RgceLoc_BIFF2(blob, length, opts);\n\tvar r = blob.read_shift(opts && opts.biff == 12 ? 4 : 2);\n\tvar c = parse_ColRelU(blob, 2);\n\treturn {r:r, c:c[0], cRel:c[1], rRel:c[2]};\n}\nfunction parse_RgceLoc_BIFF2(blob) {\n\tvar r = parse_ColRelU(blob, 2);\n\tvar c = blob.read_shift(1);\n\treturn {r:r[0], c:c, cRel:r[1], rRel:r[2]};\n}\n\n/* [MS-XLS] 2.5.198.107, 2.5.47 */\nfunction parse_RgceElfLoc(blob) {\n\tvar r = blob.read_shift(2);\n\tvar c = blob.read_shift(2);\n\treturn {r:r, c:c & 0xFF, fQuoted:!!(c & 0x4000), cRel:c>>15, rRel:c>>15 };\n}\n\n/* [MS-XLS] 2.5.198.111 ; [MS-XLSB] 2.5.97.92 TODO */\nfunction parse_RgceLocRel(blob, length, opts) {\n\tvar biff = opts && opts.biff ? opts.biff : 8;\n\tif(biff >= 2 && biff <= 5) return parse_RgceLocRel_BIFF2(blob, length, opts);\n\tvar r = blob.read_shift(biff >= 12 ? 4 : 2);\n\tvar cl = blob.read_shift(2);\n\tvar cRel = (cl & 0x4000) >> 14, rRel = (cl & 0x8000) >> 15;\n\tcl &= 0x3FFF;\n\tif(rRel == 1) while(r > 0x7FFFF) r -= 0x100000;\n\tif(cRel == 1) while(cl > 0x1FFF) cl = cl - 0x4000;\n\treturn {r:r,c:cl,cRel:cRel,rRel:rRel};\n}\nfunction parse_RgceLocRel_BIFF2(blob) {\n\tvar rl = blob.read_shift(2);\n\tvar c = blob.read_shift(1);\n\tvar rRel = (rl & 0x8000) >> 15, cRel = (rl & 0x4000) >> 14;\n\trl &= 0x3FFF;\n\tif(rRel == 1 && rl >= 0x2000) rl = rl - 0x4000;\n\tif(cRel == 1 && c >= 0x80) c = c - 0x100;\n\treturn {r:rl,c:c,cRel:cRel,rRel:rRel};\n}\n\n/* [MS-XLS] 2.5.198.27 ; [MS-XLSB] 2.5.97.18 */\nfunction parse_PtgArea(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar area = parse_RgceArea(blob, opts.biff >= 2 && opts.biff <= 5 ? 6 : 8, opts);\n\treturn [type, area];\n}\n\n/* [MS-XLS] 2.5.198.28 ; [MS-XLSB] 2.5.97.19 */\nfunction parse_PtgArea3d(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar ixti = blob.read_shift(2, 'i');\n\tvar w = 8;\n\tif(opts) switch(opts.biff) {\n\t\tcase 5: blob.l += 12; w = 6; break;\n\t\tcase 12: w = 12; break;\n\t}\n\tvar area = parse_RgceArea(blob, w, opts);\n\treturn [type, ixti, area];\n}\n\n/* [MS-XLS] 2.5.198.29 ; [MS-XLSB] 2.5.97.20 */\nfunction parse_PtgAreaErr(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tblob.l += opts && (opts.biff > 8) ? 12 : (opts.biff < 8 ? 6 : 8);\n\treturn [type];\n}\n/* [MS-XLS] 2.5.198.30 ; [MS-XLSB] 2.5.97.21 */\nfunction parse_PtgAreaErr3d(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar ixti = blob.read_shift(2);\n\tvar w = 8;\n\tif(opts) switch(opts.biff) {\n\t\tcase 5: blob.l += 12; w = 6; break;\n\t\tcase 12: w = 12; break;\n\t}\n\tblob.l += w;\n\treturn [type, ixti];\n}\n\n/* [MS-XLS] 2.5.198.31 ; [MS-XLSB] 2.5.97.22 */\nfunction parse_PtgAreaN(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar area = parse_RgceAreaRel(blob, length - 1, opts);\n\treturn [type, area];\n}\n\n/* [MS-XLS] 2.5.198.32 ; [MS-XLSB] 2.5.97.23 */\nfunction parse_PtgArray(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tblob.l += opts.biff == 2 ? 6 : opts.biff == 12 ? 14 : 7;\n\treturn [type];\n}\n\n/* [MS-XLS] 2.5.198.33 ; [MS-XLSB] 2.5.97.24 */\nfunction parse_PtgAttrBaxcel(blob) {\n\tvar bitSemi = blob[blob.l+1] & 0x01; /* 1 = volatile */\n\tvar bitBaxcel = 1;\n\tblob.l += 4;\n\treturn [bitSemi, bitBaxcel];\n}\n\n/* [MS-XLS] 2.5.198.34 ; [MS-XLSB] 2.5.97.25 */\nfunction parse_PtgAttrChoose(blob, length, opts) {\n\tblob.l +=2;\n\tvar offset = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\tvar o = [];\n\t/* offset is 1 less than the number of elements */\n\tfor(var i = 0; i <= offset; ++i) o.push(blob.read_shift(opts && opts.biff == 2 ? 1 : 2));\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.198.35 ; [MS-XLSB] 2.5.97.26 */\nfunction parse_PtgAttrGoto(blob, length, opts) {\n\tvar bitGoto = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += 2;\n\treturn [bitGoto, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n}\n\n/* [MS-XLS] 2.5.198.36 ; [MS-XLSB] 2.5.97.27 */\nfunction parse_PtgAttrIf(blob, length, opts) {\n\tvar bitIf = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += 2;\n\treturn [bitIf, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n}\n\n/* [MS-XLSB] 2.5.97.28 */\nfunction parse_PtgAttrIfError(blob) {\n\tvar bitIf = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += 2;\n\treturn [bitIf, blob.read_shift(2)];\n}\n\n/* [MS-XLS] 2.5.198.37 ; [MS-XLSB] 2.5.97.29 */\nfunction parse_PtgAttrSemi(blob, length, opts) {\n\tvar bitSemi = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += opts && opts.biff == 2 ? 3 : 4;\n\treturn [bitSemi];\n}\n\n/* [MS-XLS] 2.5.198.40 ; [MS-XLSB] 2.5.97.32 */\nfunction parse_PtgAttrSpaceType(blob) {\n\tvar type = blob.read_shift(1), cch = blob.read_shift(1);\n\treturn [type, cch];\n}\n\n/* [MS-XLS] 2.5.198.38 ; [MS-XLSB] 2.5.97.30 */\nfunction parse_PtgAttrSpace(blob) {\n\tblob.read_shift(2);\n\treturn parse_PtgAttrSpaceType(blob, 2);\n}\n\n/* [MS-XLS] 2.5.198.39 ; [MS-XLSB] 2.5.97.31 */\nfunction parse_PtgAttrSpaceSemi(blob) {\n\tblob.read_shift(2);\n\treturn parse_PtgAttrSpaceType(blob, 2);\n}\n\n/* [MS-XLS] 2.5.198.84 ; [MS-XLSB] 2.5.97.68 TODO */\nfunction parse_PtgRef(blob, length, opts) {\n\t//var ptg = blob[blob.l] & 0x1F;\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar loc = parse_RgceLoc(blob, 0, opts);\n\treturn [type, loc];\n}\n\n/* [MS-XLS] 2.5.198.88 ; [MS-XLSB] 2.5.97.72 TODO */\nfunction parse_PtgRefN(blob, length, opts) {\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar loc = parse_RgceLocRel(blob, 0, opts);\n\treturn [type, loc];\n}\n\n/* [MS-XLS] 2.5.198.85 ; [MS-XLSB] 2.5.97.69 TODO */\nfunction parse_PtgRef3d(blob, length, opts) {\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar ixti = blob.read_shift(2); // XtiIndex\n\tif(opts && opts.biff == 5) blob.l += 12;\n\tvar loc = parse_RgceLoc(blob, 0, opts); // TODO: or RgceLocRel\n\treturn [type, ixti, loc];\n}\n\n\n/* [MS-XLS] 2.5.198.62 ; [MS-XLSB] 2.5.97.45 TODO */\nfunction parse_PtgFunc(blob, length, opts) {\n\t//var ptg = blob[blob.l] & 0x1F;\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar iftab = blob.read_shift(opts && opts.biff <= 3 ? 1 : 2);\n\treturn [FtabArgc[iftab], Ftab[iftab], type];\n}\n/* [MS-XLS] 2.5.198.63 ; [MS-XLSB] 2.5.97.46 TODO */\nfunction parse_PtgFuncVar(blob, length, opts) {\n\tvar type = blob[blob.l++];\n\tvar cparams = blob.read_shift(1), tab = opts && opts.biff <= 3 ? [(type == 0x58 ? -1 : 0), blob.read_shift(1)]: parsetab(blob);\n\treturn [cparams, (tab[0] === 0 ? Ftab : Cetab)[tab[1]]];\n}\n\nfunction parsetab(blob) {\n\treturn [blob[blob.l+1]>>7, blob.read_shift(2) & 0x7FFF];\n}\n\n/* [MS-XLS] 2.5.198.41 ; [MS-XLSB] 2.5.97.33 */\nfunction parse_PtgAttrSum(blob, length, opts) {\n\tblob.l += opts && opts.biff == 2 ? 3 : 4; return;\n}\n\n/* [MS-XLS] 2.5.198.58 ; [MS-XLSB] 2.5.97.40 */\nfunction parse_PtgExp(blob, length, opts) {\n\tblob.l++;\n\tif(opts && opts.biff == 12) return [blob.read_shift(4, 'i'), 0];\n\tvar row = blob.read_shift(2);\n\tvar col = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\treturn [row, col];\n}\n\n/* [MS-XLS] 2.5.198.57 ; [MS-XLSB] 2.5.97.39 */\nfunction parse_PtgErr(blob) { blob.l++; return BErr[blob.read_shift(1)]; }\n\n/* [MS-XLS] 2.5.198.66 ; [MS-XLSB] 2.5.97.49 */\nfunction parse_PtgInt(blob) { blob.l++; return blob.read_shift(2); }\n\n/* [MS-XLS] 2.5.198.42 ; [MS-XLSB] 2.5.97.34 */\nfunction parse_PtgBool(blob) { blob.l++; return blob.read_shift(1)!==0;}\n\n/* [MS-XLS] 2.5.198.79 ; [MS-XLSB] 2.5.97.63 */\nfunction parse_PtgNum(blob) { blob.l++; return parse_Xnum(blob, 8); }\n\n/* [MS-XLS] 2.5.198.89 ; [MS-XLSB] 2.5.97.74 */\nfunction parse_PtgStr(blob, length, opts) { blob.l++; return parse_ShortXLUnicodeString(blob, length-1, opts); }\n\n/* [MS-XLS] 2.5.192.112 + 2.5.192.11{3,4,5,6,7} */\n/* [MS-XLSB] 2.5.97.93 + 2.5.97.9{4,5,6,7} */\nfunction parse_SerAr(blob, biff) {\n\tvar val = [blob.read_shift(1)];\n\tif(biff == 12) switch(val[0]) {\n\t\tcase 0x02: val[0] = 0x04; break; /* SerBool */\n\t\tcase 0x04: val[0] = 0x10; break; /* SerErr */\n\t\tcase 0x00: val[0] = 0x01; break; /* SerNum */\n\t\tcase 0x01: val[0] = 0x02; break; /* SerStr */\n\t}\n\tswitch(val[0]) {\n\t\tcase 0x04: /* SerBool -- boolean */\n\t\t\tval[1] = parsebool(blob, 1) ? 'TRUE' : 'FALSE';\n\t\t\tif(biff != 12) blob.l += 7; break;\n\t\tcase 0x25: /* appears to be an alias */\n\t\tcase 0x10: /* SerErr -- error */\n\t\t\tval[1] = BErr[blob[blob.l]];\n\t\t\tblob.l += ((biff == 12) ? 4 : 8); break;\n\t\tcase 0x00: /* SerNil -- honestly, I'm not sure how to reproduce this */\n\t\t\tblob.l += 8; break;\n\t\tcase 0x01: /* SerNum -- Xnum */\n\t\t\tval[1] = parse_Xnum(blob, 8); break;\n\t\tcase 0x02: /* SerStr -- XLUnicodeString (<256 chars) */\n\t\t\tval[1] = parse_XLUnicodeString2(blob, 0, {biff:biff > 0 && biff < 8 ? 2 : biff}); break;\n\t\tdefault: throw new Error(\"Bad SerAr: \" + val[0]); /* Unreachable */\n\t}\n\treturn val;\n}\n\n/* [MS-XLS] 2.5.198.61 ; [MS-XLSB] 2.5.97.44 */\nfunction parse_PtgExtraMem(blob, cce, opts) {\n\tvar count = blob.read_shift((opts.biff == 12) ? 4 : 2);\n\tvar out = [];\n\tfor(var i = 0; i != count; ++i) out.push(((opts.biff == 12) ? parse_UncheckedRfX : parse_Ref8U)(blob, 8));\n\treturn out;\n}\n\n/* [MS-XLS] 2.5.198.59 ; [MS-XLSB] 2.5.97.41 */\nfunction parse_PtgExtraArray(blob, length, opts) {\n\tvar rows = 0, cols = 0;\n\tif(opts.biff == 12) {\n\t\trows = blob.read_shift(4); // DRw\n\t\tcols = blob.read_shift(4); // DCol\n\t} else {\n\t\tcols = 1 + blob.read_shift(1); //DColByteU\n\t\trows = 1 + blob.read_shift(2); //DRw\n\t}\n\tif(opts.biff >= 2 && opts.biff < 8) { --rows; if(--cols == 0) cols = 0x100; }\n\t// $FlowIgnore\n\tfor(var i = 0, o = []; i != rows && (o[i] = []); ++i)\n\t\tfor(var j = 0; j != cols; ++j) o[i][j] = parse_SerAr(blob, opts.biff);\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.198.76 ; [MS-XLSB] 2.5.97.60 */\nfunction parse_PtgName(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar w = (!opts || (opts.biff >= 8)) ? 4 : 2;\n\tvar nameindex = blob.read_shift(w);\n\tswitch(opts.biff) {\n\t\tcase 2: blob.l += 5; break;\n\t\tcase 3: case 4: blob.l += 8; break;\n\t\tcase 5: blob.l += 12; break;\n\t}\n\treturn [type, 0, nameindex];\n}\n\n/* [MS-XLS] 2.5.198.77 ; [MS-XLSB] 2.5.97.61 */\nfunction parse_PtgNameX(blob, length, opts) {\n\tif(opts.biff == 5) return parse_PtgNameX_BIFF5(blob, length, opts);\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar ixti = blob.read_shift(2); // XtiIndex\n\tvar nameindex = blob.read_shift(4);\n\treturn [type, ixti, nameindex];\n}\nfunction parse_PtgNameX_BIFF5(blob) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar ixti = blob.read_shift(2, 'i'); // XtiIndex\n\tblob.l += 8;\n\tvar nameindex = blob.read_shift(2);\n\tblob.l += 12;\n\treturn [type, ixti, nameindex];\n}\n\n/* [MS-XLS] 2.5.198.70 ; [MS-XLSB] 2.5.97.54 */\nfunction parse_PtgMemArea(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tblob.l += (opts && opts.biff == 2 ? 3 : 4);\n\tvar cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\treturn [type, cce];\n}\n\n/* [MS-XLS] 2.5.198.72 ; [MS-XLSB] 2.5.97.56 */\nfunction parse_PtgMemFunc(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\treturn [type, cce];\n}\n\n\n/* [MS-XLS] 2.5.198.86 ; [MS-XLSB] 2.5.97.69 */\nfunction parse_PtgRefErr(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tblob.l += 4;\n\tif(opts.biff < 8) blob.l--;\n\tif(opts.biff == 12) blob.l += 2;\n\treturn [type];\n}\n\n/* [MS-XLS] 2.5.198.87 ; [MS-XLSB] 2.5.97.71 */\nfunction parse_PtgRefErr3d(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar ixti = blob.read_shift(2);\n\tvar w = 4;\n\tif(opts) switch(opts.biff) {\n\t\tcase 5: w = 15; break;\n\t\tcase 12: w = 6; break;\n\t}\n\tblob.l += w;\n\treturn [type, ixti];\n}\n\n/* [MS-XLS] 2.5.198.71 ; [MS-XLSB] 2.5.97.55 */\nvar parse_PtgMemErr = parsenoop;\n/* [MS-XLS] 2.5.198.73  ; [MS-XLSB] 2.5.97.57 */\nvar parse_PtgMemNoMem = parsenoop;\n/* [MS-XLS] 2.5.198.92 */\nvar parse_PtgTbl = parsenoop;\n\nfunction parse_PtgElfLoc(blob, length, opts) {\n\tblob.l += 2;\n\treturn [parse_RgceElfLoc(blob, 4, opts)];\n}\nfunction parse_PtgElfNoop(blob) {\n\tblob.l += 6;\n\treturn [];\n}\n/* [MS-XLS] 2.5.198.46 */\nvar parse_PtgElfCol = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.47 */\nvar parse_PtgElfColS = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.48 */\nvar parse_PtgElfColSV = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.49 */\nvar parse_PtgElfColV = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.50 */\nfunction parse_PtgElfLel(blob) {\n\tblob.l += 2;\n\treturn [parseuint16(blob), blob.read_shift(2) & 0x01];\n}\n/* [MS-XLS] 2.5.198.51 */\nvar parse_PtgElfRadical = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.52 */\nvar parse_PtgElfRadicalLel = parse_PtgElfLel;\n/* [MS-XLS] 2.5.198.53 */\nvar parse_PtgElfRadicalS = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.54 */\nvar parse_PtgElfRw = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.55 */\nvar parse_PtgElfRwV = parse_PtgElfLoc;\n\n/* [MS-XLSB] 2.5.97.52 TODO */\nvar PtgListRT = [\n\t\"Data\",\n\t\"All\",\n\t\"Headers\",\n\t\"??\",\n\t\"?Data2\",\n\t\"??\",\n\t\"?DataHeaders\",\n\t\"??\",\n\t\"Totals\",\n\t\"??\",\n\t\"??\",\n\t\"??\",\n\t\"?DataTotals\",\n\t\"??\",\n\t\"??\",\n\t\"??\",\n\t\"?Current\"\n];\nfunction parse_PtgList(blob) {\n\tblob.l += 2;\n\tvar ixti = blob.read_shift(2);\n\tvar flags = blob.read_shift(2);\n\tvar idx = blob.read_shift(4);\n\tvar c = blob.read_shift(2);\n\tvar C = blob.read_shift(2);\n\tvar rt = PtgListRT[(flags >> 2) & 0x1F];\n\treturn {ixti: ixti, coltype:(flags&0x3), rt:rt, idx:idx, c:c, C:C};\n}\n/* [MS-XLS] 2.5.198.91 ; [MS-XLSB] 2.5.97.76 */\nfunction parse_PtgSxName(blob) {\n\tblob.l += 2;\n\treturn [blob.read_shift(4)];\n}\n\n/* [XLS] old spec */\nfunction parse_PtgSheet(blob, length, opts) {\n\tblob.l += 5;\n\tblob.l += 2;\n\tblob.l += (opts.biff == 2 ? 1 : 4);\n\treturn [\"PTGSHEET\"];\n}\nfunction parse_PtgEndSheet(blob, length, opts) {\n\tblob.l += (opts.biff == 2 ? 4 : 5);\n\treturn [\"PTGENDSHEET\"];\n}\nfunction parse_PtgMemAreaN(blob) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar cce = blob.read_shift(2);\n\treturn [type, cce];\n}\nfunction parse_PtgMemNoMemN(blob) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar cce = blob.read_shift(2);\n\treturn [type, cce];\n}\nfunction parse_PtgAttrNoop(blob) {\n\tblob.l += 4;\n\treturn [0, 0];\n}\n\n/* [MS-XLS] 2.5.198.25 ; [MS-XLSB] 2.5.97.16 */\nvar PtgTypes = {\n0x01: { n:'PtgExp', f:parse_PtgExp },\n0x02: { n:'PtgTbl', f:parse_PtgTbl },\n0x03: { n:'PtgAdd', f:parseread1 },\n0x04: { n:'PtgSub', f:parseread1 },\n0x05: { n:'PtgMul', f:parseread1 },\n0x06: { n:'PtgDiv', f:parseread1 },\n0x07: { n:'PtgPower', f:parseread1 },\n0x08: { n:'PtgConcat', f:parseread1 },\n0x09: { n:'PtgLt', f:parseread1 },\n0x0A: { n:'PtgLe', f:parseread1 },\n0x0B: { n:'PtgEq', f:parseread1 },\n0x0C: { n:'PtgGe', f:parseread1 },\n0x0D: { n:'PtgGt', f:parseread1 },\n0x0E: { n:'PtgNe', f:parseread1 },\n0x0F: { n:'PtgIsect', f:parseread1 },\n0x10: { n:'PtgUnion', f:parseread1 },\n0x11: { n:'PtgRange', f:parseread1 },\n0x12: { n:'PtgUplus', f:parseread1 },\n0x13: { n:'PtgUminus', f:parseread1 },\n0x14: { n:'PtgPercent', f:parseread1 },\n0x15: { n:'PtgParen', f:parseread1 },\n0x16: { n:'PtgMissArg', f:parseread1 },\n0x17: { n:'PtgStr', f:parse_PtgStr },\n0x1A: { n:'PtgSheet', f:parse_PtgSheet },\n0x1B: { n:'PtgEndSheet', f:parse_PtgEndSheet },\n0x1C: { n:'PtgErr', f:parse_PtgErr },\n0x1D: { n:'PtgBool', f:parse_PtgBool },\n0x1E: { n:'PtgInt', f:parse_PtgInt },\n0x1F: { n:'PtgNum', f:parse_PtgNum },\n0x20: { n:'PtgArray', f:parse_PtgArray },\n0x21: { n:'PtgFunc', f:parse_PtgFunc },\n0x22: { n:'PtgFuncVar', f:parse_PtgFuncVar },\n0x23: { n:'PtgName', f:parse_PtgName },\n0x24: { n:'PtgRef', f:parse_PtgRef },\n0x25: { n:'PtgArea', f:parse_PtgArea },\n0x26: { n:'PtgMemArea', f:parse_PtgMemArea },\n0x27: { n:'PtgMemErr', f:parse_PtgMemErr },\n0x28: { n:'PtgMemNoMem', f:parse_PtgMemNoMem },\n0x29: { n:'PtgMemFunc', f:parse_PtgMemFunc },\n0x2A: { n:'PtgRefErr', f:parse_PtgRefErr },\n0x2B: { n:'PtgAreaErr', f:parse_PtgAreaErr },\n0x2C: { n:'PtgRefN', f:parse_PtgRefN },\n0x2D: { n:'PtgAreaN', f:parse_PtgAreaN },\n0x2E: { n:'PtgMemAreaN', f:parse_PtgMemAreaN },\n0x2F: { n:'PtgMemNoMemN', f:parse_PtgMemNoMemN },\n0x39: { n:'PtgNameX', f:parse_PtgNameX },\n0x3A: { n:'PtgRef3d', f:parse_PtgRef3d },\n0x3B: { n:'PtgArea3d', f:parse_PtgArea3d },\n0x3C: { n:'PtgRefErr3d', f:parse_PtgRefErr3d },\n0x3D: { n:'PtgAreaErr3d', f:parse_PtgAreaErr3d },\n0xFF: {}\n};\n/* These are duplicated in the PtgTypes table */\nvar PtgDupes = {\n0x40: 0x20, 0x60: 0x20,\n0x41: 0x21, 0x61: 0x21,\n0x42: 0x22, 0x62: 0x22,\n0x43: 0x23, 0x63: 0x23,\n0x44: 0x24, 0x64: 0x24,\n0x45: 0x25, 0x65: 0x25,\n0x46: 0x26, 0x66: 0x26,\n0x47: 0x27, 0x67: 0x27,\n0x48: 0x28, 0x68: 0x28,\n0x49: 0x29, 0x69: 0x29,\n0x4A: 0x2A, 0x6A: 0x2A,\n0x4B: 0x2B, 0x6B: 0x2B,\n0x4C: 0x2C, 0x6C: 0x2C,\n0x4D: 0x2D, 0x6D: 0x2D,\n0x4E: 0x2E, 0x6E: 0x2E,\n0x4F: 0x2F, 0x6F: 0x2F,\n0x58: 0x22, 0x78: 0x22,\n0x59: 0x39, 0x79: 0x39,\n0x5A: 0x3A, 0x7A: 0x3A,\n0x5B: 0x3B, 0x7B: 0x3B,\n0x5C: 0x3C, 0x7C: 0x3C,\n0x5D: 0x3D, 0x7D: 0x3D\n};\n\nvar Ptg18 = {\n0x01: { n:'PtgElfLel', f:parse_PtgElfLel },\n0x02: { n:'PtgElfRw', f:parse_PtgElfRw },\n0x03: { n:'PtgElfCol', f:parse_PtgElfCol },\n0x06: { n:'PtgElfRwV', f:parse_PtgElfRwV },\n0x07: { n:'PtgElfColV', f:parse_PtgElfColV },\n0x0A: { n:'PtgElfRadical', f:parse_PtgElfRadical },\n0x0B: { n:'PtgElfRadicalS', f:parse_PtgElfRadicalS },\n0x0D: { n:'PtgElfColS', f:parse_PtgElfColS },\n0x0F: { n:'PtgElfColSV', f:parse_PtgElfColSV },\n0x10: { n:'PtgElfRadicalLel', f:parse_PtgElfRadicalLel },\n0x19: { n:'PtgList', f:parse_PtgList },\n0x1D: { n:'PtgSxName', f:parse_PtgSxName },\n0xFF: {}\n};\nvar Ptg19 = {\n0x00: { n:'PtgAttrNoop', f:parse_PtgAttrNoop },\n0x01: { n:'PtgAttrSemi', f:parse_PtgAttrSemi },\n0x02: { n:'PtgAttrIf', f:parse_PtgAttrIf },\n0x04: { n:'PtgAttrChoose', f:parse_PtgAttrChoose },\n0x08: { n:'PtgAttrGoto', f:parse_PtgAttrGoto },\n0x10: { n:'PtgAttrSum', f:parse_PtgAttrSum },\n0x20: { n:'PtgAttrBaxcel', f:parse_PtgAttrBaxcel },\n0x21: { n:'PtgAttrBaxcel', f:parse_PtgAttrBaxcel },\n0x40: { n:'PtgAttrSpace', f:parse_PtgAttrSpace },\n0x41: { n:'PtgAttrSpaceSemi', f:parse_PtgAttrSpaceSemi },\n0x80: { n:'PtgAttrIfError', f:parse_PtgAttrIfError },\n0xFF: {}\n};\n\n/* [MS-XLS] 2.5.198.103 ; [MS-XLSB] 2.5.97.87 */\nfunction parse_RgbExtra(blob, length, rgce, opts) {\n\tif(opts.biff < 8) return parsenoop(blob, length);\n\tvar target = blob.l + length;\n\tvar o = [];\n\tfor(var i = 0; i !== rgce.length; ++i) {\n\t\tswitch(rgce[i][0]) {\n\t\t\tcase 'PtgArray': /* PtgArray -> PtgExtraArray */\n\t\t\t\trgce[i][1] = parse_PtgExtraArray(blob, 0, opts);\n\t\t\t\to.push(rgce[i][1]);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgMemArea': /* PtgMemArea -> PtgExtraMem */\n\t\t\t\trgce[i][2] = parse_PtgExtraMem(blob, rgce[i][1], opts);\n\t\t\t\to.push(rgce[i][2]);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgExp': /* PtgExp -> PtgExtraCol */\n\t\t\t\tif(opts && opts.biff == 12) {\n\t\t\t\t\trgce[i][1][1] = blob.read_shift(4);\n\t\t\t\t\to.push(rgce[i][1]);\n\t\t\t\t} break;\n\t\t\tcase 'PtgList': /* TODO: PtgList -> PtgExtraList */\n\t\t\tcase 'PtgElfRadicalS': /* TODO: PtgElfRadicalS -> PtgExtraElf */\n\t\t\tcase 'PtgElfColS': /* TODO: PtgElfColS -> PtgExtraElf */\n\t\t\tcase 'PtgElfColSV': /* TODO: PtgElfColSV -> PtgExtraElf */\n\t\t\t\tthrow \"Unsupported \" + rgce[i][0];\n\t\t\tdefault: break;\n\t\t}\n\t}\n\tlength = target - blob.l;\n\t/* note: this is technically an error but Excel disregards */\n\t//if(target !== blob.l && blob.l !== target - length) throw new Error(target + \" != \" + blob.l);\n\tif(length !== 0) o.push(parsenoop(blob, length));\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.198.104 ; [MS-XLSB] 2.5.97.88 */\nfunction parse_Rgce(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar R, id, ptgs = [];\n\twhile(target != blob.l) {\n\t\tlength = target - blob.l;\n\t\tid = blob[blob.l];\n\t\tR = PtgTypes[id] || PtgTypes[PtgDupes[id]];\n\t\tif(id === 0x18 || id === 0x19) R = (id === 0x18 ? Ptg18 : Ptg19)[blob[blob.l + 1]];\n\t\tif(!R || !R.f) { /*ptgs.push*/(parsenoop(blob, length)); }\n\t\telse { ptgs.push([R.n, R.f(blob, length, opts)]); }\n\t}\n\treturn ptgs;\n}\n\nfunction stringify_array(f) {\n\tvar o = [];\n\tfor(var i = 0; i < f.length; ++i) {\n\t\tvar x = f[i], r = [];\n\t\tfor(var j = 0; j < x.length; ++j) {\n\t\t\tvar y = x[j];\n\t\t\tif(y) switch(y[0]) {\n\t\t\t\t// TODO: handle embedded quotes\n\t\t\t\tcase 0x02:\nr.push('\"' + y[1].replace(/\"/g,'\"\"') + '\"'); break;\n\t\t\t\tdefault: r.push(y[1]);\n\t\t\t} else r.push(\"\");\n\t\t}\n\t\to.push(r.join(\",\"));\n\t}\n\treturn o.join(\";\");\n}\n\n/* [MS-XLS] 2.2.2 ; [MS-XLSB] 2.2.2 TODO */\nvar PtgBinOp = {\n\tPtgAdd: \"+\",\n\tPtgConcat: \"&\",\n\tPtgDiv: \"/\",\n\tPtgEq: \"=\",\n\tPtgGe: \">=\",\n\tPtgGt: \">\",\n\tPtgLe: \"<=\",\n\tPtgLt: \"<\",\n\tPtgMul: \"*\",\n\tPtgNe: \"<>\",\n\tPtgPower: \"^\",\n\tPtgSub: \"-\"\n};\n\n// List of invalid characters needs to be tested further\nfunction formula_quote_sheet_name(sname, opts) {\n\tif(!sname && !(opts && opts.biff <= 5 && opts.biff >= 2)) throw new Error(\"empty sheet name\");\n\tif (/[^\\w\\u4E00-\\u9FFF\\u3040-\\u30FF]/.test(sname)) return \"'\" + sname + \"'\";\n\treturn sname;\n}\nfunction get_ixti_raw(supbooks, ixti, opts) {\n\tif(!supbooks) return \"SH33TJSERR0\";\n\tif(opts.biff > 8 && (!supbooks.XTI || !supbooks.XTI[ixti])) return supbooks.SheetNames[ixti];\n\tif(!supbooks.XTI) return \"SH33TJSERR6\";\n\tvar XTI = supbooks.XTI[ixti];\n\tif(opts.biff < 8) {\n\t\tif(ixti > 10000) ixti-= 65536;\n\t\tif(ixti < 0) ixti = -ixti;\n\t\treturn ixti == 0 ? \"\" : supbooks.XTI[ixti - 1];\n\t}\n\tif(!XTI) return \"SH33TJSERR1\";\n\tvar o = \"\";\n\tif(opts.biff > 8) switch(supbooks[XTI[0]][0]) {\n\t\tcase 0x0165: /* 'BrtSupSelf' */\n\t\t\to = XTI[1] == -1 ? \"#REF\" : supbooks.SheetNames[XTI[1]];\n\t\t\treturn XTI[1] == XTI[2] ? o : o + \":\" + supbooks.SheetNames[XTI[2]];\n\t\tcase 0x0166: /* 'BrtSupSame' */\n\t\t\tif(opts.SID != null) return supbooks.SheetNames[opts.SID];\n\t\t\treturn \"SH33TJSSAME\" + supbooks[XTI[0]][0];\n\t\tcase 0x0163: /* 'BrtSupBookSrc' */\n\t\t\t/* falls through */\n\t\tdefault: return \"SH33TJSSRC\" + supbooks[XTI[0]][0];\n\t}\n\tswitch(supbooks[XTI[0]][0][0]) {\n\t\tcase 0x0401:\n\t\t\to = XTI[1] == -1 ? \"#REF\" : (supbooks.SheetNames[XTI[1]] || \"SH33TJSERR3\");\n\t\t\treturn XTI[1] == XTI[2] ? o : o + \":\" + supbooks.SheetNames[XTI[2]];\n\t\tcase 0x3A01: return supbooks[XTI[0]].slice(1).map(function(name) { return name.Name; }).join(\";;\"); //return \"SH33TJSERR8\";\n\t\tdefault:\n\t\t\tif(!supbooks[XTI[0]][0][3]) return \"SH33TJSERR2\";\n\t\t\to = XTI[1] == -1 ? \"#REF\" : (supbooks[XTI[0]][0][3][XTI[1]] || \"SH33TJSERR4\");\n\t\t\treturn XTI[1] == XTI[2] ? o : o + \":\" + supbooks[XTI[0]][0][3][XTI[2]];\n\t}\n}\nfunction get_ixti(supbooks, ixti, opts) {\n\tvar ixtiraw = get_ixti_raw(supbooks, ixti, opts);\n\treturn ixtiraw == \"#REF\" ? ixtiraw : formula_quote_sheet_name(ixtiraw, opts);\n}\nfunction stringify_formula(formula/*Array<any>*/, range, cell, supbooks, opts) {\n\tvar biff = (opts && opts.biff) || 8;\n\tvar _range = /*range != null ? range :*/ {s:{c:0, r:0},e:{c:0, r:0}};\n\tvar stack = [], e1, e2,  c, ixti=0, nameidx=0, r, sname=\"\";\n\tif(!formula[0] || !formula[0][0]) return \"\";\n\tvar last_sp = -1, sp = \"\";\n\tfor(var ff = 0, fflen = formula[0].length; ff < fflen; ++ff) {\n\t\tvar f = formula[0][ff];\n\t\tswitch(f[0]) {\n\t\t\tcase 'PtgUminus': /* [MS-XLS] 2.5.198.93 */\n\t\t\t\tstack.push(\"-\" + stack.pop()); break;\n\t\t\tcase 'PtgUplus': /* [MS-XLS] 2.5.198.95 */\n\t\t\t\tstack.push(\"+\" + stack.pop()); break;\n\t\t\tcase 'PtgPercent': /* [MS-XLS] 2.5.198.81 */\n\t\t\t\tstack.push(stack.pop() + \"%\"); break;\n\n\t\t\tcase 'PtgAdd':    /* [MS-XLS] 2.5.198.26 */\n\t\t\tcase 'PtgConcat': /* [MS-XLS] 2.5.198.43 */\n\t\t\tcase 'PtgDiv':    /* [MS-XLS] 2.5.198.45 */\n\t\t\tcase 'PtgEq':     /* [MS-XLS] 2.5.198.56 */\n\t\t\tcase 'PtgGe':     /* [MS-XLS] 2.5.198.64 */\n\t\t\tcase 'PtgGt':     /* [MS-XLS] 2.5.198.65 */\n\t\t\tcase 'PtgLe':     /* [MS-XLS] 2.5.198.68 */\n\t\t\tcase 'PtgLt':     /* [MS-XLS] 2.5.198.69 */\n\t\t\tcase 'PtgMul':    /* [MS-XLS] 2.5.198.75 */\n\t\t\tcase 'PtgNe':     /* [MS-XLS] 2.5.198.78 */\n\t\t\tcase 'PtgPower':  /* [MS-XLS] 2.5.198.82 */\n\t\t\tcase 'PtgSub':    /* [MS-XLS] 2.5.198.90 */\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tif(last_sp >= 0) {\n\t\t\t\t\tswitch(formula[0][last_sp][1][0]) {\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\t\tsp = fill(\" \", formula[0][last_sp][1][1]); break;\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\t\tsp = fill(\"\\r\", formula[0][last_sp][1][1]); break;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tsp = \"\";\n\t\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\t\tif(opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + formula[0][last_sp][1][0]);\n\t\t\t\t\t}\n\t\t\t\t\te2 = e2 + sp;\n\t\t\t\t\tlast_sp = -1;\n\t\t\t\t}\n\t\t\t\tstack.push(e2+PtgBinOp[f[0]]+e1);\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgIsect': /* [MS-XLS] 2.5.198.67 */\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\" \"+e1);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgUnion': /* [MS-XLS] 2.5.198.94 */\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\",\"+e1);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgRange': /* [MS-XLS] 2.5.198.83 */\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\":\"+e1);\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgAttrChoose': /* [MS-XLS] 2.5.198.34 */\n\t\t\t\tbreak;\n\t\t\tcase 'PtgAttrGoto': /* [MS-XLS] 2.5.198.35 */\n\t\t\t\tbreak;\n\t\t\tcase 'PtgAttrIf': /* [MS-XLS] 2.5.198.36 */\n\t\t\t\tbreak;\n\t\t\tcase 'PtgAttrIfError': /* [MS-XLSB] 2.5.97.28 */\n\t\t\t\tbreak;\n\n\n\t\t\tcase 'PtgRef': /* [MS-XLS] 2.5.198.84 */\nc = shift_cell_xls((f[1][1]), _range, opts);\n\t\t\t\tstack.push(encode_cell_xls(c, biff));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgRefN': /* [MS-XLS] 2.5.198.88 */\nc = cell ? shift_cell_xls((f[1][1]), cell, opts) : (f[1][1]);\n\t\t\t\tstack.push(encode_cell_xls(c, biff));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgRef3d': /* [MS-XLS] 2.5.198.85 */\nixti = f[1][1]; c = shift_cell_xls((f[1][2]), _range, opts);\n\t\t\t\tsname = get_ixti(supbooks, ixti, opts);\n\t\t\t\tvar w = sname; /* IE9 fails on defined names */ // eslint-disable-line no-unused-vars\n\t\t\t\tstack.push(sname + \"!\" + encode_cell_xls(c, biff));\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgFunc': /* [MS-XLS] 2.5.198.62 */\n\t\t\tcase 'PtgFuncVar': /* [MS-XLS] 2.5.198.63 */\n\t\t\t\t/* f[1] = [argc, func, type] */\n\t\t\t\tvar argc = (f[1][0]), func = (f[1][1]);\n\t\t\t\tif(!argc) argc = 0;\n\t\t\t\targc &= 0x7F;\n\t\t\t\tvar args = argc == 0 ? [] : stack.slice(-argc);\n\t\t\t\tstack.length -= argc;\n\t\t\t\tif(func === 'User') func = args.shift();\n\t\t\t\tstack.push(func + \"(\" + args.join(\",\") + \")\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgBool': /* [MS-XLS] 2.5.198.42 */\n\t\t\t\tstack.push(f[1] ? \"TRUE\" : \"FALSE\"); break;\n\t\t\tcase 'PtgInt': /* [MS-XLS] 2.5.198.66 */\n\t\t\t\tstack.push(f[1]); break;\n\t\t\tcase 'PtgNum': /* [MS-XLS] 2.5.198.79 TODO: precision? */\n\t\t\t\tstack.push(String(f[1])); break;\n\t\t\tcase 'PtgStr': /* [MS-XLS] 2.5.198.89 */\n\t\t\t\t// $FlowIgnore\n\t\t\t\tstack.push('\"' + f[1].replace(/\"/g, '\"\"') + '\"'); break;\n\t\t\tcase 'PtgErr': /* [MS-XLS] 2.5.198.57 */\n\t\t\t\tstack.push(f[1]); break;\n\t\t\tcase 'PtgAreaN': /* [MS-XLS] 2.5.198.31 TODO */\nr = shift_range_xls(f[1][1], cell ? {s:cell} : _range, opts);\n\t\t\t\tstack.push(encode_range_xls((r), opts));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgArea': /* [MS-XLS] 2.5.198.27 TODO: fixed points */\nr = shift_range_xls(f[1][1], _range, opts);\n\t\t\t\tstack.push(encode_range_xls((r), opts));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgArea3d': /* [MS-XLS] 2.5.198.28 TODO */\nixti = f[1][1]; r = f[1][2];\n\t\t\t\tsname = get_ixti(supbooks, ixti, opts);\n\t\t\t\tstack.push(sname + \"!\" + encode_range_xls((r), opts));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgAttrSum': /* [MS-XLS] 2.5.198.41 */\n\t\t\t\tstack.push(\"SUM(\" + stack.pop() + \")\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgAttrBaxcel': /* [MS-XLS] 2.5.198.33 */\n\t\t\tcase 'PtgAttrSemi': /* [MS-XLS] 2.5.198.37 */\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgName': /* [MS-XLS] 2.5.198.76 ; [MS-XLSB] 2.5.97.60 TODO: revisions */\n\t\t\t\t/* f[1] = type, 0, nameindex */\n\t\t\t\tnameidx = (f[1][2]);\n\t\t\t\tvar lbl = (supbooks.names||[])[nameidx-1] || (supbooks[0]||[])[nameidx];\n\t\t\t\tvar name = lbl ? lbl.Name : \"SH33TJSNAME\" + String(nameidx);\n\t\t\t\t/* [MS-XLSB] 2.5.97.10 Ftab -- last verified 20220204 */\n\t\t\t\tif(name && name.slice(0,6) == \"_xlfn.\" && !opts.xlfn) name = name.slice(6);\n\t\t\t\tstack.push(name);\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgNameX': /* [MS-XLS] 2.5.198.77 ; [MS-XLSB] 2.5.97.61 TODO: revisions */\n\t\t\t\t/* f[1] = type, ixti, nameindex */\n\t\t\t\tvar bookidx = (f[1][1]); nameidx = (f[1][2]); var externbook;\n\t\t\t\t/* TODO: Properly handle missing values -- this should be using get_ixti_raw primarily */\n\t\t\t\tif(opts.biff <= 5) {\n\t\t\t\t\tif(bookidx < 0) bookidx = -bookidx;\n\t\t\t\t\tif(supbooks[bookidx]) externbook = supbooks[bookidx][nameidx];\n\t\t\t\t} else {\n\t\t\t\t\tvar o = \"\";\n\t\t\t\t\tif(((supbooks[bookidx]||[])[0]||[])[0] == 0x3A01){/* empty */}\n\t\t\t\t\telse if(((supbooks[bookidx]||[])[0]||[])[0] == 0x0401){\n\t\t\t\t\t\tif(supbooks[bookidx][nameidx] && supbooks[bookidx][nameidx].itab > 0) {\n\t\t\t\t\t\t\to = supbooks.SheetNames[supbooks[bookidx][nameidx].itab-1] + \"!\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse o = supbooks.SheetNames[nameidx-1]+ \"!\";\n\t\t\t\t\tif(supbooks[bookidx] && supbooks[bookidx][nameidx]) o += supbooks[bookidx][nameidx].Name;\n\t\t\t\t\telse if(supbooks[0] && supbooks[0][nameidx]) o += supbooks[0][nameidx].Name;\n\t\t\t\t\telse {\n\t\t\t\t\t\tvar ixtidata = (get_ixti_raw(supbooks, bookidx, opts)||\"\").split(\";;\");\n\t\t\t\t\t\tif(ixtidata[nameidx - 1]) o = ixtidata[nameidx - 1]; // TODO: confirm this is correct\n\t\t\t\t\t\telse o += \"SH33TJSERRX\";\n\t\t\t\t\t}\n\t\t\t\t\tstack.push(o);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(!externbook) externbook = {Name: \"SH33TJSERRY\"};\n\t\t\t\tstack.push(externbook.Name);\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgParen': /* [MS-XLS] 2.5.198.80 */\n\t\t\t\tvar lp = '(', rp = ')';\n\t\t\t\tif(last_sp >= 0) {\n\t\t\t\t\tsp = \"\";\n\t\t\t\t\tswitch(formula[0][last_sp][1][0]) {\n\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\tcase 2: lp = fill(\" \", formula[0][last_sp][1][1]) + lp; break;\n\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\tcase 3: lp = fill(\"\\r\", formula[0][last_sp][1][1]) + lp; break;\n\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\tcase 4: rp = fill(\" \", formula[0][last_sp][1][1]) + rp; break;\n\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\tcase 5: rp = fill(\"\\r\", formula[0][last_sp][1][1]) + rp; break;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\t\tif(opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + formula[0][last_sp][1][0]);\n\t\t\t\t\t}\n\t\t\t\t\tlast_sp = -1;\n\t\t\t\t}\n\t\t\t\tstack.push(lp + stack.pop() + rp); break;\n\n\t\t\tcase 'PtgRefErr': /* [MS-XLS] 2.5.198.86 */\n\t\t\t\tstack.push('#REF!'); break;\n\n\t\t\tcase 'PtgRefErr3d': /* [MS-XLS] 2.5.198.87 */\n\t\t\t\tstack.push('#REF!'); break;\n\n\t\t\tcase 'PtgExp': /* [MS-XLS] 2.5.198.58 TODO */\n\t\t\t\tc = {c:(f[1][1]),r:(f[1][0])};\n\t\t\t\tvar q = ({c: cell.c, r:cell.r});\n\t\t\t\tif(supbooks.sharedf[encode_cell(c)]) {\n\t\t\t\t\tvar parsedf = (supbooks.sharedf[encode_cell(c)]);\n\t\t\t\t\tstack.push(stringify_formula(parsedf, _range, q, supbooks, opts));\n\t\t\t\t} else {\n\t\t\t\t\tvar fnd = false;\n\t\t\t\t\tfor(e1=0;e1!=supbooks.arrayf.length; ++e1) {\n\t\t\t\t\t\t/* TODO: should be something like range_has */\n\t\t\t\t\t\te2 = supbooks.arrayf[e1];\n\t\t\t\t\t\tif(c.c < e2[0].s.c || c.c > e2[0].e.c) continue;\n\t\t\t\t\t\tif(c.r < e2[0].s.r || c.r > e2[0].e.r) continue;\n\t\t\t\t\t\tstack.push(stringify_formula(e2[1], _range, q, supbooks, opts));\n\t\t\t\t\t\tfnd = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(!fnd) stack.push(f[1]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgArray': /* [MS-XLS] 2.5.198.32 TODO */\n\t\t\t\tstack.push(\"{\" + stringify_array(f[1]) + \"}\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMemArea': /* [MS-XLS] 2.5.198.70 TODO: confirm this is a non-display */\n\t\t\t\t//stack.push(\"(\" + f[2].map(encode_range).join(\",\") + \")\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgAttrSpace': /* [MS-XLS] 2.5.198.38 */\n\t\t\tcase 'PtgAttrSpaceSemi': /* [MS-XLS] 2.5.198.39 */\n\t\t\t\tlast_sp = ff;\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgTbl': /* [MS-XLS] 2.5.198.92 TODO */\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMemErr': /* [MS-XLS] 2.5.198.71 */\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMissArg': /* [MS-XLS] 2.5.198.74 */\n\t\t\t\tstack.push(\"\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgAreaErr': /* [MS-XLS] 2.5.198.29 */\n\t\t\t\tstack.push(\"#REF!\"); break;\n\n\t\t\tcase 'PtgAreaErr3d': /* [MS-XLS] 2.5.198.30 */\n\t\t\t\tstack.push(\"#REF!\"); break;\n\n\t\t\tcase 'PtgList': /* [MS-XLSB] 2.5.97.52 */\n\t\t\t\t// $FlowIgnore\n\t\t\t\tstack.push(\"Table\" + f[1].idx + \"[#\" + f[1].rt + \"]\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMemAreaN':\n\t\t\tcase 'PtgMemNoMemN':\n\t\t\tcase 'PtgAttrNoop':\n\t\t\tcase 'PtgSheet':\n\t\t\tcase 'PtgEndSheet':\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMemFunc': /* [MS-XLS] 2.5.198.72 TODO */\n\t\t\t\tbreak;\n\t\t\tcase 'PtgMemNoMem': /* [MS-XLS] 2.5.198.73 TODO */\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgElfCol': /* [MS-XLS] 2.5.198.46 */\n\t\t\tcase 'PtgElfColS': /* [MS-XLS] 2.5.198.47 */\n\t\t\tcase 'PtgElfColSV': /* [MS-XLS] 2.5.198.48 */\n\t\t\tcase 'PtgElfColV': /* [MS-XLS] 2.5.198.49 */\n\t\t\tcase 'PtgElfLel': /* [MS-XLS] 2.5.198.50 */\n\t\t\tcase 'PtgElfRadical': /* [MS-XLS] 2.5.198.51 */\n\t\t\tcase 'PtgElfRadicalLel': /* [MS-XLS] 2.5.198.52 */\n\t\t\tcase 'PtgElfRadicalS': /* [MS-XLS] 2.5.198.53 */\n\t\t\tcase 'PtgElfRw': /* [MS-XLS] 2.5.198.54 */\n\t\t\tcase 'PtgElfRwV': /* [MS-XLS] 2.5.198.55 */\n\t\t\t\tthrow new Error(\"Unsupported ELFs\");\n\n\t\t\tcase 'PtgSxName': /* [MS-XLS] 2.5.198.91 TODO -- find a test case */\n\t\t\t\tthrow new Error('Unrecognized Formula Token: ' + String(f));\n\t\t\tdefault: throw new Error('Unrecognized Formula Token: ' + String(f));\n\t\t}\n\t\tvar PtgNonDisp = ['PtgAttrSpace', 'PtgAttrSpaceSemi', 'PtgAttrGoto'];\n\t\tif(opts.biff != 3) if(last_sp >= 0 && PtgNonDisp.indexOf(formula[0][ff][0]) == -1) {\n\t\t\tf = formula[0][last_sp];\n\t\t\tvar _left = true;\n\t\t\tswitch(f[1][0]) {\n\t\t\t\t/* note: some bad XLSB files omit the PtgParen */\n\t\t\t\tcase 4: _left = false;\n\t\t\t\t/* falls through */\n\t\t\t\tcase 0:\n\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\tsp = fill(\" \", f[1][1]); break;\n\t\t\t\tcase 5: _left = false;\n\t\t\t\t/* falls through */\n\t\t\t\tcase 1:\n\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\tsp = fill(\"\\r\", f[1][1]); break;\n\t\t\t\tdefault:\n\t\t\t\t\tsp = \"\";\n\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\tif(opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + f[1][0]);\n\t\t\t}\n\t\t\tstack.push((_left ? sp : \"\") + stack.pop() + (_left ? \"\" : sp));\n\t\t\tlast_sp = -1;\n\t\t}\n\t}\n\tif(stack.length > 1 && opts.WTF) throw new Error(\"bad formula stack\");\n\treturn stack[0];\n}\n\n/* [MS-XLS] 2.5.198.1 TODO */\nfunction parse_ArrayParsedFormula(blob, length, opts) {\n\tvar target = blob.l + length, len = opts.biff == 2 ? 1 : 2;\n\tvar rgcb, cce = blob.read_shift(len); // length of rgce\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tif(length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\n\tblob.l = target;\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLS] 2.5.198.3 TODO */\nfunction parse_XLSCellParsedFormula(blob, length, opts) {\n\tvar target = blob.l + length, len = opts.biff == 2 ? 1 : 2;\n\tvar rgcb, cce = blob.read_shift(len); // length of rgce\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tif(length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\n\tblob.l = target;\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLS] 2.5.198.21 */\nfunction parse_NameParsedFormula(blob, length, opts, cce) {\n\tvar target = blob.l + length;\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tvar rgcb;\n\tif(target !== blob.l) rgcb = parse_RgbExtra(blob, target - blob.l, rgce, opts);\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLS] 2.5.198.118 TODO */\nfunction parse_SharedParsedFormula(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar rgcb, cce = blob.read_shift(2); // length of rgce\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tif(length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLS] 2.5.133 TODO: how to emit empty strings? */\nfunction parse_FormulaValue(blob) {\n\tvar b;\n\tif(__readUInt16LE(blob,blob.l + 6) !== 0xFFFF) return [parse_Xnum(blob),'n'];\n\tswitch(blob[blob.l]) {\n\t\tcase 0x00: blob.l += 8; return [\"String\", 's'];\n\t\tcase 0x01: b = blob[blob.l+2] === 0x1; blob.l += 8; return [b,'b'];\n\t\tcase 0x02: b = blob[blob.l+2]; blob.l += 8; return [b,'e'];\n\t\tcase 0x03: blob.l += 8; return [\"\",'s'];\n\t}\n\treturn [];\n}\nfunction write_FormulaValue(value) {\n\tif(value == null) {\n\t\t// Blank String Value\n\t\tvar o = new_buf(8);\n\t\to.write_shift(1, 0x03);\n\t\to.write_shift(1, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0xFFFF);\n\t\treturn o;\n\t} else if(typeof value == \"number\") return write_Xnum(value);\n\treturn write_Xnum(0);\n}\n\n/* [MS-XLS] 2.4.127 TODO */\nfunction parse_Formula(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar cell = parse_XLSCell(blob, 6);\n\tif(opts.biff == 2) ++blob.l;\n\tvar val = parse_FormulaValue(blob,8);\n\tvar flags = blob.read_shift(1);\n\tif(opts.biff != 2) {\n\t\tblob.read_shift(1);\n\t\tif(opts.biff >= 5) {\n\t\t\t/*var chn = */blob.read_shift(4);\n\t\t}\n\t}\n\tvar cbf = parse_XLSCellParsedFormula(blob, end - blob.l, opts);\n\treturn {cell:cell, val:val[0], formula:cbf, shared: (flags >> 3) & 1, tt:val[1]};\n}\nfunction write_Formula(cell, R, C, opts, os) {\n\t// Cell\n\tvar o1 = write_XLSCell(R, C, os);\n\n\t// FormulaValue\n\tvar o2 = write_FormulaValue(cell.v);\n\n\t// flags + cache\n\tvar o3 = new_buf(6);\n\tvar flags = 0x01 | 0x20;\n\to3.write_shift(2, flags);\n\to3.write_shift(4, 0);\n\n\t// CellParsedFormula\n\tvar bf = new_buf(cell.bf.length);\n\tfor(var i = 0; i < cell.bf.length; ++i) bf[i] = cell.bf[i];\n\n\tvar out = bconcat([o1, o2, o3, bf]);\n\treturn out;\n}\n\n\n/* XLSB Parsed Formula records have the same shape */\nfunction parse_XLSBParsedFormula(data, length, opts) {\n\tvar cce = data.read_shift(4);\n\tvar rgce = parse_Rgce(data, cce, opts);\n\tvar cb = data.read_shift(4);\n\tvar rgcb = cb > 0 ? parse_RgbExtra(data, cb, rgce, opts) : null;\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLSB] 2.5.97.1 ArrayParsedFormula */\nvar parse_XLSBArrayParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.4 CellParsedFormula */\nvar parse_XLSBCellParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.8 DVParsedFormula */\n//var parse_XLSBDVParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.9 FRTParsedFormula */\n//var parse_XLSBFRTParsedFormula = parse_XLSBParsedFormula2;\n/* [MS-XLSB] 2.5.97.12 NameParsedFormula */\nvar parse_XLSBNameParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.98 SharedParsedFormula */\nvar parse_XLSBSharedParsedFormula = parse_XLSBParsedFormula;\nvar Cetab = {\n  0: \"BEEP\",\n  1: \"OPEN\",\n  2: \"OPEN.LINKS\",\n  3: \"CLOSE.ALL\",\n  4: \"SAVE\",\n  5: \"SAVE.AS\",\n  6: \"FILE.DELETE\",\n  7: \"PAGE.SETUP\",\n  8: \"PRINT\",\n  9: \"PRINTER.SETUP\",\n  10: \"QUIT\",\n  11: \"NEW.WINDOW\",\n  12: \"ARRANGE.ALL\",\n  13: \"WINDOW.SIZE\",\n  14: \"WINDOW.MOVE\",\n  15: \"FULL\",\n  16: \"CLOSE\",\n  17: \"RUN\",\n  22: \"SET.PRINT.AREA\",\n  23: \"SET.PRINT.TITLES\",\n  24: \"SET.PAGE.BREAK\",\n  25: \"REMOVE.PAGE.BREAK\",\n  26: \"FONT\",\n  27: \"DISPLAY\",\n  28: \"PROTECT.DOCUMENT\",\n  29: \"PRECISION\",\n  30: \"A1.R1C1\",\n  31: \"CALCULATE.NOW\",\n  32: \"CALCULATION\",\n  34: \"DATA.FIND\",\n  35: \"EXTRACT\",\n  36: \"DATA.DELETE\",\n  37: \"SET.DATABASE\",\n  38: \"SET.CRITERIA\",\n  39: \"SORT\",\n  40: \"DATA.SERIES\",\n  41: \"TABLE\",\n  42: \"FORMAT.NUMBER\",\n  43: \"ALIGNMENT\",\n  44: \"STYLE\",\n  45: \"BORDER\",\n  46: \"CELL.PROTECTION\",\n  47: \"COLUMN.WIDTH\",\n  48: \"UNDO\",\n  49: \"CUT\",\n  50: \"COPY\",\n  51: \"PASTE\",\n  52: \"CLEAR\",\n  53: \"PASTE.SPECIAL\",\n  54: \"EDIT.DELETE\",\n  55: \"INSERT\",\n  56: \"FILL.RIGHT\",\n  57: \"FILL.DOWN\",\n  61: \"DEFINE.NAME\",\n  62: \"CREATE.NAMES\",\n  63: \"FORMULA.GOTO\",\n  64: \"FORMULA.FIND\",\n  65: \"SELECT.LAST.CELL\",\n  66: \"SHOW.ACTIVE.CELL\",\n  67: \"GALLERY.AREA\",\n  68: \"GALLERY.BAR\",\n  69: \"GALLERY.COLUMN\",\n  70: \"GALLERY.LINE\",\n  71: \"GALLERY.PIE\",\n  72: \"GALLERY.SCATTER\",\n  73: \"COMBINATION\",\n  74: \"PREFERRED\",\n  75: \"ADD.OVERLAY\",\n  76: \"GRIDLINES\",\n  77: \"SET.PREFERRED\",\n  78: \"AXES\",\n  79: \"LEGEND\",\n  80: \"ATTACH.TEXT\",\n  81: \"ADD.ARROW\",\n  82: \"SELECT.CHART\",\n  83: \"SELECT.PLOT.AREA\",\n  84: \"PATTERNS\",\n  85: \"MAIN.CHART\",\n  86: \"OVERLAY\",\n  87: \"SCALE\",\n  88: \"FORMAT.LEGEND\",\n  89: \"FORMAT.TEXT\",\n  90: \"EDIT.REPEAT\",\n  91: \"PARSE\",\n  92: \"JUSTIFY\",\n  93: \"HIDE\",\n  94: \"UNHIDE\",\n  95: \"WORKSPACE\",\n  96: \"FORMULA\",\n  97: \"FORMULA.FILL\",\n  98: \"FORMULA.ARRAY\",\n  99: \"DATA.FIND.NEXT\",\n  100: \"DATA.FIND.PREV\",\n  101: \"FORMULA.FIND.NEXT\",\n  102: \"FORMULA.FIND.PREV\",\n  103: \"ACTIVATE\",\n  104: \"ACTIVATE.NEXT\",\n  105: \"ACTIVATE.PREV\",\n  106: \"UNLOCKED.NEXT\",\n  107: \"UNLOCKED.PREV\",\n  108: \"COPY.PICTURE\",\n  109: \"SELECT\",\n  110: \"DELETE.NAME\",\n  111: \"DELETE.FORMAT\",\n  112: \"VLINE\",\n  113: \"HLINE\",\n  114: \"VPAGE\",\n  115: \"HPAGE\",\n  116: \"VSCROLL\",\n  117: \"HSCROLL\",\n  118: \"ALERT\",\n  119: \"NEW\",\n  120: \"CANCEL.COPY\",\n  121: \"SHOW.CLIPBOARD\",\n  122: \"MESSAGE\",\n  124: \"PASTE.LINK\",\n  125: \"APP.ACTIVATE\",\n  126: \"DELETE.ARROW\",\n  127: \"ROW.HEIGHT\",\n  128: \"FORMAT.MOVE\",\n  129: \"FORMAT.SIZE\",\n  130: \"FORMULA.REPLACE\",\n  131: \"SEND.KEYS\",\n  132: \"SELECT.SPECIAL\",\n  133: \"APPLY.NAMES\",\n  134: \"REPLACE.FONT\",\n  135: \"FREEZE.PANES\",\n  136: \"SHOW.INFO\",\n  137: \"SPLIT\",\n  138: \"ON.WINDOW\",\n  139: \"ON.DATA\",\n  140: \"DISABLE.INPUT\",\n  142: \"OUTLINE\",\n  143: \"LIST.NAMES\",\n  144: \"FILE.CLOSE\",\n  145: \"SAVE.WORKBOOK\",\n  146: \"DATA.FORM\",\n  147: \"COPY.CHART\",\n  148: \"ON.TIME\",\n  149: \"WAIT\",\n  150: \"FORMAT.FONT\",\n  151: \"FILL.UP\",\n  152: \"FILL.LEFT\",\n  153: \"DELETE.OVERLAY\",\n  155: \"SHORT.MENUS\",\n  159: \"SET.UPDATE.STATUS\",\n  161: \"COLOR.PALETTE\",\n  162: \"DELETE.STYLE\",\n  163: \"WINDOW.RESTORE\",\n  164: \"WINDOW.MAXIMIZE\",\n  166: \"CHANGE.LINK\",\n  167: \"CALCULATE.DOCUMENT\",\n  168: \"ON.KEY\",\n  169: \"APP.RESTORE\",\n  170: \"APP.MOVE\",\n  171: \"APP.SIZE\",\n  172: \"APP.MINIMIZE\",\n  173: \"APP.MAXIMIZE\",\n  174: \"BRING.TO.FRONT\",\n  175: \"SEND.TO.BACK\",\n  185: \"MAIN.CHART.TYPE\",\n  186: \"OVERLAY.CHART.TYPE\",\n  187: \"SELECT.END\",\n  188: \"OPEN.MAIL\",\n  189: \"SEND.MAIL\",\n  190: \"STANDARD.FONT\",\n  191: \"CONSOLIDATE\",\n  192: \"SORT.SPECIAL\",\n  193: \"GALLERY.3D.AREA\",\n  194: \"GALLERY.3D.COLUMN\",\n  195: \"GALLERY.3D.LINE\",\n  196: \"GALLERY.3D.PIE\",\n  197: \"VIEW.3D\",\n  198: \"GOAL.SEEK\",\n  199: \"WORKGROUP\",\n  200: \"FILL.GROUP\",\n  201: \"UPDATE.LINK\",\n  202: \"PROMOTE\",\n  203: \"DEMOTE\",\n  204: \"SHOW.DETAIL\",\n  206: \"UNGROUP\",\n  207: \"OBJECT.PROPERTIES\",\n  208: \"SAVE.NEW.OBJECT\",\n  209: \"SHARE\",\n  210: \"SHARE.NAME\",\n  211: \"DUPLICATE\",\n  212: \"APPLY.STYLE\",\n  213: \"ASSIGN.TO.OBJECT\",\n  214: \"OBJECT.PROTECTION\",\n  215: \"HIDE.OBJECT\",\n  216: \"SET.EXTRACT\",\n  217: \"CREATE.PUBLISHER\",\n  218: \"SUBSCRIBE.TO\",\n  219: \"ATTRIBUTES\",\n  220: \"SHOW.TOOLBAR\",\n  222: \"PRINT.PREVIEW\",\n  223: \"EDIT.COLOR\",\n  224: \"SHOW.LEVELS\",\n  225: \"FORMAT.MAIN\",\n  226: \"FORMAT.OVERLAY\",\n  227: \"ON.RECALC\",\n  228: \"EDIT.SERIES\",\n  229: \"DEFINE.STYLE\",\n  240: \"LINE.PRINT\",\n  243: \"ENTER.DATA\",\n  249: \"GALLERY.RADAR\",\n  250: \"MERGE.STYLES\",\n  251: \"EDITION.OPTIONS\",\n  252: \"PASTE.PICTURE\",\n  253: \"PASTE.PICTURE.LINK\",\n  254: \"SPELLING\",\n  256: \"ZOOM\",\n  259: \"INSERT.OBJECT\",\n  260: \"WINDOW.MINIMIZE\",\n  265: \"SOUND.NOTE\",\n  266: \"SOUND.PLAY\",\n  267: \"FORMAT.SHAPE\",\n  268: \"EXTEND.POLYGON\",\n  269: \"FORMAT.AUTO\",\n  272: \"GALLERY.3D.BAR\",\n  273: \"GALLERY.3D.SURFACE\",\n  274: \"FILL.AUTO\",\n  276: \"CUSTOMIZE.TOOLBAR\",\n  277: \"ADD.TOOL\",\n  278: \"EDIT.OBJECT\",\n  279: \"ON.DOUBLECLICK\",\n  280: \"ON.ENTRY\",\n  281: \"WORKBOOK.ADD\",\n  282: \"WORKBOOK.MOVE\",\n  283: \"WORKBOOK.COPY\",\n  284: \"WORKBOOK.OPTIONS\",\n  285: \"SAVE.WORKSPACE\",\n  288: \"CHART.WIZARD\",\n  289: \"DELETE.TOOL\",\n  290: \"MOVE.TOOL\",\n  291: \"WORKBOOK.SELECT\",\n  292: \"WORKBOOK.ACTIVATE\",\n  293: \"ASSIGN.TO.TOOL\",\n  295: \"COPY.TOOL\",\n  296: \"RESET.TOOL\",\n  297: \"CONSTRAIN.NUMERIC\",\n  298: \"PASTE.TOOL\",\n  302: \"WORKBOOK.NEW\",\n  305: \"SCENARIO.CELLS\",\n  306: \"SCENARIO.DELETE\",\n  307: \"SCENARIO.ADD\",\n  308: \"SCENARIO.EDIT\",\n  309: \"SCENARIO.SHOW\",\n  310: \"SCENARIO.SHOW.NEXT\",\n  311: \"SCENARIO.SUMMARY\",\n  312: \"PIVOT.TABLE.WIZARD\",\n  313: \"PIVOT.FIELD.PROPERTIES\",\n  314: \"PIVOT.FIELD\",\n  315: \"PIVOT.ITEM\",\n  316: \"PIVOT.ADD.FIELDS\",\n  318: \"OPTIONS.CALCULATION\",\n  319: \"OPTIONS.EDIT\",\n  320: \"OPTIONS.VIEW\",\n  321: \"ADDIN.MANAGER\",\n  322: \"MENU.EDITOR\",\n  323: \"ATTACH.TOOLBARS\",\n  324: \"VBAActivate\",\n  325: \"OPTIONS.CHART\",\n  328: \"VBA.INSERT.FILE\",\n  330: \"VBA.PROCEDURE.DEFINITION\",\n  336: \"ROUTING.SLIP\",\n  338: \"ROUTE.DOCUMENT\",\n  339: \"MAIL.LOGON\",\n  342: \"INSERT.PICTURE\",\n  343: \"EDIT.TOOL\",\n  344: \"GALLERY.DOUGHNUT\",\n  350: \"CHART.TREND\",\n  352: \"PIVOT.ITEM.PROPERTIES\",\n  354: \"WORKBOOK.INSERT\",\n  355: \"OPTIONS.TRANSITION\",\n  356: \"OPTIONS.GENERAL\",\n  370: \"FILTER.ADVANCED\",\n  373: \"MAIL.ADD.MAILER\",\n  374: \"MAIL.DELETE.MAILER\",\n  375: \"MAIL.REPLY\",\n  376: \"MAIL.REPLY.ALL\",\n  377: \"MAIL.FORWARD\",\n  378: \"MAIL.NEXT.LETTER\",\n  379: \"DATA.LABEL\",\n  380: \"INSERT.TITLE\",\n  381: \"FONT.PROPERTIES\",\n  382: \"MACRO.OPTIONS\",\n  383: \"WORKBOOK.HIDE\",\n  384: \"WORKBOOK.UNHIDE\",\n  385: \"WORKBOOK.DELETE\",\n  386: \"WORKBOOK.NAME\",\n  388: \"GALLERY.CUSTOM\",\n  390: \"ADD.CHART.AUTOFORMAT\",\n  391: \"DELETE.CHART.AUTOFORMAT\",\n  392: \"CHART.ADD.DATA\",\n  393: \"AUTO.OUTLINE\",\n  394: \"TAB.ORDER\",\n  395: \"SHOW.DIALOG\",\n  396: \"SELECT.ALL\",\n  397: \"UNGROUP.SHEETS\",\n  398: \"SUBTOTAL.CREATE\",\n  399: \"SUBTOTAL.REMOVE\",\n  400: \"RENAME.OBJECT\",\n  412: \"WORKBOOK.SCROLL\",\n  413: \"WORKBOOK.NEXT\",\n  414: \"WORKBOOK.PREV\",\n  415: \"WORKBOOK.TAB.SPLIT\",\n  416: \"FULL.SCREEN\",\n  417: \"WORKBOOK.PROTECT\",\n  420: \"SCROLLBAR.PROPERTIES\",\n  421: \"PIVOT.SHOW.PAGES\",\n  422: \"TEXT.TO.COLUMNS\",\n  423: \"FORMAT.CHARTTYPE\",\n  424: \"LINK.FORMAT\",\n  425: \"TRACER.DISPLAY\",\n  430: \"TRACER.NAVIGATE\",\n  431: \"TRACER.CLEAR\",\n  432: \"TRACER.ERROR\",\n  433: \"PIVOT.FIELD.GROUP\",\n  434: \"PIVOT.FIELD.UNGROUP\",\n  435: \"CHECKBOX.PROPERTIES\",\n  436: \"LABEL.PROPERTIES\",\n  437: \"LISTBOX.PROPERTIES\",\n  438: \"EDITBOX.PROPERTIES\",\n  439: \"PIVOT.REFRESH\",\n  440: \"LINK.COMBO\",\n  441: \"OPEN.TEXT\",\n  442: \"HIDE.DIALOG\",\n  443: \"SET.DIALOG.FOCUS\",\n  444: \"ENABLE.OBJECT\",\n  445: \"PUSHBUTTON.PROPERTIES\",\n  446: \"SET.DIALOG.DEFAULT\",\n  447: \"FILTER\",\n  448: \"FILTER.SHOW.ALL\",\n  449: \"CLEAR.OUTLINE\",\n  450: \"FUNCTION.WIZARD\",\n  451: \"ADD.LIST.ITEM\",\n  452: \"SET.LIST.ITEM\",\n  453: \"REMOVE.LIST.ITEM\",\n  454: \"SELECT.LIST.ITEM\",\n  455: \"SET.CONTROL.VALUE\",\n  456: \"SAVE.COPY.AS\",\n  458: \"OPTIONS.LISTS.ADD\",\n  459: \"OPTIONS.LISTS.DELETE\",\n  460: \"SERIES.AXES\",\n  461: \"SERIES.X\",\n  462: \"SERIES.Y\",\n  463: \"ERRORBAR.X\",\n  464: \"ERRORBAR.Y\",\n  465: \"FORMAT.CHART\",\n  466: \"SERIES.ORDER\",\n  467: \"MAIL.LOGOFF\",\n  468: \"CLEAR.ROUTING.SLIP\",\n  469: \"APP.ACTIVATE.MICROSOFT\",\n  470: \"MAIL.EDIT.MAILER\",\n  471: \"ON.SHEET\",\n  472: \"STANDARD.WIDTH\",\n  473: \"SCENARIO.MERGE\",\n  474: \"SUMMARY.INFO\",\n  475: \"FIND.FILE\",\n  476: \"ACTIVE.CELL.FONT\",\n  477: \"ENABLE.TIPWIZARD\",\n  478: \"VBA.MAKE.ADDIN\",\n  480: \"INSERTDATATABLE\",\n  481: \"WORKGROUP.OPTIONS\",\n  482: \"MAIL.SEND.MAILER\",\n  485: \"AUTOCORRECT\",\n  489: \"POST.DOCUMENT\",\n  491: \"PICKLIST\",\n  493: \"VIEW.SHOW\",\n  494: \"VIEW.DEFINE\",\n  495: \"VIEW.DELETE\",\n  509: \"SHEET.BACKGROUND\",\n  510: \"INSERT.MAP.OBJECT\",\n  511: \"OPTIONS.MENONO\",\n  517: \"MSOCHECKS\",\n  518: \"NORMAL\",\n  519: \"LAYOUT\",\n  520: \"RM.PRINT.AREA\",\n  521: \"CLEAR.PRINT.AREA\",\n  522: \"ADD.PRINT.AREA\",\n  523: \"MOVE.BRK\",\n  545: \"HIDECURR.NOTE\",\n  546: \"HIDEALL.NOTES\",\n  547: \"DELETE.NOTE\",\n  548: \"TRAVERSE.NOTES\",\n  549: \"ACTIVATE.NOTES\",\n  620: \"PROTECT.REVISIONS\",\n  621: \"UNPROTECT.REVISIONS\",\n  647: \"OPTIONS.ME\",\n  653: \"WEB.PUBLISH\",\n  667: \"NEWWEBQUERY\",\n  673: \"PIVOT.TABLE.CHART\",\n  753: \"OPTIONS.SAVE\",\n  755: \"OPTIONS.SPELL\",\n  808: \"HIDEALL.INKANNOTS\"\n};\nvar Ftab = {\n  0: \"COUNT\",\n  1: \"IF\",\n  2: \"ISNA\",\n  3: \"ISERROR\",\n  4: \"SUM\",\n  5: \"AVERAGE\",\n  6: \"MIN\",\n  7: \"MAX\",\n  8: \"ROW\",\n  9: \"COLUMN\",\n  10: \"NA\",\n  11: \"NPV\",\n  12: \"STDEV\",\n  13: \"DOLLAR\",\n  14: \"FIXED\",\n  15: \"SIN\",\n  16: \"COS\",\n  17: \"TAN\",\n  18: \"ATAN\",\n  19: \"PI\",\n  20: \"SQRT\",\n  21: \"EXP\",\n  22: \"LN\",\n  23: \"LOG10\",\n  24: \"ABS\",\n  25: \"INT\",\n  26: \"SIGN\",\n  27: \"ROUND\",\n  28: \"LOOKUP\",\n  29: \"INDEX\",\n  30: \"REPT\",\n  31: \"MID\",\n  32: \"LEN\",\n  33: \"VALUE\",\n  34: \"TRUE\",\n  35: \"FALSE\",\n  36: \"AND\",\n  37: \"OR\",\n  38: \"NOT\",\n  39: \"MOD\",\n  40: \"DCOUNT\",\n  41: \"DSUM\",\n  42: \"DAVERAGE\",\n  43: \"DMIN\",\n  44: \"DMAX\",\n  45: \"DSTDEV\",\n  46: \"VAR\",\n  47: \"DVAR\",\n  48: \"TEXT\",\n  49: \"LINEST\",\n  50: \"TREND\",\n  51: \"LOGEST\",\n  52: \"GROWTH\",\n  53: \"GOTO\",\n  54: \"HALT\",\n  55: \"RETURN\",\n  56: \"PV\",\n  57: \"FV\",\n  58: \"NPER\",\n  59: \"PMT\",\n  60: \"RATE\",\n  61: \"MIRR\",\n  62: \"IRR\",\n  63: \"RAND\",\n  64: \"MATCH\",\n  65: \"DATE\",\n  66: \"TIME\",\n  67: \"DAY\",\n  68: \"MONTH\",\n  69: \"YEAR\",\n  70: \"WEEKDAY\",\n  71: \"HOUR\",\n  72: \"MINUTE\",\n  73: \"SECOND\",\n  74: \"NOW\",\n  75: \"AREAS\",\n  76: \"ROWS\",\n  77: \"COLUMNS\",\n  78: \"OFFSET\",\n  79: \"ABSREF\",\n  80: \"RELREF\",\n  81: \"ARGUMENT\",\n  82: \"SEARCH\",\n  83: \"TRANSPOSE\",\n  84: \"ERROR\",\n  85: \"STEP\",\n  86: \"TYPE\",\n  87: \"ECHO\",\n  88: \"SET.NAME\",\n  89: \"CALLER\",\n  90: \"DEREF\",\n  91: \"WINDOWS\",\n  92: \"SERIES\",\n  93: \"DOCUMENTS\",\n  94: \"ACTIVE.CELL\",\n  95: \"SELECTION\",\n  96: \"RESULT\",\n  97: \"ATAN2\",\n  98: \"ASIN\",\n  99: \"ACOS\",\n  100: \"CHOOSE\",\n  101: \"HLOOKUP\",\n  102: \"VLOOKUP\",\n  103: \"LINKS\",\n  104: \"INPUT\",\n  105: \"ISREF\",\n  106: \"GET.FORMULA\",\n  107: \"GET.NAME\",\n  108: \"SET.VALUE\",\n  109: \"LOG\",\n  110: \"EXEC\",\n  111: \"CHAR\",\n  112: \"LOWER\",\n  113: \"UPPER\",\n  114: \"PROPER\",\n  115: \"LEFT\",\n  116: \"RIGHT\",\n  117: \"EXACT\",\n  118: \"TRIM\",\n  119: \"REPLACE\",\n  120: \"SUBSTITUTE\",\n  121: \"CODE\",\n  122: \"NAMES\",\n  123: \"DIRECTORY\",\n  124: \"FIND\",\n  125: \"CELL\",\n  126: \"ISERR\",\n  127: \"ISTEXT\",\n  128: \"ISNUMBER\",\n  129: \"ISBLANK\",\n  130: \"T\",\n  131: \"N\",\n  132: \"FOPEN\",\n  133: \"FCLOSE\",\n  134: \"FSIZE\",\n  135: \"FREADLN\",\n  136: \"FREAD\",\n  137: \"FWRITELN\",\n  138: \"FWRITE\",\n  139: \"FPOS\",\n  140: \"DATEVALUE\",\n  141: \"TIMEVALUE\",\n  142: \"SLN\",\n  143: \"SYD\",\n  144: \"DDB\",\n  145: \"GET.DEF\",\n  146: \"REFTEXT\",\n  147: \"TEXTREF\",\n  148: \"INDIRECT\",\n  149: \"REGISTER\",\n  150: \"CALL\",\n  151: \"ADD.BAR\",\n  152: \"ADD.MENU\",\n  153: \"ADD.COMMAND\",\n  154: \"ENABLE.COMMAND\",\n  155: \"CHECK.COMMAND\",\n  156: \"RENAME.COMMAND\",\n  157: \"SHOW.BAR\",\n  158: \"DELETE.MENU\",\n  159: \"DELETE.COMMAND\",\n  160: \"GET.CHART.ITEM\",\n  161: \"DIALOG.BOX\",\n  162: \"CLEAN\",\n  163: \"MDETERM\",\n  164: \"MINVERSE\",\n  165: \"MMULT\",\n  166: \"FILES\",\n  167: \"IPMT\",\n  168: \"PPMT\",\n  169: \"COUNTA\",\n  170: \"CANCEL.KEY\",\n  171: \"FOR\",\n  172: \"WHILE\",\n  173: \"BREAK\",\n  174: \"NEXT\",\n  175: \"INITIATE\",\n  176: \"REQUEST\",\n  177: \"POKE\",\n  178: \"EXECUTE\",\n  179: \"TERMINATE\",\n  180: \"RESTART\",\n  181: \"HELP\",\n  182: \"GET.BAR\",\n  183: \"PRODUCT\",\n  184: \"FACT\",\n  185: \"GET.CELL\",\n  186: \"GET.WORKSPACE\",\n  187: \"GET.WINDOW\",\n  188: \"GET.DOCUMENT\",\n  189: \"DPRODUCT\",\n  190: \"ISNONTEXT\",\n  191: \"GET.NOTE\",\n  192: \"NOTE\",\n  193: \"STDEVP\",\n  194: \"VARP\",\n  195: \"DSTDEVP\",\n  196: \"DVARP\",\n  197: \"TRUNC\",\n  198: \"ISLOGICAL\",\n  199: \"DCOUNTA\",\n  200: \"DELETE.BAR\",\n  201: \"UNREGISTER\",\n  204: \"USDOLLAR\",\n  205: \"FINDB\",\n  206: \"SEARCHB\",\n  207: \"REPLACEB\",\n  208: \"LEFTB\",\n  209: \"RIGHTB\",\n  210: \"MIDB\",\n  211: \"LENB\",\n  212: \"ROUNDUP\",\n  213: \"ROUNDDOWN\",\n  214: \"ASC\",\n  215: \"DBCS\",\n  216: \"RANK\",\n  219: \"ADDRESS\",\n  220: \"DAYS360\",\n  221: \"TODAY\",\n  222: \"VDB\",\n  223: \"ELSE\",\n  224: \"ELSE.IF\",\n  225: \"END.IF\",\n  226: \"FOR.CELL\",\n  227: \"MEDIAN\",\n  228: \"SUMPRODUCT\",\n  229: \"SINH\",\n  230: \"COSH\",\n  231: \"TANH\",\n  232: \"ASINH\",\n  233: \"ACOSH\",\n  234: \"ATANH\",\n  235: \"DGET\",\n  236: \"CREATE.OBJECT\",\n  237: \"VOLATILE\",\n  238: \"LAST.ERROR\",\n  239: \"CUSTOM.UNDO\",\n  240: \"CUSTOM.REPEAT\",\n  241: \"FORMULA.CONVERT\",\n  242: \"GET.LINK.INFO\",\n  243: \"TEXT.BOX\",\n  244: \"INFO\",\n  245: \"GROUP\",\n  246: \"GET.OBJECT\",\n  247: \"DB\",\n  248: \"PAUSE\",\n  251: \"RESUME\",\n  252: \"FREQUENCY\",\n  253: \"ADD.TOOLBAR\",\n  254: \"DELETE.TOOLBAR\",\n  255: \"User\",\n  256: \"RESET.TOOLBAR\",\n  257: \"EVALUATE\",\n  258: \"GET.TOOLBAR\",\n  259: \"GET.TOOL\",\n  260: \"SPELLING.CHECK\",\n  261: \"ERROR.TYPE\",\n  262: \"APP.TITLE\",\n  263: \"WINDOW.TITLE\",\n  264: \"SAVE.TOOLBAR\",\n  265: \"ENABLE.TOOL\",\n  266: \"PRESS.TOOL\",\n  267: \"REGISTER.ID\",\n  268: \"GET.WORKBOOK\",\n  269: \"AVEDEV\",\n  270: \"BETADIST\",\n  271: \"GAMMALN\",\n  272: \"BETAINV\",\n  273: \"BINOMDIST\",\n  274: \"CHIDIST\",\n  275: \"CHIINV\",\n  276: \"COMBIN\",\n  277: \"CONFIDENCE\",\n  278: \"CRITBINOM\",\n  279: \"EVEN\",\n  280: \"EXPONDIST\",\n  281: \"FDIST\",\n  282: \"FINV\",\n  283: \"FISHER\",\n  284: \"FISHERINV\",\n  285: \"FLOOR\",\n  286: \"GAMMADIST\",\n  287: \"GAMMAINV\",\n  288: \"CEILING\",\n  289: \"HYPGEOMDIST\",\n  290: \"LOGNORMDIST\",\n  291: \"LOGINV\",\n  292: \"NEGBINOMDIST\",\n  293: \"NORMDIST\",\n  294: \"NORMSDIST\",\n  295: \"NORMINV\",\n  296: \"NORMSINV\",\n  297: \"STANDARDIZE\",\n  298: \"ODD\",\n  299: \"PERMUT\",\n  300: \"POISSON\",\n  301: \"TDIST\",\n  302: \"WEIBULL\",\n  303: \"SUMXMY2\",\n  304: \"SUMX2MY2\",\n  305: \"SUMX2PY2\",\n  306: \"CHITEST\",\n  307: \"CORREL\",\n  308: \"COVAR\",\n  309: \"FORECAST\",\n  310: \"FTEST\",\n  311: \"INTERCEPT\",\n  312: \"PEARSON\",\n  313: \"RSQ\",\n  314: \"STEYX\",\n  315: \"SLOPE\",\n  316: \"TTEST\",\n  317: \"PROB\",\n  318: \"DEVSQ\",\n  319: \"GEOMEAN\",\n  320: \"HARMEAN\",\n  321: \"SUMSQ\",\n  322: \"KURT\",\n  323: \"SKEW\",\n  324: \"ZTEST\",\n  325: \"LARGE\",\n  326: \"SMALL\",\n  327: \"QUARTILE\",\n  328: \"PERCENTILE\",\n  329: \"PERCENTRANK\",\n  330: \"MODE\",\n  331: \"TRIMMEAN\",\n  332: \"TINV\",\n  334: \"MOVIE.COMMAND\",\n  335: \"GET.MOVIE\",\n  336: \"CONCATENATE\",\n  337: \"POWER\",\n  338: \"PIVOT.ADD.DATA\",\n  339: \"GET.PIVOT.TABLE\",\n  340: \"GET.PIVOT.FIELD\",\n  341: \"GET.PIVOT.ITEM\",\n  342: \"RADIANS\",\n  343: \"DEGREES\",\n  344: \"SUBTOTAL\",\n  345: \"SUMIF\",\n  346: \"COUNTIF\",\n  347: \"COUNTBLANK\",\n  348: \"SCENARIO.GET\",\n  349: \"OPTIONS.LISTS.GET\",\n  350: \"ISPMT\",\n  351: \"DATEDIF\",\n  352: \"DATESTRING\",\n  353: \"NUMBERSTRING\",\n  354: \"ROMAN\",\n  355: \"OPEN.DIALOG\",\n  356: \"SAVE.DIALOG\",\n  357: \"VIEW.GET\",\n  358: \"GETPIVOTDATA\",\n  359: \"HYPERLINK\",\n  360: \"PHONETIC\",\n  361: \"AVERAGEA\",\n  362: \"MAXA\",\n  363: \"MINA\",\n  364: \"STDEVPA\",\n  365: \"VARPA\",\n  366: \"STDEVA\",\n  367: \"VARA\",\n  368: \"BAHTTEXT\",\n  369: \"THAIDAYOFWEEK\",\n  370: \"THAIDIGIT\",\n  371: \"THAIMONTHOFYEAR\",\n  372: \"THAINUMSOUND\",\n  373: \"THAINUMSTRING\",\n  374: \"THAISTRINGLENGTH\",\n  375: \"ISTHAIDIGIT\",\n  376: \"ROUNDBAHTDOWN\",\n  377: \"ROUNDBAHTUP\",\n  378: \"THAIYEAR\",\n  379: \"RTD\",\n  380: \"CUBEVALUE\",\n  381: \"CUBEMEMBER\",\n  382: \"CUBEMEMBERPROPERTY\",\n  383: \"CUBERANKEDMEMBER\",\n  384: \"HEX2BIN\",\n  385: \"HEX2DEC\",\n  386: \"HEX2OCT\",\n  387: \"DEC2BIN\",\n  388: \"DEC2HEX\",\n  389: \"DEC2OCT\",\n  390: \"OCT2BIN\",\n  391: \"OCT2HEX\",\n  392: \"OCT2DEC\",\n  393: \"BIN2DEC\",\n  394: \"BIN2OCT\",\n  395: \"BIN2HEX\",\n  396: \"IMSUB\",\n  397: \"IMDIV\",\n  398: \"IMPOWER\",\n  399: \"IMABS\",\n  400: \"IMSQRT\",\n  401: \"IMLN\",\n  402: \"IMLOG2\",\n  403: \"IMLOG10\",\n  404: \"IMSIN\",\n  405: \"IMCOS\",\n  406: \"IMEXP\",\n  407: \"IMARGUMENT\",\n  408: \"IMCONJUGATE\",\n  409: \"IMAGINARY\",\n  410: \"IMREAL\",\n  411: \"COMPLEX\",\n  412: \"IMSUM\",\n  413: \"IMPRODUCT\",\n  414: \"SERIESSUM\",\n  415: \"FACTDOUBLE\",\n  416: \"SQRTPI\",\n  417: \"QUOTIENT\",\n  418: \"DELTA\",\n  419: \"GESTEP\",\n  420: \"ISEVEN\",\n  421: \"ISODD\",\n  422: \"MROUND\",\n  423: \"ERF\",\n  424: \"ERFC\",\n  425: \"BESSELJ\",\n  426: \"BESSELK\",\n  427: \"BESSELY\",\n  428: \"BESSELI\",\n  429: \"XIRR\",\n  430: \"XNPV\",\n  431: \"PRICEMAT\",\n  432: \"YIELDMAT\",\n  433: \"INTRATE\",\n  434: \"RECEIVED\",\n  435: \"DISC\",\n  436: \"PRICEDISC\",\n  437: \"YIELDDISC\",\n  438: \"TBILLEQ\",\n  439: \"TBILLPRICE\",\n  440: \"TBILLYIELD\",\n  441: \"PRICE\",\n  442: \"YIELD\",\n  443: \"DOLLARDE\",\n  444: \"DOLLARFR\",\n  445: \"NOMINAL\",\n  446: \"EFFECT\",\n  447: \"CUMPRINC\",\n  448: \"CUMIPMT\",\n  449: \"EDATE\",\n  450: \"EOMONTH\",\n  451: \"YEARFRAC\",\n  452: \"COUPDAYBS\",\n  453: \"COUPDAYS\",\n  454: \"COUPDAYSNC\",\n  455: \"COUPNCD\",\n  456: \"COUPNUM\",\n  457: \"COUPPCD\",\n  458: \"DURATION\",\n  459: \"MDURATION\",\n  460: \"ODDLPRICE\",\n  461: \"ODDLYIELD\",\n  462: \"ODDFPRICE\",\n  463: \"ODDFYIELD\",\n  464: \"RANDBETWEEN\",\n  465: \"WEEKNUM\",\n  466: \"AMORDEGRC\",\n  467: \"AMORLINC\",\n  468: \"CONVERT\",\n  724: \"SHEETJS\",\n  469: \"ACCRINT\",\n  470: \"ACCRINTM\",\n  471: \"WORKDAY\",\n  472: \"NETWORKDAYS\",\n  473: \"GCD\",\n  474: \"MULTINOMIAL\",\n  475: \"LCM\",\n  476: \"FVSCHEDULE\",\n  477: \"CUBEKPIMEMBER\",\n  478: \"CUBESET\",\n  479: \"CUBESETCOUNT\",\n  480: \"IFERROR\",\n  481: \"COUNTIFS\",\n  482: \"SUMIFS\",\n  483: \"AVERAGEIF\",\n  484: \"AVERAGEIFS\"\n};\nvar FtabArgc = {\n  2: 1,\n  3: 1,\n  10: 0,\n  15: 1,\n  16: 1,\n  17: 1,\n  18: 1,\n  19: 0,\n  20: 1,\n  21: 1,\n  22: 1,\n  23: 1,\n  24: 1,\n  25: 1,\n  26: 1,\n  27: 2,\n  30: 2,\n  31: 3,\n  32: 1,\n  33: 1,\n  34: 0,\n  35: 0,\n  38: 1,\n  39: 2,\n  40: 3,\n  41: 3,\n  42: 3,\n  43: 3,\n  44: 3,\n  45: 3,\n  47: 3,\n  48: 2,\n  53: 1,\n  61: 3,\n  63: 0,\n  65: 3,\n  66: 3,\n  67: 1,\n  68: 1,\n  69: 1,\n  70: 1,\n  71: 1,\n  72: 1,\n  73: 1,\n  74: 0,\n  75: 1,\n  76: 1,\n  77: 1,\n  79: 2,\n  80: 2,\n  83: 1,\n  85: 0,\n  86: 1,\n  89: 0,\n  90: 1,\n  94: 0,\n  95: 0,\n  97: 2,\n  98: 1,\n  99: 1,\n  101: 3,\n  102: 3,\n  105: 1,\n  106: 1,\n  108: 2,\n  111: 1,\n  112: 1,\n  113: 1,\n  114: 1,\n  117: 2,\n  118: 1,\n  119: 4,\n  121: 1,\n  126: 1,\n  127: 1,\n  128: 1,\n  129: 1,\n  130: 1,\n  131: 1,\n  133: 1,\n  134: 1,\n  135: 1,\n  136: 2,\n  137: 2,\n  138: 2,\n  140: 1,\n  141: 1,\n  142: 3,\n  143: 4,\n  144: 4,\n  161: 1,\n  162: 1,\n  163: 1,\n  164: 1,\n  165: 2,\n  172: 1,\n  175: 2,\n  176: 2,\n  177: 3,\n  178: 2,\n  179: 1,\n  184: 1,\n  186: 1,\n  189: 3,\n  190: 1,\n  195: 3,\n  196: 3,\n  197: 1,\n  198: 1,\n  199: 3,\n  201: 1,\n  207: 4,\n  210: 3,\n  211: 1,\n  212: 2,\n  213: 2,\n  214: 1,\n  215: 1,\n  225: 0,\n  229: 1,\n  230: 1,\n  231: 1,\n  232: 1,\n  233: 1,\n  234: 1,\n  235: 3,\n  244: 1,\n  247: 4,\n  252: 2,\n  257: 1,\n  261: 1,\n  271: 1,\n  273: 4,\n  274: 2,\n  275: 2,\n  276: 2,\n  277: 3,\n  278: 3,\n  279: 1,\n  280: 3,\n  281: 3,\n  282: 3,\n  283: 1,\n  284: 1,\n  285: 2,\n  286: 4,\n  287: 3,\n  288: 2,\n  289: 4,\n  290: 3,\n  291: 3,\n  292: 3,\n  293: 4,\n  294: 1,\n  295: 3,\n  296: 1,\n  297: 3,\n  298: 1,\n  299: 2,\n  300: 3,\n  301: 3,\n  302: 4,\n  303: 2,\n  304: 2,\n  305: 2,\n  306: 2,\n  307: 2,\n  308: 2,\n  309: 3,\n  310: 2,\n  311: 2,\n  312: 2,\n  313: 2,\n  314: 2,\n  315: 2,\n  316: 4,\n  325: 2,\n  326: 2,\n  327: 2,\n  328: 2,\n  331: 2,\n  332: 2,\n  337: 2,\n  342: 1,\n  343: 1,\n  346: 2,\n  347: 1,\n  350: 4,\n  351: 3,\n  352: 1,\n  353: 2,\n  360: 1,\n  368: 1,\n  369: 1,\n  370: 1,\n  371: 1,\n  372: 1,\n  373: 1,\n  374: 1,\n  375: 1,\n  376: 1,\n  377: 1,\n  378: 1,\n  382: 3,\n  385: 1,\n  392: 1,\n  393: 1,\n  396: 2,\n  397: 2,\n  398: 2,\n  399: 1,\n  400: 1,\n  401: 1,\n  402: 1,\n  403: 1,\n  404: 1,\n  405: 1,\n  406: 1,\n  407: 1,\n  408: 1,\n  409: 1,\n  410: 1,\n  414: 4,\n  415: 1,\n  416: 1,\n  417: 2,\n  420: 1,\n  421: 1,\n  422: 2,\n  424: 1,\n  425: 2,\n  426: 2,\n  427: 2,\n  428: 2,\n  430: 3,\n  438: 3,\n  439: 3,\n  440: 3,\n  443: 2,\n  444: 2,\n  445: 2,\n  446: 2,\n  447: 6,\n  448: 6,\n  449: 2,\n  450: 2,\n  464: 2,\n  468: 3,\n  476: 2,\n  479: 1,\n  480: 2,\n  65535: 0\n};\n/* Part 3 TODO: actually parse formulae */\nfunction ods_to_csf_formula(f) {\n\tif(f.slice(0,3) == \"of:\") f = f.slice(3);\n\t/* 5.2 Basic Expressions */\n\tif(f.charCodeAt(0) == 61) {\n\t\tf = f.slice(1);\n\t\tif(f.charCodeAt(0) == 61) f = f.slice(1);\n\t}\n\tf = f.replace(/COM\\.MICROSOFT\\./g, \"\");\n\t/* Part 3 Section 5.8 References */\n\tf = f.replace(/\\[((?:\\.[A-Z]+[0-9]+)(?::\\.[A-Z]+[0-9]+)?)\\]/g, function($$, $1) { return $1.replace(/\\./g,\"\"); });\n\t/* TODO: something other than this */\n\tf = f.replace(/\\[.(#[A-Z]*[?!])\\]/g, \"$1\");\n\treturn f.replace(/[;~]/g,\",\").replace(/\\|/g,\";\");\n}\n\nfunction csf_to_ods_formula(f) {\n\tvar o = \"of:=\" + f.replace(crefregex, \"$1[.$2$3$4$5]\").replace(/\\]:\\[/g,\":\");\n\t/* TODO: something other than this */\n\treturn o.replace(/;/g, \"|\").replace(/,/g,\";\");\n}\n\nfunction ods_to_csf_3D(r) {\n\tvar a = r.split(\":\");\n\tvar s = a[0].split(\".\")[0];\n\treturn [s, a[0].split(\".\")[1] + (a.length > 1 ? (\":\" + (a[1].split(\".\")[1] || a[1].split(\".\")[0])) : \"\")];\n}\n\nfunction csf_to_ods_3D(r) {\n\treturn r.replace(/\\./,\"!\");\n}\n\nvar strs = {}; // shared strings\nvar _ssfopts = {}; // spreadsheet formatting options\n\n\n/*global Map */\nvar browser_has_Map = typeof Map !== 'undefined';\n\nfunction get_sst_id(sst, str, rev) {\n\tvar i = 0, len = sst.length;\n\tif(rev) {\n\t\tif(browser_has_Map ? rev.has(str) : Object.prototype.hasOwnProperty.call(rev, str)) {\n\t\t\tvar revarr = browser_has_Map ? rev.get(str) : rev[str];\n\t\t\tfor(; i < revarr.length; ++i) {\n\t\t\t\tif(sst[revarr[i]].t === str) { sst.Count ++; return revarr[i]; }\n\t\t\t}\n\t\t}\n\t} else for(; i < len; ++i) {\n\t\tif(sst[i].t === str) { sst.Count ++; return i; }\n\t}\n\tsst[len] = ({t:str}); sst.Count ++; sst.Unique ++;\n\tif(rev) {\n\t\tif(browser_has_Map) {\n\t\t\tif(!rev.has(str)) rev.set(str, []);\n\t\t\trev.get(str).push(len);\n\t\t} else {\n\t\t\tif(!Object.prototype.hasOwnProperty.call(rev, str)) rev[str] = [];\n\t\t\trev[str].push(len);\n\t\t}\n\t}\n\treturn len;\n}\n\nfunction col_obj_w(C, col) {\n\tvar p = ({min:C+1,max:C+1});\n\t/* wch (chars), wpx (pixels) */\n\tvar wch = -1;\n\tif(col.MDW) MDW = col.MDW;\n\tif(col.width != null) p.customWidth = 1;\n\telse if(col.wpx != null) wch = px2char(col.wpx);\n\telse if(col.wch != null) wch = col.wch;\n\tif(wch > -1) { p.width = char2width(wch); p.customWidth = 1; }\n\telse if(col.width != null) p.width = col.width;\n\tif(col.hidden) p.hidden = true;\n\tif(col.level != null) { p.outlineLevel = p.level = col.level; }\n\treturn p;\n}\n\nfunction default_margins(margins, mode) {\n\tif(!margins) return;\n\tvar defs = [0.7, 0.7, 0.75, 0.75, 0.3, 0.3];\n\tif(mode == 'xlml') defs = [1, 1, 1, 1, 0.5, 0.5];\n\tif(margins.left   == null) margins.left   = defs[0];\n\tif(margins.right  == null) margins.right  = defs[1];\n\tif(margins.top    == null) margins.top    = defs[2];\n\tif(margins.bottom == null) margins.bottom = defs[3];\n\tif(margins.header == null) margins.header = defs[4];\n\tif(margins.footer == null) margins.footer = defs[5];\n}\n\nfunction get_cell_style(styles, cell, opts) {\n\tvar z = opts.revssf[cell.z != null ? cell.z : \"General\"];\n\tvar i = 0x3c, len = styles.length;\n\tif(z == null && opts.ssf) {\n\t\tfor(; i < 0x188; ++i) if(opts.ssf[i] == null) {\n\t\t\tSSF_load(cell.z, i);\n\t\t\t// $FlowIgnore\n\t\t\topts.ssf[i] = cell.z;\n\t\t\topts.revssf[cell.z] = z = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor(i = 0; i != len; ++i) if(styles[i].numFmtId === z) return i;\n\tstyles[len] = {\n\t\tnumFmtId:z,\n\t\tfontId:0,\n\t\tfillId:0,\n\t\tborderId:0,\n\t\txfId:0,\n\t\tapplyNumberFormat:1\n\t};\n\treturn len;\n}\n\nfunction safe_format(p, fmtid, fillid, opts, themes, styles) {\n\ttry {\n\t\tif(opts.cellNF) p.z = table_fmt[fmtid];\n\t} catch(e) { if(opts.WTF) throw e; }\n\tif(p.t === 'z' && !opts.cellStyles) return;\n\tif(p.t === 'd' && typeof p.v === 'string') p.v = parseDate(p.v);\n\tif((!opts || opts.cellText !== false) && p.t !== 'z') try {\n\t\tif(table_fmt[fmtid] == null) SSF_load(SSFImplicit[fmtid] || \"General\", fmtid);\n\t\tif(p.t === 'e') p.w = p.w || BErr[p.v];\n\t\telse if(fmtid === 0) {\n\t\t\tif(p.t === 'n') {\n\t\t\t\tif((p.v|0) === p.v) p.w = p.v.toString(10);\n\t\t\t\telse p.w = SSF_general_num(p.v);\n\t\t\t}\n\t\t\telse if(p.t === 'd') {\n\t\t\t\tvar dd = datenum(p.v);\n\t\t\t\tif((dd|0) === dd) p.w = dd.toString(10);\n\t\t\t\telse p.w = SSF_general_num(dd);\n\t\t\t}\n\t\t\telse if(p.v === undefined) return \"\";\n\t\t\telse p.w = SSF_general(p.v,_ssfopts);\n\t\t}\n\t\telse if(p.t === 'd') p.w = SSF_format(fmtid,datenum(p.v),_ssfopts);\n\t\telse p.w = SSF_format(fmtid,p.v,_ssfopts);\n\t} catch(e) { if(opts.WTF) throw e; }\n\tif(!opts.cellStyles) return;\n\tif(fillid != null) try {\n\t\tp.s = styles.Fills[fillid];\n\t\tif (p.s.fgColor && p.s.fgColor.theme && !p.s.fgColor.rgb) {\n\t\t\tp.s.fgColor.rgb = rgb_tint(themes.themeElements.clrScheme[p.s.fgColor.theme].rgb, p.s.fgColor.tint || 0);\n\t\t\tif(opts.WTF) p.s.fgColor.raw_rgb = themes.themeElements.clrScheme[p.s.fgColor.theme].rgb;\n\t\t}\n\t\tif (p.s.bgColor && p.s.bgColor.theme) {\n\t\t\tp.s.bgColor.rgb = rgb_tint(themes.themeElements.clrScheme[p.s.bgColor.theme].rgb, p.s.bgColor.tint || 0);\n\t\t\tif(opts.WTF) p.s.bgColor.raw_rgb = themes.themeElements.clrScheme[p.s.bgColor.theme].rgb;\n\t\t}\n\t} catch(e) { if(opts.WTF && styles.Fills) throw e; }\n}\n\nfunction check_ws(ws, sname, i) {\n\tif(ws && ws['!ref']) {\n\t\tvar range = safe_decode_range(ws['!ref']);\n\t\tif(range.e.c < range.s.c || range.e.r < range.s.r) throw new Error(\"Bad range (\" + i + \"): \" + ws['!ref']);\n\t}\n}\nfunction parse_ws_xml_dim(ws, s) {\n\tvar d = safe_decode_range(s);\n\tif(d.s.r<=d.e.r && d.s.c<=d.e.c && d.s.r>=0 && d.s.c>=0) ws[\"!ref\"] = encode_range(d);\n}\nvar mergecregex = /<(?:\\w:)?mergeCell ref=\"[A-Z0-9:]+\"\\s*[\\/]?>/g;\nvar sheetdataregex = /<(?:\\w+:)?sheetData[^>]*>([\\s\\S]*)<\\/(?:\\w+:)?sheetData>/;\nvar hlinkregex = /<(?:\\w:)?hyperlink [^>]*>/mg;\nvar dimregex = /\"(\\w*:\\w*)\"/;\nvar colregex = /<(?:\\w:)?col\\b[^>]*[\\/]?>/g;\nvar afregex = /<(?:\\w:)?autoFilter[^>]*([\\/]|>([\\s\\S]*)<\\/(?:\\w:)?autoFilter)>/g;\nvar marginregex= /<(?:\\w:)?pageMargins[^>]*\\/>/g;\nvar sheetprregex = /<(?:\\w:)?sheetPr\\b(?:[^>a-z][^>]*)?\\/>/;\nvar sheetprregex2= /<(?:\\w:)?sheetPr[^>]*(?:[\\/]|>([\\s\\S]*)<\\/(?:\\w:)?sheetPr)>/;\nvar svsregex = /<(?:\\w:)?sheetViews[^>]*(?:[\\/]|>([\\s\\S]*)<\\/(?:\\w:)?sheetViews)>/;\n\n/* 18.3 Worksheets */\nfunction parse_ws_xml(data, opts, idx, rels, wb, themes, styles) {\n\tif(!data) return data;\n\tif(!rels) rels = {'!id':{}};\n\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\n\t/* 18.3.1.99 worksheet CT_Worksheet */\n\tvar s = opts.dense ? ([]) : ({});\n\tvar refguess = ({s: {r:2000000, c:2000000}, e: {r:0, c:0} });\n\n\tvar data1 = \"\", data2 = \"\";\n\tvar mtch = data.match(sheetdataregex);\n\tif(mtch) {\n\t\tdata1 = data.slice(0, mtch.index);\n\t\tdata2 = data.slice(mtch.index + mtch[0].length);\n\t} else data1 = data2 = data;\n\n\t/* 18.3.1.82 sheetPr CT_SheetPr */\n\tvar sheetPr = data1.match(sheetprregex);\n\tif(sheetPr) parse_ws_xml_sheetpr(sheetPr[0], s, wb, idx);\n\telse if((sheetPr = data1.match(sheetprregex2))) parse_ws_xml_sheetpr2(sheetPr[0], sheetPr[1]||\"\", s, wb, idx, styles, themes);\n\n\t/* 18.3.1.35 dimension CT_SheetDimension */\n\tvar ridx = (data1.match(/<(?:\\w*:)?dimension/)||{index:-1}).index;\n\tif(ridx > 0) {\n\t\tvar ref = data1.slice(ridx,ridx+50).match(dimregex);\n\t\tif(ref) parse_ws_xml_dim(s, ref[1]);\n\t}\n\n\t/* 18.3.1.88 sheetViews CT_SheetViews */\n\tvar svs = data1.match(svsregex);\n\tif(svs && svs[1]) parse_ws_xml_sheetviews(svs[1], wb);\n\n\t/* 18.3.1.17 cols CT_Cols */\n\tvar columns = [];\n\tif(opts.cellStyles) {\n\t\t/* 18.3.1.13 col CT_Col */\n\t\tvar cols = data1.match(colregex);\n\t\tif(cols) parse_ws_xml_cols(columns, cols);\n\t}\n\n\t/* 18.3.1.80 sheetData CT_SheetData ? */\n\tif(mtch) parse_ws_xml_data(mtch[1], s, opts, refguess, themes, styles);\n\n\t/* 18.3.1.2  autoFilter CT_AutoFilter */\n\tvar afilter = data2.match(afregex);\n\tif(afilter) s['!autofilter'] = parse_ws_xml_autofilter(afilter[0]);\n\n\t/* 18.3.1.55 mergeCells CT_MergeCells */\n\tvar merges = [];\n\tvar _merge = data2.match(mergecregex);\n\tif(_merge) for(ridx = 0; ridx != _merge.length; ++ridx)\n\t\tmerges[ridx] = safe_decode_range(_merge[ridx].slice(_merge[ridx].indexOf(\"\\\"\")+1));\n\n\t/* 18.3.1.48 hyperlinks CT_Hyperlinks */\n\tvar hlink = data2.match(hlinkregex);\n\tif(hlink) parse_ws_xml_hlinks(s, hlink, rels);\n\n\t/* 18.3.1.62 pageMargins CT_PageMargins */\n\tvar margins = data2.match(marginregex);\n\tif(margins) s['!margins'] = parse_ws_xml_margins(parsexmltag(margins[0]));\n\n\tif(!s[\"!ref\"] && refguess.e.c >= refguess.s.c && refguess.e.r >= refguess.s.r) s[\"!ref\"] = encode_range(refguess);\n\tif(opts.sheetRows > 0 && s[\"!ref\"]) {\n\t\tvar tmpref = safe_decode_range(s[\"!ref\"]);\n\t\tif(opts.sheetRows <= +tmpref.e.r) {\n\t\t\ttmpref.e.r = opts.sheetRows - 1;\n\t\t\tif(tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n\t\t\tif(tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n\t\t\tif(tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n\t\t\tif(tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n\t\t\ts[\"!fullref\"] = s[\"!ref\"];\n\t\t\ts[\"!ref\"] = encode_range(tmpref);\n\t\t}\n\t}\n\tif(columns.length > 0) s[\"!cols\"] = columns;\n\tif(merges.length > 0) s[\"!merges\"] = merges;\n\treturn s;\n}\n\nfunction write_ws_xml_merges(merges) {\n\tif(merges.length === 0) return \"\";\n\tvar o = '<mergeCells count=\"' + merges.length + '\">';\n\tfor(var i = 0; i != merges.length; ++i) o += '<mergeCell ref=\"' + encode_range(merges[i]) + '\"/>';\n\treturn o + '</mergeCells>';\n}\n\n/* 18.3.1.82-3 sheetPr CT_ChartsheetPr / CT_SheetPr */\nfunction parse_ws_xml_sheetpr(sheetPr, s, wb, idx) {\n\tvar data = parsexmltag(sheetPr);\n\tif(!wb.Sheets[idx]) wb.Sheets[idx] = {};\n\tif(data.codeName) wb.Sheets[idx].CodeName = unescapexml(utf8read(data.codeName));\n}\nfunction parse_ws_xml_sheetpr2(sheetPr, body, s, wb, idx) {\n\tparse_ws_xml_sheetpr(sheetPr.slice(0, sheetPr.indexOf(\">\")), s, wb, idx);\n}\nfunction write_ws_xml_sheetpr(ws, wb, idx, opts, o) {\n\tvar needed = false;\n\tvar props = {}, payload = null;\n\tif(opts.bookType !== 'xlsx' && wb.vbaraw) {\n\t\tvar cname = wb.SheetNames[idx];\n\t\ttry { if(wb.Workbook) cname = wb.Workbook.Sheets[idx].CodeName || cname; } catch(e) {}\n\t\tneeded = true;\n\t\tprops.codeName = utf8write(escapexml(cname));\n\t}\n\n\tif(ws && ws[\"!outline\"]) {\n\t\tvar outlineprops = {summaryBelow:1, summaryRight:1};\n\t\tif(ws[\"!outline\"].above) outlineprops.summaryBelow = 0;\n\t\tif(ws[\"!outline\"].left) outlineprops.summaryRight = 0;\n\t\tpayload = (payload||\"\") + writextag('outlinePr', null, outlineprops);\n\t}\n\n\tif(!needed && !payload) return;\n\to[o.length] = (writextag('sheetPr', payload, props));\n}\n\n/* 18.3.1.85 sheetProtection CT_SheetProtection */\nvar sheetprot_deffalse = [\"objects\", \"scenarios\", \"selectLockedCells\", \"selectUnlockedCells\"];\nvar sheetprot_deftrue = [\n\t\"formatColumns\", \"formatRows\", \"formatCells\",\n\t\"insertColumns\", \"insertRows\", \"insertHyperlinks\",\n\t\"deleteColumns\", \"deleteRows\",\n\t\"sort\", \"autoFilter\", \"pivotTables\"\n];\nfunction write_ws_xml_protection(sp) {\n\t// algorithmName, hashValue, saltValue, spinCount\n\tvar o = ({sheet:1});\n\tsheetprot_deffalse.forEach(function(n) { if(sp[n] != null && sp[n]) o[n] = \"1\"; });\n\tsheetprot_deftrue.forEach(function(n) { if(sp[n] != null && !sp[n]) o[n] = \"0\"; });\n\t/* TODO: algorithm */\n\tif(sp.password) o.password = crypto_CreatePasswordVerifier_Method1(sp.password).toString(16).toUpperCase();\n\treturn writextag('sheetProtection', null, o);\n}\n\nfunction parse_ws_xml_hlinks(s, data, rels) {\n\tvar dense = Array.isArray(s);\n\tfor(var i = 0; i != data.length; ++i) {\n\t\tvar val = parsexmltag(utf8read(data[i]), true);\n\t\tif(!val.ref) return;\n\t\tvar rel = ((rels || {})['!id']||[])[val.id];\n\t\tif(rel) {\n\t\t\tval.Target = rel.Target;\n\t\t\tif(val.location) val.Target += \"#\"+unescapexml(val.location);\n\t\t} else {\n\t\t\tval.Target = \"#\" + unescapexml(val.location);\n\t\t\trel = {Target: val.Target, TargetMode: 'Internal'};\n\t\t}\n\t\tval.Rel = rel;\n\t\tif(val.tooltip) { val.Tooltip = val.tooltip; delete val.tooltip; }\n\t\tvar rng = safe_decode_range(val.ref);\n\t\tfor(var R=rng.s.r;R<=rng.e.r;++R) for(var C=rng.s.c;C<=rng.e.c;++C) {\n\t\t\tvar addr = encode_cell({c:C,r:R});\n\t\t\tif(dense) {\n\t\t\t\tif(!s[R]) s[R] = [];\n\t\t\t\tif(!s[R][C]) s[R][C] = {t:\"z\",v:undefined};\n\t\t\t\ts[R][C].l = val;\n\t\t\t} else {\n\t\t\t\tif(!s[addr]) s[addr] = {t:\"z\",v:undefined};\n\t\t\t\ts[addr].l = val;\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction parse_ws_xml_margins(margin) {\n\tvar o = {};\n\t[\"left\", \"right\", \"top\", \"bottom\", \"header\", \"footer\"].forEach(function(k) {\n\t\tif(margin[k]) o[k] = parseFloat(margin[k]);\n\t});\n\treturn o;\n}\nfunction write_ws_xml_margins(margin) {\n\tdefault_margins(margin);\n\treturn writextag('pageMargins', null, margin);\n}\n\nfunction parse_ws_xml_cols(columns, cols) {\n\tvar seencol = false;\n\tfor(var coli = 0; coli != cols.length; ++coli) {\n\t\tvar coll = parsexmltag(cols[coli], true);\n\t\tif(coll.hidden) coll.hidden = parsexmlbool(coll.hidden);\n\t\tvar colm=parseInt(coll.min, 10)-1, colM=parseInt(coll.max,10)-1;\n\t\tif(coll.outlineLevel) coll.level = (+coll.outlineLevel || 0);\n\t\tdelete coll.min; delete coll.max; coll.width = +coll.width;\n\t\tif(!seencol && coll.width) { seencol = true; find_mdw_colw(coll.width); }\n\t\tprocess_col(coll);\n\t\twhile(colm <= colM) columns[colm++] = dup(coll);\n\t}\n}\nfunction write_ws_xml_cols(ws, cols) {\n\tvar o = [\"<cols>\"], col;\n\tfor(var i = 0; i != cols.length; ++i) {\n\t\tif(!(col = cols[i])) continue;\n\t\to[o.length] = (writextag('col', null, col_obj_w(i, col)));\n\t}\n\to[o.length] = \"</cols>\";\n\treturn o.join(\"\");\n}\n\nfunction parse_ws_xml_autofilter(data) {\n\tvar o = { ref: (data.match(/ref=\"([^\"]*)\"/)||[])[1]};\n\treturn o;\n}\nfunction write_ws_xml_autofilter(data, ws, wb, idx) {\n\tvar ref = typeof data.ref == \"string\" ? data.ref : encode_range(data.ref);\n\tif(!wb.Workbook) wb.Workbook = ({Sheets:[]});\n\tif(!wb.Workbook.Names) wb.Workbook.Names = [];\n\tvar names = wb.Workbook.Names;\n\tvar range = decode_range(ref);\n\tif(range.s.r == range.e.r) { range.e.r = decode_range(ws[\"!ref\"]).e.r; ref = encode_range(range); }\n\tfor(var i = 0; i < names.length; ++i) {\n\t\tvar name = names[i];\n\t\tif(name.Name != '_xlnm._FilterDatabase') continue;\n\t\tif(name.Sheet != idx) continue;\n\t\tname.Ref = \"'\" + wb.SheetNames[idx] + \"'!\" + ref; break;\n\t}\n\tif(i == names.length) names.push({ Name: '_xlnm._FilterDatabase', Sheet: idx, Ref: \"'\" + wb.SheetNames[idx] + \"'!\" + ref  });\n\treturn writextag(\"autoFilter\", null, {ref:ref});\n}\n\n/* 18.3.1.88 sheetViews CT_SheetViews */\n/* 18.3.1.87 sheetView CT_SheetView */\nvar sviewregex = /<(?:\\w:)?sheetView(?:[^>a-z][^>]*)?\\/?>/;\nfunction parse_ws_xml_sheetviews(data, wb) {\n\tif(!wb.Views) wb.Views = [{}];\n\t(data.match(sviewregex)||[]).forEach(function(r, i) {\n\t\tvar tag = parsexmltag(r);\n\t\t// $FlowIgnore\n\t\tif(!wb.Views[i]) wb.Views[i] = {};\n\t\t// $FlowIgnore\n\t\tif(+tag.zoomScale) wb.Views[i].zoom = +tag.zoomScale;\n\t\t// $FlowIgnore\n\t\tif(parsexmlbool(tag.rightToLeft)) wb.Views[i].RTL = true;\n\t});\n}\nfunction write_ws_xml_sheetviews(ws, opts, idx, wb) {\n\tvar sview = ({workbookViewId:\"0\"});\n\t// $FlowIgnore\n\tif((((wb||{}).Workbook||{}).Views||[])[0]) sview.rightToLeft = wb.Workbook.Views[0].RTL ? \"1\" : \"0\";\n\treturn writextag(\"sheetViews\", writextag(\"sheetView\", null, sview), {});\n}\n\nfunction write_ws_xml_cell(cell, ref, ws, opts) {\n\tif(cell.c) ws['!comments'].push([ref, cell.c]);\n\tif(cell.v === undefined && typeof cell.f !== \"string\" || cell.t === 'z' && !cell.f) return \"\";\n\tvar vv = \"\";\n\tvar oldt = cell.t, oldv = cell.v;\n\tif(cell.t !== \"z\") switch(cell.t) {\n\t\tcase 'b': vv = cell.v ? \"1\" : \"0\"; break;\n\t\tcase 'n': vv = ''+cell.v; break;\n\t\tcase 'e': vv = BErr[cell.v]; break;\n\t\tcase 'd':\n\t\t\tif(opts && opts.cellDates) vv = parseDate(cell.v, -1).toISOString();\n\t\t\telse {\n\t\t\t\tcell = dup(cell);\n\t\t\t\tcell.t = 'n';\n\t\t\t\tvv = ''+(cell.v = datenum(parseDate(cell.v)));\n\t\t\t}\n\t\t\tif(typeof cell.z === 'undefined') cell.z = table_fmt[14];\n\t\t\tbreak;\n\t\tdefault: vv = cell.v; break;\n\t}\n\tvar v = writetag('v', escapexml(vv)), o = ({r:ref});\n\t/* TODO: cell style */\n\tvar os = get_cell_style(opts.cellXfs, cell, opts);\n\tif(os !== 0) o.s = os;\n\tswitch(cell.t) {\n\t\tcase 'n': break;\n\t\tcase 'd': o.t = \"d\"; break;\n\t\tcase 'b': o.t = \"b\"; break;\n\t\tcase 'e': o.t = \"e\"; break;\n\t\tcase 'z': break;\n\t\tdefault: if(cell.v == null) { delete cell.t; break; }\n\t\t\tif(cell.v.length > 32767) throw new Error(\"Text length must not exceed 32767 characters\");\n\t\t\tif(opts && opts.bookSST) {\n\t\t\t\tv = writetag('v', ''+get_sst_id(opts.Strings, cell.v, opts.revStrings));\n\t\t\t\to.t = \"s\"; break;\n\t\t\t}\n\t\t\to.t = \"str\"; break;\n\t}\n\tif(cell.t != oldt) { cell.t = oldt; cell.v = oldv; }\n\tif(typeof cell.f == \"string\" && cell.f) {\n\t\tvar ff = cell.F && cell.F.slice(0, ref.length) == ref ? {t:\"array\", ref:cell.F} : null;\n\t\tv = writextag('f', escapexml(cell.f), ff) + (cell.v != null ? v : \"\");\n\t}\n\tif(cell.l) ws['!links'].push([ref, cell.l]);\n\tif(cell.D) o.cm = 1;\n\treturn writextag('c', v, o);\n}\n\nvar parse_ws_xml_data = (function() {\n\tvar cellregex = /<(?:\\w+:)?c[ \\/>]/, rowregex = /<\\/(?:\\w+:)?row>/;\n\tvar rregex = /r=[\"']([^\"']*)[\"']/, isregex = /<(?:\\w+:)?is>([\\S\\s]*?)<\\/(?:\\w+:)?is>/;\n\tvar refregex = /ref=[\"']([^\"']*)[\"']/;\n\tvar match_v = matchtag(\"v\"), match_f = matchtag(\"f\");\n\nreturn function parse_ws_xml_data(sdata, s, opts, guess, themes, styles) {\n\tvar ri = 0, x = \"\", cells = [], cref = [], idx=0, i=0, cc=0, d=\"\", p;\n\tvar tag, tagr = 0, tagc = 0;\n\tvar sstr, ftag;\n\tvar fmtid = 0, fillid = 0;\n\tvar do_format = Array.isArray(styles.CellXf), cf;\n\tvar arrayf = [];\n\tvar sharedf = [];\n\tvar dense = Array.isArray(s);\n\tvar rows = [], rowobj = {}, rowrite = false;\n\tvar sheetStubs = !!opts.sheetStubs;\n\tfor(var marr = sdata.split(rowregex), mt = 0, marrlen = marr.length; mt != marrlen; ++mt) {\n\t\tx = marr[mt].trim();\n\t\tvar xlen = x.length;\n\t\tif(xlen === 0) continue;\n\n\t\t/* 18.3.1.73 row CT_Row */\n\t\tvar rstarti = 0;\n\t\touta: for(ri = 0; ri < xlen; ++ri) switch(/*x.charCodeAt(ri)*/x[ri]) {\n\t\t\tcase \">\" /*62*/:\n\t\t\t\tif(/*x.charCodeAt(ri-1) != 47*/x[ri-1] != \"/\") { ++ri; break outa; }\n\t\t\t\tif(opts && opts.cellStyles) {\n\t\t\t\t\t// TODO: avoid duplication\n\t\t\t\t\ttag = parsexmltag(x.slice(rstarti,ri), true);\n\t\t\t\t\ttagr = tag.r != null ? parseInt(tag.r, 10) : tagr+1; tagc = -1;\n\t\t\t\t\tif(opts.sheetRows && opts.sheetRows < tagr) continue;\n\t\t\t\t\trowobj = {}; rowrite = false;\n\t\t\t\t\tif(tag.ht) { rowrite = true; rowobj.hpt = parseFloat(tag.ht); rowobj.hpx = pt2px(rowobj.hpt); }\n\t\t\t\t\tif(tag.hidden == \"1\") { rowrite = true; rowobj.hidden = true; }\n\t\t\t\t\tif(tag.outlineLevel != null) { rowrite = true; rowobj.level = +tag.outlineLevel; }\n\t\t\t\t\tif(rowrite) rows[tagr-1] = rowobj;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"<\" /*60*/: rstarti = ri; break;\n\t\t}\n\t\tif(rstarti >= ri) break;\n\t\ttag = parsexmltag(x.slice(rstarti,ri), true);\n\t\ttagr = tag.r != null ? parseInt(tag.r, 10) : tagr+1; tagc = -1;\n\t\tif(opts.sheetRows && opts.sheetRows < tagr) continue;\n\t\tif(guess.s.r > tagr - 1) guess.s.r = tagr - 1;\n\t\tif(guess.e.r < tagr - 1) guess.e.r = tagr - 1;\n\n\t\tif(opts && opts.cellStyles) {\n\t\t\trowobj = {}; rowrite = false;\n\t\t\tif(tag.ht) { rowrite = true; rowobj.hpt = parseFloat(tag.ht); rowobj.hpx = pt2px(rowobj.hpt); }\n\t\t\tif(tag.hidden == \"1\") { rowrite = true; rowobj.hidden = true; }\n\t\t\tif(tag.outlineLevel != null) { rowrite = true; rowobj.level = +tag.outlineLevel; }\n\t\t\tif(rowrite) rows[tagr-1] = rowobj;\n\t\t}\n\n\t\t/* 18.3.1.4 c CT_Cell */\n\t\tcells = x.slice(ri).split(cellregex);\n\t\tfor(var rslice = 0; rslice != cells.length; ++rslice) if(cells[rslice].trim().charAt(0) != \"<\") break;\n\t\tcells = cells.slice(rslice);\n\t\tfor(ri = 0; ri != cells.length; ++ri) {\n\t\t\tx = cells[ri].trim();\n\t\t\tif(x.length === 0) continue;\n\t\t\tcref = x.match(rregex); idx = ri; i=0; cc=0;\n\t\t\tx = \"<c \" + (x.slice(0,1)==\"<\"?\">\":\"\") + x;\n\t\t\tif(cref != null && cref.length === 2) {\n\t\t\t\tidx = 0; d=cref[1];\n\t\t\t\tfor(i=0; i != d.length; ++i) {\n\t\t\t\t\tif((cc=d.charCodeAt(i)-64) < 1 || cc > 26) break;\n\t\t\t\t\tidx = 26*idx + cc;\n\t\t\t\t}\n\t\t\t\t--idx;\n\t\t\t\ttagc = idx;\n\t\t\t} else ++tagc;\n\t\t\tfor(i = 0; i != x.length; ++i) if(x.charCodeAt(i) === 62) break; ++i;\n\t\t\ttag = parsexmltag(x.slice(0,i), true);\n\t\t\tif(!tag.r) tag.r = encode_cell({r:tagr-1, c:tagc});\n\t\t\td = x.slice(i);\n\t\t\tp = ({t:\"\"});\n\n\t\t\tif((cref=d.match(match_v))!= null && cref[1] !== '') p.v=unescapexml(cref[1]);\n\t\t\tif(opts.cellFormula) {\n\t\t\t\tif((cref=d.match(match_f))!= null && cref[1] !== '') {\n\t\t\t\t\t/* TODO: match against XLSXFutureFunctions */\n\t\t\t\t\tp.f=unescapexml(utf8read(cref[1])).replace(/\\r\\n/g, \"\\n\");\n\t\t\t\t\tif(!opts.xlfn) p.f = _xlfn(p.f);\n\t\t\t\t\tif(cref[0].indexOf('t=\"array\"') > -1) {\n\t\t\t\t\t\tp.F = (d.match(refregex)||[])[1];\n\t\t\t\t\t\tif(p.F.indexOf(\":\") > -1) arrayf.push([safe_decode_range(p.F), p.F]);\n\t\t\t\t\t} else if(cref[0].indexOf('t=\"shared\"') > -1) {\n\t\t\t\t\t\t// TODO: parse formula\n\t\t\t\t\t\tftag = parsexmltag(cref[0]);\n\t\t\t\t\t\tvar ___f = unescapexml(utf8read(cref[1]));\n\t\t\t\t\t\tif(!opts.xlfn) ___f = _xlfn(___f);\n\t\t\t\t\t\tsharedf[parseInt(ftag.si, 10)] = [ftag, ___f, tag.r];\n\t\t\t\t\t}\n\t\t\t\t} else if((cref=d.match(/<f[^>]*\\/>/))) {\n\t\t\t\t\tftag = parsexmltag(cref[0]);\n\t\t\t\t\tif(sharedf[ftag.si]) p.f = shift_formula_xlsx(sharedf[ftag.si][1], sharedf[ftag.si][2]/*[0].ref*/, tag.r);\n\t\t\t\t}\n\t\t\t\t/* TODO: factor out contains logic */\n\t\t\t\tvar _tag = decode_cell(tag.r);\n\t\t\t\tfor(i = 0; i < arrayf.length; ++i)\n\t\t\t\t\tif(_tag.r >= arrayf[i][0].s.r && _tag.r <= arrayf[i][0].e.r)\n\t\t\t\t\t\tif(_tag.c >= arrayf[i][0].s.c && _tag.c <= arrayf[i][0].e.c)\n\t\t\t\t\t\t\tp.F = arrayf[i][1];\n\t\t\t}\n\n\t\t\tif(tag.t == null && p.v === undefined) {\n\t\t\t\tif(p.f || p.F) {\n\t\t\t\t\tp.v = 0; p.t = \"n\";\n\t\t\t\t} else if(!sheetStubs) continue;\n\t\t\t\telse p.t = \"z\";\n\t\t\t}\n\t\t\telse p.t = tag.t || \"n\";\n\t\t\tif(guess.s.c > tagc) guess.s.c = tagc;\n\t\t\tif(guess.e.c < tagc) guess.e.c = tagc;\n\t\t\t/* 18.18.11 t ST_CellType */\n\t\t\tswitch(p.t) {\n\t\t\t\tcase 'n':\n\t\t\t\t\tif(p.v == \"\" || p.v == null) {\n\t\t\t\t\t\tif(!sheetStubs) continue;\n\t\t\t\t\t\tp.t = 'z';\n\t\t\t\t\t} else p.v = parseFloat(p.v);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 's':\n\t\t\t\t\tif(typeof p.v == 'undefined') {\n\t\t\t\t\t\tif(!sheetStubs) continue;\n\t\t\t\t\t\tp.t = 'z';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsstr = strs[parseInt(p.v, 10)];\n\t\t\t\t\t\tp.v = sstr.t;\n\t\t\t\t\t\tp.r = sstr.r;\n\t\t\t\t\t\tif(opts.cellHTML) p.h = sstr.h;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'str':\n\t\t\t\t\tp.t = \"s\";\n\t\t\t\t\tp.v = (p.v!=null) ? utf8read(p.v) : '';\n\t\t\t\t\tif(opts.cellHTML) p.h = escapehtml(p.v);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'inlineStr':\n\t\t\t\t\tcref = d.match(isregex);\n\t\t\t\t\tp.t = 's';\n\t\t\t\t\tif(cref != null && (sstr = parse_si(cref[1]))) {\n\t\t\t\t\t\tp.v = sstr.t;\n\t\t\t\t\t\tif(opts.cellHTML) p.h = sstr.h;\n\t\t\t\t\t} else p.v = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'b': p.v = parsexmlbool(p.v); break;\n\t\t\t\tcase 'd':\n\t\t\t\t\tif(opts.cellDates) p.v = parseDate(p.v, 1);\n\t\t\t\t\telse { p.v = datenum(parseDate(p.v, 1)); p.t = 'n'; }\n\t\t\t\t\tbreak;\n\t\t\t\t/* error string in .w, number in .v */\n\t\t\t\tcase 'e':\n\t\t\t\t\tif(!opts || opts.cellText !== false) p.w = p.v;\n\t\t\t\t\tp.v = RBErr[p.v]; break;\n\t\t\t}\n\t\t\t/* formatting */\n\t\t\tfmtid = fillid = 0;\n\t\t\tcf = null;\n\t\t\tif(do_format && tag.s !== undefined) {\n\t\t\t\tcf = styles.CellXf[tag.s];\n\t\t\t\tif(cf != null) {\n\t\t\t\t\tif(cf.numFmtId != null) fmtid = cf.numFmtId;\n\t\t\t\t\tif(opts.cellStyles) {\n\t\t\t\t\t\tif(cf.fillId != null) fillid = cf.fillId;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tsafe_format(p, fmtid, fillid, opts, themes, styles);\n\t\t\tif(opts.cellDates && do_format && p.t == 'n' && fmt_is_date(table_fmt[fmtid])) { p.t = 'd'; p.v = numdate(p.v); }\n\t\t\tif(tag.cm && opts.xlmeta) {\n\t\t\t\tvar cm = (opts.xlmeta.Cell||[])[+tag.cm-1];\n\t\t\t\tif(cm && cm.type == 'XLDAPR') p.D = true;\n\t\t\t}\n\t\t\tif(dense) {\n\t\t\t\tvar _r = decode_cell(tag.r);\n\t\t\t\tif(!s[_r.r]) s[_r.r] = [];\n\t\t\t\ts[_r.r][_r.c] = p;\n\t\t\t} else s[tag.r] = p;\n\t\t}\n\t}\n\tif(rows.length > 0) s['!rows'] = rows;\n}; })();\n\nfunction write_ws_xml_data(ws, opts, idx, wb) {\n\tvar o = [], r = [], range = safe_decode_range(ws['!ref']), cell=\"\", ref, rr = \"\", cols = [], R=0, C=0, rows = ws['!rows'];\n\tvar dense = Array.isArray(ws);\n\tvar params = ({r:rr}), row, height = -1;\n\tfor(C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);\n\tfor(R = range.s.r; R <= range.e.r; ++R) {\n\t\tr = [];\n\t\trr = encode_row(R);\n\t\tfor(C = range.s.c; C <= range.e.c; ++C) {\n\t\t\tref = cols[C] + rr;\n\t\t\tvar _cell = dense ? (ws[R]||[])[C]: ws[ref];\n\t\t\tif(_cell === undefined) continue;\n\t\t\tif((cell = write_ws_xml_cell(_cell, ref, ws, opts, idx, wb)) != null) r.push(cell);\n\t\t}\n\t\tif(r.length > 0 || (rows && rows[R])) {\n\t\t\tparams = ({r:rr});\n\t\t\tif(rows && rows[R]) {\n\t\t\t\trow = rows[R];\n\t\t\t\tif(row.hidden) params.hidden = 1;\n\t\t\t\theight = -1;\n\t\t\t\tif(row.hpx) height = px2pt(row.hpx);\n\t\t\t\telse if(row.hpt) height = row.hpt;\n\t\t\t\tif(height > -1) { params.ht = height; params.customHeight = 1; }\n\t\t\t\tif(row.level) { params.outlineLevel = row.level; }\n\t\t\t}\n\t\t\to[o.length] = (writextag('row', r.join(\"\"), params));\n\t\t}\n\t}\n\tif(rows) for(; R < rows.length; ++R) {\n\t\tif(rows && rows[R]) {\n\t\t\tparams = ({r:R+1});\n\t\t\trow = rows[R];\n\t\t\tif(row.hidden) params.hidden = 1;\n\t\t\theight = -1;\n\t\t\tif (row.hpx) height = px2pt(row.hpx);\n\t\t\telse if (row.hpt) height = row.hpt;\n\t\t\tif (height > -1) { params.ht = height; params.customHeight = 1; }\n\t\t\tif (row.level) { params.outlineLevel = row.level; }\n\t\t\to[o.length] = (writextag('row', \"\", params));\n\t\t}\n\t}\n\treturn o.join(\"\");\n}\n\nfunction write_ws_xml(idx, opts, wb, rels) {\n\tvar o = [XML_HEADER, writextag('worksheet', null, {\n\t\t'xmlns': XMLNS_main[0],\n\t\t'xmlns:r': XMLNS.r\n\t})];\n\tvar s = wb.SheetNames[idx], sidx = 0, rdata = \"\";\n\tvar ws = wb.Sheets[s];\n\tif(ws == null) ws = {};\n\tvar ref = ws['!ref'] || 'A1';\n\tvar range = safe_decode_range(ref);\n\tif(range.e.c > 0x3FFF || range.e.r > 0xFFFFF) {\n\t\tif(opts.WTF) throw new Error(\"Range \" + ref + \" exceeds format limit A1:XFD1048576\");\n\t\trange.e.c = Math.min(range.e.c, 0x3FFF);\n\t\trange.e.r = Math.min(range.e.c, 0xFFFFF);\n\t\tref = encode_range(range);\n\t}\n\tif(!rels) rels = {};\n\tws['!comments'] = [];\n\tvar _drawing = [];\n\n\twrite_ws_xml_sheetpr(ws, wb, idx, opts, o);\n\n\to[o.length] = (writextag('dimension', null, {'ref': ref}));\n\n\to[o.length] = write_ws_xml_sheetviews(ws, opts, idx, wb);\n\n\t/* TODO: store in WB, process styles */\n\tif(opts.sheetFormat) o[o.length] = (writextag('sheetFormatPr', null, {\n\t\tdefaultRowHeight:opts.sheetFormat.defaultRowHeight||'16',\n\t\tbaseColWidth:opts.sheetFormat.baseColWidth||'10',\n\t\toutlineLevelRow:opts.sheetFormat.outlineLevelRow||'7'\n\t}));\n\n\tif(ws['!cols'] != null && ws['!cols'].length > 0) o[o.length] = (write_ws_xml_cols(ws, ws['!cols']));\n\n\to[sidx = o.length] = '<sheetData/>';\n\tws['!links'] = [];\n\tif(ws['!ref'] != null) {\n\t\trdata = write_ws_xml_data(ws, opts, idx, wb, rels);\n\t\tif(rdata.length > 0) o[o.length] = (rdata);\n\t}\n\tif(o.length>sidx+1) { o[o.length] = ('</sheetData>'); o[sidx]=o[sidx].replace(\"/>\",\">\"); }\n\n\t/* sheetCalcPr */\n\n\tif(ws['!protect']) o[o.length] = write_ws_xml_protection(ws['!protect']);\n\n\t/* protectedRanges */\n\t/* scenarios */\n\n\tif(ws['!autofilter'] != null) o[o.length] = write_ws_xml_autofilter(ws['!autofilter'], ws, wb, idx);\n\n\t/* sortState */\n\t/* dataConsolidate */\n\t/* customSheetViews */\n\n\tif(ws['!merges'] != null && ws['!merges'].length > 0) o[o.length] = (write_ws_xml_merges(ws['!merges']));\n\n\t/* phoneticPr */\n\t/* conditionalFormatting */\n\t/* dataValidations */\n\n\tvar relc = -1, rel, rId = -1;\n\tif(ws['!links'].length > 0) {\n\t\to[o.length] = \"<hyperlinks>\";\nws['!links'].forEach(function(l) {\n\t\t\tif(!l[1].Target) return;\n\t\t\trel = ({\"ref\":l[0]});\n\t\t\tif(l[1].Target.charAt(0) != \"#\") {\n\t\t\t\trId = add_rels(rels, -1, escapexml(l[1].Target).replace(/#.*$/, \"\"), RELS.HLINK);\n\t\t\t\trel[\"r:id\"] = \"rId\"+rId;\n\t\t\t}\n\t\t\tif((relc = l[1].Target.indexOf(\"#\")) > -1) rel.location = escapexml(l[1].Target.slice(relc+1));\n\t\t\tif(l[1].Tooltip) rel.tooltip = escapexml(l[1].Tooltip);\n\t\t\to[o.length] = writextag(\"hyperlink\",null,rel);\n\t\t});\n\t\to[o.length] = \"</hyperlinks>\";\n\t}\n\tdelete ws['!links'];\n\n\t/* printOptions */\n\n\tif(ws['!margins'] != null) o[o.length] =  write_ws_xml_margins(ws['!margins']);\n\n\t/* pageSetup */\n\t/* headerFooter */\n\t/* rowBreaks */\n\t/* colBreaks */\n\t/* customProperties */\n\t/* cellWatches */\n\n\tif(!opts || opts.ignoreEC || (opts.ignoreEC == (void 0))) o[o.length] = writetag(\"ignoredErrors\", writextag(\"ignoredError\", null, {numberStoredAsText:1, sqref:ref}));\n\n\t/* smartTags */\n\n\tif(_drawing.length > 0) {\n\t\trId = add_rels(rels, -1, \"../drawings/drawing\" + (idx+1) + \".xml\", RELS.DRAW);\n\t\to[o.length] = writextag(\"drawing\", null, {\"r:id\":\"rId\" + rId});\n\t\tws['!drawing'] = _drawing;\n\t}\n\n\tif(ws['!comments'].length > 0) {\n\t\trId = add_rels(rels, -1, \"../drawings/vmlDrawing\" + (idx+1) + \".vml\", RELS.VML);\n\t\to[o.length] = writextag(\"legacyDrawing\", null, {\"r:id\":\"rId\" + rId});\n\t\tws['!legacy'] = rId;\n\t}\n\n\t/* legacyDrawingHF */\n\t/* picture */\n\t/* oleObjects */\n\t/* controls */\n\t/* webPublishItems */\n\t/* tableParts */\n\t/* extLst */\n\n\tif(o.length>1) { o[o.length] = ('</worksheet>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n\n/* [MS-XLSB] 2.4.726 BrtRowHdr */\nfunction parse_BrtRowHdr(data, length) {\n\tvar z = ({});\n\tvar tgt = data.l + length;\n\tz.r = data.read_shift(4);\n\tdata.l += 4; // TODO: ixfe\n\tvar miyRw = data.read_shift(2);\n\tdata.l += 1; // TODO: top/bot padding\n\tvar flags = data.read_shift(1);\n\tdata.l = tgt;\n\tif(flags & 0x07) z.level = flags & 0x07;\n\tif(flags & 0x10) z.hidden = true;\n\tif(flags & 0x20) z.hpt = miyRw / 20;\n\treturn z;\n}\nfunction write_BrtRowHdr(R, range, ws) {\n\tvar o = new_buf(17+8*16);\n\tvar row = (ws['!rows']||[])[R]||{};\n\to.write_shift(4, R);\n\n\to.write_shift(4, 0); /* TODO: ixfe */\n\n\tvar miyRw = 0x0140;\n\tif(row.hpx) miyRw = px2pt(row.hpx) * 20;\n\telse if(row.hpt) miyRw = row.hpt * 20;\n\to.write_shift(2, miyRw);\n\n\to.write_shift(1, 0); /* top/bot padding */\n\n\tvar flags = 0x0;\n\tif(row.level) flags |= row.level;\n\tif(row.hidden) flags |= 0x10;\n\tif(row.hpx || row.hpt) flags |= 0x20;\n\to.write_shift(1, flags);\n\n\to.write_shift(1, 0); /* phonetic guide */\n\n\t/* [MS-XLSB] 2.5.8 BrtColSpan explains the mechanism */\n\tvar ncolspan = 0, lcs = o.l;\n\to.l += 4;\n\n\tvar caddr = {r:R, c:0};\n\tfor(var i = 0; i < 16; ++i) {\n\t\tif((range.s.c > ((i+1) << 10)) || (range.e.c < (i << 10))) continue;\n\t\tvar first = -1, last = -1;\n\t\tfor(var j = (i<<10); j < ((i+1)<<10); ++j) {\n\t\t\tcaddr.c = j;\n\t\t\tvar cell = Array.isArray(ws) ? (ws[caddr.r]||[])[caddr.c] : ws[encode_cell(caddr)];\n\t\t\tif(cell) { if(first < 0) first = j; last = j; }\n\t\t}\n\t\tif(first < 0) continue;\n\t\t++ncolspan;\n\t\to.write_shift(4, first);\n\t\to.write_shift(4, last);\n\t}\n\n\tvar l = o.l;\n\to.l = lcs;\n\to.write_shift(4, ncolspan);\n\to.l = l;\n\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\nfunction write_row_header(ba, ws, range, R) {\n\tvar o = write_BrtRowHdr(R, range, ws);\n\tif((o.length > 17) || (ws['!rows']||[])[R]) write_record(ba, 0x0000 /* BrtRowHdr */, o);\n}\n\n/* [MS-XLSB] 2.4.820 BrtWsDim */\nvar parse_BrtWsDim = parse_UncheckedRfX;\nvar write_BrtWsDim = write_UncheckedRfX;\n\n/* [MS-XLSB] 2.4.821 BrtWsFmtInfo */\nfunction parse_BrtWsFmtInfo() {\n}\n//function write_BrtWsFmtInfo(ws, o) { }\n\n/* [MS-XLSB] 2.4.823 BrtWsProp */\nfunction parse_BrtWsProp(data, length) {\n\tvar z = {};\n\tvar f = data[data.l]; ++data.l;\n\tz.above = !(f & 0x40);\n\tz.left  = !(f & 0x80);\n\t/* TODO: pull flags */\n\tdata.l += 18;\n\tz.name = parse_XLSBCodeName(data, length - 19);\n\treturn z;\n}\nfunction write_BrtWsProp(str, outl, o) {\n\tif(o == null) o = new_buf(84+4*str.length);\n\tvar f = 0xC0;\n\tif(outl) {\n\t\tif(outl.above) f &= ~0x40;\n\t\tif(outl.left)  f &= ~0x80;\n\t}\n\to.write_shift(1, f);\n\tfor(var i = 1; i < 3; ++i) o.write_shift(1,0);\n\twrite_BrtColor({auto:1}, o);\n\to.write_shift(-4,-1);\n\to.write_shift(-4,-1);\n\twrite_XLSBCodeName(str, o);\n\treturn o.slice(0, o.l);\n}\n\n/* [MS-XLSB] 2.4.306 BrtCellBlank */\nfunction parse_BrtCellBlank(data) {\n\tvar cell = parse_XLSBCell(data);\n\treturn [cell];\n}\nfunction write_BrtCellBlank(cell, ncell, o) {\n\tif(o == null) o = new_buf(8);\n\treturn write_XLSBCell(ncell, o);\n}\nfunction parse_BrtShortBlank(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\treturn [cell];\n}\nfunction write_BrtShortBlank(cell, ncell, o) {\n\tif(o == null) o = new_buf(4);\n\treturn write_XLSBShortCell(ncell, o);\n}\n\n/* [MS-XLSB] 2.4.307 BrtCellBool */\nfunction parse_BrtCellBool(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar fBool = data.read_shift(1);\n\treturn [cell, fBool, 'b'];\n}\nfunction write_BrtCellBool(cell, ncell, o) {\n\tif(o == null) o = new_buf(9);\n\twrite_XLSBCell(ncell, o);\n\to.write_shift(1, cell.v ? 1 : 0);\n\treturn o;\n}\nfunction parse_BrtShortBool(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar fBool = data.read_shift(1);\n\treturn [cell, fBool, 'b'];\n}\nfunction write_BrtShortBool(cell, ncell, o) {\n\tif(o == null) o = new_buf(5);\n\twrite_XLSBShortCell(ncell, o);\n\to.write_shift(1, cell.v ? 1 : 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.308 BrtCellError */\nfunction parse_BrtCellError(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar bError = data.read_shift(1);\n\treturn [cell, bError, 'e'];\n}\nfunction write_BrtCellError(cell, ncell, o) {\n\tif(o == null) o = new_buf(9);\n\twrite_XLSBCell(ncell, o);\n\to.write_shift(1, cell.v);\n\treturn o;\n}\nfunction parse_BrtShortError(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar bError = data.read_shift(1);\n\treturn [cell, bError, 'e'];\n}\nfunction write_BrtShortError(cell, ncell, o) {\n\tif(o == null) o = new_buf(8);\n\twrite_XLSBShortCell(ncell, o);\n\to.write_shift(1, cell.v);\n\to.write_shift(2, 0);\n\to.write_shift(1, 0);\n\treturn o;\n}\n\n\n/* [MS-XLSB] 2.4.311 BrtCellIsst */\nfunction parse_BrtCellIsst(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar isst = data.read_shift(4);\n\treturn [cell, isst, 's'];\n}\nfunction write_BrtCellIsst(cell, ncell, o) {\n\tif(o == null) o = new_buf(12);\n\twrite_XLSBCell(ncell, o);\n\to.write_shift(4, ncell.v);\n\treturn o;\n}\nfunction parse_BrtShortIsst(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar isst = data.read_shift(4);\n\treturn [cell, isst, 's'];\n}\nfunction write_BrtShortIsst(cell, ncell, o) {\n\tif(o == null) o = new_buf(8);\n\twrite_XLSBShortCell(ncell, o);\n\to.write_shift(4, ncell.v);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.313 BrtCellReal */\nfunction parse_BrtCellReal(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_Xnum(data);\n\treturn [cell, value, 'n'];\n}\nfunction write_BrtCellReal(cell, ncell, o) {\n\tif(o == null) o = new_buf(16);\n\twrite_XLSBCell(ncell, o);\n\twrite_Xnum(cell.v, o);\n\treturn o;\n}\nfunction parse_BrtShortReal(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar value = parse_Xnum(data);\n\treturn [cell, value, 'n'];\n}\nfunction write_BrtShortReal(cell, ncell, o) {\n\tif(o == null) o = new_buf(12);\n\twrite_XLSBShortCell(ncell, o);\n\twrite_Xnum(cell.v, o);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.314 BrtCellRk */\nfunction parse_BrtCellRk(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_RkNumber(data);\n\treturn [cell, value, 'n'];\n}\nfunction write_BrtCellRk(cell, ncell, o) {\n\tif(o == null) o = new_buf(12);\n\twrite_XLSBCell(ncell, o);\n\twrite_RkNumber(cell.v, o);\n\treturn o;\n}\nfunction parse_BrtShortRk(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar value = parse_RkNumber(data);\n\treturn [cell, value, 'n'];\n}\nfunction write_BrtShortRk(cell, ncell, o) {\n\tif(o == null) o = new_buf(8);\n\twrite_XLSBShortCell(ncell, o);\n\twrite_RkNumber(cell.v, o);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.323 BrtCellRString */\nfunction parse_BrtCellRString(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_RichStr(data);\n\treturn [cell, value, 'is'];\n}\n\n/* [MS-XLSB] 2.4.317 BrtCellSt */\nfunction parse_BrtCellSt(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_XLWideString(data);\n\treturn [cell, value, 'str'];\n}\nfunction write_BrtCellSt(cell, ncell, o) {\n\tif(o == null) o = new_buf(12 + 4 * cell.v.length);\n\twrite_XLSBCell(ncell, o);\n\twrite_XLWideString(cell.v, o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\nfunction parse_BrtShortSt(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar value = parse_XLWideString(data);\n\treturn [cell, value, 'str'];\n}\nfunction write_BrtShortSt(cell, ncell, o) {\n\tif(o == null) o = new_buf(8 + 4 * cell.v.length);\n\twrite_XLSBShortCell(ncell, o);\n\twrite_XLWideString(cell.v, o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.653 BrtFmlaBool */\nfunction parse_BrtFmlaBool(data, length, opts) {\n\tvar end = data.l + length;\n\tvar cell = parse_XLSBCell(data);\n\tcell.r = opts['!row'];\n\tvar value = data.read_shift(1);\n\tvar o = [cell, value, 'b'];\n\tif(opts.cellFormula) {\n\t\tdata.l += 2;\n\t\tvar formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n\t\to[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\n\t}\n\telse data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.654 BrtFmlaError */\nfunction parse_BrtFmlaError(data, length, opts) {\n\tvar end = data.l + length;\n\tvar cell = parse_XLSBCell(data);\n\tcell.r = opts['!row'];\n\tvar value = data.read_shift(1);\n\tvar o = [cell, value, 'e'];\n\tif(opts.cellFormula) {\n\t\tdata.l += 2;\n\t\tvar formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n\t\to[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\n\t}\n\telse data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.655 BrtFmlaNum */\nfunction parse_BrtFmlaNum(data, length, opts) {\n\tvar end = data.l + length;\n\tvar cell = parse_XLSBCell(data);\n\tcell.r = opts['!row'];\n\tvar value = parse_Xnum(data);\n\tvar o = [cell, value, 'n'];\n\tif(opts.cellFormula) {\n\t\tdata.l += 2;\n\t\tvar formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n\t\to[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\n\t}\n\telse data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.656 BrtFmlaString */\nfunction parse_BrtFmlaString(data, length, opts) {\n\tvar end = data.l + length;\n\tvar cell = parse_XLSBCell(data);\n\tcell.r = opts['!row'];\n\tvar value = parse_XLWideString(data);\n\tvar o = [cell, value, 'str'];\n\tif(opts.cellFormula) {\n\t\tdata.l += 2;\n\t\tvar formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n\t\to[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\n\t}\n\telse data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.682 BrtMergeCell */\nvar parse_BrtMergeCell = parse_UncheckedRfX;\nvar write_BrtMergeCell = write_UncheckedRfX;\n/* [MS-XLSB] 2.4.107 BrtBeginMergeCells */\nfunction write_BrtBeginMergeCells(cnt, o) {\n\tif(o == null) o = new_buf(4);\n\to.write_shift(4, cnt);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.662 BrtHLink */\nfunction parse_BrtHLink(data, length) {\n\tvar end = data.l + length;\n\tvar rfx = parse_UncheckedRfX(data, 16);\n\tvar relId = parse_XLNullableWideString(data);\n\tvar loc = parse_XLWideString(data);\n\tvar tooltip = parse_XLWideString(data);\n\tvar display = parse_XLWideString(data);\n\tdata.l = end;\n\tvar o = ({rfx:rfx, relId:relId, loc:loc, display:display});\n\tif(tooltip) o.Tooltip = tooltip;\n\treturn o;\n}\nfunction write_BrtHLink(l, rId) {\n\tvar o = new_buf(50+4*(l[1].Target.length + (l[1].Tooltip || \"\").length));\n\twrite_UncheckedRfX({s:decode_cell(l[0]), e:decode_cell(l[0])}, o);\n\twrite_RelID(\"rId\" + rId, o);\n\tvar locidx = l[1].Target.indexOf(\"#\");\n\tvar loc = locidx == -1 ? \"\" : l[1].Target.slice(locidx+1);\n\twrite_XLWideString(loc || \"\", o);\n\twrite_XLWideString(l[1].Tooltip || \"\", o);\n\twrite_XLWideString(\"\", o);\n\treturn o.slice(0, o.l);\n}\n\n/* [MS-XLSB] 2.4.692 BrtPane */\nfunction parse_BrtPane(/*data, length, opts*/) {\n}\n\n/* [MS-XLSB] 2.4.6 BrtArrFmla */\nfunction parse_BrtArrFmla(data, length, opts) {\n\tvar end = data.l + length;\n\tvar rfx = parse_RfX(data, 16);\n\tvar fAlwaysCalc = data.read_shift(1);\n\tvar o = [rfx]; o[2] = fAlwaysCalc;\n\tif(opts.cellFormula) {\n\t\tvar formula = parse_XLSBArrayParsedFormula(data, end - data.l, opts);\n\t\to[1] = formula;\n\t} else data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.750 BrtShrFmla */\nfunction parse_BrtShrFmla(data, length, opts) {\n\tvar end = data.l + length;\n\tvar rfx = parse_UncheckedRfX(data, 16);\n\tvar o = [rfx];\n\tif(opts.cellFormula) {\n\t\tvar formula = parse_XLSBSharedParsedFormula(data, end - data.l, opts);\n\t\to[1] = formula;\n\t\tdata.l = end;\n\t} else data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.323 BrtColInfo */\n/* TODO: once XLS ColInfo is set, combine the functions */\nfunction write_BrtColInfo(C, col, o) {\n\tif(o == null) o = new_buf(18);\n\tvar p = col_obj_w(C, col);\n\to.write_shift(-4, C);\n\to.write_shift(-4, C);\n\to.write_shift(4, (p.width || 10) * 256);\n\to.write_shift(4, 0/*ixfe*/); // style\n\tvar flags = 0;\n\tif(col.hidden) flags |= 0x01;\n\tif(typeof p.width == 'number') flags |= 0x02;\n\tif(col.level) flags |= (col.level << 8);\n\to.write_shift(2, flags); // bit flag\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.678 BrtMargins */\nvar BrtMarginKeys = [\"left\",\"right\",\"top\",\"bottom\",\"header\",\"footer\"];\nfunction parse_BrtMargins(data) {\n\tvar margins = ({});\n\tBrtMarginKeys.forEach(function(k) { margins[k] = parse_Xnum(data, 8); });\n\treturn margins;\n}\nfunction write_BrtMargins(margins, o) {\n\tif(o == null) o = new_buf(6*8);\n\tdefault_margins(margins);\n\tBrtMarginKeys.forEach(function(k) { write_Xnum((margins)[k], o); });\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.299 BrtBeginWsView */\nfunction parse_BrtBeginWsView(data) {\n\tvar f = data.read_shift(2);\n\tdata.l += 28;\n\treturn { RTL: f & 0x20 };\n}\nfunction write_BrtBeginWsView(ws, Workbook, o) {\n\tif(o == null) o = new_buf(30);\n\tvar f = 0x39c;\n\tif((((Workbook||{}).Views||[])[0]||{}).RTL) f |= 0x20;\n\to.write_shift(2, f); // bit flag\n\to.write_shift(4, 0);\n\to.write_shift(4, 0); // view first row\n\to.write_shift(4, 0); // view first col\n\to.write_shift(1, 0); // gridline color ICV\n\to.write_shift(1, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, 100); // zoom scale\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(4, 0); // workbook view id\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.309 BrtCellIgnoreEC */\nfunction write_BrtCellIgnoreEC(ref) {\n\tvar o = new_buf(24);\n\to.write_shift(4, 4);\n\to.write_shift(4, 1);\n\twrite_UncheckedRfX(ref, o);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.748 BrtSheetProtection */\nfunction write_BrtSheetProtection(sp, o) {\n\tif(o == null) o = new_buf(16*4+2);\n\to.write_shift(2, sp.password ? crypto_CreatePasswordVerifier_Method1(sp.password) : 0);\n\to.write_shift(4, 1); // this record should not be written if no protection\n\t[\n\t\t[\"objects\",             false], // fObjects\n\t\t[\"scenarios\",           false], // fScenarios\n\t\t[\"formatCells\",          true], // fFormatCells\n\t\t[\"formatColumns\",        true], // fFormatColumns\n\t\t[\"formatRows\",           true], // fFormatRows\n\t\t[\"insertColumns\",        true], // fInsertColumns\n\t\t[\"insertRows\",           true], // fInsertRows\n\t\t[\"insertHyperlinks\",     true], // fInsertHyperlinks\n\t\t[\"deleteColumns\",        true], // fDeleteColumns\n\t\t[\"deleteRows\",           true], // fDeleteRows\n\t\t[\"selectLockedCells\",   false], // fSelLockedCells\n\t\t[\"sort\",                 true], // fSort\n\t\t[\"autoFilter\",           true], // fAutoFilter\n\t\t[\"pivotTables\",          true], // fPivotTables\n\t\t[\"selectUnlockedCells\", false]  // fSelUnlockedCells\n\t].forEach(function(n) {\nif(n[1]) o.write_shift(4, sp[n[0]] != null && !sp[n[0]] ? 1 : 0);\n\t\telse      o.write_shift(4, sp[n[0]] != null && sp[n[0]] ? 0 : 1);\n\t});\n\treturn o;\n}\n\nfunction parse_BrtDVal(/*data, length, opts*/) {\n}\nfunction parse_BrtDVal14(/*data, length, opts*/) {\n}\n/* [MS-XLSB] 2.1.7.61 Worksheet */\nfunction parse_ws_bin(data, _opts, idx, rels, wb, themes, styles) {\n\tif(!data) return data;\n\tvar opts = _opts || {};\n\tif(!rels) rels = {'!id':{}};\n\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\tvar s = (opts.dense ? [] : {});\n\n\tvar ref;\n\tvar refguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\n\tvar state = [];\n\tvar pass = false, end = false;\n\tvar row, p, cf, R, C, addr, sstr, rr, cell;\n\tvar merges = [];\n\topts.biff = 12;\n\topts['!row'] = 0;\n\n\tvar ai = 0, af = false;\n\n\tvar arrayf = [];\n\tvar sharedf = {};\n\tvar supbooks = opts.supbooks || wb.supbooks || ([[]]);\n\tsupbooks.sharedf = sharedf;\n\tsupbooks.arrayf = arrayf;\n\tsupbooks.SheetNames = wb.SheetNames || wb.Sheets.map(function(x) { return x.name; });\n\tif(!opts.supbooks) {\n\t\topts.supbooks = supbooks;\n\t\tif(wb.Names) for(var i = 0; i < wb.Names.length; ++i) supbooks[0][i+1] = wb.Names[i];\n\t}\n\n\tvar colinfo = [], rowinfo = [];\n\tvar seencol = false;\n\n\tXLSBRecordEnum[0x0010] = { n:\"BrtShortReal\", f:parse_BrtShortReal };\n\n\tvar cm, vm;\n\n\trecordhopper(data, function ws_parse(val, RR, RT) {\n\t\tif(end) return;\n\t\tswitch(RT) {\n\t\t\tcase 0x0094: /* 'BrtWsDim' */\n\t\t\t\tref = val; break;\n\t\t\tcase 0x0000: /* 'BrtRowHdr' */\n\t\t\t\trow = val;\n\t\t\t\tif(opts.sheetRows && opts.sheetRows <= row.r) end=true;\n\t\t\t\trr = encode_row(R = row.r);\n\t\t\t\topts['!row'] = row.r;\n\t\t\t\tif(val.hidden || val.hpt || val.level != null) {\n\t\t\t\t\tif(val.hpt) val.hpx = pt2px(val.hpt);\n\t\t\t\t\trowinfo[val.r] = val;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0002: /* 'BrtCellRk' */\n\t\t\tcase 0x0003: /* 'BrtCellError' */\n\t\t\tcase 0x0004: /* 'BrtCellBool' */\n\t\t\tcase 0x0005: /* 'BrtCellReal' */\n\t\t\tcase 0x0006: /* 'BrtCellSt' */\n\t\t\tcase 0x0007: /* 'BrtCellIsst' */\n\t\t\tcase 0x0008: /* 'BrtFmlaString' */\n\t\t\tcase 0x0009: /* 'BrtFmlaNum' */\n\t\t\tcase 0x000A: /* 'BrtFmlaBool' */\n\t\t\tcase 0x000B: /* 'BrtFmlaError' */\n\t\t\tcase 0x000D: /* 'BrtShortRk' */\n\t\t\tcase 0x000E: /* 'BrtShortError' */\n\t\t\tcase 0x000F: /* 'BrtShortBool' */\n\t\t\tcase 0x0010: /* 'BrtShortReal' */\n\t\t\tcase 0x0011: /* 'BrtShortSt' */\n\t\t\tcase 0x0012: /* 'BrtShortIsst' */\n\t\t\tcase 0x003E: /* 'BrtCellRString' */\n\t\t\t\tp = ({t:val[2]});\n\t\t\t\tswitch(val[2]) {\n\t\t\t\t\tcase 'n': p.v = val[1]; break;\n\t\t\t\t\tcase 's': sstr = strs[val[1]]; p.v = sstr.t; p.r = sstr.r; break;\n\t\t\t\t\tcase 'b': p.v = val[1] ? true : false; break;\n\t\t\t\t\tcase 'e': p.v = val[1]; if(opts.cellText !== false) p.w = BErr[p.v]; break;\n\t\t\t\t\tcase 'str': p.t = 's'; p.v = val[1]; break;\n\t\t\t\t\tcase 'is': p.t = 's'; p.v = val[1].t; break;\n\t\t\t\t}\n\t\t\t\tif((cf = styles.CellXf[val[0].iStyleRef])) safe_format(p,cf.numFmtId,null,opts, themes, styles);\n\t\t\t\tC = val[0].c == -1 ? C + 1 : val[0].c;\n\t\t\t\tif(opts.dense) { if(!s[R]) s[R] = []; s[R][C] = p; }\n\t\t\t\telse s[encode_col(C) + rr] = p;\n\t\t\t\tif(opts.cellFormula) {\n\t\t\t\t\taf = false;\n\t\t\t\t\tfor(ai = 0; ai < arrayf.length; ++ai) {\n\t\t\t\t\t\tvar aii = arrayf[ai];\n\t\t\t\t\t\tif(row.r >= aii[0].s.r && row.r <= aii[0].e.r)\n\t\t\t\t\t\t\tif(C >= aii[0].s.c && C <= aii[0].e.c) {\n\t\t\t\t\t\t\t\tp.F = encode_range(aii[0]); af = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(!af && val.length > 3) p.f = val[3];\n\t\t\t\t}\n\n\t\t\t\tif(refguess.s.r > row.r) refguess.s.r = row.r;\n\t\t\t\tif(refguess.s.c > C) refguess.s.c = C;\n\t\t\t\tif(refguess.e.r < row.r) refguess.e.r = row.r;\n\t\t\t\tif(refguess.e.c < C) refguess.e.c = C;\n\t\t\t\tif(opts.cellDates && cf && p.t == 'n' && fmt_is_date(table_fmt[cf.numFmtId])) {\n\t\t\t\t\tvar _d = SSF_parse_date_code(p.v); if(_d) { p.t = 'd'; p.v = new Date(_d.y, _d.m-1,_d.d,_d.H,_d.M,_d.S,_d.u); }\n\t\t\t\t}\n\t\t\t\tif(cm) {\n\t\t\t\t\tif(cm.type == 'XLDAPR') p.D = true;\n\t\t\t\t\tcm = void 0;\n\t\t\t\t}\n\t\t\t\tif(vm) vm = void 0;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0001: /* 'BrtCellBlank' */\n\t\t\tcase 0x000C: /* 'BrtShortBlank' */\n\t\t\t\tif(!opts.sheetStubs || pass) break;\n\t\t\t\tp = ({t:'z',v:void 0});\n\t\t\t\tC = val[0].c == -1 ? C + 1 : val[0].c;\n\t\t\t\tif(opts.dense) { if(!s[R]) s[R] = []; s[R][C] = p; }\n\t\t\t\telse s[encode_col(C) + rr] = p;\n\t\t\t\tif(refguess.s.r > row.r) refguess.s.r = row.r;\n\t\t\t\tif(refguess.s.c > C) refguess.s.c = C;\n\t\t\t\tif(refguess.e.r < row.r) refguess.e.r = row.r;\n\t\t\t\tif(refguess.e.c < C) refguess.e.c = C;\n\t\t\t\tif(cm) {\n\t\t\t\t\tif(cm.type == 'XLDAPR') p.D = true;\n\t\t\t\t\tcm = void 0;\n\t\t\t\t}\n\t\t\t\tif(vm) vm = void 0;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x00B0: /* 'BrtMergeCell' */\n\t\t\t\tmerges.push(val); break;\n\n\t\t\tcase 0x0031: { /* 'BrtCellMeta' */\n\t\t\t\tcm = ((opts.xlmeta||{}).Cell||[])[val-1];\n\t\t\t} break;\n\n\t\t\tcase 0x01EE: /* 'BrtHLink' */\n\t\t\t\tvar rel = rels['!id'][val.relId];\n\t\t\t\tif(rel) {\n\t\t\t\t\tval.Target = rel.Target;\n\t\t\t\t\tif(val.loc) val.Target += \"#\"+val.loc;\n\t\t\t\t\tval.Rel = rel;\n\t\t\t\t} else if(val.relId == '') {\n\t\t\t\t\tval.Target = \"#\" + val.loc;\n\t\t\t\t}\n\t\t\t\tfor(R=val.rfx.s.r;R<=val.rfx.e.r;++R) for(C=val.rfx.s.c;C<=val.rfx.e.c;++C) {\n\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\tif(!s[R]) s[R] = [];\n\t\t\t\t\t\tif(!s[R][C]) s[R][C] = {t:'z',v:undefined};\n\t\t\t\t\t\ts[R][C].l = val;\n\t\t\t\t\t} else {\n\t\t\t\t\t\taddr = encode_cell({c:C,r:R});\n\t\t\t\t\t\tif(!s[addr]) s[addr] = {t:'z',v:undefined};\n\t\t\t\t\t\ts[addr].l = val;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 0x01AA: /* 'BrtArrFmla' */\n\t\t\t\tif(!opts.cellFormula) break;\n\t\t\t\tarrayf.push(val);\n\t\t\t\tcell = ((opts.dense ? s[R][C] : s[encode_col(C) + rr]));\n\t\t\t\tcell.f = stringify_formula(val[1], refguess, {r:row.r, c:C}, supbooks, opts);\n\t\t\t\tcell.F = encode_range(val[0]);\n\t\t\t\tbreak;\n\t\t\tcase 0x01AB: /* 'BrtShrFmla' */\n\t\t\t\tif(!opts.cellFormula) break;\n\t\t\t\tsharedf[encode_cell(val[0].s)] = val[1];\n\t\t\t\tcell = (opts.dense ? s[R][C] : s[encode_col(C) + rr]);\n\t\t\t\tcell.f = stringify_formula(val[1], refguess, {r:row.r, c:C}, supbooks, opts);\n\t\t\t\tbreak;\n\n\t\t\t/* identical to 'ColInfo' in XLS */\n\t\t\tcase 0x003C: /* 'BrtColInfo' */\n\t\t\t\tif(!opts.cellStyles) break;\n\t\t\t\twhile(val.e >= val.s) {\n\t\t\t\t\tcolinfo[val.e--] = { width: val.w/256, hidden: !!(val.flags & 0x01), level: val.level };\n\t\t\t\t\tif(!seencol) { seencol = true; find_mdw_colw(val.w/256); }\n\t\t\t\t\tprocess_col(colinfo[val.e+1]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 0x00A1: /* 'BrtBeginAFilter' */\n\t\t\t\ts['!autofilter'] = { ref:encode_range(val) };\n\t\t\t\tbreak;\n\n\t\t\tcase 0x01DC: /* 'BrtMargins' */\n\t\t\t\ts['!margins'] = val;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0093: /* 'BrtWsProp' */\n\t\t\t\tif(!wb.Sheets[idx]) wb.Sheets[idx] = {};\n\t\t\t\tif(val.name) wb.Sheets[idx].CodeName = val.name;\n\t\t\t\tif(val.above || val.left) s['!outline'] = { above: val.above, left: val.left };\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0089: /* 'BrtBeginWsView' */\n\t\t\t\tif(!wb.Views) wb.Views = [{}];\n\t\t\t\tif(!wb.Views[0]) wb.Views[0] = {};\n\t\t\t\tif(val.RTL) wb.Views[0].RTL = true;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x01E5: /* 'BrtWsFmtInfo' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0040: /* 'BrtDVal' */\n\t\t\tcase 0x041D: /* 'BrtDVal14' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0097: /* 'BrtPane' */\n\t\t\t\tbreak;\n\t\t\tcase 0x0098: /* 'BrtSel' */\n\t\t\tcase 0x00AF: /* 'BrtAFilterDateGroupItem' */\n\t\t\tcase 0x0284: /* 'BrtActiveX' */\n\t\t\tcase 0x0271: /* 'BrtBigName' */\n\t\t\tcase 0x0232: /* 'BrtBkHim' */\n\t\t\tcase 0x018C: /* 'BrtBrk' */\n\t\t\tcase 0x0458: /* 'BrtCFIcon' */\n\t\t\tcase 0x047A: /* 'BrtCFRuleExt' */\n\t\t\tcase 0x01D7: /* 'BrtCFVO' */\n\t\t\tcase 0x041A: /* 'BrtCFVO14' */\n\t\t\tcase 0x0289: /* 'BrtCellIgnoreEC' */\n\t\t\tcase 0x0451: /* 'BrtCellIgnoreEC14' */\n\t\t\tcase 0x024D: /* 'BrtCellSmartTagProperty' */\n\t\t\tcase 0x025F: /* 'BrtCellWatch' */\n\t\t\tcase 0x0234: /* 'BrtColor' */\n\t\t\tcase 0x041F: /* 'BrtColor14' */\n\t\t\tcase 0x00A8: /* 'BrtColorFilter' */\n\t\t\tcase 0x00AE: /* 'BrtCustomFilter' */\n\t\t\tcase 0x049C: /* 'BrtCustomFilter14' */\n\t\t\tcase 0x01F3: /* 'BrtDRef' */\n\t\t\tcase 0x01FB: /* 'BrtDXF' */\n\t\t\tcase 0x0226: /* 'BrtDrawing' */\n\t\t\tcase 0x00AB: /* 'BrtDynamicFilter' */\n\t\t\tcase 0x00A7: /* 'BrtFilter' */\n\t\t\tcase 0x0499: /* 'BrtFilter14' */\n\t\t\tcase 0x00A9: /* 'BrtIconFilter' */\n\t\t\tcase 0x049D: /* 'BrtIconFilter14' */\n\t\t\tcase 0x0227: /* 'BrtLegacyDrawing' */\n\t\t\tcase 0x0228: /* 'BrtLegacyDrawingHF' */\n\t\t\tcase 0x0295: /* 'BrtListPart' */\n\t\t\tcase 0x027F: /* 'BrtOleObject' */\n\t\t\tcase 0x01DE: /* 'BrtPageSetup' */\n\t\t\tcase 0x0219: /* 'BrtPhoneticInfo' */\n\t\t\tcase 0x01DD: /* 'BrtPrintOptions' */\n\t\t\tcase 0x0218: /* 'BrtRangeProtection' */\n\t\t\tcase 0x044F: /* 'BrtRangeProtection14' */\n\t\t\tcase 0x02A8: /* 'BrtRangeProtectionIso' */\n\t\t\tcase 0x0450: /* 'BrtRangeProtectionIso14' */\n\t\t\tcase 0x0400: /* 'BrtRwDescent' */\n\t\t\tcase 0x0297: /* 'BrtSheetCalcProp' */\n\t\t\tcase 0x0217: /* 'BrtSheetProtection' */\n\t\t\tcase 0x02A6: /* 'BrtSheetProtectionIso' */\n\t\t\tcase 0x01F8: /* 'BrtSlc' */\n\t\t\tcase 0x0413: /* 'BrtSparkline' */\n\t\t\tcase 0x01AC: /* 'BrtTable' */\n\t\t\tcase 0x00AA: /* 'BrtTop10Filter' */\n\t\t\tcase 0x0C00: /* 'BrtUid' */\n\t\t\tcase 0x0032: /* 'BrtValueMeta' */\n\t\t\tcase 0x0816: /* 'BrtWebExtension' */\n\t\t\tcase 0x0415: /* 'BrtWsFmtInfoEx14' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tpass = false; break;\n\t\t\tcase 0x0025: /* 'BrtACBegin' */\n\t\t\t\tstate.push(RT); pass = true; break;\n\t\t\tcase 0x0026: /* 'BrtACEnd' */\n\t\t\t\tstate.pop(); pass = false; break;\n\n\t\t\tdefault:\n\t\t\t\tif(RR.T){/* empty */}\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t}, opts);\n\n\tdelete opts.supbooks;\n\tdelete opts['!row'];\n\n\tif(!s[\"!ref\"] && (refguess.s.r < 2000000 || ref && (ref.e.r > 0 || ref.e.c > 0 || ref.s.r > 0 || ref.s.c > 0))) s[\"!ref\"] = encode_range(ref || refguess);\n\tif(opts.sheetRows && s[\"!ref\"]) {\n\t\tvar tmpref = safe_decode_range(s[\"!ref\"]);\n\t\tif(opts.sheetRows <= +tmpref.e.r) {\n\t\t\ttmpref.e.r = opts.sheetRows - 1;\n\t\t\tif(tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n\t\t\tif(tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n\t\t\tif(tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n\t\t\tif(tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n\t\t\ts[\"!fullref\"] = s[\"!ref\"];\n\t\t\ts[\"!ref\"] = encode_range(tmpref);\n\t\t}\n\t}\n\tif(merges.length > 0) s[\"!merges\"] = merges;\n\tif(colinfo.length > 0) s[\"!cols\"] = colinfo;\n\tif(rowinfo.length > 0) s[\"!rows\"] = rowinfo;\n\treturn s;\n}\n\n/* TODO: something useful -- this is a stub */\nfunction write_ws_bin_cell(ba, cell, R, C, opts, ws, last_seen) {\n\tif(cell.v === undefined) return false;\n\tvar vv = \"\";\n\tswitch(cell.t) {\n\t\tcase 'b': vv = cell.v ? \"1\" : \"0\"; break;\n\t\tcase 'd': // no BrtCellDate :(\n\t\t\tcell = dup(cell);\n\t\t\tcell.z = cell.z || table_fmt[14];\n\t\t\tcell.v = datenum(parseDate(cell.v)); cell.t = 'n';\n\t\t\tbreak;\n\t\t/* falls through */\n\t\tcase 'n': case 'e': vv = ''+cell.v; break;\n\t\tdefault: vv = cell.v; break;\n\t}\n\tvar o = ({r:R, c:C});\n\t/* TODO: cell style */\n\to.s = get_cell_style(opts.cellXfs, cell, opts);\n\tif(cell.l) ws['!links'].push([encode_cell(o), cell.l]);\n\tif(cell.c) ws['!comments'].push([encode_cell(o), cell.c]);\n\tswitch(cell.t) {\n\t\tcase 's': case 'str':\n\t\t\tif(opts.bookSST) {\n\t\t\t\tvv = get_sst_id(opts.Strings, (cell.v), opts.revStrings);\n\t\t\t\to.t = \"s\"; o.v = vv;\n\t\t\t\tif(last_seen) write_record(ba, 0x0012 /* BrtShortIsst */, write_BrtShortIsst(cell, o));\n\t\t\t\telse write_record(ba, 0x0007 /* BrtCellIsst */, write_BrtCellIsst(cell, o));\n\t\t\t} else {\n\t\t\t\to.t = \"str\";\n\t\t\t\tif(last_seen) write_record(ba, 0x0011 /* BrtShortSt */, write_BrtShortSt(cell, o));\n\t\t\t\telse write_record(ba, 0x0006 /* BrtCellSt */, write_BrtCellSt(cell, o));\n\t\t\t}\n\t\t\treturn true;\n\t\tcase 'n':\n\t\t\t/* TODO: determine threshold for Real vs RK */\n\t\t\tif(cell.v == (cell.v | 0) && cell.v > -1000 && cell.v < 1000) {\n\t\t\t\tif(last_seen) write_record(ba, 0x000D /* BrtShortRk */, write_BrtShortRk(cell, o));\n\t\t\t\telse write_record(ba, 0x0002 /* BrtCellRk */, write_BrtCellRk(cell, o));\n\t\t\t} else {\n\t\t\t\tif(last_seen) write_record(ba, 0x0010 /* BrtShortReal */, write_BrtShortReal(cell, o));\n\t\t\t\telse write_record(ba, 0x0005 /* BrtCellReal */, write_BrtCellReal(cell, o));\n\t\t\t} return true;\n\t\tcase 'b':\n\t\t\to.t = \"b\";\n\t\t\tif(last_seen) write_record(ba, 0x000F /* BrtShortBool */, write_BrtShortBool(cell, o));\n\t\t\telse write_record(ba, 0x0004 /* BrtCellBool */, write_BrtCellBool(cell, o));\n\t\t\treturn true;\n\t\tcase 'e':\n\t\t\to.t = \"e\";\n\t\t\tif(last_seen) write_record(ba, 0x000E /* BrtShortError */, write_BrtShortError(cell, o));\n\t\t\telse write_record(ba, 0x0003 /* BrtCellError */, write_BrtCellError(cell, o));\n\t\t\treturn true;\n\t}\n\tif(last_seen) write_record(ba, 0x000C /* BrtShortBlank */, write_BrtShortBlank(cell, o));\n\telse write_record(ba, 0x0001 /* BrtCellBlank */, write_BrtCellBlank(cell, o));\n\treturn true;\n}\n\nfunction write_CELLTABLE(ba, ws, idx, opts) {\n\tvar range = safe_decode_range(ws['!ref'] || \"A1\"), ref, rr = \"\", cols = [];\n\twrite_record(ba, 0x0091 /* BrtBeginSheetData */);\n\tvar dense = Array.isArray(ws);\n\tvar cap = range.e.r;\n\tif(ws['!rows']) cap = Math.max(range.e.r, ws['!rows'].length - 1);\n\tfor(var R = range.s.r; R <= cap; ++R) {\n\t\trr = encode_row(R);\n\t\t/* [ACCELLTABLE] */\n\t\t/* BrtRowHdr */\n\t\twrite_row_header(ba, ws, range, R);\n\t\tvar last_seen = false;\n\t\tif(R <= range.e.r) for(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\t/* *16384CELL */\n\t\t\tif(R === range.s.r) cols[C] = encode_col(C);\n\t\t\tref = cols[C] + rr;\n\t\t\tvar cell = dense ? (ws[R]||[])[C] : ws[ref];\n\t\t\tif(!cell) { last_seen = false; continue; }\n\t\t\t/* write cell */\n\t\t\tlast_seen = write_ws_bin_cell(ba, cell, R, C, opts, ws, last_seen);\n\t\t}\n\t}\n\twrite_record(ba, 0x0092 /* BrtEndSheetData */);\n}\n\nfunction write_MERGECELLS(ba, ws) {\n\tif(!ws || !ws['!merges']) return;\n\twrite_record(ba, 0x00B1 /* BrtBeginMergeCells */, write_BrtBeginMergeCells(ws['!merges'].length));\n\tws['!merges'].forEach(function(m) { write_record(ba, 0x00B0 /* BrtMergeCell */, write_BrtMergeCell(m)); });\n\twrite_record(ba, 0x00B2 /* BrtEndMergeCells */);\n}\n\nfunction write_COLINFOS(ba, ws) {\n\tif(!ws || !ws['!cols']) return;\n\twrite_record(ba, 0x0186 /* BrtBeginColInfos */);\n\tws['!cols'].forEach(function(m, i) { if(m) write_record(ba, 0x003C /* 'BrtColInfo' */, write_BrtColInfo(i, m)); });\n\twrite_record(ba, 0x0187 /* BrtEndColInfos */);\n}\n\nfunction write_IGNOREECS(ba, ws) {\n\tif(!ws || !ws['!ref']) return;\n\twrite_record(ba, 0x0288 /* BrtBeginCellIgnoreECs */);\n\twrite_record(ba, 0x0289 /* BrtCellIgnoreEC */, write_BrtCellIgnoreEC(safe_decode_range(ws['!ref'])));\n\twrite_record(ba, 0x028A /* BrtEndCellIgnoreECs */);\n}\n\nfunction write_HLINKS(ba, ws, rels) {\n\t/* *BrtHLink */\n\tws['!links'].forEach(function(l) {\n\t\tif(!l[1].Target) return;\n\t\tvar rId = add_rels(rels, -1, l[1].Target.replace(/#.*$/, \"\"), RELS.HLINK);\n\t\twrite_record(ba, 0x01EE /* BrtHLink */, write_BrtHLink(l, rId));\n\t});\n\tdelete ws['!links'];\n}\nfunction write_LEGACYDRAWING(ba, ws, idx, rels) {\n\t/* [BrtLegacyDrawing] */\n\tif(ws['!comments'].length > 0) {\n\t\tvar rId = add_rels(rels, -1, \"../drawings/vmlDrawing\" + (idx+1) + \".vml\", RELS.VML);\n\t\twrite_record(ba, 0x0227 /* BrtLegacyDrawing */, write_RelID(\"rId\" + rId));\n\t\tws['!legacy'] = rId;\n\t}\n}\n\nfunction write_AUTOFILTER(ba, ws, wb, idx) {\n\tif(!ws['!autofilter']) return;\n\tvar data = ws['!autofilter'];\n\tvar ref = typeof data.ref === \"string\" ? data.ref : encode_range(data.ref);\n\n\t/* Update FilterDatabase defined name for the worksheet */\n\tif(!wb.Workbook) wb.Workbook = ({Sheets:[]});\n\tif(!wb.Workbook.Names) wb.Workbook.Names = [];\n\tvar names = wb.Workbook.Names;\n\tvar range = decode_range(ref);\n\tif(range.s.r == range.e.r) { range.e.r = decode_range(ws[\"!ref\"]).e.r; ref = encode_range(range); }\n\tfor(var i = 0; i < names.length; ++i) {\n\t\tvar name = names[i];\n\t\tif(name.Name != '_xlnm._FilterDatabase') continue;\n\t\tif(name.Sheet != idx) continue;\n\t\tname.Ref = \"'\" + wb.SheetNames[idx] + \"'!\" + ref; break;\n\t}\n\tif(i == names.length) names.push({ Name: '_xlnm._FilterDatabase', Sheet: idx, Ref: \"'\" + wb.SheetNames[idx] + \"'!\" + ref  });\n\n\twrite_record(ba, 0x00A1 /* BrtBeginAFilter */, write_UncheckedRfX(safe_decode_range(ref)));\n\t/* *FILTERCOLUMN */\n\t/* [SORTSTATE] */\n\t/* BrtEndAFilter */\n\twrite_record(ba, 0x00A2 /* BrtEndAFilter */);\n}\n\nfunction write_WSVIEWS2(ba, ws, Workbook) {\n\twrite_record(ba, 0x0085 /* BrtBeginWsViews */);\n\t{ /* 1*WSVIEW2 */\n\t\t/* [ACUID] */\n\t\twrite_record(ba, 0x0089 /* BrtBeginWsView */, write_BrtBeginWsView(ws, Workbook));\n\t\t/* [BrtPane] */\n\t\t/* *4BrtSel */\n\t\t/* *4SXSELECT */\n\t\t/* *FRT */\n\t\twrite_record(ba, 0x008A /* BrtEndWsView */);\n\t}\n\t/* *FRT */\n\twrite_record(ba, 0x0086 /* BrtEndWsViews */);\n}\n\nfunction write_WSFMTINFO() {\n\t/* [ACWSFMTINFO] */\n\t// write_record(ba, 0x01E5 /* BrtWsFmtInfo */, write_BrtWsFmtInfo(ws));\n}\n\nfunction write_SHEETPROTECT(ba, ws) {\n\tif(!ws['!protect']) return;\n\t/* [BrtSheetProtectionIso] */\n\twrite_record(ba, 0x0217 /* BrtSheetProtection */, write_BrtSheetProtection(ws['!protect']));\n}\n\nfunction write_ws_bin(idx, opts, wb, rels) {\n\tvar ba = buf_array();\n\tvar s = wb.SheetNames[idx], ws = wb.Sheets[s] || {};\n\tvar c = s; try { if(wb && wb.Workbook) c = wb.Workbook.Sheets[idx].CodeName || c; } catch(e) {}\n\tvar r = safe_decode_range(ws['!ref'] || \"A1\");\n\tif(r.e.c > 0x3FFF || r.e.r > 0xFFFFF) {\n\t\tif(opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:XFD1048576\");\n\t\tr.e.c = Math.min(r.e.c, 0x3FFF);\n\t\tr.e.r = Math.min(r.e.c, 0xFFFFF);\n\t}\n\tws['!links'] = [];\n\t/* passed back to write_zip and removed there */\n\tws['!comments'] = [];\n\twrite_record(ba, 0x0081 /* BrtBeginSheet */);\n\tif(wb.vbaraw || ws['!outline']) write_record(ba, 0x0093 /* BrtWsProp */, write_BrtWsProp(c, ws['!outline']));\n\twrite_record(ba, 0x0094 /* BrtWsDim */, write_BrtWsDim(r));\n\twrite_WSVIEWS2(ba, ws, wb.Workbook);\n\twrite_WSFMTINFO(ba, ws);\n\twrite_COLINFOS(ba, ws, idx, opts, wb);\n\twrite_CELLTABLE(ba, ws, idx, opts, wb);\n\t/* [BrtSheetCalcProp] */\n\twrite_SHEETPROTECT(ba, ws);\n\t/* *([BrtRangeProtectionIso] BrtRangeProtection) */\n\t/* [SCENMAN] */\n\twrite_AUTOFILTER(ba, ws, wb, idx);\n\t/* [SORTSTATE] */\n\t/* [DCON] */\n\t/* [USERSHVIEWS] */\n\twrite_MERGECELLS(ba, ws);\n\t/* [BrtPhoneticInfo] */\n\t/* *CONDITIONALFORMATTING */\n\t/* [DVALS] */\n\twrite_HLINKS(ba, ws, rels);\n\t/* [BrtPrintOptions] */\n\tif(ws['!margins']) write_record(ba, 0x01DC /* BrtMargins */, write_BrtMargins(ws['!margins']));\n\t/* [BrtPageSetup] */\n\t/* [HEADERFOOTER] */\n\t/* [RWBRK] */\n\t/* [COLBRK] */\n\t/* *BrtBigName */\n\t/* [CELLWATCHES] */\n\tif(!opts || opts.ignoreEC || (opts.ignoreEC == (void 0))) write_IGNOREECS(ba, ws);\n\t/* [SMARTTAGS] */\n\t/* [BrtDrawing] */\n\twrite_LEGACYDRAWING(ba, ws, idx, rels);\n\t/* [BrtLegacyDrawingHF] */\n\t/* [BrtBkHim] */\n\t/* [OLEOBJECTS] */\n\t/* [ACTIVEXCONTROLS] */\n\t/* [WEBPUBITEMS] */\n\t/* [LISTPARTS] */\n\t/* FRTWORKSHEET */\n\twrite_record(ba, 0x0082 /* BrtEndSheet */);\n\treturn ba.end();\n}\nfunction parse_Cache(data) {\n\tvar col = [];\n\tvar num = data.match(/^<c:numCache>/);\n\tvar f;\n\n\t/* 21.2.2.150 pt CT_NumVal */\n\t(data.match(/<c:pt idx=\"(\\d*)\">(.*?)<\\/c:pt>/mg)||[]).forEach(function(pt) {\n\t\tvar q = pt.match(/<c:pt idx=\"(\\d*?)\"><c:v>(.*)<\\/c:v><\\/c:pt>/);\n\t\tif(!q) return;\n\t\tcol[+q[1]] = num ? +q[2] : q[2];\n\t});\n\n\t/* 21.2.2.71 formatCode CT_Xstring */\n\tvar nf = unescapexml((data.match(/<c:formatCode>([\\s\\S]*?)<\\/c:formatCode>/) || [\"\",\"General\"])[1]);\n\n\t(data.match(/<c:f>(.*?)<\\/c:f>/mg)||[]).forEach(function(F) { f = F.replace(/<.*?>/g,\"\"); });\n\n\treturn [col, nf, f];\n}\n\n/* 21.2 DrawingML - Charts */\nfunction parse_chart(data, name, opts, rels, wb, csheet) {\n\tvar cs = ((csheet || {\"!type\":\"chart\"}));\n\tif(!data) return csheet;\n\t/* 21.2.2.27 chart CT_Chart */\n\n\tvar C = 0, R = 0, col = \"A\";\n\tvar refguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\n\t/* 21.2.2.120 numCache CT_NumData */\n\t(data.match(/<c:numCache>[\\s\\S]*?<\\/c:numCache>/gm)||[]).forEach(function(nc) {\n\t\tvar cache = parse_Cache(nc);\n\t\trefguess.s.r = refguess.s.c = 0;\n\t\trefguess.e.c = C;\n\t\tcol = encode_col(C);\n\t\tcache[0].forEach(function(n,i) {\n\t\t\tcs[col + encode_row(i)] = {t:'n', v:n, z:cache[1] };\n\t\t\tR = i;\n\t\t});\n\t\tif(refguess.e.r < R) refguess.e.r = R;\n\t\t++C;\n\t});\n\tif(C > 0) cs[\"!ref\"] = encode_range(refguess);\n\treturn cs;\n}\n/* 18.3 Worksheets also covers Chartsheets */\nfunction parse_cs_xml(data, opts, idx, rels, wb) {\n\tif(!data) return data;\n\t/* 18.3.1.12 chartsheet CT_ChartSheet */\n\tif(!rels) rels = {'!id':{}};\n\tvar s = ({'!type':\"chart\", '!drawel':null, '!rel':\"\"});\n\tvar m;\n\n\t/* 18.3.1.83 sheetPr CT_ChartsheetPr */\n\tvar sheetPr = data.match(sheetprregex);\n\tif(sheetPr) parse_ws_xml_sheetpr(sheetPr[0], s, wb, idx);\n\n\t/* 18.3.1.36 drawing CT_Drawing */\n\tif((m = data.match(/drawing r:id=\"(.*?)\"/))) s['!rel'] = m[1];\n\n\tif(rels['!id'][s['!rel']]) s['!drawel'] = rels['!id'][s['!rel']];\n\treturn s;\n}\nfunction write_cs_xml(idx, opts, wb, rels) {\n\tvar o = [XML_HEADER, writextag('chartsheet', null, {\n\t\t'xmlns': XMLNS_main[0],\n\t\t'xmlns:r': XMLNS.r\n\t})];\n\to[o.length] = writextag(\"drawing\", null, {\"r:id\": \"rId1\"});\n\tadd_rels(rels, -1, \"../drawings/drawing\" + (idx+1) + \".xml\", RELS.DRAW);\n\tif(o.length>2) { o[o.length] = ('</chartsheet>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n\n/* [MS-XLSB] 2.4.331 BrtCsProp */\nfunction parse_BrtCsProp(data, length) {\n\tdata.l += 10;\n\tvar name = parse_XLWideString(data, length - 10);\n\treturn { name: name };\n}\n\n/* [MS-XLSB] 2.1.7.7 Chart Sheet */\nfunction parse_cs_bin(data, opts, idx, rels, wb) {\n\tif(!data) return data;\n\tif(!rels) rels = {'!id':{}};\n\tvar s = {'!type':\"chart\", '!drawel':null, '!rel':\"\"};\n\tvar state = [];\n\tvar pass = false;\n\trecordhopper(data, function cs_parse(val, R, RT) {\n\t\tswitch(RT) {\n\n\t\t\tcase 0x0226: /* 'BrtDrawing' */\n\t\t\t\ts['!rel'] = val; break;\n\n\t\t\tcase 0x028B: /* 'BrtCsProp' */\n\t\t\t\tif(!wb.Sheets[idx]) wb.Sheets[idx] = {};\n\t\t\t\tif(val.name) wb.Sheets[idx].CodeName = val.name;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0232: /* 'BrtBkHim' */\n\t\t\tcase 0x028C: /* 'BrtCsPageSetup' */\n\t\t\tcase 0x029D: /* 'BrtCsProtection' */\n\t\t\tcase 0x02A7: /* 'BrtCsProtectionIso' */\n\t\t\tcase 0x0227: /* 'BrtLegacyDrawing' */\n\t\t\tcase 0x0228: /* 'BrtLegacyDrawingHF' */\n\t\t\tcase 0x01DC: /* 'BrtMargins' */\n\t\t\tcase 0x0C00: /* 'BrtUid' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tpass = false; break;\n\t\t\tcase 0x0025: /* 'BrtACBegin' */\n\t\t\t\tstate.push(RT); break;\n\t\t\tcase 0x0026: /* 'BrtACEnd' */\n\t\t\t\tstate.pop(); break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T > 0) state.push(RT);\n\t\t\t\telse if(R.T < 0) state.pop();\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t}, opts);\n\n\tif(rels['!id'][s['!rel']]) s['!drawel'] = rels['!id'][s['!rel']];\n\treturn s;\n}\nfunction write_cs_bin() {\n\tvar ba = buf_array();\n\twrite_record(ba, 0x0081 /* BrtBeginSheet */);\n\t/* [BrtCsProp] */\n\t/* CSVIEWS */\n\t/* [[BrtCsProtectionIso] BrtCsProtection] */\n\t/* [USERCSVIEWS] */\n\t/* [BrtMargins] */\n\t/* [BrtCsPageSetup] */\n\t/* [HEADERFOOTER] */\n\t/* BrtDrawing */\n\t/* [BrtLegacyDrawing] */\n\t/* [BrtLegacyDrawingHF] */\n\t/* [BrtBkHim] */\n\t/* [WEBPUBITEMS] */\n\t/* FRTCHARTSHEET */\n\twrite_record(ba, 0x0082 /* BrtEndSheet */);\n\treturn ba.end();\n}\n/* 18.2.28 (CT_WorkbookProtection) Defaults */\nvar WBPropsDef = [\n\t['allowRefreshQuery',           false, \"bool\"],\n\t['autoCompressPictures',        true,  \"bool\"],\n\t['backupFile',                  false, \"bool\"],\n\t['checkCompatibility',          false, \"bool\"],\n\t['CodeName',                    ''],\n\t['date1904',                    false, \"bool\"],\n\t['defaultThemeVersion',         0,      \"int\"],\n\t['filterPrivacy',               false, \"bool\"],\n\t['hidePivotFieldList',          false, \"bool\"],\n\t['promptedSolutions',           false, \"bool\"],\n\t['publishItems',                false, \"bool\"],\n\t['refreshAllConnections',       false, \"bool\"],\n\t['saveExternalLinkValues',      true,  \"bool\"],\n\t['showBorderUnselectedTables',  true,  \"bool\"],\n\t['showInkAnnotation',           true,  \"bool\"],\n\t['showObjects',                 'all'],\n\t['showPivotChartFilter',        false, \"bool\"],\n\t['updateLinks', 'userSet']\n];\n\n/* 18.2.30 (CT_BookView) Defaults */\nvar WBViewDef = [\n\t['activeTab',                   0,      \"int\"],\n\t['autoFilterDateGrouping',      true,  \"bool\"],\n\t['firstSheet',                  0,      \"int\"],\n\t['minimized',                   false, \"bool\"],\n\t['showHorizontalScroll',        true,  \"bool\"],\n\t['showSheetTabs',               true,  \"bool\"],\n\t['showVerticalScroll',          true,  \"bool\"],\n\t['tabRatio',                    600,    \"int\"],\n\t['visibility',                  'visible']\n\t//window{Height,Width}, {x,y}Window\n];\n\n/* 18.2.19 (CT_Sheet) Defaults */\nvar SheetDef = [\n\t//['state', 'visible']\n];\n\n/* 18.2.2  (CT_CalcPr) Defaults */\nvar CalcPrDef = [\n\t['calcCompleted', 'true'],\n\t['calcMode', 'auto'],\n\t['calcOnSave', 'true'],\n\t['concurrentCalc', 'true'],\n\t['fullCalcOnLoad', 'false'],\n\t['fullPrecision', 'true'],\n\t['iterate', 'false'],\n\t['iterateCount', '100'],\n\t['iterateDelta', '0.001'],\n\t['refMode', 'A1']\n];\n\n/* 18.2.3 (CT_CustomWorkbookView) Defaults */\n/*var CustomWBViewDef = [\n\t['autoUpdate', 'false'],\n\t['changesSavedWin', 'false'],\n\t['includeHiddenRowCol', 'true'],\n\t['includePrintSettings', 'true'],\n\t['maximized', 'false'],\n\t['minimized', 'false'],\n\t['onlySync', 'false'],\n\t['personalView', 'false'],\n\t['showComments', 'commIndicator'],\n\t['showFormulaBar', 'true'],\n\t['showHorizontalScroll', 'true'],\n\t['showObjects', 'all'],\n\t['showSheetTabs', 'true'],\n\t['showStatusbar', 'true'],\n\t['showVerticalScroll', 'true'],\n\t['tabRatio', '600'],\n\t['xWindow', '0'],\n\t['yWindow', '0']\n];*/\n\nfunction push_defaults_array(target, defaults) {\n\tfor(var j = 0; j != target.length; ++j) { var w = target[j];\n\t\tfor(var i=0; i != defaults.length; ++i) { var z = defaults[i];\n\t\t\tif(w[z[0]] == null) w[z[0]] = z[1];\n\t\t\telse switch(z[2]) {\n\t\t\tcase \"bool\": if(typeof w[z[0]] == \"string\") w[z[0]] = parsexmlbool(w[z[0]]); break;\n\t\t\tcase \"int\": if(typeof w[z[0]] == \"string\") w[z[0]] = parseInt(w[z[0]], 10); break;\n\t\t\t}\n\t\t}\n\t}\n}\nfunction push_defaults(target, defaults) {\n\tfor(var i = 0; i != defaults.length; ++i) { var z = defaults[i];\n\t\tif(target[z[0]] == null) target[z[0]] = z[1];\n\t\telse switch(z[2]) {\n\t\t\tcase \"bool\": if(typeof target[z[0]] == \"string\") target[z[0]] = parsexmlbool(target[z[0]]); break;\n\t\t\tcase \"int\": if(typeof target[z[0]] == \"string\") target[z[0]] = parseInt(target[z[0]], 10); break;\n\t\t}\n\t}\n}\n\nfunction parse_wb_defaults(wb) {\n\tpush_defaults(wb.WBProps, WBPropsDef);\n\tpush_defaults(wb.CalcPr, CalcPrDef);\n\n\tpush_defaults_array(wb.WBView, WBViewDef);\n\tpush_defaults_array(wb.Sheets, SheetDef);\n\n\t_ssfopts.date1904 = parsexmlbool(wb.WBProps.date1904);\n}\n\nfunction safe1904(wb) {\n\t/* TODO: store date1904 somewhere else */\n\tif(!wb.Workbook) return \"false\";\n\tif(!wb.Workbook.WBProps) return \"false\";\n\treturn parsexmlbool(wb.Workbook.WBProps.date1904) ? \"true\" : \"false\";\n}\n\nvar badchars = \"][*?\\/\\\\\".split(\"\");\nfunction check_ws_name(n, safe) {\n\tif(n.length > 31) { if(safe) return false; throw new Error(\"Sheet names cannot exceed 31 chars\"); }\n\tvar _good = true;\n\tbadchars.forEach(function(c) {\n\t\tif(n.indexOf(c) == -1) return;\n\t\tif(!safe) throw new Error(\"Sheet name cannot contain : \\\\ / ? * [ ]\");\n\t\t_good = false;\n\t});\n\treturn _good;\n}\nfunction check_wb_names(N, S, codes) {\n\tN.forEach(function(n,i) {\n\t\tcheck_ws_name(n);\n\t\tfor(var j = 0; j < i; ++j) if(n == N[j]) throw new Error(\"Duplicate Sheet Name: \" + n);\n\t\tif(codes) {\n\t\t\tvar cn = (S && S[i] && S[i].CodeName) || n;\n\t\t\tif(cn.charCodeAt(0) == 95 && cn.length > 22) throw new Error(\"Bad Code Name: Worksheet\" + cn);\n\t\t}\n\t});\n}\nfunction check_wb(wb) {\n\tif(!wb || !wb.SheetNames || !wb.Sheets) throw new Error(\"Invalid Workbook\");\n\tif(!wb.SheetNames.length) throw new Error(\"Workbook is empty\");\n\tvar Sheets = (wb.Workbook && wb.Workbook.Sheets) || [];\n\tcheck_wb_names(wb.SheetNames, Sheets, !!wb.vbaraw);\n\tfor(var i = 0; i < wb.SheetNames.length; ++i) check_ws(wb.Sheets[wb.SheetNames[i]], wb.SheetNames[i], i);\n\t/* TODO: validate workbook */\n}\n/* 18.2 Workbook */\nvar wbnsregex = /<\\w+:workbook/;\nfunction parse_wb_xml(data, opts) {\n\tif(!data) throw new Error(\"Could not find file\");\n\tvar wb = { AppVersion:{}, WBProps:{}, WBView:[], Sheets:[], CalcPr:{}, Names:[], xmlns: \"\" };\n\tvar pass = false, xmlns = \"xmlns\";\n\tvar dname = {}, dnstart = 0;\n\tdata.replace(tagregex, function xml_wb(x, idx) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\n\t\t\t/* 18.2.27 workbook CT_Workbook 1 */\n\t\t\tcase '<workbook':\n\t\t\t\tif(x.match(wbnsregex)) xmlns = \"xmlns\" + x.match(/<(\\w+):/)[1];\n\t\t\t\twb.xmlns = y[xmlns];\n\t\t\t\tbreak;\n\t\t\tcase '</workbook>': break;\n\n\t\t\t/* 18.2.13 fileVersion CT_FileVersion ? */\n\t\t\tcase '<fileVersion': delete y[0]; wb.AppVersion = y; break;\n\t\t\tcase '<fileVersion/>': case '</fileVersion>': break;\n\n\t\t\t/* 18.2.12 fileSharing CT_FileSharing ? */\n\t\t\tcase '<fileSharing':\n\t\t\t\tbreak;\n\t\t\tcase '<fileSharing/>': break;\n\n\t\t\t/* 18.2.28 workbookPr CT_WorkbookPr ? */\n\t\t\tcase '<workbookPr':\n\t\t\tcase '<workbookPr/>':\n\t\t\t\tWBPropsDef.forEach(function(w) {\n\t\t\t\t\tif(y[w[0]] == null) return;\n\t\t\t\t\tswitch(w[2]) {\n\t\t\t\t\t\tcase \"bool\": wb.WBProps[w[0]] = parsexmlbool(y[w[0]]); break;\n\t\t\t\t\t\tcase \"int\": wb.WBProps[w[0]] = parseInt(y[w[0]], 10); break;\n\t\t\t\t\t\tdefault: wb.WBProps[w[0]] = y[w[0]];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif(y.codeName) wb.WBProps.CodeName = utf8read(y.codeName);\n\t\t\t\tbreak;\n\t\t\tcase '</workbookPr>': break;\n\n\t\t\t/* 18.2.29 workbookProtection CT_WorkbookProtection ? */\n\t\t\tcase '<workbookProtection':\n\t\t\t\tbreak;\n\t\t\tcase '<workbookProtection/>': break;\n\n\t\t\t/* 18.2.1  bookViews CT_BookViews ? */\n\t\t\tcase '<bookViews': case '<bookViews>': case '</bookViews>': break;\n\t\t\t/* 18.2.30   workbookView CT_BookView + */\n\t\t\tcase '<workbookView': case '<workbookView/>': delete y[0]; wb.WBView.push(y); break;\n\t\t\tcase '</workbookView>': break;\n\n\t\t\t/* 18.2.20 sheets CT_Sheets 1 */\n\t\t\tcase '<sheets': case '<sheets>': case '</sheets>': break; // aggregate sheet\n\t\t\t/* 18.2.19   sheet CT_Sheet + */\n\t\t\tcase '<sheet':\n\t\t\t\tswitch(y.state) {\n\t\t\t\t\tcase \"hidden\": y.Hidden = 1; break;\n\t\t\t\t\tcase \"veryHidden\": y.Hidden = 2; break;\n\t\t\t\t\tdefault: y.Hidden = 0;\n\t\t\t\t}\n\t\t\t\tdelete y.state;\n\t\t\t\ty.name = unescapexml(utf8read(y.name));\n\t\t\t\tdelete y[0]; wb.Sheets.push(y); break;\n\t\t\tcase '</sheet>': break;\n\n\t\t\t/* 18.2.15 functionGroups CT_FunctionGroups ? */\n\t\t\tcase '<functionGroups': case '<functionGroups/>': break;\n\t\t\t/* 18.2.14   functionGroup CT_FunctionGroup + */\n\t\t\tcase '<functionGroup': break;\n\n\t\t\t/* 18.2.9  externalReferences CT_ExternalReferences ? */\n\t\t\tcase '<externalReferences': case '</externalReferences>': case '<externalReferences>': break;\n\t\t\t/* 18.2.8    externalReference CT_ExternalReference + */\n\t\t\tcase '<externalReference': break;\n\n\t\t\t/* 18.2.6  definedNames CT_DefinedNames ? */\n\t\t\tcase '<definedNames/>': break;\n\t\t\tcase '<definedNames>': case '<definedNames': pass=true; break;\n\t\t\tcase '</definedNames>': pass=false; break;\n\t\t\t/* 18.2.5    definedName CT_DefinedName + */\n\t\t\tcase '<definedName': {\n\t\t\t\tdname = {};\n\t\t\t\tdname.Name = utf8read(y.name);\n\t\t\t\tif(y.comment) dname.Comment = y.comment;\n\t\t\t\tif(y.localSheetId) dname.Sheet = +y.localSheetId;\n\t\t\t\tif(parsexmlbool(y.hidden||\"0\")) dname.Hidden = true;\n\t\t\t\tdnstart = idx + x.length;\n\t\t\t}\tbreak;\n\t\t\tcase '</definedName>': {\n\t\t\t\tdname.Ref = unescapexml(utf8read(data.slice(dnstart, idx)));\n\t\t\t\twb.Names.push(dname);\n\t\t\t} break;\n\t\t\tcase '<definedName/>': break;\n\n\t\t\t/* 18.2.2  calcPr CT_CalcPr ? */\n\t\t\tcase '<calcPr': delete y[0]; wb.CalcPr = y; break;\n\t\t\tcase '<calcPr/>': delete y[0]; wb.CalcPr = y; break;\n\t\t\tcase '</calcPr>': break;\n\n\t\t\t/* 18.2.16 oleSize CT_OleSize ? (ref required) */\n\t\t\tcase '<oleSize': break;\n\n\t\t\t/* 18.2.4  customWorkbookViews CT_CustomWorkbookViews ? */\n\t\t\tcase '<customWorkbookViews>': case '</customWorkbookViews>': case '<customWorkbookViews': break;\n\t\t\t/* 18.2.3  customWorkbookView CT_CustomWorkbookView + */\n\t\t\tcase '<customWorkbookView': case '</customWorkbookView>': break;\n\n\t\t\t/* 18.2.18 pivotCaches CT_PivotCaches ? */\n\t\t\tcase '<pivotCaches>': case '</pivotCaches>': case '<pivotCaches': break;\n\t\t\t/* 18.2.17 pivotCache CT_PivotCache ? */\n\t\t\tcase '<pivotCache': break;\n\n\t\t\t/* 18.2.21 smartTagPr CT_SmartTagPr ? */\n\t\t\tcase '<smartTagPr': case '<smartTagPr/>': break;\n\n\t\t\t/* 18.2.23 smartTagTypes CT_SmartTagTypes ? */\n\t\t\tcase '<smartTagTypes': case '<smartTagTypes>': case '</smartTagTypes>': break;\n\t\t\t/* 18.2.22 smartTagType CT_SmartTagType ? */\n\t\t\tcase '<smartTagType': break;\n\n\t\t\t/* 18.2.24 webPublishing CT_WebPublishing ? */\n\t\t\tcase '<webPublishing': case '<webPublishing/>': break;\n\n\t\t\t/* 18.2.11 fileRecoveryPr CT_FileRecoveryPr ? */\n\t\t\tcase '<fileRecoveryPr': case '<fileRecoveryPr/>': break;\n\n\t\t\t/* 18.2.26 webPublishObjects CT_WebPublishObjects ? */\n\t\t\tcase '<webPublishObjects>': case '<webPublishObjects': case '</webPublishObjects>': break;\n\t\t\t/* 18.2.25 webPublishObject CT_WebPublishObject ? */\n\t\t\tcase '<webPublishObject': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': case '<extLst/>': break;\n\t\t\t/* 18.2.7  ext CT_Extension + */\n\t\t\tcase '<ext': pass=true; break; //TODO: check with versions of excel\n\t\t\tcase '</ext>': pass=false; break;\n\n\t\t\t/* Others */\n\t\t\tcase '<ArchID': break;\n\t\t\tcase '<AlternateContent':\n\t\t\tcase '<AlternateContent>': pass=true; break;\n\t\t\tcase '</AlternateContent>': pass=false; break;\n\n\t\t\t/* TODO */\n\t\t\tcase '<revisionPtr': break;\n\n\t\t\tdefault: if(!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in workbook');\n\t\t}\n\t\treturn x;\n\t});\n\tif(XMLNS_main.indexOf(wb.xmlns) === -1) throw new Error(\"Unknown Namespace: \" + wb.xmlns);\n\n\tparse_wb_defaults(wb);\n\n\treturn wb;\n}\n\nfunction write_wb_xml(wb) {\n\tvar o = [XML_HEADER];\n\to[o.length] = writextag('workbook', null, {\n\t\t'xmlns': XMLNS_main[0],\n\t\t//'xmlns:mx': XMLNS.mx,\n\t\t//'xmlns:s': XMLNS_main[0],\n\t\t'xmlns:r': XMLNS.r\n\t});\n\n\tvar write_names = (wb.Workbook && (wb.Workbook.Names||[]).length > 0);\n\n\t/* fileVersion */\n\t/* fileSharing */\n\n\tvar workbookPr = ({codeName:\"ThisWorkbook\"});\n\tif(wb.Workbook && wb.Workbook.WBProps) {\n\t\tWBPropsDef.forEach(function(x) {\nif((wb.Workbook.WBProps[x[0]]) == null) return;\n\t\t\tif((wb.Workbook.WBProps[x[0]]) == x[1]) return;\n\t\t\tworkbookPr[x[0]] = (wb.Workbook.WBProps[x[0]]);\n\t\t});\nif(wb.Workbook.WBProps.CodeName) { workbookPr.codeName = wb.Workbook.WBProps.CodeName; delete workbookPr.CodeName; }\n\t}\n\to[o.length] = (writextag('workbookPr', null, workbookPr));\n\n\t/* workbookProtection */\n\n\tvar sheets = wb.Workbook && wb.Workbook.Sheets || [];\n\tvar i = 0;\n\n\t/* bookViews only written if first worksheet is hidden */\n\tif(sheets && sheets[0] && !!sheets[0].Hidden) {\n\t\to[o.length] = \"<bookViews>\";\n\t\tfor(i = 0; i != wb.SheetNames.length; ++i) {\n\t\t\tif(!sheets[i]) break;\n\t\t\tif(!sheets[i].Hidden) break;\n\t\t}\n\t\tif(i == wb.SheetNames.length) i = 0;\n\t\to[o.length] = '<workbookView firstSheet=\"' + i + '\" activeTab=\"' + i + '\"/>';\n\t\to[o.length] = \"</bookViews>\";\n\t}\n\n\to[o.length] = \"<sheets>\";\n\tfor(i = 0; i != wb.SheetNames.length; ++i) {\n\t\tvar sht = ({name:escapexml(wb.SheetNames[i].slice(0,31))});\n\t\tsht.sheetId = \"\"+(i+1);\n\t\tsht[\"r:id\"] = \"rId\"+(i+1);\n\t\tif(sheets[i]) switch(sheets[i].Hidden) {\n\t\t\tcase 1: sht.state = \"hidden\"; break;\n\t\t\tcase 2: sht.state = \"veryHidden\"; break;\n\t\t}\n\t\to[o.length] = (writextag('sheet',null,sht));\n\t}\n\to[o.length] = \"</sheets>\";\n\n\t/* functionGroups */\n\t/* externalReferences */\n\n\tif(write_names) {\n\t\to[o.length] = \"<definedNames>\";\n\t\tif(wb.Workbook && wb.Workbook.Names) wb.Workbook.Names.forEach(function(n) {\n\t\t\tvar d = {name:n.Name};\n\t\t\tif(n.Comment) d.comment = n.Comment;\n\t\t\tif(n.Sheet != null) d.localSheetId = \"\"+n.Sheet;\n\t\t\tif(n.Hidden) d.hidden = \"1\";\n\t\t\tif(!n.Ref) return;\n\t\t\to[o.length] = writextag('definedName', escapexml(n.Ref), d);\n\t\t});\n\t\to[o.length] = \"</definedNames>\";\n\t}\n\n\t/* calcPr */\n\t/* oleSize */\n\t/* customWorkbookViews */\n\t/* pivotCaches */\n\t/* smartTagPr */\n\t/* smartTagTypes */\n\t/* webPublishing */\n\t/* fileRecoveryPr */\n\t/* webPublishObjects */\n\t/* extLst */\n\n\tif(o.length>2){ o[o.length] = '</workbook>'; o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.304 BrtBundleSh */\nfunction parse_BrtBundleSh(data, length) {\n\tvar z = {};\n\tz.Hidden = data.read_shift(4); //hsState ST_SheetState\n\tz.iTabID = data.read_shift(4);\n\tz.strRelID = parse_RelID(data,length-8);\n\tz.name = parse_XLWideString(data);\n\treturn z;\n}\nfunction write_BrtBundleSh(data, o) {\n\tif(!o) o = new_buf(127);\n\to.write_shift(4, data.Hidden);\n\to.write_shift(4, data.iTabID);\n\twrite_RelID(data.strRelID, o);\n\twrite_XLWideString(data.name.slice(0,31), o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.815 BrtWbProp */\nfunction parse_BrtWbProp(data, length) {\n\tvar o = ({});\n\tvar flags = data.read_shift(4);\n\to.defaultThemeVersion = data.read_shift(4);\n\tvar strName = (length > 8) ? parse_XLWideString(data) : \"\";\n\tif(strName.length > 0) o.CodeName = strName;\n\to.autoCompressPictures = !!(flags & 0x10000);\n\to.backupFile = !!(flags & 0x40);\n\to.checkCompatibility = !!(flags & 0x1000);\n\to.date1904 = !!(flags & 0x01);\n\to.filterPrivacy = !!(flags & 0x08);\n\to.hidePivotFieldList = !!(flags & 0x400);\n\to.promptedSolutions = !!(flags & 0x10);\n\to.publishItems = !!(flags & 0x800);\n\to.refreshAllConnections = !!(flags & 0x40000);\n\to.saveExternalLinkValues = !!(flags & 0x80);\n\to.showBorderUnselectedTables = !!(flags & 0x04);\n\to.showInkAnnotation = !!(flags & 0x20);\n\to.showObjects = [\"all\", \"placeholders\", \"none\"][(flags >> 13) & 0x03];\n\to.showPivotChartFilter = !!(flags & 0x8000);\n\to.updateLinks = [\"userSet\", \"never\", \"always\"][(flags >> 8) & 0x03];\n\treturn o;\n}\nfunction write_BrtWbProp(data, o) {\n\tif(!o) o = new_buf(72);\n\tvar flags = 0;\n\tif(data) {\n\t\t/* TODO: mirror parse_BrtWbProp fields */\n\t\tif(data.filterPrivacy) flags |= 0x08;\n\t}\n\to.write_shift(4, flags);\n\to.write_shift(4, 0);\n\twrite_XLSBCodeName(data && data.CodeName || \"ThisWorkbook\", o);\n\treturn o.slice(0, o.l);\n}\n\nfunction parse_BrtFRTArchID$(data, length) {\n\tvar o = {};\n\tdata.read_shift(4);\n\to.ArchID = data.read_shift(4);\n\tdata.l += length - 8;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.687 BrtName */\nfunction parse_BrtName(data, length, opts) {\n\tvar end = data.l + length;\n\tdata.l += 4; //var flags = data.read_shift(4);\n\tdata.l += 1; //var chKey = data.read_shift(1);\n\tvar itab = data.read_shift(4);\n\tvar name = parse_XLNameWideString(data);\n\tvar formula = parse_XLSBNameParsedFormula(data, 0, opts);\n\tvar comment = parse_XLNullableWideString(data);\n\t//if(0 /* fProc */) {\n\t\t// unusedstring1: XLNullableWideString\n\t\t// description: XLNullableWideString\n\t\t// helpTopic: XLNullableWideString\n\t\t// unusedstring2: XLNullableWideString\n\t//}\n\tdata.l = end;\n\tvar out = ({Name:name, Ptg:formula});\n\tif(itab < 0xFFFFFFF) out.Sheet = itab;\n\tif(comment) out.Comment = comment;\n\treturn out;\n}\n\n/* [MS-XLSB] 2.1.7.61 Workbook */\nfunction parse_wb_bin(data, opts) {\n\tvar wb = { AppVersion:{}, WBProps:{}, WBView:[], Sheets:[], CalcPr:{}, xmlns: \"\" };\n\tvar state = [];\n\tvar pass = false;\n\n\tif(!opts) opts = {};\n\topts.biff = 12;\n\n\tvar Names = [];\n\tvar supbooks = ([[]]);\n\tsupbooks.SheetNames = [];\n\tsupbooks.XTI = [];\n\n\tXLSBRecordEnum[0x0010] = { n:\"BrtFRTArchID$\", f:parse_BrtFRTArchID$ };\n\n\trecordhopper(data, function hopper_wb(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x009C: /* 'BrtBundleSh' */\n\t\t\t\tsupbooks.SheetNames.push(val.name);\n\t\t\t\twb.Sheets.push(val); break;\n\n\t\t\tcase 0x0099: /* 'BrtWbProp' */\n\t\t\t\twb.WBProps = val; break;\n\n\t\t\tcase 0x0027: /* 'BrtName' */\n\t\t\t\tif(val.Sheet != null) opts.SID = val.Sheet;\n\t\t\t\tval.Ref = stringify_formula(val.Ptg, null, null, supbooks, opts);\n\t\t\t\tdelete opts.SID;\n\t\t\t\tdelete val.Ptg;\n\t\t\t\tNames.push(val);\n\t\t\t\tbreak;\n\t\t\tcase 0x040C: /* 'BrtNameExt' */ break;\n\n\t\t\tcase 0x0165: /* 'BrtSupSelf' */\n\t\t\tcase 0x0166: /* 'BrtSupSame' */\n\t\t\tcase 0x0163: /* 'BrtSupBookSrc' */\n\t\t\tcase 0x029B: /* 'BrtSupAddin' */\n\t\t\t\tif(!supbooks[0].length) supbooks[0] = [RT, val];\n\t\t\t\telse supbooks.push([RT, val]);\n\t\t\t\tsupbooks[supbooks.length - 1].XTI = [];\n\t\t\t\tbreak;\n\t\t\tcase 0x016A: /* 'BrtExternSheet' */\n\t\t\t\tif(supbooks.length === 0) { supbooks[0] = []; supbooks[0].XTI = []; }\n\t\t\t\tsupbooks[supbooks.length - 1].XTI = supbooks[supbooks.length - 1].XTI.concat(val);\n\t\t\t\tsupbooks.XTI = supbooks.XTI.concat(val);\n\t\t\t\tbreak;\n\t\t\tcase 0x0169: /* 'BrtPlaceholderName' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0817: /* 'BrtAbsPath15' */\n\t\t\tcase 0x009E: /* 'BrtBookView' */\n\t\t\tcase 0x008F: /* 'BrtBeginBundleShs' */\n\t\t\tcase 0x0298: /* 'BrtBeginFnGroup' */\n\t\t\tcase 0x0161: /* 'BrtBeginExternals' */\n\t\t\t\tbreak;\n\n\t\t\t/* case 'BrtModelTimeGroupingCalcCol' */\n\t\t\tcase 0x0C00: /* 'BrtUid' */\n\t\t\tcase 0x0C01: /* 'BrtRevisionPtr' */\n\t\t\tcase 0x0216: /* 'BrtBookProtection' */\n\t\t\tcase 0x02A5: /* 'BrtBookProtectionIso' */\n\t\t\tcase 0x009D: /* 'BrtCalcProp' */\n\t\t\tcase 0x0262: /* 'BrtCrashRecErr' */\n\t\t\tcase 0x0802: /* 'BrtDecoupledPivotCacheID' */\n\t\t\tcase 0x009B: /* 'BrtFileRecover' */\n\t\t\tcase 0x0224: /* 'BrtFileSharing' */\n\t\t\tcase 0x02A4: /* 'BrtFileSharingIso' */\n\t\t\tcase 0x0080: /* 'BrtFileVersion' */\n\t\t\tcase 0x0299: /* 'BrtFnGroup' */\n\t\t\tcase 0x0850: /* 'BrtModelRelationship' */\n\t\t\tcase 0x084D: /* 'BrtModelTable' */\n\t\t\tcase 0x0225: /* 'BrtOleSize' */\n\t\t\tcase 0x0805: /* 'BrtPivotTableRef' */\n\t\t\tcase 0x0254: /* 'BrtSmartTagType' */\n\t\t\tcase 0x081C: /* 'BrtTableSlicerCacheID' */\n\t\t\tcase 0x081B: /* 'BrtTableSlicerCacheIDs' */\n\t\t\tcase 0x0822: /* 'BrtTimelineCachePivotCacheID' */\n\t\t\tcase 0x018D: /* 'BrtUserBookView' */\n\t\t\tcase 0x009A: /* 'BrtWbFactoid' */\n\t\t\tcase 0x045D: /* 'BrtWbProp14' */\n\t\t\tcase 0x0229: /* 'BrtWebOpt' */\n\t\t\tcase 0x082B: /* 'BrtWorkBookPr15' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tstate.push(RT); pass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tstate.pop(); pass = false; break;\n\t\t\tcase 0x0025: /* 'BrtACBegin' */\n\t\t\t\tstate.push(RT); pass = true; break;\n\t\t\tcase 0x0026: /* 'BrtACEnd' */\n\t\t\t\tstate.pop(); pass = false; break;\n\n\t\t\tcase 0x0010: /* 'BrtFRTArchID$' */ break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){/* empty */}\n\t\t\t\telse if(!pass || (opts.WTF && state[state.length-1] != 0x0025 /* BrtACBegin */ && state[state.length-1] != 0x0023 /* BrtFRTBegin */)) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t}, opts);\n\n\tparse_wb_defaults(wb);\n\n\t// $FlowIgnore\n\twb.Names = Names;\n\n\t(wb).supbooks = supbooks;\n\treturn wb;\n}\n\nfunction write_BUNDLESHS(ba, wb) {\n\twrite_record(ba, 0x008F /* BrtBeginBundleShs */);\n\tfor(var idx = 0; idx != wb.SheetNames.length; ++idx) {\n\t\tvar viz = wb.Workbook && wb.Workbook.Sheets && wb.Workbook.Sheets[idx] && wb.Workbook.Sheets[idx].Hidden || 0;\n\t\tvar d = { Hidden: viz, iTabID: idx+1, strRelID: 'rId' + (idx+1), name: wb.SheetNames[idx] };\n\t\twrite_record(ba, 0x009C /* BrtBundleSh */, write_BrtBundleSh(d));\n\t}\n\twrite_record(ba, 0x0090 /* BrtEndBundleShs */);\n}\n\n/* [MS-XLSB] 2.4.649 BrtFileVersion */\nfunction write_BrtFileVersion(data, o) {\n\tif(!o) o = new_buf(127);\n\tfor(var i = 0; i != 4; ++i) o.write_shift(4, 0);\n\twrite_XLWideString(\"SheetJS\", o);\n\twrite_XLWideString(XLSX.version, o);\n\twrite_XLWideString(XLSX.version, o);\n\twrite_XLWideString(\"7262\", o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.301 BrtBookView */\nfunction write_BrtBookView(idx, o) {\n\tif(!o) o = new_buf(29);\n\to.write_shift(-4, 0);\n\to.write_shift(-4, 460);\n\to.write_shift(4,  28800);\n\to.write_shift(4,  17600);\n\to.write_shift(4,  500);\n\to.write_shift(4,  idx);\n\to.write_shift(4,  idx);\n\tvar flags = 0x78;\n\to.write_shift(1,  flags);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\nfunction write_BOOKVIEWS(ba, wb) {\n\t/* required if hidden tab appears before visible tab */\n\tif(!wb.Workbook || !wb.Workbook.Sheets) return;\n\tvar sheets = wb.Workbook.Sheets;\n\tvar i = 0, vistab = -1, hidden = -1;\n\tfor(; i < sheets.length; ++i) {\n\t\tif(!sheets[i] || !sheets[i].Hidden && vistab == -1) vistab = i;\n\t\telse if(sheets[i].Hidden == 1 && hidden == -1) hidden = i;\n\t}\n\tif(hidden > vistab) return;\n\twrite_record(ba, 0x0087 /* BrtBeginBookViews */);\n\twrite_record(ba, 0x009E /* BrtBookView */, write_BrtBookView(vistab));\n\t/* 1*(BrtBookView *FRT) */\n\twrite_record(ba, 0x0088 /* BrtEndBookViews */);\n}\n\n/* [MS-XLSB] 2.4.305 BrtCalcProp */\n/*function write_BrtCalcProp(data, o) {\n\tif(!o) o = new_buf(26);\n\to.write_shift(4,0); // force recalc\n\to.write_shift(4,1);\n\to.write_shift(4,0);\n\twrite_Xnum(0, o);\n\to.write_shift(-4, 1023);\n\to.write_shift(1, 0x33);\n\to.write_shift(1, 0x00);\n\treturn o;\n}*/\n\n/* [MS-XLSB] 2.4.646 BrtFileRecover */\n/*function write_BrtFileRecover(data, o) {\n\tif(!o) o = new_buf(1);\n\to.write_shift(1,0);\n\treturn o;\n}*/\n\n/* [MS-XLSB] 2.1.7.61 Workbook */\nfunction write_wb_bin(wb, opts) {\n\tvar ba = buf_array();\n\twrite_record(ba, 0x0083 /* BrtBeginBook */);\n\twrite_record(ba, 0x0080 /* BrtFileVersion */, write_BrtFileVersion());\n\t/* [[BrtFileSharingIso] BrtFileSharing] */\n\twrite_record(ba, 0x0099 /* BrtWbProp */, write_BrtWbProp(wb.Workbook && wb.Workbook.WBProps || null));\n\t/* [ACABSPATH] */\n\t/* [[BrtBookProtectionIso] BrtBookProtection] */\n\twrite_BOOKVIEWS(ba, wb, opts);\n\twrite_BUNDLESHS(ba, wb, opts);\n\t/* [FNGROUP] */\n\t/* [EXTERNALS] */\n\t/* *BrtName */\n\t/* write_record(ba, 0x009D BrtCalcProp, write_BrtCalcProp()); */\n\t/* [BrtOleSize] */\n\t/* *(BrtUserBookView *FRT) */\n\t/* [PIVOTCACHEIDS] */\n\t/* [BrtWbFactoid] */\n\t/* [SMARTTAGTYPES] */\n\t/* [BrtWebOpt] */\n\t/* write_record(ba, 0x009B BrtFileRecover, write_BrtFileRecover()); */\n\t/* [WEBPUBITEMS] */\n\t/* [CRERRS] */\n\t/* FRTWORKBOOK */\n\twrite_record(ba, 0x0084 /* BrtEndBook */);\n\n\treturn ba.end();\n}\nfunction parse_wb(data, name, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_wb_bin((data), opts);\n\treturn parse_wb_xml((data), opts);\n}\n\nfunction parse_ws(data, name, idx, opts, rels, wb, themes, styles) {\n\tif(name.slice(-4)===\".bin\") return parse_ws_bin((data), opts, idx, rels, wb, themes, styles);\n\treturn parse_ws_xml((data), opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_cs(data, name, idx, opts, rels, wb, themes, styles) {\n\tif(name.slice(-4)===\".bin\") return parse_cs_bin((data), opts, idx, rels, wb, themes, styles);\n\treturn parse_cs_xml((data), opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_ms(data, name, idx, opts, rels, wb, themes, styles) {\n\tif(name.slice(-4)===\".bin\") return parse_ms_bin((data), opts, idx, rels, wb, themes, styles);\n\treturn parse_ms_xml((data), opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_ds(data, name, idx, opts, rels, wb, themes, styles) {\n\tif(name.slice(-4)===\".bin\") return parse_ds_bin((data), opts, idx, rels, wb, themes, styles);\n\treturn parse_ds_xml((data), opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_sty(data, name, themes, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_sty_bin((data), themes, opts);\n\treturn parse_sty_xml((data), themes, opts);\n}\n\nfunction parse_theme(data, name, opts) {\n\treturn parse_theme_xml(data, opts);\n}\n\nfunction parse_sst(data, name, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_sst_bin((data), opts);\n\treturn parse_sst_xml((data), opts);\n}\n\nfunction parse_cmnt(data, name, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_comments_bin((data), opts);\n\treturn parse_comments_xml((data), opts);\n}\n\nfunction parse_cc(data, name, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_cc_bin((data), name, opts);\n\treturn parse_cc_xml((data), name, opts);\n}\n\nfunction parse_xlink(data, rel, name, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_xlink_bin((data), rel, name, opts);\n\treturn parse_xlink_xml((data), rel, name, opts);\n}\n\nfunction parse_xlmeta(data, name, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_xlmeta_bin((data), name, opts);\n\treturn parse_xlmeta_xml((data), name, opts);\n}\n\nfunction write_wb(wb, name, opts) {\n\treturn (name.slice(-4)===\".bin\" ? write_wb_bin : write_wb_xml)(wb, opts);\n}\n\nfunction write_ws(data, name, opts, wb, rels) {\n\treturn (name.slice(-4)===\".bin\" ? write_ws_bin : write_ws_xml)(data, opts, wb, rels);\n}\n\n// eslint-disable-next-line no-unused-vars\nfunction write_cs(data, name, opts, wb, rels) {\n\treturn (name.slice(-4)===\".bin\" ? write_cs_bin : write_cs_xml)(data, opts, wb, rels);\n}\n\nfunction write_sty(data, name, opts) {\n\treturn (name.slice(-4)===\".bin\" ? write_sty_bin : write_sty_xml)(data, opts);\n}\n\nfunction write_sst(data, name, opts) {\n\treturn (name.slice(-4)===\".bin\" ? write_sst_bin : write_sst_xml)(data, opts);\n}\n\nfunction write_cmnt(data, name, opts) {\n\treturn (name.slice(-4)===\".bin\" ? write_comments_bin : write_comments_xml)(data, opts);\n}\n/*\nfunction write_cc(data, name:string, opts) {\n\treturn (name.slice(-4)===\".bin\" ? write_cc_bin : write_cc_xml)(data, opts);\n}\n*/\n\nfunction write_xlmeta(name) {\n\treturn (name.slice(-4)===\".bin\" ? write_xlmeta_bin : write_xlmeta_xml)();\n}\nvar attregexg2=/([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\nvar attregex2=/([\\w:]+)=((?:\")(?:[^\"]*)(?:\")|(?:')(?:[^']*)(?:'))/;\nfunction xlml_parsexmltag(tag, skip_root) {\n\tvar words = tag.split(/\\s+/);\n\tvar z = ([]); if(!skip_root) z[0] = words[0];\n\tif(words.length === 1) return z;\n\tvar m = tag.match(attregexg2), y, j, w, i;\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\ty = m[i].match(attregex2);\nif((j=y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].slice(1,y[2].length-1);\n\t\telse {\n\t\t\tif(y[1].slice(0,6) === \"xmlns:\") w = \"xmlns\"+y[1].slice(6);\n\t\t\telse w = y[1].slice(j+1);\n\t\t\tz[w] = y[2].slice(1,y[2].length-1);\n\t\t}\n\t}\n\treturn z;\n}\nfunction xlml_parsexmltagobj(tag) {\n\tvar words = tag.split(/\\s+/);\n\tvar z = {};\n\tif(words.length === 1) return z;\n\tvar m = tag.match(attregexg2), y, j, w, i;\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\ty = m[i].match(attregex2);\nif((j=y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].slice(1,y[2].length-1);\n\t\telse {\n\t\t\tif(y[1].slice(0,6) === \"xmlns:\") w = \"xmlns\"+y[1].slice(6);\n\t\t\telse w = y[1].slice(j+1);\n\t\t\tz[w] = y[2].slice(1,y[2].length-1);\n\t\t}\n\t}\n\treturn z;\n}\n\n// ----\n\n/* map from xlml named formats to SSF TODO: localize */\nvar XLMLFormatMap;\n\nfunction xlml_format(format, value) {\n\tvar fmt = XLMLFormatMap[format] || unescapexml(format);\n\tif(fmt === \"General\") return SSF_general(value);\n\treturn SSF_format(fmt, value);\n}\n\nfunction xlml_set_custprop(Custprops, key, cp, val) {\n\tvar oval = val;\n\tswitch((cp[0].match(/dt:dt=\"([\\w.]+)\"/)||[\"\",\"\"])[1]) {\n\t\tcase \"boolean\": oval = parsexmlbool(val); break;\n\t\tcase \"i2\": case \"int\": oval = parseInt(val, 10); break;\n\t\tcase \"r4\": case \"float\": oval = parseFloat(val); break;\n\t\tcase \"date\": case \"dateTime.tz\": oval = parseDate(val); break;\n\t\tcase \"i8\": case \"string\": case \"fixed\": case \"uuid\": case \"bin.base64\": break;\n\t\tdefault: throw new Error(\"bad custprop:\" + cp[0]);\n\t}\n\tCustprops[unescapexml(key)] = oval;\n}\n\nfunction safe_format_xlml(cell, nf, o) {\n\tif(cell.t === 'z') return;\n\tif(!o || o.cellText !== false) try {\n\t\tif(cell.t === 'e') { cell.w = cell.w || BErr[cell.v]; }\n\t\telse if(nf === \"General\") {\n\t\t\tif(cell.t === 'n') {\n\t\t\t\tif((cell.v|0) === cell.v) cell.w = cell.v.toString(10);\n\t\t\t\telse cell.w = SSF_general_num(cell.v);\n\t\t\t}\n\t\t\telse cell.w = SSF_general(cell.v);\n\t\t}\n\t\telse cell.w = xlml_format(nf||\"General\", cell.v);\n\t} catch(e) { if(o.WTF) throw e; }\n\ttry {\n\t\tvar z = XLMLFormatMap[nf]||nf||\"General\";\n\t\tif(o.cellNF) cell.z = z;\n\t\tif(o.cellDates && cell.t == 'n' && fmt_is_date(z)) {\n\t\t\tvar _d = SSF_parse_date_code(cell.v); if(_d) { cell.t = 'd'; cell.v = new Date(_d.y, _d.m-1,_d.d,_d.H,_d.M,_d.S,_d.u); }\n\t\t}\n\t} catch(e) { if(o.WTF) throw e; }\n}\n\nfunction process_style_xlml(styles, stag, opts) {\n\tif(opts.cellStyles) {\n\t\tif(stag.Interior) {\n\t\t\tvar I = stag.Interior;\n\t\t\tif(I.Pattern) I.patternType = XLMLPatternTypeMap[I.Pattern] || I.Pattern;\n\t\t}\n\t}\n\tstyles[stag.ID] = stag;\n}\n\n/* TODO: there must exist some form of OSP-blessed spec */\nfunction parse_xlml_data(xml, ss, data, cell, base, styles, csty, row, arrayf, o) {\n\tvar nf = \"General\", sid = cell.StyleID, S = {}; o = o || {};\n\tvar interiors = [];\n\tvar i = 0;\n\tif(sid === undefined && row) sid = row.StyleID;\n\tif(sid === undefined && csty) sid = csty.StyleID;\n\twhile(styles[sid] !== undefined) {\n\t\tif(styles[sid].nf) nf = styles[sid].nf;\n\t\tif(styles[sid].Interior) interiors.push(styles[sid].Interior);\n\t\tif(!styles[sid].Parent) break;\n\t\tsid = styles[sid].Parent;\n\t}\n\tswitch(data.Type) {\n\t\tcase 'Boolean':\n\t\t\tcell.t = 'b';\n\t\t\tcell.v = parsexmlbool(xml);\n\t\t\tbreak;\n\t\tcase 'String':\n\t\t\tcell.t = 's'; cell.r = xlml_fixstr(unescapexml(xml));\n\t\t\tcell.v = (xml.indexOf(\"<\") > -1 ? unescapexml(ss||xml).replace(/<.*?>/g, \"\") : cell.r); // todo: BR etc\n\t\t\tbreak;\n\t\tcase 'DateTime':\n\t\t\tif(xml.slice(-1) != \"Z\") xml += \"Z\";\n\t\t\tcell.v = (parseDate(xml) - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n\t\t\tif(cell.v !== cell.v) cell.v = unescapexml(xml);\n\t\t\telse if(cell.v<60) cell.v = cell.v -1;\n\t\t\tif(!nf || nf == \"General\") nf = \"yyyy-mm-dd\";\n\t\t\t/* falls through */\n\t\tcase 'Number':\n\t\t\tif(cell.v === undefined) cell.v=+xml;\n\t\t\tif(!cell.t) cell.t = 'n';\n\t\t\tbreak;\n\t\tcase 'Error': cell.t = 'e'; cell.v = RBErr[xml]; if(o.cellText !== false) cell.w = xml; break;\n\t\tdefault:\n\t\t\tif(xml == \"\" && ss == \"\") { cell.t = 'z'; }\n\t\t\telse { cell.t = 's'; cell.v = xlml_fixstr(ss||xml); }\n\t\t\tbreak;\n\t}\n\tsafe_format_xlml(cell, nf, o);\n\tif(o.cellFormula !== false) {\n\t\tif(cell.Formula) {\n\t\t\tvar fstr = unescapexml(cell.Formula);\n\t\t\t/* strictly speaking, the leading = is required but some writers omit */\n\t\t\tif(fstr.charCodeAt(0) == 61 /* = */) fstr = fstr.slice(1);\n\t\t\tcell.f = rc_to_a1(fstr, base);\n\t\t\tdelete cell.Formula;\n\t\t\tif(cell.ArrayRange == \"RC\") cell.F = rc_to_a1(\"RC:RC\", base);\n\t\t\telse if(cell.ArrayRange) {\n\t\t\t\tcell.F = rc_to_a1(cell.ArrayRange, base);\n\t\t\t\tarrayf.push([safe_decode_range(cell.F), cell.F]);\n\t\t\t}\n\t\t} else {\n\t\t\tfor(i = 0; i < arrayf.length; ++i)\n\t\t\t\tif(base.r >= arrayf[i][0].s.r && base.r <= arrayf[i][0].e.r)\n\t\t\t\t\tif(base.c >= arrayf[i][0].s.c && base.c <= arrayf[i][0].e.c)\n\t\t\t\t\t\tcell.F = arrayf[i][1];\n\t\t}\n\t}\n\tif(o.cellStyles) {\n\t\tinteriors.forEach(function(x) {\n\t\t\tif(!S.patternType && x.patternType) S.patternType = x.patternType;\n\t\t});\n\t\tcell.s = S;\n\t}\n\tif(cell.StyleID !== undefined) cell.ixfe = cell.StyleID;\n}\n\nfunction xlml_clean_comment(comment) {\n\tcomment.t = comment.v || \"\";\n\tcomment.t = comment.t.replace(/\\r\\n/g,\"\\n\").replace(/\\r/g,\"\\n\");\n\tcomment.v = comment.w = comment.ixfe = undefined;\n}\n\n/* TODO: Everything */\nfunction parse_xlml_xml(d, _opts) {\n\tvar opts = _opts || {};\n\tmake_ssf();\n\tvar str = debom(xlml_normalize(d));\n\tif(opts.type == 'binary' || opts.type == 'array' || opts.type == 'base64') {\n\t\tif(typeof $cptable !== 'undefined') str = $cptable.utils.decode(65001, char_codes(str));\n\t\telse str = utf8read(str);\n\t}\n\tvar opening = str.slice(0, 1024).toLowerCase(), ishtml = false;\n\topening = opening.replace(/\".*?\"/g, \"\");\n\tif((opening.indexOf(\">\") & 1023) > Math.min((opening.indexOf(\",\") & 1023), (opening.indexOf(\";\")&1023))) { var _o = dup(opts); _o.type = \"string\"; return PRN.to_workbook(str, _o); }\n\tif(opening.indexOf(\"<?xml\") == -1) [\"html\", \"table\", \"head\", \"meta\", \"script\", \"style\", \"div\"].forEach(function(tag) { if(opening.indexOf(\"<\" + tag) >= 0) ishtml = true; });\n\tif(ishtml) return html_to_workbook(str, opts);\n\n\tXLMLFormatMap = ({\n\t\t\"General Number\": \"General\",\n\t\t\"General Date\": table_fmt[22],\n\t\t\"Long Date\": \"dddd, mmmm dd, yyyy\",\n\t\t\"Medium Date\": table_fmt[15],\n\t\t\"Short Date\": table_fmt[14],\n\t\t\"Long Time\": table_fmt[19],\n\t\t\"Medium Time\": table_fmt[18],\n\t\t\"Short Time\": table_fmt[20],\n\t\t\"Currency\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t\t\"Fixed\": table_fmt[2],\n\t\t\"Standard\": table_fmt[4],\n\t\t\"Percent\": table_fmt[10],\n\t\t\"Scientific\": table_fmt[11],\n\t\t\"Yes/No\": '\"Yes\";\"Yes\";\"No\";@',\n\t\t\"True/False\": '\"True\";\"True\";\"False\";@',\n\t\t\"On/Off\": '\"Yes\";\"Yes\";\"No\";@'\n\t});\n\n\n\tvar Rn;\n\tvar state = [], tmp;\n\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\tvar sheets = {}, sheetnames = [], cursheet = (opts.dense ? [] : {}), sheetname = \"\";\n\tvar cell = ({}), row = {};// eslint-disable-line no-unused-vars\n\tvar dtag = xlml_parsexmltag('<Data ss:Type=\"String\">'), didx = 0;\n\tvar c = 0, r = 0;\n\tvar refguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\tvar styles = {}, stag = {};\n\tvar ss = \"\", fidx = 0;\n\tvar merges = [];\n\tvar Props = {}, Custprops = {}, pidx = 0, cp = [];\n\tvar comments = [], comment = ({});\n\tvar cstys = [], csty, seencol = false;\n\tvar arrayf = [];\n\tvar rowinfo = [], rowobj = {}, cc = 0, rr = 0;\n\tvar Workbook = ({ Sheets:[], WBProps:{date1904:false} }), wsprops = {};\n\txlmlregex.lastIndex = 0;\n\tstr = str.replace(/<!--([\\s\\S]*?)-->/mg,\"\");\n\tvar raw_Rn3 = \"\";\n\twhile((Rn = xlmlregex.exec(str))) switch((Rn[3] = (raw_Rn3 = Rn[3]).toLowerCase())) {\n\t\tcase 'data' /*case 'Data'*/:\n\t\t\tif(raw_Rn3 == \"data\") {\n\t\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(state[state.length-1][1]) break;\n\t\t\tif(Rn[1]==='/') parse_xlml_data(str.slice(didx, Rn.index), ss, dtag, state[state.length-1][0]==/*\"Comment\"*/\"comment\"?comment:cell, {c:c,r:r}, styles, cstys[c], row, arrayf, opts);\n\t\t\telse { ss = \"\"; dtag = xlml_parsexmltag(Rn[0]); didx = Rn.index + Rn[0].length; }\n\t\t\tbreak;\n\t\tcase 'cell' /*case 'Cell'*/:\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif(comments.length > 0) cell.c = comments;\n\t\t\t\tif((!opts.sheetRows || opts.sheetRows > r) && cell.v !== undefined) {\n\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\tif(!cursheet[r]) cursheet[r] = [];\n\t\t\t\t\t\tcursheet[r][c] = cell;\n\t\t\t\t\t} else cursheet[encode_col(c) + encode_row(r)] = cell;\n\t\t\t\t}\n\t\t\t\tif(cell.HRef) {\n\t\t\t\t\tcell.l = ({Target:unescapexml(cell.HRef)});\n\t\t\t\t\tif(cell.HRefScreenTip) cell.l.Tooltip = cell.HRefScreenTip;\n\t\t\t\t\tdelete cell.HRef; delete cell.HRefScreenTip;\n\t\t\t\t}\n\t\t\t\tif(cell.MergeAcross || cell.MergeDown) {\n\t\t\t\t\tcc = c + (parseInt(cell.MergeAcross,10)|0);\n\t\t\t\t\trr = r + (parseInt(cell.MergeDown,10)|0);\n\t\t\t\t\tmerges.push({s:{c:c,r:r},e:{c:cc,r:rr}});\n\t\t\t\t}\n\t\t\t\tif(!opts.sheetStubs) { if(cell.MergeAcross) c = cc + 1; else ++c; }\n\t\t\t\telse if(cell.MergeAcross || cell.MergeDown) {\nfor(var cma = c; cma <= cc; ++cma) {\n\t\t\t\t\t\tfor(var cmd = r; cmd <= rr; ++cmd) {\n\t\t\t\t\t\t\tif(cma > c || cmd > r) {\n\t\t\t\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\t\t\t\tif(!cursheet[cmd]) cursheet[cmd] = [];\n\t\t\t\t\t\t\t\t\tcursheet[cmd][cma] = {t:'z'};\n\t\t\t\t\t\t\t\t} else cursheet[encode_col(cma) + encode_row(cmd)] = {t:'z'};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tc = cc + 1;\n\t\t\t\t}\n\t\t\t\telse ++c;\n\t\t\t} else {\n\t\t\t\tcell = xlml_parsexmltagobj(Rn[0]);\n\t\t\t\tif(cell.Index) c = +cell.Index - 1;\n\t\t\t\tif(c < refguess.s.c) refguess.s.c = c;\n\t\t\t\tif(c > refguess.e.c) refguess.e.c = c;\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") ++c;\n\t\t\t\tcomments = [];\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'row' /*case 'Row'*/:\n\t\t\tif(Rn[1]==='/' || Rn[0].slice(-2) === \"/>\") {\n\t\t\t\tif(r < refguess.s.r) refguess.s.r = r;\n\t\t\t\tif(r > refguess.e.r) refguess.e.r = r;\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") {\n\t\t\t\t\trow = xlml_parsexmltag(Rn[0]);\n\t\t\t\t\tif(row.Index) r = +row.Index - 1;\n\t\t\t\t}\n\t\t\t\tc = 0; ++r;\n\t\t\t} else {\n\t\t\t\trow = xlml_parsexmltag(Rn[0]);\n\t\t\t\tif(row.Index) r = +row.Index - 1;\n\t\t\t\trowobj = {};\n\t\t\t\tif(row.AutoFitHeight == \"0\" || row.Height) {\n\t\t\t\t\trowobj.hpx = parseInt(row.Height, 10); rowobj.hpt = px2pt(rowobj.hpx);\n\t\t\t\t\trowinfo[r] = rowobj;\n\t\t\t\t}\n\t\t\t\tif(row.Hidden == \"1\") { rowobj.hidden = true; rowinfo[r] = rowobj; }\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'worksheet' /*case 'Worksheet'*/: /* TODO: read range from FullRows/FullColumns */\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));\n\t\t\t\tsheetnames.push(sheetname);\n\t\t\t\tif(refguess.s.r <= refguess.e.r && refguess.s.c <= refguess.e.c) {\n\t\t\t\t\tcursheet[\"!ref\"] = encode_range(refguess);\n\t\t\t\t\tif(opts.sheetRows && opts.sheetRows <= refguess.e.r) {\n\t\t\t\t\t\tcursheet[\"!fullref\"] = cursheet[\"!ref\"];\n\t\t\t\t\t\trefguess.e.r = opts.sheetRows - 1;\n\t\t\t\t\t\tcursheet[\"!ref\"] = encode_range(refguess);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(merges.length) cursheet[\"!merges\"] = merges;\n\t\t\t\tif(cstys.length > 0) cursheet[\"!cols\"] = cstys;\n\t\t\t\tif(rowinfo.length > 0) cursheet[\"!rows\"] = rowinfo;\n\t\t\t\tsheets[sheetname] = cursheet;\n\t\t\t} else {\n\t\t\t\trefguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\t\t\t\tr = c = 0;\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\ttmp = xlml_parsexmltag(Rn[0]);\n\t\t\t\tsheetname = unescapexml(tmp.Name);\n\t\t\t\tcursheet = (opts.dense ? [] : {});\n\t\t\t\tmerges = [];\n\t\t\t\tarrayf = [];\n\t\t\t\trowinfo = [];\n\t\t\t\twsprops = {name:sheetname, Hidden:0};\n\t\t\t\tWorkbook.Sheets.push(wsprops);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'table' /*case 'Table'*/:\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\telse if(Rn[0].slice(-2) == \"/>\") break;\n\t\t\telse {\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\tcstys = []; seencol = false;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'style' /*case 'Style'*/:\n\t\t\tif(Rn[1]==='/') process_style_xlml(styles, stag, opts);\n\t\t\telse stag = xlml_parsexmltag(Rn[0]);\n\t\t\tbreak;\n\n\t\tcase 'numberformat' /*case 'NumberFormat'*/:\n\t\t\tstag.nf = unescapexml(xlml_parsexmltag(Rn[0]).Format || \"General\");\n\t\t\tif(XLMLFormatMap[stag.nf]) stag.nf = XLMLFormatMap[stag.nf];\n\t\t\tfor(var ssfidx = 0; ssfidx != 0x188; ++ssfidx) if(table_fmt[ssfidx] == stag.nf) break;\n\t\t\tif(ssfidx == 0x188) for(ssfidx = 0x39; ssfidx != 0x188; ++ssfidx) if(table_fmt[ssfidx] == null) { SSF_load(stag.nf, ssfidx); break; }\n\t\t\tbreak;\n\n\t\tcase 'column' /*case 'Column'*/:\n\t\t\tif(state[state.length-1][0] !== /*'Table'*/'table') break;\n\t\t\tcsty = xlml_parsexmltag(Rn[0]);\n\t\t\tif(csty.Hidden) { csty.hidden = true; delete csty.Hidden; }\n\t\t\tif(csty.Width) csty.wpx = parseInt(csty.Width, 10);\n\t\t\tif(!seencol && csty.wpx > 10) {\n\t\t\t\tseencol = true; MDW = DEF_MDW; //find_mdw_wpx(csty.wpx);\n\t\t\t\tfor(var _col = 0; _col < cstys.length; ++_col) if(cstys[_col]) process_col(cstys[_col]);\n\t\t\t}\n\t\t\tif(seencol) process_col(csty);\n\t\t\tcstys[(csty.Index-1||cstys.length)] = csty;\n\t\t\tfor(var i = 0; i < +csty.Span; ++i) cstys[cstys.length] = dup(csty);\n\t\t\tbreak;\n\n\t\tcase 'namedrange' /*case 'NamedRange'*/:\n\t\t\tif(Rn[1]==='/') break;\n\t\t\tif(!Workbook.Names) Workbook.Names = [];\n\t\t\tvar _NamedRange = parsexmltag(Rn[0]);\n\t\t\tvar _DefinedName = ({\n\t\t\t\tName: _NamedRange.Name,\n\t\t\t\tRef: rc_to_a1(_NamedRange.RefersTo.slice(1), {r:0, c:0})\n\t\t\t});\n\t\t\tif(Workbook.Sheets.length>0) _DefinedName.Sheet=Workbook.Sheets.length-1;\nWorkbook.Names.push(_DefinedName);\n\t\t\tbreak;\n\n\t\tcase 'namedcell' /*case 'NamedCell'*/: break;\n\t\tcase 'b' /*case 'B'*/: break;\n\t\tcase 'i' /*case 'I'*/: break;\n\t\tcase 'u' /*case 'U'*/: break;\n\t\tcase 's' /*case 'S'*/: break;\n\t\tcase 'em' /*case 'EM'*/: break;\n\t\tcase 'h2' /*case 'H2'*/: break;\n\t\tcase 'h3' /*case 'H3'*/: break;\n\t\tcase 'sub' /*case 'Sub'*/: break;\n\t\tcase 'sup' /*case 'Sup'*/: break;\n\t\tcase 'span' /*case 'Span'*/: break;\n\t\tcase 'alignment' /*case 'Alignment'*/:\n\t\t\tbreak;\n\t\tcase 'borders' /*case 'Borders'*/: break;\n\t\tcase 'border' /*case 'Border'*/: break;\n\t\tcase 'font' /*case 'Font'*/:\n\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\telse if(Rn[1]===\"/\") ss += str.slice(fidx, Rn.index);\n\t\t\telse fidx = Rn.index + Rn[0].length;\n\t\t\tbreak;\n\t\tcase 'interior' /*case 'Interior'*/:\n\t\t\tif(!opts.cellStyles) break;\n\t\t\tstag.Interior = xlml_parsexmltag(Rn[0]);\n\t\t\tbreak;\n\t\tcase 'protection' /*case 'Protection'*/: break;\n\n\t\tcase 'author' /*case 'Author'*/:\n\t\tcase 'title' /*case 'Title'*/:\n\t\tcase 'description' /*case 'Description'*/:\n\t\tcase 'created' /*case 'Created'*/:\n\t\tcase 'keywords' /*case 'Keywords'*/:\n\t\tcase 'subject' /*case 'Subject'*/:\n\t\tcase 'category' /*case 'Category'*/:\n\t\tcase 'company' /*case 'Company'*/:\n\t\tcase 'lastauthor' /*case 'LastAuthor'*/:\n\t\tcase 'lastsaved' /*case 'LastSaved'*/:\n\t\tcase 'lastprinted' /*case 'LastPrinted'*/:\n\t\tcase 'version' /*case 'Version'*/:\n\t\tcase 'revision' /*case 'Revision'*/:\n\t\tcase 'totaltime' /*case 'TotalTime'*/:\n\t\tcase 'hyperlinkbase' /*case 'HyperlinkBase'*/:\n\t\tcase 'manager' /*case 'Manager'*/:\n\t\tcase 'contentstatus' /*case 'ContentStatus'*/:\n\t\tcase 'identifier' /*case 'Identifier'*/:\n\t\tcase 'language' /*case 'Language'*/:\n\t\tcase 'appname' /*case 'AppName'*/:\n\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\telse if(Rn[1]===\"/\") xlml_set_prop(Props, raw_Rn3, str.slice(pidx, Rn.index));\n\t\t\telse pidx = Rn.index + Rn[0].length;\n\t\t\tbreak;\n\t\tcase 'paragraphs' /*case 'Paragraphs'*/: break;\n\n\t\tcase 'styles' /*case 'Styles'*/:\n\t\tcase 'workbook' /*case 'Workbook'*/:\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\telse state.push([Rn[3], false]);\n\t\t\tbreak;\n\n\t\tcase 'comment' /*case 'Comment'*/:\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));\n\t\t\t\txlml_clean_comment(comment);\n\t\t\t\tcomments.push(comment);\n\t\t\t} else {\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\ttmp = xlml_parsexmltag(Rn[0]);\n\t\t\t\tcomment = ({a:tmp.Author});\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'autofilter' /*case 'AutoFilter'*/:\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\tvar AutoFilter = xlml_parsexmltag(Rn[0]);\n\t\t\t\tcursheet['!autofilter'] = { ref:rc_to_a1(AutoFilter.Range).replace(/\\$/g,\"\") };\n\t\t\t\tstate.push([Rn[3], true]);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'name' /*case 'Name'*/: break;\n\n\t\tcase 'datavalidation' /*case 'DataValidation'*/:\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));\n\t\t\t} else {\n\t\t\t\tif(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'pixelsperinch' /*case 'PixelsPerInch'*/:\n\t\t\tbreak;\n\t\tcase 'componentoptions' /*case 'ComponentOptions'*/:\n\t\tcase 'documentproperties' /*case 'DocumentProperties'*/:\n\t\tcase 'customdocumentproperties' /*case 'CustomDocumentProperties'*/:\n\t\tcase 'officedocumentsettings' /*case 'OfficeDocumentSettings'*/:\n\t\tcase 'pivottable' /*case 'PivotTable'*/:\n\t\tcase 'pivotcache' /*case 'PivotCache'*/:\n\t\tcase 'names' /*case 'Names'*/:\n\t\tcase 'mapinfo' /*case 'MapInfo'*/:\n\t\tcase 'pagebreaks' /*case 'PageBreaks'*/:\n\t\tcase 'querytable' /*case 'QueryTable'*/:\n\t\tcase 'sorting' /*case 'Sorting'*/:\n\t\tcase 'schema' /*case 'Schema'*/: //case 'data' /*case 'data'*/:\n\t\tcase 'conditionalformatting' /*case 'ConditionalFormatting'*/:\n\t\tcase 'smarttagtype' /*case 'SmartTagType'*/:\n\t\tcase 'smarttags' /*case 'SmartTags'*/:\n\t\tcase 'excelworkbook' /*case 'ExcelWorkbook'*/:\n\t\tcase 'workbookoptions' /*case 'WorkbookOptions'*/:\n\t\tcase 'worksheetoptions' /*case 'WorksheetOptions'*/:\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\tbreak;\n\n\t\tcase 'null' /*case 'Null'*/: break;\n\n\t\tdefault:\n\t\t\t/* FODS file root is <office:document> */\n\t\t\tif(state.length == 0 && Rn[3] == \"document\") return parse_fods(str, opts);\n\t\t\t/* UOS file root is <uof:UOF> */\n\t\t\tif(state.length == 0 && Rn[3] == \"uof\"/*\"UOF\"*/) return parse_fods(str, opts);\n\n\t\t\tvar seen = true;\n\t\t\tswitch(state[state.length-1][0]) {\n\t\t\t\t/* OfficeDocumentSettings */\n\t\t\t\tcase 'officedocumentsettings' /*case 'OfficeDocumentSettings'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'allowpng' /*case 'AllowPNG'*/: break;\n\t\t\t\t\tcase 'removepersonalinformation' /*case 'RemovePersonalInformation'*/: break;\n\t\t\t\t\tcase 'downloadcomponents' /*case 'DownloadComponents'*/: break;\n\t\t\t\t\tcase 'locationofcomponents' /*case 'LocationOfComponents'*/: break;\n\t\t\t\t\tcase 'colors' /*case 'Colors'*/: break;\n\t\t\t\t\tcase 'color' /*case 'Color'*/: break;\n\t\t\t\t\tcase 'index' /*case 'Index'*/: break;\n\t\t\t\t\tcase 'rgb' /*case 'RGB'*/: break;\n\t\t\t\t\tcase 'targetscreensize' /*case 'TargetScreenSize'*/: break;\n\t\t\t\t\tcase 'readonlyrecommended' /*case 'ReadOnlyRecommended'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* ComponentOptions */\n\t\t\t\tcase 'componentoptions' /*case 'ComponentOptions'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'toolbar' /*case 'Toolbar'*/: break;\n\t\t\t\t\tcase 'hideofficelogo' /*case 'HideOfficeLogo'*/: break;\n\t\t\t\t\tcase 'spreadsheetautofit' /*case 'SpreadsheetAutoFit'*/: break;\n\t\t\t\t\tcase 'label' /*case 'Label'*/: break;\n\t\t\t\t\tcase 'caption' /*case 'Caption'*/: break;\n\t\t\t\t\tcase 'maxheight' /*case 'MaxHeight'*/: break;\n\t\t\t\t\tcase 'maxwidth' /*case 'MaxWidth'*/: break;\n\t\t\t\t\tcase 'nextsheetnumber' /*case 'NextSheetNumber'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* ExcelWorkbook */\n\t\t\t\tcase 'excelworkbook' /*case 'ExcelWorkbook'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'date1904' /*case 'Date1904'*/:\nWorkbook.WBProps.date1904 = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'windowheight' /*case 'WindowHeight'*/: break;\n\t\t\t\t\tcase 'windowwidth' /*case 'WindowWidth'*/: break;\n\t\t\t\t\tcase 'windowtopx' /*case 'WindowTopX'*/: break;\n\t\t\t\t\tcase 'windowtopy' /*case 'WindowTopY'*/: break;\n\t\t\t\t\tcase 'tabratio' /*case 'TabRatio'*/: break;\n\t\t\t\t\tcase 'protectstructure' /*case 'ProtectStructure'*/: break;\n\t\t\t\t\tcase 'protectwindow' /*case 'ProtectWindow'*/: break;\n\t\t\t\t\tcase 'protectwindows' /*case 'ProtectWindows'*/: break;\n\t\t\t\t\tcase 'activesheet' /*case 'ActiveSheet'*/: break;\n\t\t\t\t\tcase 'displayinknotes' /*case 'DisplayInkNotes'*/: break;\n\t\t\t\t\tcase 'firstvisiblesheet' /*case 'FirstVisibleSheet'*/: break;\n\t\t\t\t\tcase 'supbook' /*case 'SupBook'*/: break;\n\t\t\t\t\tcase 'sheetname' /*case 'SheetName'*/: break;\n\t\t\t\t\tcase 'sheetindex' /*case 'SheetIndex'*/: break;\n\t\t\t\t\tcase 'sheetindexfirst' /*case 'SheetIndexFirst'*/: break;\n\t\t\t\t\tcase 'sheetindexlast' /*case 'SheetIndexLast'*/: break;\n\t\t\t\t\tcase 'dll' /*case 'Dll'*/: break;\n\t\t\t\t\tcase 'acceptlabelsinformulas' /*case 'AcceptLabelsInFormulas'*/: break;\n\t\t\t\t\tcase 'donotsavelinkvalues' /*case 'DoNotSaveLinkValues'*/: break;\n\t\t\t\t\tcase 'iteration' /*case 'Iteration'*/: break;\n\t\t\t\t\tcase 'maxiterations' /*case 'MaxIterations'*/: break;\n\t\t\t\t\tcase 'maxchange' /*case 'MaxChange'*/: break;\n\t\t\t\t\tcase 'path' /*case 'Path'*/: break;\n\t\t\t\t\tcase 'xct' /*case 'Xct'*/: break;\n\t\t\t\t\tcase 'count' /*case 'Count'*/: break;\n\t\t\t\t\tcase 'selectedsheets' /*case 'SelectedSheets'*/: break;\n\t\t\t\t\tcase 'calculation' /*case 'Calculation'*/: break;\n\t\t\t\t\tcase 'uncalced' /*case 'Uncalced'*/: break;\n\t\t\t\t\tcase 'startupprompt' /*case 'StartupPrompt'*/: break;\n\t\t\t\t\tcase 'crn' /*case 'Crn'*/: break;\n\t\t\t\t\tcase 'externname' /*case 'ExternName'*/: break;\n\t\t\t\t\tcase 'formula' /*case 'Formula'*/: break;\n\t\t\t\t\tcase 'colfirst' /*case 'ColFirst'*/: break;\n\t\t\t\t\tcase 'collast' /*case 'ColLast'*/: break;\n\t\t\t\t\tcase 'wantadvise' /*case 'WantAdvise'*/: break;\n\t\t\t\t\tcase 'boolean' /*case 'Boolean'*/: break;\n\t\t\t\t\tcase 'error' /*case 'Error'*/: break;\n\t\t\t\t\tcase 'text' /*case 'Text'*/: break;\n\t\t\t\t\tcase 'ole' /*case 'OLE'*/: break;\n\t\t\t\t\tcase 'noautorecover' /*case 'NoAutoRecover'*/: break;\n\t\t\t\t\tcase 'publishobjects' /*case 'PublishObjects'*/: break;\n\t\t\t\t\tcase 'donotcalculatebeforesave' /*case 'DoNotCalculateBeforeSave'*/: break;\n\t\t\t\t\tcase 'number' /*case 'Number'*/: break;\n\t\t\t\t\tcase 'refmoder1c1' /*case 'RefModeR1C1'*/: break;\n\t\t\t\t\tcase 'embedsavesmarttags' /*case 'EmbedSaveSmartTags'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* WorkbookOptions */\n\t\t\t\tcase 'workbookoptions' /*case 'WorkbookOptions'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'owcversion' /*case 'OWCVersion'*/: break;\n\t\t\t\t\tcase 'height' /*case 'Height'*/: break;\n\t\t\t\t\tcase 'width' /*case 'Width'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* WorksheetOptions */\n\t\t\t\tcase 'worksheetoptions' /*case 'WorksheetOptions'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'visible' /*case 'Visible'*/:\n\t\t\t\t\t\tif(Rn[0].slice(-2) === \"/>\"){/* empty */}\n\t\t\t\t\t\telse if(Rn[1]===\"/\") switch(str.slice(pidx, Rn.index)) {\n\t\t\t\t\t\t\tcase \"SheetHidden\": wsprops.Hidden = 1; break;\n\t\t\t\t\t\t\tcase \"SheetVeryHidden\": wsprops.Hidden = 2; break;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse pidx = Rn.index + Rn[0].length;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'header' /*case 'Header'*/:\n\t\t\t\t\t\tif(!cursheet['!margins']) default_margins(cursheet['!margins']={}, 'xlml');\n\t\t\t\t\t\tif(!isNaN(+parsexmltag(Rn[0]).Margin)) cursheet['!margins'].header = +parsexmltag(Rn[0]).Margin;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'footer' /*case 'Footer'*/:\n\t\t\t\t\t\tif(!cursheet['!margins']) default_margins(cursheet['!margins']={}, 'xlml');\n\t\t\t\t\t\tif(!isNaN(+parsexmltag(Rn[0]).Margin)) cursheet['!margins'].footer = +parsexmltag(Rn[0]).Margin;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'pagemargins' /*case 'PageMargins'*/:\n\t\t\t\t\t\tvar pagemargins = parsexmltag(Rn[0]);\n\t\t\t\t\t\tif(!cursheet['!margins']) default_margins(cursheet['!margins']={},'xlml');\n\t\t\t\t\t\tif(!isNaN(+pagemargins.Top)) cursheet['!margins'].top = +pagemargins.Top;\n\t\t\t\t\t\tif(!isNaN(+pagemargins.Left)) cursheet['!margins'].left = +pagemargins.Left;\n\t\t\t\t\t\tif(!isNaN(+pagemargins.Right)) cursheet['!margins'].right = +pagemargins.Right;\n\t\t\t\t\t\tif(!isNaN(+pagemargins.Bottom)) cursheet['!margins'].bottom = +pagemargins.Bottom;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'displayrighttoleft' /*case 'DisplayRightToLeft'*/:\n\t\t\t\t\t\tif(!Workbook.Views) Workbook.Views = [];\n\t\t\t\t\t\tif(!Workbook.Views[0]) Workbook.Views[0] = {};\n\t\t\t\t\t\tWorkbook.Views[0].RTL = true;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'freezepanes' /*case 'FreezePanes'*/: break;\n\t\t\t\t\tcase 'frozennosplit' /*case 'FrozenNoSplit'*/: break;\n\n\t\t\t\t\tcase 'splithorizontal' /*case 'SplitHorizontal'*/:\n\t\t\t\t\tcase 'splitvertical' /*case 'SplitVertical'*/:\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'donotdisplaygridlines' /*case 'DoNotDisplayGridlines'*/:\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'activerow' /*case 'ActiveRow'*/: break;\n\t\t\t\t\tcase 'activecol' /*case 'ActiveCol'*/: break;\n\t\t\t\t\tcase 'toprowbottompane' /*case 'TopRowBottomPane'*/: break;\n\t\t\t\t\tcase 'leftcolumnrightpane' /*case 'LeftColumnRightPane'*/: break;\n\n\t\t\t\t\tcase 'unsynced' /*case 'Unsynced'*/: break;\n\t\t\t\t\tcase 'print' /*case 'Print'*/: break;\n\t\t\t\t\tcase 'printerrors' /*case 'PrintErrors'*/: break;\n\t\t\t\t\tcase 'panes' /*case 'Panes'*/: break;\n\t\t\t\t\tcase 'scale' /*case 'Scale'*/: break;\n\t\t\t\t\tcase 'pane' /*case 'Pane'*/: break;\n\t\t\t\t\tcase 'number' /*case 'Number'*/: break;\n\t\t\t\t\tcase 'layout' /*case 'Layout'*/: break;\n\t\t\t\t\tcase 'pagesetup' /*case 'PageSetup'*/: break;\n\t\t\t\t\tcase 'selected' /*case 'Selected'*/: break;\n\t\t\t\t\tcase 'protectobjects' /*case 'ProtectObjects'*/: break;\n\t\t\t\t\tcase 'enableselection' /*case 'EnableSelection'*/: break;\n\t\t\t\t\tcase 'protectscenarios' /*case 'ProtectScenarios'*/: break;\n\t\t\t\t\tcase 'validprinterinfo' /*case 'ValidPrinterInfo'*/: break;\n\t\t\t\t\tcase 'horizontalresolution' /*case 'HorizontalResolution'*/: break;\n\t\t\t\t\tcase 'verticalresolution' /*case 'VerticalResolution'*/: break;\n\t\t\t\t\tcase 'numberofcopies' /*case 'NumberofCopies'*/: break;\n\t\t\t\t\tcase 'activepane' /*case 'ActivePane'*/: break;\n\t\t\t\t\tcase 'toprowvisible' /*case 'TopRowVisible'*/: break;\n\t\t\t\t\tcase 'leftcolumnvisible' /*case 'LeftColumnVisible'*/: break;\n\t\t\t\t\tcase 'fittopage' /*case 'FitToPage'*/: break;\n\t\t\t\t\tcase 'rangeselection' /*case 'RangeSelection'*/: break;\n\t\t\t\t\tcase 'papersizeindex' /*case 'PaperSizeIndex'*/: break;\n\t\t\t\t\tcase 'pagelayoutzoom' /*case 'PageLayoutZoom'*/: break;\n\t\t\t\t\tcase 'pagebreakzoom' /*case 'PageBreakZoom'*/: break;\n\t\t\t\t\tcase 'filteron' /*case 'FilterOn'*/: break;\n\t\t\t\t\tcase 'fitwidth' /*case 'FitWidth'*/: break;\n\t\t\t\t\tcase 'fitheight' /*case 'FitHeight'*/: break;\n\t\t\t\t\tcase 'commentslayout' /*case 'CommentsLayout'*/: break;\n\t\t\t\t\tcase 'zoom' /*case 'Zoom'*/: break;\n\t\t\t\t\tcase 'lefttoright' /*case 'LeftToRight'*/: break;\n\t\t\t\t\tcase 'gridlines' /*case 'Gridlines'*/: break;\n\t\t\t\t\tcase 'allowsort' /*case 'AllowSort'*/: break;\n\t\t\t\t\tcase 'allowfilter' /*case 'AllowFilter'*/: break;\n\t\t\t\t\tcase 'allowinsertrows' /*case 'AllowInsertRows'*/: break;\n\t\t\t\t\tcase 'allowdeleterows' /*case 'AllowDeleteRows'*/: break;\n\t\t\t\t\tcase 'allowinsertcols' /*case 'AllowInsertCols'*/: break;\n\t\t\t\t\tcase 'allowdeletecols' /*case 'AllowDeleteCols'*/: break;\n\t\t\t\t\tcase 'allowinserthyperlinks' /*case 'AllowInsertHyperlinks'*/: break;\n\t\t\t\t\tcase 'allowformatcells' /*case 'AllowFormatCells'*/: break;\n\t\t\t\t\tcase 'allowsizecols' /*case 'AllowSizeCols'*/: break;\n\t\t\t\t\tcase 'allowsizerows' /*case 'AllowSizeRows'*/: break;\n\t\t\t\t\tcase 'nosummaryrowsbelowdetail' /*case 'NoSummaryRowsBelowDetail'*/:\n\t\t\t\t\t\tif(!cursheet[\"!outline\"]) cursheet[\"!outline\"] = {};\n\t\t\t\t\t\tcursheet[\"!outline\"].above = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'tabcolorindex' /*case 'TabColorIndex'*/: break;\n\t\t\t\t\tcase 'donotdisplayheadings' /*case 'DoNotDisplayHeadings'*/: break;\n\t\t\t\t\tcase 'showpagelayoutzoom' /*case 'ShowPageLayoutZoom'*/: break;\n\t\t\t\t\tcase 'nosummarycolumnsrightdetail' /*case 'NoSummaryColumnsRightDetail'*/:\n\t\t\t\t\t\tif(!cursheet[\"!outline\"]) cursheet[\"!outline\"] = {};\n\t\t\t\t\t\tcursheet[\"!outline\"].left = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'blackandwhite' /*case 'BlackAndWhite'*/: break;\n\t\t\t\t\tcase 'donotdisplayzeros' /*case 'DoNotDisplayZeros'*/: break;\n\t\t\t\t\tcase 'displaypagebreak' /*case 'DisplayPageBreak'*/: break;\n\t\t\t\t\tcase 'rowcolheadings' /*case 'RowColHeadings'*/: break;\n\t\t\t\t\tcase 'donotdisplayoutline' /*case 'DoNotDisplayOutline'*/: break;\n\t\t\t\t\tcase 'noorientation' /*case 'NoOrientation'*/: break;\n\t\t\t\t\tcase 'allowusepivottables' /*case 'AllowUsePivotTables'*/: break;\n\t\t\t\t\tcase 'zeroheight' /*case 'ZeroHeight'*/: break;\n\t\t\t\t\tcase 'viewablerange' /*case 'ViewableRange'*/: break;\n\t\t\t\t\tcase 'selection' /*case 'Selection'*/: break;\n\t\t\t\t\tcase 'protectcontents' /*case 'ProtectContents'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* PivotTable */\n\t\t\t\tcase 'pivottable' /*case 'PivotTable'*/: case 'pivotcache' /*case 'PivotCache'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'immediateitemsondrop' /*case 'ImmediateItemsOnDrop'*/: break;\n\t\t\t\t\tcase 'showpagemultipleitemlabel' /*case 'ShowPageMultipleItemLabel'*/: break;\n\t\t\t\t\tcase 'compactrowindent' /*case 'CompactRowIndent'*/: break;\n\t\t\t\t\tcase 'location' /*case 'Location'*/: break;\n\t\t\t\t\tcase 'pivotfield' /*case 'PivotField'*/: break;\n\t\t\t\t\tcase 'orientation' /*case 'Orientation'*/: break;\n\t\t\t\t\tcase 'layoutform' /*case 'LayoutForm'*/: break;\n\t\t\t\t\tcase 'layoutsubtotallocation' /*case 'LayoutSubtotalLocation'*/: break;\n\t\t\t\t\tcase 'layoutcompactrow' /*case 'LayoutCompactRow'*/: break;\n\t\t\t\t\tcase 'position' /*case 'Position'*/: break;\n\t\t\t\t\tcase 'pivotitem' /*case 'PivotItem'*/: break;\n\t\t\t\t\tcase 'datatype' /*case 'DataType'*/: break;\n\t\t\t\t\tcase 'datafield' /*case 'DataField'*/: break;\n\t\t\t\t\tcase 'sourcename' /*case 'SourceName'*/: break;\n\t\t\t\t\tcase 'parentfield' /*case 'ParentField'*/: break;\n\t\t\t\t\tcase 'ptlineitems' /*case 'PTLineItems'*/: break;\n\t\t\t\t\tcase 'ptlineitem' /*case 'PTLineItem'*/: break;\n\t\t\t\t\tcase 'countofsameitems' /*case 'CountOfSameItems'*/: break;\n\t\t\t\t\tcase 'item' /*case 'Item'*/: break;\n\t\t\t\t\tcase 'itemtype' /*case 'ItemType'*/: break;\n\t\t\t\t\tcase 'ptsource' /*case 'PTSource'*/: break;\n\t\t\t\t\tcase 'cacheindex' /*case 'CacheIndex'*/: break;\n\t\t\t\t\tcase 'consolidationreference' /*case 'ConsolidationReference'*/: break;\n\t\t\t\t\tcase 'filename' /*case 'FileName'*/: break;\n\t\t\t\t\tcase 'reference' /*case 'Reference'*/: break;\n\t\t\t\t\tcase 'nocolumngrand' /*case 'NoColumnGrand'*/: break;\n\t\t\t\t\tcase 'norowgrand' /*case 'NoRowGrand'*/: break;\n\t\t\t\t\tcase 'blanklineafteritems' /*case 'BlankLineAfterItems'*/: break;\n\t\t\t\t\tcase 'hidden' /*case 'Hidden'*/: break;\n\t\t\t\t\tcase 'subtotal' /*case 'Subtotal'*/: break;\n\t\t\t\t\tcase 'basefield' /*case 'BaseField'*/: break;\n\t\t\t\t\tcase 'mapchilditems' /*case 'MapChildItems'*/: break;\n\t\t\t\t\tcase 'function' /*case 'Function'*/: break;\n\t\t\t\t\tcase 'refreshonfileopen' /*case 'RefreshOnFileOpen'*/: break;\n\t\t\t\t\tcase 'printsettitles' /*case 'PrintSetTitles'*/: break;\n\t\t\t\t\tcase 'mergelabels' /*case 'MergeLabels'*/: break;\n\t\t\t\t\tcase 'defaultversion' /*case 'DefaultVersion'*/: break;\n\t\t\t\t\tcase 'refreshname' /*case 'RefreshName'*/: break;\n\t\t\t\t\tcase 'refreshdate' /*case 'RefreshDate'*/: break;\n\t\t\t\t\tcase 'refreshdatecopy' /*case 'RefreshDateCopy'*/: break;\n\t\t\t\t\tcase 'versionlastrefresh' /*case 'VersionLastRefresh'*/: break;\n\t\t\t\t\tcase 'versionlastupdate' /*case 'VersionLastUpdate'*/: break;\n\t\t\t\t\tcase 'versionupdateablemin' /*case 'VersionUpdateableMin'*/: break;\n\t\t\t\t\tcase 'versionrefreshablemin' /*case 'VersionRefreshableMin'*/: break;\n\t\t\t\t\tcase 'calculation' /*case 'Calculation'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* PageBreaks */\n\t\t\t\tcase 'pagebreaks' /*case 'PageBreaks'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'colbreaks' /*case 'ColBreaks'*/: break;\n\t\t\t\t\tcase 'colbreak' /*case 'ColBreak'*/: break;\n\t\t\t\t\tcase 'rowbreaks' /*case 'RowBreaks'*/: break;\n\t\t\t\t\tcase 'rowbreak' /*case 'RowBreak'*/: break;\n\t\t\t\t\tcase 'colstart' /*case 'ColStart'*/: break;\n\t\t\t\t\tcase 'colend' /*case 'ColEnd'*/: break;\n\t\t\t\t\tcase 'rowend' /*case 'RowEnd'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* AutoFilter */\n\t\t\t\tcase 'autofilter' /*case 'AutoFilter'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'autofiltercolumn' /*case 'AutoFilterColumn'*/: break;\n\t\t\t\t\tcase 'autofiltercondition' /*case 'AutoFilterCondition'*/: break;\n\t\t\t\t\tcase 'autofilterand' /*case 'AutoFilterAnd'*/: break;\n\t\t\t\t\tcase 'autofilteror' /*case 'AutoFilterOr'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* QueryTable */\n\t\t\t\tcase 'querytable' /*case 'QueryTable'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'id' /*case 'Id'*/: break;\n\t\t\t\t\tcase 'autoformatfont' /*case 'AutoFormatFont'*/: break;\n\t\t\t\t\tcase 'autoformatpattern' /*case 'AutoFormatPattern'*/: break;\n\t\t\t\t\tcase 'querysource' /*case 'QuerySource'*/: break;\n\t\t\t\t\tcase 'querytype' /*case 'QueryType'*/: break;\n\t\t\t\t\tcase 'enableredirections' /*case 'EnableRedirections'*/: break;\n\t\t\t\t\tcase 'refreshedinxl9' /*case 'RefreshedInXl9'*/: break;\n\t\t\t\t\tcase 'urlstring' /*case 'URLString'*/: break;\n\t\t\t\t\tcase 'htmltables' /*case 'HTMLTables'*/: break;\n\t\t\t\t\tcase 'connection' /*case 'Connection'*/: break;\n\t\t\t\t\tcase 'commandtext' /*case 'CommandText'*/: break;\n\t\t\t\t\tcase 'refreshinfo' /*case 'RefreshInfo'*/: break;\n\t\t\t\t\tcase 'notitles' /*case 'NoTitles'*/: break;\n\t\t\t\t\tcase 'nextid' /*case 'NextId'*/: break;\n\t\t\t\t\tcase 'columninfo' /*case 'ColumnInfo'*/: break;\n\t\t\t\t\tcase 'overwritecells' /*case 'OverwriteCells'*/: break;\n\t\t\t\t\tcase 'donotpromptforfile' /*case 'DoNotPromptForFile'*/: break;\n\t\t\t\t\tcase 'textwizardsettings' /*case 'TextWizardSettings'*/: break;\n\t\t\t\t\tcase 'source' /*case 'Source'*/: break;\n\t\t\t\t\tcase 'number' /*case 'Number'*/: break;\n\t\t\t\t\tcase 'decimal' /*case 'Decimal'*/: break;\n\t\t\t\t\tcase 'thousandseparator' /*case 'ThousandSeparator'*/: break;\n\t\t\t\t\tcase 'trailingminusnumbers' /*case 'TrailingMinusNumbers'*/: break;\n\t\t\t\t\tcase 'formatsettings' /*case 'FormatSettings'*/: break;\n\t\t\t\t\tcase 'fieldtype' /*case 'FieldType'*/: break;\n\t\t\t\t\tcase 'delimiters' /*case 'Delimiters'*/: break;\n\t\t\t\t\tcase 'tab' /*case 'Tab'*/: break;\n\t\t\t\t\tcase 'comma' /*case 'Comma'*/: break;\n\t\t\t\t\tcase 'autoformatname' /*case 'AutoFormatName'*/: break;\n\t\t\t\t\tcase 'versionlastedit' /*case 'VersionLastEdit'*/: break;\n\t\t\t\t\tcase 'versionlastrefresh' /*case 'VersionLastRefresh'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\tcase 'datavalidation' /*case 'DataValidation'*/:\n\t\t\t\tswitch(Rn[3]) {\n\t\t\t\t\tcase 'range' /*case 'Range'*/: break;\n\n\t\t\t\t\tcase 'type' /*case 'Type'*/: break;\n\t\t\t\t\tcase 'min' /*case 'Min'*/: break;\n\t\t\t\t\tcase 'max' /*case 'Max'*/: break;\n\t\t\t\t\tcase 'sort' /*case 'Sort'*/: break;\n\t\t\t\t\tcase 'descending' /*case 'Descending'*/: break;\n\t\t\t\t\tcase 'order' /*case 'Order'*/: break;\n\t\t\t\t\tcase 'casesensitive' /*case 'CaseSensitive'*/: break;\n\t\t\t\t\tcase 'value' /*case 'Value'*/: break;\n\t\t\t\t\tcase 'errorstyle' /*case 'ErrorStyle'*/: break;\n\t\t\t\t\tcase 'errormessage' /*case 'ErrorMessage'*/: break;\n\t\t\t\t\tcase 'errortitle' /*case 'ErrorTitle'*/: break;\n\t\t\t\t\tcase 'inputmessage' /*case 'InputMessage'*/: break;\n\t\t\t\t\tcase 'inputtitle' /*case 'InputTitle'*/: break;\n\t\t\t\t\tcase 'combohide' /*case 'ComboHide'*/: break;\n\t\t\t\t\tcase 'inputhide' /*case 'InputHide'*/: break;\n\t\t\t\t\tcase 'condition' /*case 'Condition'*/: break;\n\t\t\t\t\tcase 'qualifier' /*case 'Qualifier'*/: break;\n\t\t\t\t\tcase 'useblank' /*case 'UseBlank'*/: break;\n\t\t\t\t\tcase 'value1' /*case 'Value1'*/: break;\n\t\t\t\t\tcase 'value2' /*case 'Value2'*/: break;\n\t\t\t\t\tcase 'format' /*case 'Format'*/: break;\n\n\t\t\t\t\tcase 'cellrangelist' /*case 'CellRangeList'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\tcase 'sorting' /*case 'Sorting'*/:\n\t\t\t\tcase 'conditionalformatting' /*case 'ConditionalFormatting'*/:\n\t\t\t\tswitch(Rn[3]) {\n\t\t\t\t\tcase 'range' /*case 'Range'*/: break;\n\t\t\t\t\tcase 'type' /*case 'Type'*/: break;\n\t\t\t\t\tcase 'min' /*case 'Min'*/: break;\n\t\t\t\t\tcase 'max' /*case 'Max'*/: break;\n\t\t\t\t\tcase 'sort' /*case 'Sort'*/: break;\n\t\t\t\t\tcase 'descending' /*case 'Descending'*/: break;\n\t\t\t\t\tcase 'order' /*case 'Order'*/: break;\n\t\t\t\t\tcase 'casesensitive' /*case 'CaseSensitive'*/: break;\n\t\t\t\t\tcase 'value' /*case 'Value'*/: break;\n\t\t\t\t\tcase 'errorstyle' /*case 'ErrorStyle'*/: break;\n\t\t\t\t\tcase 'errormessage' /*case 'ErrorMessage'*/: break;\n\t\t\t\t\tcase 'errortitle' /*case 'ErrorTitle'*/: break;\n\t\t\t\t\tcase 'cellrangelist' /*case 'CellRangeList'*/: break;\n\t\t\t\t\tcase 'inputmessage' /*case 'InputMessage'*/: break;\n\t\t\t\t\tcase 'inputtitle' /*case 'InputTitle'*/: break;\n\t\t\t\t\tcase 'combohide' /*case 'ComboHide'*/: break;\n\t\t\t\t\tcase 'inputhide' /*case 'InputHide'*/: break;\n\t\t\t\t\tcase 'condition' /*case 'Condition'*/: break;\n\t\t\t\t\tcase 'qualifier' /*case 'Qualifier'*/: break;\n\t\t\t\t\tcase 'useblank' /*case 'UseBlank'*/: break;\n\t\t\t\t\tcase 'value1' /*case 'Value1'*/: break;\n\t\t\t\t\tcase 'value2' /*case 'Value2'*/: break;\n\t\t\t\t\tcase 'format' /*case 'Format'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* MapInfo (schema) */\n\t\t\t\tcase 'mapinfo' /*case 'MapInfo'*/: case 'schema' /*case 'Schema'*/: case 'data' /*case 'data'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'map' /*case 'Map'*/: break;\n\t\t\t\t\tcase 'entry' /*case 'Entry'*/: break;\n\t\t\t\t\tcase 'range' /*case 'Range'*/: break;\n\t\t\t\t\tcase 'xpath' /*case 'XPath'*/: break;\n\t\t\t\t\tcase 'field' /*case 'Field'*/: break;\n\t\t\t\t\tcase 'xsdtype' /*case 'XSDType'*/: break;\n\t\t\t\t\tcase 'filteron' /*case 'FilterOn'*/: break;\n\t\t\t\t\tcase 'aggregate' /*case 'Aggregate'*/: break;\n\t\t\t\t\tcase 'elementtype' /*case 'ElementType'*/: break;\n\t\t\t\t\tcase 'attributetype' /*case 'AttributeType'*/: break;\n\t\t\t\t/* These are from xsd (XML Schema Definition) */\n\t\t\t\t\tcase 'schema' /*case 'schema'*/:\n\t\t\t\t\tcase 'element' /*case 'element'*/:\n\t\t\t\t\tcase 'complextype' /*case 'complexType'*/:\n\t\t\t\t\tcase 'datatype' /*case 'datatype'*/:\n\t\t\t\t\tcase 'all' /*case 'all'*/:\n\t\t\t\t\tcase 'attribute' /*case 'attribute'*/:\n\t\t\t\t\tcase 'extends' /*case 'extends'*/: break;\n\n\t\t\t\t\tcase 'row' /*case 'row'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* SmartTags (can be anything) */\n\t\t\t\tcase 'smarttags' /*case 'SmartTags'*/: break;\n\n\t\t\t\tdefault: seen = false; break;\n\t\t\t}\n\t\t\tif(seen) break;\n\t\t\t/* CustomDocumentProperties */\n\t\t\tif(Rn[3].match(/!\\[CDATA/)) break;\n\t\t\tif(!state[state.length-1][1]) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n\t\t\tif(state[state.length-1][0]===/*'CustomDocumentProperties'*/'customdocumentproperties') {\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\t\telse if(Rn[1]===\"/\") xlml_set_custprop(Custprops, raw_Rn3, cp, str.slice(pidx, Rn.index));\n\t\t\t\telse { cp = Rn; pidx = Rn.index + Rn[0].length; }\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(opts.WTF) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n\t}\n\tvar out = ({});\n\tif(!opts.bookSheets && !opts.bookProps) out.Sheets = sheets;\n\tout.SheetNames = sheetnames;\n\tout.Workbook = Workbook;\n\tout.SSF = dup(table_fmt);\n\tout.Props = Props;\n\tout.Custprops = Custprops;\n\treturn out;\n}\n\nfunction parse_xlml(data, opts) {\n\tfix_read_opts(opts=opts||{});\n\tswitch(opts.type||\"base64\") {\n\t\tcase \"base64\": return parse_xlml_xml(Base64_decode(data), opts);\n\t\tcase \"binary\": case \"buffer\": case \"file\": return parse_xlml_xml(data, opts);\n\t\tcase \"array\": return parse_xlml_xml(a2s(data), opts);\n\t}\n}\n\n/* TODO */\nfunction write_props_xlml(wb, opts) {\n\tvar o = [];\n\t/* DocumentProperties */\n\tif(wb.Props) o.push(xlml_write_docprops(wb.Props, opts));\n\t/* CustomDocumentProperties */\n\tif(wb.Custprops) o.push(xlml_write_custprops(wb.Props, wb.Custprops, opts));\n\treturn o.join(\"\");\n}\n/* TODO */\nfunction write_wb_xlml() {\n\t/* OfficeDocumentSettings */\n\t/* ExcelWorkbook */\n\treturn \"\";\n}\n/* TODO */\nfunction write_sty_xlml(wb, opts) {\n\t/* Styles */\n\tvar styles = ['<Style ss:ID=\"Default\" ss:Name=\"Normal\"><NumberFormat/></Style>'];\n\topts.cellXfs.forEach(function(xf, id) {\n\t\tvar payload = [];\n\t\tpayload.push(writextag('NumberFormat', null, {\"ss:Format\": escapexml(table_fmt[xf.numFmtId])}));\n\n\t\tvar o = {\"ss:ID\": \"s\" + (21+id)};\n\t\tstyles.push(writextag('Style', payload.join(\"\"), o));\n\t});\n\treturn writextag(\"Styles\", styles.join(\"\"));\n}\nfunction write_name_xlml(n) { return writextag(\"NamedRange\", null, {\"ss:Name\": n.Name, \"ss:RefersTo\":\"=\" + a1_to_rc(n.Ref, {r:0,c:0})}); }\nfunction write_names_xlml(wb) {\n\tif(!((wb||{}).Workbook||{}).Names) return \"\";\nvar names = wb.Workbook.Names;\n\tvar out = [];\n\tfor(var i = 0; i < names.length; ++i) {\n\t\tvar n = names[i];\n\t\tif(n.Sheet != null) continue;\n\t\tif(n.Name.match(/^_xlfn\\./)) continue;\n\t\tout.push(write_name_xlml(n));\n\t}\n\treturn writextag(\"Names\", out.join(\"\"));\n}\nfunction write_ws_xlml_names(ws, opts, idx, wb) {\n\tif(!ws) return \"\";\n\tif(!((wb||{}).Workbook||{}).Names) return \"\";\nvar names = wb.Workbook.Names;\n\tvar out = [];\n\tfor(var i = 0; i < names.length; ++i) {\n\t\tvar n = names[i];\n\t\tif(n.Sheet != idx) continue;\n\t\t/*switch(n.Name) {\n\t\t\tcase \"_\": continue;\n\t\t}*/\n\t\tif(n.Name.match(/^_xlfn\\./)) continue;\n\t\tout.push(write_name_xlml(n));\n\t}\n\treturn out.join(\"\");\n}\n/* WorksheetOptions */\nfunction write_ws_xlml_wsopts(ws, opts, idx, wb) {\n\tif(!ws) return \"\";\n\tvar o = [];\n\t/* NOTE: spec technically allows any order, but stick with implied order */\n\n\t/* FitToPage */\n\t/* DoNotDisplayColHeaders */\n\t/* DoNotDisplayRowHeaders */\n\t/* ViewableRange */\n\t/* Selection */\n\t/* GridlineColor */\n\t/* Name */\n\t/* ExcelWorksheetType */\n\t/* IntlMacro */\n\t/* Unsynced */\n\t/* Selected */\n\t/* CodeName */\n\n\tif(ws['!margins']) {\n\t\to.push(\"<PageSetup>\");\n\t\tif(ws['!margins'].header) o.push(writextag(\"Header\", null, {'x:Margin':ws['!margins'].header}));\n\t\tif(ws['!margins'].footer) o.push(writextag(\"Footer\", null, {'x:Margin':ws['!margins'].footer}));\n\t\to.push(writextag(\"PageMargins\", null, {\n\t\t\t'x:Bottom': ws['!margins'].bottom || \"0.75\",\n\t\t\t'x:Left': ws['!margins'].left || \"0.7\",\n\t\t\t'x:Right': ws['!margins'].right || \"0.7\",\n\t\t\t'x:Top': ws['!margins'].top || \"0.75\"\n\t\t}));\n\t\to.push(\"</PageSetup>\");\n\t}\n\n\t/* PageSetup */\n\t/* DisplayPageBreak */\n\t/* TransitionExpressionEvaluation */\n\t/* TransitionFormulaEntry */\n\t/* Print */\n\t/* Zoom */\n\t/* PageLayoutZoom */\n\t/* PageBreakZoom */\n\t/* ShowPageBreakZoom */\n\t/* DefaultRowHeight */\n\t/* DefaultColumnWidth */\n\t/* StandardWidth */\n\n\tif(wb && wb.Workbook && wb.Workbook.Sheets && wb.Workbook.Sheets[idx]) {\n\t\t/* Visible */\n\t\tif(wb.Workbook.Sheets[idx].Hidden) o.push(writextag(\"Visible\", (wb.Workbook.Sheets[idx].Hidden == 1 ? \"SheetHidden\" : \"SheetVeryHidden\"), {}));\n\t\telse {\n\t\t\t/* Selected */\n\t\t\tfor(var i = 0; i < idx; ++i) if(wb.Workbook.Sheets[i] && !wb.Workbook.Sheets[i].Hidden) break;\n\t\t\tif(i == idx) o.push(\"<Selected/>\");\n\t\t}\n\t}\n\n\t/* LeftColumnVisible */\n\n\tif(((((wb||{}).Workbook||{}).Views||[])[0]||{}).RTL) o.push(\"<DisplayRightToLeft/>\");\n\n\t/* GridlineColorIndex */\n\t/* DisplayFormulas */\n\t/* DoNotDisplayGridlines */\n\t/* DoNotDisplayHeadings */\n\t/* DoNotDisplayOutline */\n\t/* ApplyAutomaticOutlineStyles */\n\t/* NoSummaryRowsBelowDetail */\n\t/* NoSummaryColumnsRightDetail */\n\t/* DoNotDisplayZeros */\n\t/* ActiveRow */\n\t/* ActiveColumn */\n\t/* FilterOn */\n\t/* RangeSelection */\n\t/* TopRowVisible */\n\t/* TopRowBottomPane */\n\t/* LeftColumnRightPane */\n\t/* ActivePane */\n\t/* SplitHorizontal */\n\t/* SplitVertical */\n\t/* FreezePanes */\n\t/* FrozenNoSplit */\n\t/* TabColorIndex */\n\t/* Panes */\n\n\t/* NOTE: Password not supported in XLML Format */\n\tif(ws['!protect']) {\n\t\to.push(writetag(\"ProtectContents\", \"True\"));\n\t\tif(ws['!protect'].objects) o.push(writetag(\"ProtectObjects\", \"True\"));\n\t\tif(ws['!protect'].scenarios) o.push(writetag(\"ProtectScenarios\", \"True\"));\n\t\tif(ws['!protect'].selectLockedCells != null && !ws['!protect'].selectLockedCells) o.push(writetag(\"EnableSelection\", \"NoSelection\"));\n\t\telse if(ws['!protect'].selectUnlockedCells != null && !ws['!protect'].selectUnlockedCells) o.push(writetag(\"EnableSelection\", \"UnlockedCells\"));\n\t[\n\t\t[ \"formatCells\", \"AllowFormatCells\" ],\n\t\t[ \"formatColumns\", \"AllowSizeCols\" ],\n\t\t[ \"formatRows\", \"AllowSizeRows\" ],\n\t\t[ \"insertColumns\", \"AllowInsertCols\" ],\n\t\t[ \"insertRows\", \"AllowInsertRows\" ],\n\t\t[ \"insertHyperlinks\", \"AllowInsertHyperlinks\" ],\n\t\t[ \"deleteColumns\", \"AllowDeleteCols\" ],\n\t\t[ \"deleteRows\", \"AllowDeleteRows\" ],\n\t\t[ \"sort\", \"AllowSort\" ],\n\t\t[ \"autoFilter\", \"AllowFilter\" ],\n\t\t[ \"pivotTables\", \"AllowUsePivotTables\" ]\n\t].forEach(function(x) { if(ws['!protect'][x[0]]) o.push(\"<\"+x[1]+\"/>\"); });\n\t}\n\n\tif(o.length == 0) return \"\";\n\treturn writextag(\"WorksheetOptions\", o.join(\"\"), {xmlns:XLMLNS.x});\n}\nfunction write_ws_xlml_comment(comments) {\n\treturn comments.map(function(c) {\n\t\t// TODO: formatted text\n\t\tvar t = xlml_unfixstr(c.t||\"\");\n\t\tvar d =writextag(\"ss:Data\", t, {\"xmlns\":\"http://www.w3.org/TR/REC-html40\"});\n\t\treturn writextag(\"Comment\", d, {\"ss:Author\":c.a});\n\t}).join(\"\");\n}\nfunction write_ws_xlml_cell(cell, ref, ws, opts, idx, wb, addr){\n\tif(!cell || (cell.v == undefined && cell.f == undefined)) return \"\";\n\n\tvar attr = {};\n\tif(cell.f) attr[\"ss:Formula\"] = \"=\" + escapexml(a1_to_rc(cell.f, addr));\n\tif(cell.F && cell.F.slice(0, ref.length) == ref) {\n\t\tvar end = decode_cell(cell.F.slice(ref.length + 1));\n\t\tattr[\"ss:ArrayRange\"] = \"RC:R\" + (end.r == addr.r ? \"\" : \"[\" + (end.r - addr.r) + \"]\") + \"C\" + (end.c == addr.c ? \"\" : \"[\" + (end.c - addr.c) + \"]\");\n\t}\n\n\tif(cell.l && cell.l.Target) {\n\t\tattr[\"ss:HRef\"] = escapexml(cell.l.Target);\n\t\tif(cell.l.Tooltip) attr[\"x:HRefScreenTip\"] = escapexml(cell.l.Tooltip);\n\t}\n\n\tif(ws['!merges']) {\n\t\tvar marr = ws['!merges'];\n\t\tfor(var mi = 0; mi != marr.length; ++mi) {\n\t\t\tif(marr[mi].s.c != addr.c || marr[mi].s.r != addr.r) continue;\n\t\t\tif(marr[mi].e.c > marr[mi].s.c) attr['ss:MergeAcross'] = marr[mi].e.c - marr[mi].s.c;\n\t\t\tif(marr[mi].e.r > marr[mi].s.r) attr['ss:MergeDown'] = marr[mi].e.r - marr[mi].s.r;\n\t\t}\n\t}\n\n\tvar t = \"\", p = \"\";\n\tswitch(cell.t) {\n\t\tcase 'z': if(!opts.sheetStubs) return \"\"; break;\n\t\tcase 'n': t = 'Number'; p = String(cell.v); break;\n\t\tcase 'b': t = 'Boolean'; p = (cell.v ? \"1\" : \"0\"); break;\n\t\tcase 'e': t = 'Error'; p = BErr[cell.v]; break;\n\t\tcase 'd': t = 'DateTime'; p = new Date(cell.v).toISOString(); if(cell.z == null) cell.z = cell.z || table_fmt[14]; break;\n\t\tcase 's': t = 'String'; p = escapexlml(cell.v||\"\"); break;\n\t}\n\t/* TODO: cell style */\n\tvar os = get_cell_style(opts.cellXfs, cell, opts);\n\tattr[\"ss:StyleID\"] = \"s\" + (21+os);\n\tattr[\"ss:Index\"] = addr.c + 1;\n\tvar _v = (cell.v != null ? p : \"\");\n\tvar m = cell.t == 'z' ? \"\" : ('<Data ss:Type=\"' + t + '\">' + _v + '</Data>');\n\n\tif((cell.c||[]).length > 0) m += write_ws_xlml_comment(cell.c);\n\n\treturn writextag(\"Cell\", m, attr);\n}\nfunction write_ws_xlml_row(R, row) {\n\tvar o = '<Row ss:Index=\"' + (R+1) + '\"';\n\tif(row) {\n\t\tif(row.hpt && !row.hpx) row.hpx = pt2px(row.hpt);\n\t\tif(row.hpx) o += ' ss:AutoFitHeight=\"0\" ss:Height=\"' + row.hpx + '\"';\n\t\tif(row.hidden) o += ' ss:Hidden=\"1\"';\n\t}\n\treturn o + '>';\n}\n/* TODO */\nfunction write_ws_xlml_table(ws, opts, idx, wb) {\n\tif(!ws['!ref']) return \"\";\n\tvar range = safe_decode_range(ws['!ref']);\n\tvar marr = ws['!merges'] || [], mi = 0;\n\tvar o = [];\n\tif(ws['!cols']) ws['!cols'].forEach(function(n, i) {\n\t\tprocess_col(n);\n\t\tvar w = !!n.width;\n\t\tvar p = col_obj_w(i, n);\n\t\tvar k = {\"ss:Index\":i+1};\n\t\tif(w) k['ss:Width'] = width2px(p.width);\n\t\tif(n.hidden) k['ss:Hidden']=\"1\";\n\t\to.push(writextag(\"Column\",null,k));\n\t});\n\tvar dense = Array.isArray(ws);\n\tfor(var R = range.s.r; R <= range.e.r; ++R) {\n\t\tvar row = [write_ws_xlml_row(R, (ws['!rows']||[])[R])];\n\t\tfor(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\tvar skip = false;\n\t\t\tfor(mi = 0; mi != marr.length; ++mi) {\n\t\t\t\tif(marr[mi].s.c > C) continue;\n\t\t\t\tif(marr[mi].s.r > R) continue;\n\t\t\t\tif(marr[mi].e.c < C) continue;\n\t\t\t\tif(marr[mi].e.r < R) continue;\n\t\t\t\tif(marr[mi].s.c != C || marr[mi].s.r != R) skip = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(skip) continue;\n\t\t\tvar addr = {r:R,c:C};\n\t\t\tvar ref = encode_cell(addr), cell = dense ? (ws[R]||[])[C] : ws[ref];\n\t\t\trow.push(write_ws_xlml_cell(cell, ref, ws, opts, idx, wb, addr));\n\t\t}\n\t\trow.push(\"</Row>\");\n\t\tif(row.length > 2) o.push(row.join(\"\"));\n\t}\n\treturn o.join(\"\");\n}\nfunction write_ws_xlml(idx, opts, wb) {\n\tvar o = [];\n\tvar s = wb.SheetNames[idx];\n\tvar ws = wb.Sheets[s];\n\n\tvar t = ws ? write_ws_xlml_names(ws, opts, idx, wb) : \"\";\n\tif(t.length > 0) o.push(\"<Names>\" + t + \"</Names>\");\n\n\t/* Table */\n\tt = ws ? write_ws_xlml_table(ws, opts, idx, wb) : \"\";\n\tif(t.length > 0) o.push(\"<Table>\" + t + \"</Table>\");\n\n\t/* WorksheetOptions */\n\to.push(write_ws_xlml_wsopts(ws, opts, idx, wb));\n\n\treturn o.join(\"\");\n}\nfunction write_xlml(wb, opts) {\n\tif(!opts) opts = {};\n\tif(!wb.SSF) wb.SSF = dup(table_fmt);\n\tif(wb.SSF) {\n\t\tmake_ssf(); SSF_load_table(wb.SSF);\n\t\t// $FlowIgnore\n\t\topts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\n\t\topts.ssf = wb.SSF;\n\t\topts.cellXfs = [];\n\t\tget_cell_style(opts.cellXfs, {}, {revssf:{\"General\":0}});\n\t}\n\tvar d = [];\n\td.push(write_props_xlml(wb, opts));\n\td.push(write_wb_xlml(wb, opts));\n\td.push(\"\");\n\td.push(\"\");\n\tfor(var i = 0; i < wb.SheetNames.length; ++i)\n\t\td.push(writextag(\"Worksheet\", write_ws_xlml(i, opts, wb), {\"ss:Name\":escapexml(wb.SheetNames[i])}));\n\td[2] = write_sty_xlml(wb, opts);\n\td[3] = write_names_xlml(wb, opts);\n\treturn XML_HEADER + writextag(\"Workbook\", d.join(\"\"), {\n\t\t'xmlns':      XLMLNS.ss,\n\t\t'xmlns:o':    XLMLNS.o,\n\t\t'xmlns:x':    XLMLNS.x,\n\t\t'xmlns:ss':   XLMLNS.ss,\n\t\t'xmlns:dt':   XLMLNS.dt,\n\t\t'xmlns:html': XLMLNS.html\n\t});\n}\n/* [MS-OLEDS] 2.3.8 CompObjStream */\nfunction parse_compobj(obj) {\n\tvar v = {};\n\tvar o = obj.content;\n/* [MS-OLEDS] 2.3.7 CompObjHeader -- All fields MUST be ignored */\n\to.l = 28;\n\n\tv.AnsiUserType = o.read_shift(0, \"lpstr-ansi\");\n\tv.AnsiClipboardFormat = parse_ClipboardFormatOrAnsiString(o);\n\n\tif(o.length - o.l <= 4) return v;\n\n\tvar m = o.read_shift(4);\n\tif(m == 0 || m > 40) return v;\n\to.l-=4; v.Reserved1 = o.read_shift(0, \"lpstr-ansi\");\n\n\tif(o.length - o.l <= 4) return v;\n\tm = o.read_shift(4);\n\tif(m !== 0x71b239f4) return v;\n\tv.UnicodeClipboardFormat = parse_ClipboardFormatOrUnicodeString(o);\n\n\tm = o.read_shift(4);\n\tif(m == 0 || m > 40) return v;\n\to.l-=4; v.Reserved2 = o.read_shift(0, \"lpwstr\");\n}\n\n/*\n\tContinue logic for:\n\t- 2.4.58 Continue          0x003c\n\t- 2.4.59 ContinueBigName   0x043c\n\t- 2.4.60 ContinueFrt       0x0812\n\t- 2.4.61 ContinueFrt11     0x0875\n\t- 2.4.62 ContinueFrt12     0x087f\n*/\nvar CONTINUE_RT = [ 0x003c, 0x043c, 0x0812, 0x0875, 0x087f ];\nfunction slurp(RecordType, R, blob, length, opts) {\n\tvar l = length;\n\tvar bufs = [];\n\tvar d = blob.slice(blob.l,blob.l+l);\n\tif(opts && opts.enc && opts.enc.insitu && d.length > 0) switch(RecordType) {\n\tcase 0x0009: case 0x0209: case 0x0409: case 0x0809/* BOF */: case 0x002f /* FilePass */: case 0x0195 /* FileLock */: case 0x00e1 /* InterfaceHdr */: case 0x0196 /* RRDInfo */: case 0x0138 /* RRDHead */: case 0x0194 /* UsrExcl */: case 0x000a /* EOF */:\n\t\tbreak;\n\tcase 0x0085 /* BoundSheet8 */:\n\t\tbreak;\n\tdefault:\n\t\topts.enc.insitu(d);\n\t}\n\tbufs.push(d);\n\tblob.l += l;\n\tvar nextrt = __readUInt16LE(blob,blob.l), next = XLSRecordEnum[nextrt];\n\tvar start = 0;\n\twhile(next != null && CONTINUE_RT.indexOf(nextrt) > -1) {\n\t\tl = __readUInt16LE(blob,blob.l+2);\n\t\tstart = blob.l + 4;\n\t\tif(nextrt == 0x0812 /* ContinueFrt */) start += 4;\n\t\telse if(nextrt == 0x0875 || nextrt == 0x087f) {\n\t\t\tstart += 12;\n\t\t}\n\t\td = blob.slice(start,blob.l+4+l);\n\t\tbufs.push(d);\n\t\tblob.l += 4+l;\n\t\tnext = (XLSRecordEnum[nextrt = __readUInt16LE(blob, blob.l)]);\n\t}\n\tvar b = (bconcat(bufs));\n\tprep_blob(b, 0);\n\tvar ll = 0; b.lens = [];\n\tfor(var j = 0; j < bufs.length; ++j) { b.lens.push(ll); ll += bufs[j].length; }\n\tif(b.length < length) throw \"XLS Record 0x\" + RecordType.toString(16) + \" Truncated: \" + b.length + \" < \" + length;\n\treturn R.f(b, b.length, opts);\n}\n\nfunction safe_format_xf(p, opts, date1904) {\n\tif(p.t === 'z') return;\n\tif(!p.XF) return;\n\tvar fmtid = 0;\n\ttry {\n\t\tfmtid = p.z || p.XF.numFmtId || 0;\n\t\tif(opts.cellNF) p.z = table_fmt[fmtid];\n\t} catch(e) { if(opts.WTF) throw e; }\n\tif(!opts || opts.cellText !== false) try {\n\t\tif(p.t === 'e') { p.w = p.w || BErr[p.v]; }\n\t\telse if(fmtid === 0 || fmtid == \"General\") {\n\t\t\tif(p.t === 'n') {\n\t\t\t\tif((p.v|0) === p.v) p.w = p.v.toString(10);\n\t\t\t\telse p.w = SSF_general_num(p.v);\n\t\t\t}\n\t\t\telse p.w = SSF_general(p.v);\n\t\t}\n\t\telse p.w = SSF_format(fmtid,p.v, {date1904:!!date1904, dateNF: opts && opts.dateNF});\n\t} catch(e) { if(opts.WTF) throw e; }\n\tif(opts.cellDates && fmtid && p.t == 'n' && fmt_is_date(table_fmt[fmtid] || String(fmtid))) {\n\t\tvar _d = SSF_parse_date_code(p.v); if(_d) { p.t = 'd'; p.v = new Date(_d.y, _d.m-1,_d.d,_d.H,_d.M,_d.S,_d.u); }\n\t}\n}\n\nfunction make_cell(val, ixfe, t) {\n\treturn ({v:val, ixfe:ixfe, t:t});\n}\n\n// 2.3.2\nfunction parse_workbook(blob, options) {\n\tvar wb = ({opts:{}});\n\tvar Sheets = {};\n\tif(DENSE != null && options.dense == null) options.dense = DENSE;\n\tvar out = ((options.dense ? [] : {}));\n\tvar Directory = {};\n\tvar range = ({});\n\tvar last_formula = null;\n\tvar sst = ([]);\n\tvar cur_sheet = \"\";\n\tvar Preamble = {};\n\tvar lastcell, last_cell = \"\", cc, cmnt, rngC, rngR;\n\tvar sharedf = {};\n\tvar arrayf = [];\n\tvar temp_val;\n\tvar country;\n\tvar XFs = []; /* XF records */\n\tvar palette = [];\n\tvar Workbook = ({ Sheets:[], WBProps:{date1904:false}, Views:[{}] }), wsprops = {};\n\tvar get_rgb = function getrgb(icv) {\n\t\tif(icv < 8) return XLSIcv[icv];\n\t\tif(icv < 64) return palette[icv-8] || XLSIcv[icv];\n\t\treturn XLSIcv[icv];\n\t};\n\tvar process_cell_style = function pcs(cell, line, options) {\n\t\tvar xfd = line.XF.data;\n\t\tif(!xfd || !xfd.patternType || !options || !options.cellStyles) return;\n\t\tline.s = ({});\n\t\tline.s.patternType = xfd.patternType;\n\t\tvar t;\n\t\tif((t = rgb2Hex(get_rgb(xfd.icvFore)))) { line.s.fgColor = {rgb:t}; }\n\t\tif((t = rgb2Hex(get_rgb(xfd.icvBack)))) { line.s.bgColor = {rgb:t}; }\n\t};\n\tvar addcell = function addcell(cell, line, options) {\n\t\tif(file_depth > 1) return;\n\t\tif(options.sheetRows && cell.r >= options.sheetRows) return;\n\t\tif(options.cellStyles && line.XF && line.XF.data) process_cell_style(cell, line, options);\n\t\tdelete line.ixfe; delete line.XF;\n\t\tlastcell = cell;\n\t\tlast_cell = encode_cell(cell);\n\t\tif(!range || !range.s || !range.e) range = {s:{r:0,c:0},e:{r:0,c:0}};\n\t\tif(cell.r < range.s.r) range.s.r = cell.r;\n\t\tif(cell.c < range.s.c) range.s.c = cell.c;\n\t\tif(cell.r + 1 > range.e.r) range.e.r = cell.r + 1;\n\t\tif(cell.c + 1 > range.e.c) range.e.c = cell.c + 1;\n\t\tif(options.cellFormula && line.f) {\n\t\t\tfor(var afi = 0; afi < arrayf.length; ++afi) {\n\t\t\t\tif(arrayf[afi][0].s.c > cell.c || arrayf[afi][0].s.r > cell.r) continue;\n\t\t\t\tif(arrayf[afi][0].e.c < cell.c || arrayf[afi][0].e.r < cell.r) continue;\n\t\t\t\tline.F = encode_range(arrayf[afi][0]);\n\t\t\t\tif(arrayf[afi][0].s.c != cell.c || arrayf[afi][0].s.r != cell.r) delete line.f;\n\t\t\t\tif(line.f) line.f = \"\" + stringify_formula(arrayf[afi][1], range, cell, supbooks, opts);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t{\n\t\t\tif(options.dense) {\n\t\t\t\tif(!out[cell.r]) out[cell.r] = [];\n\t\t\t\tout[cell.r][cell.c] = line;\n\t\t\t} else out[last_cell] = line;\n\t\t}\n\t};\n\tvar opts = ({\n\t\tenc: false, // encrypted\n\t\tsbcch: 0, // cch in the preceding SupBook\n\t\tsnames: [], // sheetnames\n\t\tsharedf: sharedf, // shared formulae by address\n\t\tarrayf: arrayf, // array formulae array\n\t\trrtabid: [], // RRTabId\n\t\tlastuser: \"\", // Last User from WriteAccess\n\t\tbiff: 8, // BIFF version\n\t\tcodepage: 0, // CP from CodePage record\n\t\twinlocked: 0, // fLockWn from WinProtect\n\t\tcellStyles: !!options && !!options.cellStyles,\n\t\tWTF: !!options && !!options.wtf\n\t});\n\tif(options.password) opts.password = options.password;\n\tvar themes;\n\tvar merges = [];\n\tvar objects = [];\n\tvar colinfo = [], rowinfo = [];\n\tvar seencol = false;\n\tvar supbooks = ([]); // 1-indexed, will hold extern names\n\tsupbooks.SheetNames = opts.snames;\n\tsupbooks.sharedf = opts.sharedf;\n\tsupbooks.arrayf = opts.arrayf;\n\tsupbooks.names = [];\n\tsupbooks.XTI = [];\n\tvar last_RT = 0;\n\tvar file_depth = 0; /* TODO: make a real stack */\n\tvar BIFF2Fmt = 0, BIFF2FmtTable = [];\n\tvar FilterDatabases = []; /* TODO: sort out supbooks and process elsewhere */\n\tvar last_lbl;\n\n\t/* explicit override for some broken writers */\n\topts.codepage = 1200;\n\tset_cp(1200);\n\tvar seen_codepage = false;\n\twhile(blob.l < blob.length - 1) {\n\t\tvar s = blob.l;\n\t\tvar RecordType = blob.read_shift(2);\n\t\tif(RecordType === 0 && last_RT === 0x000a /* EOF */) break;\n\t\tvar length = (blob.l === blob.length ? 0 : blob.read_shift(2));\n\t\tvar R = XLSRecordEnum[RecordType];\n\t\t//console.log(RecordType.toString(16), RecordType, R, blob.l, length, blob.length);\n\t\t//if(!R) console.log(blob.slice(blob.l, blob.l + length));\n\t\tif(R && R.f) {\n\t\t\tif(options.bookSheets) {\n\t\t\t\tif(last_RT === 0x0085 /* BoundSheet8 */ && RecordType !== 0x0085 /* R.n !== 'BoundSheet8' */) break;\n\t\t\t}\n\t\t\tlast_RT = RecordType;\n\t\t\tif(R.r === 2 || R.r == 12) {\n\t\t\t\tvar rt = blob.read_shift(2); length -= 2;\n\t\t\t\tif(!opts.enc && rt !== RecordType && (((rt&0xFF)<<8)|(rt>>8)) !== RecordType) throw new Error(\"rt mismatch: \" + rt + \"!=\" + RecordType);\n\t\t\t\tif(R.r == 12){\n\t\t\t\t\tblob.l += 10; length -= 10;\n\t\t\t\t} // skip FRT\n\t\t\t}\n\t\t\t//console.error(R,blob.l,length,blob.length);\n\t\t\tvar val = ({});\n\t\t\tif(RecordType === 0x000a /* EOF */) val = R.f(blob, length, opts);\n\t\t\telse val = slurp(RecordType, R, blob, length, opts);\nif(file_depth == 0 && [0x0009, 0x0209, 0x0409, 0x0809].indexOf(last_RT) === -1 /* 'BOF' */) continue;\n\t\t\tswitch(RecordType) {\n\t\t\t\tcase 0x0022 /* Date1904 */:\nwb.opts.Date1904 = Workbook.WBProps.date1904 = val; break;\n\t\t\t\tcase 0x0086 /* WriteProtect */: wb.opts.WriteProtect = true; break;\n\t\t\t\tcase 0x002f /* FilePass */:\n\t\t\t\t\tif(!opts.enc) blob.l = 0;\n\t\t\t\t\topts.enc = val;\n\t\t\t\t\tif(!options.password) throw new Error(\"File is password-protected\");\n\t\t\t\t\tif(val.valid == null) throw new Error(\"Encryption scheme unsupported\");\n\t\t\t\t\tif(!val.valid) throw new Error(\"Password is incorrect\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x005c /* WriteAccess */: opts.lastuser = val; break;\n\t\t\t\tcase 0x0042 /* CodePage */:\n\t\t\t\t\tvar cpval = Number(val);\n\t\t\t\t\t/* overrides based on test cases */\n\t\t\t\t\tswitch(cpval) {\n\t\t\t\t\t\tcase 0x5212: cpval =  1200; break;\n\t\t\t\t\t\tcase 0x8000: cpval = 10000; break;\n\t\t\t\t\t\tcase 0x8001: cpval =  1252; break;\n\t\t\t\t\t}\n\t\t\t\t\tset_cp(opts.codepage = cpval);\n\t\t\t\t\tseen_codepage = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x013d /* RRTabId */: opts.rrtabid = val; break;\n\t\t\t\tcase 0x0019 /* WinProtect */: opts.winlocked = val; break;\n\t\t\t\tcase 0x01b7 /* RefreshAll */: wb.opts[\"RefreshAll\"] = val; break;\n\t\t\t\tcase 0x000c /* CalcCount */: wb.opts[\"CalcCount\"] = val; break;\n\t\t\t\tcase 0x0010 /* CalcDelta */: wb.opts[\"CalcDelta\"] = val; break;\n\t\t\t\tcase 0x0011 /* CalcIter */: wb.opts[\"CalcIter\"] = val; break;\n\t\t\t\tcase 0x000d /* CalcMode */: wb.opts[\"CalcMode\"] = val; break;\n\t\t\t\tcase 0x000e /* CalcPrecision */: wb.opts[\"CalcPrecision\"] = val; break;\n\t\t\t\tcase 0x005f /* CalcSaveRecalc */: wb.opts[\"CalcSaveRecalc\"] = val; break;\n\t\t\t\tcase 0x000f /* CalcRefMode */: opts.CalcRefMode = val; break; // TODO: implement R1C1\n\t\t\t\tcase 0x08a3 /* ForceFullCalculation */: wb.opts.FullCalc = val; break;\n\t\t\t\tcase 0x0081 /* WsBool */:\n\t\t\t\t\tif(val.fDialog) out[\"!type\"] = \"dialog\";\n\t\t\t\t\tif(!val.fBelow) (out[\"!outline\"] || (out[\"!outline\"] = {})).above = true;\n\t\t\t\t\tif(!val.fRight) (out[\"!outline\"] || (out[\"!outline\"] = {})).left = true;\n\t\t\t\t\tbreak; // TODO\n\t\t\t\tcase 0x00e0 /* XF */:\n\t\t\t\t\tXFs.push(val); break;\n\t\t\t\tcase 0x01ae /* SupBook */:\n\t\t\t\t\tsupbooks.push([val]);\n\t\t\t\t\tsupbooks[supbooks.length-1].XTI = [];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0023: case 0x0223 /* ExternName */:\n\t\t\t\t\tsupbooks[supbooks.length-1].push(val);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0018: case 0x0218 /* Lbl */:\n\t\t\t\t\tlast_lbl = ({\n\t\t\t\t\t\tName: val.Name,\n\t\t\t\t\t\tRef: stringify_formula(val.rgce,range,null,supbooks,opts)\n\t\t\t\t\t});\n\t\t\t\t\tif(val.itab > 0) last_lbl.Sheet = val.itab - 1;\n\t\t\t\t\tsupbooks.names.push(last_lbl);\n\t\t\t\t\tif(!supbooks[0]) { supbooks[0] = []; supbooks[0].XTI = []; }\n\t\t\t\t\tsupbooks[supbooks.length-1].push(val);\n\t\t\t\t\tif(val.Name == \"_xlnm._FilterDatabase\" && val.itab > 0)\n\t\t\t\t\t\tif(val.rgce && val.rgce[0] && val.rgce[0][0] && val.rgce[0][0][0] == 'PtgArea3d')\n\t\t\t\t\t\t\tFilterDatabases[val.itab - 1] = { ref: encode_range(val.rgce[0][0][1][2]) };\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0016 /* ExternCount */: opts.ExternCount = val; break;\n\t\t\t\tcase 0x0017 /* ExternSheet */:\n\t\t\t\t\tif(supbooks.length == 0) { supbooks[0] = []; supbooks[0].XTI = []; }\n\t\t\t\t\tsupbooks[supbooks.length - 1].XTI = supbooks[supbooks.length - 1].XTI.concat(val); supbooks.XTI = supbooks.XTI.concat(val); break;\n\t\t\t\tcase 0x0894 /* NameCmt */:\n\t\t\t\t\t/* TODO: search for correct name */\n\t\t\t\t\tif(opts.biff < 8) break;\n\t\t\t\t\tif(last_lbl != null) last_lbl.Comment = val[1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0012 /* Protect */: out[\"!protect\"] = val; break; /* for sheet or book */\n\t\t\t\tcase 0x0013 /* Password */: if(val !== 0 && opts.WTF) console.error(\"Password verifier: \" + val); break;\n\t\t\t\tcase 0x0085 /* BoundSheet8 */: {\n\t\t\t\t\tDirectory[val.pos] = val;\n\t\t\t\t\topts.snames.push(val.name);\n\t\t\t\t} break;\n\t\t\t\tcase 0x000a /* EOF */: {\n\t\t\t\t\tif(--file_depth) break;\n\t\t\t\t\tif(range.e) {\n\t\t\t\t\t\tif(range.e.r > 0 && range.e.c > 0) {\n\t\t\t\t\t\t\trange.e.r--; range.e.c--;\n\t\t\t\t\t\t\tout[\"!ref\"] = encode_range(range);\n\t\t\t\t\t\t\tif(options.sheetRows && options.sheetRows <= range.e.r) {\n\t\t\t\t\t\t\t\tvar tmpri = range.e.r;\n\t\t\t\t\t\t\t\trange.e.r = options.sheetRows - 1;\n\t\t\t\t\t\t\t\tout[\"!fullref\"] = out[\"!ref\"];\n\t\t\t\t\t\t\t\tout[\"!ref\"] = encode_range(range);\n\t\t\t\t\t\t\t\trange.e.r = tmpri;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.e.r++; range.e.c++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(merges.length > 0) out[\"!merges\"] = merges;\n\t\t\t\t\t\tif(objects.length > 0) out[\"!objects\"] = objects;\n\t\t\t\t\t\tif(colinfo.length > 0) out[\"!cols\"] = colinfo;\n\t\t\t\t\t\tif(rowinfo.length > 0) out[\"!rows\"] = rowinfo;\n\t\t\t\t\t\tWorkbook.Sheets.push(wsprops);\n\t\t\t\t\t}\n\t\t\t\t\tif(cur_sheet === \"\") Preamble = out; else Sheets[cur_sheet] = out;\n\t\t\t\t\tout = ((options.dense ? [] : {}));\n\t\t\t\t} break;\n\t\t\t\tcase 0x0009: case 0x0209: case 0x0409: case 0x0809 /* BOF */: {\n\t\t\t\t\tif(opts.biff === 8) opts.biff = {\n0x0009:2,\n0x0209:3,\n0x0409:4\n\t\t\t\t\t}[RecordType] || {\n0x0200:2,\n0x0300:3,\n0x0400:4,\n0x0500:5,\n0x0600:8,\n0x0002:2,\n0x0007:2\n\t\t\t\t\t}[val.BIFFVer] || 8;\n\t\t\t\t\topts.biffguess = val.BIFFVer == 0;\n\t\t\t\t\tif(val.BIFFVer == 0 && val.dt == 0x1000) { opts.biff = 5; seen_codepage = true; set_cp(opts.codepage = 28591); }\n\t\t\t\t\tif(opts.biff == 8 && val.BIFFVer == 0 && val.dt == 16) opts.biff = 2;\n\t\t\t\t\tif(file_depth++) break;\n\t\t\t\t\tout = ((options.dense ? [] : {}));\n\n\t\t\t\t\tif(opts.biff < 8 && !seen_codepage) { seen_codepage = true; set_cp(opts.codepage = options.codepage || 1252); }\n\n\t\t\t\t\tif(opts.biff < 5 || val.BIFFVer == 0 && val.dt == 0x1000) {\n\t\t\t\t\t\tif(cur_sheet === \"\") cur_sheet = \"Sheet1\";\n\t\t\t\t\t\trange = {s:{r:0,c:0},e:{r:0,c:0}};\n\t\t\t\t\t\t/* fake BoundSheet8 */\n\t\t\t\t\t\tvar fakebs8 = {pos: blob.l - length, name:cur_sheet};\n\t\t\t\t\t\tDirectory[fakebs8.pos] = fakebs8;\n\t\t\t\t\t\topts.snames.push(cur_sheet);\n\t\t\t\t\t}\n\t\t\t\t\telse cur_sheet = (Directory[s] || {name:\"\"}).name;\n\t\t\t\t\tif(val.dt == 0x20) out[\"!type\"] = \"chart\";\n\t\t\t\t\tif(val.dt == 0x40) out[\"!type\"] = \"macro\";\n\t\t\t\t\tmerges = [];\n\t\t\t\t\tobjects = [];\n\t\t\t\t\topts.arrayf = arrayf = [];\n\t\t\t\t\tcolinfo = []; rowinfo = [];\n\t\t\t\t\tseencol = false;\n\t\t\t\t\twsprops = {Hidden:(Directory[s]||{hs:0}).hs, name:cur_sheet };\n\t\t\t\t} break;\n\t\t\t\tcase 0x0203 /* Number */: case 0x0003 /* BIFF2NUM */: case 0x0002 /* BIFF2INT */: {\n\t\t\t\t\tif(out[\"!type\"] == \"chart\") if(options.dense ? (out[val.r]||[])[val.c]: out[encode_cell({c:val.c, r:val.r})]) ++val.c;\n\t\t\t\t\ttemp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe]||{}, v:val.val, t:'n'});\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 0x0005: case 0x0205 /* BoolErr */: {\n\t\t\t\t\ttemp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.val, t:val.t});\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 0x027e /* RK */: {\n\t\t\t\t\ttemp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.rknum, t:'n'});\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 0x00bd /* MulRk */: {\n\t\t\t\t\tfor(var j = val.c; j <= val.C; ++j) {\n\t\t\t\t\t\tvar ixfe = val.rkrec[j-val.c][0];\n\t\t\t\t\t\ttemp_val= ({ixfe:ixfe, XF:XFs[ixfe], v:val.rkrec[j-val.c][1], t:'n'});\n\t\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\taddcell({c:j, r:val.r}, temp_val, options);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0006: case 0x0206: case 0x0406 /* Formula */: {\n\t\t\t\t\tif(val.val == 'String') { last_formula = val; break; }\n\t\t\t\t\ttemp_val = make_cell(val.val, val.cell.ixfe, val.tt);\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\tif(options.cellFormula) {\n\t\t\t\t\t\tvar _f = val.formula;\n\t\t\t\t\t\tif(_f && _f[0] && _f[0][0] && _f[0][0][0] == 'PtgExp') {\n\t\t\t\t\t\t\tvar _fr = _f[0][0][1][0], _fc = _f[0][0][1][1];\n\t\t\t\t\t\t\tvar _fe = encode_cell({r:_fr, c:_fc});\n\t\t\t\t\t\t\tif(sharedf[_fe]) temp_val.f = \"\"+stringify_formula(val.formula,range,val.cell,supbooks, opts);\n\t\t\t\t\t\t\telse temp_val.F = ((options.dense ? (out[_fr]||[])[_fc]: out[_fe]) || {}).F;\n\t\t\t\t\t\t} else temp_val.f = \"\"+stringify_formula(val.formula,range,val.cell,supbooks, opts);\n\t\t\t\t\t}\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell(val.cell, temp_val, options);\n\t\t\t\t\tlast_formula = val;\n\t\t\t\t} break;\n\t\t\t\tcase 0x0007: case 0x0207 /* String */: {\n\t\t\t\t\tif(last_formula) { /* technically always true */\n\t\t\t\t\t\tlast_formula.val = val;\n\t\t\t\t\t\ttemp_val = make_cell(val, last_formula.cell.ixfe, 's');\n\t\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\t\tif(options.cellFormula) {\n\t\t\t\t\t\t\ttemp_val.f = \"\"+stringify_formula(last_formula.formula, range, last_formula.cell, supbooks, opts);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\taddcell(last_formula.cell, temp_val, options);\n\t\t\t\t\t\tlast_formula = null;\n\t\t\t\t\t} else throw new Error(\"String record expects Formula\");\n\t\t\t\t} break;\n\t\t\t\tcase 0x0021: case 0x0221 /* Array */: {\n\t\t\t\t\tarrayf.push(val);\n\t\t\t\t\tvar _arraystart = encode_cell(val[0].s);\n\t\t\t\t\tcc = options.dense ? (out[val[0].s.r]||[])[val[0].s.c] : out[_arraystart];\n\t\t\t\t\tif(options.cellFormula && cc) {\n\t\t\t\t\t\tif(!last_formula) break; /* technically unreachable */\n\t\t\t\t\t\tif(!_arraystart || !cc) break;\n\t\t\t\t\t\tcc.f = \"\"+stringify_formula(val[1], range, val[0], supbooks, opts);\n\t\t\t\t\t\tcc.F = encode_range(val[0]);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x04bc /* ShrFmla */: {\n\t\t\t\t\tif(!options.cellFormula) break;\n\t\t\t\t\tif(last_cell) {\n\t\t\t\t\t\t/* TODO: capture range */\n\t\t\t\t\t\tif(!last_formula) break; /* technically unreachable */\n\t\t\t\t\t\tsharedf[encode_cell(last_formula.cell)]= val[0];\n\t\t\t\t\t\tcc = options.dense ? (out[last_formula.cell.r]||[])[last_formula.cell.c] : out[encode_cell(last_formula.cell)];\n\t\t\t\t\t\t(cc||{}).f = \"\"+stringify_formula(val[0], range, lastcell, supbooks, opts);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x00fd /* LabelSst */:\n\t\t\t\t\ttemp_val=make_cell(sst[val.isst].t, val.ixfe, 's');\n\t\t\t\t\tif(sst[val.isst].h) temp_val.h = sst[val.isst].h;\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0201 /* Blank */: if(options.sheetStubs) {\n\t\t\t\t\ttemp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe], t:'z'});\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 0x00be /* MulBlank */: if(options.sheetStubs) {\n\t\t\t\t\tfor(var _j = val.c; _j <= val.C; ++_j) {\n\t\t\t\t\t\tvar _ixfe = val.ixfe[_j-val.c];\n\t\t\t\t\t\ttemp_val= ({ixfe:_ixfe, XF:XFs[_ixfe], t:'z'});\n\t\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\taddcell({c:_j, r:val.r}, temp_val, options);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x00d6 /* RString */:\n\t\t\t\tcase 0x0204 /* Label */: case 0x0004 /* BIFF2STR */:\n\t\t\t\t\ttemp_val=make_cell(val.val, val.ixfe, 's');\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 0x0000: case 0x0200 /* Dimensions */: {\n\t\t\t\t\tif(file_depth === 1) range = val; /* TODO: stack */\n\t\t\t\t} break;\n\t\t\t\tcase 0x00fc /* SST */: {\n\t\t\t\t\tsst = val;\n\t\t\t\t} break;\n\t\t\t\tcase 0x041e /* Format */: { /* val = [id, fmt] */\n\t\t\t\t\tif(opts.biff == 4) {\n\t\t\t\t\t\tBIFF2FmtTable[BIFF2Fmt++] = val[1];\n\t\t\t\t\t\tfor(var b4idx = 0; b4idx < BIFF2Fmt + 163; ++b4idx) if(table_fmt[b4idx] == val[1]) break;\n\t\t\t\t\t\tif(b4idx >= 163) SSF_load(val[1], BIFF2Fmt + 163);\n\t\t\t\t\t}\n\t\t\t\t\telse SSF_load(val[1], val[0]);\n\t\t\t\t} break;\n\t\t\t\tcase 0x001e /* BIFF2FORMAT */: {\n\t\t\t\t\tBIFF2FmtTable[BIFF2Fmt++] = val;\n\t\t\t\t\tfor(var b2idx = 0; b2idx < BIFF2Fmt + 163; ++b2idx) if(table_fmt[b2idx] == val) break;\n\t\t\t\t\tif(b2idx >= 163) SSF_load(val, BIFF2Fmt + 163);\n\t\t\t\t} break;\n\n\t\t\t\tcase 0x00e5 /* MergeCells */: merges = merges.concat(val); break;\n\n\t\t\t\tcase 0x005d /* Obj */: objects[val.cmo[0]] = opts.lastobj = val; break;\n\t\t\t\tcase 0x01b6 /* TxO */: opts.lastobj.TxO = val; break;\n\t\t\t\tcase 0x007f /* ImData */: opts.lastobj.ImData = val; break;\n\n\t\t\t\tcase 0x01b8 /* HLink */: {\n\t\t\t\t\tfor(rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\n\t\t\t\t\t\tfor(rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\n\t\t\t\t\t\t\tcc = options.dense ? (out[rngR]||[])[rngC] : out[encode_cell({c:rngC,r:rngR})];\n\t\t\t\t\t\t\tif(cc) cc.l = val[1];\n\t\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0800 /* HLinkTooltip */: {\n\t\t\t\t\tfor(rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\n\t\t\t\t\t\tfor(rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\n\t\t\t\t\t\t\tcc = options.dense ? (out[rngR]||[])[rngC] : out[encode_cell({c:rngC,r:rngR})];\n\t\t\t\t\t\t\tif(cc && cc.l) cc.l.Tooltip = val[1];\n\t\t\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x001c /* Note */: {\n\t\t\t\t\tif(opts.biff <= 5 && opts.biff >= 2) break; /* TODO: BIFF5 */\n\t\t\t\t\tcc = options.dense ? (out[val[0].r]||[])[val[0].c] : out[encode_cell(val[0])];\n\t\t\t\t\tvar noteobj = objects[val[2]];\n\t\t\t\t\tif(!cc) {\n\t\t\t\t\t\tif(options.dense) {\n\t\t\t\t\t\t\tif(!out[val[0].r]) out[val[0].r] = [];\n\t\t\t\t\t\t\tcc = out[val[0].r][val[0].c] = ({t:\"z\"});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcc = out[encode_cell(val[0])] = ({t:\"z\"});\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.e.r = Math.max(range.e.r, val[0].r);\n\t\t\t\t\t\trange.s.r = Math.min(range.s.r, val[0].r);\n\t\t\t\t\t\trange.e.c = Math.max(range.e.c, val[0].c);\n\t\t\t\t\t\trange.s.c = Math.min(range.s.c, val[0].c);\n\t\t\t\t\t}\n\t\t\t\t\tif(!cc.c) cc.c = [];\n\t\t\t\t\tcmnt = {a:val[1],t:noteobj.TxO.t};\n\t\t\t\t\tcc.c.push(cmnt);\n\t\t\t\t} break;\n\t\t\t\tcase 0x087d /* XFExt */: update_xfext(XFs[val.ixfe], val.ext); break;\n\t\t\t\tcase 0x007d /* ColInfo */: {\n\t\t\t\t\tif(!opts.cellStyles) break;\n\t\t\t\t\twhile(val.e >= val.s) {\n\t\t\t\t\t\tcolinfo[val.e--] = { width: val.w/256, level: (val.level || 0), hidden: !!(val.flags & 1) };\n\t\t\t\t\t\tif(!seencol) { seencol = true; find_mdw_colw(val.w/256); }\n\t\t\t\t\t\tprocess_col(colinfo[val.e+1]);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0208 /* Row */: {\n\t\t\t\t\tvar rowobj = {};\n\t\t\t\t\tif(val.level != null) { rowinfo[val.r] = rowobj; rowobj.level = val.level; }\n\t\t\t\t\tif(val.hidden) { rowinfo[val.r] = rowobj; rowobj.hidden = true; }\n\t\t\t\t\tif(val.hpt) {\n\t\t\t\t\t\trowinfo[val.r] = rowobj;\n\t\t\t\t\t\trowobj.hpt = val.hpt; rowobj.hpx = pt2px(val.hpt);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0026 /* LeftMargin */:\n\t\t\t\tcase 0x0027 /* RightMargin */:\n\t\t\t\tcase 0x0028 /* TopMargin */:\n\t\t\t\tcase 0x0029 /* BottomMargin */:\n\t\t\t\t\tif(!out['!margins']) default_margins(out['!margins'] = {});\n\t\t\t\t\tout['!margins'][({0x26: \"left\", 0x27:\"right\", 0x28:\"top\", 0x29:\"bottom\"})[RecordType]] = val;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x00a1 /* Setup */: // TODO\n\t\t\t\t\tif(!out['!margins']) default_margins(out['!margins'] = {});\n\t\t\t\t\tout['!margins'].header = val.header;\n\t\t\t\t\tout['!margins'].footer = val.footer;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x023e /* Window2 */: // TODO\n\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\tif(val.RTL) Workbook.Views[0].RTL = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0092 /* Palette */: palette = val; break;\n\t\t\t\tcase 0x0896 /* Theme */: themes = val; break;\n\t\t\t\tcase 0x008c /* Country */: country = val; break;\n\t\t\t\tcase 0x01ba /* CodeName */: {\nif(!cur_sheet) Workbook.WBProps.CodeName = val || \"ThisWorkbook\";\n\t\t\t\t\telse wsprops.CodeName = val || wsprops.name;\n\t\t\t\t} break;\n\t\t\t}\n\t\t} else {\n\t\t\tif(!R) console.error(\"Missing Info for XLS Record 0x\" + RecordType.toString(16));\n\t\t\tblob.l += length;\n\t\t}\n\t}\n\twb.SheetNames=keys(Directory).sort(function(a,b) { return Number(a) - Number(b); }).map(function(x){return Directory[x].name;});\n\tif(!options.bookSheets) wb.Sheets=Sheets;\n\tif(!wb.SheetNames.length && Preamble[\"!ref\"]) {\n\t\twb.SheetNames.push(\"Sheet1\");\n\t\t/*jshint -W069 */\n\t\tif(wb.Sheets) wb.Sheets[\"Sheet1\"] = Preamble;\n\t\t/*jshint +W069 */\n\t} else wb.Preamble=Preamble;\n\tif(wb.Sheets) FilterDatabases.forEach(function(r,i) { wb.Sheets[wb.SheetNames[i]]['!autofilter'] = r; });\n\twb.Strings = sst;\n\twb.SSF = dup(table_fmt);\n\tif(opts.enc) wb.Encryption = opts.enc;\n\tif(themes) wb.Themes = themes;\n\twb.Metadata = {};\n\tif(country !== undefined) wb.Metadata.Country = country;\n\tif(supbooks.names.length > 0) Workbook.Names = supbooks.names;\n\twb.Workbook = Workbook;\n\treturn wb;\n}\n\n/* TODO: split props*/\nvar PSCLSID = {\n\tSI: \"e0859ff2f94f6810ab9108002b27b3d9\",\n\tDSI: \"02d5cdd59c2e1b10939708002b2cf9ae\",\n\tUDI: \"05d5cdd59c2e1b10939708002b2cf9ae\"\n};\nfunction parse_xls_props(cfb, props, o) {\n\t/* [MS-OSHARED] 2.3.3.2.2 Document Summary Information Property Set */\n\tvar DSI = CFB.find(cfb, '/!DocumentSummaryInformation');\n\tif(DSI && DSI.size > 0) try {\n\t\tvar DocSummary = parse_PropertySetStream(DSI, DocSummaryPIDDSI, PSCLSID.DSI);\n\t\tfor(var d in DocSummary) props[d] = DocSummary[d];\n\t} catch(e) {if(o.WTF) throw e;/* empty */}\n\n\t/* [MS-OSHARED] 2.3.3.2.1 Summary Information Property Set*/\n\tvar SI = CFB.find(cfb, '/!SummaryInformation');\n\tif(SI && SI.size > 0) try {\n\t\tvar Summary = parse_PropertySetStream(SI, SummaryPIDSI, PSCLSID.SI);\n\t\tfor(var s in Summary) if(props[s] == null) props[s] = Summary[s];\n\t} catch(e) {if(o.WTF) throw e;/* empty */}\n\n\tif(props.HeadingPairs && props.TitlesOfParts) {\n\t\tload_props_pairs(props.HeadingPairs, props.TitlesOfParts, props, o);\n\t\tdelete props.HeadingPairs; delete props.TitlesOfParts;\n\t}\n}\nfunction write_xls_props(wb, cfb) {\n\tvar DSEntries = [], SEntries = [], CEntries = [];\n\tvar i = 0, Keys;\n\tvar DocSummaryRE = evert_key(DocSummaryPIDDSI, \"n\");\n\tvar SummaryRE = evert_key(SummaryPIDSI, \"n\");\n\tif(wb.Props) {\n\t\tKeys = keys(wb.Props);\n\t\t// $FlowIgnore\n\t\tfor(i = 0; i < Keys.length; ++i) (Object.prototype.hasOwnProperty.call(DocSummaryRE, Keys[i]) ? DSEntries : Object.prototype.hasOwnProperty.call(SummaryRE, Keys[i]) ? SEntries : CEntries).push([Keys[i], wb.Props[Keys[i]]]);\n\t}\n\tif(wb.Custprops) {\n\t\tKeys = keys(wb.Custprops);\n\t\t// $FlowIgnore\n\t\tfor(i = 0; i < Keys.length; ++i) if(!Object.prototype.hasOwnProperty.call((wb.Props||{}), Keys[i])) (Object.prototype.hasOwnProperty.call(DocSummaryRE, Keys[i]) ? DSEntries : Object.prototype.hasOwnProperty.call(SummaryRE, Keys[i]) ? SEntries : CEntries).push([Keys[i], wb.Custprops[Keys[i]]]);\n\t}\n\tvar CEntries2 = [];\n\tfor(i = 0; i < CEntries.length; ++i) {\n\t\tif(XLSPSSkip.indexOf(CEntries[i][0]) > -1 || PseudoPropsPairs.indexOf(CEntries[i][0]) > -1) continue;\n\t\tif(CEntries[i][1] == null) continue;\n\t\tCEntries2.push(CEntries[i]);\n\t}\n\tif(SEntries.length) CFB.utils.cfb_add(cfb, \"/\\u0005SummaryInformation\", write_PropertySetStream(SEntries, PSCLSID.SI, SummaryRE, SummaryPIDSI));\n\tif(DSEntries.length || CEntries2.length) CFB.utils.cfb_add(cfb, \"/\\u0005DocumentSummaryInformation\", write_PropertySetStream(DSEntries, PSCLSID.DSI, DocSummaryRE, DocSummaryPIDDSI, CEntries2.length ? CEntries2 : null, PSCLSID.UDI));\n}\n\nfunction parse_xlscfb(cfb, options) {\nif(!options) options = {};\nfix_read_opts(options);\nreset_cp();\nif(options.codepage) set_ansi(options.codepage);\nvar CompObj, WB;\nif(cfb.FullPaths) {\n\tif(CFB.find(cfb, '/encryption')) throw new Error(\"File is password-protected\");\n\tCompObj = CFB.find(cfb, '!CompObj');\n\tWB = CFB.find(cfb, '/Workbook') || CFB.find(cfb, '/Book');\n} else {\n\tswitch(options.type) {\n\t\tcase 'base64': cfb = s2a(Base64_decode(cfb)); break;\n\t\tcase 'binary': cfb = s2a(cfb); break;\n\t\tcase 'buffer': break;\n\t\tcase 'array': if(!Array.isArray(cfb)) cfb = Array.prototype.slice.call(cfb); break;\n\t}\n\tprep_blob(cfb, 0);\n\tWB = ({content: cfb});\n}\nvar WorkbookP;\n\nvar _data;\nif(CompObj) parse_compobj(CompObj);\nif(options.bookProps && !options.bookSheets) WorkbookP = ({});\nelse {\n\tvar T = has_buf ? 'buffer' : 'array';\n\tif(WB && WB.content) WorkbookP = parse_workbook(WB.content, options);\n\t/* Quattro Pro 7-8 */\n\telse if((_data=CFB.find(cfb, 'PerfectOffice_MAIN')) && _data.content) WorkbookP = WK_.to_workbook(_data.content, (options.type = T, options));\n\t/* Quattro Pro 9 */\n\telse if((_data=CFB.find(cfb, 'NativeContent_MAIN')) && _data.content) WorkbookP = WK_.to_workbook(_data.content, (options.type = T, options));\n\t/* Works 4 for Mac */\n\telse if((_data=CFB.find(cfb, 'MN0')) && _data.content) throw new Error(\"Unsupported Works 4 for Mac file\");\n\telse throw new Error(\"Cannot find Workbook stream\");\n\tif(options.bookVBA && cfb.FullPaths && CFB.find(cfb, '/_VBA_PROJECT_CUR/VBA/dir')) WorkbookP.vbaraw = make_vba_xls(cfb);\n}\n\nvar props = {};\nif(cfb.FullPaths) parse_xls_props(cfb, props, options);\n\nWorkbookP.Props = WorkbookP.Custprops = props; /* TODO: split up properties */\nif(options.bookFiles) WorkbookP.cfb = cfb;\n/*WorkbookP.CompObjP = CompObjP; // TODO: storage? */\nreturn WorkbookP;\n}\n\n\nfunction write_xlscfb(wb, opts) {\n\tvar o = opts || {};\n\tvar cfb = CFB.utils.cfb_new({root:\"R\"});\n\tvar wbpath = \"/Workbook\";\n\tswitch(o.bookType || \"xls\") {\n\t\tcase \"xls\": o.bookType = \"biff8\";\n\t\t/* falls through */\n\t\tcase \"xla\": if(!o.bookType) o.bookType = \"xla\";\n\t\t/* falls through */\n\t\tcase \"biff8\": wbpath = \"/Workbook\"; o.biff = 8; break;\n\t\tcase \"biff5\": wbpath = \"/Book\"; o.biff = 5; break;\n\t\tdefault: throw new Error(\"invalid type \" + o.bookType + \" for XLS CFB\");\n\t}\n\tCFB.utils.cfb_add(cfb, wbpath, write_biff_buf(wb, o));\n\tif(o.biff == 8 && (wb.Props || wb.Custprops)) write_xls_props(wb, cfb);\n\t// TODO: SI, DSI, CO\n\tif(o.biff == 8 && wb.vbaraw) fill_vba_xls(cfb, CFB.read(wb.vbaraw, {type: typeof wb.vbaraw == \"string\" ? \"binary\" : \"buffer\"}));\n\treturn cfb;\n}\n/* [MS-XLSB] 2.3 Record Enumeration */\nvar XLSBRecordEnum = {\n0x0000: { /* n:\"BrtRowHdr\", */ f:parse_BrtRowHdr },\n0x0001: { /* n:\"BrtCellBlank\", */ f:parse_BrtCellBlank },\n0x0002: { /* n:\"BrtCellRk\", */ f:parse_BrtCellRk },\n0x0003: { /* n:\"BrtCellError\", */ f:parse_BrtCellError },\n0x0004: { /* n:\"BrtCellBool\", */ f:parse_BrtCellBool },\n0x0005: { /* n:\"BrtCellReal\", */ f:parse_BrtCellReal },\n0x0006: { /* n:\"BrtCellSt\", */ f:parse_BrtCellSt },\n0x0007: { /* n:\"BrtCellIsst\", */ f:parse_BrtCellIsst },\n0x0008: { /* n:\"BrtFmlaString\", */ f:parse_BrtFmlaString },\n0x0009: { /* n:\"BrtFmlaNum\", */ f:parse_BrtFmlaNum },\n0x000A: { /* n:\"BrtFmlaBool\", */ f:parse_BrtFmlaBool },\n0x000B: { /* n:\"BrtFmlaError\", */ f:parse_BrtFmlaError },\n0x000C: { /* n:\"BrtShortBlank\", */ f:parse_BrtShortBlank },\n0x000D: { /* n:\"BrtShortRk\", */ f:parse_BrtShortRk },\n0x000E: { /* n:\"BrtShortError\", */ f:parse_BrtShortError },\n0x000F: { /* n:\"BrtShortBool\", */ f:parse_BrtShortBool },\n0x0010: { /* n:\"BrtShortReal\", */ f:parse_BrtShortReal },\n0x0011: { /* n:\"BrtShortSt\", */ f:parse_BrtShortSt },\n0x0012: { /* n:\"BrtShortIsst\", */ f:parse_BrtShortIsst },\n0x0013: { /* n:\"BrtSSTItem\", */ f:parse_RichStr },\n0x0014: { /* n:\"BrtPCDIMissing\" */ },\n0x0015: { /* n:\"BrtPCDINumber\" */ },\n0x0016: { /* n:\"BrtPCDIBoolean\" */ },\n0x0017: { /* n:\"BrtPCDIError\" */ },\n0x0018: { /* n:\"BrtPCDIString\" */ },\n0x0019: { /* n:\"BrtPCDIDatetime\" */ },\n0x001A: { /* n:\"BrtPCDIIndex\" */ },\n0x001B: { /* n:\"BrtPCDIAMissing\" */ },\n0x001C: { /* n:\"BrtPCDIANumber\" */ },\n0x001D: { /* n:\"BrtPCDIABoolean\" */ },\n0x001E: { /* n:\"BrtPCDIAError\" */ },\n0x001F: { /* n:\"BrtPCDIAString\" */ },\n0x0020: { /* n:\"BrtPCDIADatetime\" */ },\n0x0021: { /* n:\"BrtPCRRecord\" */ },\n0x0022: { /* n:\"BrtPCRRecordDt\" */ },\n0x0023: { /* n:\"BrtFRTBegin\", */ T:1 },\n0x0024: { /* n:\"BrtFRTEnd\", */ T:-1 },\n0x0025: { /* n:\"BrtACBegin\", */ T:1 },\n0x0026: { /* n:\"BrtACEnd\", */ T:-1 },\n0x0027: { /* n:\"BrtName\", */ f:parse_BrtName },\n0x0028: { /* n:\"BrtIndexRowBlock\" */ },\n0x002A: { /* n:\"BrtIndexBlock\" */ },\n0x002B: { /* n:\"BrtFont\", */ f:parse_BrtFont },\n0x002C: { /* n:\"BrtFmt\", */ f:parse_BrtFmt },\n0x002D: { /* n:\"BrtFill\", */ f:parse_BrtFill },\n0x002E: { /* n:\"BrtBorder\", */ f:parse_BrtBorder },\n0x002F: { /* n:\"BrtXF\", */ f:parse_BrtXF },\n0x0030: { /* n:\"BrtStyle\" */ },\n0x0031: { /* n:\"BrtCellMeta\", */ f:parse_Int32LE },\n0x0032: { /* n:\"BrtValueMeta\" */ },\n0x0033: { /* n:\"BrtMdb\" */ f:parse_BrtMdb },\n0x0034: { /* n:\"BrtBeginFmd\", */ T:1 },\n0x0035: { /* n:\"BrtEndFmd\", */ T:-1 },\n0x0036: { /* n:\"BrtBeginMdx\", */ T:1 },\n0x0037: { /* n:\"BrtEndMdx\", */ T:-1 },\n0x0038: { /* n:\"BrtBeginMdxTuple\", */ T:1 },\n0x0039: { /* n:\"BrtEndMdxTuple\", */ T:-1 },\n0x003A: { /* n:\"BrtMdxMbrIstr\" */ },\n0x003B: { /* n:\"BrtStr\" */ },\n0x003C: { /* n:\"BrtColInfo\", */ f:parse_ColInfo },\n0x003E: { /* n:\"BrtCellRString\", */ f:parse_BrtCellRString },\n0x003F: { /* n:\"BrtCalcChainItem$\", */ f:parse_BrtCalcChainItem$ },\n0x0040: { /* n:\"BrtDVal\", */ f:parse_BrtDVal },\n0x0041: { /* n:\"BrtSxvcellNum\" */ },\n0x0042: { /* n:\"BrtSxvcellStr\" */ },\n0x0043: { /* n:\"BrtSxvcellBool\" */ },\n0x0044: { /* n:\"BrtSxvcellErr\" */ },\n0x0045: { /* n:\"BrtSxvcellDate\" */ },\n0x0046: { /* n:\"BrtSxvcellNil\" */ },\n0x0080: { /* n:\"BrtFileVersion\" */ },\n0x0081: { /* n:\"BrtBeginSheet\", */ T:1 },\n0x0082: { /* n:\"BrtEndSheet\", */ T:-1 },\n0x0083: { /* n:\"BrtBeginBook\", */ T:1, f:parsenoop, p:0 },\n0x0084: { /* n:\"BrtEndBook\", */ T:-1 },\n0x0085: { /* n:\"BrtBeginWsViews\", */ T:1 },\n0x0086: { /* n:\"BrtEndWsViews\", */ T:-1 },\n0x0087: { /* n:\"BrtBeginBookViews\", */ T:1 },\n0x0088: { /* n:\"BrtEndBookViews\", */ T:-1 },\n0x0089: { /* n:\"BrtBeginWsView\", */ T:1, f:parse_BrtBeginWsView },\n0x008A: { /* n:\"BrtEndWsView\", */ T:-1 },\n0x008B: { /* n:\"BrtBeginCsViews\", */ T:1 },\n0x008C: { /* n:\"BrtEndCsViews\", */ T:-1 },\n0x008D: { /* n:\"BrtBeginCsView\", */ T:1 },\n0x008E: { /* n:\"BrtEndCsView\", */ T:-1 },\n0x008F: { /* n:\"BrtBeginBundleShs\", */ T:1 },\n0x0090: { /* n:\"BrtEndBundleShs\", */ T:-1 },\n0x0091: { /* n:\"BrtBeginSheetData\", */ T:1 },\n0x0092: { /* n:\"BrtEndSheetData\", */ T:-1 },\n0x0093: { /* n:\"BrtWsProp\", */ f:parse_BrtWsProp },\n0x0094: { /* n:\"BrtWsDim\", */ f:parse_BrtWsDim, p:16 },\n0x0097: { /* n:\"BrtPane\", */ f:parse_BrtPane },\n0x0098: { /* n:\"BrtSel\" */ },\n0x0099: { /* n:\"BrtWbProp\", */ f:parse_BrtWbProp },\n0x009A: { /* n:\"BrtWbFactoid\" */ },\n0x009B: { /* n:\"BrtFileRecover\" */ },\n0x009C: { /* n:\"BrtBundleSh\", */ f:parse_BrtBundleSh },\n0x009D: { /* n:\"BrtCalcProp\" */ },\n0x009E: { /* n:\"BrtBookView\" */ },\n0x009F: { /* n:\"BrtBeginSst\", */ T:1, f:parse_BrtBeginSst },\n0x00A0: { /* n:\"BrtEndSst\", */ T:-1 },\n0x00A1: { /* n:\"BrtBeginAFilter\", */ T:1, f:parse_UncheckedRfX },\n0x00A2: { /* n:\"BrtEndAFilter\", */ T:-1 },\n0x00A3: { /* n:\"BrtBeginFilterColumn\", */ T:1 },\n0x00A4: { /* n:\"BrtEndFilterColumn\", */ T:-1 },\n0x00A5: { /* n:\"BrtBeginFilters\", */ T:1 },\n0x00A6: { /* n:\"BrtEndFilters\", */ T:-1 },\n0x00A7: { /* n:\"BrtFilter\" */ },\n0x00A8: { /* n:\"BrtColorFilter\" */ },\n0x00A9: { /* n:\"BrtIconFilter\" */ },\n0x00AA: { /* n:\"BrtTop10Filter\" */ },\n0x00AB: { /* n:\"BrtDynamicFilter\" */ },\n0x00AC: { /* n:\"BrtBeginCustomFilters\", */ T:1 },\n0x00AD: { /* n:\"BrtEndCustomFilters\", */ T:-1 },\n0x00AE: { /* n:\"BrtCustomFilter\" */ },\n0x00AF: { /* n:\"BrtAFilterDateGroupItem\" */ },\n0x00B0: { /* n:\"BrtMergeCell\", */ f:parse_BrtMergeCell },\n0x00B1: { /* n:\"BrtBeginMergeCells\", */ T:1 },\n0x00B2: { /* n:\"BrtEndMergeCells\", */ T:-1 },\n0x00B3: { /* n:\"BrtBeginPivotCacheDef\", */ T:1 },\n0x00B4: { /* n:\"BrtEndPivotCacheDef\", */ T:-1 },\n0x00B5: { /* n:\"BrtBeginPCDFields\", */ T:1 },\n0x00B6: { /* n:\"BrtEndPCDFields\", */ T:-1 },\n0x00B7: { /* n:\"BrtBeginPCDField\", */ T:1 },\n0x00B8: { /* n:\"BrtEndPCDField\", */ T:-1 },\n0x00B9: { /* n:\"BrtBeginPCDSource\", */ T:1 },\n0x00BA: { /* n:\"BrtEndPCDSource\", */ T:-1 },\n0x00BB: { /* n:\"BrtBeginPCDSRange\", */ T:1 },\n0x00BC: { /* n:\"BrtEndPCDSRange\", */ T:-1 },\n0x00BD: { /* n:\"BrtBeginPCDFAtbl\", */ T:1 },\n0x00BE: { /* n:\"BrtEndPCDFAtbl\", */ T:-1 },\n0x00BF: { /* n:\"BrtBeginPCDIRun\", */ T:1 },\n0x00C0: { /* n:\"BrtEndPCDIRun\", */ T:-1 },\n0x00C1: { /* n:\"BrtBeginPivotCacheRecords\", */ T:1 },\n0x00C2: { /* n:\"BrtEndPivotCacheRecords\", */ T:-1 },\n0x00C3: { /* n:\"BrtBeginPCDHierarchies\", */ T:1 },\n0x00C4: { /* n:\"BrtEndPCDHierarchies\", */ T:-1 },\n0x00C5: { /* n:\"BrtBeginPCDHierarchy\", */ T:1 },\n0x00C6: { /* n:\"BrtEndPCDHierarchy\", */ T:-1 },\n0x00C7: { /* n:\"BrtBeginPCDHFieldsUsage\", */ T:1 },\n0x00C8: { /* n:\"BrtEndPCDHFieldsUsage\", */ T:-1 },\n0x00C9: { /* n:\"BrtBeginExtConnection\", */ T:1 },\n0x00CA: { /* n:\"BrtEndExtConnection\", */ T:-1 },\n0x00CB: { /* n:\"BrtBeginECDbProps\", */ T:1 },\n0x00CC: { /* n:\"BrtEndECDbProps\", */ T:-1 },\n0x00CD: { /* n:\"BrtBeginECOlapProps\", */ T:1 },\n0x00CE: { /* n:\"BrtEndECOlapProps\", */ T:-1 },\n0x00CF: { /* n:\"BrtBeginPCDSConsol\", */ T:1 },\n0x00D0: { /* n:\"BrtEndPCDSConsol\", */ T:-1 },\n0x00D1: { /* n:\"BrtBeginPCDSCPages\", */ T:1 },\n0x00D2: { /* n:\"BrtEndPCDSCPages\", */ T:-1 },\n0x00D3: { /* n:\"BrtBeginPCDSCPage\", */ T:1 },\n0x00D4: { /* n:\"BrtEndPCDSCPage\", */ T:-1 },\n0x00D5: { /* n:\"BrtBeginPCDSCPItem\", */ T:1 },\n0x00D6: { /* n:\"BrtEndPCDSCPItem\", */ T:-1 },\n0x00D7: { /* n:\"BrtBeginPCDSCSets\", */ T:1 },\n0x00D8: { /* n:\"BrtEndPCDSCSets\", */ T:-1 },\n0x00D9: { /* n:\"BrtBeginPCDSCSet\", */ T:1 },\n0x00DA: { /* n:\"BrtEndPCDSCSet\", */ T:-1 },\n0x00DB: { /* n:\"BrtBeginPCDFGroup\", */ T:1 },\n0x00DC: { /* n:\"BrtEndPCDFGroup\", */ T:-1 },\n0x00DD: { /* n:\"BrtBeginPCDFGItems\", */ T:1 },\n0x00DE: { /* n:\"BrtEndPCDFGItems\", */ T:-1 },\n0x00DF: { /* n:\"BrtBeginPCDFGRange\", */ T:1 },\n0x00E0: { /* n:\"BrtEndPCDFGRange\", */ T:-1 },\n0x00E1: { /* n:\"BrtBeginPCDFGDiscrete\", */ T:1 },\n0x00E2: { /* n:\"BrtEndPCDFGDiscrete\", */ T:-1 },\n0x00E3: { /* n:\"BrtBeginPCDSDTupleCache\", */ T:1 },\n0x00E4: { /* n:\"BrtEndPCDSDTupleCache\", */ T:-1 },\n0x00E5: { /* n:\"BrtBeginPCDSDTCEntries\", */ T:1 },\n0x00E6: { /* n:\"BrtEndPCDSDTCEntries\", */ T:-1 },\n0x00E7: { /* n:\"BrtBeginPCDSDTCEMembers\", */ T:1 },\n0x00E8: { /* n:\"BrtEndPCDSDTCEMembers\", */ T:-1 },\n0x00E9: { /* n:\"BrtBeginPCDSDTCEMember\", */ T:1 },\n0x00EA: { /* n:\"BrtEndPCDSDTCEMember\", */ T:-1 },\n0x00EB: { /* n:\"BrtBeginPCDSDTCQueries\", */ T:1 },\n0x00EC: { /* n:\"BrtEndPCDSDTCQueries\", */ T:-1 },\n0x00ED: { /* n:\"BrtBeginPCDSDTCQuery\", */ T:1 },\n0x00EE: { /* n:\"BrtEndPCDSDTCQuery\", */ T:-1 },\n0x00EF: { /* n:\"BrtBeginPCDSDTCSets\", */ T:1 },\n0x00F0: { /* n:\"BrtEndPCDSDTCSets\", */ T:-1 },\n0x00F1: { /* n:\"BrtBeginPCDSDTCSet\", */ T:1 },\n0x00F2: { /* n:\"BrtEndPCDSDTCSet\", */ T:-1 },\n0x00F3: { /* n:\"BrtBeginPCDCalcItems\", */ T:1 },\n0x00F4: { /* n:\"BrtEndPCDCalcItems\", */ T:-1 },\n0x00F5: { /* n:\"BrtBeginPCDCalcItem\", */ T:1 },\n0x00F6: { /* n:\"BrtEndPCDCalcItem\", */ T:-1 },\n0x00F7: { /* n:\"BrtBeginPRule\", */ T:1 },\n0x00F8: { /* n:\"BrtEndPRule\", */ T:-1 },\n0x00F9: { /* n:\"BrtBeginPRFilters\", */ T:1 },\n0x00FA: { /* n:\"BrtEndPRFilters\", */ T:-1 },\n0x00FB: { /* n:\"BrtBeginPRFilter\", */ T:1 },\n0x00FC: { /* n:\"BrtEndPRFilter\", */ T:-1 },\n0x00FD: { /* n:\"BrtBeginPNames\", */ T:1 },\n0x00FE: { /* n:\"BrtEndPNames\", */ T:-1 },\n0x00FF: { /* n:\"BrtBeginPName\", */ T:1 },\n0x0100: { /* n:\"BrtEndPName\", */ T:-1 },\n0x0101: { /* n:\"BrtBeginPNPairs\", */ T:1 },\n0x0102: { /* n:\"BrtEndPNPairs\", */ T:-1 },\n0x0103: { /* n:\"BrtBeginPNPair\", */ T:1 },\n0x0104: { /* n:\"BrtEndPNPair\", */ T:-1 },\n0x0105: { /* n:\"BrtBeginECWebProps\", */ T:1 },\n0x0106: { /* n:\"BrtEndECWebProps\", */ T:-1 },\n0x0107: { /* n:\"BrtBeginEcWpTables\", */ T:1 },\n0x0108: { /* n:\"BrtEndECWPTables\", */ T:-1 },\n0x0109: { /* n:\"BrtBeginECParams\", */ T:1 },\n0x010A: { /* n:\"BrtEndECParams\", */ T:-1 },\n0x010B: { /* n:\"BrtBeginECParam\", */ T:1 },\n0x010C: { /* n:\"BrtEndECParam\", */ T:-1 },\n0x010D: { /* n:\"BrtBeginPCDKPIs\", */ T:1 },\n0x010E: { /* n:\"BrtEndPCDKPIs\", */ T:-1 },\n0x010F: { /* n:\"BrtBeginPCDKPI\", */ T:1 },\n0x0110: { /* n:\"BrtEndPCDKPI\", */ T:-1 },\n0x0111: { /* n:\"BrtBeginDims\", */ T:1 },\n0x0112: { /* n:\"BrtEndDims\", */ T:-1 },\n0x0113: { /* n:\"BrtBeginDim\", */ T:1 },\n0x0114: { /* n:\"BrtEndDim\", */ T:-1 },\n0x0115: { /* n:\"BrtIndexPartEnd\" */ },\n0x0116: { /* n:\"BrtBeginStyleSheet\", */ T:1 },\n0x0117: { /* n:\"BrtEndStyleSheet\", */ T:-1 },\n0x0118: { /* n:\"BrtBeginSXView\", */ T:1 },\n0x0119: { /* n:\"BrtEndSXVI\", */ T:-1 },\n0x011A: { /* n:\"BrtBeginSXVI\", */ T:1 },\n0x011B: { /* n:\"BrtBeginSXVIs\", */ T:1 },\n0x011C: { /* n:\"BrtEndSXVIs\", */ T:-1 },\n0x011D: { /* n:\"BrtBeginSXVD\", */ T:1 },\n0x011E: { /* n:\"BrtEndSXVD\", */ T:-1 },\n0x011F: { /* n:\"BrtBeginSXVDs\", */ T:1 },\n0x0120: { /* n:\"BrtEndSXVDs\", */ T:-1 },\n0x0121: { /* n:\"BrtBeginSXPI\", */ T:1 },\n0x0122: { /* n:\"BrtEndSXPI\", */ T:-1 },\n0x0123: { /* n:\"BrtBeginSXPIs\", */ T:1 },\n0x0124: { /* n:\"BrtEndSXPIs\", */ T:-1 },\n0x0125: { /* n:\"BrtBeginSXDI\", */ T:1 },\n0x0126: { /* n:\"BrtEndSXDI\", */ T:-1 },\n0x0127: { /* n:\"BrtBeginSXDIs\", */ T:1 },\n0x0128: { /* n:\"BrtEndSXDIs\", */ T:-1 },\n0x0129: { /* n:\"BrtBeginSXLI\", */ T:1 },\n0x012A: { /* n:\"BrtEndSXLI\", */ T:-1 },\n0x012B: { /* n:\"BrtBeginSXLIRws\", */ T:1 },\n0x012C: { /* n:\"BrtEndSXLIRws\", */ T:-1 },\n0x012D: { /* n:\"BrtBeginSXLICols\", */ T:1 },\n0x012E: { /* n:\"BrtEndSXLICols\", */ T:-1 },\n0x012F: { /* n:\"BrtBeginSXFormat\", */ T:1 },\n0x0130: { /* n:\"BrtEndSXFormat\", */ T:-1 },\n0x0131: { /* n:\"BrtBeginSXFormats\", */ T:1 },\n0x0132: { /* n:\"BrtEndSxFormats\", */ T:-1 },\n0x0133: { /* n:\"BrtBeginSxSelect\", */ T:1 },\n0x0134: { /* n:\"BrtEndSxSelect\", */ T:-1 },\n0x0135: { /* n:\"BrtBeginISXVDRws\", */ T:1 },\n0x0136: { /* n:\"BrtEndISXVDRws\", */ T:-1 },\n0x0137: { /* n:\"BrtBeginISXVDCols\", */ T:1 },\n0x0138: { /* n:\"BrtEndISXVDCols\", */ T:-1 },\n0x0139: { /* n:\"BrtEndSXLocation\", */ T:-1 },\n0x013A: { /* n:\"BrtBeginSXLocation\", */ T:1 },\n0x013B: { /* n:\"BrtEndSXView\", */ T:-1 },\n0x013C: { /* n:\"BrtBeginSXTHs\", */ T:1 },\n0x013D: { /* n:\"BrtEndSXTHs\", */ T:-1 },\n0x013E: { /* n:\"BrtBeginSXTH\", */ T:1 },\n0x013F: { /* n:\"BrtEndSXTH\", */ T:-1 },\n0x0140: { /* n:\"BrtBeginISXTHRws\", */ T:1 },\n0x0141: { /* n:\"BrtEndISXTHRws\", */ T:-1 },\n0x0142: { /* n:\"BrtBeginISXTHCols\", */ T:1 },\n0x0143: { /* n:\"BrtEndISXTHCols\", */ T:-1 },\n0x0144: { /* n:\"BrtBeginSXTDMPS\", */ T:1 },\n0x0145: { /* n:\"BrtEndSXTDMPs\", */ T:-1 },\n0x0146: { /* n:\"BrtBeginSXTDMP\", */ T:1 },\n0x0147: { /* n:\"BrtEndSXTDMP\", */ T:-1 },\n0x0148: { /* n:\"BrtBeginSXTHItems\", */ T:1 },\n0x0149: { /* n:\"BrtEndSXTHItems\", */ T:-1 },\n0x014A: { /* n:\"BrtBeginSXTHItem\", */ T:1 },\n0x014B: { /* n:\"BrtEndSXTHItem\", */ T:-1 },\n0x014C: { /* n:\"BrtBeginMetadata\", */ T:1 },\n0x014D: { /* n:\"BrtEndMetadata\", */ T:-1 },\n0x014E: { /* n:\"BrtBeginEsmdtinfo\", */ T:1 },\n0x014F: { /* n:\"BrtMdtinfo\", */ f:parse_BrtMdtinfo },\n0x0150: { /* n:\"BrtEndEsmdtinfo\", */ T:-1 },\n0x0151: { /* n:\"BrtBeginEsmdb\", */ f:parse_BrtBeginEsmdb, T:1 },\n0x0152: { /* n:\"BrtEndEsmdb\", */ T:-1 },\n0x0153: { /* n:\"BrtBeginEsfmd\", */ T:1 },\n0x0154: { /* n:\"BrtEndEsfmd\", */ T:-1 },\n0x0155: { /* n:\"BrtBeginSingleCells\", */ T:1 },\n0x0156: { /* n:\"BrtEndSingleCells\", */ T:-1 },\n0x0157: { /* n:\"BrtBeginList\", */ T:1 },\n0x0158: { /* n:\"BrtEndList\", */ T:-1 },\n0x0159: { /* n:\"BrtBeginListCols\", */ T:1 },\n0x015A: { /* n:\"BrtEndListCols\", */ T:-1 },\n0x015B: { /* n:\"BrtBeginListCol\", */ T:1 },\n0x015C: { /* n:\"BrtEndListCol\", */ T:-1 },\n0x015D: { /* n:\"BrtBeginListXmlCPr\", */ T:1 },\n0x015E: { /* n:\"BrtEndListXmlCPr\", */ T:-1 },\n0x015F: { /* n:\"BrtListCCFmla\" */ },\n0x0160: { /* n:\"BrtListTrFmla\" */ },\n0x0161: { /* n:\"BrtBeginExternals\", */ T:1 },\n0x0162: { /* n:\"BrtEndExternals\", */ T:-1 },\n0x0163: { /* n:\"BrtSupBookSrc\", */ f:parse_RelID},\n0x0165: { /* n:\"BrtSupSelf\" */ },\n0x0166: { /* n:\"BrtSupSame\" */ },\n0x0167: { /* n:\"BrtSupTabs\" */ },\n0x0168: { /* n:\"BrtBeginSupBook\", */ T:1 },\n0x0169: { /* n:\"BrtPlaceholderName\" */ },\n0x016A: { /* n:\"BrtExternSheet\", */ f:parse_ExternSheet },\n0x016B: { /* n:\"BrtExternTableStart\" */ },\n0x016C: { /* n:\"BrtExternTableEnd\" */ },\n0x016E: { /* n:\"BrtExternRowHdr\" */ },\n0x016F: { /* n:\"BrtExternCellBlank\" */ },\n0x0170: { /* n:\"BrtExternCellReal\" */ },\n0x0171: { /* n:\"BrtExternCellBool\" */ },\n0x0172: { /* n:\"BrtExternCellError\" */ },\n0x0173: { /* n:\"BrtExternCellString\" */ },\n0x0174: { /* n:\"BrtBeginEsmdx\", */ T:1 },\n0x0175: { /* n:\"BrtEndEsmdx\", */ T:-1 },\n0x0176: { /* n:\"BrtBeginMdxSet\", */ T:1 },\n0x0177: { /* n:\"BrtEndMdxSet\", */ T:-1 },\n0x0178: { /* n:\"BrtBeginMdxMbrProp\", */ T:1 },\n0x0179: { /* n:\"BrtEndMdxMbrProp\", */ T:-1 },\n0x017A: { /* n:\"BrtBeginMdxKPI\", */ T:1 },\n0x017B: { /* n:\"BrtEndMdxKPI\", */ T:-1 },\n0x017C: { /* n:\"BrtBeginEsstr\", */ T:1 },\n0x017D: { /* n:\"BrtEndEsstr\", */ T:-1 },\n0x017E: { /* n:\"BrtBeginPRFItem\", */ T:1 },\n0x017F: { /* n:\"BrtEndPRFItem\", */ T:-1 },\n0x0180: { /* n:\"BrtBeginPivotCacheIDs\", */ T:1 },\n0x0181: { /* n:\"BrtEndPivotCacheIDs\", */ T:-1 },\n0x0182: { /* n:\"BrtBeginPivotCacheID\", */ T:1 },\n0x0183: { /* n:\"BrtEndPivotCacheID\", */ T:-1 },\n0x0184: { /* n:\"BrtBeginISXVIs\", */ T:1 },\n0x0185: { /* n:\"BrtEndISXVIs\", */ T:-1 },\n0x0186: { /* n:\"BrtBeginColInfos\", */ T:1 },\n0x0187: { /* n:\"BrtEndColInfos\", */ T:-1 },\n0x0188: { /* n:\"BrtBeginRwBrk\", */ T:1 },\n0x0189: { /* n:\"BrtEndRwBrk\", */ T:-1 },\n0x018A: { /* n:\"BrtBeginColBrk\", */ T:1 },\n0x018B: { /* n:\"BrtEndColBrk\", */ T:-1 },\n0x018C: { /* n:\"BrtBrk\" */ },\n0x018D: { /* n:\"BrtUserBookView\" */ },\n0x018E: { /* n:\"BrtInfo\" */ },\n0x018F: { /* n:\"BrtCUsr\" */ },\n0x0190: { /* n:\"BrtUsr\" */ },\n0x0191: { /* n:\"BrtBeginUsers\", */ T:1 },\n0x0193: { /* n:\"BrtEOF\" */ },\n0x0194: { /* n:\"BrtUCR\" */ },\n0x0195: { /* n:\"BrtRRInsDel\" */ },\n0x0196: { /* n:\"BrtRREndInsDel\" */ },\n0x0197: { /* n:\"BrtRRMove\" */ },\n0x0198: { /* n:\"BrtRREndMove\" */ },\n0x0199: { /* n:\"BrtRRChgCell\" */ },\n0x019A: { /* n:\"BrtRREndChgCell\" */ },\n0x019B: { /* n:\"BrtRRHeader\" */ },\n0x019C: { /* n:\"BrtRRUserView\" */ },\n0x019D: { /* n:\"BrtRRRenSheet\" */ },\n0x019E: { /* n:\"BrtRRInsertSh\" */ },\n0x019F: { /* n:\"BrtRRDefName\" */ },\n0x01A0: { /* n:\"BrtRRNote\" */ },\n0x01A1: { /* n:\"BrtRRConflict\" */ },\n0x01A2: { /* n:\"BrtRRTQSIF\" */ },\n0x01A3: { /* n:\"BrtRRFormat\" */ },\n0x01A4: { /* n:\"BrtRREndFormat\" */ },\n0x01A5: { /* n:\"BrtRRAutoFmt\" */ },\n0x01A6: { /* n:\"BrtBeginUserShViews\", */ T:1 },\n0x01A7: { /* n:\"BrtBeginUserShView\", */ T:1 },\n0x01A8: { /* n:\"BrtEndUserShView\", */ T:-1 },\n0x01A9: { /* n:\"BrtEndUserShViews\", */ T:-1 },\n0x01AA: { /* n:\"BrtArrFmla\", */ f:parse_BrtArrFmla },\n0x01AB: { /* n:\"BrtShrFmla\", */ f:parse_BrtShrFmla },\n0x01AC: { /* n:\"BrtTable\" */ },\n0x01AD: { /* n:\"BrtBeginExtConnections\", */ T:1 },\n0x01AE: { /* n:\"BrtEndExtConnections\", */ T:-1 },\n0x01AF: { /* n:\"BrtBeginPCDCalcMems\", */ T:1 },\n0x01B0: { /* n:\"BrtEndPCDCalcMems\", */ T:-1 },\n0x01B1: { /* n:\"BrtBeginPCDCalcMem\", */ T:1 },\n0x01B2: { /* n:\"BrtEndPCDCalcMem\", */ T:-1 },\n0x01B3: { /* n:\"BrtBeginPCDHGLevels\", */ T:1 },\n0x01B4: { /* n:\"BrtEndPCDHGLevels\", */ T:-1 },\n0x01B5: { /* n:\"BrtBeginPCDHGLevel\", */ T:1 },\n0x01B6: { /* n:\"BrtEndPCDHGLevel\", */ T:-1 },\n0x01B7: { /* n:\"BrtBeginPCDHGLGroups\", */ T:1 },\n0x01B8: { /* n:\"BrtEndPCDHGLGroups\", */ T:-1 },\n0x01B9: { /* n:\"BrtBeginPCDHGLGroup\", */ T:1 },\n0x01BA: { /* n:\"BrtEndPCDHGLGroup\", */ T:-1 },\n0x01BB: { /* n:\"BrtBeginPCDHGLGMembers\", */ T:1 },\n0x01BC: { /* n:\"BrtEndPCDHGLGMembers\", */ T:-1 },\n0x01BD: { /* n:\"BrtBeginPCDHGLGMember\", */ T:1 },\n0x01BE: { /* n:\"BrtEndPCDHGLGMember\", */ T:-1 },\n0x01BF: { /* n:\"BrtBeginQSI\", */ T:1 },\n0x01C0: { /* n:\"BrtEndQSI\", */ T:-1 },\n0x01C1: { /* n:\"BrtBeginQSIR\", */ T:1 },\n0x01C2: { /* n:\"BrtEndQSIR\", */ T:-1 },\n0x01C3: { /* n:\"BrtBeginDeletedNames\", */ T:1 },\n0x01C4: { /* n:\"BrtEndDeletedNames\", */ T:-1 },\n0x01C5: { /* n:\"BrtBeginDeletedName\", */ T:1 },\n0x01C6: { /* n:\"BrtEndDeletedName\", */ T:-1 },\n0x01C7: { /* n:\"BrtBeginQSIFs\", */ T:1 },\n0x01C8: { /* n:\"BrtEndQSIFs\", */ T:-1 },\n0x01C9: { /* n:\"BrtBeginQSIF\", */ T:1 },\n0x01CA: { /* n:\"BrtEndQSIF\", */ T:-1 },\n0x01CB: { /* n:\"BrtBeginAutoSortScope\", */ T:1 },\n0x01CC: { /* n:\"BrtEndAutoSortScope\", */ T:-1 },\n0x01CD: { /* n:\"BrtBeginConditionalFormatting\", */ T:1 },\n0x01CE: { /* n:\"BrtEndConditionalFormatting\", */ T:-1 },\n0x01CF: { /* n:\"BrtBeginCFRule\", */ T:1 },\n0x01D0: { /* n:\"BrtEndCFRule\", */ T:-1 },\n0x01D1: { /* n:\"BrtBeginIconSet\", */ T:1 },\n0x01D2: { /* n:\"BrtEndIconSet\", */ T:-1 },\n0x01D3: { /* n:\"BrtBeginDatabar\", */ T:1 },\n0x01D4: { /* n:\"BrtEndDatabar\", */ T:-1 },\n0x01D5: { /* n:\"BrtBeginColorScale\", */ T:1 },\n0x01D6: { /* n:\"BrtEndColorScale\", */ T:-1 },\n0x01D7: { /* n:\"BrtCFVO\" */ },\n0x01D8: { /* n:\"BrtExternValueMeta\" */ },\n0x01D9: { /* n:\"BrtBeginColorPalette\", */ T:1 },\n0x01DA: { /* n:\"BrtEndColorPalette\", */ T:-1 },\n0x01DB: { /* n:\"BrtIndexedColor\" */ },\n0x01DC: { /* n:\"BrtMargins\", */ f:parse_BrtMargins },\n0x01DD: { /* n:\"BrtPrintOptions\" */ },\n0x01DE: { /* n:\"BrtPageSetup\" */ },\n0x01DF: { /* n:\"BrtBeginHeaderFooter\", */ T:1 },\n0x01E0: { /* n:\"BrtEndHeaderFooter\", */ T:-1 },\n0x01E1: { /* n:\"BrtBeginSXCrtFormat\", */ T:1 },\n0x01E2: { /* n:\"BrtEndSXCrtFormat\", */ T:-1 },\n0x01E3: { /* n:\"BrtBeginSXCrtFormats\", */ T:1 },\n0x01E4: { /* n:\"BrtEndSXCrtFormats\", */ T:-1 },\n0x01E5: { /* n:\"BrtWsFmtInfo\", */ f:parse_BrtWsFmtInfo },\n0x01E6: { /* n:\"BrtBeginMgs\", */ T:1 },\n0x01E7: { /* n:\"BrtEndMGs\", */ T:-1 },\n0x01E8: { /* n:\"BrtBeginMGMaps\", */ T:1 },\n0x01E9: { /* n:\"BrtEndMGMaps\", */ T:-1 },\n0x01EA: { /* n:\"BrtBeginMG\", */ T:1 },\n0x01EB: { /* n:\"BrtEndMG\", */ T:-1 },\n0x01EC: { /* n:\"BrtBeginMap\", */ T:1 },\n0x01ED: { /* n:\"BrtEndMap\", */ T:-1 },\n0x01EE: { /* n:\"BrtHLink\", */ f:parse_BrtHLink },\n0x01EF: { /* n:\"BrtBeginDCon\", */ T:1 },\n0x01F0: { /* n:\"BrtEndDCon\", */ T:-1 },\n0x01F1: { /* n:\"BrtBeginDRefs\", */ T:1 },\n0x01F2: { /* n:\"BrtEndDRefs\", */ T:-1 },\n0x01F3: { /* n:\"BrtDRef\" */ },\n0x01F4: { /* n:\"BrtBeginScenMan\", */ T:1 },\n0x01F5: { /* n:\"BrtEndScenMan\", */ T:-1 },\n0x01F6: { /* n:\"BrtBeginSct\", */ T:1 },\n0x01F7: { /* n:\"BrtEndSct\", */ T:-1 },\n0x01F8: { /* n:\"BrtSlc\" */ },\n0x01F9: { /* n:\"BrtBeginDXFs\", */ T:1 },\n0x01FA: { /* n:\"BrtEndDXFs\", */ T:-1 },\n0x01FB: { /* n:\"BrtDXF\" */ },\n0x01FC: { /* n:\"BrtBeginTableStyles\", */ T:1 },\n0x01FD: { /* n:\"BrtEndTableStyles\", */ T:-1 },\n0x01FE: { /* n:\"BrtBeginTableStyle\", */ T:1 },\n0x01FF: { /* n:\"BrtEndTableStyle\", */ T:-1 },\n0x0200: { /* n:\"BrtTableStyleElement\" */ },\n0x0201: { /* n:\"BrtTableStyleClient\" */ },\n0x0202: { /* n:\"BrtBeginVolDeps\", */ T:1 },\n0x0203: { /* n:\"BrtEndVolDeps\", */ T:-1 },\n0x0204: { /* n:\"BrtBeginVolType\", */ T:1 },\n0x0205: { /* n:\"BrtEndVolType\", */ T:-1 },\n0x0206: { /* n:\"BrtBeginVolMain\", */ T:1 },\n0x0207: { /* n:\"BrtEndVolMain\", */ T:-1 },\n0x0208: { /* n:\"BrtBeginVolTopic\", */ T:1 },\n0x0209: { /* n:\"BrtEndVolTopic\", */ T:-1 },\n0x020A: { /* n:\"BrtVolSubtopic\" */ },\n0x020B: { /* n:\"BrtVolRef\" */ },\n0x020C: { /* n:\"BrtVolNum\" */ },\n0x020D: { /* n:\"BrtVolErr\" */ },\n0x020E: { /* n:\"BrtVolStr\" */ },\n0x020F: { /* n:\"BrtVolBool\" */ },\n0x0210: { /* n:\"BrtBeginCalcChain$\", */ T:1 },\n0x0211: { /* n:\"BrtEndCalcChain$\", */ T:-1 },\n0x0212: { /* n:\"BrtBeginSortState\", */ T:1 },\n0x0213: { /* n:\"BrtEndSortState\", */ T:-1 },\n0x0214: { /* n:\"BrtBeginSortCond\", */ T:1 },\n0x0215: { /* n:\"BrtEndSortCond\", */ T:-1 },\n0x0216: { /* n:\"BrtBookProtection\" */ },\n0x0217: { /* n:\"BrtSheetProtection\" */ },\n0x0218: { /* n:\"BrtRangeProtection\" */ },\n0x0219: { /* n:\"BrtPhoneticInfo\" */ },\n0x021A: { /* n:\"BrtBeginECTxtWiz\", */ T:1 },\n0x021B: { /* n:\"BrtEndECTxtWiz\", */ T:-1 },\n0x021C: { /* n:\"BrtBeginECTWFldInfoLst\", */ T:1 },\n0x021D: { /* n:\"BrtEndECTWFldInfoLst\", */ T:-1 },\n0x021E: { /* n:\"BrtBeginECTwFldInfo\", */ T:1 },\n0x0224: { /* n:\"BrtFileSharing\" */ },\n0x0225: { /* n:\"BrtOleSize\" */ },\n0x0226: { /* n:\"BrtDrawing\", */ f:parse_RelID },\n0x0227: { /* n:\"BrtLegacyDrawing\" */ },\n0x0228: { /* n:\"BrtLegacyDrawingHF\" */ },\n0x0229: { /* n:\"BrtWebOpt\" */ },\n0x022A: { /* n:\"BrtBeginWebPubItems\", */ T:1 },\n0x022B: { /* n:\"BrtEndWebPubItems\", */ T:-1 },\n0x022C: { /* n:\"BrtBeginWebPubItem\", */ T:1 },\n0x022D: { /* n:\"BrtEndWebPubItem\", */ T:-1 },\n0x022E: { /* n:\"BrtBeginSXCondFmt\", */ T:1 },\n0x022F: { /* n:\"BrtEndSXCondFmt\", */ T:-1 },\n0x0230: { /* n:\"BrtBeginSXCondFmts\", */ T:1 },\n0x0231: { /* n:\"BrtEndSXCondFmts\", */ T:-1 },\n0x0232: { /* n:\"BrtBkHim\" */ },\n0x0234: { /* n:\"BrtColor\" */ },\n0x0235: { /* n:\"BrtBeginIndexedColors\", */ T:1 },\n0x0236: { /* n:\"BrtEndIndexedColors\", */ T:-1 },\n0x0239: { /* n:\"BrtBeginMRUColors\", */ T:1 },\n0x023A: { /* n:\"BrtEndMRUColors\", */ T:-1 },\n0x023C: { /* n:\"BrtMRUColor\" */ },\n0x023D: { /* n:\"BrtBeginDVals\", */ T:1 },\n0x023E: { /* n:\"BrtEndDVals\", */ T:-1 },\n0x0241: { /* n:\"BrtSupNameStart\" */ },\n0x0242: { /* n:\"BrtSupNameValueStart\" */ },\n0x0243: { /* n:\"BrtSupNameValueEnd\" */ },\n0x0244: { /* n:\"BrtSupNameNum\" */ },\n0x0245: { /* n:\"BrtSupNameErr\" */ },\n0x0246: { /* n:\"BrtSupNameSt\" */ },\n0x0247: { /* n:\"BrtSupNameNil\" */ },\n0x0248: { /* n:\"BrtSupNameBool\" */ },\n0x0249: { /* n:\"BrtSupNameFmla\" */ },\n0x024A: { /* n:\"BrtSupNameBits\" */ },\n0x024B: { /* n:\"BrtSupNameEnd\" */ },\n0x024C: { /* n:\"BrtEndSupBook\", */ T:-1 },\n0x024D: { /* n:\"BrtCellSmartTagProperty\" */ },\n0x024E: { /* n:\"BrtBeginCellSmartTag\", */ T:1 },\n0x024F: { /* n:\"BrtEndCellSmartTag\", */ T:-1 },\n0x0250: { /* n:\"BrtBeginCellSmartTags\", */ T:1 },\n0x0251: { /* n:\"BrtEndCellSmartTags\", */ T:-1 },\n0x0252: { /* n:\"BrtBeginSmartTags\", */ T:1 },\n0x0253: { /* n:\"BrtEndSmartTags\", */ T:-1 },\n0x0254: { /* n:\"BrtSmartTagType\" */ },\n0x0255: { /* n:\"BrtBeginSmartTagTypes\", */ T:1 },\n0x0256: { /* n:\"BrtEndSmartTagTypes\", */ T:-1 },\n0x0257: { /* n:\"BrtBeginSXFilters\", */ T:1 },\n0x0258: { /* n:\"BrtEndSXFilters\", */ T:-1 },\n0x0259: { /* n:\"BrtBeginSXFILTER\", */ T:1 },\n0x025A: { /* n:\"BrtEndSXFilter\", */ T:-1 },\n0x025B: { /* n:\"BrtBeginFills\", */ T:1 },\n0x025C: { /* n:\"BrtEndFills\", */ T:-1 },\n0x025D: { /* n:\"BrtBeginCellWatches\", */ T:1 },\n0x025E: { /* n:\"BrtEndCellWatches\", */ T:-1 },\n0x025F: { /* n:\"BrtCellWatch\" */ },\n0x0260: { /* n:\"BrtBeginCRErrs\", */ T:1 },\n0x0261: { /* n:\"BrtEndCRErrs\", */ T:-1 },\n0x0262: { /* n:\"BrtCrashRecErr\" */ },\n0x0263: { /* n:\"BrtBeginFonts\", */ T:1 },\n0x0264: { /* n:\"BrtEndFonts\", */ T:-1 },\n0x0265: { /* n:\"BrtBeginBorders\", */ T:1 },\n0x0266: { /* n:\"BrtEndBorders\", */ T:-1 },\n0x0267: { /* n:\"BrtBeginFmts\", */ T:1 },\n0x0268: { /* n:\"BrtEndFmts\", */ T:-1 },\n0x0269: { /* n:\"BrtBeginCellXFs\", */ T:1 },\n0x026A: { /* n:\"BrtEndCellXFs\", */ T:-1 },\n0x026B: { /* n:\"BrtBeginStyles\", */ T:1 },\n0x026C: { /* n:\"BrtEndStyles\", */ T:-1 },\n0x0271: { /* n:\"BrtBigName\" */ },\n0x0272: { /* n:\"BrtBeginCellStyleXFs\", */ T:1 },\n0x0273: { /* n:\"BrtEndCellStyleXFs\", */ T:-1 },\n0x0274: { /* n:\"BrtBeginComments\", */ T:1 },\n0x0275: { /* n:\"BrtEndComments\", */ T:-1 },\n0x0276: { /* n:\"BrtBeginCommentAuthors\", */ T:1 },\n0x0277: { /* n:\"BrtEndCommentAuthors\", */ T:-1 },\n0x0278: { /* n:\"BrtCommentAuthor\", */ f:parse_BrtCommentAuthor },\n0x0279: { /* n:\"BrtBeginCommentList\", */ T:1 },\n0x027A: { /* n:\"BrtEndCommentList\", */ T:-1 },\n0x027B: { /* n:\"BrtBeginComment\", */ T:1, f:parse_BrtBeginComment},\n0x027C: { /* n:\"BrtEndComment\", */ T:-1 },\n0x027D: { /* n:\"BrtCommentText\", */ f:parse_BrtCommentText },\n0x027E: { /* n:\"BrtBeginOleObjects\", */ T:1 },\n0x027F: { /* n:\"BrtOleObject\" */ },\n0x0280: { /* n:\"BrtEndOleObjects\", */ T:-1 },\n0x0281: { /* n:\"BrtBeginSxrules\", */ T:1 },\n0x0282: { /* n:\"BrtEndSxRules\", */ T:-1 },\n0x0283: { /* n:\"BrtBeginActiveXControls\", */ T:1 },\n0x0284: { /* n:\"BrtActiveX\" */ },\n0x0285: { /* n:\"BrtEndActiveXControls\", */ T:-1 },\n0x0286: { /* n:\"BrtBeginPCDSDTCEMembersSortBy\", */ T:1 },\n0x0288: { /* n:\"BrtBeginCellIgnoreECs\", */ T:1 },\n0x0289: { /* n:\"BrtCellIgnoreEC\" */ },\n0x028A: { /* n:\"BrtEndCellIgnoreECs\", */ T:-1 },\n0x028B: { /* n:\"BrtCsProp\", */ f:parse_BrtCsProp },\n0x028C: { /* n:\"BrtCsPageSetup\" */ },\n0x028D: { /* n:\"BrtBeginUserCsViews\", */ T:1 },\n0x028E: { /* n:\"BrtEndUserCsViews\", */ T:-1 },\n0x028F: { /* n:\"BrtBeginUserCsView\", */ T:1 },\n0x0290: { /* n:\"BrtEndUserCsView\", */ T:-1 },\n0x0291: { /* n:\"BrtBeginPcdSFCIEntries\", */ T:1 },\n0x0292: { /* n:\"BrtEndPCDSFCIEntries\", */ T:-1 },\n0x0293: { /* n:\"BrtPCDSFCIEntry\" */ },\n0x0294: { /* n:\"BrtBeginListParts\", */ T:1 },\n0x0295: { /* n:\"BrtListPart\" */ },\n0x0296: { /* n:\"BrtEndListParts\", */ T:-1 },\n0x0297: { /* n:\"BrtSheetCalcProp\" */ },\n0x0298: { /* n:\"BrtBeginFnGroup\", */ T:1 },\n0x0299: { /* n:\"BrtFnGroup\" */ },\n0x029A: { /* n:\"BrtEndFnGroup\", */ T:-1 },\n0x029B: { /* n:\"BrtSupAddin\" */ },\n0x029C: { /* n:\"BrtSXTDMPOrder\" */ },\n0x029D: { /* n:\"BrtCsProtection\" */ },\n0x029F: { /* n:\"BrtBeginWsSortMap\", */ T:1 },\n0x02A0: { /* n:\"BrtEndWsSortMap\", */ T:-1 },\n0x02A1: { /* n:\"BrtBeginRRSort\", */ T:1 },\n0x02A2: { /* n:\"BrtEndRRSort\", */ T:-1 },\n0x02A3: { /* n:\"BrtRRSortItem\" */ },\n0x02A4: { /* n:\"BrtFileSharingIso\" */ },\n0x02A5: { /* n:\"BrtBookProtectionIso\" */ },\n0x02A6: { /* n:\"BrtSheetProtectionIso\" */ },\n0x02A7: { /* n:\"BrtCsProtectionIso\" */ },\n0x02A8: { /* n:\"BrtRangeProtectionIso\" */ },\n0x02A9: { /* n:\"BrtDValList\" */ },\n0x0400: { /* n:\"BrtRwDescent\" */ },\n0x0401: { /* n:\"BrtKnownFonts\" */ },\n0x0402: { /* n:\"BrtBeginSXTupleSet\", */ T:1 },\n0x0403: { /* n:\"BrtEndSXTupleSet\", */ T:-1 },\n0x0404: { /* n:\"BrtBeginSXTupleSetHeader\", */ T:1 },\n0x0405: { /* n:\"BrtEndSXTupleSetHeader\", */ T:-1 },\n0x0406: { /* n:\"BrtSXTupleSetHeaderItem\" */ },\n0x0407: { /* n:\"BrtBeginSXTupleSetData\", */ T:1 },\n0x0408: { /* n:\"BrtEndSXTupleSetData\", */ T:-1 },\n0x0409: { /* n:\"BrtBeginSXTupleSetRow\", */ T:1 },\n0x040A: { /* n:\"BrtEndSXTupleSetRow\", */ T:-1 },\n0x040B: { /* n:\"BrtSXTupleSetRowItem\" */ },\n0x040C: { /* n:\"BrtNameExt\" */ },\n0x040D: { /* n:\"BrtPCDH14\" */ },\n0x040E: { /* n:\"BrtBeginPCDCalcMem14\", */ T:1 },\n0x040F: { /* n:\"BrtEndPCDCalcMem14\", */ T:-1 },\n0x0410: { /* n:\"BrtSXTH14\" */ },\n0x0411: { /* n:\"BrtBeginSparklineGroup\", */ T:1 },\n0x0412: { /* n:\"BrtEndSparklineGroup\", */ T:-1 },\n0x0413: { /* n:\"BrtSparkline\" */ },\n0x0414: { /* n:\"BrtSXDI14\" */ },\n0x0415: { /* n:\"BrtWsFmtInfoEx14\" */ },\n0x0416: { /* n:\"BrtBeginConditionalFormatting14\", */ T:1 },\n0x0417: { /* n:\"BrtEndConditionalFormatting14\", */ T:-1 },\n0x0418: { /* n:\"BrtBeginCFRule14\", */ T:1 },\n0x0419: { /* n:\"BrtEndCFRule14\", */ T:-1 },\n0x041A: { /* n:\"BrtCFVO14\" */ },\n0x041B: { /* n:\"BrtBeginDatabar14\", */ T:1 },\n0x041C: { /* n:\"BrtBeginIconSet14\", */ T:1 },\n0x041D: { /* n:\"BrtDVal14\", */ f: parse_BrtDVal14 },\n0x041E: { /* n:\"BrtBeginDVals14\", */ T:1 },\n0x041F: { /* n:\"BrtColor14\" */ },\n0x0420: { /* n:\"BrtBeginSparklines\", */ T:1 },\n0x0421: { /* n:\"BrtEndSparklines\", */ T:-1 },\n0x0422: { /* n:\"BrtBeginSparklineGroups\", */ T:1 },\n0x0423: { /* n:\"BrtEndSparklineGroups\", */ T:-1 },\n0x0425: { /* n:\"BrtSXVD14\" */ },\n0x0426: { /* n:\"BrtBeginSXView14\", */ T:1 },\n0x0427: { /* n:\"BrtEndSXView14\", */ T:-1 },\n0x0428: { /* n:\"BrtBeginSXView16\", */ T:1 },\n0x0429: { /* n:\"BrtEndSXView16\", */ T:-1 },\n0x042A: { /* n:\"BrtBeginPCD14\", */ T:1 },\n0x042B: { /* n:\"BrtEndPCD14\", */ T:-1 },\n0x042C: { /* n:\"BrtBeginExtConn14\", */ T:1 },\n0x042D: { /* n:\"BrtEndExtConn14\", */ T:-1 },\n0x042E: { /* n:\"BrtBeginSlicerCacheIDs\", */ T:1 },\n0x042F: { /* n:\"BrtEndSlicerCacheIDs\", */ T:-1 },\n0x0430: { /* n:\"BrtBeginSlicerCacheID\", */ T:1 },\n0x0431: { /* n:\"BrtEndSlicerCacheID\", */ T:-1 },\n0x0433: { /* n:\"BrtBeginSlicerCache\", */ T:1 },\n0x0434: { /* n:\"BrtEndSlicerCache\", */ T:-1 },\n0x0435: { /* n:\"BrtBeginSlicerCacheDef\", */ T:1 },\n0x0436: { /* n:\"BrtEndSlicerCacheDef\", */ T:-1 },\n0x0437: { /* n:\"BrtBeginSlicersEx\", */ T:1 },\n0x0438: { /* n:\"BrtEndSlicersEx\", */ T:-1 },\n0x0439: { /* n:\"BrtBeginSlicerEx\", */ T:1 },\n0x043A: { /* n:\"BrtEndSlicerEx\", */ T:-1 },\n0x043B: { /* n:\"BrtBeginSlicer\", */ T:1 },\n0x043C: { /* n:\"BrtEndSlicer\", */ T:-1 },\n0x043D: { /* n:\"BrtSlicerCachePivotTables\" */ },\n0x043E: { /* n:\"BrtBeginSlicerCacheOlapImpl\", */ T:1 },\n0x043F: { /* n:\"BrtEndSlicerCacheOlapImpl\", */ T:-1 },\n0x0440: { /* n:\"BrtBeginSlicerCacheLevelsData\", */ T:1 },\n0x0441: { /* n:\"BrtEndSlicerCacheLevelsData\", */ T:-1 },\n0x0442: { /* n:\"BrtBeginSlicerCacheLevelData\", */ T:1 },\n0x0443: { /* n:\"BrtEndSlicerCacheLevelData\", */ T:-1 },\n0x0444: { /* n:\"BrtBeginSlicerCacheSiRanges\", */ T:1 },\n0x0445: { /* n:\"BrtEndSlicerCacheSiRanges\", */ T:-1 },\n0x0446: { /* n:\"BrtBeginSlicerCacheSiRange\", */ T:1 },\n0x0447: { /* n:\"BrtEndSlicerCacheSiRange\", */ T:-1 },\n0x0448: { /* n:\"BrtSlicerCacheOlapItem\" */ },\n0x0449: { /* n:\"BrtBeginSlicerCacheSelections\", */ T:1 },\n0x044A: { /* n:\"BrtSlicerCacheSelection\" */ },\n0x044B: { /* n:\"BrtEndSlicerCacheSelections\", */ T:-1 },\n0x044C: { /* n:\"BrtBeginSlicerCacheNative\", */ T:1 },\n0x044D: { /* n:\"BrtEndSlicerCacheNative\", */ T:-1 },\n0x044E: { /* n:\"BrtSlicerCacheNativeItem\" */ },\n0x044F: { /* n:\"BrtRangeProtection14\" */ },\n0x0450: { /* n:\"BrtRangeProtectionIso14\" */ },\n0x0451: { /* n:\"BrtCellIgnoreEC14\" */ },\n0x0457: { /* n:\"BrtList14\" */ },\n0x0458: { /* n:\"BrtCFIcon\" */ },\n0x0459: { /* n:\"BrtBeginSlicerCachesPivotCacheIDs\", */ T:1 },\n0x045A: { /* n:\"BrtEndSlicerCachesPivotCacheIDs\", */ T:-1 },\n0x045B: { /* n:\"BrtBeginSlicers\", */ T:1 },\n0x045C: { /* n:\"BrtEndSlicers\", */ T:-1 },\n0x045D: { /* n:\"BrtWbProp14\" */ },\n0x045E: { /* n:\"BrtBeginSXEdit\", */ T:1 },\n0x045F: { /* n:\"BrtEndSXEdit\", */ T:-1 },\n0x0460: { /* n:\"BrtBeginSXEdits\", */ T:1 },\n0x0461: { /* n:\"BrtEndSXEdits\", */ T:-1 },\n0x0462: { /* n:\"BrtBeginSXChange\", */ T:1 },\n0x0463: { /* n:\"BrtEndSXChange\", */ T:-1 },\n0x0464: { /* n:\"BrtBeginSXChanges\", */ T:1 },\n0x0465: { /* n:\"BrtEndSXChanges\", */ T:-1 },\n0x0466: { /* n:\"BrtSXTupleItems\" */ },\n0x0468: { /* n:\"BrtBeginSlicerStyle\", */ T:1 },\n0x0469: { /* n:\"BrtEndSlicerStyle\", */ T:-1 },\n0x046A: { /* n:\"BrtSlicerStyleElement\" */ },\n0x046B: { /* n:\"BrtBeginStyleSheetExt14\", */ T:1 },\n0x046C: { /* n:\"BrtEndStyleSheetExt14\", */ T:-1 },\n0x046D: { /* n:\"BrtBeginSlicerCachesPivotCacheID\", */ T:1 },\n0x046E: { /* n:\"BrtEndSlicerCachesPivotCacheID\", */ T:-1 },\n0x046F: { /* n:\"BrtBeginConditionalFormattings\", */ T:1 },\n0x0470: { /* n:\"BrtEndConditionalFormattings\", */ T:-1 },\n0x0471: { /* n:\"BrtBeginPCDCalcMemExt\", */ T:1 },\n0x0472: { /* n:\"BrtEndPCDCalcMemExt\", */ T:-1 },\n0x0473: { /* n:\"BrtBeginPCDCalcMemsExt\", */ T:1 },\n0x0474: { /* n:\"BrtEndPCDCalcMemsExt\", */ T:-1 },\n0x0475: { /* n:\"BrtPCDField14\" */ },\n0x0476: { /* n:\"BrtBeginSlicerStyles\", */ T:1 },\n0x0477: { /* n:\"BrtEndSlicerStyles\", */ T:-1 },\n0x0478: { /* n:\"BrtBeginSlicerStyleElements\", */ T:1 },\n0x0479: { /* n:\"BrtEndSlicerStyleElements\", */ T:-1 },\n0x047A: { /* n:\"BrtCFRuleExt\" */ },\n0x047B: { /* n:\"BrtBeginSXCondFmt14\", */ T:1 },\n0x047C: { /* n:\"BrtEndSXCondFmt14\", */ T:-1 },\n0x047D: { /* n:\"BrtBeginSXCondFmts14\", */ T:1 },\n0x047E: { /* n:\"BrtEndSXCondFmts14\", */ T:-1 },\n0x0480: { /* n:\"BrtBeginSortCond14\", */ T:1 },\n0x0481: { /* n:\"BrtEndSortCond14\", */ T:-1 },\n0x0482: { /* n:\"BrtEndDVals14\", */ T:-1 },\n0x0483: { /* n:\"BrtEndIconSet14\", */ T:-1 },\n0x0484: { /* n:\"BrtEndDatabar14\", */ T:-1 },\n0x0485: { /* n:\"BrtBeginColorScale14\", */ T:1 },\n0x0486: { /* n:\"BrtEndColorScale14\", */ T:-1 },\n0x0487: { /* n:\"BrtBeginSxrules14\", */ T:1 },\n0x0488: { /* n:\"BrtEndSxrules14\", */ T:-1 },\n0x0489: { /* n:\"BrtBeginPRule14\", */ T:1 },\n0x048A: { /* n:\"BrtEndPRule14\", */ T:-1 },\n0x048B: { /* n:\"BrtBeginPRFilters14\", */ T:1 },\n0x048C: { /* n:\"BrtEndPRFilters14\", */ T:-1 },\n0x048D: { /* n:\"BrtBeginPRFilter14\", */ T:1 },\n0x048E: { /* n:\"BrtEndPRFilter14\", */ T:-1 },\n0x048F: { /* n:\"BrtBeginPRFItem14\", */ T:1 },\n0x0490: { /* n:\"BrtEndPRFItem14\", */ T:-1 },\n0x0491: { /* n:\"BrtBeginCellIgnoreECs14\", */ T:1 },\n0x0492: { /* n:\"BrtEndCellIgnoreECs14\", */ T:-1 },\n0x0493: { /* n:\"BrtDxf14\" */ },\n0x0494: { /* n:\"BrtBeginDxF14s\", */ T:1 },\n0x0495: { /* n:\"BrtEndDxf14s\", */ T:-1 },\n0x0499: { /* n:\"BrtFilter14\" */ },\n0x049A: { /* n:\"BrtBeginCustomFilters14\", */ T:1 },\n0x049C: { /* n:\"BrtCustomFilter14\" */ },\n0x049D: { /* n:\"BrtIconFilter14\" */ },\n0x049E: { /* n:\"BrtPivotCacheConnectionName\" */ },\n0x0800: { /* n:\"BrtBeginDecoupledPivotCacheIDs\", */ T:1 },\n0x0801: { /* n:\"BrtEndDecoupledPivotCacheIDs\", */ T:-1 },\n0x0802: { /* n:\"BrtDecoupledPivotCacheID\" */ },\n0x0803: { /* n:\"BrtBeginPivotTableRefs\", */ T:1 },\n0x0804: { /* n:\"BrtEndPivotTableRefs\", */ T:-1 },\n0x0805: { /* n:\"BrtPivotTableRef\" */ },\n0x0806: { /* n:\"BrtSlicerCacheBookPivotTables\" */ },\n0x0807: { /* n:\"BrtBeginSxvcells\", */ T:1 },\n0x0808: { /* n:\"BrtEndSxvcells\", */ T:-1 },\n0x0809: { /* n:\"BrtBeginSxRow\", */ T:1 },\n0x080A: { /* n:\"BrtEndSxRow\", */ T:-1 },\n0x080C: { /* n:\"BrtPcdCalcMem15\" */ },\n0x0813: { /* n:\"BrtQsi15\" */ },\n0x0814: { /* n:\"BrtBeginWebExtensions\", */ T:1 },\n0x0815: { /* n:\"BrtEndWebExtensions\", */ T:-1 },\n0x0816: { /* n:\"BrtWebExtension\" */ },\n0x0817: { /* n:\"BrtAbsPath15\" */ },\n0x0818: { /* n:\"BrtBeginPivotTableUISettings\", */ T:1 },\n0x0819: { /* n:\"BrtEndPivotTableUISettings\", */ T:-1 },\n0x081B: { /* n:\"BrtTableSlicerCacheIDs\" */ },\n0x081C: { /* n:\"BrtTableSlicerCacheID\" */ },\n0x081D: { /* n:\"BrtBeginTableSlicerCache\", */ T:1 },\n0x081E: { /* n:\"BrtEndTableSlicerCache\", */ T:-1 },\n0x081F: { /* n:\"BrtSxFilter15\" */ },\n0x0820: { /* n:\"BrtBeginTimelineCachePivotCacheIDs\", */ T:1 },\n0x0821: { /* n:\"BrtEndTimelineCachePivotCacheIDs\", */ T:-1 },\n0x0822: { /* n:\"BrtTimelineCachePivotCacheID\" */ },\n0x0823: { /* n:\"BrtBeginTimelineCacheIDs\", */ T:1 },\n0x0824: { /* n:\"BrtEndTimelineCacheIDs\", */ T:-1 },\n0x0825: { /* n:\"BrtBeginTimelineCacheID\", */ T:1 },\n0x0826: { /* n:\"BrtEndTimelineCacheID\", */ T:-1 },\n0x0827: { /* n:\"BrtBeginTimelinesEx\", */ T:1 },\n0x0828: { /* n:\"BrtEndTimelinesEx\", */ T:-1 },\n0x0829: { /* n:\"BrtBeginTimelineEx\", */ T:1 },\n0x082A: { /* n:\"BrtEndTimelineEx\", */ T:-1 },\n0x082B: { /* n:\"BrtWorkBookPr15\" */ },\n0x082C: { /* n:\"BrtPCDH15\" */ },\n0x082D: { /* n:\"BrtBeginTimelineStyle\", */ T:1 },\n0x082E: { /* n:\"BrtEndTimelineStyle\", */ T:-1 },\n0x082F: { /* n:\"BrtTimelineStyleElement\" */ },\n0x0830: { /* n:\"BrtBeginTimelineStylesheetExt15\", */ T:1 },\n0x0831: { /* n:\"BrtEndTimelineStylesheetExt15\", */ T:-1 },\n0x0832: { /* n:\"BrtBeginTimelineStyles\", */ T:1 },\n0x0833: { /* n:\"BrtEndTimelineStyles\", */ T:-1 },\n0x0834: { /* n:\"BrtBeginTimelineStyleElements\", */ T:1 },\n0x0835: { /* n:\"BrtEndTimelineStyleElements\", */ T:-1 },\n0x0836: { /* n:\"BrtDxf15\" */ },\n0x0837: { /* n:\"BrtBeginDxfs15\", */ T:1 },\n0x0838: { /* n:\"BrtEndDxfs15\", */ T:-1 },\n0x0839: { /* n:\"BrtSlicerCacheHideItemsWithNoData\" */ },\n0x083A: { /* n:\"BrtBeginItemUniqueNames\", */ T:1 },\n0x083B: { /* n:\"BrtEndItemUniqueNames\", */ T:-1 },\n0x083C: { /* n:\"BrtItemUniqueName\" */ },\n0x083D: { /* n:\"BrtBeginExtConn15\", */ T:1 },\n0x083E: { /* n:\"BrtEndExtConn15\", */ T:-1 },\n0x083F: { /* n:\"BrtBeginOledbPr15\", */ T:1 },\n0x0840: { /* n:\"BrtEndOledbPr15\", */ T:-1 },\n0x0841: { /* n:\"BrtBeginDataFeedPr15\", */ T:1 },\n0x0842: { /* n:\"BrtEndDataFeedPr15\", */ T:-1 },\n0x0843: { /* n:\"BrtTextPr15\" */ },\n0x0844: { /* n:\"BrtRangePr15\" */ },\n0x0845: { /* n:\"BrtDbCommand15\" */ },\n0x0846: { /* n:\"BrtBeginDbTables15\", */ T:1 },\n0x0847: { /* n:\"BrtEndDbTables15\", */ T:-1 },\n0x0848: { /* n:\"BrtDbTable15\" */ },\n0x0849: { /* n:\"BrtBeginDataModel\", */ T:1 },\n0x084A: { /* n:\"BrtEndDataModel\", */ T:-1 },\n0x084B: { /* n:\"BrtBeginModelTables\", */ T:1 },\n0x084C: { /* n:\"BrtEndModelTables\", */ T:-1 },\n0x084D: { /* n:\"BrtModelTable\" */ },\n0x084E: { /* n:\"BrtBeginModelRelationships\", */ T:1 },\n0x084F: { /* n:\"BrtEndModelRelationships\", */ T:-1 },\n0x0850: { /* n:\"BrtModelRelationship\" */ },\n0x0851: { /* n:\"BrtBeginECTxtWiz15\", */ T:1 },\n0x0852: { /* n:\"BrtEndECTxtWiz15\", */ T:-1 },\n0x0853: { /* n:\"BrtBeginECTWFldInfoLst15\", */ T:1 },\n0x0854: { /* n:\"BrtEndECTWFldInfoLst15\", */ T:-1 },\n0x0855: { /* n:\"BrtBeginECTWFldInfo15\", */ T:1 },\n0x0856: { /* n:\"BrtFieldListActiveItem\" */ },\n0x0857: { /* n:\"BrtPivotCacheIdVersion\" */ },\n0x0858: { /* n:\"BrtSXDI15\" */ },\n0x0859: { /* n:\"BrtBeginModelTimeGroupings\", */ T:1 },\n0x085A: { /* n:\"BrtEndModelTimeGroupings\", */ T:-1 },\n0x085B: { /* n:\"BrtBeginModelTimeGrouping\", */ T:1 },\n0x085C: { /* n:\"BrtEndModelTimeGrouping\", */ T:-1 },\n0x085D: { /* n:\"BrtModelTimeGroupingCalcCol\" */ },\n0x0C00: { /* n:\"BrtUid\" */ },\n0x0C01: { /* n:\"BrtRevisionPtr\" */ },\n0x1000: { /* n:\"BrtBeginDynamicArrayPr\", */ T:1 },\n0x1001: { /* n:\"BrtEndDynamicArrayPr\", */ T:-1 },\n0x138A: { /* n:\"BrtBeginRichValueBlock\", */ T:1 },\n0x138B: { /* n:\"BrtEndRichValueBlock\", */ T:-1 },\n0x13D9: { /* n:\"BrtBeginRichFilters\", */ T:1 },\n0x13DA: { /* n:\"BrtEndRichFilters\", */ T:-1 },\n0x13DB: { /* n:\"BrtRichFilter\" */ },\n0x13DC: { /* n:\"BrtBeginRichFilterColumn\", */ T:1 },\n0x13DD: { /* n:\"BrtEndRichFilterColumn\", */ T:-1 },\n0x13DE: { /* n:\"BrtBeginCustomRichFilters\", */ T:1 },\n0x13DF: { /* n:\"BrtEndCustomRichFilters\", */ T:-1 },\n0x13E0: { /* n:\"BrtCustomRichFilter\" */ },\n0x13E1: { /* n:\"BrtTop10RichFilter\" */ },\n0x13E2: { /* n:\"BrtDynamicRichFilter\" */ },\n0x13E4: { /* n:\"BrtBeginRichSortCondition\", */ T:1 },\n0x13E5: { /* n:\"BrtEndRichSortCondition\", */ T:-1 },\n0x13E6: { /* n:\"BrtRichFilterDateGroupItem\" */ },\n0x13E7: { /* n:\"BrtBeginCalcFeatures\", */ T:1 },\n0x13E8: { /* n:\"BrtEndCalcFeatures\", */ T:-1 },\n0x13E9: { /* n:\"BrtCalcFeature\" */ },\n0x13EB: { /* n:\"BrtExternalLinksPr\" */ },\n0xFFFF: { n:\"\" }\n};\n\n/* [MS-XLS] 2.3 Record Enumeration (and other sources) */\nvar XLSRecordEnum = {\n\t/* [MS-XLS] 2.3 Record Enumeration 2021-08-17 */\n0x0006: { /* n:\"Formula\", */ f:parse_Formula },\n0x000a: { /* n:\"EOF\", */ f:parsenoop2 },\n0x000c: { /* n:\"CalcCount\", */ f:parseuint16 }, //\n0x000d: { /* n:\"CalcMode\", */ f:parseuint16 }, //\n0x000e: { /* n:\"CalcPrecision\", */ f:parsebool }, //\n0x000f: { /* n:\"CalcRefMode\", */ f:parsebool }, //\n0x0010: { /* n:\"CalcDelta\", */ f:parse_Xnum }, //\n0x0011: { /* n:\"CalcIter\", */ f:parsebool }, //\n0x0012: { /* n:\"Protect\", */ f:parsebool },\n0x0013: { /* n:\"Password\", */ f:parseuint16 },\n0x0014: { /* n:\"Header\", */ f:parse_XLHeaderFooter },\n0x0015: { /* n:\"Footer\", */ f:parse_XLHeaderFooter },\n0x0017: { /* n:\"ExternSheet\", */ f:parse_ExternSheet },\n0x0018: { /* n:\"Lbl\", */ f:parse_Lbl },\n0x0019: { /* n:\"WinProtect\", */ f:parsebool },\n0x001a: { /* n:\"VerticalPageBreaks\", */ },\n0x001b: { /* n:\"HorizontalPageBreaks\", */ },\n0x001c: { /* n:\"Note\", */ f:parse_Note },\n0x001d: { /* n:\"Selection\", */ },\n0x0022: { /* n:\"Date1904\", */ f:parsebool },\n0x0023: { /* n:\"ExternName\", */ f:parse_ExternName },\n0x0026: { /* n:\"LeftMargin\", */ f:parse_Xnum }, // *\n0x0027: { /* n:\"RightMargin\", */ f:parse_Xnum }, // *\n0x0028: { /* n:\"TopMargin\", */ f:parse_Xnum }, // *\n0x0029: { /* n:\"BottomMargin\", */ f:parse_Xnum }, // *\n0x002a: { /* n:\"PrintRowCol\", */ f:parsebool },\n0x002b: { /* n:\"PrintGrid\", */ f:parsebool },\n0x002f: { /* n:\"FilePass\", */ f:parse_FilePass },\n0x0031: { /* n:\"Font\", */ f:parse_Font },\n0x0033: { /* n:\"PrintSize\", */ f:parseuint16 },\n0x003c: { /* n:\"Continue\", */ },\n0x003d: { /* n:\"Window1\", */ f:parse_Window1 },\n0x0040: { /* n:\"Backup\", */ f:parsebool },\n0x0041: { /* n:\"Pane\", */ f:parse_Pane },\n0x0042: { /* n:\"CodePage\", */ f:parseuint16 },\n0x004d: { /* n:\"Pls\", */ },\n0x0050: { /* n:\"DCon\", */ },\n0x0051: { /* n:\"DConRef\", */ },\n0x0052: { /* n:\"DConName\", */ },\n0x0055: { /* n:\"DefColWidth\", */ f:parseuint16 },\n0x0059: { /* n:\"XCT\", */ },\n0x005a: { /* n:\"CRN\", */ },\n0x005b: { /* n:\"FileSharing\", */ },\n0x005c: { /* n:\"WriteAccess\", */ f:parse_WriteAccess },\n0x005d: { /* n:\"Obj\", */ f:parse_Obj },\n0x005e: { /* n:\"Uncalced\", */ },\n0x005f: { /* n:\"CalcSaveRecalc\", */ f:parsebool }, //\n0x0060: { /* n:\"Template\", */ },\n0x0061: { /* n:\"Intl\", */ },\n0x0063: { /* n:\"ObjProtect\", */ f:parsebool },\n0x007d: { /* n:\"ColInfo\", */ f:parse_ColInfo },\n0x0080: { /* n:\"Guts\", */ f:parse_Guts },\n0x0081: { /* n:\"WsBool\", */ f:parse_WsBool },\n0x0082: { /* n:\"GridSet\", */ f:parseuint16 },\n0x0083: { /* n:\"HCenter\", */ f:parsebool },\n0x0084: { /* n:\"VCenter\", */ f:parsebool },\n0x0085: { /* n:\"BoundSheet8\", */ f:parse_BoundSheet8 },\n0x0086: { /* n:\"WriteProtect\", */ },\n0x008c: { /* n:\"Country\", */ f:parse_Country },\n0x008d: { /* n:\"HideObj\", */ f:parseuint16 },\n0x0090: { /* n:\"Sort\", */ },\n0x0092: { /* n:\"Palette\", */ f:parse_Palette },\n0x0097: { /* n:\"Sync\", */ },\n0x0098: { /* n:\"LPr\", */ },\n0x0099: { /* n:\"DxGCol\", */ },\n0x009a: { /* n:\"FnGroupName\", */ },\n0x009b: { /* n:\"FilterMode\", */ },\n0x009c: { /* n:\"BuiltInFnGroupCount\", */ f:parseuint16 },\n0x009d: { /* n:\"AutoFilterInfo\", */ },\n0x009e: { /* n:\"AutoFilter\", */ },\n0x00a0: { /* n:\"Scl\", */ f:parse_Scl },\n0x00a1: { /* n:\"Setup\", */ f:parse_Setup },\n0x00ae: { /* n:\"ScenMan\", */ },\n0x00af: { /* n:\"SCENARIO\", */ },\n0x00b0: { /* n:\"SxView\", */ },\n0x00b1: { /* n:\"Sxvd\", */ },\n0x00b2: { /* n:\"SXVI\", */ },\n0x00b4: { /* n:\"SxIvd\", */ },\n0x00b5: { /* n:\"SXLI\", */ },\n0x00b6: { /* n:\"SXPI\", */ },\n0x00b8: { /* n:\"DocRoute\", */ },\n0x00b9: { /* n:\"RecipName\", */ },\n0x00bd: { /* n:\"MulRk\", */ f:parse_MulRk },\n0x00be: { /* n:\"MulBlank\", */ f:parse_MulBlank },\n0x00c1: { /* n:\"Mms\", */ f:parsenoop2 },\n0x00c5: { /* n:\"SXDI\", */ },\n0x00c6: { /* n:\"SXDB\", */ },\n0x00c7: { /* n:\"SXFDB\", */ },\n0x00c8: { /* n:\"SXDBB\", */ },\n0x00c9: { /* n:\"SXNum\", */ },\n0x00ca: { /* n:\"SxBool\", */ f:parsebool },\n0x00cb: { /* n:\"SxErr\", */ },\n0x00cc: { /* n:\"SXInt\", */ },\n0x00cd: { /* n:\"SXString\", */ },\n0x00ce: { /* n:\"SXDtr\", */ },\n0x00cf: { /* n:\"SxNil\", */ },\n0x00d0: { /* n:\"SXTbl\", */ },\n0x00d1: { /* n:\"SXTBRGIITM\", */ },\n0x00d2: { /* n:\"SxTbpg\", */ },\n0x00d3: { /* n:\"ObProj\", */ },\n0x00d5: { /* n:\"SXStreamID\", */ },\n0x00d7: { /* n:\"DBCell\", */ },\n0x00d8: { /* n:\"SXRng\", */ },\n0x00d9: { /* n:\"SxIsxoper\", */ },\n0x00da: { /* n:\"BookBool\", */ f:parseuint16 },\n0x00dc: { /* n:\"DbOrParamQry\", */ },\n0x00dd: { /* n:\"ScenarioProtect\", */ f:parsebool },\n0x00de: { /* n:\"OleObjectSize\", */ },\n0x00e0: { /* n:\"XF\", */ f:parse_XF },\n0x00e1: { /* n:\"InterfaceHdr\", */ f:parse_InterfaceHdr },\n0x00e2: { /* n:\"InterfaceEnd\", */ f:parsenoop2 },\n0x00e3: { /* n:\"SXVS\", */ },\n0x00e5: { /* n:\"MergeCells\", */ f:parse_MergeCells },\n0x00e9: { /* n:\"BkHim\", */ },\n0x00eb: { /* n:\"MsoDrawingGroup\", */ },\n0x00ec: { /* n:\"MsoDrawing\", */ },\n0x00ed: { /* n:\"MsoDrawingSelection\", */ },\n0x00ef: { /* n:\"PhoneticInfo\", */ },\n0x00f0: { /* n:\"SxRule\", */ },\n0x00f1: { /* n:\"SXEx\", */ },\n0x00f2: { /* n:\"SxFilt\", */ },\n0x00f4: { /* n:\"SxDXF\", */ },\n0x00f5: { /* n:\"SxItm\", */ },\n0x00f6: { /* n:\"SxName\", */ },\n0x00f7: { /* n:\"SxSelect\", */ },\n0x00f8: { /* n:\"SXPair\", */ },\n0x00f9: { /* n:\"SxFmla\", */ },\n0x00fb: { /* n:\"SxFormat\", */ },\n0x00fc: { /* n:\"SST\", */ f:parse_SST },\n0x00fd: { /* n:\"LabelSst\", */ f:parse_LabelSst },\n0x00ff: { /* n:\"ExtSST\", */ f:parse_ExtSST },\n0x0100: { /* n:\"SXVDEx\", */ },\n0x0103: { /* n:\"SXFormula\", */ },\n0x0122: { /* n:\"SXDBEx\", */ },\n0x0137: { /* n:\"RRDInsDel\", */ },\n0x0138: { /* n:\"RRDHead\", */ },\n0x013b: { /* n:\"RRDChgCell\", */ },\n0x013d: { /* n:\"RRTabId\", */ f:parseuint16a },\n0x013e: { /* n:\"RRDRenSheet\", */ },\n0x013f: { /* n:\"RRSort\", */ },\n0x0140: { /* n:\"RRDMove\", */ },\n0x014a: { /* n:\"RRFormat\", */ },\n0x014b: { /* n:\"RRAutoFmt\", */ },\n0x014d: { /* n:\"RRInsertSh\", */ },\n0x014e: { /* n:\"RRDMoveBegin\", */ },\n0x014f: { /* n:\"RRDMoveEnd\", */ },\n0x0150: { /* n:\"RRDInsDelBegin\", */ },\n0x0151: { /* n:\"RRDInsDelEnd\", */ },\n0x0152: { /* n:\"RRDConflict\", */ },\n0x0153: { /* n:\"RRDDefName\", */ },\n0x0154: { /* n:\"RRDRstEtxp\", */ },\n0x015f: { /* n:\"LRng\", */ },\n0x0160: { /* n:\"UsesELFs\", */ f:parsebool },\n0x0161: { /* n:\"DSF\", */ f:parsenoop2 },\n0x0191: { /* n:\"CUsr\", */ },\n0x0192: { /* n:\"CbUsr\", */ },\n0x0193: { /* n:\"UsrInfo\", */ },\n0x0194: { /* n:\"UsrExcl\", */ },\n0x0195: { /* n:\"FileLock\", */ },\n0x0196: { /* n:\"RRDInfo\", */ },\n0x0197: { /* n:\"BCUsrs\", */ },\n0x0198: { /* n:\"UsrChk\", */ },\n0x01a9: { /* n:\"UserBView\", */ },\n0x01aa: { /* n:\"UserSViewBegin\", */ },\n0x01ab: { /* n:\"UserSViewEnd\", */ },\n0x01ac: { /* n:\"RRDUserView\", */ },\n0x01ad: { /* n:\"Qsi\", */ },\n0x01ae: { /* n:\"SupBook\", */ f:parse_SupBook },\n0x01af: { /* n:\"Prot4Rev\", */ f:parsebool },\n0x01b0: { /* n:\"CondFmt\", */ },\n0x01b1: { /* n:\"CF\", */ },\n0x01b2: { /* n:\"DVal\", */ },\n0x01b5: { /* n:\"DConBin\", */ },\n0x01b6: { /* n:\"TxO\", */ f:parse_TxO },\n0x01b7: { /* n:\"RefreshAll\", */ f:parsebool }, //\n0x01b8: { /* n:\"HLink\", */ f:parse_HLink },\n0x01b9: { /* n:\"Lel\", */ },\n0x01ba: { /* n:\"CodeName\", */ f:parse_XLUnicodeString },\n0x01bb: { /* n:\"SXFDBType\", */ },\n0x01bc: { /* n:\"Prot4RevPass\", */ f:parseuint16 },\n0x01bd: { /* n:\"ObNoMacros\", */ },\n0x01be: { /* n:\"Dv\", */ },\n0x01c0: { /* n:\"Excel9File\", */ f:parsenoop2 },\n0x01c1: { /* n:\"RecalcId\", */ f:parse_RecalcId, r:2},\n0x01c2: { /* n:\"EntExU2\", */ f:parsenoop2 },\n0x0200: { /* n:\"Dimensions\", */ f:parse_Dimensions },\n0x0201: { /* n:\"Blank\", */ f:parse_Blank },\n0x0203: { /* n:\"Number\", */ f:parse_Number },\n0x0204: { /* n:\"Label\", */ f:parse_Label },\n0x0205: { /* n:\"BoolErr\", */ f:parse_BoolErr },\n0x0207: { /* n:\"String\", */ f:parse_String },\n0x0208: { /* n:\"Row\", */ f:parse_Row },\n0x020b: { /* n:\"Index\", */ },\n0x0221: { /* n:\"Array\", */ f:parse_Array },\n0x0225: { /* n:\"DefaultRowHeight\", */ f:parse_DefaultRowHeight },\n0x0236: { /* n:\"Table\", */ },\n0x023e: { /* n:\"Window2\", */ f:parse_Window2 },\n0x027e: { /* n:\"RK\", */ f:parse_RK },\n0x0293: { /* n:\"Style\", */ },\n0x0418: { /* n:\"BigName\", */ },\n0x041e: { /* n:\"Format\", */ f:parse_Format },\n0x043c: { /* n:\"ContinueBigName\", */ },\n0x04bc: { /* n:\"ShrFmla\", */ f:parse_ShrFmla },\n0x0800: { /* n:\"HLinkTooltip\", */ f:parse_HLinkTooltip },\n0x0801: { /* n:\"WebPub\", */ },\n0x0802: { /* n:\"QsiSXTag\", */ },\n0x0803: { /* n:\"DBQueryExt\", */ },\n0x0804: { /* n:\"ExtString\", */ },\n0x0805: { /* n:\"TxtQry\", */ },\n0x0806: { /* n:\"Qsir\", */ },\n0x0807: { /* n:\"Qsif\", */ },\n0x0808: { /* n:\"RRDTQSIF\", */ },\n0x0809: { /* n:\"BOF\", */ f:parse_BOF },\n0x080a: { /* n:\"OleDbConn\", */ },\n0x080b: { /* n:\"WOpt\", */ },\n0x080c: { /* n:\"SXViewEx\", */ },\n0x080d: { /* n:\"SXTH\", */ },\n0x080e: { /* n:\"SXPIEx\", */ },\n0x080f: { /* n:\"SXVDTEx\", */ },\n0x0810: { /* n:\"SXViewEx9\", */ },\n0x0812: { /* n:\"ContinueFrt\", */ },\n0x0813: { /* n:\"RealTimeData\", */ },\n0x0850: { /* n:\"ChartFrtInfo\", */ },\n0x0851: { /* n:\"FrtWrapper\", */ },\n0x0852: { /* n:\"StartBlock\", */ },\n0x0853: { /* n:\"EndBlock\", */ },\n0x0854: { /* n:\"StartObject\", */ },\n0x0855: { /* n:\"EndObject\", */ },\n0x0856: { /* n:\"CatLab\", */ },\n0x0857: { /* n:\"YMult\", */ },\n0x0858: { /* n:\"SXViewLink\", */ },\n0x0859: { /* n:\"PivotChartBits\", */ },\n0x085a: { /* n:\"FrtFontList\", */ },\n0x0862: { /* n:\"SheetExt\", */ },\n0x0863: { /* n:\"BookExt\", */ r:12},\n0x0864: { /* n:\"SXAddl\", */ },\n0x0865: { /* n:\"CrErr\", */ },\n0x0866: { /* n:\"HFPicture\", */ },\n0x0867: { /* n:\"FeatHdr\", */ f:parsenoop2 },\n0x0868: { /* n:\"Feat\", */ },\n0x086a: { /* n:\"DataLabExt\", */ },\n0x086b: { /* n:\"DataLabExtContents\", */ },\n0x086c: { /* n:\"CellWatch\", */ },\n0x0871: { /* n:\"FeatHdr11\", */ },\n0x0872: { /* n:\"Feature11\", */ },\n0x0874: { /* n:\"DropDownObjIds\", */ },\n0x0875: { /* n:\"ContinueFrt11\", */ },\n0x0876: { /* n:\"DConn\", */ },\n0x0877: { /* n:\"List12\", */ },\n0x0878: { /* n:\"Feature12\", */ },\n0x0879: { /* n:\"CondFmt12\", */ },\n0x087a: { /* n:\"CF12\", */ },\n0x087b: { /* n:\"CFEx\", */ },\n0x087c: { /* n:\"XFCRC\", */ f:parse_XFCRC, r:12 },\n0x087d: { /* n:\"XFExt\", */ f:parse_XFExt, r:12 },\n0x087e: { /* n:\"AutoFilter12\", */ },\n0x087f: { /* n:\"ContinueFrt12\", */ },\n0x0884: { /* n:\"MDTInfo\", */ },\n0x0885: { /* n:\"MDXStr\", */ },\n0x0886: { /* n:\"MDXTuple\", */ },\n0x0887: { /* n:\"MDXSet\", */ },\n0x0888: { /* n:\"MDXProp\", */ },\n0x0889: { /* n:\"MDXKPI\", */ },\n0x088a: { /* n:\"MDB\", */ },\n0x088b: { /* n:\"PLV\", */ },\n0x088c: { /* n:\"Compat12\", */ f:parsebool, r:12 },\n0x088d: { /* n:\"DXF\", */ },\n0x088e: { /* n:\"TableStyles\", */ r:12 },\n0x088f: { /* n:\"TableStyle\", */ },\n0x0890: { /* n:\"TableStyleElement\", */ },\n0x0892: { /* n:\"StyleExt\", */ },\n0x0893: { /* n:\"NamePublish\", */ },\n0x0894: { /* n:\"NameCmt\", */ f:parse_NameCmt, r:12 },\n0x0895: { /* n:\"SortData\", */ },\n0x0896: { /* n:\"Theme\", */ f:parse_Theme, r:12 },\n0x0897: { /* n:\"GUIDTypeLib\", */ },\n0x0898: { /* n:\"FnGrp12\", */ },\n0x0899: { /* n:\"NameFnGrp12\", */ },\n0x089a: { /* n:\"MTRSettings\", */ f:parse_MTRSettings, r:12 },\n0x089b: { /* n:\"CompressPictures\", */ f:parsenoop2 },\n0x089c: { /* n:\"HeaderFooter\", */ },\n0x089d: { /* n:\"CrtLayout12\", */ },\n0x089e: { /* n:\"CrtMlFrt\", */ },\n0x089f: { /* n:\"CrtMlFrtContinue\", */ },\n0x08a3: { /* n:\"ForceFullCalculation\", */ f:parse_ForceFullCalculation },\n0x08a4: { /* n:\"ShapePropsStream\", */ },\n0x08a5: { /* n:\"TextPropsStream\", */ },\n0x08a6: { /* n:\"RichTextStream\", */ },\n0x08a7: { /* n:\"CrtLayout12A\", */ },\n0x1001: { /* n:\"Units\", */ },\n0x1002: { /* n:\"Chart\", */ },\n0x1003: { /* n:\"Series\", */ },\n0x1006: { /* n:\"DataFormat\", */ },\n0x1007: { /* n:\"LineFormat\", */ },\n0x1009: { /* n:\"MarkerFormat\", */ },\n0x100a: { /* n:\"AreaFormat\", */ },\n0x100b: { /* n:\"PieFormat\", */ },\n0x100c: { /* n:\"AttachedLabel\", */ },\n0x100d: { /* n:\"SeriesText\", */ },\n0x1014: { /* n:\"ChartFormat\", */ },\n0x1015: { /* n:\"Legend\", */ },\n0x1016: { /* n:\"SeriesList\", */ },\n0x1017: { /* n:\"Bar\", */ },\n0x1018: { /* n:\"Line\", */ },\n0x1019: { /* n:\"Pie\", */ },\n0x101a: { /* n:\"Area\", */ },\n0x101b: { /* n:\"Scatter\", */ },\n0x101c: { /* n:\"CrtLine\", */ },\n0x101d: { /* n:\"Axis\", */ },\n0x101e: { /* n:\"Tick\", */ },\n0x101f: { /* n:\"ValueRange\", */ },\n0x1020: { /* n:\"CatSerRange\", */ },\n0x1021: { /* n:\"AxisLine\", */ },\n0x1022: { /* n:\"CrtLink\", */ },\n0x1024: { /* n:\"DefaultText\", */ },\n0x1025: { /* n:\"Text\", */ },\n0x1026: { /* n:\"FontX\", */ f:parseuint16 },\n0x1027: { /* n:\"ObjectLink\", */ },\n0x1032: { /* n:\"Frame\", */ },\n0x1033: { /* n:\"Begin\", */ },\n0x1034: { /* n:\"End\", */ },\n0x1035: { /* n:\"PlotArea\", */ },\n0x103a: { /* n:\"Chart3d\", */ },\n0x103c: { /* n:\"PicF\", */ },\n0x103d: { /* n:\"DropBar\", */ },\n0x103e: { /* n:\"Radar\", */ },\n0x103f: { /* n:\"Surf\", */ },\n0x1040: { /* n:\"RadarArea\", */ },\n0x1041: { /* n:\"AxisParent\", */ },\n0x1043: { /* n:\"LegendException\", */ },\n0x1044: { /* n:\"ShtProps\", */ f:parse_ShtProps },\n0x1045: { /* n:\"SerToCrt\", */ },\n0x1046: { /* n:\"AxesUsed\", */ },\n0x1048: { /* n:\"SBaseRef\", */ },\n0x104a: { /* n:\"SerParent\", */ },\n0x104b: { /* n:\"SerAuxTrend\", */ },\n0x104e: { /* n:\"IFmtRecord\", */ },\n0x104f: { /* n:\"Pos\", */ },\n0x1050: { /* n:\"AlRuns\", */ },\n0x1051: { /* n:\"BRAI\", */ },\n0x105b: { /* n:\"SerAuxErrBar\", */ },\n0x105c: { /* n:\"ClrtClient\", */ f:parse_ClrtClient },\n0x105d: { /* n:\"SerFmt\", */ },\n0x105f: { /* n:\"Chart3DBarShape\", */ },\n0x1060: { /* n:\"Fbi\", */ },\n0x1061: { /* n:\"BopPop\", */ },\n0x1062: { /* n:\"AxcExt\", */ },\n0x1063: { /* n:\"Dat\", */ },\n0x1064: { /* n:\"PlotGrowth\", */ },\n0x1065: { /* n:\"SIIndex\", */ },\n0x1066: { /* n:\"GelFrame\", */ },\n0x1067: { /* n:\"BopPopCustom\", */ },\n0x1068: { /* n:\"Fbi2\", */ },\n\n0x0000: { /* n:\"Dimensions\", */ f:parse_Dimensions },\n0x0001: { /* n:\"BIFF2BLANK\", */ },\n0x0002: { /* n:\"BIFF2INT\", */ f:parse_BIFF2INT },\n0x0003: { /* n:\"BIFF2NUM\", */ f:parse_BIFF2NUM },\n0x0004: { /* n:\"BIFF2STR\", */ f:parse_BIFF2STR },\n0x0005: { /* n:\"BoolErr\", */ f:parse_BoolErr },\n0x0007: { /* n:\"String\", */ f:parse_BIFF2STRING },\n0x0008: { /* n:\"BIFF2ROW\", */ },\n0x0009: { /* n:\"BOF\", */ f:parse_BOF },\n0x000b: { /* n:\"Index\", */ },\n0x0016: { /* n:\"ExternCount\", */ f:parseuint16 },\n0x001e: { /* n:\"BIFF2FORMAT\", */ f:parse_BIFF2Format },\n0x001f: { /* n:\"BIFF2FMTCNT\", */ }, /* 16-bit cnt of BIFF2FORMAT records */\n0x0020: { /* n:\"BIFF2COLINFO\", */ },\n0x0021: { /* n:\"Array\", */ f:parse_Array },\n0x0024: { /* n:\"COLWIDTH\", */ },\n0x0025: { /* n:\"DefaultRowHeight\", */ f:parse_DefaultRowHeight },\n\t// 0x2c ??\n\t// 0x2d ??\n\t// 0x2e ??\n\t// 0x30 FONTCOUNT: number of fonts\n0x0032: { /* n:\"BIFF2FONTXTRA\", */ f:parse_BIFF2FONTXTRA },\n\t// 0x35: INFOOPTS\n\t// 0x36: TABLE (BIFF2 only)\n\t// 0x37: TABLE2 (BIFF2 only)\n\t// 0x38: WNDESK\n\t// 0x39 ??\n\t// 0x3a: BEGINPREF\n\t// 0x3b: ENDPREF\n0x003e: { /* n:\"BIFF2WINDOW2\", */ },\n\t// 0x3f ??\n\t// 0x46: SHOWSCROLL\n\t// 0x47: SHOWFORMULA\n\t// 0x48: STATUSBAR\n\t// 0x49: SHORTMENUS\n\t// 0x4A:\n\t// 0x4B:\n\t// 0x4C:\n\t// 0x4E:\n\t// 0x4F:\n\t// 0x58: TOOLBAR (BIFF3)\n\n\t/* - - - */\n0x0034: { /* n:\"DDEObjName\", */ },\n0x0043: { /* n:\"BIFF2XF\", */ },\n0x0044: { /* n:\"BIFF2XFINDEX\", */ f:parseuint16 },\n0x0045: { /* n:\"BIFF2FONTCLR\", */ },\n0x0056: { /* n:\"BIFF4FMTCNT\", */ }, /* 16-bit cnt, similar to BIFF2 */\n0x007e: { /* n:\"RK\", */ }, /* Not necessarily same as 0x027e */\n0x007f: { /* n:\"ImData\", */ f:parse_ImData },\n0x0087: { /* n:\"Addin\", */ },\n0x0088: { /* n:\"Edg\", */ },\n0x0089: { /* n:\"Pub\", */ },\n\t// 0x8A\n\t// 0x8B LH: alternate menu key flag (BIFF3/4)\n\t// 0x8E\n\t// 0x8F\n0x0091: { /* n:\"Sub\", */ },\n\t// 0x93 STYLE\n0x0094: { /* n:\"LHRecord\", */ },\n0x0095: { /* n:\"LHNGraph\", */ },\n0x0096: { /* n:\"Sound\", */ },\n\t// 0xA2 FNPROTO: function prototypes (BIFF4)\n\t// 0xA3\n\t// 0xA8\n0x00a9: { /* n:\"CoordList\", */ },\n0x00ab: { /* n:\"GCW\", */ },\n0x00bc: { /* n:\"ShrFmla\", */ }, /* Not necessarily same as 0x04bc */\n0x00bf: { /* n:\"ToolbarHdr\", */ },\n0x00c0: { /* n:\"ToolbarEnd\", */ },\n0x00c2: { /* n:\"AddMenu\", */ },\n0x00c3: { /* n:\"DelMenu\", */ },\n0x00d6: { /* n:\"RString\", */ f:parse_RString },\n0x00df: { /* n:\"UDDesc\", */ },\n0x00ea: { /* n:\"TabIdConf\", */ },\n0x0162: { /* n:\"XL5Modify\", */ },\n0x01a5: { /* n:\"FileSharing2\", */ },\n0x0206: { /* n:\"Formula\", */ f:parse_Formula },\n0x0209: { /* n:\"BOF\", */ f:parse_BOF },\n0x0218: { /* n:\"Lbl\", */ f:parse_Lbl },\n0x0223: { /* n:\"ExternName\", */ f:parse_ExternName },\n0x0231: { /* n:\"Font\", */ },\n0x0243: { /* n:\"BIFF3XF\", */ },\n0x0406: { /* n:\"Formula\", */ f:parse_Formula },\n0x0409: { /* n:\"BOF\", */ f:parse_BOF },\n0x0443: { /* n:\"BIFF4XF\", */ },\n0x086d: { /* n:\"FeatInfo\", */ },\n0x0873: { /* n:\"FeatInfo11\", */ },\n0x0881: { /* n:\"SXAddl12\", */ },\n0x08c0: { /* n:\"AutoWebPub\", */ },\n0x08c1: { /* n:\"ListObj\", */ },\n0x08c2: { /* n:\"ListField\", */ },\n0x08c3: { /* n:\"ListDV\", */ },\n0x08c4: { /* n:\"ListCondFmt\", */ },\n0x08c5: { /* n:\"ListCF\", */ },\n0x08c6: { /* n:\"FMQry\", */ },\n0x08c7: { /* n:\"FMSQry\", */ },\n0x08c8: { /* n:\"PLV\", */ },\n0x08c9: { /* n:\"LnExt\", */ },\n0x08ca: { /* n:\"MkrExt\", */ },\n0x08cb: { /* n:\"CrtCoopt\", */ },\n0x08d6: { /* n:\"FRTArchId$\", */ r:12 },\n\n0x7262: {}\n};\n\nfunction write_biff_rec(ba, type, payload, length) {\n\tvar t = type;\n\tif(isNaN(t)) return;\n\tvar len = length || (payload||[]).length || 0;\n\tvar o = ba.next(4);\n\to.write_shift(2, t);\n\to.write_shift(2, len);\n\tif(len > 0 && is_buf(payload)) ba.push(payload);\n}\n\nfunction write_biff_continue(ba, type, payload, length) {\n\tvar len = length || (payload||[]).length || 0;\n\tif(len <= 8224) return write_biff_rec(ba, type, payload, len);\n\tvar t = type;\n\tif(isNaN(t)) return;\n\tvar parts = payload.parts || [], sidx = 0;\n\tvar i = 0, w = 0;\n\twhile(w + (parts[sidx] || 8224) <= 8224) { w+= (parts[sidx] || 8224); sidx++; }\n\tvar o = ba.next(4);\n\to.write_shift(2, t);\n\to.write_shift(2, w);\n\tba.push(payload.slice(i, i + w));\n\ti += w;\n\twhile(i < len) {\n\t\to = ba.next(4);\n\t\to.write_shift(2, 0x3c); // TODO: figure out correct continue type\n\t\tw = 0;\n\t\twhile(w + (parts[sidx] || 8224) <= 8224) { w+= (parts[sidx] || 8224); sidx++; }\n\t\to.write_shift(2, w);\n\t\tba.push(payload.slice(i, i+w)); i+= w;\n\t}\n}\n\nfunction write_BIFF2Cell(out, r, c) {\n\tif(!out) out = new_buf(7);\n\tout.write_shift(2, r);\n\tout.write_shift(2, c);\n\tout.write_shift(2, 0);\n\tout.write_shift(1, 0);\n\treturn out;\n}\n\nfunction write_BIFF2BERR(r, c, val, t) {\n\tvar out = new_buf(9);\n\twrite_BIFF2Cell(out, r, c);\n\twrite_Bes(val, t || 'b', out);\n\treturn out;\n}\n\n/* TODO: codepage, large strings */\nfunction write_BIFF2LABEL(r, c, val) {\n\tvar out = new_buf(8 + 2*val.length);\n\twrite_BIFF2Cell(out, r, c);\n\tout.write_shift(1, val.length);\n\tout.write_shift(val.length, val, 'sbcs');\n\treturn out.l < out.length ? out.slice(0, out.l) : out;\n}\n\nfunction write_ws_biff2_cell(ba, cell, R, C) {\n\tif(cell.v != null) switch(cell.t) {\n\t\tcase 'd': case 'n':\n\t\t\tvar v = cell.t == 'd' ? datenum(parseDate(cell.v)) : cell.v;\n\t\t\tif((v == (v|0)) && (v >= 0) && (v < 65536))\n\t\t\t\twrite_biff_rec(ba, 0x0002, write_BIFF2INT(R, C, v));\n\t\t\telse\n\t\t\t\twrite_biff_rec(ba, 0x0003, write_BIFF2NUM(R,C, v));\n\t\t\treturn;\n\t\tcase 'b': case 'e': write_biff_rec(ba, 0x0005, write_BIFF2BERR(R, C, cell.v, cell.t)); return;\n\t\t/* TODO: codepage, sst */\n\t\tcase 's': case 'str':\n\t\t\twrite_biff_rec(ba, 0x0004, write_BIFF2LABEL(R, C, (cell.v||\"\").slice(0,255)));\n\t\t\treturn;\n\t}\n\twrite_biff_rec(ba, 0x0001, write_BIFF2Cell(null, R, C));\n}\n\nfunction write_ws_biff2(ba, ws, idx, opts) {\n\tvar dense = Array.isArray(ws);\n\tvar range = safe_decode_range(ws['!ref'] || \"A1\"), ref, rr = \"\", cols = [];\n\tif(range.e.c > 0xFF || range.e.r > 0x3FFF) {\n\t\tif(opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:IV16384\");\n\t\trange.e.c = Math.min(range.e.c, 0xFF);\n\t\trange.e.r = Math.min(range.e.c, 0x3FFF);\n\t\tref = encode_range(range);\n\t}\n\tfor(var R = range.s.r; R <= range.e.r; ++R) {\n\t\trr = encode_row(R);\n\t\tfor(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\tif(R === range.s.r) cols[C] = encode_col(C);\n\t\t\tref = cols[C] + rr;\n\t\t\tvar cell = dense ? (ws[R]||[])[C] : ws[ref];\n\t\t\tif(!cell) continue;\n\t\t\t/* write cell */\n\t\t\twrite_ws_biff2_cell(ba, cell, R, C, opts);\n\t\t}\n\t}\n}\n\n/* Based on test files */\nfunction write_biff2_buf(wb, opts) {\n\tvar o = opts || {};\n\tif(DENSE != null && o.dense == null) o.dense = DENSE;\n\tvar ba = buf_array();\n\tvar idx = 0;\n\tfor(var i=0;i<wb.SheetNames.length;++i) if(wb.SheetNames[i] == o.sheet) idx=i;\n\tif(idx == 0 && !!o.sheet && wb.SheetNames[0] != o.sheet) throw new Error(\"Sheet not found: \" + o.sheet);\n\twrite_biff_rec(ba, (o.biff == 4 ? 0x0409 : (o.biff == 3 ? 0x0209 : 0x0009)), write_BOF(wb, 0x10, o));\n\t/* ... */\n\twrite_ws_biff2(ba, wb.Sheets[wb.SheetNames[idx]], idx, o, wb);\n\t/* ... */\n\twrite_biff_rec(ba, 0x000A);\n\treturn ba.end();\n}\n\nfunction write_FONTS_biff8(ba, data, opts) {\n\twrite_biff_rec(ba, 0x0031 /* Font */, write_Font({\n\t\tsz:12,\n\t\tcolor: {theme:1},\n\t\tname: \"Arial\",\n\t\tfamily: 2,\n\t\tscheme: \"minor\"\n\t}, opts));\n}\n\n\nfunction write_FMTS_biff8(ba, NF, opts) {\n\tif(!NF) return;\n\t[[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\nfor(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) write_biff_rec(ba, 0x041E /* Format */, write_Format(i, NF[i], opts));\n\t});\n}\n\nfunction write_FEAT(ba, ws) {\n\t/* [MS-XLS] 2.4.112 */\n\tvar o = new_buf(19);\n\to.write_shift(4, 0x867); o.write_shift(4, 0); o.write_shift(4, 0);\n\to.write_shift(2, 3); o.write_shift(1, 1); o.write_shift(4, 0);\n\twrite_biff_rec(ba, 0x0867 /* FeatHdr */, o);\n\t/* [MS-XLS] 2.4.111 */\n\to = new_buf(39);\n\to.write_shift(4, 0x868); o.write_shift(4, 0); o.write_shift(4, 0);\n\to.write_shift(2, 3); o.write_shift(1, 0); o.write_shift(4, 0);\n\to.write_shift(2, 1); o.write_shift(4, 4); o.write_shift(2, 0);\n\twrite_Ref8U(safe_decode_range(ws['!ref']||\"A1\"), o);\n\to.write_shift(4, 4);\n\twrite_biff_rec(ba, 0x0868 /* Feat */, o);\n}\n\nfunction write_CELLXFS_biff8(ba, opts) {\n\tfor(var i = 0; i < 16; ++i) write_biff_rec(ba, 0x00e0 /* XF */, write_XF({numFmtId:0, style:true}, 0, opts));\n\topts.cellXfs.forEach(function(c) {\n\t\twrite_biff_rec(ba, 0x00e0 /* XF */, write_XF(c, 0, opts));\n\t});\n}\n\nfunction write_ws_biff8_hlinks(ba, ws) {\n\tfor(var R=0; R<ws['!links'].length; ++R) {\n\t\tvar HL = ws['!links'][R];\n\t\twrite_biff_rec(ba, 0x01b8 /* HLink */, write_HLink(HL));\n\t\tif(HL[1].Tooltip) write_biff_rec(ba, 0x0800 /* HLinkTooltip */, write_HLinkTooltip(HL));\n\t}\n\tdelete ws['!links'];\n}\n\nfunction write_ws_cols_biff8(ba, cols) {\n\tif(!cols) return;\n\tvar cnt = 0;\n\tcols.forEach(function(col, idx) {\n\t\tif(++cnt <= 256 && col) {\n\t\t\twrite_biff_rec(ba, 0x007d /* ColInfo */, write_ColInfo(col_obj_w(idx, col), idx));\n\t\t}\n\t});\n}\n\nfunction write_ws_biff8_cell(ba, cell, R, C, opts) {\n\tvar os = 16 + get_cell_style(opts.cellXfs, cell, opts);\n\tif(cell.v == null && !cell.bf) {\n\t\twrite_biff_rec(ba, 0x0201 /* Blank */, write_XLSCell(R, C, os));\n\t\treturn;\n\t}\n\tif(cell.bf) write_biff_rec(ba, 0x0006 /* Formula */, write_Formula(cell, R, C, opts, os));\n\telse switch(cell.t) {\n\t\tcase 'd': case 'n':\n\t\t\tvar v = cell.t == 'd' ? datenum(parseDate(cell.v)) : cell.v;\n\t\t\t/* TODO: emit RK as appropriate */\n\t\t\twrite_biff_rec(ba, 0x0203 /* Number */, write_Number(R, C, v, os, opts));\n\t\t\tbreak;\n\t\tcase 'b': case 'e':\n\t\t\twrite_biff_rec(ba, 0x0205 /* BoolErr */, write_BoolErr(R, C, cell.v, os, opts, cell.t));\n\t\t\tbreak;\n\t\t/* TODO: codepage, sst */\n\t\tcase 's': case 'str':\n\t\t\tif(opts.bookSST) {\n\t\t\t\tvar isst = get_sst_id(opts.Strings, cell.v, opts.revStrings);\n\t\t\t\twrite_biff_rec(ba, 0x00fd /* LabelSst */, write_LabelSst(R, C, isst, os, opts));\n\t\t\t} else write_biff_rec(ba, 0x0204 /* Label */, write_Label(R, C, (cell.v||\"\").slice(0,255), os, opts));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\twrite_biff_rec(ba, 0x0201 /* Blank */, write_XLSCell(R, C, os));\n\t}\n}\n\n/* [MS-XLS] 2.1.7.20.5 */\nfunction write_ws_biff8(idx, opts, wb) {\n\tvar ba = buf_array();\n\tvar s = wb.SheetNames[idx], ws = wb.Sheets[s] || {};\n\tvar _WB = ((wb||{}).Workbook||{});\n\tvar _sheet = ((_WB.Sheets||[])[idx]||{});\n\tvar dense = Array.isArray(ws);\n\tvar b8 = opts.biff == 8;\n\tvar ref, rr = \"\", cols = [];\n\tvar range = safe_decode_range(ws['!ref'] || \"A1\");\n\tvar MAX_ROWS = b8 ? 65536 : 16384;\n\tif(range.e.c > 0xFF || range.e.r >= MAX_ROWS) {\n\t\tif(opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:IV16384\");\n\t\trange.e.c = Math.min(range.e.c, 0xFF);\n\t\trange.e.r = Math.min(range.e.c, MAX_ROWS-1);\n\t}\n\n\twrite_biff_rec(ba, 0x0809, write_BOF(wb, 0x10, opts));\n\t/* [Uncalced] Index */\n\twrite_biff_rec(ba, 0x000d /* CalcMode */, writeuint16(1));\n\twrite_biff_rec(ba, 0x000c /* CalcCount */, writeuint16(100));\n\twrite_biff_rec(ba, 0x000f /* CalcRefMode */, writebool(true));\n\twrite_biff_rec(ba, 0x0011 /* CalcIter */, writebool(false));\n\twrite_biff_rec(ba, 0x0010 /* CalcDelta */, write_Xnum(0.001));\n\twrite_biff_rec(ba, 0x005f /* CalcSaveRecalc */, writebool(true));\n\twrite_biff_rec(ba, 0x002a /* PrintRowCol */, writebool(false));\n\twrite_biff_rec(ba, 0x002b /* PrintGrid */, writebool(false));\n\twrite_biff_rec(ba, 0x0082 /* GridSet */, writeuint16(1));\n\twrite_biff_rec(ba, 0x0080 /* Guts */, write_Guts([0,0]));\n\t/* DefaultRowHeight WsBool [Sync] [LPr] [HorizontalPageBreaks] [VerticalPageBreaks] */\n\t/* Header (string) */\n\t/* Footer (string) */\n\twrite_biff_rec(ba, 0x0083 /* HCenter */, writebool(false));\n\twrite_biff_rec(ba, 0x0084 /* VCenter */, writebool(false));\n\t/* ... */\n\tif(b8) write_ws_cols_biff8(ba, ws[\"!cols\"]);\n\t/* ... */\n\twrite_biff_rec(ba, 0x200, write_Dimensions(range, opts));\n\t/* ... */\n\n\tif(b8) ws['!links'] = [];\n\tfor(var R = range.s.r; R <= range.e.r; ++R) {\n\t\trr = encode_row(R);\n\t\tfor(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\tif(R === range.s.r) cols[C] = encode_col(C);\n\t\t\tref = cols[C] + rr;\n\t\t\tvar cell = dense ? (ws[R]||[])[C] : ws[ref];\n\t\t\tif(!cell) continue;\n\t\t\t/* write cell */\n\t\t\twrite_ws_biff8_cell(ba, cell, R, C, opts);\n\t\t\tif(b8 && cell.l) ws['!links'].push([ref, cell.l]);\n\t\t}\n\t}\n\tvar cname = _sheet.CodeName || _sheet.name || s;\n\t/* ... */\n\tif(b8) write_biff_rec(ba, 0x023e /* Window2 */, write_Window2((_WB.Views||[])[0]));\n\t/* ... */\n\tif(b8 && (ws['!merges']||[]).length) write_biff_rec(ba, 0x00e5 /* MergeCells */, write_MergeCells(ws['!merges']));\n\t/* [LRng] *QUERYTABLE [PHONETICINFO] CONDFMTS */\n\tif(b8) write_ws_biff8_hlinks(ba, ws);\n\t/* [DVAL] */\n\twrite_biff_rec(ba, 0x01ba /* CodeName */, write_XLUnicodeString(cname, opts));\n\t/* *WebPub *CellWatch [SheetExt] */\n\tif(b8) write_FEAT(ba, ws);\n\t/* *FEAT11 *RECORD12 */\n\twrite_biff_rec(ba, 0x000a /* EOF */);\n\treturn ba.end();\n}\n\n/* [MS-XLS] 2.1.7.20.3 */\nfunction write_biff8_global(wb, bufs, opts) {\n\tvar A = buf_array();\n\tvar _WB = ((wb||{}).Workbook||{});\n\tvar _sheets = (_WB.Sheets||[]);\n\tvar _wb = _WB.WBProps||{};\n\tvar b8 = opts.biff == 8, b5 = opts.biff == 5;\n\twrite_biff_rec(A, 0x0809, write_BOF(wb, 0x05, opts));\n\tif(opts.bookType == \"xla\") write_biff_rec(A, 0x0087 /* Addin */);\n\twrite_biff_rec(A, 0x00e1 /* InterfaceHdr */, b8 ? writeuint16(0x04b0) : null);\n\twrite_biff_rec(A, 0x00c1 /* Mms */, writezeroes(2));\n\tif(b5) write_biff_rec(A, 0x00bf /* ToolbarHdr */);\n\tif(b5) write_biff_rec(A, 0x00c0 /* ToolbarEnd */);\n\twrite_biff_rec(A, 0x00e2 /* InterfaceEnd */);\n\twrite_biff_rec(A, 0x005c /* WriteAccess */, write_WriteAccess(\"SheetJS\", opts));\n\t/* [FileSharing] */\n\twrite_biff_rec(A, 0x0042 /* CodePage */, writeuint16(b8 ? 0x04b0 : 0x04E4));\n\t/* *2047 Lel */\n\tif(b8) write_biff_rec(A, 0x0161 /* DSF */, writeuint16(0));\n\tif(b8) write_biff_rec(A, 0x01c0 /* Excel9File */);\n\twrite_biff_rec(A, 0x013d /* RRTabId */, write_RRTabId(wb.SheetNames.length));\n\tif(b8 && wb.vbaraw) write_biff_rec(A, 0x00d3 /* ObProj */);\n\t/* [ObNoMacros] */\n\tif(b8 && wb.vbaraw) {\n\t\tvar cname = _wb.CodeName || \"ThisWorkbook\";\n\t\twrite_biff_rec(A, 0x01ba /* CodeName */, write_XLUnicodeString(cname, opts));\n\t}\n\twrite_biff_rec(A, 0x009c /* BuiltInFnGroupCount */, writeuint16(0x11));\n\t/* *FnGroupName *FnGrp12 */\n\t/* *Lbl */\n\t/* [OleObjectSize] */\n\twrite_biff_rec(A, 0x0019 /* WinProtect */, writebool(false));\n\twrite_biff_rec(A, 0x0012 /* Protect */, writebool(false));\n\twrite_biff_rec(A, 0x0013 /* Password */, writeuint16(0));\n\tif(b8) write_biff_rec(A, 0x01af /* Prot4Rev */, writebool(false));\n\tif(b8) write_biff_rec(A, 0x01bc /* Prot4RevPass */, writeuint16(0));\n\twrite_biff_rec(A, 0x003d /* Window1 */, write_Window1(opts));\n\twrite_biff_rec(A, 0x0040 /* Backup */, writebool(false));\n\twrite_biff_rec(A, 0x008d /* HideObj */, writeuint16(0));\n\twrite_biff_rec(A, 0x0022 /* Date1904 */, writebool(safe1904(wb)==\"true\"));\n\twrite_biff_rec(A, 0x000e /* CalcPrecision */, writebool(true));\n\tif(b8) write_biff_rec(A, 0x01b7 /* RefreshAll */, writebool(false));\n\twrite_biff_rec(A, 0x00DA /* BookBool */, writeuint16(0));\n\t/* ... */\n\twrite_FONTS_biff8(A, wb, opts);\n\twrite_FMTS_biff8(A, wb.SSF, opts);\n\twrite_CELLXFS_biff8(A, opts);\n\t/* ... */\n\tif(b8) write_biff_rec(A, 0x0160 /* UsesELFs */, writebool(false));\n\tvar a = A.end();\n\n\tvar C = buf_array();\n\t/* METADATA [MTRSettings] [ForceFullCalculation] */\n\tif(b8) write_biff_rec(C, 0x008C, write_Country());\n\t/* *SUPBOOK *LBL *RTD [RecalcId] *HFPicture *MSODRAWINGGROUP */\n\n\t/* BIFF8: [SST *Continue] ExtSST */\n\tif(b8 && opts.Strings) write_biff_continue(C, 0x00FC, write_SST(opts.Strings, opts));\n\n\t/* *WebPub [WOpt] [CrErr] [BookExt] *FeatHdr *DConn [THEME] [CompressPictures] [Compat12] [GUIDTypeLib] */\n\twrite_biff_rec(C, 0x000A /* EOF */);\n\tvar c = C.end();\n\n\tvar B = buf_array();\n\tvar blen = 0, j = 0;\n\tfor(j = 0; j < wb.SheetNames.length; ++j) blen += (b8 ? 12 : 11) + (b8 ? 2 : 1) * wb.SheetNames[j].length;\n\tvar start = a.length + blen + c.length;\n\tfor(j = 0; j < wb.SheetNames.length; ++j) {\n\t\tvar _sheet = _sheets[j] || ({});\n\t\twrite_biff_rec(B, 0x0085 /* BoundSheet8 */, write_BoundSheet8({pos:start, hs:_sheet.Hidden||0, dt:0, name:wb.SheetNames[j]}, opts));\n\t\tstart += bufs[j].length;\n\t}\n\t/* 1*BoundSheet8 */\n\tvar b = B.end();\n\tif(blen != b.length) throw new Error(\"BS8 \" + blen + \" != \" + b.length);\n\n\tvar out = [];\n\tif(a.length) out.push(a);\n\tif(b.length) out.push(b);\n\tif(c.length) out.push(c);\n\treturn bconcat(out);\n}\n\n/* [MS-XLS] 2.1.7.20 Workbook Stream */\nfunction write_biff8_buf(wb, opts) {\n\tvar o = opts || {};\n\tvar bufs = [];\n\n\tif(wb && !wb.SSF) {\n\t\twb.SSF = dup(table_fmt);\n\t}\n\tif(wb && wb.SSF) {\n\t\tmake_ssf(); SSF_load_table(wb.SSF);\n\t\t// $FlowIgnore\n\t\to.revssf = evert_num(wb.SSF); o.revssf[wb.SSF[65535]] = 0;\n\t\to.ssf = wb.SSF;\n\t}\n\n\to.Strings = []; o.Strings.Count = 0; o.Strings.Unique = 0;\n\tfix_write_opts(o);\n\n\to.cellXfs = [];\n\tget_cell_style(o.cellXfs, {}, {revssf:{\"General\":0}});\n\n\tif(!wb.Props) wb.Props = {};\n\n\tfor(var i = 0; i < wb.SheetNames.length; ++i) bufs[bufs.length] = write_ws_biff8(i, o, wb);\n\tbufs.unshift(write_biff8_global(wb, bufs, o));\n\treturn bconcat(bufs);\n}\n\nfunction write_biff_buf(wb, opts) {\n\tfor(var i = 0; i <= wb.SheetNames.length; ++i) {\n\t\tvar ws = wb.Sheets[wb.SheetNames[i]];\n\t\tif(!ws || !ws[\"!ref\"]) continue;\n\t\tvar range = decode_range(ws[\"!ref\"]);\n\t\tif(range.e.c > 255) { // note: 255 is IV\n\t\tif(typeof console != \"undefined\" && console.error) console.error(\"Worksheet '\" + wb.SheetNames[i] + \"' extends beyond column IV (255).  Data may be lost.\");\n\t\t}\n\t}\n\n\tvar o = opts || {};\n\tswitch(o.biff || 2) {\n\t\tcase 8: case 5: return write_biff8_buf(wb, opts);\n\t\tcase 4: case 3: case 2: return write_biff2_buf(wb, opts);\n\t}\n\tthrow new Error(\"invalid type \" + o.bookType + \" for BIFF\");\n}\n/* note: browser DOM element cannot see mso- style attrs, must parse */\nfunction html_to_sheet(str, _opts) {\n\tvar opts = _opts || {};\n\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\tvar ws = opts.dense ? ([]) : ({});\n\tstr = str.replace(/<!--.*?-->/g, \"\");\n\tvar mtch = str.match(/<table/i);\n\tif(!mtch) throw new Error(\"Invalid HTML: could not find <table>\");\n\tvar mtch2 = str.match(/<\\/table/i);\n\tvar i = mtch.index, j = mtch2 && mtch2.index || str.length;\n\tvar rows = split_regex(str.slice(i, j), /(:?<tr[^>]*>)/i, \"<tr>\");\n\tvar R = -1, C = 0, RS = 0, CS = 0;\n\tvar range = {s:{r:10000000, c:10000000},e:{r:0,c:0}};\n\tvar merges = [];\n\tfor(i = 0; i < rows.length; ++i) {\n\t\tvar row = rows[i].trim();\n\t\tvar hd = row.slice(0,3).toLowerCase();\n\t\tif(hd == \"<tr\") { ++R; if(opts.sheetRows && opts.sheetRows <= R) { --R; break; } C = 0; continue; }\n\t\tif(hd != \"<td\" && hd != \"<th\") continue;\n\t\tvar cells = row.split(/<\\/t[dh]>/i);\n\t\tfor(j = 0; j < cells.length; ++j) {\n\t\t\tvar cell = cells[j].trim();\n\t\t\tif(!cell.match(/<t[dh]/i)) continue;\n\t\t\tvar m = cell, cc = 0;\n\t\t\t/* TODO: parse styles etc */\n\t\t\twhile(m.charAt(0) == \"<\" && (cc = m.indexOf(\">\")) > -1) m = m.slice(cc+1);\n\t\t\tfor(var midx = 0; midx < merges.length; ++midx) {\n\t\t\t\tvar _merge = merges[midx];\n\t\t\t\tif(_merge.s.c == C && _merge.s.r < R && R <= _merge.e.r) { C = _merge.e.c + 1; midx = -1; }\n\t\t\t}\n\t\t\tvar tag = parsexmltag(cell.slice(0, cell.indexOf(\">\")));\n\t\t\tCS = tag.colspan ? +tag.colspan : 1;\n\t\t\tif((RS = +tag.rowspan)>1 || CS>1) merges.push({s:{r:R,c:C},e:{r:R + (RS||1) - 1, c:C + CS - 1}});\n\t\t\tvar _t = tag.t || tag[\"data-t\"] || \"\";\n\t\t\t/* TODO: generate stub cells */\n\t\t\tif(!m.length) { C += CS; continue; }\n\t\t\tm = htmldecode(m);\n\t\t\tif(range.s.r > R) range.s.r = R; if(range.e.r < R) range.e.r = R;\n\t\t\tif(range.s.c > C) range.s.c = C; if(range.e.c < C) range.e.c = C;\n\t\t\tif(!m.length) { C += CS; continue; }\n\t\t\tvar o = {t:'s', v:m};\n\t\t\tif(opts.raw || !m.trim().length || _t == 's'){}\n\t\t\telse if(m === 'TRUE') o = {t:'b', v:true};\n\t\t\telse if(m === 'FALSE') o = {t:'b', v:false};\n\t\t\telse if(!isNaN(fuzzynum(m))) o = {t:'n', v:fuzzynum(m)};\n\t\t\telse if(!isNaN(fuzzydate(m).getDate())) {\n\t\t\t\to = ({t:'d', v:parseDate(m)});\n\t\t\t\tif(!opts.cellDates) o = ({t:'n', v:datenum(o.v)});\n\t\t\t\to.z = opts.dateNF || table_fmt[14];\n\t\t\t}\n\t\t\tif(opts.dense) { if(!ws[R]) ws[R] = []; ws[R][C] = o; }\n\t\t\telse ws[encode_cell({r:R, c:C})] = o;\n\t\t\tC += CS;\n\t\t}\n\t}\n\tws['!ref'] = encode_range(range);\n\tif(merges.length) ws[\"!merges\"] = merges;\n\treturn ws;\n}\nfunction make_html_row(ws, r, R, o) {\n\tvar M = (ws['!merges'] ||[]);\n\tvar oo = [];\n\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\tvar RS = 0, CS = 0;\n\t\tfor(var j = 0; j < M.length; ++j) {\n\t\t\tif(M[j].s.r > R || M[j].s.c > C) continue;\n\t\t\tif(M[j].e.r < R || M[j].e.c < C) continue;\n\t\t\tif(M[j].s.r < R || M[j].s.c < C) { RS = -1; break; }\n\t\t\tRS = M[j].e.r - M[j].s.r + 1; CS = M[j].e.c - M[j].s.c + 1; break;\n\t\t}\n\t\tif(RS < 0) continue;\n\t\tvar coord = encode_cell({r:R,c:C});\n\t\tvar cell = o.dense ? (ws[R]||[])[C] : ws[coord];\n\t\t/* TODO: html entities */\n\t\tvar w = (cell && cell.v != null) && (cell.h || escapehtml(cell.w || (format_cell(cell), cell.w) || \"\")) || \"\";\n\t\tvar sp = ({});\n\t\tif(RS > 1) sp.rowspan = RS;\n\t\tif(CS > 1) sp.colspan = CS;\n\t\tif(o.editable) w = '<span contenteditable=\"true\">' + w + '</span>';\n\t\telse if(cell) {\n\t\t\tsp[\"data-t\"] = cell && cell.t || 'z';\n\t\t\tif(cell.v != null) sp[\"data-v\"] = cell.v;\n\t\t\tif(cell.z != null) sp[\"data-z\"] = cell.z;\n\t\t\tif(cell.l && (cell.l.Target || \"#\").charAt(0) != \"#\") w = '<a href=\"' + cell.l.Target +'\">' + w + '</a>';\n\t\t}\n\t\tsp.id = (o.id || \"sjs\") + \"-\" + coord;\n\t\too.push(writextag('td', w, sp));\n\t}\n\tvar preamble = \"<tr>\";\n\treturn preamble + oo.join(\"\") + \"</tr>\";\n}\n\nvar HTML_BEGIN = '<html><head><meta charset=\"utf-8\"/><title>SheetJS Table Export</title></head><body>';\nvar HTML_END = '</body></html>';\n\nfunction html_to_workbook(str, opts) {\n\tvar mtch = str.match(/<table[\\s\\S]*?>[\\s\\S]*?<\\/table>/gi);\n\tif(!mtch || mtch.length == 0) throw new Error(\"Invalid HTML: could not find <table>\");\n\tif(mtch.length == 1) return sheet_to_workbook(html_to_sheet(mtch[0], opts), opts);\n\tvar wb = book_new();\n\tmtch.forEach(function(s, idx) { book_append_sheet(wb, html_to_sheet(s, opts), \"Sheet\" + (idx+1)); });\n\treturn wb;\n}\n\nfunction make_html_preamble(ws, R, o) {\n\tvar out = [];\n\treturn out.join(\"\") + '<table' + (o && o.id ? ' id=\"' + o.id + '\"' : \"\") + '>';\n}\n\nfunction sheet_to_html(ws, opts/*, wb:?Workbook*/) {\n\tvar o = opts || {};\n\tvar header = o.header != null ? o.header : HTML_BEGIN;\n\tvar footer = o.footer != null ? o.footer : HTML_END;\n\tvar out = [header];\n\tvar r = decode_range(ws['!ref']);\n\to.dense = Array.isArray(ws);\n\tout.push(make_html_preamble(ws, r, o));\n\tfor(var R = r.s.r; R <= r.e.r; ++R) out.push(make_html_row(ws, r, R, o));\n\tout.push(\"</table>\" + footer);\n\treturn out.join(\"\");\n}\n\nfunction sheet_add_dom(ws, table, _opts) {\n\tvar opts = _opts || {};\n\tif(DENSE != null) opts.dense = DENSE;\n\tvar or_R = 0, or_C = 0;\n\tif(opts.origin != null) {\n\t\tif(typeof opts.origin == 'number') or_R = opts.origin;\n\t\telse {\n\t\t\tvar _origin = typeof opts.origin == \"string\" ? decode_cell(opts.origin) : opts.origin;\n\t\t\tor_R = _origin.r; or_C = _origin.c;\n\t\t}\n\t}\n\n\tvar rows = table.getElementsByTagName('tr');\n\tvar sheetRows = Math.min(opts.sheetRows||10000000, rows.length);\n\tvar range = {s:{r:0,c:0},e:{r:or_R,c:or_C}};\n\tif(ws[\"!ref\"]) {\n\t\tvar _range = decode_range(ws[\"!ref\"]);\n\t\trange.s.r = Math.min(range.s.r, _range.s.r);\n\t\trange.s.c = Math.min(range.s.c, _range.s.c);\n\t\trange.e.r = Math.max(range.e.r, _range.e.r);\n\t\trange.e.c = Math.max(range.e.c, _range.e.c);\n\t\tif(or_R == -1) range.e.r = or_R = _range.e.r + 1;\n\t}\n\tvar merges = [], midx = 0;\n\tvar rowinfo = ws[\"!rows\"] || (ws[\"!rows\"] = []);\n\tvar _R = 0, R = 0, _C = 0, C = 0, RS = 0, CS = 0;\n\tif(!ws[\"!cols\"]) ws['!cols'] = [];\n\tfor(; _R < rows.length && R < sheetRows; ++_R) {\n\t\tvar row = rows[_R];\n\t\tif (is_dom_element_hidden(row)) {\n\t\t\tif (opts.display) continue;\n\t\t\trowinfo[R] = {hidden: true};\n\t\t}\n\t\tvar elts = (row.children);\n\t\tfor(_C = C = 0; _C < elts.length; ++_C) {\n\t\t\tvar elt = elts[_C];\n\t\t\tif (opts.display && is_dom_element_hidden(elt)) continue;\n\t\t\tvar v = elt.hasAttribute('data-v') ? elt.getAttribute('data-v') : elt.hasAttribute('v') ? elt.getAttribute('v') : htmldecode(elt.innerHTML);\n\t\t\tvar z = elt.getAttribute('data-z') || elt.getAttribute('z');\n\t\t\tfor(midx = 0; midx < merges.length; ++midx) {\n\t\t\t\tvar m = merges[midx];\n\t\t\t\tif(m.s.c == C + or_C && m.s.r < R + or_R && R + or_R <= m.e.r) { C = m.e.c+1 - or_C; midx = -1; }\n\t\t\t}\n\t\t\t/* TODO: figure out how to extract nonstandard mso- style */\n\t\t\tCS = +elt.getAttribute(\"colspan\") || 1;\n\t\t\tif( ((RS = (+elt.getAttribute(\"rowspan\") || 1)))>1 || CS>1) merges.push({s:{r:R + or_R,c:C + or_C},e:{r:R + or_R + (RS||1) - 1, c:C + or_C + (CS||1) - 1}});\n\t\t\tvar o = {t:'s', v:v};\n\t\t\tvar _t = elt.getAttribute(\"data-t\") || elt.getAttribute(\"t\") || \"\";\n\t\t\tif(v != null) {\n\t\t\t\tif(v.length == 0) o.t = _t || 'z';\n\t\t\t\telse if(opts.raw || v.trim().length == 0 || _t == \"s\"){}\n\t\t\t\telse if(v === 'TRUE') o = {t:'b', v:true};\n\t\t\t\telse if(v === 'FALSE') o = {t:'b', v:false};\n\t\t\t\telse if(!isNaN(fuzzynum(v))) o = {t:'n', v:fuzzynum(v)};\n\t\t\t\telse if(!isNaN(fuzzydate(v).getDate())) {\n\t\t\t\t\to = ({t:'d', v:parseDate(v)});\n\t\t\t\t\tif(!opts.cellDates) o = ({t:'n', v:datenum(o.v)});\n\t\t\t\t\to.z = opts.dateNF || table_fmt[14];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(o.z === undefined && z != null) o.z = z;\n\t\t\t/* The first link is used.  Links are assumed to be fully specified.\n\t\t\t * TODO: The right way to process relative links is to make a new <a> */\n\t\t\tvar l = \"\", Aelts = elt.getElementsByTagName(\"A\");\n\t\t\tif(Aelts && Aelts.length) for(var Aelti = 0; Aelti < Aelts.length; ++Aelti)\tif(Aelts[Aelti].hasAttribute(\"href\")) {\n\t\t\t\tl = Aelts[Aelti].getAttribute(\"href\"); if(l.charAt(0) != \"#\") break;\n\t\t\t}\n\t\t\tif(l && l.charAt(0) != \"#\") o.l = ({ Target: l });\n\t\t\tif(opts.dense) { if(!ws[R + or_R]) ws[R + or_R] = []; ws[R + or_R][C + or_C] = o; }\n\t\t\telse ws[encode_cell({c:C + or_C, r:R + or_R})] = o;\n\t\t\tif(range.e.c < C + or_C) range.e.c = C + or_C;\n\t\t\tC += CS;\n\t\t}\n\t\t++R;\n\t}\n\tif(merges.length) ws['!merges'] = (ws[\"!merges\"] || []).concat(merges);\n\trange.e.r = Math.max(range.e.r, R - 1 + or_R);\n\tws['!ref'] = encode_range(range);\n\tif(R >= sheetRows) ws['!fullref'] = encode_range((range.e.r = rows.length-_R+R-1 + or_R,range)); // We can count the real number of rows to parse but we don't to improve the performance\n\treturn ws;\n}\n\nfunction parse_dom_table(table, _opts) {\n\tvar opts = _opts || {};\n\tvar ws = opts.dense ? ([]) : ({});\n\treturn sheet_add_dom(ws, table, _opts);\n}\n\nfunction table_to_book(table, opts) {\n\treturn sheet_to_workbook(parse_dom_table(table, opts), opts);\n}\n\nfunction is_dom_element_hidden(element) {\n\tvar display = '';\n\tvar get_computed_style = get_get_computed_style_function(element);\n\tif(get_computed_style) display = get_computed_style(element).getPropertyValue('display');\n\tif(!display) display = element.style && element.style.display;\n\treturn display === 'none';\n}\n\n/* global getComputedStyle */\nfunction get_get_computed_style_function(element) {\n\t// The proper getComputedStyle implementation is the one defined in the element window\n\tif(element.ownerDocument.defaultView && typeof element.ownerDocument.defaultView.getComputedStyle === 'function') return element.ownerDocument.defaultView.getComputedStyle;\n\t// If it is not available, try to get one from the global namespace\n\tif(typeof getComputedStyle === 'function') return getComputedStyle;\n\treturn null;\n}\n/* OpenDocument */\nfunction parse_text_p(text) {\n\t/* 6.1.2 White Space Characters */\n\tvar fixed = text\n\t\t.replace(/[\\t\\r\\n]/g, \" \").trim().replace(/ +/g, \" \")\n\t\t.replace(/<text:s\\/>/g,\" \")\n\t\t.replace(/<text:s text:c=\"(\\d+)\"\\/>/g, function($$,$1) { return Array(parseInt($1,10)+1).join(\" \"); })\n\t\t.replace(/<text:tab[^>]*\\/>/g,\"\\t\")\n\t\t.replace(/<text:line-break\\/>/g,\"\\n\");\n\tvar v = unescapexml(fixed.replace(/<[^>]*>/g,\"\"));\n\n\treturn [v];\n}\n\nvar number_formats_ods = {\n\t/* ods name: [short ssf fmt, long ssf fmt] */\n\tday:           [\"d\",   \"dd\"],\n\tmonth:         [\"m\",   \"mm\"],\n\tyear:          [\"y\",   \"yy\"],\n\thours:         [\"h\",   \"hh\"],\n\tminutes:       [\"m\",   \"mm\"],\n\tseconds:       [\"s\",   \"ss\"],\n\t\"am-pm\":       [\"A/P\", \"AM/PM\"],\n\t\"day-of-week\": [\"ddd\", \"dddd\"],\n\tera:           [\"e\",   \"ee\"],\n\t/* there is no native representation of LO \"Q\" format */\n\tquarter:       [\"\\\\Qm\", \"m\\\\\\\"th quarter\\\"\"]\n};\n\n\nfunction parse_content_xml(d, _opts) {\n\t\tvar opts = _opts || {};\n\t\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\t\tvar str = xlml_normalize(d);\n\t\tvar state = [], tmp;\n\t\tvar tag;\n\t\tvar NFtag = {name:\"\"}, NF = \"\", pidx = 0;\n\t\tvar sheetag;\n\t\tvar rowtag;\n\t\tvar Sheets = {}, SheetNames = [];\n\t\tvar ws = opts.dense ? ([]) : ({});\n\t\tvar Rn, q;\n\t\tvar ctag = ({value:\"\"});\n\t\tvar textp = \"\", textpidx = 0, textptag;\n\t\tvar textR = [];\n\t\tvar R = -1, C = -1, range = {s: {r:1000000,c:10000000}, e: {r:0, c:0}};\n\t\tvar row_ol = 0;\n\t\tvar number_format_map = {};\n\t\tvar merges = [], mrange = {}, mR = 0, mC = 0;\n\t\tvar rowinfo = [], rowpeat = 1, colpeat = 1;\n\t\tvar arrayf = [];\n\t\tvar WB = {Names:[]};\n\t\tvar atag = ({});\n\t\tvar _Ref = [\"\", \"\"];\n\t\tvar comments = [], comment = ({});\n\t\tvar creator = \"\", creatoridx = 0;\n\t\tvar isstub = false, intable = false;\n\t\tvar i = 0;\n\t\txlmlregex.lastIndex = 0;\n\t\tstr = str.replace(/<!--([\\s\\S]*?)-->/mg,\"\").replace(/<!DOCTYPE[^\\[]*\\[[^\\]]*\\]>/gm,\"\");\n\t\twhile((Rn = xlmlregex.exec(str))) switch((Rn[3]=Rn[3].replace(/_.*$/,\"\"))) {\n\n\t\t\tcase 'table': case '工作表': // 9.1.2 <table:table>\n\t\t\t\tif(Rn[1]==='/') {\n\t\t\t\t\tif(range.e.c >= range.s.c && range.e.r >= range.s.r) ws['!ref'] = encode_range(range);\n\t\t\t\t\telse ws['!ref'] = \"A1:A1\";\n\t\t\t\t\tif(opts.sheetRows > 0 && opts.sheetRows <= range.e.r) {\n\t\t\t\t\t\tws['!fullref'] = ws['!ref'];\n\t\t\t\t\t\trange.e.r = opts.sheetRows - 1;\n\t\t\t\t\t\tws['!ref'] = encode_range(range);\n\t\t\t\t\t}\n\t\t\t\t\tif(merges.length) ws['!merges'] = merges;\n\t\t\t\t\tif(rowinfo.length) ws[\"!rows\"] = rowinfo;\n\t\t\t\t\tsheetag.name = sheetag['名称'] || sheetag.name;\n\t\t\t\t\tif(typeof JSON !== 'undefined') JSON.stringify(sheetag);\n\t\t\t\t\tSheetNames.push(sheetag.name);\n\t\t\t\t\tSheets[sheetag.name] = ws;\n\t\t\t\t\tintable = false;\n\t\t\t\t}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\t\tsheetag = parsexmltag(Rn[0], false);\n\t\t\t\t\tR = C = -1;\n\t\t\t\t\trange.s.r = range.s.c = 10000000; range.e.r = range.e.c = 0;\n\t\t\t\t\tws = opts.dense ? ([]) : ({}); merges = [];\n\t\t\t\t\trowinfo = [];\n\t\t\t\t\tintable = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'table-row-group': // 9.1.9 <table:table-row-group>\n\t\t\t\tif(Rn[1] === \"/\") --row_ol; else ++row_ol;\n\t\t\t\tbreak;\n\t\t\tcase 'table-row': case '行': // 9.1.3 <table:table-row>\n\t\t\t\tif(Rn[1] === '/') { R+=rowpeat; rowpeat = 1; break; }\n\t\t\t\trowtag = parsexmltag(Rn[0], false);\n\t\t\t\tif(rowtag['行号']) R = rowtag['行号'] - 1; else if(R == -1) R = 0;\n\t\t\t\trowpeat = +rowtag['number-rows-repeated'] || 1;\n\t\t\t\t/* TODO: remove magic */\n\t\t\t\tif(rowpeat < 10) for(i = 0; i < rowpeat; ++i) if(row_ol > 0) rowinfo[R + i] = {level: row_ol};\n\t\t\t\tC = -1; break;\n\t\t\tcase 'covered-table-cell': // 9.1.5 <table:covered-table-cell>\n\t\t\t\tif(Rn[1] !== '/') ++C;\n\t\t\t\tif(opts.sheetStubs) {\n\t\t\t\t\tif(opts.dense) { if(!ws[R]) ws[R] = []; ws[R][C] = {t:'z'}; }\n\t\t\t\t\telse ws[encode_cell({r:R,c:C})] = {t:'z'};\n\t\t\t\t}\n\t\t\t\ttextp = \"\"; textR = [];\n\t\t\t\tbreak; /* stub */\n\t\t\tcase 'table-cell': case '数据':\n\t\t\t\tif(Rn[0].charAt(Rn[0].length-2) === '/') {\n\t\t\t\t\t++C;\n\t\t\t\t\tctag = parsexmltag(Rn[0], false);\n\t\t\t\t\tcolpeat = parseInt(ctag['number-columns-repeated']||\"1\", 10);\n\t\t\t\t\tq = ({t:'z', v:null});\n\t\t\t\t\tif(ctag.formula && opts.cellFormula != false) q.f = ods_to_csf_formula(unescapexml(ctag.formula));\n\t\t\t\t\tif((ctag['数据类型'] || ctag['value-type']) == \"string\") {\n\t\t\t\t\t\tq.t = \"s\"; q.v = unescapexml(ctag['string-value'] || \"\");\n\t\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\t\tif(!ws[R]) ws[R] = [];\n\t\t\t\t\t\t\tws[R][C] = q;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tws[encode_cell({r:R,c:C})] = q;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tC+= colpeat-1;\n\t\t\t\t} else if(Rn[1]!=='/') {\n\t\t\t\t\t++C;\n\t\t\t\t\ttextp = \"\"; textpidx = 0; textR = [];\n\t\t\t\t\tcolpeat = 1;\n\t\t\t\t\tvar rptR = rowpeat ? R + rowpeat - 1 : R;\n\t\t\t\t\tif(C > range.e.c) range.e.c = C;\n\t\t\t\t\tif(C < range.s.c) range.s.c = C;\n\t\t\t\t\tif(R < range.s.r) range.s.r = R;\n\t\t\t\t\tif(rptR > range.e.r) range.e.r = rptR;\n\t\t\t\t\tctag = parsexmltag(Rn[0], false);\n\t\t\t\t\tcomments = []; comment = ({});\n\t\t\t\t\tq = ({t:ctag['数据类型'] || ctag['value-type'], v:null});\n\t\t\t\t\tif(opts.cellFormula) {\n\t\t\t\t\t\tif(ctag.formula) ctag.formula = unescapexml(ctag.formula);\n\t\t\t\t\t\tif(ctag['number-matrix-columns-spanned'] && ctag['number-matrix-rows-spanned']) {\n\t\t\t\t\t\t\tmR = parseInt(ctag['number-matrix-rows-spanned'],10) || 0;\n\t\t\t\t\t\t\tmC = parseInt(ctag['number-matrix-columns-spanned'],10) || 0;\n\t\t\t\t\t\t\tmrange = {s: {r:R,c:C}, e:{r:R + mR-1,c:C + mC-1}};\n\t\t\t\t\t\t\tq.F = encode_range(mrange);\n\t\t\t\t\t\t\tarrayf.push([mrange, q.F]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ctag.formula) q.f = ods_to_csf_formula(ctag.formula);\n\t\t\t\t\t\telse for(i = 0; i < arrayf.length; ++i)\n\t\t\t\t\t\t\tif(R >= arrayf[i][0].s.r && R <= arrayf[i][0].e.r)\n\t\t\t\t\t\t\t\tif(C >= arrayf[i][0].s.c && C <= arrayf[i][0].e.c)\n\t\t\t\t\t\t\t\t\tq.F = arrayf[i][1];\n\t\t\t\t\t}\n\t\t\t\t\tif(ctag['number-columns-spanned'] || ctag['number-rows-spanned']) {\n\t\t\t\t\t\tmR = parseInt(ctag['number-rows-spanned'],10) || 0;\n\t\t\t\t\t\tmC = parseInt(ctag['number-columns-spanned'],10) || 0;\n\t\t\t\t\t\tmrange = {s: {r:R,c:C}, e:{r:R + mR-1,c:C + mC-1}};\n\t\t\t\t\t\tmerges.push(mrange);\n\t\t\t\t\t}\n\n\t\t\t\t\t/* 19.675.2 table:number-columns-repeated */\n\t\t\t\t\tif(ctag['number-columns-repeated']) colpeat = parseInt(ctag['number-columns-repeated'], 10);\n\n\t\t\t\t\t/* 19.385 office:value-type */\n\t\t\t\t\tswitch(q.t) {\n\t\t\t\t\t\tcase 'boolean': q.t = 'b'; q.v = parsexmlbool(ctag['boolean-value']); break;\n\t\t\t\t\t\tcase 'float': q.t = 'n'; q.v = parseFloat(ctag.value); break;\n\t\t\t\t\t\tcase 'percentage': q.t = 'n'; q.v = parseFloat(ctag.value); break;\n\t\t\t\t\t\tcase 'currency': q.t = 'n'; q.v = parseFloat(ctag.value); break;\n\t\t\t\t\t\tcase 'date': q.t = 'd'; q.v = parseDate(ctag['date-value']);\n\t\t\t\t\t\t\tif(!opts.cellDates) { q.t = 'n'; q.v = datenum(q.v); }\n\t\t\t\t\t\t\tq.z = 'm/d/yy'; break;\n\t\t\t\t\t\tcase 'time': q.t = 'n'; q.v = parse_isodur(ctag['time-value'])/86400;\n\t\t\t\t\t\t\tif(opts.cellDates) { q.t = 'd'; q.v = numdate(q.v); }\n\t\t\t\t\t\t\tq.z = 'HH:MM:SS'; break;\n\t\t\t\t\t\tcase 'number': q.t = 'n'; q.v = parseFloat(ctag['数据数值']); break;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tif(q.t === 'string' || q.t === 'text' || !q.t) {\n\t\t\t\t\t\t\t\tq.t = 's';\n\t\t\t\t\t\t\t\tif(ctag['string-value'] != null) { textp = unescapexml(ctag['string-value']); textR = []; }\n\t\t\t\t\t\t\t} else throw new Error('Unsupported value type ' + q.t);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tisstub = false;\n\t\t\t\t\tif(q.t === 's') {\n\t\t\t\t\t\tq.v = textp || '';\n\t\t\t\t\t\tif(textR.length) q.R = textR;\n\t\t\t\t\t\tisstub = textpidx == 0;\n\t\t\t\t\t}\n\t\t\t\t\tif(atag.Target) q.l = atag;\n\t\t\t\t\tif(comments.length > 0) { q.c = comments; comments = []; }\n\t\t\t\t\tif(textp && opts.cellText !== false) q.w = textp;\n\t\t\t\t\tif(isstub) { q.t = \"z\"; delete q.v; }\n\t\t\t\t\tif(!isstub || opts.sheetStubs) {\n\t\t\t\t\t\tif(!(opts.sheetRows && opts.sheetRows <= R)) {\n\t\t\t\t\t\t\tfor(var rpt = 0; rpt < rowpeat; ++rpt) {\n\t\t\t\t\t\t\t\tcolpeat = parseInt(ctag['number-columns-repeated']||\"1\", 10);\n\t\t\t\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\t\t\t\tif(!ws[R + rpt]) ws[R + rpt] = [];\n\t\t\t\t\t\t\t\t\tws[R + rpt][C] = rpt == 0 ? q : dup(q);\n\t\t\t\t\t\t\t\t\twhile(--colpeat > 0) ws[R + rpt][C + colpeat] = dup(q);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tws[encode_cell({r:R + rpt,c:C})] = q;\n\t\t\t\t\t\t\t\t\twhile(--colpeat > 0) ws[encode_cell({r:R + rpt,c:C + colpeat})] = dup(q);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(range.e.c <= C) range.e.c = C;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcolpeat = parseInt(ctag['number-columns-repeated']||\"1\", 10);\n\t\t\t\t\tC += colpeat-1; colpeat = 0;\n\t\t\t\t\tq = {};\n\t\t\t\t\ttextp = \"\"; textR = [];\n\t\t\t\t}\n\t\t\t\tatag = ({});\n\t\t\t\tbreak; // 9.1.4 <table:table-cell>\n\n\t\t\t/* pure state */\n\t\t\tcase 'document': // TODO: <office:document> is the root for FODS\n\t\t\tcase 'document-content': case '电子表格文档': // 3.1.3.2 <office:document-content>\n\t\t\tcase 'spreadsheet': case '主体': // 3.7 <office:spreadsheet>\n\t\t\tcase 'scripts': // 3.12 <office:scripts>\n\t\t\tcase 'styles': // TODO <office:styles>\n\t\t\tcase 'font-face-decls': // 3.14 <office:font-face-decls>\n\t\t\tcase 'master-styles': // 3.15.4 <office:master-styles> -- relevant for FODS\n\t\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\t\tbreak;\n\n\t\t\tcase 'annotation': // 14.1 <office:annotation>\n\t\t\t\tif(Rn[1]==='/'){\n\t\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;\n\t\t\t\t\tcomment.t = textp;\n\t\t\t\t\tif(textR.length) comment.R = textR;\n\t\t\t\t\tcomment.a = creator;\n\t\t\t\t\tcomments.push(comment);\n\t\t\t\t}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') {state.push([Rn[3], false]);}\n\t\t\t\tcreator = \"\"; creatoridx = 0;\n\t\t\t\ttextp = \"\"; textpidx = 0; textR = [];\n\t\t\t\tbreak;\n\n\t\t\tcase 'creator': // 4.3.2.7 <dc:creator>\n\t\t\t\tif(Rn[1]==='/') { creator = str.slice(creatoridx,Rn.index); }\n\t\t\t\telse creatoridx = Rn.index + Rn[0].length;\n\t\t\t\tbreak;\n\n\t\t\t/* ignore state */\n\t\t\tcase 'meta': case '元数据': // TODO: <office:meta> <uof:元数据> FODS/UOF\n\t\t\tcase 'settings': // TODO: <office:settings>\n\t\t\tcase 'config-item-set': // TODO: <office:config-item-set>\n\t\t\tcase 'config-item-map-indexed': // TODO: <office:config-item-map-indexed>\n\t\t\tcase 'config-item-map-entry': // TODO: <office:config-item-map-entry>\n\t\t\tcase 'config-item-map-named': // TODO: <office:config-item-map-entry>\n\t\t\tcase 'shapes': // 9.2.8 <table:shapes>\n\t\t\tcase 'frame': // 10.4.2 <draw:frame>\n\t\t\tcase 'text-box': // 10.4.3 <draw:text-box>\n\t\t\tcase 'image': // 10.4.4 <draw:image>\n\t\t\tcase 'data-pilot-tables': // 9.6.2 <table:data-pilot-tables>\n\t\t\tcase 'list-style': // 16.30 <text:list-style>\n\t\t\tcase 'form': // 13.13 <form:form>\n\t\t\tcase 'dde-links': // 9.8 <table:dde-links>\n\t\t\tcase 'event-listeners': // TODO\n\t\t\tcase 'chart': // TODO\n\t\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], false]);\n\t\t\t\ttextp = \"\"; textpidx = 0; textR = [];\n\t\t\t\tbreak;\n\n\t\t\tcase 'scientific-number': // TODO: <number:scientific-number>\n\t\t\t\tbreak;\n\t\t\tcase 'currency-symbol': // TODO: <number:currency-symbol>\n\t\t\t\tbreak;\n\t\t\tcase 'currency-style': // TODO: <number:currency-style>\n\t\t\t\tbreak;\n\t\t\tcase 'number-style': // 16.27.2 <number:number-style>\n\t\t\tcase 'percentage-style': // 16.27.9 <number:percentage-style>\n\t\t\tcase 'date-style': // 16.27.10 <number:date-style>\n\t\t\tcase 'time-style': // 16.27.18 <number:time-style>\n\t\t\t\tif(Rn[1]==='/'){\n\t\t\t\t\tnumber_format_map[NFtag.name] = NF;\n\t\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;\n\t\t\t\t} else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\t\tNF = \"\";\n\t\t\t\t\tNFtag = parsexmltag(Rn[0], false);\n\t\t\t\t\tstate.push([Rn[3], true]);\n\t\t\t\t} break;\n\n\t\t\tcase 'script': break; // 3.13 <office:script>\n\t\t\tcase 'libraries': break; // TODO: <ooo:libraries>\n\t\t\tcase 'automatic-styles': break; // 3.15.3 <office:automatic-styles>\n\n\t\t\tcase 'default-style': // TODO: <style:default-style>\n\t\t\tcase 'page-layout': break; // TODO: <style:page-layout>\n\t\t\tcase 'style': // 16.2 <style:style>\n\t\t\t\tbreak;\n\t\t\tcase 'map': break; // 16.3 <style:map>\n\t\t\tcase 'font-face': break; // 16.21 <style:font-face>\n\n\t\t\tcase 'paragraph-properties': break; // 17.6 <style:paragraph-properties>\n\t\t\tcase 'table-properties': break; // 17.15 <style:table-properties>\n\t\t\tcase 'table-column-properties': break; // 17.16 <style:table-column-properties>\n\t\t\tcase 'table-row-properties': break; // 17.17 <style:table-row-properties>\n\t\t\tcase 'table-cell-properties': break; // 17.18 <style:table-cell-properties>\n\n\t\t\tcase 'number': // 16.27.3 <number:number>\n\t\t\t\tswitch(state[state.length-1][0]) {\n\t\t\t\t\tcase 'time-style':\n\t\t\t\t\tcase 'date-style':\n\t\t\t\t\t\ttag = parsexmltag(Rn[0], false);\n\t\t\t\t\t\tNF += number_formats_ods[Rn[3]][tag.style==='long'?1:0]; break;\n\t\t\t\t} break;\n\n\t\t\tcase 'fraction': break; // TODO 16.27.6 <number:fraction>\n\n\t\t\tcase 'day': // 16.27.11 <number:day>\n\t\t\tcase 'month': // 16.27.12 <number:month>\n\t\t\tcase 'year': // 16.27.13 <number:year>\n\t\t\tcase 'era': // 16.27.14 <number:era>\n\t\t\tcase 'day-of-week': // 16.27.15 <number:day-of-week>\n\t\t\tcase 'week-of-year': // 16.27.16 <number:week-of-year>\n\t\t\tcase 'quarter': // 16.27.17 <number:quarter>\n\t\t\tcase 'hours': // 16.27.19 <number:hours>\n\t\t\tcase 'minutes': // 16.27.20 <number:minutes>\n\t\t\tcase 'seconds': // 16.27.21 <number:seconds>\n\t\t\tcase 'am-pm': // 16.27.22 <number:am-pm>\n\t\t\t\tswitch(state[state.length-1][0]) {\n\t\t\t\t\tcase 'time-style':\n\t\t\t\t\tcase 'date-style':\n\t\t\t\t\t\ttag = parsexmltag(Rn[0], false);\n\t\t\t\t\t\tNF += number_formats_ods[Rn[3]][tag.style==='long'?1:0]; break;\n\t\t\t\t} break;\n\n\t\t\tcase 'boolean-style': break; // 16.27.23 <number:boolean-style>\n\t\t\tcase 'boolean': break; // 16.27.24 <number:boolean>\n\t\t\tcase 'text-style': break; // 16.27.25 <number:text-style>\n\t\t\tcase 'text': // 16.27.26 <number:text>\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\t\telse if(Rn[1]===\"/\") switch(state[state.length-1][0]) {\n\t\t\t\t\tcase 'number-style':\n\t\t\t\t\tcase 'date-style':\n\t\t\t\t\tcase 'time-style':\n\t\t\t\t\t\tNF += str.slice(pidx, Rn.index);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse pidx = Rn.index + Rn[0].length;\n\t\t\t\tbreak;\n\n\t\t\tcase 'named-range': // 9.4.12 <table:named-range>\n\t\t\t\ttag = parsexmltag(Rn[0], false);\n\t\t\t\t_Ref = ods_to_csf_3D(tag['cell-range-address']);\n\t\t\t\tvar nrange = ({Name:tag.name, Ref:_Ref[0] + '!' + _Ref[1]});\n\t\t\t\tif(intable) nrange.Sheet = SheetNames.length;\n\t\t\t\tWB.Names.push(nrange);\n\t\t\t\tbreak;\n\n\t\t\tcase 'text-content': break; // 16.27.27 <number:text-content>\n\t\t\tcase 'text-properties': break; // 16.27.27 <style:text-properties>\n\t\t\tcase 'embedded-text': break; // 16.27.4 <number:embedded-text>\n\n\t\t\tcase 'body': case '电子表格': break; // 3.3 16.9.6 19.726.3\n\n\t\t\tcase 'forms': break; // 12.25.2 13.2\n\t\t\tcase 'table-column': break; // 9.1.6 <table:table-column>\n\t\t\tcase 'table-header-rows': break; // 9.1.7 <table:table-header-rows>\n\t\t\tcase 'table-rows': break; // 9.1.12 <table:table-rows>\n\t\t\t/* TODO: outline levels */\n\t\t\tcase 'table-column-group': break; // 9.1.10 <table:table-column-group>\n\t\t\tcase 'table-header-columns': break; // 9.1.11 <table:table-header-columns>\n\t\t\tcase 'table-columns': break; // 9.1.12 <table:table-columns>\n\n\t\t\tcase 'null-date': break; // 9.4.2 <table:null-date> TODO: date1904\n\n\t\t\tcase 'graphic-properties': break; // 17.21 <style:graphic-properties>\n\t\t\tcase 'calculation-settings': break; // 9.4.1 <table:calculation-settings>\n\t\t\tcase 'named-expressions': break; // 9.4.11 <table:named-expressions>\n\t\t\tcase 'label-range': break; // 9.4.9 <table:label-range>\n\t\t\tcase 'label-ranges': break; // 9.4.10 <table:label-ranges>\n\t\t\tcase 'named-expression': break; // 9.4.13 <table:named-expression>\n\t\t\tcase 'sort': break; // 9.4.19 <table:sort>\n\t\t\tcase 'sort-by': break; // 9.4.20 <table:sort-by>\n\t\t\tcase 'sort-groups': break; // 9.4.22 <table:sort-groups>\n\n\t\t\tcase 'tab': break; // 6.1.4 <text:tab>\n\t\t\tcase 'line-break': break; // 6.1.5 <text:line-break>\n\t\t\tcase 'span': break; // 6.1.7 <text:span>\n\t\t\tcase 'p': case '文本串': // 5.1.3 <text:p>\n\t\t\t\tif(['master-styles'].indexOf(state[state.length-1][0]) > -1) break;\n\t\t\t\tif(Rn[1]==='/' && (!ctag || !ctag['string-value'])) {\n\t\t\t\t\tvar ptp = parse_text_p(str.slice(textpidx,Rn.index), textptag);\n\t\t\t\t\ttextp = (textp.length > 0 ? textp + \"\\n\" : \"\") + ptp[0];\n\t\t\t\t} else { textptag = parsexmltag(Rn[0], false); textpidx = Rn.index + Rn[0].length; }\n\t\t\t\tbreak; // <text:p>\n\t\t\tcase 's': break; // <text:s>\n\n\t\t\tcase 'database-range': // 9.4.15 <table:database-range>\n\t\t\t\tif(Rn[1]==='/') break;\n\t\t\t\ttry {\n\t\t\t\t\t_Ref = ods_to_csf_3D(parsexmltag(Rn[0])['target-range-address']);\n\t\t\t\t\tSheets[_Ref[0]]['!autofilter'] = { ref:_Ref[1] };\n\t\t\t\t} catch(e) {/* empty */}\n\t\t\t\tbreak;\n\n\t\t\tcase 'date': break; // <*:date>\n\n\t\t\tcase 'object': break; // 10.4.6.2 <draw:object>\n\t\t\tcase 'title': case '标题': break; // <*:title> OR <uof:标题>\n\t\t\tcase 'desc': break; // <*:desc>\n\t\t\tcase 'binary-data': break; // 10.4.5 TODO: b64 blob\n\n\t\t\t/* 9.2 Advanced Tables */\n\t\t\tcase 'table-source': break; // 9.2.6\n\t\t\tcase 'scenario': break; // 9.2.6\n\n\t\t\tcase 'iteration': break; // 9.4.3 <table:iteration>\n\t\t\tcase 'content-validations': break; // 9.4.4 <table:\n\t\t\tcase 'content-validation': break; // 9.4.5 <table:\n\t\t\tcase 'help-message': break; // 9.4.6 <table:\n\t\t\tcase 'error-message': break; // 9.4.7 <table:\n\t\t\tcase 'database-ranges': break; // 9.4.14 <table:database-ranges>\n\t\t\tcase 'filter': break; // 9.5.2 <table:filter>\n\t\t\tcase 'filter-and': break; // 9.5.3 <table:filter-and>\n\t\t\tcase 'filter-or': break; // 9.5.4 <table:filter-or>\n\t\t\tcase 'filter-condition': break; // 9.5.5 <table:filter-condition>\n\n\t\t\tcase 'list-level-style-bullet': break; // 16.31 <text:\n\t\t\tcase 'list-level-style-number': break; // 16.32 <text:\n\t\t\tcase 'list-level-properties': break; // 17.19 <style:\n\n\t\t\t/* 7.3 Document Fields */\n\t\t\tcase 'sender-firstname': // 7.3.6.2\n\t\t\tcase 'sender-lastname': // 7.3.6.3\n\t\t\tcase 'sender-initials': // 7.3.6.4\n\t\t\tcase 'sender-title': // 7.3.6.5\n\t\t\tcase 'sender-position': // 7.3.6.6\n\t\t\tcase 'sender-email': // 7.3.6.7\n\t\t\tcase 'sender-phone-private': // 7.3.6.8\n\t\t\tcase 'sender-fax': // 7.3.6.9\n\t\t\tcase 'sender-company': // 7.3.6.10\n\t\t\tcase 'sender-phone-work': // 7.3.6.11\n\t\t\tcase 'sender-street': // 7.3.6.12\n\t\t\tcase 'sender-city': // 7.3.6.13\n\t\t\tcase 'sender-postal-code': // 7.3.6.14\n\t\t\tcase 'sender-country': // 7.3.6.15\n\t\t\tcase 'sender-state-or-province': // 7.3.6.16\n\t\t\tcase 'author-name': // 7.3.7.1\n\t\t\tcase 'author-initials': // 7.3.7.2\n\t\t\tcase 'chapter': // 7.3.8\n\t\t\tcase 'file-name': // 7.3.9\n\t\t\tcase 'template-name': // 7.3.9\n\t\t\tcase 'sheet-name': // 7.3.9\n\t\t\t\tbreak;\n\n\t\t\tcase 'event-listener':\n\t\t\t\tbreak;\n\t\t\t/* TODO: FODS Properties */\n\t\t\tcase 'initial-creator':\n\t\t\tcase 'creation-date':\n\t\t\tcase 'print-date':\n\t\t\tcase 'generator':\n\t\t\tcase 'document-statistic':\n\t\t\tcase 'user-defined':\n\t\t\tcase 'editing-duration':\n\t\t\tcase 'editing-cycles':\n\t\t\t\tbreak;\n\n\t\t\t/* TODO: FODS Config */\n\t\t\tcase 'config-item':\n\t\t\t\tbreak;\n\n\t\t\t/* TODO: style tokens */\n\t\t\tcase 'page-number': break; // TODO <text:page-number>\n\t\t\tcase 'page-count': break; // TODO <text:page-count>\n\t\t\tcase 'time': break; // TODO <text:time>\n\n\t\t\t/* 9.3 Advanced Table Cells */\n\t\t\tcase 'cell-range-source': break; // 9.3.1 <table:\n\t\t\tcase 'detective': break; // 9.3.2 <table:\n\t\t\tcase 'operation': break; // 9.3.3 <table:\n\t\t\tcase 'highlighted-range': break; // 9.3.4 <table:\n\n\t\t\t/* 9.6 Data Pilot Tables <table: */\n\t\t\tcase 'data-pilot-table': // 9.6.3\n\t\t\tcase 'source-cell-range': // 9.6.5\n\t\t\tcase 'source-service': // 9.6.6\n\t\t\tcase 'data-pilot-field': // 9.6.7\n\t\t\tcase 'data-pilot-level': // 9.6.8\n\t\t\tcase 'data-pilot-subtotals': // 9.6.9\n\t\t\tcase 'data-pilot-subtotal': // 9.6.10\n\t\t\tcase 'data-pilot-members': // 9.6.11\n\t\t\tcase 'data-pilot-member': // 9.6.12\n\t\t\tcase 'data-pilot-display-info': // 9.6.13\n\t\t\tcase 'data-pilot-sort-info': // 9.6.14\n\t\t\tcase 'data-pilot-layout-info': // 9.6.15\n\t\t\tcase 'data-pilot-field-reference': // 9.6.16\n\t\t\tcase 'data-pilot-groups': // 9.6.17\n\t\t\tcase 'data-pilot-group': // 9.6.18\n\t\t\tcase 'data-pilot-group-member': // 9.6.19\n\t\t\t\tbreak;\n\n\t\t\t/* 10.3 Drawing Shapes */\n\t\t\tcase 'rect': // 10.3.2\n\t\t\t\tbreak;\n\n\t\t\t/* 14.6 DDE Connections */\n\t\t\tcase 'dde-connection-decls': // 14.6.2 <text:\n\t\t\tcase 'dde-connection-decl': // 14.6.3 <text:\n\t\t\tcase 'dde-link': // 14.6.4 <table:\n\t\t\tcase 'dde-source': // 14.6.5 <office:\n\t\t\t\tbreak;\n\n\t\t\tcase 'properties': break; // 13.7 <form:properties>\n\t\t\tcase 'property': break; // 13.8 <form:property>\n\n\t\t\tcase 'a': // 6.1.8 hyperlink\n\t\t\t\tif(Rn[1]!== '/') {\n\t\t\t\t\tatag = parsexmltag(Rn[0], false);\n\t\t\t\t\tif(!atag.href) break;\n\t\t\t\t\tatag.Target = unescapexml(atag.href); delete atag.href;\n\t\t\t\t\tif(atag.Target.charAt(0) == \"#\" && atag.Target.indexOf(\".\") > -1) {\n\t\t\t\t\t\t_Ref = ods_to_csf_3D(atag.Target.slice(1));\n\t\t\t\t\t\tatag.Target = \"#\" + _Ref[0] + \"!\" + _Ref[1];\n\t\t\t\t\t} else if(atag.Target.match(/^\\.\\.[\\\\\\/]/)) atag.Target = atag.Target.slice(3);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\t/* non-standard */\n\t\t\tcase 'table-protection': break;\n\t\t\tcase 'data-pilot-grand-total': break; // <table:\n\t\t\tcase 'office-document-common-attrs': break; // bare\n\t\t\tdefault: switch(Rn[2]) {\n\t\t\t\tcase 'dc:':       // TODO: properties\n\t\t\t\tcase 'calcext:':  // ignore undocumented extensions\n\t\t\t\tcase 'loext:':    // ignore undocumented extensions\n\t\t\t\tcase 'ooo:':      // ignore undocumented extensions\n\t\t\t\tcase 'chartooo:': // ignore undocumented extensions\n\t\t\t\tcase 'draw:':     // TODO: drawing\n\t\t\t\tcase 'style:':    // TODO: styles\n\t\t\t\tcase 'chart:':    // TODO: charts\n\t\t\t\tcase 'form:':     // TODO: forms\n\t\t\t\tcase 'uof:':      // TODO: uof\n\t\t\t\tcase '表:':       // TODO: uof\n\t\t\t\tcase '字:':       // TODO: uof\n\t\t\t\t\tbreak;\n\t\t\t\tdefault: if(opts.WTF) throw new Error(Rn);\n\t\t\t}\n\t\t}\n\t\tvar out = ({\n\t\t\tSheets: Sheets,\n\t\t\tSheetNames: SheetNames,\n\t\t\tWorkbook: WB\n\t\t});\n\t\tif(opts.bookSheets) delete out.Sheets;\n\t\treturn out;\n}\n\nfunction parse_ods(zip, opts) {\n\topts = opts || ({});\n\tif(safegetzipfile(zip, 'META-INF/manifest.xml')) parse_manifest(getzipdata(zip, 'META-INF/manifest.xml'), opts);\n\tvar content = getzipstr(zip, 'content.xml');\n\tif(!content) throw new Error(\"Missing content.xml in ODS / UOF file\");\n\tvar wb = parse_content_xml(utf8read(content), opts);\n\tif(safegetzipfile(zip, 'meta.xml')) wb.Props = parse_core_props(getzipdata(zip, 'meta.xml'));\n\treturn wb;\n}\nfunction parse_fods(data, opts) {\n\treturn parse_content_xml(data, opts);\n}\n\n/* OpenDocument */\nvar write_styles_ods = /* @__PURE__ */(function() {\n\tvar master_styles = [\n\t\t'<office:master-styles>',\n\t\t\t'<style:master-page style:name=\"mp1\" style:page-layout-name=\"mp1\">',\n\t\t\t\t'<style:header/>',\n\t\t\t\t'<style:header-left style:display=\"false\"/>',\n\t\t\t\t'<style:footer/>',\n\t\t\t\t'<style:footer-left style:display=\"false\"/>',\n\t\t\t'</style:master-page>',\n\t\t'</office:master-styles>'\n\t].join(\"\");\n\n\tvar payload = '<office:document-styles ' + wxt_helper({\n\t\t'xmlns:office':   \"urn:oasis:names:tc:opendocument:xmlns:office:1.0\",\n\t\t'xmlns:table':    \"urn:oasis:names:tc:opendocument:xmlns:table:1.0\",\n\t\t'xmlns:style':    \"urn:oasis:names:tc:opendocument:xmlns:style:1.0\",\n\t\t'xmlns:text':     \"urn:oasis:names:tc:opendocument:xmlns:text:1.0\",\n\t\t'xmlns:draw':     \"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\",\n\t\t'xmlns:fo':       \"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\",\n\t\t'xmlns:xlink':    \"http://www.w3.org/1999/xlink\",\n\t\t'xmlns:dc':       \"http://purl.org/dc/elements/1.1/\",\n\t\t'xmlns:number':   \"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\",\n\t\t'xmlns:svg':      \"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\",\n\t\t'xmlns:of':       \"urn:oasis:names:tc:opendocument:xmlns:of:1.2\",\n\t\t'office:version': \"1.2\"\n\t}) + '>' + master_styles + '</office:document-styles>';\n\n\treturn function wso() {\n\t\treturn XML_HEADER + payload;\n\t};\n})();\nvar write_content_ods = /* @__PURE__ */(function() {\n\t/* 6.1.2 White Space Characters */\n\tvar write_text_p = function(text) {\n\t\treturn escapexml(text)\n\t\t\t.replace(/  +/g, function($$){return '<text:s text:c=\"'+$$.length+'\"/>';})\n\t\t\t.replace(/\\t/g, \"<text:tab/>\")\n\t\t\t.replace(/\\n/g, \"</text:p><text:p>\")\n\t\t\t.replace(/^ /, \"<text:s/>\").replace(/ $/, \"<text:s/>\");\n\t};\n\n\tvar null_cell_xml = '          <table:table-cell />\\n';\n\tvar covered_cell_xml = '          <table:covered-table-cell/>\\n';\n\tvar write_ws = function(ws, wb, i) {\n\t\t/* Section 9 Tables */\n\t\tvar o = [];\n\t\to.push('      <table:table table:name=\"' + escapexml(wb.SheetNames[i]) + '\" table:style-name=\"ta1\">\\n');\n\t\tvar R=0,C=0, range = decode_range(ws['!ref']||\"A1\");\n\t\tvar marr = ws['!merges'] || [], mi = 0;\n\t\tvar dense = Array.isArray(ws);\n\t\tif(ws[\"!cols\"]) {\n\t\t\tfor(C = 0; C <= range.e.c; ++C) o.push('        <table:table-column' + (ws[\"!cols\"][C] ? ' table:style-name=\"co' + ws[\"!cols\"][C].ods + '\"' : '') + '></table:table-column>\\n');\n\t\t}\n\t\tvar H = \"\", ROWS = ws[\"!rows\"]||[];\n\t\tfor(R = 0; R < range.s.r; ++R) {\n\t\t\tH = ROWS[R] ? ' table:style-name=\"ro' + ROWS[R].ods + '\"' : \"\";\n\t\t\to.push('        <table:table-row' + H + '></table:table-row>\\n');\n\t\t}\n\t\tfor(; R <= range.e.r; ++R) {\n\t\t\tH = ROWS[R] ? ' table:style-name=\"ro' + ROWS[R].ods + '\"' : \"\";\n\t\t\to.push('        <table:table-row' + H + '>\\n');\n\t\t\tfor(C=0; C < range.s.c; ++C) o.push(null_cell_xml);\n\t\t\tfor(; C <= range.e.c; ++C) {\n\t\t\t\tvar skip = false, ct = {}, textp = \"\";\n\t\t\t\tfor(mi = 0; mi != marr.length; ++mi) {\n\t\t\t\t\tif(marr[mi].s.c > C) continue;\n\t\t\t\t\tif(marr[mi].s.r > R) continue;\n\t\t\t\t\tif(marr[mi].e.c < C) continue;\n\t\t\t\t\tif(marr[mi].e.r < R) continue;\n\t\t\t\t\tif(marr[mi].s.c != C || marr[mi].s.r != R) skip = true;\n\t\t\t\t\tct['table:number-columns-spanned'] = (marr[mi].e.c - marr[mi].s.c + 1);\n\t\t\t\t\tct['table:number-rows-spanned'] =    (marr[mi].e.r - marr[mi].s.r + 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(skip) { o.push(covered_cell_xml); continue; }\n\t\t\t\tvar ref = encode_cell({r:R, c:C}), cell = dense ? (ws[R]||[])[C]: ws[ref];\n\t\t\t\tif(cell && cell.f) {\n\t\t\t\t\tct['table:formula'] = escapexml(csf_to_ods_formula(cell.f));\n\t\t\t\t\tif(cell.F) {\n\t\t\t\t\t\tif(cell.F.slice(0, ref.length) == ref) {\n\t\t\t\t\t\t\tvar _Fref = decode_range(cell.F);\n\t\t\t\t\t\t\tct['table:number-matrix-columns-spanned'] = (_Fref.e.c - _Fref.s.c + 1);\n\t\t\t\t\t\t\tct['table:number-matrix-rows-spanned'] =    (_Fref.e.r - _Fref.s.r + 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!cell) { o.push(null_cell_xml); continue; }\n\t\t\t\tswitch(cell.t) {\n\t\t\t\t\tcase 'b':\n\t\t\t\t\t\ttextp = (cell.v ? 'TRUE' : 'FALSE');\n\t\t\t\t\t\tct['office:value-type'] = \"boolean\";\n\t\t\t\t\t\tct['office:boolean-value'] = (cell.v ? 'true' : 'false');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'n':\n\t\t\t\t\t\ttextp = (cell.w||String(cell.v||0));\n\t\t\t\t\t\tct['office:value-type'] = \"float\";\n\t\t\t\t\t\tct['office:value'] = (cell.v||0);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 's': case 'str':\n\t\t\t\t\t\ttextp = cell.v == null ? \"\" : cell.v;\n\t\t\t\t\t\tct['office:value-type'] = \"string\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'd':\n\t\t\t\t\t\ttextp = (cell.w||(parseDate(cell.v).toISOString()));\n\t\t\t\t\t\tct['office:value-type'] = \"date\";\n\t\t\t\t\t\tct['office:date-value'] = (parseDate(cell.v).toISOString());\n\t\t\t\t\t\tct['table:style-name'] = \"ce1\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t//case 'e':\n\t\t\t\t\tdefault: o.push(null_cell_xml); continue;\n\t\t\t\t}\n\t\t\t\tvar text_p = write_text_p(textp);\n\t\t\t\tif(cell.l && cell.l.Target) {\n\t\t\t\t\tvar _tgt = cell.l.Target;\n\t\t\t\t\t_tgt = _tgt.charAt(0) == \"#\" ? \"#\" + csf_to_ods_3D(_tgt.slice(1)) : _tgt;\n\t\t\t\t\t// TODO: choose correct parent path format based on link delimiters\n\t\t\t\t\tif(_tgt.charAt(0) != \"#\" && !_tgt.match(/^\\w+:/)) _tgt = '../' + _tgt;\n\t\t\t\t\ttext_p = writextag('text:a', text_p, {'xlink:href': _tgt.replace(/&/g, \"&amp;\")});\n\t\t\t\t}\n\t\t\t\to.push('          ' + writextag('table:table-cell', writextag('text:p', text_p, {}), ct) + '\\n');\n\t\t\t}\n\t\t\to.push('        </table:table-row>\\n');\n\t\t}\n\t\to.push('      </table:table>\\n');\n\t\treturn o.join(\"\");\n\t};\n\n\tvar write_automatic_styles_ods = function(o, wb) {\n\t\to.push(' <office:automatic-styles>\\n');\n\n\t\to.push('  <number:date-style style:name=\"N37\" number:automatic-order=\"true\">\\n');\n\t\to.push('   <number:month number:style=\"long\"/>\\n');\n\t\to.push('   <number:text>/</number:text>\\n');\n\t\to.push('   <number:day number:style=\"long\"/>\\n');\n\t\to.push('   <number:text>/</number:text>\\n');\n\t\to.push('   <number:year/>\\n');\n\t\to.push('  </number:date-style>\\n');\n\n\t\t/* column styles */\n\t\tvar cidx = 0;\n\t\twb.SheetNames.map(function(n) { return wb.Sheets[n]; }).forEach(function(ws) {\n\t\t\tif(!ws) return;\n\t\t\tif(ws[\"!cols\"]) {\n\t\t\t\tfor(var C = 0; C < ws[\"!cols\"].length; ++C) if(ws[\"!cols\"][C]) {\n\t\t\t\t\tvar colobj = ws[\"!cols\"][C];\n\t\t\t\t\tif(colobj.width == null && colobj.wpx == null && colobj.wch == null) continue;\n\t\t\t\t\tprocess_col(colobj);\n\t\t\t\t\tcolobj.ods = cidx;\n\t\t\t\t\tvar w = ws[\"!cols\"][C].wpx + \"px\";\n\t\t\t\t\to.push('  <style:style style:name=\"co' + cidx + '\" style:family=\"table-column\">\\n');\n\t\t\t\t\to.push('   <style:table-column-properties fo:break-before=\"auto\" style:column-width=\"' + w + '\"/>\\n');\n\t\t\t\t\to.push('  </style:style>\\n');\n\t\t\t\t\t++cidx;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t/* row styles */\n\t\tvar ridx = 0;\n\t\twb.SheetNames.map(function(n) { return wb.Sheets[n]; }).forEach(function(ws) {\n\t\t\tif(!ws) return;\n\t\t\tif(ws[\"!rows\"]) {\n\t\t\t\tfor(var R = 0; R < ws[\"!rows\"].length; ++R) if(ws[\"!rows\"][R]) {\n\t\t\t\t\tws[\"!rows\"][R].ods = ridx;\n\t\t\t\t\tvar h = ws[\"!rows\"][R].hpx + \"px\";\n\t\t\t\t\to.push('  <style:style style:name=\"ro' + ridx + '\" style:family=\"table-row\">\\n');\n\t\t\t\t\to.push('   <style:table-row-properties fo:break-before=\"auto\" style:row-height=\"' + h + '\"/>\\n');\n\t\t\t\t\to.push('  </style:style>\\n');\n\t\t\t\t\t++ridx;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t/* table */\n\t\to.push('  <style:style style:name=\"ta1\" style:family=\"table\" style:master-page-name=\"mp1\">\\n');\n\t\to.push('   <style:table-properties table:display=\"true\" style:writing-mode=\"lr-tb\"/>\\n');\n\t\to.push('  </style:style>\\n');\n\n\t\t/* table cells, text */\n\t\to.push('  <style:style style:name=\"ce1\" style:family=\"table-cell\" style:parent-style-name=\"Default\" style:data-style-name=\"N37\"/>\\n');\n\n\t\t/* page-layout */\n\n\t\to.push(' </office:automatic-styles>\\n');\n\t};\n\n\treturn function wcx(wb, opts) {\n\t\tvar o = [XML_HEADER];\n\t\t/* 3.1.3.2 */\n\t\tvar attr = wxt_helper({\n\t\t\t'xmlns:office':       \"urn:oasis:names:tc:opendocument:xmlns:office:1.0\",\n\t\t\t'xmlns:table':        \"urn:oasis:names:tc:opendocument:xmlns:table:1.0\",\n\t\t\t'xmlns:style':        \"urn:oasis:names:tc:opendocument:xmlns:style:1.0\",\n\t\t\t'xmlns:text':         \"urn:oasis:names:tc:opendocument:xmlns:text:1.0\",\n\t\t\t'xmlns:draw':         \"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\",\n\t\t\t'xmlns:fo':           \"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\",\n\t\t\t'xmlns:xlink':        \"http://www.w3.org/1999/xlink\",\n\t\t\t'xmlns:dc':           \"http://purl.org/dc/elements/1.1/\",\n\t\t\t'xmlns:meta':         \"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\",\n\t\t\t'xmlns:number':       \"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\",\n\t\t\t'xmlns:presentation': \"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0\",\n\t\t\t'xmlns:svg':          \"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\",\n\t\t\t'xmlns:chart':        \"urn:oasis:names:tc:opendocument:xmlns:chart:1.0\",\n\t\t\t'xmlns:dr3d':         \"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0\",\n\t\t\t'xmlns:math':         \"http://www.w3.org/1998/Math/MathML\",\n\t\t\t'xmlns:form':         \"urn:oasis:names:tc:opendocument:xmlns:form:1.0\",\n\t\t\t'xmlns:script':       \"urn:oasis:names:tc:opendocument:xmlns:script:1.0\",\n\t\t\t'xmlns:ooo':          \"http://openoffice.org/2004/office\",\n\t\t\t'xmlns:ooow':         \"http://openoffice.org/2004/writer\",\n\t\t\t'xmlns:oooc':         \"http://openoffice.org/2004/calc\",\n\t\t\t'xmlns:dom':          \"http://www.w3.org/2001/xml-events\",\n\t\t\t'xmlns:xforms':       \"http://www.w3.org/2002/xforms\",\n\t\t\t'xmlns:xsd':          \"http://www.w3.org/2001/XMLSchema\",\n\t\t\t'xmlns:xsi':          \"http://www.w3.org/2001/XMLSchema-instance\",\n\t\t\t'xmlns:sheet':        \"urn:oasis:names:tc:opendocument:sh33tjs:1.0\",\n\t\t\t'xmlns:rpt':          \"http://openoffice.org/2005/report\",\n\t\t\t'xmlns:of':           \"urn:oasis:names:tc:opendocument:xmlns:of:1.2\",\n\t\t\t'xmlns:xhtml':        \"http://www.w3.org/1999/xhtml\",\n\t\t\t'xmlns:grddl':        \"http://www.w3.org/2003/g/data-view#\",\n\t\t\t'xmlns:tableooo':     \"http://openoffice.org/2009/table\",\n\t\t\t'xmlns:drawooo':      \"http://openoffice.org/2010/draw\",\n\t\t\t'xmlns:calcext':      \"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0\",\n\t\t\t'xmlns:loext':        \"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0\",\n\t\t\t'xmlns:field':        \"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0\",\n\t\t\t'xmlns:formx':        \"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0\",\n\t\t\t'xmlns:css3t':        \"http://www.w3.org/TR/css3-text/\",\n\t\t\t'office:version':     \"1.2\"\n\t\t});\n\n\t\tvar fods = wxt_helper({\n\t\t\t'xmlns:config':    \"urn:oasis:names:tc:opendocument:xmlns:config:1.0\",\n\t\t\t'office:mimetype': \"application/vnd.oasis.opendocument.spreadsheet\"\n\t\t});\n\n\t\tif(opts.bookType == \"fods\") {\n\t\t\to.push('<office:document' + attr + fods + '>\\n');\n\t\t\to.push(write_meta_ods().replace(/office:document-meta/g, \"office:meta\"));\n\t\t\t// TODO: settings (equiv of settings.xml for ODS)\n\t\t} else o.push('<office:document-content' + attr  + '>\\n');\n\t\t// o.push('  <office:scripts/>\\n');\n\t\twrite_automatic_styles_ods(o, wb);\n\t\to.push('  <office:body>\\n');\n\t\to.push('    <office:spreadsheet>\\n');\n\t\tfor(var i = 0; i != wb.SheetNames.length; ++i) o.push(write_ws(wb.Sheets[wb.SheetNames[i]], wb, i, opts));\n\t\to.push('    </office:spreadsheet>\\n');\n\t\to.push('  </office:body>\\n');\n\t\tif(opts.bookType == \"fods\") o.push('</office:document>');\n\t\telse o.push('</office:document-content>');\n\t\treturn o.join(\"\");\n\t};\n})();\n\nfunction write_ods(wb, opts) {\n\tif(opts.bookType == \"fods\") return write_content_ods(wb, opts);\n\n\tvar zip = zip_new();\n\tvar f = \"\";\n\n\tvar manifest = [];\n\tvar rdf = [];\n\n\t/* Part 3 Section 3.3 MIME Media Type */\n\tf = \"mimetype\";\n\tzip_add_file(zip, f, \"application/vnd.oasis.opendocument.spreadsheet\");\n\n\t/* Part 1 Section 2.2 Documents */\n\tf = \"content.xml\";\n\tzip_add_file(zip, f, write_content_ods(wb, opts));\n\tmanifest.push([f, \"text/xml\"]);\n\trdf.push([f, \"ContentFile\"]);\n\n\t/* TODO: these are hard-coded styles to satiate excel */\n\tf = \"styles.xml\";\n\tzip_add_file(zip, f, write_styles_ods(wb, opts));\n\tmanifest.push([f, \"text/xml\"]);\n\trdf.push([f, \"StylesFile\"]);\n\n\t/* TODO: this is hard-coded to satiate excel */\n\tf = \"meta.xml\";\n\tzip_add_file(zip, f, XML_HEADER + write_meta_ods());\n\tmanifest.push([f, \"text/xml\"]);\n\trdf.push([f, \"MetadataFile\"]);\n\n\t/* Part 3 Section 6 Metadata Manifest File */\n\tf = \"manifest.rdf\";\n\tzip_add_file(zip, f, write_rdf(rdf/*, opts*/));\n\tmanifest.push([f, \"application/rdf+xml\"]);\n\n\t/* Part 3 Section 4 Manifest File */\n\tf = \"META-INF/manifest.xml\";\n\tzip_add_file(zip, f, write_manifest(manifest/*, opts*/));\n\n\treturn zip;\n}\n\n/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */\nfunction u8_to_dataview(array) {\n  return new DataView(array.buffer, array.byteOffset, array.byteLength);\n}\nfunction u8str(u8) {\n  return typeof TextDecoder != \"undefined\" ? new TextDecoder().decode(u8) : utf8read(a2s(u8));\n}\nfunction stru8(str) {\n  return typeof TextEncoder != \"undefined\" ? new TextEncoder().encode(str) : s2a(utf8write(str));\n}\nfunction u8contains(body, search) {\n  outer:\n    for (var L = 0; L <= body.length - search.length; ++L) {\n      for (var j = 0; j < search.length; ++j)\n        if (body[L + j] != search[j])\n          continue outer;\n      return true;\n    }\n  return false;\n}\nfunction u8concat(u8a) {\n  var len = u8a.reduce(function(acc, x) {\n    return acc + x.length;\n  }, 0);\n  var out = new Uint8Array(len);\n  var off = 0;\n  u8a.forEach(function(u8) {\n    out.set(u8, off);\n    off += u8.length;\n  });\n  return out;\n}\nfunction popcnt(x) {\n  x -= x >> 1 & 1431655765;\n  x = (x & 858993459) + (x >> 2 & 858993459);\n  return (x + (x >> 4) & 252645135) * 16843009 >>> 24;\n}\nfunction readDecimal128LE(buf, offset) {\n  var exp = (buf[offset + 15] & 127) << 7 | buf[offset + 14] >> 1;\n  var mantissa = buf[offset + 14] & 1;\n  for (var j = offset + 13; j >= offset; --j)\n    mantissa = mantissa * 256 + buf[j];\n  return (buf[offset + 15] & 128 ? -mantissa : mantissa) * Math.pow(10, exp - 6176);\n}\nfunction writeDecimal128LE(buf, offset, value) {\n  var exp = Math.floor(value == 0 ? 0 : Math.LOG10E * Math.log(Math.abs(value))) + 6176 - 20;\n  var mantissa = value / Math.pow(10, exp - 6176);\n  buf[offset + 15] |= exp >> 7;\n  buf[offset + 14] |= (exp & 127) << 1;\n  for (var i = 0; mantissa >= 1; ++i, mantissa /= 256)\n    buf[offset + i] = mantissa & 255;\n  buf[offset + 15] |= value >= 0 ? 0 : 128;\n}\nfunction parse_varint49(buf, ptr) {\n  var l = ptr ? ptr[0] : 0;\n  var usz = buf[l] & 127;\n  varint:\n    if (buf[l++] >= 128) {\n      usz |= (buf[l] & 127) << 7;\n      if (buf[l++] < 128)\n        break varint;\n      usz |= (buf[l] & 127) << 14;\n      if (buf[l++] < 128)\n        break varint;\n      usz |= (buf[l] & 127) << 21;\n      if (buf[l++] < 128)\n        break varint;\n      usz += (buf[l] & 127) * Math.pow(2, 28);\n      ++l;\n      if (buf[l++] < 128)\n        break varint;\n      usz += (buf[l] & 127) * Math.pow(2, 35);\n      ++l;\n      if (buf[l++] < 128)\n        break varint;\n      usz += (buf[l] & 127) * Math.pow(2, 42);\n      ++l;\n      if (buf[l++] < 128)\n        break varint;\n    }\n  if (ptr)\n    ptr[0] = l;\n  return usz;\n}\nfunction write_varint49(v) {\n  var usz = new Uint8Array(7);\n  usz[0] = v & 127;\n  var L = 1;\n  sz:\n    if (v > 127) {\n      usz[L - 1] |= 128;\n      usz[L] = v >> 7 & 127;\n      ++L;\n      if (v <= 16383)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v >> 14 & 127;\n      ++L;\n      if (v <= 2097151)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v >> 21 & 127;\n      ++L;\n      if (v <= 268435455)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v / 256 >>> 21 & 127;\n      ++L;\n      if (v <= 34359738367)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v / 65536 >>> 21 & 127;\n      ++L;\n      if (v <= 4398046511103)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v / 16777216 >>> 21 & 127;\n      ++L;\n    }\n  return usz.slice(0, L);\n}\nfunction varint_to_i32(buf) {\n  var l = 0, i32 = buf[l] & 127;\n  varint:\n    if (buf[l++] >= 128) {\n      i32 |= (buf[l] & 127) << 7;\n      if (buf[l++] < 128)\n        break varint;\n      i32 |= (buf[l] & 127) << 14;\n      if (buf[l++] < 128)\n        break varint;\n      i32 |= (buf[l] & 127) << 21;\n      if (buf[l++] < 128)\n        break varint;\n      i32 |= (buf[l] & 127) << 28;\n    }\n  return i32;\n}\nfunction parse_shallow(buf) {\n  var out = [], ptr = [0];\n  while (ptr[0] < buf.length) {\n    var off = ptr[0];\n    var num = parse_varint49(buf, ptr);\n    var type = num & 7;\n    num = Math.floor(num / 8);\n    var len = 0;\n    var res;\n    if (num == 0)\n      break;\n    switch (type) {\n      case 0:\n        {\n          var l = ptr[0];\n          while (buf[ptr[0]++] >= 128)\n            ;\n          res = buf.slice(l, ptr[0]);\n        }\n        break;\n      case 5:\n        len = 4;\n        res = buf.slice(ptr[0], ptr[0] + len);\n        ptr[0] += len;\n        break;\n      case 1:\n        len = 8;\n        res = buf.slice(ptr[0], ptr[0] + len);\n        ptr[0] += len;\n        break;\n      case 2:\n        len = parse_varint49(buf, ptr);\n        res = buf.slice(ptr[0], ptr[0] + len);\n        ptr[0] += len;\n        break;\n      case 3:\n      case 4:\n      default:\n        throw new Error(\"PB Type \".concat(type, \" for Field \").concat(num, \" at offset \").concat(off));\n    }\n    var v = { data: res, type: type };\n    if (out[num] == null)\n      out[num] = [v];\n    else\n      out[num].push(v);\n  }\n  return out;\n}\nfunction write_shallow(proto) {\n  var out = [];\n  proto.forEach(function(field, idx) {\n    field.forEach(function(item) {\n      if (!item.data)\n        return;\n      out.push(write_varint49(idx * 8 + item.type));\n      if (item.type == 2)\n        out.push(write_varint49(item.data.length));\n      out.push(item.data);\n    });\n  });\n  return u8concat(out);\n}\nfunction mappa(data, cb) {\n  return (data == null ? void 0 : data.map(function(d) {\n    return cb(d.data);\n  })) || [];\n}\nfunction parse_iwa_file(buf) {\n  var _a;\n  var out = [], ptr = [0];\n  while (ptr[0] < buf.length) {\n    var len = parse_varint49(buf, ptr);\n    var ai = parse_shallow(buf.slice(ptr[0], ptr[0] + len));\n    ptr[0] += len;\n    var res = {\n      id: varint_to_i32(ai[1][0].data),\n      messages: []\n    };\n    ai[2].forEach(function(b) {\n      var mi = parse_shallow(b.data);\n      var fl = varint_to_i32(mi[3][0].data);\n      res.messages.push({\n        meta: mi,\n        data: buf.slice(ptr[0], ptr[0] + fl)\n      });\n      ptr[0] += fl;\n    });\n    if ((_a = ai[3]) == null ? void 0 : _a[0])\n      res.merge = varint_to_i32(ai[3][0].data) >>> 0 > 0;\n    out.push(res);\n  }\n  return out;\n}\nfunction write_iwa_file(ias) {\n  var bufs = [];\n  ias.forEach(function(ia) {\n    var ai = [];\n    ai[1] = [{ data: write_varint49(ia.id), type: 0 }];\n    ai[2] = [];\n    if (ia.merge != null)\n      ai[3] = [{ data: write_varint49(+!!ia.merge), type: 0 }];\n    var midata = [];\n    ia.messages.forEach(function(mi) {\n      midata.push(mi.data);\n      mi.meta[3] = [{ type: 0, data: write_varint49(mi.data.length) }];\n      ai[2].push({ data: write_shallow(mi.meta), type: 2 });\n    });\n    var aipayload = write_shallow(ai);\n    bufs.push(write_varint49(aipayload.length));\n    bufs.push(aipayload);\n    midata.forEach(function(mid) {\n      return bufs.push(mid);\n    });\n  });\n  return u8concat(bufs);\n}\nfunction parse_snappy_chunk(type, buf) {\n  if (type != 0)\n    throw new Error(\"Unexpected Snappy chunk type \".concat(type));\n  var ptr = [0];\n  var usz = parse_varint49(buf, ptr);\n  var chunks = [];\n  while (ptr[0] < buf.length) {\n    var tag = buf[ptr[0]] & 3;\n    if (tag == 0) {\n      var len = buf[ptr[0]++] >> 2;\n      if (len < 60)\n        ++len;\n      else {\n        var c = len - 59;\n        len = buf[ptr[0]];\n        if (c > 1)\n          len |= buf[ptr[0] + 1] << 8;\n        if (c > 2)\n          len |= buf[ptr[0] + 2] << 16;\n        if (c > 3)\n          len |= buf[ptr[0] + 3] << 24;\n        len >>>= 0;\n        len++;\n        ptr[0] += c;\n      }\n      chunks.push(buf.slice(ptr[0], ptr[0] + len));\n      ptr[0] += len;\n      continue;\n    } else {\n      var offset = 0, length = 0;\n      if (tag == 1) {\n        length = (buf[ptr[0]] >> 2 & 7) + 4;\n        offset = (buf[ptr[0]++] & 224) << 3;\n        offset |= buf[ptr[0]++];\n      } else {\n        length = (buf[ptr[0]++] >> 2) + 1;\n        if (tag == 2) {\n          offset = buf[ptr[0]] | buf[ptr[0] + 1] << 8;\n          ptr[0] += 2;\n        } else {\n          offset = (buf[ptr[0]] | buf[ptr[0] + 1] << 8 | buf[ptr[0] + 2] << 16 | buf[ptr[0] + 3] << 24) >>> 0;\n          ptr[0] += 4;\n        }\n      }\n      chunks = [u8concat(chunks)];\n      if (offset == 0)\n        throw new Error(\"Invalid offset 0\");\n      if (offset > chunks[0].length)\n        throw new Error(\"Invalid offset beyond length\");\n      if (length >= offset) {\n        chunks.push(chunks[0].slice(-offset));\n        length -= offset;\n        while (length >= chunks[chunks.length - 1].length) {\n          chunks.push(chunks[chunks.length - 1]);\n          length -= chunks[chunks.length - 1].length;\n        }\n      }\n      chunks.push(chunks[0].slice(-offset, -offset + length));\n    }\n  }\n  var o = u8concat(chunks);\n  if (o.length != usz)\n    throw new Error(\"Unexpected length: \".concat(o.length, \" != \").concat(usz));\n  return o;\n}\nfunction decompress_iwa_file(buf) {\n  var out = [];\n  var l = 0;\n  while (l < buf.length) {\n    var t = buf[l++];\n    var len = buf[l] | buf[l + 1] << 8 | buf[l + 2] << 16;\n    l += 3;\n    out.push(parse_snappy_chunk(t, buf.slice(l, l + len)));\n    l += len;\n  }\n  if (l !== buf.length)\n    throw new Error(\"data is not a valid framed stream!\");\n  return u8concat(out);\n}\nfunction compress_iwa_file(buf) {\n  var out = [];\n  var l = 0;\n  while (l < buf.length) {\n    var c = Math.min(buf.length - l, 268435455);\n    var frame = new Uint8Array(4);\n    out.push(frame);\n    var usz = write_varint49(c);\n    var L = usz.length;\n    out.push(usz);\n    if (c <= 60) {\n      L++;\n      out.push(new Uint8Array([c - 1 << 2]));\n    } else if (c <= 256) {\n      L += 2;\n      out.push(new Uint8Array([240, c - 1 & 255]));\n    } else if (c <= 65536) {\n      L += 3;\n      out.push(new Uint8Array([244, c - 1 & 255, c - 1 >> 8 & 255]));\n    } else if (c <= 16777216) {\n      L += 4;\n      out.push(new Uint8Array([248, c - 1 & 255, c - 1 >> 8 & 255, c - 1 >> 16 & 255]));\n    } else if (c <= 4294967296) {\n      L += 5;\n      out.push(new Uint8Array([252, c - 1 & 255, c - 1 >> 8 & 255, c - 1 >> 16 & 255, c - 1 >>> 24 & 255]));\n    }\n    out.push(buf.slice(l, l + c));\n    L += c;\n    frame[0] = 0;\n    frame[1] = L & 255;\n    frame[2] = L >> 8 & 255;\n    frame[3] = L >> 16 & 255;\n    l += c;\n  }\n  return u8concat(out);\n}\nfunction parse_old_storage(buf, sst, rsst, v) {\n  var dv = u8_to_dataview(buf);\n  var flags = dv.getUint32(4, true);\n  var data_offset = (v > 1 ? 12 : 8) + popcnt(flags & (v > 1 ? 3470 : 398)) * 4;\n  var ridx = -1, sidx = -1, ieee = NaN, dt = new Date(2001, 0, 1);\n  if (flags & 512) {\n    ridx = dv.getUint32(data_offset, true);\n    data_offset += 4;\n  }\n  data_offset += popcnt(flags & (v > 1 ? 12288 : 4096)) * 4;\n  if (flags & 16) {\n    sidx = dv.getUint32(data_offset, true);\n    data_offset += 4;\n  }\n  if (flags & 32) {\n    ieee = dv.getFloat64(data_offset, true);\n    data_offset += 8;\n  }\n  if (flags & 64) {\n    dt.setTime(dt.getTime() + dv.getFloat64(data_offset, true) * 1e3);\n    data_offset += 8;\n  }\n  var ret;\n  switch (buf[2]) {\n    case 0:\n      break;\n    case 2:\n      ret = { t: \"n\", v: ieee };\n      break;\n    case 3:\n      ret = { t: \"s\", v: sst[sidx] };\n      break;\n    case 5:\n      ret = { t: \"d\", v: dt };\n      break;\n    case 6:\n      ret = { t: \"b\", v: ieee > 0 };\n      break;\n    case 7:\n      ret = { t: \"n\", v: ieee / 86400 };\n      break;\n    case 8:\n      ret = { t: \"e\", v: 0 };\n      break;\n    case 9:\n      {\n        if (ridx > -1)\n          ret = { t: \"s\", v: rsst[ridx] };\n        else if (sidx > -1)\n          ret = { t: \"s\", v: sst[sidx] };\n        else if (!isNaN(ieee))\n          ret = { t: \"n\", v: ieee };\n        else\n          throw new Error(\"Unsupported cell type \".concat(buf.slice(0, 4)));\n      }\n      break;\n    default:\n      throw new Error(\"Unsupported cell type \".concat(buf.slice(0, 4)));\n  }\n  return ret;\n}\nfunction parse_new_storage(buf, sst, rsst) {\n  var dv = u8_to_dataview(buf);\n  var flags = dv.getUint32(8, true);\n  var data_offset = 12;\n  var ridx = -1, sidx = -1, d128 = NaN, ieee = NaN, dt = new Date(2001, 0, 1);\n  if (flags & 1) {\n    d128 = readDecimal128LE(buf, data_offset);\n    data_offset += 16;\n  }\n  if (flags & 2) {\n    ieee = dv.getFloat64(data_offset, true);\n    data_offset += 8;\n  }\n  if (flags & 4) {\n    dt.setTime(dt.getTime() + dv.getFloat64(data_offset, true) * 1e3);\n    data_offset += 8;\n  }\n  if (flags & 8) {\n    sidx = dv.getUint32(data_offset, true);\n    data_offset += 4;\n  }\n  if (flags & 16) {\n    ridx = dv.getUint32(data_offset, true);\n    data_offset += 4;\n  }\n  var ret;\n  switch (buf[1]) {\n    case 0:\n      break;\n    case 2:\n      ret = { t: \"n\", v: d128 };\n      break;\n    case 3:\n      ret = { t: \"s\", v: sst[sidx] };\n      break;\n    case 5:\n      ret = { t: \"d\", v: dt };\n      break;\n    case 6:\n      ret = { t: \"b\", v: ieee > 0 };\n      break;\n    case 7:\n      ret = { t: \"n\", v: ieee / 86400 };\n      break;\n    case 8:\n      ret = { t: \"e\", v: 0 };\n      break;\n    case 9:\n      {\n        if (ridx > -1)\n          ret = { t: \"s\", v: rsst[ridx] };\n        else\n          throw new Error(\"Unsupported cell type \".concat(buf[1], \" : \").concat(flags & 31, \" : \").concat(buf.slice(0, 4)));\n      }\n      break;\n    case 10:\n      ret = { t: \"n\", v: d128 };\n      break;\n    default:\n      throw new Error(\"Unsupported cell type \".concat(buf[1], \" : \").concat(flags & 31, \" : \").concat(buf.slice(0, 4)));\n  }\n  return ret;\n}\nfunction write_new_storage(cell, sst) {\n  var out = new Uint8Array(32), dv = u8_to_dataview(out), l = 12, flags = 0;\n  out[0] = 5;\n  switch (cell.t) {\n    case \"n\":\n      out[1] = 2;\n      writeDecimal128LE(out, l, cell.v);\n      flags |= 1;\n      l += 16;\n      break;\n    case \"b\":\n      out[1] = 6;\n      dv.setFloat64(l, cell.v ? 1 : 0, true);\n      flags |= 2;\n      l += 8;\n      break;\n    case \"s\":\n      if (sst.indexOf(cell.v) == -1)\n        throw new Error(\"Value \".concat(cell.v, \" missing from SST!\"));\n      out[1] = 3;\n      dv.setUint32(l, sst.indexOf(cell.v), true);\n      flags |= 8;\n      l += 4;\n      break;\n    default:\n      throw \"unsupported cell type \" + cell.t;\n  }\n  dv.setUint32(8, flags, true);\n  return out.slice(0, l);\n}\nfunction write_old_storage(cell, sst) {\n  var out = new Uint8Array(32), dv = u8_to_dataview(out), l = 12, flags = 0;\n  out[0] = 3;\n  switch (cell.t) {\n    case \"n\":\n      out[2] = 2;\n      dv.setFloat64(l, cell.v, true);\n      flags |= 32;\n      l += 8;\n      break;\n    case \"b\":\n      out[2] = 6;\n      dv.setFloat64(l, cell.v ? 1 : 0, true);\n      flags |= 32;\n      l += 8;\n      break;\n    case \"s\":\n      if (sst.indexOf(cell.v) == -1)\n        throw new Error(\"Value \".concat(cell.v, \" missing from SST!\"));\n      out[2] = 3;\n      dv.setUint32(l, sst.indexOf(cell.v), true);\n      flags |= 16;\n      l += 4;\n      break;\n    default:\n      throw \"unsupported cell type \" + cell.t;\n  }\n  dv.setUint32(4, flags, true);\n  return out.slice(0, l);\n}\nfunction parse_cell_storage(buf, sst, rsst) {\n  switch (buf[0]) {\n    case 0:\n    case 1:\n    case 2:\n    case 3:\n      return parse_old_storage(buf, sst, rsst, buf[0]);\n    case 5:\n      return parse_new_storage(buf, sst, rsst);\n    default:\n      throw new Error(\"Unsupported payload version \".concat(buf[0]));\n  }\n}\nfunction parse_TSP_Reference(buf) {\n  var pb = parse_shallow(buf);\n  return parse_varint49(pb[1][0].data);\n}\nfunction write_TSP_Reference(idx) {\n  var out = [];\n  out[1] = [{ type: 0, data: write_varint49(idx) }];\n  return write_shallow(out);\n}\nfunction parse_TST_TableDataList(M, root) {\n  var pb = parse_shallow(root.data);\n  var type = varint_to_i32(pb[1][0].data);\n  var entries = pb[3];\n  var data = [];\n  (entries || []).forEach(function(entry) {\n    var le = parse_shallow(entry.data);\n    var key = varint_to_i32(le[1][0].data) >>> 0;\n    switch (type) {\n      case 1:\n        data[key] = u8str(le[3][0].data);\n        break;\n      case 8:\n        {\n          var rt = M[parse_TSP_Reference(le[9][0].data)][0];\n          var rtp = parse_shallow(rt.data);\n          var rtpref = M[parse_TSP_Reference(rtp[1][0].data)][0];\n          var mtype = varint_to_i32(rtpref.meta[1][0].data);\n          if (mtype != 2001)\n            throw new Error(\"2000 unexpected reference to \".concat(mtype));\n          var tswpsa = parse_shallow(rtpref.data);\n          data[key] = tswpsa[3].map(function(x) {\n            return u8str(x.data);\n          }).join(\"\");\n        }\n        break;\n    }\n  });\n  return data;\n}\nfunction parse_TST_TileRowInfo(u8, type) {\n  var _a, _b, _c, _d, _e, _f, _g, _h, _i, _j, _k, _l, _m, _n;\n  var pb = parse_shallow(u8);\n  var R = varint_to_i32(pb[1][0].data) >>> 0;\n  var cnt = varint_to_i32(pb[2][0].data) >>> 0;\n  var wide_offsets = ((_b = (_a = pb[8]) == null ? void 0 : _a[0]) == null ? void 0 : _b.data) && varint_to_i32(pb[8][0].data) > 0 || false;\n  var used_storage_u8, used_storage;\n  if (((_d = (_c = pb[7]) == null ? void 0 : _c[0]) == null ? void 0 : _d.data) && type != 0) {\n    used_storage_u8 = (_f = (_e = pb[7]) == null ? void 0 : _e[0]) == null ? void 0 : _f.data;\n    used_storage = (_h = (_g = pb[6]) == null ? void 0 : _g[0]) == null ? void 0 : _h.data;\n  } else if (((_j = (_i = pb[4]) == null ? void 0 : _i[0]) == null ? void 0 : _j.data) && type != 1) {\n    used_storage_u8 = (_l = (_k = pb[4]) == null ? void 0 : _k[0]) == null ? void 0 : _l.data;\n    used_storage = (_n = (_m = pb[3]) == null ? void 0 : _m[0]) == null ? void 0 : _n.data;\n  } else\n    throw \"NUMBERS Tile missing \".concat(type, \" cell storage\");\n  var width = wide_offsets ? 4 : 1;\n  var used_storage_offsets = u8_to_dataview(used_storage_u8);\n  var offsets = [];\n  for (var C = 0; C < used_storage_u8.length / 2; ++C) {\n    var off = used_storage_offsets.getUint16(C * 2, true);\n    if (off < 65535)\n      offsets.push([C, off]);\n  }\n  if (offsets.length != cnt)\n    throw \"Expected \".concat(cnt, \" cells, found \").concat(offsets.length);\n  var cells = [];\n  for (C = 0; C < offsets.length - 1; ++C)\n    cells[offsets[C][0]] = used_storage.subarray(offsets[C][1] * width, offsets[C + 1][1] * width);\n  if (offsets.length >= 1)\n    cells[offsets[offsets.length - 1][0]] = used_storage.subarray(offsets[offsets.length - 1][1] * width);\n  return { R: R, cells: cells };\n}\nfunction parse_TST_Tile(M, root) {\n  var _a;\n  var pb = parse_shallow(root.data);\n  var storage = ((_a = pb == null ? void 0 : pb[7]) == null ? void 0 : _a[0]) ? varint_to_i32(pb[7][0].data) >>> 0 > 0 ? 1 : 0 : -1;\n  var ri = mappa(pb[5], function(u8) {\n    return parse_TST_TileRowInfo(u8, storage);\n  });\n  return {\n    nrows: varint_to_i32(pb[4][0].data) >>> 0,\n    data: ri.reduce(function(acc, x) {\n      if (!acc[x.R])\n        acc[x.R] = [];\n      x.cells.forEach(function(cell, C) {\n        if (acc[x.R][C])\n          throw new Error(\"Duplicate cell r=\".concat(x.R, \" c=\").concat(C));\n        acc[x.R][C] = cell;\n      });\n      return acc;\n    }, [])\n  };\n}\nfunction parse_TST_TableModelArchive(M, root, ws) {\n  var _a;\n  var pb = parse_shallow(root.data);\n  var range = { s: { r: 0, c: 0 }, e: { r: 0, c: 0 } };\n  range.e.r = (varint_to_i32(pb[6][0].data) >>> 0) - 1;\n  if (range.e.r < 0)\n    throw new Error(\"Invalid row varint \".concat(pb[6][0].data));\n  range.e.c = (varint_to_i32(pb[7][0].data) >>> 0) - 1;\n  if (range.e.c < 0)\n    throw new Error(\"Invalid col varint \".concat(pb[7][0].data));\n  ws[\"!ref\"] = encode_range(range);\n  var store = parse_shallow(pb[4][0].data);\n  var sst = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[4][0].data)][0]);\n  var rsst = ((_a = store[17]) == null ? void 0 : _a[0]) ? parse_TST_TableDataList(M, M[parse_TSP_Reference(store[17][0].data)][0]) : [];\n  var tile = parse_shallow(store[3][0].data);\n  var _R = 0;\n  tile[1].forEach(function(t) {\n    var tl = parse_shallow(t.data);\n    var ref = M[parse_TSP_Reference(tl[2][0].data)][0];\n    var mtype = varint_to_i32(ref.meta[1][0].data);\n    if (mtype != 6002)\n      throw new Error(\"6001 unexpected reference to \".concat(mtype));\n    var _tile = parse_TST_Tile(M, ref);\n    _tile.data.forEach(function(row, R) {\n      row.forEach(function(buf, C) {\n        var addr = encode_cell({ r: _R + R, c: C });\n        var res = parse_cell_storage(buf, sst, rsst);\n        if (res)\n          ws[addr] = res;\n      });\n    });\n    _R += _tile.nrows;\n  });\n}\nfunction parse_TST_TableInfoArchive(M, root) {\n  var pb = parse_shallow(root.data);\n  var out = { \"!ref\": \"A1\" };\n  var tableref = M[parse_TSP_Reference(pb[2][0].data)];\n  var mtype = varint_to_i32(tableref[0].meta[1][0].data);\n  if (mtype != 6001)\n    throw new Error(\"6000 unexpected reference to \".concat(mtype));\n  parse_TST_TableModelArchive(M, tableref[0], out);\n  return out;\n}\nfunction parse_TN_SheetArchive(M, root) {\n  var _a;\n  var pb = parse_shallow(root.data);\n  var out = {\n    name: ((_a = pb[1]) == null ? void 0 : _a[0]) ? u8str(pb[1][0].data) : \"\",\n    sheets: []\n  };\n  var shapeoffs = mappa(pb[2], parse_TSP_Reference);\n  shapeoffs.forEach(function(off) {\n    M[off].forEach(function(m) {\n      var mtype = varint_to_i32(m.meta[1][0].data);\n      if (mtype == 6e3)\n        out.sheets.push(parse_TST_TableInfoArchive(M, m));\n    });\n  });\n  return out;\n}\nfunction parse_TN_DocumentArchive(M, root) {\n  var out = book_new();\n  var pb = parse_shallow(root.data);\n  var sheetoffs = mappa(pb[1], parse_TSP_Reference);\n  sheetoffs.forEach(function(off) {\n    M[off].forEach(function(m) {\n      var mtype = varint_to_i32(m.meta[1][0].data);\n      if (mtype == 2) {\n        var root2 = parse_TN_SheetArchive(M, m);\n        root2.sheets.forEach(function(sheet, idx) {\n          book_append_sheet(out, sheet, idx == 0 ? root2.name : root2.name + \"_\" + idx, true);\n        });\n      }\n    });\n  });\n  if (out.SheetNames.length == 0)\n    throw new Error(\"Empty NUMBERS file\");\n  return out;\n}\nfunction parse_numbers_iwa(cfb) {\n  var _a, _b, _c, _d;\n  var M = {}, indices = [];\n  cfb.FullPaths.forEach(function(p) {\n    if (p.match(/\\.iwpv2/))\n      throw new Error(\"Unsupported password protection\");\n  });\n  cfb.FileIndex.forEach(function(s) {\n    if (!s.name.match(/\\.iwa$/))\n      return;\n    var o;\n    try {\n      o = decompress_iwa_file(s.content);\n    } catch (e) {\n      return console.log(\"?? \" + s.content.length + \" \" + (e.message || e));\n    }\n    var packets;\n    try {\n      packets = parse_iwa_file(o);\n    } catch (e) {\n      return console.log(\"## \" + (e.message || e));\n    }\n    packets.forEach(function(packet) {\n      M[packet.id] = packet.messages;\n      indices.push(packet.id);\n    });\n  });\n  if (!indices.length)\n    throw new Error(\"File has no messages\");\n  var docroot = ((_d = (_c = (_b = (_a = M == null ? void 0 : M[1]) == null ? void 0 : _a[0]) == null ? void 0 : _b.meta) == null ? void 0 : _c[1]) == null ? void 0 : _d[0].data) && varint_to_i32(M[1][0].meta[1][0].data) == 1 && M[1][0];\n  if (!docroot)\n    indices.forEach(function(idx) {\n      M[idx].forEach(function(iwam) {\n        var mtype = varint_to_i32(iwam.meta[1][0].data) >>> 0;\n        if (mtype == 1) {\n          if (!docroot)\n            docroot = iwam;\n          else\n            throw new Error(\"Document has multiple roots\");\n        }\n      });\n    });\n  if (!docroot)\n    throw new Error(\"Cannot find Document root\");\n  return parse_TN_DocumentArchive(M, docroot);\n}\nfunction write_tile_row(tri, data, SST) {\n  var _a, _b, _c, _d;\n  if (!((_a = tri[6]) == null ? void 0 : _a[0]) || !((_b = tri[7]) == null ? void 0 : _b[0]))\n    throw \"Mutation only works on post-BNC storages!\";\n  var wide_offsets = ((_d = (_c = tri[8]) == null ? void 0 : _c[0]) == null ? void 0 : _d.data) && varint_to_i32(tri[8][0].data) > 0 || false;\n  if (wide_offsets)\n    throw \"Math only works with normal offsets\";\n  var cnt = 0;\n  var dv = u8_to_dataview(tri[7][0].data), last_offset = 0, cell_storage = [];\n  var _dv = u8_to_dataview(tri[4][0].data), _last_offset = 0, _cell_storage = [];\n  for (var C = 0; C < data.length; ++C) {\n    if (data[C] == null) {\n      dv.setUint16(C * 2, 65535, true);\n      _dv.setUint16(C * 2, 65535);\n      continue;\n    }\n    dv.setUint16(C * 2, last_offset, true);\n    _dv.setUint16(C * 2, _last_offset, true);\n    var celload, _celload;\n    switch (typeof data[C]) {\n      case \"string\":\n        celload = write_new_storage({ t: \"s\", v: data[C] }, SST);\n        _celload = write_old_storage({ t: \"s\", v: data[C] }, SST);\n        break;\n      case \"number\":\n        celload = write_new_storage({ t: \"n\", v: data[C] }, SST);\n        _celload = write_old_storage({ t: \"n\", v: data[C] }, SST);\n        break;\n      case \"boolean\":\n        celload = write_new_storage({ t: \"b\", v: data[C] }, SST);\n        _celload = write_old_storage({ t: \"b\", v: data[C] }, SST);\n        break;\n      default:\n        throw new Error(\"Unsupported value \" + data[C]);\n    }\n    cell_storage.push(celload);\n    last_offset += celload.length;\n    _cell_storage.push(_celload);\n    _last_offset += _celload.length;\n    ++cnt;\n  }\n  tri[2][0].data = write_varint49(cnt);\n  for (; C < tri[7][0].data.length / 2; ++C) {\n    dv.setUint16(C * 2, 65535, true);\n    _dv.setUint16(C * 2, 65535, true);\n  }\n  tri[6][0].data = u8concat(cell_storage);\n  tri[3][0].data = u8concat(_cell_storage);\n  return cnt;\n}\nfunction write_numbers_iwa(wb, opts) {\n  if (!opts || !opts.numbers)\n    throw new Error(\"Must pass a `numbers` option -- check the README\");\n  var ws = wb.Sheets[wb.SheetNames[0]];\n  if (wb.SheetNames.length > 1)\n    console.error(\"The Numbers writer currently writes only the first table\");\n  var range = decode_range(ws[\"!ref\"]);\n  range.s.r = range.s.c = 0;\n  var trunc = false;\n  if (range.e.c > 9) {\n    trunc = true;\n    range.e.c = 9;\n  }\n  if (range.e.r > 49) {\n    trunc = true;\n    range.e.r = 49;\n  }\n  if (trunc)\n    console.error(\"The Numbers writer is currently limited to \".concat(encode_range(range)));\n  var data = sheet_to_json(ws, { range: range, header: 1 });\n  var SST = [\"~Sh33tJ5~\"];\n  data.forEach(function(row) {\n    return row.forEach(function(cell) {\n      if (typeof cell == \"string\")\n        SST.push(cell);\n    });\n  });\n  var dependents = {};\n  var indices = [];\n  var cfb = CFB.read(opts.numbers, { type: \"base64\" });\n  cfb.FileIndex.map(function(fi, idx) {\n    return [fi, cfb.FullPaths[idx]];\n  }).forEach(function(row) {\n    var fi = row[0], fp = row[1];\n    if (fi.type != 2)\n      return;\n    if (!fi.name.match(/\\.iwa/))\n      return;\n    var old_content = fi.content;\n    var raw1 = decompress_iwa_file(old_content);\n    var x2 = parse_iwa_file(raw1);\n    x2.forEach(function(packet2) {\n      indices.push(packet2.id);\n      dependents[packet2.id] = { deps: [], location: fp, type: varint_to_i32(packet2.messages[0].meta[1][0].data) };\n    });\n  });\n  indices.sort(function(x2, y2) {\n    return x2 - y2;\n  });\n  var indices_varint = indices.filter(function(x2) {\n    return x2 > 1;\n  }).map(function(x2) {\n    return [x2, write_varint49(x2)];\n  });\n  cfb.FileIndex.map(function(fi, idx) {\n    return [fi, cfb.FullPaths[idx]];\n  }).forEach(function(row) {\n    var fi = row[0], fp = row[1];\n    if (!fi.name.match(/\\.iwa/))\n      return;\n    var x2 = parse_iwa_file(decompress_iwa_file(fi.content));\n    x2.forEach(function(ia) {\n      ia.messages.forEach(function(m) {\n        indices_varint.forEach(function(ivi) {\n          if (ia.messages.some(function(mess) {\n            return varint_to_i32(mess.meta[1][0].data) != 11006 && u8contains(mess.data, ivi[1]);\n          })) {\n            dependents[ivi[0]].deps.push(ia.id);\n          }\n        });\n      });\n    });\n  });\n  function get_unique_msgid() {\n    for (var i = 927262; i < 2e6; ++i)\n      if (!dependents[i])\n        return i;\n    throw new Error(\"Too many messages\");\n  }\n  var entry = CFB.find(cfb, dependents[1].location);\n  var x = parse_iwa_file(decompress_iwa_file(entry.content));\n  var docroot;\n  for (var xi = 0; xi < x.length; ++xi) {\n    var packet = x[xi];\n    if (packet.id == 1)\n      docroot = packet;\n  }\n  var sheetrootref = parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[1][0].data);\n  entry = CFB.find(cfb, dependents[sheetrootref].location);\n  x = parse_iwa_file(decompress_iwa_file(entry.content));\n  for (xi = 0; xi < x.length; ++xi) {\n    packet = x[xi];\n    if (packet.id == sheetrootref)\n      docroot = packet;\n  }\n  sheetrootref = parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[2][0].data);\n  entry = CFB.find(cfb, dependents[sheetrootref].location);\n  x = parse_iwa_file(decompress_iwa_file(entry.content));\n  for (xi = 0; xi < x.length; ++xi) {\n    packet = x[xi];\n    if (packet.id == sheetrootref)\n      docroot = packet;\n  }\n  sheetrootref = parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[2][0].data);\n  entry = CFB.find(cfb, dependents[sheetrootref].location);\n  x = parse_iwa_file(decompress_iwa_file(entry.content));\n  for (xi = 0; xi < x.length; ++xi) {\n    packet = x[xi];\n    if (packet.id == sheetrootref)\n      docroot = packet;\n  }\n  var pb = parse_shallow(docroot.messages[0].data);\n  {\n    pb[6][0].data = write_varint49(range.e.r + 1);\n    pb[7][0].data = write_varint49(range.e.c + 1);\n    var cruidsref = parse_TSP_Reference(pb[46][0].data);\n    var oldbucket = CFB.find(cfb, dependents[cruidsref].location);\n    var _x = parse_iwa_file(decompress_iwa_file(oldbucket.content));\n    {\n      for (var j = 0; j < _x.length; ++j) {\n        if (_x[j].id == cruidsref)\n          break;\n      }\n      if (_x[j].id != cruidsref)\n        throw \"Bad ColumnRowUIDMapArchive\";\n      var cruids = parse_shallow(_x[j].messages[0].data);\n      cruids[1] = [];\n      cruids[2] = [], cruids[3] = [];\n      for (var C = 0; C <= range.e.c; ++C) {\n        var uuid = [];\n        uuid[1] = uuid[2] = [{ type: 0, data: write_varint49(C + 420690) }];\n        cruids[1].push({ type: 2, data: write_shallow(uuid) });\n        cruids[2].push({ type: 0, data: write_varint49(C) });\n        cruids[3].push({ type: 0, data: write_varint49(C) });\n      }\n      cruids[4] = [];\n      cruids[5] = [], cruids[6] = [];\n      for (var R = 0; R <= range.e.r; ++R) {\n        uuid = [];\n        uuid[1] = uuid[2] = [{ type: 0, data: write_varint49(R + 726270) }];\n        cruids[4].push({ type: 2, data: write_shallow(uuid) });\n        cruids[5].push({ type: 0, data: write_varint49(R) });\n        cruids[6].push({ type: 0, data: write_varint49(R) });\n      }\n      _x[j].messages[0].data = write_shallow(cruids);\n    }\n    oldbucket.content = compress_iwa_file(write_iwa_file(_x));\n    oldbucket.size = oldbucket.content.length;\n    delete pb[46];\n    var store = parse_shallow(pb[4][0].data);\n    {\n      store[7][0].data = write_varint49(range.e.r + 1);\n      var row_headers = parse_shallow(store[1][0].data);\n      var row_header_ref = parse_TSP_Reference(row_headers[2][0].data);\n      oldbucket = CFB.find(cfb, dependents[row_header_ref].location);\n      _x = parse_iwa_file(decompress_iwa_file(oldbucket.content));\n      {\n        if (_x[0].id != row_header_ref)\n          throw \"Bad HeaderStorageBucket\";\n        var base_bucket = parse_shallow(_x[0].messages[0].data);\n        for (R = 0; R < data.length; ++R) {\n          var _bucket = parse_shallow(base_bucket[2][0].data);\n          _bucket[1][0].data = write_varint49(R);\n          _bucket[4][0].data = write_varint49(data[R].length);\n          base_bucket[2][R] = { type: base_bucket[2][0].type, data: write_shallow(_bucket) };\n        }\n        _x[0].messages[0].data = write_shallow(base_bucket);\n      }\n      oldbucket.content = compress_iwa_file(write_iwa_file(_x));\n      oldbucket.size = oldbucket.content.length;\n      var col_header_ref = parse_TSP_Reference(store[2][0].data);\n      oldbucket = CFB.find(cfb, dependents[col_header_ref].location);\n      _x = parse_iwa_file(decompress_iwa_file(oldbucket.content));\n      {\n        if (_x[0].id != col_header_ref)\n          throw \"Bad HeaderStorageBucket\";\n        base_bucket = parse_shallow(_x[0].messages[0].data);\n        for (C = 0; C <= range.e.c; ++C) {\n          _bucket = parse_shallow(base_bucket[2][0].data);\n          _bucket[1][0].data = write_varint49(C);\n          _bucket[4][0].data = write_varint49(range.e.r + 1);\n          base_bucket[2][C] = { type: base_bucket[2][0].type, data: write_shallow(_bucket) };\n        }\n        _x[0].messages[0].data = write_shallow(base_bucket);\n      }\n      oldbucket.content = compress_iwa_file(write_iwa_file(_x));\n      oldbucket.size = oldbucket.content.length;\n      var sstref = parse_TSP_Reference(store[4][0].data);\n      (function() {\n        var sentry = CFB.find(cfb, dependents[sstref].location);\n        var sx = parse_iwa_file(decompress_iwa_file(sentry.content));\n        var sstroot;\n        for (var sxi = 0; sxi < sx.length; ++sxi) {\n          var packet2 = sx[sxi];\n          if (packet2.id == sstref)\n            sstroot = packet2;\n        }\n        var sstdata = parse_shallow(sstroot.messages[0].data);\n        {\n          sstdata[3] = [];\n          var newsst = [];\n          SST.forEach(function(str, i) {\n            newsst[1] = [{ type: 0, data: write_varint49(i) }];\n            newsst[2] = [{ type: 0, data: write_varint49(1) }];\n            newsst[3] = [{ type: 2, data: stru8(str) }];\n            sstdata[3].push({ type: 2, data: write_shallow(newsst) });\n          });\n        }\n        sstroot.messages[0].data = write_shallow(sstdata);\n        var sy = write_iwa_file(sx);\n        var raw32 = compress_iwa_file(sy);\n        sentry.content = raw32;\n        sentry.size = sentry.content.length;\n      })();\n      var tile = parse_shallow(store[3][0].data);\n      {\n        var t = tile[1][0];\n        delete tile[2];\n        var tl = parse_shallow(t.data);\n        {\n          var tileref = parse_TSP_Reference(tl[2][0].data);\n          (function() {\n            var tentry = CFB.find(cfb, dependents[tileref].location);\n            var tx = parse_iwa_file(decompress_iwa_file(tentry.content));\n            var tileroot;\n            for (var sxi = 0; sxi < tx.length; ++sxi) {\n              var packet2 = tx[sxi];\n              if (packet2.id == tileref)\n                tileroot = packet2;\n            }\n            var tiledata = parse_shallow(tileroot.messages[0].data);\n            {\n              delete tiledata[6];\n              delete tile[7];\n              var rowload = new Uint8Array(tiledata[5][0].data);\n              tiledata[5] = [];\n              var cnt = 0;\n              for (var R2 = 0; R2 <= range.e.r; ++R2) {\n                var tilerow = parse_shallow(rowload);\n                cnt += write_tile_row(tilerow, data[R2], SST);\n                tilerow[1][0].data = write_varint49(R2);\n                tiledata[5].push({ data: write_shallow(tilerow), type: 2 });\n              }\n              tiledata[1] = [{ type: 0, data: write_varint49(range.e.c + 1) }];\n              tiledata[2] = [{ type: 0, data: write_varint49(range.e.r + 1) }];\n              tiledata[3] = [{ type: 0, data: write_varint49(cnt) }];\n              tiledata[4] = [{ type: 0, data: write_varint49(range.e.r + 1) }];\n            }\n            tileroot.messages[0].data = write_shallow(tiledata);\n            var ty = write_iwa_file(tx);\n            var raw32 = compress_iwa_file(ty);\n            tentry.content = raw32;\n            tentry.size = tentry.content.length;\n          })();\n        }\n        t.data = write_shallow(tl);\n      }\n      store[3][0].data = write_shallow(tile);\n    }\n    pb[4][0].data = write_shallow(store);\n  }\n  docroot.messages[0].data = write_shallow(pb);\n  var y = write_iwa_file(x);\n  var raw3 = compress_iwa_file(y);\n  entry.content = raw3;\n  entry.size = entry.content.length;\n  return cfb;\n}\nfunction fix_opts_func(defaults) {\n\treturn function fix_opts(opts) {\n\t\tfor(var i = 0; i != defaults.length; ++i) {\n\t\t\tvar d = defaults[i];\n\t\t\tif(opts[d[0]] === undefined) opts[d[0]] = d[1];\n\t\t\tif(d[2] === 'n') opts[d[0]] = Number(opts[d[0]]);\n\t\t}\n\t};\n}\n\nfunction fix_read_opts(opts) {\nfix_opts_func([\n\t['cellNF', false], /* emit cell number format string as .z */\n\t['cellHTML', true], /* emit html string as .h */\n\t['cellFormula', true], /* emit formulae as .f */\n\t['cellStyles', false], /* emits style/theme as .s */\n\t['cellText', true], /* emit formatted text as .w */\n\t['cellDates', false], /* emit date cells with type `d` */\n\n\t['sheetStubs', false], /* emit empty cells */\n\t['sheetRows', 0, 'n'], /* read n rows (0 = read all rows) */\n\n\t['bookDeps', false], /* parse calculation chains */\n\t['bookSheets', false], /* only try to get sheet names (no Sheets) */\n\t['bookProps', false], /* only try to get properties (no Sheets) */\n\t['bookFiles', false], /* include raw file structure (keys, files, cfb) */\n\t['bookVBA', false], /* include vba raw data (vbaraw) */\n\n\t['password',''], /* password */\n\t['WTF', false] /* WTF mode (throws errors) */\n])(opts);\n}\n\nfunction fix_write_opts(opts) {\nfix_opts_func([\n\t['cellDates', false], /* write date cells with type `d` */\n\n\t['bookSST', false], /* Generate Shared String Table */\n\n\t['bookType', 'xlsx'], /* Type of workbook (xlsx/m/b) */\n\n\t['compression', false], /* Use file compression */\n\n\t['WTF', false] /* WTF mode (throws errors) */\n])(opts);\n}\nfunction get_sheet_type(n) {\n\tif(RELS.WS.indexOf(n) > -1) return \"sheet\";\n\tif(RELS.CS && n == RELS.CS) return \"chart\";\n\tif(RELS.DS && n == RELS.DS) return \"dialog\";\n\tif(RELS.MS && n == RELS.MS) return \"macro\";\n\treturn (n && n.length) ? n : \"sheet\";\n}\nfunction safe_parse_wbrels(wbrels, sheets) {\n\tif(!wbrels) return 0;\n\ttry {\n\t\twbrels = sheets.map(function pwbr(w) { if(!w.id) w.id = w.strRelID; return [w.name, wbrels['!id'][w.id].Target, get_sheet_type(wbrels['!id'][w.id].Type)]; });\n\t} catch(e) { return null; }\n\treturn !wbrels || wbrels.length === 0 ? null : wbrels;\n}\n\nfunction safe_parse_sheet(zip, path, relsPath, sheet, idx, sheetRels, sheets, stype, opts, wb, themes, styles) {\n\ttry {\n\t\tsheetRels[sheet]=parse_rels(getzipstr(zip, relsPath, true), path);\n\t\tvar data = getzipdata(zip, path);\n\t\tvar _ws;\n\t\tswitch(stype) {\n\t\t\tcase 'sheet':  _ws = parse_ws(data, path, idx, opts, sheetRels[sheet], wb, themes, styles); break;\n\t\t\tcase 'chart':  _ws = parse_cs(data, path, idx, opts, sheetRels[sheet], wb, themes, styles);\n\t\t\t\tif(!_ws || !_ws['!drawel']) break;\n\t\t\t\tvar dfile = resolve_path(_ws['!drawel'].Target, path);\n\t\t\t\tvar drelsp = get_rels_path(dfile);\n\t\t\t\tvar draw = parse_drawing(getzipstr(zip, dfile, true), parse_rels(getzipstr(zip, drelsp, true), dfile));\n\t\t\t\tvar chartp = resolve_path(draw, dfile);\n\t\t\t\tvar crelsp = get_rels_path(chartp);\n\t\t\t\t_ws = parse_chart(getzipstr(zip, chartp, true), chartp, opts, parse_rels(getzipstr(zip, crelsp, true), chartp), wb, _ws);\n\t\t\t\tbreak;\n\t\t\tcase 'macro':  _ws = parse_ms(data, path, idx, opts, sheetRels[sheet], wb, themes, styles); break;\n\t\t\tcase 'dialog': _ws = parse_ds(data, path, idx, opts, sheetRels[sheet], wb, themes, styles); break;\n\t\t\tdefault: throw new Error(\"Unrecognized sheet type \" + stype);\n\t\t}\n\t\tsheets[sheet] = _ws;\n\n\t\t/* scan rels for comments and threaded comments */\n\t\tvar tcomments = [];\n\t\tif(sheetRels && sheetRels[sheet]) keys(sheetRels[sheet]).forEach(function(n) {\n\t\t\tvar dfile = \"\";\n\t\t\tif(sheetRels[sheet][n].Type == RELS.CMNT) {\n\t\t\t\tdfile = resolve_path(sheetRels[sheet][n].Target, path);\n\t\t\t\tvar comments = parse_cmnt(getzipdata(zip, dfile, true), dfile, opts);\n\t\t\t\tif(!comments || !comments.length) return;\n\t\t\t\tsheet_insert_comments(_ws, comments, false);\n\t\t\t}\n\t\t\tif(sheetRels[sheet][n].Type == RELS.TCMNT) {\n\t\t\t\tdfile = resolve_path(sheetRels[sheet][n].Target, path);\n\t\t\t\ttcomments = tcomments.concat(parse_tcmnt_xml(getzipdata(zip, dfile, true), opts));\n\t\t\t}\n\t\t});\n\t\tif(tcomments && tcomments.length) sheet_insert_comments(_ws, tcomments, true, opts.people || []);\n\t} catch(e) { if(opts.WTF) throw e; }\n}\n\nfunction strip_front_slash(x) { return x.charAt(0) == '/' ? x.slice(1) : x; }\n\nfunction parse_zip(zip, opts) {\n\tmake_ssf();\n\topts = opts || {};\n\tfix_read_opts(opts);\n\n\t/* OpenDocument Part 3 Section 2.2.1 OpenDocument Package */\n\tif(safegetzipfile(zip, 'META-INF/manifest.xml')) return parse_ods(zip, opts);\n\t/* UOC */\n\tif(safegetzipfile(zip, 'objectdata.xml')) return parse_ods(zip, opts);\n\t/* Numbers */\n\tif(safegetzipfile(zip, 'Index/Document.iwa')) {\n\t\tif(typeof Uint8Array == \"undefined\") throw new Error('NUMBERS file parsing requires Uint8Array support');\n\t\tif(typeof parse_numbers_iwa != \"undefined\") {\n\t\t\tif(zip.FileIndex) return parse_numbers_iwa(zip);\n\t\t\tvar _zip = CFB.utils.cfb_new();\n\t\t\tzipentries(zip).forEach(function(e) { zip_add_file(_zip, e, getzipbin(zip, e)); });\n\t\t\treturn parse_numbers_iwa(_zip);\n\t\t}\n\t\tthrow new Error('Unsupported NUMBERS file');\n\t}\n\tif(!safegetzipfile(zip, '[Content_Types].xml')) {\n\t\tif(safegetzipfile(zip, 'index.xml.gz')) throw new Error('Unsupported NUMBERS 08 file');\n\t\tif(safegetzipfile(zip, 'index.xml')) throw new Error('Unsupported NUMBERS 09 file');\n\t\tthrow new Error('Unsupported ZIP file');\n\t}\n\n\tvar entries = zipentries(zip);\n\tvar dir = parse_ct((getzipstr(zip, '[Content_Types].xml')));\n\tvar xlsb = false;\n\tvar sheets, binname;\n\tif(dir.workbooks.length === 0) {\n\t\tbinname = \"xl/workbook.xml\";\n\t\tif(getzipdata(zip,binname, true)) dir.workbooks.push(binname);\n\t}\n\tif(dir.workbooks.length === 0) {\n\t\tbinname = \"xl/workbook.bin\";\n\t\tif(!getzipdata(zip,binname,true)) throw new Error(\"Could not find workbook\");\n\t\tdir.workbooks.push(binname);\n\t\txlsb = true;\n\t}\n\tif(dir.workbooks[0].slice(-3) == \"bin\") xlsb = true;\n\n\tvar themes = ({});\n\tvar styles = ({});\n\tif(!opts.bookSheets && !opts.bookProps) {\n\t\tstrs = [];\n\t\tif(dir.sst) try { strs=parse_sst(getzipdata(zip, strip_front_slash(dir.sst)), dir.sst, opts); } catch(e) { if(opts.WTF) throw e; }\n\n\t\tif(opts.cellStyles && dir.themes.length) themes = parse_theme(getzipstr(zip, dir.themes[0].replace(/^\\//,''), true)||\"\",dir.themes[0], opts);\n\n\t\tif(dir.style) styles = parse_sty(getzipdata(zip, strip_front_slash(dir.style)), dir.style, themes, opts);\n\t}\n\n\t/*var externbooks = */dir.links.map(function(link) {\n\t\ttry {\n\t\t\tvar rels = parse_rels(getzipstr(zip, get_rels_path(strip_front_slash(link))), link);\n\t\t\treturn parse_xlink(getzipdata(zip, strip_front_slash(link)), rels, link, opts);\n\t\t} catch(e) {}\n\t});\n\n\tvar wb = parse_wb(getzipdata(zip, strip_front_slash(dir.workbooks[0])), dir.workbooks[0], opts);\n\n\tvar props = {}, propdata = \"\";\n\n\tif(dir.coreprops.length) {\n\t\tpropdata = getzipdata(zip, strip_front_slash(dir.coreprops[0]), true);\n\t\tif(propdata) props = parse_core_props(propdata);\n\t\tif(dir.extprops.length !== 0) {\n\t\t\tpropdata = getzipdata(zip, strip_front_slash(dir.extprops[0]), true);\n\t\t\tif(propdata) parse_ext_props(propdata, props, opts);\n\t\t}\n\t}\n\n\tvar custprops = {};\n\tif(!opts.bookSheets || opts.bookProps) {\n\t\tif (dir.custprops.length !== 0) {\n\t\t\tpropdata = getzipstr(zip, strip_front_slash(dir.custprops[0]), true);\n\t\t\tif(propdata) custprops = parse_cust_props(propdata, opts);\n\t\t}\n\t}\n\n\tvar out = ({});\n\tif(opts.bookSheets || opts.bookProps) {\n\t\tif(wb.Sheets) sheets = wb.Sheets.map(function pluck(x){ return x.name; });\n\t\telse if(props.Worksheets && props.SheetNames.length > 0) sheets=props.SheetNames;\n\t\tif(opts.bookProps) { out.Props = props; out.Custprops = custprops; }\n\t\tif(opts.bookSheets && typeof sheets !== 'undefined') out.SheetNames = sheets;\n\t\tif(opts.bookSheets ? out.SheetNames : opts.bookProps) return out;\n\t}\n\tsheets = {};\n\n\tvar deps = {};\n\tif(opts.bookDeps && dir.calcchain) deps=parse_cc(getzipdata(zip, strip_front_slash(dir.calcchain)),dir.calcchain,opts);\n\n\tvar i=0;\n\tvar sheetRels = ({});\n\tvar path, relsPath;\n\n\t{\n\t\tvar wbsheets = wb.Sheets;\n\t\tprops.Worksheets = wbsheets.length;\n\t\tprops.SheetNames = [];\n\t\tfor(var j = 0; j != wbsheets.length; ++j) {\n\t\t\tprops.SheetNames[j] = wbsheets[j].name;\n\t\t}\n\t}\n\n\tvar wbext = xlsb ? \"bin\" : \"xml\";\n\tvar wbrelsi = dir.workbooks[0].lastIndexOf(\"/\");\n\tvar wbrelsfile = (dir.workbooks[0].slice(0, wbrelsi+1) + \"_rels/\" + dir.workbooks[0].slice(wbrelsi+1) + \".rels\").replace(/^\\//,\"\");\n\tif(!safegetzipfile(zip, wbrelsfile)) wbrelsfile = 'xl/_rels/workbook.' + wbext + '.rels';\n\tvar wbrels = parse_rels(getzipstr(zip, wbrelsfile, true), wbrelsfile.replace(/_rels.*/, \"s5s\"));\n\n\tif((dir.metadata || []).length >= 1) {\n\t\t/* TODO: MDX and other types of metadata */\n\t\topts.xlmeta = parse_xlmeta(getzipdata(zip, strip_front_slash(dir.metadata[0])),dir.metadata[0],opts);\n\t}\n\n\tif((dir.people || []).length >= 1) {\n\t\topts.people = parse_people_xml(getzipdata(zip, strip_front_slash(dir.people[0])),opts);\n\t}\n\n\tif(wbrels) wbrels = safe_parse_wbrels(wbrels, wb.Sheets);\n\n\t/* Numbers iOS hack */\n\tvar nmode = (getzipdata(zip,\"xl/worksheets/sheet.xml\",true))?1:0;\n\twsloop: for(i = 0; i != props.Worksheets; ++i) {\n\t\tvar stype = \"sheet\";\n\t\tif(wbrels && wbrels[i]) {\n\t\t\tpath = 'xl/' + (wbrels[i][1]).replace(/[\\/]?xl\\//, \"\");\n\t\t\tif(!safegetzipfile(zip, path)) path = wbrels[i][1];\n\t\t\tif(!safegetzipfile(zip, path)) path = wbrelsfile.replace(/_rels\\/.*$/,\"\") + wbrels[i][1];\n\t\t\tstype = wbrels[i][2];\n\t\t} else {\n\t\t\tpath = 'xl/worksheets/sheet'+(i+1-nmode)+\".\" + wbext;\n\t\t\tpath = path.replace(/sheet0\\./,\"sheet.\");\n\t\t}\n\t\trelsPath = path.replace(/^(.*)(\\/)([^\\/]*)$/, \"$1/_rels/$3.rels\");\n\t\tif(opts && opts.sheets != null) switch(typeof opts.sheets) {\n\t\t\tcase \"number\": if(i != opts.sheets) continue wsloop; break;\n\t\t\tcase \"string\": if(props.SheetNames[i].toLowerCase() != opts.sheets.toLowerCase()) continue wsloop; break;\n\t\t\tdefault: if(Array.isArray && Array.isArray(opts.sheets)) {\n\t\t\t\tvar snjseen = false;\n\t\t\t\tfor(var snj = 0; snj != opts.sheets.length; ++snj) {\n\t\t\t\t\tif(typeof opts.sheets[snj] == \"number\" && opts.sheets[snj] == i) snjseen=1;\n\t\t\t\t\tif(typeof opts.sheets[snj] == \"string\" && opts.sheets[snj].toLowerCase() == props.SheetNames[i].toLowerCase()) snjseen = 1;\n\t\t\t\t}\n\t\t\t\tif(!snjseen) continue wsloop;\n\t\t\t}\n\t\t}\n\t\tsafe_parse_sheet(zip, path, relsPath, props.SheetNames[i], i, sheetRels, sheets, stype, opts, wb, themes, styles);\n\t}\n\n\tout = ({\n\t\tDirectory: dir,\n\t\tWorkbook: wb,\n\t\tProps: props,\n\t\tCustprops: custprops,\n\t\tDeps: deps,\n\t\tSheets: sheets,\n\t\tSheetNames: props.SheetNames,\n\t\tStrings: strs,\n\t\tStyles: styles,\n\t\tThemes: themes,\n\t\tSSF: dup(table_fmt)\n\t});\n\tif(opts && opts.bookFiles) {\n\t\tif(zip.files) {\n\t\t\tout.keys = entries;\n\t\t\tout.files = zip.files;\n\t\t} else {\n\t\t\tout.keys = [];\n\t\t\tout.files = {};\n\t\t\tzip.FullPaths.forEach(function(p, idx) {\n\t\t\t\tp = p.replace(/^Root Entry[\\/]/, \"\");\n\t\t\t\tout.keys.push(p);\n\t\t\t\tout.files[p] = zip.FileIndex[idx];\n\t\t\t});\n\t\t}\n\t}\n\tif(opts && opts.bookVBA) {\n\t\tif(dir.vba.length > 0) out.vbaraw = getzipdata(zip,strip_front_slash(dir.vba[0]),true);\n\t\telse if(dir.defaults && dir.defaults.bin === CT_VBA) out.vbaraw = getzipdata(zip, 'xl/vbaProject.bin',true);\n\t}\n\treturn out;\n}\n\n/* [MS-OFFCRYPTO] 2.1.1 */\nfunction parse_xlsxcfb(cfb, _opts) {\n\tvar opts = _opts || {};\n\tvar f = 'Workbook', data = CFB.find(cfb, f);\n\ttry {\n\tf = '/!DataSpaces/Version';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\t/*var version = */parse_DataSpaceVersionInfo(data.content);\n\n\t/* 2.3.4.1 */\n\tf = '/!DataSpaces/DataSpaceMap';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\tvar dsm = parse_DataSpaceMap(data.content);\n\tif(dsm.length !== 1 || dsm[0].comps.length !== 1 || dsm[0].comps[0].t !== 0 || dsm[0].name !== \"StrongEncryptionDataSpace\" || dsm[0].comps[0].v !== \"EncryptedPackage\")\n\t\tthrow new Error(\"ECMA-376 Encrypted file bad \" + f);\n\n\t/* 2.3.4.2 */\n\tf = '/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\tvar seds = parse_DataSpaceDefinition(data.content);\n\tif(seds.length != 1 || seds[0] != \"StrongEncryptionTransform\")\n\t\tthrow new Error(\"ECMA-376 Encrypted file bad \" + f);\n\n\t/* 2.3.4.3 */\n\tf = '/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\t/*var hdr = */parse_Primary(data.content);\n\t} catch(e) {}\n\n\tf = '/EncryptionInfo';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\tvar einfo = parse_EncryptionInfo(data.content);\n\n\t/* 2.3.4.4 */\n\tf = '/EncryptedPackage';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\n/*global decrypt_agile */\nif(einfo[0] == 0x04 && typeof decrypt_agile !== 'undefined') return decrypt_agile(einfo[1], data.content, opts.password || \"\", opts);\n/*global decrypt_std76 */\nif(einfo[0] == 0x02 && typeof decrypt_std76 !== 'undefined') return decrypt_std76(einfo[1], data.content, opts.password || \"\", opts);\n\tthrow new Error(\"File is password-protected\");\n}\n\nfunction write_zip(wb, opts) {\n\tif(opts.bookType == \"ods\") return write_ods(wb, opts);\n\tif(opts.bookType == \"numbers\") return write_numbers_iwa(wb, opts);\n\tif(opts.bookType == \"xlsb\") return write_zip_xlsxb(wb, opts);\n\treturn write_zip_xlsx(wb, opts);\n}\n\n/* XLSX and XLSB writing are very similar.  Originally they were unified in one\n   export function.  This is horrible for tree shaking in the common case (most\n   applications need to export files in one format) so this function supports\n   both formats while write_zip_xlsx only handles XLSX */\nfunction write_zip_xlsxb(wb, opts) {\n\t_shapeid = 1024;\n\tif(wb && !wb.SSF) {\n\t\twb.SSF = dup(table_fmt);\n\t}\n\tif(wb && wb.SSF) {\n\t\tmake_ssf(); SSF_load_table(wb.SSF);\n\t\t// $FlowIgnore\n\t\topts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\n\t\topts.ssf = wb.SSF;\n\t}\n\topts.rels = {}; opts.wbrels = {};\n\topts.Strings = []; opts.Strings.Count = 0; opts.Strings.Unique = 0;\n\tif(browser_has_Map) opts.revStrings = new Map();\n\telse { opts.revStrings = {}; opts.revStrings.foo = []; delete opts.revStrings.foo; }\n\tvar wbext = opts.bookType == \"xlsb\" ? \"bin\" : \"xml\";\n\tvar vbafmt = VBAFMTS.indexOf(opts.bookType) > -1;\n\tvar ct = new_ct();\n\tfix_write_opts(opts = opts || {});\n\tvar zip = zip_new();\n\tvar f = \"\", rId = 0;\n\n\topts.cellXfs = [];\n\tget_cell_style(opts.cellXfs, {}, {revssf:{\"General\":0}});\n\n\tif(!wb.Props) wb.Props = {};\n\n\tf = \"docProps/core.xml\";\n\tzip_add_file(zip, f, write_core_props(wb.Props, opts));\n\tct.coreprops.push(f);\n\tadd_rels(opts.rels, 2, f, RELS.CORE_PROPS);\n\nf = \"docProps/app.xml\";\n\tif(wb.Props && wb.Props.SheetNames){/* empty */}\n\telse if(!wb.Workbook || !wb.Workbook.Sheets) wb.Props.SheetNames = wb.SheetNames;\n\telse {\n\t\tvar _sn = [];\n\t\tfor(var _i = 0; _i < wb.SheetNames.length; ++_i)\n\t\t\tif((wb.Workbook.Sheets[_i]||{}).Hidden != 2) _sn.push(wb.SheetNames[_i]);\n\t\twb.Props.SheetNames = _sn;\n\t}\n\twb.Props.Worksheets = wb.Props.SheetNames.length;\n\tzip_add_file(zip, f, write_ext_props(wb.Props, opts));\n\tct.extprops.push(f);\n\tadd_rels(opts.rels, 3, f, RELS.EXT_PROPS);\n\n\tif(wb.Custprops !== wb.Props && keys(wb.Custprops||{}).length > 0) {\n\t\tf = \"docProps/custom.xml\";\n\t\tzip_add_file(zip, f, write_cust_props(wb.Custprops, opts));\n\t\tct.custprops.push(f);\n\t\tadd_rels(opts.rels, 4, f, RELS.CUST_PROPS);\n\t}\n\n\tfor(rId=1;rId <= wb.SheetNames.length; ++rId) {\n\t\tvar wsrels = {'!id':{}};\n\t\tvar ws = wb.Sheets[wb.SheetNames[rId-1]];\n\t\tvar _type = (ws || {})[\"!type\"] || \"sheet\";\n\t\tswitch(_type) {\n\t\tcase \"chart\":\n\t\t\t/* falls through */\n\t\tdefault:\n\t\t\tf = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\n\t\t\tzip_add_file(zip, f, write_ws(rId-1, f, opts, wb, wsrels));\n\t\t\tct.sheets.push(f);\n\t\t\tadd_rels(opts.wbrels, -1, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS[0]);\n\t\t}\n\n\t\tif(ws) {\n\t\t\tvar comments = ws['!comments'];\n\t\t\tvar need_vml = false;\n\t\t\tvar cf = \"\";\n\t\t\tif(comments && comments.length > 0) {\n\t\t\t\tcf = \"xl/comments\" + rId + \".\" + wbext;\n\t\t\t\tzip_add_file(zip, cf, write_cmnt(comments, cf, opts));\n\t\t\t\tct.comments.push(cf);\n\t\t\t\tadd_rels(wsrels, -1, \"../comments\" + rId + \".\" + wbext, RELS.CMNT);\n\t\t\t\tneed_vml = true;\n\t\t\t}\n\t\t\tif(ws['!legacy']) {\n\t\t\t\tif(need_vml) zip_add_file(zip, \"xl/drawings/vmlDrawing\" + (rId) + \".vml\", write_comments_vml(rId, ws['!comments']));\n\t\t\t}\n\t\t\tdelete ws['!comments'];\n\t\t\tdelete ws['!legacy'];\n\t\t}\n\n\t\tif(wsrels['!id'].rId1) zip_add_file(zip, get_rels_path(f), write_rels(wsrels));\n\t}\n\n\tif(opts.Strings != null && opts.Strings.length > 0) {\n\t\tf = \"xl/sharedStrings.\" + wbext;\n\t\tzip_add_file(zip, f, write_sst(opts.Strings, f, opts));\n\t\tct.strs.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"sharedStrings.\" + wbext, RELS.SST);\n\t}\n\n\tf = \"xl/workbook.\" + wbext;\n\tzip_add_file(zip, f, write_wb(wb, f, opts));\n\tct.workbooks.push(f);\n\tadd_rels(opts.rels, 1, f, RELS.WB);\n\n\t/* TODO: something more intelligent with themes */\n\n\tf = \"xl/theme/theme1.xml\";\n\tzip_add_file(zip, f, write_theme(wb.Themes, opts));\n\tct.themes.push(f);\n\tadd_rels(opts.wbrels, -1, \"theme/theme1.xml\", RELS.THEME);\n\n\t/* TODO: something more intelligent with styles */\n\n\tf = \"xl/styles.\" + wbext;\n\tzip_add_file(zip, f, write_sty(wb, f, opts));\n\tct.styles.push(f);\n\tadd_rels(opts.wbrels, -1, \"styles.\" + wbext, RELS.STY);\n\n\tif(wb.vbaraw && vbafmt) {\n\t\tf = \"xl/vbaProject.bin\";\n\t\tzip_add_file(zip, f, wb.vbaraw);\n\t\tct.vba.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"vbaProject.bin\", RELS.VBA);\n\t}\n\n\tf = \"xl/metadata.\" + wbext;\n\tzip_add_file(zip, f, write_xlmeta(f));\n\tct.metadata.push(f);\n\tadd_rels(opts.wbrels, -1, \"metadata.\" + wbext, RELS.XLMETA);\n\n\tzip_add_file(zip, \"[Content_Types].xml\", write_ct(ct, opts));\n\tzip_add_file(zip, '_rels/.rels', write_rels(opts.rels));\n\tzip_add_file(zip, 'xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\n\n\tdelete opts.revssf; delete opts.ssf;\n\treturn zip;\n}\n\nfunction write_zip_xlsx(wb, opts) {\n\t_shapeid = 1024;\n\tif(wb && !wb.SSF) {\n\t\twb.SSF = dup(table_fmt);\n\t}\n\tif(wb && wb.SSF) {\n\t\tmake_ssf(); SSF_load_table(wb.SSF);\n\t\t// $FlowIgnore\n\t\topts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\n\t\topts.ssf = wb.SSF;\n\t}\n\topts.rels = {}; opts.wbrels = {};\n\topts.Strings = []; opts.Strings.Count = 0; opts.Strings.Unique = 0;\n\tif(browser_has_Map) opts.revStrings = new Map();\n\telse { opts.revStrings = {}; opts.revStrings.foo = []; delete opts.revStrings.foo; }\n\tvar wbext = \"xml\";\n\tvar vbafmt = VBAFMTS.indexOf(opts.bookType) > -1;\n\tvar ct = new_ct();\n\tfix_write_opts(opts = opts || {});\n\tvar zip = zip_new();\n\tvar f = \"\", rId = 0;\n\n\topts.cellXfs = [];\n\tget_cell_style(opts.cellXfs, {}, {revssf:{\"General\":0}});\n\n\tif(!wb.Props) wb.Props = {};\n\n\tf = \"docProps/core.xml\";\n\tzip_add_file(zip, f, write_core_props(wb.Props, opts));\n\tct.coreprops.push(f);\n\tadd_rels(opts.rels, 2, f, RELS.CORE_PROPS);\n\nf = \"docProps/app.xml\";\n\tif(wb.Props && wb.Props.SheetNames){/* empty */}\n\telse if(!wb.Workbook || !wb.Workbook.Sheets) wb.Props.SheetNames = wb.SheetNames;\n\telse {\n\t\tvar _sn = [];\n\t\tfor(var _i = 0; _i < wb.SheetNames.length; ++_i)\n\t\t\tif((wb.Workbook.Sheets[_i]||{}).Hidden != 2) _sn.push(wb.SheetNames[_i]);\n\t\twb.Props.SheetNames = _sn;\n\t}\n\twb.Props.Worksheets = wb.Props.SheetNames.length;\n\tzip_add_file(zip, f, write_ext_props(wb.Props, opts));\n\tct.extprops.push(f);\n\tadd_rels(opts.rels, 3, f, RELS.EXT_PROPS);\n\n\tif(wb.Custprops !== wb.Props && keys(wb.Custprops||{}).length > 0) {\n\t\tf = \"docProps/custom.xml\";\n\t\tzip_add_file(zip, f, write_cust_props(wb.Custprops, opts));\n\t\tct.custprops.push(f);\n\t\tadd_rels(opts.rels, 4, f, RELS.CUST_PROPS);\n\t}\n\n\tvar people = [\"SheetJ5\"];\n\topts.tcid = 0;\n\n\tfor(rId=1;rId <= wb.SheetNames.length; ++rId) {\n\t\tvar wsrels = {'!id':{}};\n\t\tvar ws = wb.Sheets[wb.SheetNames[rId-1]];\n\t\tvar _type = (ws || {})[\"!type\"] || \"sheet\";\n\t\tswitch(_type) {\n\t\tcase \"chart\":\n\t\t\t/* falls through */\n\t\tdefault:\n\t\t\tf = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\n\t\t\tzip_add_file(zip, f, write_ws_xml(rId-1, opts, wb, wsrels));\n\t\t\tct.sheets.push(f);\n\t\t\tadd_rels(opts.wbrels, -1, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS[0]);\n\t\t}\n\n\t\tif(ws) {\n\t\t\tvar comments = ws['!comments'];\n\t\t\tvar need_vml = false;\n\t\t\tvar cf = \"\";\n\t\t\tif(comments && comments.length > 0) {\n\t\t\t\tvar needtc = false;\n\t\t\t\tcomments.forEach(function(carr) {\n\t\t\t\t\tcarr[1].forEach(function(c) { if(c.T == true) needtc = true; });\n\t\t\t\t});\n\t\t\t\tif(needtc) {\n\t\t\t\t\tcf = \"xl/threadedComments/threadedComment\" + rId + \".\" + wbext;\n\t\t\t\t\tzip_add_file(zip, cf, write_tcmnt_xml(comments, people, opts));\n\t\t\t\t\tct.threadedcomments.push(cf);\n\t\t\t\t\tadd_rels(wsrels, -1, \"../threadedComments/threadedComment\" + rId + \".\" + wbext, RELS.TCMNT);\n\t\t\t\t}\n\n\t\t\t\tcf = \"xl/comments\" + rId + \".\" + wbext;\n\t\t\t\tzip_add_file(zip, cf, write_comments_xml(comments, opts));\n\t\t\t\tct.comments.push(cf);\n\t\t\t\tadd_rels(wsrels, -1, \"../comments\" + rId + \".\" + wbext, RELS.CMNT);\n\t\t\t\tneed_vml = true;\n\t\t\t}\n\t\t\tif(ws['!legacy']) {\n\t\t\t\tif(need_vml) zip_add_file(zip, \"xl/drawings/vmlDrawing\" + (rId) + \".vml\", write_comments_vml(rId, ws['!comments']));\n\t\t\t}\n\t\t\tdelete ws['!comments'];\n\t\t\tdelete ws['!legacy'];\n\t\t}\n\n\t\tif(wsrels['!id'].rId1) zip_add_file(zip, get_rels_path(f), write_rels(wsrels));\n\t}\n\n\tif(opts.Strings != null && opts.Strings.length > 0) {\n\t\tf = \"xl/sharedStrings.\" + wbext;\n\t\tzip_add_file(zip, f, write_sst_xml(opts.Strings, opts));\n\t\tct.strs.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"sharedStrings.\" + wbext, RELS.SST);\n\t}\n\n\tf = \"xl/workbook.\" + wbext;\n\tzip_add_file(zip, f, write_wb_xml(wb, opts));\n\tct.workbooks.push(f);\n\tadd_rels(opts.rels, 1, f, RELS.WB);\n\n\t/* TODO: something more intelligent with themes */\n\n\tf = \"xl/theme/theme1.xml\";\n\tzip_add_file(zip, f, write_theme(wb.Themes, opts));\n\tct.themes.push(f);\n\tadd_rels(opts.wbrels, -1, \"theme/theme1.xml\", RELS.THEME);\n\n\t/* TODO: something more intelligent with styles */\n\n\tf = \"xl/styles.\" + wbext;\n\tzip_add_file(zip, f, write_sty_xml(wb, opts));\n\tct.styles.push(f);\n\tadd_rels(opts.wbrels, -1, \"styles.\" + wbext, RELS.STY);\n\n\tif(wb.vbaraw && vbafmt) {\n\t\tf = \"xl/vbaProject.bin\";\n\t\tzip_add_file(zip, f, wb.vbaraw);\n\t\tct.vba.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"vbaProject.bin\", RELS.VBA);\n\t}\n\n\tf = \"xl/metadata.\" + wbext;\n\tzip_add_file(zip, f, write_xlmeta_xml());\n\tct.metadata.push(f);\n\tadd_rels(opts.wbrels, -1, \"metadata.\" + wbext, RELS.XLMETA);\n\n\tif(people.length > 1) {\n\t\tf = \"xl/persons/person.xml\";\n\t\tzip_add_file(zip, f, write_people_xml(people, opts));\n\t\tct.people.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"persons/person.xml\", RELS.PEOPLE);\n\t}\n\n\tzip_add_file(zip, \"[Content_Types].xml\", write_ct(ct, opts));\n\tzip_add_file(zip, '_rels/.rels', write_rels(opts.rels));\n\tzip_add_file(zip, 'xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\n\n\tdelete opts.revssf; delete opts.ssf;\n\treturn zip;\n}\n\nfunction firstbyte(f,o) {\n\tvar x = \"\";\n\tswitch((o||{}).type || \"base64\") {\n\t\tcase 'buffer': return [f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7]];\n\t\tcase 'base64': x = Base64_decode(f.slice(0,12)); break;\n\t\tcase 'binary': x = f; break;\n\t\tcase 'array':  return [f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7]];\n\t\tdefault: throw new Error(\"Unrecognized type \" + (o && o.type || \"undefined\"));\n\t}\n\treturn [x.charCodeAt(0), x.charCodeAt(1), x.charCodeAt(2), x.charCodeAt(3), x.charCodeAt(4), x.charCodeAt(5), x.charCodeAt(6), x.charCodeAt(7)];\n}\n\nfunction read_cfb(cfb, opts) {\n\tif(CFB.find(cfb, \"EncryptedPackage\")) return parse_xlsxcfb(cfb, opts);\n\treturn parse_xlscfb(cfb, opts);\n}\n\nfunction read_zip(data, opts) {\n\tvar zip, d = data;\n\tvar o = opts||{};\n\tif(!o.type) o.type = (has_buf && Buffer.isBuffer(data)) ? \"buffer\" : \"base64\";\n\tzip = zip_read(d, o);\n\treturn parse_zip(zip, o);\n}\n\nfunction read_plaintext(data, o) {\n\tvar i = 0;\n\tmain: while(i < data.length) switch(data.charCodeAt(i)) {\n\t\tcase 0x0A: case 0x0D: case 0x20: ++i; break;\n\t\tcase 0x3C: return parse_xlml(data.slice(i),o);\n\t\tdefault: break main;\n\t}\n\treturn PRN.to_workbook(data, o);\n}\n\nfunction read_plaintext_raw(data, o) {\n\tvar str = \"\", bytes = firstbyte(data, o);\n\tswitch(o.type) {\n\t\tcase 'base64': str = Base64_decode(data); break;\n\t\tcase 'binary': str = data; break;\n\t\tcase 'buffer': str = data.toString('binary'); break;\n\t\tcase 'array': str = cc2str(data); break;\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\n\t}\n\tif(bytes[0] == 0xEF && bytes[1] == 0xBB && bytes[2] == 0xBF) str = utf8read(str);\n\to.type = \"binary\";\n\treturn read_plaintext(str, o);\n}\n\nfunction read_utf16(data, o) {\n\tvar d = data;\n\tif(o.type == 'base64') d = Base64_decode(d);\n\td = $cptable.utils.decode(1200, d.slice(2), 'str');\n\to.type = \"binary\";\n\treturn read_plaintext(d, o);\n}\n\nfunction bstrify(data) {\n\treturn !data.match(/[^\\x00-\\x7F]/) ? data : utf8write(data);\n}\n\nfunction read_prn(data, d, o, str) {\n\tif(str) { o.type = \"string\"; return PRN.to_workbook(data, o); }\n\treturn PRN.to_workbook(d, o);\n}\n\nfunction readSync(data, opts) {\n\treset_cp();\n\tvar o = opts||{};\n\tif(typeof ArrayBuffer !== 'undefined' && data instanceof ArrayBuffer) return readSync(new Uint8Array(data), (o = dup(o), o.type = \"array\", o));\n\tif(typeof Uint8Array !== 'undefined' && data instanceof Uint8Array && !o.type) o.type = typeof Deno !== \"undefined\" ? \"buffer\" : \"array\";\n\tvar d = data, n = [0,0,0,0], str = false;\n\tif(o.cellStyles) { o.cellNF = true; o.sheetStubs = true; }\n\t_ssfopts = {};\n\tif(o.dateNF) _ssfopts.dateNF = o.dateNF;\n\tif(!o.type) o.type = (has_buf && Buffer.isBuffer(data)) ? \"buffer\" : \"base64\";\n\tif(o.type == \"file\") { o.type = has_buf ? \"buffer\" : \"binary\"; d = read_binary(data); if(typeof Uint8Array !== 'undefined' && !has_buf) o.type = \"array\"; }\n\tif(o.type == \"string\") { str = true; o.type = \"binary\"; o.codepage = 65001; d = bstrify(data); }\n\tif(o.type == 'array' && typeof Uint8Array !== 'undefined' && data instanceof Uint8Array && typeof ArrayBuffer !== 'undefined') {\n\t\t// $FlowIgnore\n\t\tvar ab=new ArrayBuffer(3), vu=new Uint8Array(ab); vu.foo=\"bar\";\n\t\t// $FlowIgnore\n\t\tif(!vu.foo) {o=dup(o); o.type='array'; return readSync(ab2a(d), o);}\n\t}\n\tswitch((n = firstbyte(d, o))[0]) {\n\t\tcase 0xD0: if(n[1] === 0xCF && n[2] === 0x11 && n[3] === 0xE0 && n[4] === 0xA1 && n[5] === 0xB1 && n[6] === 0x1A && n[7] === 0xE1) return read_cfb(CFB.read(d, o), o); break;\n\t\tcase 0x09: if(n[1] <= 0x08) return parse_xlscfb(d, o); break;\n\t\tcase 0x3C: return parse_xlml(d, o);\n\t\tcase 0x49:\n\t\t\tif(n[1] === 0x49 && n[2] === 0x2a && n[3] === 0x00) throw new Error(\"TIFF Image File is not a spreadsheet\");\n\t\t\tif(n[1] === 0x44) return read_wb_ID(d, o);\n\t\t\tbreak;\n\t\tcase 0x54: if(n[1] === 0x41 && n[2] === 0x42 && n[3] === 0x4C) return DIF.to_workbook(d, o); break;\n\t\tcase 0x50: return (n[1] === 0x4B && n[2] < 0x09 && n[3] < 0x09) ? read_zip(d, o) : read_prn(data, d, o, str);\n\t\tcase 0xEF: return n[3] === 0x3C ? parse_xlml(d, o) : read_prn(data, d, o, str);\n\t\tcase 0xFF:\n\t\t\tif(n[1] === 0xFE) { return read_utf16(d, o); }\n\t\t\telse if(n[1] === 0x00 && n[2] === 0x02 && n[3] === 0x00) return WK_.to_workbook(d, o);\n\t\t\tbreak;\n\t\tcase 0x00:\n\t\t\tif(n[1] === 0x00) {\n\t\t\t\tif(n[2] >= 0x02 && n[3] === 0x00) return WK_.to_workbook(d, o);\n\t\t\t\tif(n[2] === 0x00 && (n[3] === 0x08 || n[3] === 0x09)) return WK_.to_workbook(d, o);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 0x03: case 0x83: case 0x8B: case 0x8C: return DBF.to_workbook(d, o);\n\t\tcase 0x7B: if(n[1] === 0x5C && n[2] === 0x72 && n[3] === 0x74) return RTF.to_workbook(d, o); break;\n\t\tcase 0x0A: case 0x0D: case 0x20: return read_plaintext_raw(d, o);\n\t\tcase 0x89: if(n[1] === 0x50 && n[2] === 0x4E && n[3] === 0x47) throw new Error(\"PNG Image File is not a spreadsheet\"); break;\n\t}\n\tif(DBF_SUPPORTED_VERSIONS.indexOf(n[0]) > -1 && n[2] <= 12 && n[3] <= 31) return DBF.to_workbook(d, o);\n\treturn read_prn(data, d, o, str);\n}\n\nfunction readFileSync(filename, opts) {\n\tvar o = opts||{}; o.type = 'file';\n\treturn readSync(filename, o);\n}\nfunction write_cfb_ctr(cfb, o) {\n\tswitch(o.type) {\n\t\tcase \"base64\": case \"binary\": break;\n\t\tcase \"buffer\": case \"array\": o.type = \"\"; break;\n\t\tcase \"file\": return write_dl(o.file, CFB.write(cfb, {type:has_buf ? 'buffer' : \"\"}));\n\t\tcase \"string\": throw new Error(\"'string' output type invalid for '\" + o.bookType + \"' files\");\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\n\t}\n\treturn CFB.write(cfb, o);\n}\n\nfunction write_zip_type(wb, opts) {\n\tvar o = dup(opts||{});\n\tvar z = write_zip(wb, o);\n\treturn write_zip_denouement(z, o);\n}\nfunction write_zip_typeXLSX(wb, opts) {\n\tvar o = dup(opts||{});\n\tvar z = write_zip_xlsx(wb, o);\n\treturn write_zip_denouement(z, o);\n}\nfunction write_zip_denouement(z, o) {\n\tvar oopts = {};\n\tvar ftype = has_buf ? \"nodebuffer\" : (typeof Uint8Array !== \"undefined\" ? \"array\" : \"string\");\n\tif(o.compression) oopts.compression = 'DEFLATE';\n\tif(o.password) oopts.type = ftype;\n\telse switch(o.type) {\n\t\tcase \"base64\": oopts.type = \"base64\"; break;\n\t\tcase \"binary\": oopts.type = \"string\"; break;\n\t\tcase \"string\": throw new Error(\"'string' output type invalid for '\" + o.bookType + \"' files\");\n\t\tcase \"buffer\":\n\t\tcase \"file\": oopts.type = ftype; break;\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\n\t}\n\tvar out = z.FullPaths ? CFB.write(z, {fileType:\"zip\", type: {\"nodebuffer\": \"buffer\", \"string\": \"binary\"}[oopts.type] || oopts.type, compression: !!o.compression}) : z.generate(oopts);\n\tif(typeof Deno !== \"undefined\") {\n\t\tif(typeof out == \"string\") {\n\t\t\tif(o.type == \"binary\" || o.type == \"base64\") return out;\n\t\t\tout = new Uint8Array(s2ab(out));\n\t\t}\n\t}\n/*jshint -W083 */\n\tif(o.password && typeof encrypt_agile !== 'undefined') return write_cfb_ctr(encrypt_agile(out, o.password), o); // eslint-disable-line no-undef\n/*jshint +W083 */\n\tif(o.type === \"file\") return write_dl(o.file, out);\n\treturn o.type == \"string\" ? utf8read(out) : out;\n}\n\nfunction write_cfb_type(wb, opts) {\n\tvar o = opts||{};\n\tvar cfb = write_xlscfb(wb, o);\n\treturn write_cfb_ctr(cfb, o);\n}\n\nfunction write_string_type(out, opts, bom) {\n\tif(!bom) bom = \"\";\n\tvar o = bom + out;\n\tswitch(opts.type) {\n\t\tcase \"base64\": return Base64_encode(utf8write(o));\n\t\tcase \"binary\": return utf8write(o);\n\t\tcase \"string\": return out;\n\t\tcase \"file\": return write_dl(opts.file, o, 'utf8');\n\t\tcase \"buffer\": {\n\t\t\tif(has_buf) return Buffer_from(o, 'utf8');\n\t\t\telse if(typeof TextEncoder !== \"undefined\") return new TextEncoder().encode(o);\n\t\t\telse return write_string_type(o, {type:'binary'}).split(\"\").map(function(c) { return c.charCodeAt(0); });\n\t\t}\n\t}\n\tthrow new Error(\"Unrecognized type \" + opts.type);\n}\n\nfunction write_stxt_type(out, opts) {\n\tswitch(opts.type) {\n\t\tcase \"base64\": return Base64_encode(out);\n\t\tcase \"binary\": return out;\n\t\tcase \"string\": return out; /* override in sheet_to_txt */\n\t\tcase \"file\": return write_dl(opts.file, out, 'binary');\n\t\tcase \"buffer\": {\n\t\t\tif(has_buf) return Buffer_from(out, 'binary');\n\t\t\telse return out.split(\"\").map(function(c) { return c.charCodeAt(0); });\n\t\t}\n\t}\n\tthrow new Error(\"Unrecognized type \" + opts.type);\n}\n\n/* TODO: test consistency */\nfunction write_binary_type(out, opts) {\n\tswitch(opts.type) {\n\t\tcase \"string\":\n\t\tcase \"base64\":\n\t\tcase \"binary\":\n\t\t\tvar bstr = \"\";\n\t\t\t// $FlowIgnore\n\t\t\tfor(var i = 0; i < out.length; ++i) bstr += String.fromCharCode(out[i]);\n\t\t\treturn opts.type == 'base64' ? Base64_encode(bstr) : opts.type == 'string' ? utf8read(bstr) : bstr;\n\t\tcase \"file\": return write_dl(opts.file, out);\n\t\tcase \"buffer\": return out;\n\t\tdefault: throw new Error(\"Unrecognized type \" + opts.type);\n\t}\n}\n\nfunction writeSyncXLSX(wb, opts) {\n\treset_cp();\n\tcheck_wb(wb);\n\tvar o = dup(opts||{});\n\tif(o.cellStyles) { o.cellNF = true; o.sheetStubs = true; }\n\tif(o.type == \"array\") { o.type = \"binary\"; var out = (writeSyncXLSX(wb, o)); o.type = \"array\"; return s2ab(out); }\n\treturn write_zip_typeXLSX(wb, o);\n}\n\nfunction writeSync(wb, opts) {\n\treset_cp();\n\tcheck_wb(wb);\n\tvar o = dup(opts||{});\n\tif(o.cellStyles) { o.cellNF = true; o.sheetStubs = true; }\n\tif(o.type == \"array\") { o.type = \"binary\"; var out = (writeSync(wb, o)); o.type = \"array\"; return s2ab(out); }\n\tvar idx = 0;\n\tif(o.sheet) {\n\t\tif(typeof o.sheet == \"number\") idx = o.sheet;\n\t\telse idx = wb.SheetNames.indexOf(o.sheet);\n\t\tif(!wb.SheetNames[idx]) throw new Error(\"Sheet not found: \" + o.sheet + \" : \" + (typeof o.sheet));\n\t}\n\tswitch(o.bookType || 'xlsb') {\n\t\tcase 'xml':\n\t\tcase 'xlml': return write_string_type(write_xlml(wb, o), o);\n\t\tcase 'slk':\n\t\tcase 'sylk': return write_string_type(SYLK.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'htm':\n\t\tcase 'html': return write_string_type(sheet_to_html(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'txt': return write_stxt_type(sheet_to_txt(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'csv': return write_string_type(sheet_to_csv(wb.Sheets[wb.SheetNames[idx]], o), o, \"\\ufeff\");\n\t\tcase 'dif': return write_string_type(DIF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'dbf': return write_binary_type(DBF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'prn': return write_string_type(PRN.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'rtf': return write_string_type(RTF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'eth': return write_string_type(ETH.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'fods': return write_string_type(write_ods(wb, o), o);\n\t\tcase 'wk1': return write_binary_type(WK_.sheet_to_wk1(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'wk3': return write_binary_type(WK_.book_to_wk3(wb, o), o);\n\t\tcase 'biff2': if(!o.biff) o.biff = 2; /* falls through */\n\t\tcase 'biff3': if(!o.biff) o.biff = 3; /* falls through */\n\t\tcase 'biff4': if(!o.biff) o.biff = 4; return write_binary_type(write_biff_buf(wb, o), o);\n\t\tcase 'biff5': if(!o.biff) o.biff = 5; /* falls through */\n\t\tcase 'biff8':\n\t\tcase 'xla':\n\t\tcase 'xls': if(!o.biff) o.biff = 8; return write_cfb_type(wb, o);\n\t\tcase 'xlsx':\n\t\tcase 'xlsm':\n\t\tcase 'xlam':\n\t\tcase 'xlsb':\n\t\tcase 'numbers':\n\t\tcase 'ods': return write_zip_type(wb, o);\n\t\tdefault: throw new Error (\"Unrecognized bookType |\" + o.bookType + \"|\");\n\t}\n}\n\nfunction resolve_book_type(o) {\n\tif(o.bookType) return;\n\tvar _BT = {\n\t\t\"xls\": \"biff8\",\n\t\t\"htm\": \"html\",\n\t\t\"slk\": \"sylk\",\n\t\t\"socialcalc\": \"eth\",\n\t\t\"Sh33tJS\": \"WTF\"\n\t};\n\tvar ext = o.file.slice(o.file.lastIndexOf(\".\")).toLowerCase();\n\tif(ext.match(/^\\.[a-z]+$/)) o.bookType = ext.slice(1);\n\to.bookType = _BT[o.bookType] || o.bookType;\n}\n\nfunction writeFileSync(wb, filename, opts) {\n\tvar o = opts||{}; o.type = 'file';\n\to.file = filename;\n\tresolve_book_type(o);\n\treturn writeSync(wb, o);\n}\n\nfunction writeFileSyncXLSX(wb, filename, opts) {\n\tvar o = opts||{}; o.type = 'file';\n\to.file = filename;\n\tresolve_book_type(o);\n\treturn writeSyncXLSX(wb, o);\n}\n\n\nfunction writeFileAsync(filename, wb, opts, cb) {\n\tvar o = opts||{}; o.type = 'file';\n\to.file = filename;\n\tresolve_book_type(o);\n\to.type = 'buffer';\n\tvar _cb = cb; if(!(_cb instanceof Function)) _cb = (opts);\n\treturn _fs.writeFile(filename, writeSync(wb, o), _cb);\n}\nfunction make_json_row(sheet, r, R, cols, header, hdr, dense, o) {\n\tvar rr = encode_row(R);\n\tvar defval = o.defval, raw = o.raw || !Object.prototype.hasOwnProperty.call(o, \"raw\");\n\tvar isempty = true;\n\tvar row = (header === 1) ? [] : {};\n\tif(header !== 1) {\n\t\tif(Object.defineProperty) try { Object.defineProperty(row, '__rowNum__', {value:R, enumerable:false}); } catch(e) { row.__rowNum__ = R; }\n\t\telse row.__rowNum__ = R;\n\t}\n\tif(!dense || sheet[R]) for (var C = r.s.c; C <= r.e.c; ++C) {\n\t\tvar val = dense ? sheet[R][C] : sheet[cols[C] + rr];\n\t\tif(val === undefined || val.t === undefined) {\n\t\t\tif(defval === undefined) continue;\n\t\t\tif(hdr[C] != null) { row[hdr[C]] = defval; }\n\t\t\tcontinue;\n\t\t}\n\t\tvar v = val.v;\n\t\tswitch(val.t){\n\t\t\tcase 'z': if(v == null) break; continue;\n\t\t\tcase 'e': v = (v == 0 ? null : void 0); break;\n\t\t\tcase 's': case 'd': case 'b': case 'n': break;\n\t\t\tdefault: throw new Error('unrecognized type ' + val.t);\n\t\t}\n\t\tif(hdr[C] != null) {\n\t\t\tif(v == null) {\n\t\t\t\tif(val.t == \"e\" && v === null) row[hdr[C]] = null;\n\t\t\t\telse if(defval !== undefined) row[hdr[C]] = defval;\n\t\t\t\telse if(raw && v === null) row[hdr[C]] = null;\n\t\t\t\telse continue;\n\t\t\t} else {\n\t\t\t\trow[hdr[C]] = raw && (val.t !== \"n\" || (val.t === \"n\" && o.rawNumbers !== false)) ? v : format_cell(val,v,o);\n\t\t\t}\n\t\t\tif(v != null) isempty = false;\n\t\t}\n\t}\n\treturn { row: row, isempty: isempty };\n}\n\n\nfunction sheet_to_json(sheet, opts) {\n\tif(sheet == null || sheet[\"!ref\"] == null) return [];\n\tvar val = {t:'n',v:0}, header = 0, offset = 1, hdr = [], v=0, vv=\"\";\n\tvar r = {s:{r:0,c:0},e:{r:0,c:0}};\n\tvar o = opts || {};\n\tvar range = o.range != null ? o.range : sheet[\"!ref\"];\n\tif(o.header === 1) header = 1;\n\telse if(o.header === \"A\") header = 2;\n\telse if(Array.isArray(o.header)) header = 3;\n\telse if(o.header == null) header = 0;\n\tswitch(typeof range) {\n\t\tcase 'string': r = safe_decode_range(range); break;\n\t\tcase 'number': r = safe_decode_range(sheet[\"!ref\"]); r.s.r = range; break;\n\t\tdefault: r = range;\n\t}\n\tif(header > 0) offset = 0;\n\tvar rr = encode_row(r.s.r);\n\tvar cols = [];\n\tvar out = [];\n\tvar outi = 0, counter = 0;\n\tvar dense = Array.isArray(sheet);\n\tvar R = r.s.r, C = 0;\n\tvar header_cnt = {};\n\tif(dense && !sheet[R]) sheet[R] = [];\n\tvar colinfo = o.skipHidden && sheet[\"!cols\"] || [];\n\tvar rowinfo = o.skipHidden && sheet[\"!rows\"] || [];\n\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\tif(((colinfo[C]||{}).hidden)) continue;\n\t\tcols[C] = encode_col(C);\n\t\tval = dense ? sheet[R][C] : sheet[cols[C] + rr];\n\t\tswitch(header) {\n\t\t\tcase 1: hdr[C] = C - r.s.c; break;\n\t\t\tcase 2: hdr[C] = cols[C]; break;\n\t\t\tcase 3: hdr[C] = o.header[C - r.s.c]; break;\n\t\t\tdefault:\n\t\t\t\tif(val == null) val = {w: \"__EMPTY\", t: \"s\"};\n\t\t\t\tvv = v = format_cell(val, null, o);\n\t\t\t\tcounter = header_cnt[v] || 0;\n\t\t\t\tif(!counter) header_cnt[v] = 1;\n\t\t\t\telse {\n\t\t\t\t\tdo { vv = v + \"_\" + (counter++); } while(header_cnt[vv]); header_cnt[v] = counter;\n\t\t\t\t\theader_cnt[vv] = 1;\n\t\t\t\t}\n\t\t\t\thdr[C] = vv;\n\t\t}\n\t}\n\tfor (R = r.s.r + offset; R <= r.e.r; ++R) {\n\t\tif ((rowinfo[R]||{}).hidden) continue;\n\t\tvar row = make_json_row(sheet, r, R, cols, header, hdr, dense, o);\n\t\tif((row.isempty === false) || (header === 1 ? o.blankrows !== false : !!o.blankrows)) out[outi++] = row.row;\n\t}\n\tout.length = outi;\n\treturn out;\n}\n\nvar qreg = /\"/g;\nfunction make_csv_row(sheet, r, R, cols, fs, rs, FS, o) {\n\tvar isempty = true;\n\tvar row = [], txt = \"\", rr = encode_row(R);\n\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\tif (!cols[C]) continue;\n\t\tvar val = o.dense ? (sheet[R]||[])[C]: sheet[cols[C] + rr];\n\t\tif(val == null) txt = \"\";\n\t\telse if(val.v != null) {\n\t\t\tisempty = false;\n\t\t\ttxt = ''+(o.rawNumbers && val.t == \"n\" ? val.v : format_cell(val, null, o));\n\t\t\tfor(var i = 0, cc = 0; i !== txt.length; ++i) if((cc = txt.charCodeAt(i)) === fs || cc === rs || cc === 34 || o.forceQuotes) {txt = \"\\\"\" + txt.replace(qreg, '\"\"') + \"\\\"\"; break; }\n\t\t\tif(txt == \"ID\") txt = '\"ID\"';\n\t\t} else if(val.f != null && !val.F) {\n\t\t\tisempty = false;\n\t\t\ttxt = '=' + val.f; if(txt.indexOf(\",\") >= 0) txt = '\"' + txt.replace(qreg, '\"\"') + '\"';\n\t\t} else txt = \"\";\n\t\t/* NOTE: Excel CSV does not support array formulae */\n\t\trow.push(txt);\n\t}\n\tif(o.blankrows === false && isempty) return null;\n\treturn row.join(FS);\n}\n\nfunction sheet_to_csv(sheet, opts) {\n\tvar out = [];\n\tvar o = opts == null ? {} : opts;\n\tif(sheet == null || sheet[\"!ref\"] == null) return \"\";\n\tvar r = safe_decode_range(sheet[\"!ref\"]);\n\tvar FS = o.FS !== undefined ? o.FS : \",\", fs = FS.charCodeAt(0);\n\tvar RS = o.RS !== undefined ? o.RS : \"\\n\", rs = RS.charCodeAt(0);\n\tvar endregex = new RegExp((FS==\"|\" ? \"\\\\|\" : FS)+\"+$\");\n\tvar row = \"\", cols = [];\n\to.dense = Array.isArray(sheet);\n\tvar colinfo = o.skipHidden && sheet[\"!cols\"] || [];\n\tvar rowinfo = o.skipHidden && sheet[\"!rows\"] || [];\n\tfor(var C = r.s.c; C <= r.e.c; ++C) if (!((colinfo[C]||{}).hidden)) cols[C] = encode_col(C);\n\tvar w = 0;\n\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\tif ((rowinfo[R]||{}).hidden) continue;\n\t\trow = make_csv_row(sheet, r, R, cols, fs, rs, FS, o);\n\t\tif(row == null) { continue; }\n\t\tif(o.strip) row = row.replace(endregex,\"\");\n\t\tif(row || (o.blankrows !== false)) out.push((w++ ? RS : \"\") + row);\n\t}\n\tdelete o.dense;\n\treturn out.join(\"\");\n}\n\nfunction sheet_to_txt(sheet, opts) {\n\tif(!opts) opts = {}; opts.FS = \"\\t\"; opts.RS = \"\\n\";\n\tvar s = sheet_to_csv(sheet, opts);\n\tif(typeof $cptable == 'undefined' || opts.type == 'string') return s;\n\tvar o = $cptable.utils.encode(1200, s, 'str');\n\treturn String.fromCharCode(255) + String.fromCharCode(254) + o;\n}\n\nfunction sheet_to_formulae(sheet) {\n\tvar y = \"\", x, val=\"\";\n\tif(sheet == null || sheet[\"!ref\"] == null) return [];\n\tvar r = safe_decode_range(sheet['!ref']), rr = \"\", cols = [], C;\n\tvar cmds = [];\n\tvar dense = Array.isArray(sheet);\n\tfor(C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\n\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\trr = encode_row(R);\n\t\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\t\ty = cols[C] + rr;\n\t\t\tx = dense ? (sheet[R]||[])[C] : sheet[y];\n\t\t\tval = \"\";\n\t\t\tif(x === undefined) continue;\n\t\t\telse if(x.F != null) {\n\t\t\t\ty = x.F;\n\t\t\t\tif(!x.f) continue;\n\t\t\t\tval = x.f;\n\t\t\t\tif(y.indexOf(\":\") == -1) y = y + \":\" + y;\n\t\t\t}\n\t\t\tif(x.f != null) val = x.f;\n\t\t\telse if(x.t == 'z') continue;\n\t\t\telse if(x.t == 'n' && x.v != null) val = \"\" + x.v;\n\t\t\telse if(x.t == 'b') val = x.v ? \"TRUE\" : \"FALSE\";\n\t\t\telse if(x.w !== undefined) val = \"'\" + x.w;\n\t\t\telse if(x.v === undefined) continue;\n\t\t\telse if(x.t == 's') val = \"'\" + x.v;\n\t\t\telse val = \"\"+x.v;\n\t\t\tcmds[cmds.length] = y + \"=\" + val;\n\t\t}\n\t}\n\treturn cmds;\n}\n\nfunction sheet_add_json(_ws, js, opts) {\n\tvar o = opts || {};\n\tvar offset = +!o.skipHeader;\n\tvar ws = _ws || ({});\n\tvar _R = 0, _C = 0;\n\tif(ws && o.origin != null) {\n\t\tif(typeof o.origin == 'number') _R = o.origin;\n\t\telse {\n\t\t\tvar _origin = typeof o.origin == \"string\" ? decode_cell(o.origin) : o.origin;\n\t\t\t_R = _origin.r; _C = _origin.c;\n\t\t}\n\t}\n\tvar cell;\n\tvar range = ({s: {c:0, r:0}, e: {c:_C, r:_R + js.length - 1 + offset}});\n\tif(ws['!ref']) {\n\t\tvar _range = safe_decode_range(ws['!ref']);\n\t\trange.e.c = Math.max(range.e.c, _range.e.c);\n\t\trange.e.r = Math.max(range.e.r, _range.e.r);\n\t\tif(_R == -1) { _R = _range.e.r + 1; range.e.r = _R + js.length - 1 + offset; }\n\t} else {\n\t\tif(_R == -1) { _R = 0; range.e.r = js.length - 1 + offset; }\n\t}\n\tvar hdr = o.header || [], C = 0;\n\n\tjs.forEach(function (JS, R) {\n\t\tkeys(JS).forEach(function(k) {\n\t\t\tif((C=hdr.indexOf(k)) == -1) hdr[C=hdr.length] = k;\n\t\t\tvar v = JS[k];\n\t\t\tvar t = 'z';\n\t\t\tvar z = \"\";\n\t\t\tvar ref = encode_cell({c:_C + C,r:_R + R + offset});\n\t\t\tcell = ws_get_cell_stub(ws, ref);\n\t\t\tif(v && typeof v === 'object' && !(v instanceof Date)){\n\t\t\t\tws[ref] = v;\n\t\t\t} else {\n\t\t\t\tif(typeof v == 'number') t = 'n';\n\t\t\t\telse if(typeof v == 'boolean') t = 'b';\n\t\t\t\telse if(typeof v == 'string') t = 's';\n\t\t\t\telse if(v instanceof Date) {\n\t\t\t\t\tt = 'd';\n\t\t\t\t\tif(!o.cellDates) { t = 'n'; v = datenum(v); }\n\t\t\t\t\tz = (o.dateNF || table_fmt[14]);\n\t\t\t\t}\n\t\t\t\telse if(v === null && o.nullError) { t = 'e'; v = 0; }\n\t\t\t\tif(!cell) ws[ref] = cell = ({t:t, v:v});\n\t\t\t\telse {\n\t\t\t\t\tcell.t = t; cell.v = v;\n\t\t\t\t\tdelete cell.w; delete cell.R;\n\t\t\t\t\tif(z) cell.z = z;\n\t\t\t\t}\n\t\t\t\tif(z) cell.z = z;\n\t\t\t}\n\t\t});\n\t});\n\trange.e.c = Math.max(range.e.c, _C + hdr.length - 1);\n\tvar __R = encode_row(_R);\n\tif(offset) for(C = 0; C < hdr.length; ++C) ws[encode_col(C + _C) + __R] = {t:'s', v:hdr[C]};\n\tws['!ref'] = encode_range(range);\n\treturn ws;\n}\nfunction json_to_sheet(js, opts) { return sheet_add_json(null, js, opts); }\n\n/* get cell, creating a stub if necessary */\nfunction ws_get_cell_stub(ws, R, C) {\n\t/* A1 cell address */\n\tif(typeof R == \"string\") {\n\t\t/* dense */\n\t\tif(Array.isArray(ws)) {\n\t\t\tvar RC = decode_cell(R);\n\t\t\tif(!ws[RC.r]) ws[RC.r] = [];\n\t\t\treturn ws[RC.r][RC.c] || (ws[RC.r][RC.c] = {t:'z'});\n\t\t}\n\t\treturn ws[R] || (ws[R] = {t:'z'});\n\t}\n\t/* cell address object */\n\tif(typeof R != \"number\") return ws_get_cell_stub(ws, encode_cell(R));\n\t/* R and C are 0-based indices */\n\treturn ws_get_cell_stub(ws, encode_cell({r:R,c:C||0}));\n}\n\n/* find sheet index for given name / validate index */\nfunction wb_sheet_idx(wb, sh) {\n\tif(typeof sh == \"number\") {\n\t\tif(sh >= 0 && wb.SheetNames.length > sh) return sh;\n\t\tthrow new Error(\"Cannot find sheet # \" + sh);\n\t} else if(typeof sh == \"string\") {\n\t\tvar idx = wb.SheetNames.indexOf(sh);\n\t\tif(idx > -1) return idx;\n\t\tthrow new Error(\"Cannot find sheet name |\" + sh + \"|\");\n\t} else throw new Error(\"Cannot find sheet |\" + sh + \"|\");\n}\n\n/* simple blank workbook object */\nfunction book_new() {\n\treturn { SheetNames: [], Sheets: {} };\n}\n\n/* add a worksheet to the end of a given workbook */\nfunction book_append_sheet(wb, ws, name, roll) {\n\tvar i = 1;\n\tif(!name) for(; i <= 0xFFFF; ++i, name = undefined) if(wb.SheetNames.indexOf(name = \"Sheet\" + i) == -1) break;\n\tif(!name || wb.SheetNames.length >= 0xFFFF) throw new Error(\"Too many worksheets\");\n\tif(roll && wb.SheetNames.indexOf(name) >= 0) {\n\t\tvar m = name.match(/(^.*?)(\\d+)$/);\n\t\ti = m && +m[2] || 0;\n\t\tvar root = m && m[1] || name;\n\t\tfor(++i; i <= 0xFFFF; ++i) if(wb.SheetNames.indexOf(name = root + i) == -1) break;\n\t}\n\tcheck_ws_name(name);\n\tif(wb.SheetNames.indexOf(name) >= 0) throw new Error(\"Worksheet with name |\" + name + \"| already exists!\");\n\n\twb.SheetNames.push(name);\n\twb.Sheets[name] = ws;\n\treturn name;\n}\n\n/* set sheet visibility (visible/hidden/very hidden) */\nfunction book_set_sheet_visibility(wb, sh, vis) {\n\tif(!wb.Workbook) wb.Workbook = {};\n\tif(!wb.Workbook.Sheets) wb.Workbook.Sheets = [];\n\n\tvar idx = wb_sheet_idx(wb, sh);\n\t// $FlowIgnore\n\tif(!wb.Workbook.Sheets[idx]) wb.Workbook.Sheets[idx] = {};\n\n\tswitch(vis) {\n\t\tcase 0: case 1: case 2: break;\n\t\tdefault: throw new Error(\"Bad sheet visibility setting \" + vis);\n\t}\n\t// $FlowIgnore\n\twb.Workbook.Sheets[idx].Hidden = vis;\n}\n\n/* set number format */\nfunction cell_set_number_format(cell, fmt) {\n\tcell.z = fmt;\n\treturn cell;\n}\n\n/* set cell hyperlink */\nfunction cell_set_hyperlink(cell, target, tooltip) {\n\tif(!target) {\n\t\tdelete cell.l;\n\t} else {\n\t\tcell.l = ({ Target: target });\n\t\tif(tooltip) cell.l.Tooltip = tooltip;\n\t}\n\treturn cell;\n}\nfunction cell_set_internal_link(cell, range, tooltip) { return cell_set_hyperlink(cell, \"#\" + range, tooltip); }\n\n/* add to cell comments */\nfunction cell_add_comment(cell, text, author) {\n\tif(!cell.c) cell.c = [];\n\tcell.c.push({t:text, a:author||\"SheetJS\"});\n}\n\n/* set array formula and flush related cells */\nfunction sheet_set_array_formula(ws, range, formula, dynamic) {\n\tvar rng = typeof range != \"string\" ? range : safe_decode_range(range);\n\tvar rngstr = typeof range == \"string\" ? range : encode_range(range);\n\tfor(var R = rng.s.r; R <= rng.e.r; ++R) for(var C = rng.s.c; C <= rng.e.c; ++C) {\n\t\tvar cell = ws_get_cell_stub(ws, R, C);\n\t\tcell.t = 'n';\n\t\tcell.F = rngstr;\n\t\tdelete cell.v;\n\t\tif(R == rng.s.r && C == rng.s.c) {\n\t\t\tcell.f = formula;\n\t\t\tif(dynamic) cell.D = true;\n\t\t}\n\t}\n\treturn ws;\n}\n\nvar utils = {\n\tencode_col: encode_col,\n\tencode_row: encode_row,\n\tencode_cell: encode_cell,\n\tencode_range: encode_range,\n\tdecode_col: decode_col,\n\tdecode_row: decode_row,\n\tsplit_cell: split_cell,\n\tdecode_cell: decode_cell,\n\tdecode_range: decode_range,\n\tformat_cell: format_cell,\n\tsheet_add_aoa: sheet_add_aoa,\n\tsheet_add_json: sheet_add_json,\n\tsheet_add_dom: sheet_add_dom,\n\taoa_to_sheet: aoa_to_sheet,\n\tjson_to_sheet: json_to_sheet,\n\ttable_to_sheet: parse_dom_table,\n\ttable_to_book: table_to_book,\n\tsheet_to_csv: sheet_to_csv,\n\tsheet_to_txt: sheet_to_txt,\n\tsheet_to_json: sheet_to_json,\n\tsheet_to_html: sheet_to_html,\n\tsheet_to_formulae: sheet_to_formulae,\n\tsheet_to_row_object_array: sheet_to_json,\n\tsheet_get_cell: ws_get_cell_stub,\n\tbook_new: book_new,\n\tbook_append_sheet: book_append_sheet,\n\tbook_set_sheet_visibility: book_set_sheet_visibility,\n\tcell_set_number_format: cell_set_number_format,\n\tcell_set_hyperlink: cell_set_hyperlink,\n\tcell_set_internal_link: cell_set_internal_link,\n\tcell_add_comment: cell_add_comment,\n\tsheet_set_array_formula: sheet_set_array_formula,\n\tconsts: {\n\t\tSHEET_VISIBLE: 0,\n\t\tSHEET_HIDDEN: 1,\n\t\tSHEET_VERY_HIDDEN: 2\n\t}\n};\n\nvar _Readable;\nfunction set_readable(R) { _Readable = R; }\n\nfunction write_csv_stream(sheet, opts) {\n\tvar stream = _Readable();\n\tvar o = opts == null ? {} : opts;\n\tif(sheet == null || sheet[\"!ref\"] == null) { stream.push(null); return stream; }\n\tvar r = safe_decode_range(sheet[\"!ref\"]);\n\tvar FS = o.FS !== undefined ? o.FS : \",\", fs = FS.charCodeAt(0);\n\tvar RS = o.RS !== undefined ? o.RS : \"\\n\", rs = RS.charCodeAt(0);\n\tvar endregex = new RegExp((FS==\"|\" ? \"\\\\|\" : FS)+\"+$\");\n\tvar row = \"\", cols = [];\n\to.dense = Array.isArray(sheet);\n\tvar colinfo = o.skipHidden && sheet[\"!cols\"] || [];\n\tvar rowinfo = o.skipHidden && sheet[\"!rows\"] || [];\n\tfor(var C = r.s.c; C <= r.e.c; ++C) if (!((colinfo[C]||{}).hidden)) cols[C] = encode_col(C);\n\tvar R = r.s.r;\n\tvar BOM = false, w = 0;\n\tstream._read = function() {\n\t\tif(!BOM) { BOM = true; return stream.push(\"\\uFEFF\"); }\n\t\twhile(R <= r.e.r) {\n\t\t\t++R;\n\t\t\tif ((rowinfo[R-1]||{}).hidden) continue;\n\t\t\trow = make_csv_row(sheet, r, R-1, cols, fs, rs, FS, o);\n\t\t\tif(row != null) {\n\t\t\t\tif(o.strip) row = row.replace(endregex,\"\");\n\t\t\t\tif(row || (o.blankrows !== false)) return stream.push((w++ ? RS : \"\") + row);\n\t\t\t}\n\t\t}\n\t\treturn stream.push(null);\n\t};\n\treturn stream;\n}\n\nfunction write_html_stream(ws, opts) {\n\tvar stream = _Readable();\n\n\tvar o = opts || {};\n\tvar header = o.header != null ? o.header : HTML_BEGIN;\n\tvar footer = o.footer != null ? o.footer : HTML_END;\n\tstream.push(header);\n\tvar r = decode_range(ws['!ref']);\n\to.dense = Array.isArray(ws);\n\tstream.push(make_html_preamble(ws, r, o));\n\tvar R = r.s.r;\n\tvar end = false;\n\tstream._read = function() {\n\t\tif(R > r.e.r) {\n\t\t\tif(!end) { end = true; stream.push(\"</table>\" + footer); }\n\t\t\treturn stream.push(null);\n\t\t}\n\t\twhile(R <= r.e.r) {\n\t\t\tstream.push(make_html_row(ws, r, R, o));\n\t\t\t++R;\n\t\t\tbreak;\n\t\t}\n\t};\n\treturn stream;\n}\n\nfunction write_json_stream(sheet, opts) {\n\tvar stream = _Readable({objectMode:true});\n\n\tif(sheet == null || sheet[\"!ref\"] == null) { stream.push(null); return stream; }\n\tvar val = {t:'n',v:0}, header = 0, offset = 1, hdr = [], v=0, vv=\"\";\n\tvar r = {s:{r:0,c:0},e:{r:0,c:0}};\n\tvar o = opts || {};\n\tvar range = o.range != null ? o.range : sheet[\"!ref\"];\n\tif(o.header === 1) header = 1;\n\telse if(o.header === \"A\") header = 2;\n\telse if(Array.isArray(o.header)) header = 3;\n\tswitch(typeof range) {\n\t\tcase 'string': r = safe_decode_range(range); break;\n\t\tcase 'number': r = safe_decode_range(sheet[\"!ref\"]); r.s.r = range; break;\n\t\tdefault: r = range;\n\t}\n\tif(header > 0) offset = 0;\n\tvar rr = encode_row(r.s.r);\n\tvar cols = [];\n\tvar counter = 0;\n\tvar dense = Array.isArray(sheet);\n\tvar R = r.s.r, C = 0;\n\tvar header_cnt = {};\n\tif(dense && !sheet[R]) sheet[R] = [];\n\tvar colinfo = o.skipHidden && sheet[\"!cols\"] || [];\n\tvar rowinfo = o.skipHidden && sheet[\"!rows\"] || [];\n\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\tif(((colinfo[C]||{}).hidden)) continue;\n\t\tcols[C] = encode_col(C);\n\t\tval = dense ? sheet[R][C] : sheet[cols[C] + rr];\n\t\tswitch(header) {\n\t\t\tcase 1: hdr[C] = C - r.s.c; break;\n\t\t\tcase 2: hdr[C] = cols[C]; break;\n\t\t\tcase 3: hdr[C] = o.header[C - r.s.c]; break;\n\t\t\tdefault:\n\t\t\t\tif(val == null) val = {w: \"__EMPTY\", t: \"s\"};\n\t\t\t\tvv = v = format_cell(val, null, o);\n\t\t\t\tcounter = header_cnt[v] || 0;\n\t\t\t\tif(!counter) header_cnt[v] = 1;\n\t\t\t\telse {\n\t\t\t\t\tdo { vv = v + \"_\" + (counter++); } while(header_cnt[vv]); header_cnt[v] = counter;\n\t\t\t\t\theader_cnt[vv] = 1;\n\t\t\t\t}\n\t\t\t\thdr[C] = vv;\n\t\t}\n\t}\n\tR = r.s.r + offset;\n\tstream._read = function() {\n\t\twhile(R <= r.e.r) {\n\t\t\tif ((rowinfo[R-1]||{}).hidden) continue;\n\t\t\tvar row = make_json_row(sheet, r, R, cols, header, hdr, dense, o);\n\t\t\t++R;\n\t\t\tif((row.isempty === false) || (header === 1 ? o.blankrows !== false : !!o.blankrows)) {\n\t\t\t\tstream.push(row.row);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\treturn stream.push(null);\n\t};\n\treturn stream;\n}\n\nvar __stream = {\n\tto_json: write_json_stream,\n\tto_html: write_html_stream,\n\tto_csv: write_csv_stream,\n  set_readable: set_readable\n};\nif(typeof parse_xlscfb !== \"undefined\") XLSX.parse_xlscfb = parse_xlscfb;\nXLSX.parse_zip = parse_zip;\nXLSX.read = readSync; //xlsread\nXLSX.readFile = readFileSync; //readFile\nXLSX.readFileSync = readFileSync;\nXLSX.write = writeSync;\nXLSX.writeFile = writeFileSync;\nXLSX.writeFileSync = writeFileSync;\nXLSX.writeFileAsync = writeFileAsync;\nXLSX.utils = utils;\nXLSX.writeXLSX = writeSyncXLSX;\nXLSX.writeFileXLSX = writeFileSyncXLSX;\nXLSX.SSF = SSF;\nif(typeof __stream !== \"undefined\") XLSX.stream = __stream;\nif(typeof CFB !== \"undefined\") XLSX.CFB = CFB;\nif(typeof require !== \"undefined\") {\n  var strmod = require('stream');\n  if((strmod||{}).Readable) set_readable(strmod.Readable);\n}\n}\n/*global define */\nif(typeof exports !== 'undefined') make_xlsx_lib(exports);\nelse if(typeof module !== 'undefined' && module.exports) make_xlsx_lib(module.exports);\nelse if(typeof define === 'function' && define.amd) define('xlsx', function() { if(!XLSX.version) make_xlsx_lib(XLSX); return XLSX; });\nelse make_xlsx_lib(XLSX);\n/* NOTE: the following extra line is needed for \"Lightning Locker Service\" */\nif(typeof window !== 'undefined' && !window.XLSX) try { window.XLSX = XLSX; } catch(e) {}\n"],"mappings":"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I;IAAE;IACd,MAAM,EAAE,EAAE;IAAE;IACZ,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAAI;IAAE;IACd,MAAM,EAAE,IAA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A,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MAClB,MAAM,EAAE;QAAEA,CAAC,EAAC;MAAK,CAAC;MA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AAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,EAAE,EAAE,CAAC;IACL,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,EAAE,CAAC;IACN,GAAG,E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"},"metadata":{},"sourceType":"script","externalDependencies":[]}